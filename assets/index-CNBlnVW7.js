function nR(t,e){for(var r=0;r<e.length;r++){const n=e[r];if(typeof n!="string"&&!Array.isArray(n)){for(const i in n)if(i!=="default"&&!(i in t)){const o=Object.getOwnPropertyDescriptor(n,i);o&&Object.defineProperty(t,i,o.get?o:{enumerable:!0,get:()=>n[i]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const c of o.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&n(c)}).observe(document,{childList:!0,subtree:!0});function r(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerPolicy&&(o.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?o.credentials="include":i.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function n(i){if(i.ep)return;i.ep=!0;const o=r(i);fetch(i.href,o)}})();function Ug(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var km={exports:{}},_u={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var gy;function aR(){if(gy)return _u;gy=1;var t=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function r(n,i,o){var c=null;if(o!==void 0&&(c=""+o),i.key!==void 0&&(c=""+i.key),"key"in i){o={};for(var u in i)u!=="key"&&(o[u]=i[u])}else o=i;return i=o.ref,{$$typeof:t,type:n,key:c,ref:i!==void 0?i:null,props:o}}return _u.Fragment=e,_u.jsx=r,_u.jsxs=r,_u}var vy;function iR(){return vy||(vy=1,km.exports=aR()),km.exports}var Q=iR(),bm={exports:{}},ft={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var _y;function sR(){if(_y)return ft;_y=1;var t=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),i=Symbol.for("react.profiler"),o=Symbol.for("react.consumer"),c=Symbol.for("react.context"),u=Symbol.for("react.forward_ref"),h=Symbol.for("react.suspense"),p=Symbol.for("react.memo"),g=Symbol.for("react.lazy"),_=Symbol.iterator;function x(G){return G===null||typeof G!="object"?null:(G=_&&G[_]||G["@@iterator"],typeof G=="function"?G:null)}var T={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},w=Object.assign,S={};function C(G,se,P){this.props=G,this.context=se,this.refs=S,this.updater=P||T}C.prototype.isReactComponent={},C.prototype.setState=function(G,se){if(typeof G!="object"&&typeof G!="function"&&G!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,G,se,"setState")},C.prototype.forceUpdate=function(G){this.updater.enqueueForceUpdate(this,G,"forceUpdate")};function z(){}z.prototype=C.prototype;function Y(G,se,P){this.props=G,this.context=se,this.refs=S,this.updater=P||T}var L=Y.prototype=new z;L.constructor=Y,w(L,C.prototype),L.isPureReactComponent=!0;var K=Array.isArray,Z={H:null,A:null,T:null,S:null,V:null},re=Object.prototype.hasOwnProperty;function k(G,se,P,j,J,ee){return P=ee.ref,{$$typeof:t,type:G,key:se,ref:P!==void 0?P:null,props:ee}}function A(G,se){return k(G.type,se,void 0,void 0,void 0,G.props)}function E(G){return typeof G=="object"&&G!==null&&G.$$typeof===t}function I(G){var se={"=":"=0",":":"=2"};return"$"+G.replace(/[=:]/g,function(P){return se[P]})}var O=/\/+/g;function D(G,se){return typeof G=="object"&&G!==null&&G.key!=null?I(""+G.key):se.toString(36)}function F(){}function Fe(G){switch(G.status){case"fulfilled":return G.value;case"rejected":throw G.reason;default:switch(typeof G.status=="string"?G.then(F,F):(G.status="pending",G.then(function(se){G.status==="pending"&&(G.status="fulfilled",G.value=se)},function(se){G.status==="pending"&&(G.status="rejected",G.reason=se)})),G.status){case"fulfilled":return G.value;case"rejected":throw G.reason}}throw G}function Ce(G,se,P,j,J){var ee=typeof G;(ee==="undefined"||ee==="boolean")&&(G=null);var ue=!1;if(G===null)ue=!0;else switch(ee){case"bigint":case"string":case"number":ue=!0;break;case"object":switch(G.$$typeof){case t:case e:ue=!0;break;case g:return ue=G._init,Ce(ue(G._payload),se,P,j,J)}}if(ue)return J=J(G),ue=j===""?"."+D(G,0):j,K(J)?(P="",ue!=null&&(P=ue.replace(O,"$&/")+"/"),Ce(J,se,P,"",function(we){return we})):J!=null&&(E(J)&&(J=A(J,P+(J.key==null||G&&G.key===J.key?"":(""+J.key).replace(O,"$&/")+"/")+ue)),se.push(J)),1;ue=0;var Ie=j===""?".":j+":";if(K(G))for(var Ee=0;Ee<G.length;Ee++)j=G[Ee],ee=Ie+D(j,Ee),ue+=Ce(j,se,P,ee,J);else if(Ee=x(G),typeof Ee=="function")for(G=Ee.call(G),Ee=0;!(j=G.next()).done;)j=j.value,ee=Ie+D(j,Ee++),ue+=Ce(j,se,P,ee,J);else if(ee==="object"){if(typeof G.then=="function")return Ce(Fe(G),se,P,j,J);throw se=String(G),Error("Objects are not valid as a React child (found: "+(se==="[object Object]"?"object with keys {"+Object.keys(G).join(", ")+"}":se)+"). If you meant to render a collection of children, use an array instead.")}return ue}function ae(G,se,P){if(G==null)return G;var j=[],J=0;return Ce(G,j,"","",function(ee){return se.call(P,ee,J++)}),j}function oe(G){if(G._status===-1){var se=G._result;se=se(),se.then(function(P){(G._status===0||G._status===-1)&&(G._status=1,G._result=P)},function(P){(G._status===0||G._status===-1)&&(G._status=2,G._result=P)}),G._status===-1&&(G._status=0,G._result=se)}if(G._status===1)return G._result.default;throw G._result}var be=typeof reportError=="function"?reportError:function(G){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var se=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof G=="object"&&G!==null&&typeof G.message=="string"?String(G.message):String(G),error:G});if(!window.dispatchEvent(se))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",G);return}console.error(G)};function ne(){}return ft.Children={map:ae,forEach:function(G,se,P){ae(G,function(){se.apply(this,arguments)},P)},count:function(G){var se=0;return ae(G,function(){se++}),se},toArray:function(G){return ae(G,function(se){return se})||[]},only:function(G){if(!E(G))throw Error("React.Children.only expected to receive a single React element child.");return G}},ft.Component=C,ft.Fragment=r,ft.Profiler=i,ft.PureComponent=Y,ft.StrictMode=n,ft.Suspense=h,ft.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=Z,ft.__COMPILER_RUNTIME={__proto__:null,c:function(G){return Z.H.useMemoCache(G)}},ft.cache=function(G){return function(){return G.apply(null,arguments)}},ft.cloneElement=function(G,se,P){if(G==null)throw Error("The argument must be a React element, but you passed "+G+".");var j=w({},G.props),J=G.key,ee=void 0;if(se!=null)for(ue in se.ref!==void 0&&(ee=void 0),se.key!==void 0&&(J=""+se.key),se)!re.call(se,ue)||ue==="key"||ue==="__self"||ue==="__source"||ue==="ref"&&se.ref===void 0||(j[ue]=se[ue]);var ue=arguments.length-2;if(ue===1)j.children=P;else if(1<ue){for(var Ie=Array(ue),Ee=0;Ee<ue;Ee++)Ie[Ee]=arguments[Ee+2];j.children=Ie}return k(G.type,J,void 0,void 0,ee,j)},ft.createContext=function(G){return G={$$typeof:c,_currentValue:G,_currentValue2:G,_threadCount:0,Provider:null,Consumer:null},G.Provider=G,G.Consumer={$$typeof:o,_context:G},G},ft.createElement=function(G,se,P){var j,J={},ee=null;if(se!=null)for(j in se.key!==void 0&&(ee=""+se.key),se)re.call(se,j)&&j!=="key"&&j!=="__self"&&j!=="__source"&&(J[j]=se[j]);var ue=arguments.length-2;if(ue===1)J.children=P;else if(1<ue){for(var Ie=Array(ue),Ee=0;Ee<ue;Ee++)Ie[Ee]=arguments[Ee+2];J.children=Ie}if(G&&G.defaultProps)for(j in ue=G.defaultProps,ue)J[j]===void 0&&(J[j]=ue[j]);return k(G,ee,void 0,void 0,null,J)},ft.createRef=function(){return{current:null}},ft.forwardRef=function(G){return{$$typeof:u,render:G}},ft.isValidElement=E,ft.lazy=function(G){return{$$typeof:g,_payload:{_status:-1,_result:G},_init:oe}},ft.memo=function(G,se){return{$$typeof:p,type:G,compare:se===void 0?null:se}},ft.startTransition=function(G){var se=Z.T,P={};Z.T=P;try{var j=G(),J=Z.S;J!==null&&J(P,j),typeof j=="object"&&j!==null&&typeof j.then=="function"&&j.then(ne,be)}catch(ee){be(ee)}finally{Z.T=se}},ft.unstable_useCacheRefresh=function(){return Z.H.useCacheRefresh()},ft.use=function(G){return Z.H.use(G)},ft.useActionState=function(G,se,P){return Z.H.useActionState(G,se,P)},ft.useCallback=function(G,se){return Z.H.useCallback(G,se)},ft.useContext=function(G){return Z.H.useContext(G)},ft.useDebugValue=function(){},ft.useDeferredValue=function(G,se){return Z.H.useDeferredValue(G,se)},ft.useEffect=function(G,se,P){var j=Z.H;if(typeof P=="function")throw Error("useEffect CRUD overload is not enabled in this build of React.");return j.useEffect(G,se)},ft.useId=function(){return Z.H.useId()},ft.useImperativeHandle=function(G,se,P){return Z.H.useImperativeHandle(G,se,P)},ft.useInsertionEffect=function(G,se){return Z.H.useInsertionEffect(G,se)},ft.useLayoutEffect=function(G,se){return Z.H.useLayoutEffect(G,se)},ft.useMemo=function(G,se){return Z.H.useMemo(G,se)},ft.useOptimistic=function(G,se){return Z.H.useOptimistic(G,se)},ft.useReducer=function(G,se,P){return Z.H.useReducer(G,se,P)},ft.useRef=function(G){return Z.H.useRef(G)},ft.useState=function(G){return Z.H.useState(G)},ft.useSyncExternalStore=function(G,se,P){return Z.H.useSyncExternalStore(G,se,P)},ft.useTransition=function(){return Z.H.useTransition()},ft.version="19.1.0",ft}var xy;function Bg(){return xy||(xy=1,bm.exports=sR()),bm.exports}var Pe=Bg();const u2=Ug(Pe),oR=nR({__proto__:null,default:u2},[Pe]);var Im={exports:{}},xu={},Dm={exports:{}},Om={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var yy;function lR(){return yy||(yy=1,function(t){function e(ae,oe){var be=ae.length;ae.push(oe);e:for(;0<be;){var ne=be-1>>>1,G=ae[ne];if(0<i(G,oe))ae[ne]=oe,ae[be]=G,be=ne;else break e}}function r(ae){return ae.length===0?null:ae[0]}function n(ae){if(ae.length===0)return null;var oe=ae[0],be=ae.pop();if(be!==oe){ae[0]=be;e:for(var ne=0,G=ae.length,se=G>>>1;ne<se;){var P=2*(ne+1)-1,j=ae[P],J=P+1,ee=ae[J];if(0>i(j,be))J<G&&0>i(ee,j)?(ae[ne]=ee,ae[J]=be,ne=J):(ae[ne]=j,ae[P]=be,ne=P);else if(J<G&&0>i(ee,be))ae[ne]=ee,ae[J]=be,ne=J;else break e}}return oe}function i(ae,oe){var be=ae.sortIndex-oe.sortIndex;return be!==0?be:ae.id-oe.id}if(t.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var o=performance;t.unstable_now=function(){return o.now()}}else{var c=Date,u=c.now();t.unstable_now=function(){return c.now()-u}}var h=[],p=[],g=1,_=null,x=3,T=!1,w=!1,S=!1,C=!1,z=typeof setTimeout=="function"?setTimeout:null,Y=typeof clearTimeout=="function"?clearTimeout:null,L=typeof setImmediate<"u"?setImmediate:null;function K(ae){for(var oe=r(p);oe!==null;){if(oe.callback===null)n(p);else if(oe.startTime<=ae)n(p),oe.sortIndex=oe.expirationTime,e(h,oe);else break;oe=r(p)}}function Z(ae){if(S=!1,K(ae),!w)if(r(h)!==null)w=!0,re||(re=!0,D());else{var oe=r(p);oe!==null&&Ce(Z,oe.startTime-ae)}}var re=!1,k=-1,A=5,E=-1;function I(){return C?!0:!(t.unstable_now()-E<A)}function O(){if(C=!1,re){var ae=t.unstable_now();E=ae;var oe=!0;try{e:{w=!1,S&&(S=!1,Y(k),k=-1),T=!0;var be=x;try{t:{for(K(ae),_=r(h);_!==null&&!(_.expirationTime>ae&&I());){var ne=_.callback;if(typeof ne=="function"){_.callback=null,x=_.priorityLevel;var G=ne(_.expirationTime<=ae);if(ae=t.unstable_now(),typeof G=="function"){_.callback=G,K(ae),oe=!0;break t}_===r(h)&&n(h),K(ae)}else n(h);_=r(h)}if(_!==null)oe=!0;else{var se=r(p);se!==null&&Ce(Z,se.startTime-ae),oe=!1}}break e}finally{_=null,x=be,T=!1}oe=void 0}}finally{oe?D():re=!1}}}var D;if(typeof L=="function")D=function(){L(O)};else if(typeof MessageChannel<"u"){var F=new MessageChannel,Fe=F.port2;F.port1.onmessage=O,D=function(){Fe.postMessage(null)}}else D=function(){z(O,0)};function Ce(ae,oe){k=z(function(){ae(t.unstable_now())},oe)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(ae){ae.callback=null},t.unstable_forceFrameRate=function(ae){0>ae||125<ae?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):A=0<ae?Math.floor(1e3/ae):5},t.unstable_getCurrentPriorityLevel=function(){return x},t.unstable_next=function(ae){switch(x){case 1:case 2:case 3:var oe=3;break;default:oe=x}var be=x;x=oe;try{return ae()}finally{x=be}},t.unstable_requestPaint=function(){C=!0},t.unstable_runWithPriority=function(ae,oe){switch(ae){case 1:case 2:case 3:case 4:case 5:break;default:ae=3}var be=x;x=ae;try{return oe()}finally{x=be}},t.unstable_scheduleCallback=function(ae,oe,be){var ne=t.unstable_now();switch(typeof be=="object"&&be!==null?(be=be.delay,be=typeof be=="number"&&0<be?ne+be:ne):be=ne,ae){case 1:var G=-1;break;case 2:G=250;break;case 5:G=1073741823;break;case 4:G=1e4;break;default:G=5e3}return G=be+G,ae={id:g++,callback:oe,priorityLevel:ae,startTime:be,expirationTime:G,sortIndex:-1},be>ne?(ae.sortIndex=be,e(p,ae),r(h)===null&&ae===r(p)&&(S?(Y(k),k=-1):S=!0,Ce(Z,be-ne))):(ae.sortIndex=G,e(h,ae),w||T||(w=!0,re||(re=!0,D()))),ae},t.unstable_shouldYield=I,t.unstable_wrapCallback=function(ae){var oe=x;return function(){var be=x;x=oe;try{return ae.apply(this,arguments)}finally{x=be}}}}(Om)),Om}var Ey;function cR(){return Ey||(Ey=1,Dm.exports=lR()),Dm.exports}var Nm={exports:{}},an={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ty;function uR(){if(Ty)return an;Ty=1;var t=Bg();function e(h){var p="https://react.dev/errors/"+h;if(1<arguments.length){p+="?args[]="+encodeURIComponent(arguments[1]);for(var g=2;g<arguments.length;g++)p+="&args[]="+encodeURIComponent(arguments[g])}return"Minified React error #"+h+"; visit "+p+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function r(){}var n={d:{f:r,r:function(){throw Error(e(522))},D:r,C:r,L:r,m:r,X:r,S:r,M:r},p:0,findDOMNode:null},i=Symbol.for("react.portal");function o(h,p,g){var _=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:i,key:_==null?null:""+_,children:h,containerInfo:p,implementation:g}}var c=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function u(h,p){if(h==="font")return"";if(typeof p=="string")return p==="use-credentials"?p:""}return an.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=n,an.createPortal=function(h,p){var g=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!p||p.nodeType!==1&&p.nodeType!==9&&p.nodeType!==11)throw Error(e(299));return o(h,p,null,g)},an.flushSync=function(h){var p=c.T,g=n.p;try{if(c.T=null,n.p=2,h)return h()}finally{c.T=p,n.p=g,n.d.f()}},an.preconnect=function(h,p){typeof h=="string"&&(p?(p=p.crossOrigin,p=typeof p=="string"?p==="use-credentials"?p:"":void 0):p=null,n.d.C(h,p))},an.prefetchDNS=function(h){typeof h=="string"&&n.d.D(h)},an.preinit=function(h,p){if(typeof h=="string"&&p&&typeof p.as=="string"){var g=p.as,_=u(g,p.crossOrigin),x=typeof p.integrity=="string"?p.integrity:void 0,T=typeof p.fetchPriority=="string"?p.fetchPriority:void 0;g==="style"?n.d.S(h,typeof p.precedence=="string"?p.precedence:void 0,{crossOrigin:_,integrity:x,fetchPriority:T}):g==="script"&&n.d.X(h,{crossOrigin:_,integrity:x,fetchPriority:T,nonce:typeof p.nonce=="string"?p.nonce:void 0})}},an.preinitModule=function(h,p){if(typeof h=="string")if(typeof p=="object"&&p!==null){if(p.as==null||p.as==="script"){var g=u(p.as,p.crossOrigin);n.d.M(h,{crossOrigin:g,integrity:typeof p.integrity=="string"?p.integrity:void 0,nonce:typeof p.nonce=="string"?p.nonce:void 0})}}else p==null&&n.d.M(h)},an.preload=function(h,p){if(typeof h=="string"&&typeof p=="object"&&p!==null&&typeof p.as=="string"){var g=p.as,_=u(g,p.crossOrigin);n.d.L(h,g,{crossOrigin:_,integrity:typeof p.integrity=="string"?p.integrity:void 0,nonce:typeof p.nonce=="string"?p.nonce:void 0,type:typeof p.type=="string"?p.type:void 0,fetchPriority:typeof p.fetchPriority=="string"?p.fetchPriority:void 0,referrerPolicy:typeof p.referrerPolicy=="string"?p.referrerPolicy:void 0,imageSrcSet:typeof p.imageSrcSet=="string"?p.imageSrcSet:void 0,imageSizes:typeof p.imageSizes=="string"?p.imageSizes:void 0,media:typeof p.media=="string"?p.media:void 0})}},an.preloadModule=function(h,p){if(typeof h=="string")if(p){var g=u(p.as,p.crossOrigin);n.d.m(h,{as:typeof p.as=="string"&&p.as!=="script"?p.as:void 0,crossOrigin:g,integrity:typeof p.integrity=="string"?p.integrity:void 0})}else n.d.m(h)},an.requestFormReset=function(h){n.d.r(h)},an.unstable_batchedUpdates=function(h,p){return h(p)},an.useFormState=function(h,p,g){return c.H.useFormState(h,p,g)},an.useFormStatus=function(){return c.H.useHostTransitionStatus()},an.version="19.1.0",an}var Ay;function f2(){if(Ay)return Nm.exports;Ay=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}return t(),Nm.exports=uR(),Nm.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var wy;function fR(){if(wy)return xu;wy=1;var t=cR(),e=Bg(),r=f2();function n(a){var s="https://react.dev/errors/"+a;if(1<arguments.length){s+="?args[]="+encodeURIComponent(arguments[1]);for(var l=2;l<arguments.length;l++)s+="&args[]="+encodeURIComponent(arguments[l])}return"Minified React error #"+a+"; visit "+s+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function i(a){return!(!a||a.nodeType!==1&&a.nodeType!==9&&a.nodeType!==11)}function o(a){var s=a,l=a;if(a.alternate)for(;s.return;)s=s.return;else{a=s;do s=a,(s.flags&4098)!==0&&(l=s.return),a=s.return;while(a)}return s.tag===3?l:null}function c(a){if(a.tag===13){var s=a.memoizedState;if(s===null&&(a=a.alternate,a!==null&&(s=a.memoizedState)),s!==null)return s.dehydrated}return null}function u(a){if(o(a)!==a)throw Error(n(188))}function h(a){var s=a.alternate;if(!s){if(s=o(a),s===null)throw Error(n(188));return s!==a?null:a}for(var l=a,f=s;;){var m=l.return;if(m===null)break;var v=m.alternate;if(v===null){if(f=m.return,f!==null){l=f;continue}break}if(m.child===v.child){for(v=m.child;v;){if(v===l)return u(m),a;if(v===f)return u(m),s;v=v.sibling}throw Error(n(188))}if(l.return!==f.return)l=m,f=v;else{for(var b=!1,M=m.child;M;){if(M===l){b=!0,l=m,f=v;break}if(M===f){b=!0,f=m,l=v;break}M=M.sibling}if(!b){for(M=v.child;M;){if(M===l){b=!0,l=v,f=m;break}if(M===f){b=!0,f=v,l=m;break}M=M.sibling}if(!b)throw Error(n(189))}}if(l.alternate!==f)throw Error(n(190))}if(l.tag!==3)throw Error(n(188));return l.stateNode.current===l?a:s}function p(a){var s=a.tag;if(s===5||s===26||s===27||s===6)return a;for(a=a.child;a!==null;){if(s=p(a),s!==null)return s;a=a.sibling}return null}var g=Object.assign,_=Symbol.for("react.element"),x=Symbol.for("react.transitional.element"),T=Symbol.for("react.portal"),w=Symbol.for("react.fragment"),S=Symbol.for("react.strict_mode"),C=Symbol.for("react.profiler"),z=Symbol.for("react.provider"),Y=Symbol.for("react.consumer"),L=Symbol.for("react.context"),K=Symbol.for("react.forward_ref"),Z=Symbol.for("react.suspense"),re=Symbol.for("react.suspense_list"),k=Symbol.for("react.memo"),A=Symbol.for("react.lazy"),E=Symbol.for("react.activity"),I=Symbol.for("react.memo_cache_sentinel"),O=Symbol.iterator;function D(a){return a===null||typeof a!="object"?null:(a=O&&a[O]||a["@@iterator"],typeof a=="function"?a:null)}var F=Symbol.for("react.client.reference");function Fe(a){if(a==null)return null;if(typeof a=="function")return a.$$typeof===F?null:a.displayName||a.name||null;if(typeof a=="string")return a;switch(a){case w:return"Fragment";case C:return"Profiler";case S:return"StrictMode";case Z:return"Suspense";case re:return"SuspenseList";case E:return"Activity"}if(typeof a=="object")switch(a.$$typeof){case T:return"Portal";case L:return(a.displayName||"Context")+".Provider";case Y:return(a._context.displayName||"Context")+".Consumer";case K:var s=a.render;return a=a.displayName,a||(a=s.displayName||s.name||"",a=a!==""?"ForwardRef("+a+")":"ForwardRef"),a;case k:return s=a.displayName||null,s!==null?s:Fe(a.type)||"Memo";case A:s=a._payload,a=a._init;try{return Fe(a(s))}catch{}}return null}var Ce=Array.isArray,ae=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,oe=r.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,be={pending:!1,data:null,method:null,action:null},ne=[],G=-1;function se(a){return{current:a}}function P(a){0>G||(a.current=ne[G],ne[G]=null,G--)}function j(a,s){G++,ne[G]=a.current,a.current=s}var J=se(null),ee=se(null),ue=se(null),Ie=se(null);function Ee(a,s){switch(j(ue,s),j(ee,a),j(J,null),s.nodeType){case 9:case 11:a=(a=s.documentElement)&&(a=a.namespaceURI)?Gx(a):0;break;default:if(a=s.tagName,s=s.namespaceURI)s=Gx(s),a=qx(s,a);else switch(a){case"svg":a=1;break;case"math":a=2;break;default:a=0}}P(J),j(J,a)}function we(){P(J),P(ee),P(ue)}function Te(a){a.memoizedState!==null&&j(Ie,a);var s=J.current,l=qx(s,a.type);s!==l&&(j(ee,a),j(J,l))}function Ue(a){ee.current===a&&(P(J),P(ee)),Ie.current===a&&(P(Ie),du._currentValue=be)}var W=Object.prototype.hasOwnProperty,nt=t.unstable_scheduleCallback,Ge=t.unstable_cancelCallback,Ke=t.unstable_shouldYield,Be=t.unstable_requestPaint,Ne=t.unstable_now,Ye=t.unstable_getCurrentPriorityLevel,ut=t.unstable_ImmediatePriority,_t=t.unstable_UserBlockingPriority,rr=t.unstable_NormalPriority,_r=t.unstable_LowPriority,hr=t.unstable_IdlePriority,Et=t.log,er=t.unstable_setDisableYieldValue,Ze=null,Je=null;function dt(a){if(typeof Et=="function"&&er(a),Je&&typeof Je.setStrictMode=="function")try{Je.setStrictMode(Ze,a)}catch{}}var Lt=Math.clz32?Math.clz32:Vt,ot=Math.log,Ft=Math.LN2;function Vt(a){return a>>>=0,a===0?32:31-(ot(a)/Ft|0)|0}var Ot=256,Lr=4194304;function Cn(a){var s=a&42;if(s!==0)return s;switch(a&-a){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return a&4194048;case 4194304:case 8388608:case 16777216:case 33554432:return a&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return a}}function Gi(a,s,l){var f=a.pendingLanes;if(f===0)return 0;var m=0,v=a.suspendedLanes,b=a.pingedLanes;a=a.warmLanes;var M=f&134217727;return M!==0?(f=M&~v,f!==0?m=Cn(f):(b&=M,b!==0?m=Cn(b):l||(l=M&~a,l!==0&&(m=Cn(l))))):(M=f&~v,M!==0?m=Cn(M):b!==0?m=Cn(b):l||(l=f&~a,l!==0&&(m=Cn(l)))),m===0?0:s!==0&&s!==m&&(s&v)===0&&(v=m&-m,l=s&-s,v>=l||v===32&&(l&4194048)!==0)?s:m}function ci(a,s){return(a.pendingLanes&~(a.suspendedLanes&~a.pingedLanes)&s)===0}function qi(a,s){switch(a){case 1:case 2:case 4:case 8:case 64:return s+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return s+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Ki(){var a=Ot;return Ot<<=1,(Ot&4194048)===0&&(Ot=256),a}function Wi(){var a=Lr;return Lr<<=1,(Lr&62914560)===0&&(Lr=4194304),a}function _a(a){for(var s=[],l=0;31>l;l++)s.push(a);return s}function xa(a,s){a.pendingLanes|=s,s!==268435456&&(a.suspendedLanes=0,a.pingedLanes=0,a.warmLanes=0)}function Na(a,s,l,f,m,v){var b=a.pendingLanes;a.pendingLanes=l,a.suspendedLanes=0,a.pingedLanes=0,a.warmLanes=0,a.expiredLanes&=l,a.entangledLanes&=l,a.errorRecoveryDisabledLanes&=l,a.shellSuspendCounter=0;var M=a.entanglements,te=a.expirationTimes,pe=a.hiddenUpdates;for(l=b&~l;0<l;){var Ae=31-Lt(l),Re=1<<Ae;M[Ae]=0,te[Ae]=-1;var ve=pe[Ae];if(ve!==null)for(pe[Ae]=null,Ae=0;Ae<ve.length;Ae++){var _e=ve[Ae];_e!==null&&(_e.lane&=-536870913)}l&=~Re}f!==0&&Qn(a,f,0),v!==0&&m===0&&a.tag!==0&&(a.suspendedLanes|=v&~(b&~s))}function Qn(a,s,l){a.pendingLanes|=s,a.suspendedLanes&=~s;var f=31-Lt(s);a.entangledLanes|=s,a.entanglements[f]=a.entanglements[f]|1073741824|l&4194090}function Ys(a,s){var l=a.entangledLanes|=s;for(a=a.entanglements;l;){var f=31-Lt(l),m=1<<f;m&s|a[f]&s&&(a[f]|=s),l&=~m}}function Fa(a){switch(a){case 2:a=1;break;case 8:a=4;break;case 32:a=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:a=128;break;case 268435456:a=134217728;break;default:a=0}return a}function Xi(a){return a&=-a,2<a?8<a?(a&134217727)!==0?32:268435456:8:2}function Pa(){var a=oe.p;return a!==0?a:(a=window.event,a===void 0?32:uy(a.type))}function rl(a,s){var l=oe.p;try{return oe.p=a,s()}finally{oe.p=l}}var Qt=Math.random().toString(36).slice(2),dr="__reactFiber$"+Qt,nr="__reactProps$"+Qt,Rn="__reactContainer$"+Qt,$s="__reactEvents$"+Qt,yc="__reactListeners$"+Qt,N="__reactHandles$"+Qt,q="__reactResources$"+Qt,U="__reactMarker$"+Qt;function B(a){delete a[dr],delete a[nr],delete a[$s],delete a[yc],delete a[N]}function H(a){var s=a[dr];if(s)return s;for(var l=a.parentNode;l;){if(s=l[Rn]||l[dr]){if(l=s.alternate,s.child!==null||l!==null&&l.child!==null)for(a=Yx(a);a!==null;){if(l=a[dr])return l;a=Yx(a)}return s}a=l,l=a.parentNode}return null}function X(a){if(a=a[dr]||a[Rn]){var s=a.tag;if(s===5||s===6||s===13||s===26||s===27||s===3)return a}return null}function de(a){var s=a.tag;if(s===5||s===26||s===27||s===6)return a.stateNode;throw Error(n(33))}function xe(a){var s=a[q];return s||(s=a[q]={hoistableStyles:new Map,hoistableScripts:new Map}),s}function ce(a){a[U]=!0}var me=new Set,ge={};function Oe(a,s){Le(a,s),Le(a+"Capture",s)}function Le(a,s){for(ge[a]=s,a=0;a<s.length;a++)me.add(s[a])}var ze=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Me={},je={};function at(a){return W.call(je,a)?!0:W.call(Me,a)?!1:ze.test(a)?je[a]=!0:(Me[a]=!0,!1)}function Pt(a,s,l){if(at(s))if(l===null)a.removeAttribute(s);else{switch(typeof l){case"undefined":case"function":case"symbol":a.removeAttribute(s);return;case"boolean":var f=s.toLowerCase().slice(0,5);if(f!=="data-"&&f!=="aria-"){a.removeAttribute(s);return}}a.setAttribute(s,""+l)}}function St(a,s,l){if(l===null)a.removeAttribute(s);else{switch(typeof l){case"undefined":case"function":case"symbol":case"boolean":a.removeAttribute(s);return}a.setAttribute(s,""+l)}}function Ct(a,s,l,f){if(f===null)a.removeAttribute(l);else{switch(typeof f){case"undefined":case"function":case"symbol":case"boolean":a.removeAttribute(l);return}a.setAttributeNS(s,l,""+f)}}var Mn,Ma;function vn(a){if(Mn===void 0)try{throw Error()}catch(l){var s=l.stack.trim().match(/\n( *(at )?)/);Mn=s&&s[1]||"",Ma=-1<l.stack.indexOf(`
    at`)?" (<anonymous>)":-1<l.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Mn+a+Ma}var kn=!1;function La(a,s){if(!a||kn)return"";kn=!0;var l=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var f={DetermineComponentFrameRoot:function(){try{if(s){var Re=function(){throw Error()};if(Object.defineProperty(Re.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(Re,[])}catch(_e){var ve=_e}Reflect.construct(a,[],Re)}else{try{Re.call()}catch(_e){ve=_e}a.call(Re.prototype)}}else{try{throw Error()}catch(_e){ve=_e}(Re=a())&&typeof Re.catch=="function"&&Re.catch(function(){})}}catch(_e){if(_e&&ve&&typeof _e.stack=="string")return[_e.stack,ve.stack]}return[null,null]}};f.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var m=Object.getOwnPropertyDescriptor(f.DetermineComponentFrameRoot,"name");m&&m.configurable&&Object.defineProperty(f.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var v=f.DetermineComponentFrameRoot(),b=v[0],M=v[1];if(b&&M){var te=b.split(`
`),pe=M.split(`
`);for(m=f=0;f<te.length&&!te[f].includes("DetermineComponentFrameRoot");)f++;for(;m<pe.length&&!pe[m].includes("DetermineComponentFrameRoot");)m++;if(f===te.length||m===pe.length)for(f=te.length-1,m=pe.length-1;1<=f&&0<=m&&te[f]!==pe[m];)m--;for(;1<=f&&0<=m;f--,m--)if(te[f]!==pe[m]){if(f!==1||m!==1)do if(f--,m--,0>m||te[f]!==pe[m]){var Ae=`
`+te[f].replace(" at new "," at ");return a.displayName&&Ae.includes("<anonymous>")&&(Ae=Ae.replace("<anonymous>",a.displayName)),Ae}while(1<=f&&0<=m);break}}}finally{kn=!1,Error.prepareStackTrace=l}return(l=a?a.displayName||a.name:"")?vn(l):""}function _n(a){switch(a.tag){case 26:case 27:case 5:return vn(a.type);case 16:return vn("Lazy");case 13:return vn("Suspense");case 19:return vn("SuspenseList");case 0:case 15:return La(a.type,!1);case 11:return La(a.type.render,!1);case 1:return La(a.type,!0);case 31:return vn("Activity");default:return""}}function nl(a){try{var s="";do s+=_n(a),a=a.return;while(a);return s}catch(l){return`
Error generating stack: `+l.message+`
`+l.stack}}function xn(a){switch(typeof a){case"bigint":case"boolean":case"number":case"string":case"undefined":return a;case"object":return a;default:return""}}function Ec(a){var s=a.type;return(a=a.nodeName)&&a.toLowerCase()==="input"&&(s==="checkbox"||s==="radio")}function Od(a){var s=Ec(a)?"checked":"value",l=Object.getOwnPropertyDescriptor(a.constructor.prototype,s),f=""+a[s];if(!a.hasOwnProperty(s)&&typeof l<"u"&&typeof l.get=="function"&&typeof l.set=="function"){var m=l.get,v=l.set;return Object.defineProperty(a,s,{configurable:!0,get:function(){return m.call(this)},set:function(b){f=""+b,v.call(this,b)}}),Object.defineProperty(a,s,{enumerable:l.enumerable}),{getValue:function(){return f},setValue:function(b){f=""+b},stopTracking:function(){a._valueTracker=null,delete a[s]}}}}function al(a){a._valueTracker||(a._valueTracker=Od(a))}function Tc(a){if(!a)return!1;var s=a._valueTracker;if(!s)return!0;var l=s.getValue(),f="";return a&&(f=Ec(a)?a.checked?"true":"false":a.value),a=f,a!==l?(s.setValue(a),!0):!1}function Qs(a){if(a=a||(typeof document<"u"?document:void 0),typeof a>"u")return null;try{return a.activeElement||a.body}catch{return a.body}}var Nd=/[\n"\\]/g;function xr(a){return a.replace(Nd,function(s){return"\\"+s.charCodeAt(0).toString(16)+" "})}function Ln(a,s,l,f,m,v,b,M){a.name="",b!=null&&typeof b!="function"&&typeof b!="symbol"&&typeof b!="boolean"?a.type=b:a.removeAttribute("type"),s!=null?b==="number"?(s===0&&a.value===""||a.value!=s)&&(a.value=""+xn(s)):a.value!==""+xn(s)&&(a.value=""+xn(s)):b!=="submit"&&b!=="reset"||a.removeAttribute("value"),s!=null?Yi(a,b,xn(s)):l!=null?Yi(a,b,xn(l)):f!=null&&a.removeAttribute("value"),m==null&&v!=null&&(a.defaultChecked=!!v),m!=null&&(a.checked=m&&typeof m!="function"&&typeof m!="symbol"),M!=null&&typeof M!="function"&&typeof M!="symbol"&&typeof M!="boolean"?a.name=""+xn(M):a.removeAttribute("name")}function Zs(a,s,l,f,m,v,b,M){if(v!=null&&typeof v!="function"&&typeof v!="symbol"&&typeof v!="boolean"&&(a.type=v),s!=null||l!=null){if(!(v!=="submit"&&v!=="reset"||s!=null))return;l=l!=null?""+xn(l):"",s=s!=null?""+xn(s):l,M||s===a.value||(a.value=s),a.defaultValue=s}f=f??m,f=typeof f!="function"&&typeof f!="symbol"&&!!f,a.checked=M?a.checked:!!f,a.defaultChecked=!!f,b!=null&&typeof b!="function"&&typeof b!="symbol"&&typeof b!="boolean"&&(a.name=b)}function Yi(a,s,l){s==="number"&&Qs(a.ownerDocument)===a||a.defaultValue===""+l||(a.defaultValue=""+l)}function ui(a,s,l,f){if(a=a.options,s){s={};for(var m=0;m<l.length;m++)s["$"+l[m]]=!0;for(l=0;l<a.length;l++)m=s.hasOwnProperty("$"+a[l].value),a[l].selected!==m&&(a[l].selected=m),m&&f&&(a[l].defaultSelected=!0)}else{for(l=""+xn(l),s=null,m=0;m<a.length;m++){if(a[m].value===l){a[m].selected=!0,f&&(a[m].defaultSelected=!0);return}s!==null||a[m].disabled||(s=a[m])}s!==null&&(s.selected=!0)}}function Kt(a,s,l){if(s!=null&&(s=""+xn(s),s!==a.value&&(a.value=s),l==null)){a.defaultValue!==s&&(a.defaultValue=s);return}a.defaultValue=l!=null?""+xn(l):""}function Js(a,s,l,f){if(s==null){if(f!=null){if(l!=null)throw Error(n(92));if(Ce(f)){if(1<f.length)throw Error(n(93));f=f[0]}l=f}l==null&&(l=""),s=l}l=xn(s),a.defaultValue=l,f=a.textContent,f===l&&f!==""&&f!==null&&(a.value=f)}function Zn(a,s){if(s){var l=a.firstChild;if(l&&l===a.lastChild&&l.nodeType===3){l.nodeValue=s;return}}a.textContent=s}var eo=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Mf(a,s,l){var f=s.indexOf("--")===0;l==null||typeof l=="boolean"||l===""?f?a.setProperty(s,""):s==="float"?a.cssFloat="":a[s]="":f?a.setProperty(s,l):typeof l!="number"||l===0||eo.has(s)?s==="float"?a.cssFloat=l:a[s]=(""+l).trim():a[s]=l+"px"}function Ac(a,s,l){if(s!=null&&typeof s!="object")throw Error(n(62));if(a=a.style,l!=null){for(var f in l)!l.hasOwnProperty(f)||s!=null&&s.hasOwnProperty(f)||(f.indexOf("--")===0?a.setProperty(f,""):f==="float"?a.cssFloat="":a[f]="");for(var m in s)f=s[m],s.hasOwnProperty(m)&&l[m]!==f&&Mf(a,m,f)}else for(var v in s)s.hasOwnProperty(v)&&Mf(a,v,s[v])}function wc(a){if(a.indexOf("-")===-1)return!1;switch(a){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Fd=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Pd=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function il(a){return Pd.test(""+a)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":a}var fi=null;function Jn(a){return a=a.target||a.srcElement||window,a.correspondingUseElement&&(a=a.correspondingUseElement),a.nodeType===3?a.parentNode:a}var hi=null,di=null;function Sc(a){var s=X(a);if(s&&(a=s.stateNode)){var l=a[nr]||null;e:switch(a=s.stateNode,s.type){case"input":if(Ln(a,l.value,l.defaultValue,l.defaultValue,l.checked,l.defaultChecked,l.type,l.name),s=l.name,l.type==="radio"&&s!=null){for(l=a;l.parentNode;)l=l.parentNode;for(l=l.querySelectorAll('input[name="'+xr(""+s)+'"][type="radio"]'),s=0;s<l.length;s++){var f=l[s];if(f!==a&&f.form===a.form){var m=f[nr]||null;if(!m)throw Error(n(90));Ln(f,m.value,m.defaultValue,m.defaultValue,m.checked,m.defaultChecked,m.type,m.name)}}for(s=0;s<l.length;s++)f=l[s],f.form===a.form&&Tc(f)}break e;case"textarea":Kt(a,l.value,l.defaultValue);break e;case"select":s=l.value,s!=null&&ui(a,!!l.multiple,s,!1)}}}var Va=!1;function Lf(a,s,l){if(Va)return a(s,l);Va=!0;try{var f=a(s);return f}finally{if(Va=!1,(hi!==null||di!==null)&&(Ih(),hi&&(s=hi,a=di,di=hi=null,Sc(s),a)))for(s=0;s<a.length;s++)Sc(a[s])}}function to(a,s){var l=a.stateNode;if(l===null)return null;var f=l[nr]||null;if(f===null)return null;l=f[s];e:switch(s){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(f=!f.disabled)||(a=a.type,f=!(a==="button"||a==="input"||a==="select"||a==="textarea")),a=!f;break e;default:a=!1}if(a)return null;if(l&&typeof l!="function")throw Error(n(231,s,typeof l));return l}var ya=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),ea=!1;if(ya)try{var ro={};Object.defineProperty(ro,"passive",{get:function(){ea=!0}}),window.addEventListener("test",ro,ro),window.removeEventListener("test",ro,ro)}catch{ea=!1}var Ua=null,$i=null,pi=null;function Cc(){if(pi)return pi;var a,s=$i,l=s.length,f,m="value"in Ua?Ua.value:Ua.textContent,v=m.length;for(a=0;a<l&&s[a]===m[a];a++);var b=l-a;for(f=1;f<=b&&s[l-f]===m[v-f];f++);return pi=m.slice(a,1<f?1-f:void 0)}function Ba(a){var s=a.keyCode;return"charCode"in a?(a=a.charCode,a===0&&s===13&&(a=13)):a=s,a===10&&(a=13),32<=a||a===13?a:0}function ja(){return!0}function Rc(){return!1}function Vr(a){function s(l,f,m,v,b){this._reactName=l,this._targetInst=m,this.type=f,this.nativeEvent=v,this.target=b,this.currentTarget=null;for(var M in a)a.hasOwnProperty(M)&&(l=a[M],this[M]=l?l(v):v[M]);return this.isDefaultPrevented=(v.defaultPrevented!=null?v.defaultPrevented:v.returnValue===!1)?ja:Rc,this.isPropagationStopped=Rc,this}return g(s.prototype,{preventDefault:function(){this.defaultPrevented=!0;var l=this.nativeEvent;l&&(l.preventDefault?l.preventDefault():typeof l.returnValue!="unknown"&&(l.returnValue=!1),this.isDefaultPrevented=ja)},stopPropagation:function(){var l=this.nativeEvent;l&&(l.stopPropagation?l.stopPropagation():typeof l.cancelBubble!="unknown"&&(l.cancelBubble=!0),this.isPropagationStopped=ja)},persist:function(){},isPersistent:ja}),s}var Bt={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(a){return a.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},sl=Vr(Bt),no=g({},Bt,{view:0,detail:0}),Vf=Vr(no),ol,ll,za,ao=g({},no,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:oo,button:0,buttons:0,relatedTarget:function(a){return a.relatedTarget===void 0?a.fromElement===a.srcElement?a.toElement:a.fromElement:a.relatedTarget},movementX:function(a){return"movementX"in a?a.movementX:(a!==za&&(za&&a.type==="mousemove"?(ol=a.screenX-za.screenX,ll=a.screenY-za.screenY):ll=ol=0,za=a),ol)},movementY:function(a){return"movementY"in a?a.movementY:ll}}),ta=Vr(ao),Uf=g({},ao,{dataTransfer:0}),Md=Vr(Uf),io=g({},no,{relatedTarget:0}),cl=Vr(io),kc=g({},Bt,{animationName:0,elapsedTime:0,pseudoElement:0}),ul=Vr(kc),Bf=g({},Bt,{clipboardData:function(a){return"clipboardData"in a?a.clipboardData:window.clipboardData}}),fl=Vr(Bf),Ld=g({},Bt,{data:0}),bc=Vr(Ld),so={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},jf={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},zf={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Ic(a){var s=this.nativeEvent;return s.getModifierState?s.getModifierState(a):(a=zf[a])?!!s[a]:!1}function oo(){return Ic}var Hf=g({},no,{key:function(a){if(a.key){var s=so[a.key]||a.key;if(s!=="Unidentified")return s}return a.type==="keypress"?(a=Ba(a),a===13?"Enter":String.fromCharCode(a)):a.type==="keydown"||a.type==="keyup"?jf[a.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:oo,charCode:function(a){return a.type==="keypress"?Ba(a):0},keyCode:function(a){return a.type==="keydown"||a.type==="keyup"?a.keyCode:0},which:function(a){return a.type==="keypress"?Ba(a):a.type==="keydown"||a.type==="keyup"?a.keyCode:0}}),hl=Vr(Hf),Gf=g({},ao,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Dc=Vr(Gf),mi=g({},no,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:oo}),qf=Vr(mi),Kf=g({},Bt,{propertyName:0,elapsedTime:0,pseudoElement:0}),Wf=Vr(Kf),Xf=g({},ao,{deltaX:function(a){return"deltaX"in a?a.deltaX:"wheelDeltaX"in a?-a.wheelDeltaX:0},deltaY:function(a){return"deltaY"in a?a.deltaY:"wheelDeltaY"in a?-a.wheelDeltaY:"wheelDelta"in a?-a.wheelDelta:0},deltaZ:0,deltaMode:0}),dl=Vr(Xf),yn=g({},Bt,{newState:0,oldState:0}),Yf=Vr(yn),$f=[9,13,27,32],Ha=ya&&"CompositionEvent"in window,d=null;ya&&"documentMode"in document&&(d=document.documentMode);var y=ya&&"TextEvent"in window&&!d,R=ya&&(!Ha||d&&8<d&&11>=d),V=" ",fe=!1;function ye(a,s){switch(a){case"keyup":return $f.indexOf(s.keyCode)!==-1;case"keydown":return s.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Ve(a){return a=a.detail,typeof a=="object"&&"data"in a?a.data:null}var Rt=!1;function br(a,s){switch(a){case"compositionend":return Ve(s);case"keypress":return s.which!==32?null:(fe=!0,V);case"textInput":return a=s.data,a===V&&fe?null:a;default:return null}}function kt(a,s){if(Rt)return a==="compositionend"||!Ha&&ye(a,s)?(a=Cc(),pi=$i=Ua=null,Rt=!1,a):null;switch(a){case"paste":return null;case"keypress":if(!(s.ctrlKey||s.altKey||s.metaKey)||s.ctrlKey&&s.altKey){if(s.char&&1<s.char.length)return s.char;if(s.which)return String.fromCharCode(s.which)}return null;case"compositionend":return R&&s.locale!=="ko"?null:s.data;default:return null}}var Ur={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Ir(a){var s=a&&a.nodeName&&a.nodeName.toLowerCase();return s==="input"?!!Ur[a.type]:s==="textarea"}function gi(a,s,l,f){hi?di?di.push(f):di=[f]:hi=f,s=Mh(s,"onChange"),0<s.length&&(l=new sl("onChange","change",null,l,f),a.push({event:l,listeners:s}))}var Kr=null,Ga=null;function Oc(a){Ux(a,0)}function Qf(a){var s=de(a);if(Tc(s))return a}function sv(a,s){if(a==="change")return s}var ov=!1;if(ya){var Vd;if(ya){var Ud="oninput"in document;if(!Ud){var lv=document.createElement("div");lv.setAttribute("oninput","return;"),Ud=typeof lv.oninput=="function"}Vd=Ud}else Vd=!1;ov=Vd&&(!document.documentMode||9<document.documentMode)}function cv(){Kr&&(Kr.detachEvent("onpropertychange",uv),Ga=Kr=null)}function uv(a){if(a.propertyName==="value"&&Qf(Ga)){var s=[];gi(s,Ga,a,Jn(a)),Lf(Oc,s)}}function N4(a,s,l){a==="focusin"?(cv(),Kr=s,Ga=l,Kr.attachEvent("onpropertychange",uv)):a==="focusout"&&cv()}function F4(a){if(a==="selectionchange"||a==="keyup"||a==="keydown")return Qf(Ga)}function P4(a,s){if(a==="click")return Qf(s)}function M4(a,s){if(a==="input"||a==="change")return Qf(s)}function L4(a,s){return a===s&&(a!==0||1/a===1/s)||a!==a&&s!==s}var Vn=typeof Object.is=="function"?Object.is:L4;function Nc(a,s){if(Vn(a,s))return!0;if(typeof a!="object"||a===null||typeof s!="object"||s===null)return!1;var l=Object.keys(a),f=Object.keys(s);if(l.length!==f.length)return!1;for(f=0;f<l.length;f++){var m=l[f];if(!W.call(s,m)||!Vn(a[m],s[m]))return!1}return!0}function fv(a){for(;a&&a.firstChild;)a=a.firstChild;return a}function hv(a,s){var l=fv(a);a=0;for(var f;l;){if(l.nodeType===3){if(f=a+l.textContent.length,a<=s&&f>=s)return{node:l,offset:s-a};a=f}e:{for(;l;){if(l.nextSibling){l=l.nextSibling;break e}l=l.parentNode}l=void 0}l=fv(l)}}function dv(a,s){return a&&s?a===s?!0:a&&a.nodeType===3?!1:s&&s.nodeType===3?dv(a,s.parentNode):"contains"in a?a.contains(s):a.compareDocumentPosition?!!(a.compareDocumentPosition(s)&16):!1:!1}function pv(a){a=a!=null&&a.ownerDocument!=null&&a.ownerDocument.defaultView!=null?a.ownerDocument.defaultView:window;for(var s=Qs(a.document);s instanceof a.HTMLIFrameElement;){try{var l=typeof s.contentWindow.location.href=="string"}catch{l=!1}if(l)a=s.contentWindow;else break;s=Qs(a.document)}return s}function Bd(a){var s=a&&a.nodeName&&a.nodeName.toLowerCase();return s&&(s==="input"&&(a.type==="text"||a.type==="search"||a.type==="tel"||a.type==="url"||a.type==="password")||s==="textarea"||a.contentEditable==="true")}var V4=ya&&"documentMode"in document&&11>=document.documentMode,pl=null,jd=null,Fc=null,zd=!1;function mv(a,s,l){var f=l.window===l?l.document:l.nodeType===9?l:l.ownerDocument;zd||pl==null||pl!==Qs(f)||(f=pl,"selectionStart"in f&&Bd(f)?f={start:f.selectionStart,end:f.selectionEnd}:(f=(f.ownerDocument&&f.ownerDocument.defaultView||window).getSelection(),f={anchorNode:f.anchorNode,anchorOffset:f.anchorOffset,focusNode:f.focusNode,focusOffset:f.focusOffset}),Fc&&Nc(Fc,f)||(Fc=f,f=Mh(jd,"onSelect"),0<f.length&&(s=new sl("onSelect","select",null,s,l),a.push({event:s,listeners:f}),s.target=pl)))}function lo(a,s){var l={};return l[a.toLowerCase()]=s.toLowerCase(),l["Webkit"+a]="webkit"+s,l["Moz"+a]="moz"+s,l}var ml={animationend:lo("Animation","AnimationEnd"),animationiteration:lo("Animation","AnimationIteration"),animationstart:lo("Animation","AnimationStart"),transitionrun:lo("Transition","TransitionRun"),transitionstart:lo("Transition","TransitionStart"),transitioncancel:lo("Transition","TransitionCancel"),transitionend:lo("Transition","TransitionEnd")},Hd={},gv={};ya&&(gv=document.createElement("div").style,"AnimationEvent"in window||(delete ml.animationend.animation,delete ml.animationiteration.animation,delete ml.animationstart.animation),"TransitionEvent"in window||delete ml.transitionend.transition);function co(a){if(Hd[a])return Hd[a];if(!ml[a])return a;var s=ml[a],l;for(l in s)if(s.hasOwnProperty(l)&&l in gv)return Hd[a]=s[l];return a}var vv=co("animationend"),_v=co("animationiteration"),xv=co("animationstart"),U4=co("transitionrun"),B4=co("transitionstart"),j4=co("transitioncancel"),yv=co("transitionend"),Ev=new Map,Gd="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Gd.push("scrollEnd");function Ea(a,s){Ev.set(a,s),Oe(s,[a])}var Tv=new WeakMap;function ra(a,s){if(typeof a=="object"&&a!==null){var l=Tv.get(a);return l!==void 0?l:(s={value:a,source:s,stack:nl(s)},Tv.set(a,s),s)}return{value:a,source:s,stack:nl(s)}}var na=[],gl=0,qd=0;function Zf(){for(var a=gl,s=qd=gl=0;s<a;){var l=na[s];na[s++]=null;var f=na[s];na[s++]=null;var m=na[s];na[s++]=null;var v=na[s];if(na[s++]=null,f!==null&&m!==null){var b=f.pending;b===null?m.next=m:(m.next=b.next,b.next=m),f.pending=m}v!==0&&Av(l,m,v)}}function Jf(a,s,l,f){na[gl++]=a,na[gl++]=s,na[gl++]=l,na[gl++]=f,qd|=f,a.lanes|=f,a=a.alternate,a!==null&&(a.lanes|=f)}function Kd(a,s,l,f){return Jf(a,s,l,f),eh(a)}function vl(a,s){return Jf(a,null,null,s),eh(a)}function Av(a,s,l){a.lanes|=l;var f=a.alternate;f!==null&&(f.lanes|=l);for(var m=!1,v=a.return;v!==null;)v.childLanes|=l,f=v.alternate,f!==null&&(f.childLanes|=l),v.tag===22&&(a=v.stateNode,a===null||a._visibility&1||(m=!0)),a=v,v=v.return;return a.tag===3?(v=a.stateNode,m&&s!==null&&(m=31-Lt(l),a=v.hiddenUpdates,f=a[m],f===null?a[m]=[s]:f.push(s),s.lane=l|536870912),v):null}function eh(a){if(50<iu)throw iu=0,Zp=null,Error(n(185));for(var s=a.return;s!==null;)a=s,s=a.return;return a.tag===3?a.stateNode:null}var _l={};function z4(a,s,l,f){this.tag=a,this.key=l,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=s,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=f,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Un(a,s,l,f){return new z4(a,s,l,f)}function Wd(a){return a=a.prototype,!(!a||!a.isReactComponent)}function vi(a,s){var l=a.alternate;return l===null?(l=Un(a.tag,s,a.key,a.mode),l.elementType=a.elementType,l.type=a.type,l.stateNode=a.stateNode,l.alternate=a,a.alternate=l):(l.pendingProps=s,l.type=a.type,l.flags=0,l.subtreeFlags=0,l.deletions=null),l.flags=a.flags&65011712,l.childLanes=a.childLanes,l.lanes=a.lanes,l.child=a.child,l.memoizedProps=a.memoizedProps,l.memoizedState=a.memoizedState,l.updateQueue=a.updateQueue,s=a.dependencies,l.dependencies=s===null?null:{lanes:s.lanes,firstContext:s.firstContext},l.sibling=a.sibling,l.index=a.index,l.ref=a.ref,l.refCleanup=a.refCleanup,l}function wv(a,s){a.flags&=65011714;var l=a.alternate;return l===null?(a.childLanes=0,a.lanes=s,a.child=null,a.subtreeFlags=0,a.memoizedProps=null,a.memoizedState=null,a.updateQueue=null,a.dependencies=null,a.stateNode=null):(a.childLanes=l.childLanes,a.lanes=l.lanes,a.child=l.child,a.subtreeFlags=0,a.deletions=null,a.memoizedProps=l.memoizedProps,a.memoizedState=l.memoizedState,a.updateQueue=l.updateQueue,a.type=l.type,s=l.dependencies,a.dependencies=s===null?null:{lanes:s.lanes,firstContext:s.firstContext}),a}function th(a,s,l,f,m,v){var b=0;if(f=a,typeof a=="function")Wd(a)&&(b=1);else if(typeof a=="string")b=GC(a,l,J.current)?26:a==="html"||a==="head"||a==="body"?27:5;else e:switch(a){case E:return a=Un(31,l,s,m),a.elementType=E,a.lanes=v,a;case w:return uo(l.children,m,v,s);case S:b=8,m|=24;break;case C:return a=Un(12,l,s,m|2),a.elementType=C,a.lanes=v,a;case Z:return a=Un(13,l,s,m),a.elementType=Z,a.lanes=v,a;case re:return a=Un(19,l,s,m),a.elementType=re,a.lanes=v,a;default:if(typeof a=="object"&&a!==null)switch(a.$$typeof){case z:case L:b=10;break e;case Y:b=9;break e;case K:b=11;break e;case k:b=14;break e;case A:b=16,f=null;break e}b=29,l=Error(n(130,a===null?"null":typeof a,"")),f=null}return s=Un(b,l,s,m),s.elementType=a,s.type=f,s.lanes=v,s}function uo(a,s,l,f){return a=Un(7,a,f,s),a.lanes=l,a}function Xd(a,s,l){return a=Un(6,a,null,s),a.lanes=l,a}function Yd(a,s,l){return s=Un(4,a.children!==null?a.children:[],a.key,s),s.lanes=l,s.stateNode={containerInfo:a.containerInfo,pendingChildren:null,implementation:a.implementation},s}var xl=[],yl=0,rh=null,nh=0,aa=[],ia=0,fo=null,_i=1,xi="";function ho(a,s){xl[yl++]=nh,xl[yl++]=rh,rh=a,nh=s}function Sv(a,s,l){aa[ia++]=_i,aa[ia++]=xi,aa[ia++]=fo,fo=a;var f=_i;a=xi;var m=32-Lt(f)-1;f&=~(1<<m),l+=1;var v=32-Lt(s)+m;if(30<v){var b=m-m%5;v=(f&(1<<b)-1).toString(32),f>>=b,m-=b,_i=1<<32-Lt(s)+m|l<<m|f,xi=v+a}else _i=1<<v|l<<m|f,xi=a}function $d(a){a.return!==null&&(ho(a,1),Sv(a,1,0))}function Qd(a){for(;a===rh;)rh=xl[--yl],xl[yl]=null,nh=xl[--yl],xl[yl]=null;for(;a===fo;)fo=aa[--ia],aa[ia]=null,xi=aa[--ia],aa[ia]=null,_i=aa[--ia],aa[ia]=null}var En=null,cr=null,Ut=!1,po=null,qa=!1,Zd=Error(n(519));function mo(a){var s=Error(n(418,""));throw Lc(ra(s,a)),Zd}function Cv(a){var s=a.stateNode,l=a.type,f=a.memoizedProps;switch(s[dr]=a,s[nr]=f,l){case"dialog":yt("cancel",s),yt("close",s);break;case"iframe":case"object":case"embed":yt("load",s);break;case"video":case"audio":for(l=0;l<ou.length;l++)yt(ou[l],s);break;case"source":yt("error",s);break;case"img":case"image":case"link":yt("error",s),yt("load",s);break;case"details":yt("toggle",s);break;case"input":yt("invalid",s),Zs(s,f.value,f.defaultValue,f.checked,f.defaultChecked,f.type,f.name,!0),al(s);break;case"select":yt("invalid",s);break;case"textarea":yt("invalid",s),Js(s,f.value,f.defaultValue,f.children),al(s)}l=f.children,typeof l!="string"&&typeof l!="number"&&typeof l!="bigint"||s.textContent===""+l||f.suppressHydrationWarning===!0||Hx(s.textContent,l)?(f.popover!=null&&(yt("beforetoggle",s),yt("toggle",s)),f.onScroll!=null&&yt("scroll",s),f.onScrollEnd!=null&&yt("scrollend",s),f.onClick!=null&&(s.onclick=Lh),s=!0):s=!1,s||mo(a)}function Rv(a){for(En=a.return;En;)switch(En.tag){case 5:case 13:qa=!1;return;case 27:case 3:qa=!0;return;default:En=En.return}}function Pc(a){if(a!==En)return!1;if(!Ut)return Rv(a),Ut=!0,!1;var s=a.tag,l;if((l=s!==3&&s!==27)&&((l=s===5)&&(l=a.type,l=!(l!=="form"&&l!=="button")||pm(a.type,a.memoizedProps)),l=!l),l&&cr&&mo(a),Rv(a),s===13){if(a=a.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(n(317));e:{for(a=a.nextSibling,s=0;a;){if(a.nodeType===8)if(l=a.data,l==="/$"){if(s===0){cr=Aa(a.nextSibling);break e}s--}else l!=="$"&&l!=="$!"&&l!=="$?"||s++;a=a.nextSibling}cr=null}}else s===27?(s=cr,hs(a.type)?(a=_m,_m=null,cr=a):cr=s):cr=En?Aa(a.stateNode.nextSibling):null;return!0}function Mc(){cr=En=null,Ut=!1}function kv(){var a=po;return a!==null&&(Dn===null?Dn=a:Dn.push.apply(Dn,a),po=null),a}function Lc(a){po===null?po=[a]:po.push(a)}var Jd=se(null),go=null,yi=null;function Qi(a,s,l){j(Jd,s._currentValue),s._currentValue=l}function Ei(a){a._currentValue=Jd.current,P(Jd)}function ep(a,s,l){for(;a!==null;){var f=a.alternate;if((a.childLanes&s)!==s?(a.childLanes|=s,f!==null&&(f.childLanes|=s)):f!==null&&(f.childLanes&s)!==s&&(f.childLanes|=s),a===l)break;a=a.return}}function tp(a,s,l,f){var m=a.child;for(m!==null&&(m.return=a);m!==null;){var v=m.dependencies;if(v!==null){var b=m.child;v=v.firstContext;e:for(;v!==null;){var M=v;v=m;for(var te=0;te<s.length;te++)if(M.context===s[te]){v.lanes|=l,M=v.alternate,M!==null&&(M.lanes|=l),ep(v.return,l,a),f||(b=null);break e}v=M.next}}else if(m.tag===18){if(b=m.return,b===null)throw Error(n(341));b.lanes|=l,v=b.alternate,v!==null&&(v.lanes|=l),ep(b,l,a),b=null}else b=m.child;if(b!==null)b.return=m;else for(b=m;b!==null;){if(b===a){b=null;break}if(m=b.sibling,m!==null){m.return=b.return,b=m;break}b=b.return}m=b}}function Vc(a,s,l,f){a=null;for(var m=s,v=!1;m!==null;){if(!v){if((m.flags&524288)!==0)v=!0;else if((m.flags&262144)!==0)break}if(m.tag===10){var b=m.alternate;if(b===null)throw Error(n(387));if(b=b.memoizedProps,b!==null){var M=m.type;Vn(m.pendingProps.value,b.value)||(a!==null?a.push(M):a=[M])}}else if(m===Ie.current){if(b=m.alternate,b===null)throw Error(n(387));b.memoizedState.memoizedState!==m.memoizedState.memoizedState&&(a!==null?a.push(du):a=[du])}m=m.return}a!==null&&tp(s,a,l,f),s.flags|=262144}function ah(a){for(a=a.firstContext;a!==null;){if(!Vn(a.context._currentValue,a.memoizedValue))return!0;a=a.next}return!1}function vo(a){go=a,yi=null,a=a.dependencies,a!==null&&(a.firstContext=null)}function nn(a){return bv(go,a)}function ih(a,s){return go===null&&vo(a),bv(a,s)}function bv(a,s){var l=s._currentValue;if(s={context:s,memoizedValue:l,next:null},yi===null){if(a===null)throw Error(n(308));yi=s,a.dependencies={lanes:0,firstContext:s},a.flags|=524288}else yi=yi.next=s;return l}var H4=typeof AbortController<"u"?AbortController:function(){var a=[],s=this.signal={aborted:!1,addEventListener:function(l,f){a.push(f)}};this.abort=function(){s.aborted=!0,a.forEach(function(l){return l()})}},G4=t.unstable_scheduleCallback,q4=t.unstable_NormalPriority,Dr={$$typeof:L,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function rp(){return{controller:new H4,data:new Map,refCount:0}}function Uc(a){a.refCount--,a.refCount===0&&G4(q4,function(){a.controller.abort()})}var Bc=null,np=0,El=0,Tl=null;function K4(a,s){if(Bc===null){var l=Bc=[];np=0,El=im(),Tl={status:"pending",value:void 0,then:function(f){l.push(f)}}}return np++,s.then(Iv,Iv),s}function Iv(){if(--np===0&&Bc!==null){Tl!==null&&(Tl.status="fulfilled");var a=Bc;Bc=null,El=0,Tl=null;for(var s=0;s<a.length;s++)(0,a[s])()}}function W4(a,s){var l=[],f={status:"pending",value:null,reason:null,then:function(m){l.push(m)}};return a.then(function(){f.status="fulfilled",f.value=s;for(var m=0;m<l.length;m++)(0,l[m])(s)},function(m){for(f.status="rejected",f.reason=m,m=0;m<l.length;m++)(0,l[m])(void 0)}),f}var Dv=ae.S;ae.S=function(a,s){typeof s=="object"&&s!==null&&typeof s.then=="function"&&K4(a,s),Dv!==null&&Dv(a,s)};var _o=se(null);function ap(){var a=_o.current;return a!==null?a:Zt.pooledCache}function sh(a,s){s===null?j(_o,_o.current):j(_o,s.pool)}function Ov(){var a=ap();return a===null?null:{parent:Dr._currentValue,pool:a}}var jc=Error(n(460)),Nv=Error(n(474)),oh=Error(n(542)),ip={then:function(){}};function Fv(a){return a=a.status,a==="fulfilled"||a==="rejected"}function lh(){}function Pv(a,s,l){switch(l=a[l],l===void 0?a.push(s):l!==s&&(s.then(lh,lh),s=l),s.status){case"fulfilled":return s.value;case"rejected":throw a=s.reason,Lv(a),a;default:if(typeof s.status=="string")s.then(lh,lh);else{if(a=Zt,a!==null&&100<a.shellSuspendCounter)throw Error(n(482));a=s,a.status="pending",a.then(function(f){if(s.status==="pending"){var m=s;m.status="fulfilled",m.value=f}},function(f){if(s.status==="pending"){var m=s;m.status="rejected",m.reason=f}})}switch(s.status){case"fulfilled":return s.value;case"rejected":throw a=s.reason,Lv(a),a}throw zc=s,jc}}var zc=null;function Mv(){if(zc===null)throw Error(n(459));var a=zc;return zc=null,a}function Lv(a){if(a===jc||a===oh)throw Error(n(483))}var Zi=!1;function sp(a){a.updateQueue={baseState:a.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function op(a,s){a=a.updateQueue,s.updateQueue===a&&(s.updateQueue={baseState:a.baseState,firstBaseUpdate:a.firstBaseUpdate,lastBaseUpdate:a.lastBaseUpdate,shared:a.shared,callbacks:null})}function Ji(a){return{lane:a,tag:0,payload:null,callback:null,next:null}}function es(a,s,l){var f=a.updateQueue;if(f===null)return null;if(f=f.shared,(zt&2)!==0){var m=f.pending;return m===null?s.next=s:(s.next=m.next,m.next=s),f.pending=s,s=eh(a),Av(a,null,l),s}return Jf(a,f,s,l),eh(a)}function Hc(a,s,l){if(s=s.updateQueue,s!==null&&(s=s.shared,(l&4194048)!==0)){var f=s.lanes;f&=a.pendingLanes,l|=f,s.lanes=l,Ys(a,l)}}function lp(a,s){var l=a.updateQueue,f=a.alternate;if(f!==null&&(f=f.updateQueue,l===f)){var m=null,v=null;if(l=l.firstBaseUpdate,l!==null){do{var b={lane:l.lane,tag:l.tag,payload:l.payload,callback:null,next:null};v===null?m=v=b:v=v.next=b,l=l.next}while(l!==null);v===null?m=v=s:v=v.next=s}else m=v=s;l={baseState:f.baseState,firstBaseUpdate:m,lastBaseUpdate:v,shared:f.shared,callbacks:f.callbacks},a.updateQueue=l;return}a=l.lastBaseUpdate,a===null?l.firstBaseUpdate=s:a.next=s,l.lastBaseUpdate=s}var cp=!1;function Gc(){if(cp){var a=Tl;if(a!==null)throw a}}function qc(a,s,l,f){cp=!1;var m=a.updateQueue;Zi=!1;var v=m.firstBaseUpdate,b=m.lastBaseUpdate,M=m.shared.pending;if(M!==null){m.shared.pending=null;var te=M,pe=te.next;te.next=null,b===null?v=pe:b.next=pe,b=te;var Ae=a.alternate;Ae!==null&&(Ae=Ae.updateQueue,M=Ae.lastBaseUpdate,M!==b&&(M===null?Ae.firstBaseUpdate=pe:M.next=pe,Ae.lastBaseUpdate=te))}if(v!==null){var Re=m.baseState;b=0,Ae=pe=te=null,M=v;do{var ve=M.lane&-536870913,_e=ve!==M.lane;if(_e?(bt&ve)===ve:(f&ve)===ve){ve!==0&&ve===El&&(cp=!0),Ae!==null&&(Ae=Ae.next={lane:0,tag:M.tag,payload:M.payload,callback:null,next:null});e:{var it=a,Qe=M;ve=s;var Yt=l;switch(Qe.tag){case 1:if(it=Qe.payload,typeof it=="function"){Re=it.call(Yt,Re,ve);break e}Re=it;break e;case 3:it.flags=it.flags&-65537|128;case 0:if(it=Qe.payload,ve=typeof it=="function"?it.call(Yt,Re,ve):it,ve==null)break e;Re=g({},Re,ve);break e;case 2:Zi=!0}}ve=M.callback,ve!==null&&(a.flags|=64,_e&&(a.flags|=8192),_e=m.callbacks,_e===null?m.callbacks=[ve]:_e.push(ve))}else _e={lane:ve,tag:M.tag,payload:M.payload,callback:M.callback,next:null},Ae===null?(pe=Ae=_e,te=Re):Ae=Ae.next=_e,b|=ve;if(M=M.next,M===null){if(M=m.shared.pending,M===null)break;_e=M,M=_e.next,_e.next=null,m.lastBaseUpdate=_e,m.shared.pending=null}}while(!0);Ae===null&&(te=Re),m.baseState=te,m.firstBaseUpdate=pe,m.lastBaseUpdate=Ae,v===null&&(m.shared.lanes=0),ls|=b,a.lanes=b,a.memoizedState=Re}}function Vv(a,s){if(typeof a!="function")throw Error(n(191,a));a.call(s)}function Uv(a,s){var l=a.callbacks;if(l!==null)for(a.callbacks=null,a=0;a<l.length;a++)Vv(l[a],s)}var Al=se(null),ch=se(0);function Bv(a,s){a=ki,j(ch,a),j(Al,s),ki=a|s.baseLanes}function up(){j(ch,ki),j(Al,Al.current)}function fp(){ki=ch.current,P(Al),P(ch)}var ts=0,pt=null,Wt=null,yr=null,uh=!1,wl=!1,xo=!1,fh=0,Kc=0,Sl=null,X4=0;function pr(){throw Error(n(321))}function hp(a,s){if(s===null)return!1;for(var l=0;l<s.length&&l<a.length;l++)if(!Vn(a[l],s[l]))return!1;return!0}function dp(a,s,l,f,m,v){return ts=v,pt=s,s.memoizedState=null,s.updateQueue=null,s.lanes=0,ae.H=a===null||a.memoizedState===null?A_:w_,xo=!1,v=l(f,m),xo=!1,wl&&(v=zv(s,l,f,m)),jv(a),v}function jv(a){ae.H=vh;var s=Wt!==null&&Wt.next!==null;if(ts=0,yr=Wt=pt=null,uh=!1,Kc=0,Sl=null,s)throw Error(n(300));a===null||Br||(a=a.dependencies,a!==null&&ah(a)&&(Br=!0))}function zv(a,s,l,f){pt=a;var m=0;do{if(wl&&(Sl=null),Kc=0,wl=!1,25<=m)throw Error(n(301));if(m+=1,yr=Wt=null,a.updateQueue!=null){var v=a.updateQueue;v.lastEffect=null,v.events=null,v.stores=null,v.memoCache!=null&&(v.memoCache.index=0)}ae.H=tC,v=s(l,f)}while(wl);return v}function Y4(){var a=ae.H,s=a.useState()[0];return s=typeof s.then=="function"?Wc(s):s,a=a.useState()[0],(Wt!==null?Wt.memoizedState:null)!==a&&(pt.flags|=1024),s}function pp(){var a=fh!==0;return fh=0,a}function mp(a,s,l){s.updateQueue=a.updateQueue,s.flags&=-2053,a.lanes&=~l}function gp(a){if(uh){for(a=a.memoizedState;a!==null;){var s=a.queue;s!==null&&(s.pending=null),a=a.next}uh=!1}ts=0,yr=Wt=pt=null,wl=!1,Kc=fh=0,Sl=null}function bn(){var a={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return yr===null?pt.memoizedState=yr=a:yr=yr.next=a,yr}function Er(){if(Wt===null){var a=pt.alternate;a=a!==null?a.memoizedState:null}else a=Wt.next;var s=yr===null?pt.memoizedState:yr.next;if(s!==null)yr=s,Wt=a;else{if(a===null)throw pt.alternate===null?Error(n(467)):Error(n(310));Wt=a,a={memoizedState:Wt.memoizedState,baseState:Wt.baseState,baseQueue:Wt.baseQueue,queue:Wt.queue,next:null},yr===null?pt.memoizedState=yr=a:yr=yr.next=a}return yr}function vp(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Wc(a){var s=Kc;return Kc+=1,Sl===null&&(Sl=[]),a=Pv(Sl,a,s),s=pt,(yr===null?s.memoizedState:yr.next)===null&&(s=s.alternate,ae.H=s===null||s.memoizedState===null?A_:w_),a}function hh(a){if(a!==null&&typeof a=="object"){if(typeof a.then=="function")return Wc(a);if(a.$$typeof===L)return nn(a)}throw Error(n(438,String(a)))}function _p(a){var s=null,l=pt.updateQueue;if(l!==null&&(s=l.memoCache),s==null){var f=pt.alternate;f!==null&&(f=f.updateQueue,f!==null&&(f=f.memoCache,f!=null&&(s={data:f.data.map(function(m){return m.slice()}),index:0})))}if(s==null&&(s={data:[],index:0}),l===null&&(l=vp(),pt.updateQueue=l),l.memoCache=s,l=s.data[s.index],l===void 0)for(l=s.data[s.index]=Array(a),f=0;f<a;f++)l[f]=I;return s.index++,l}function Ti(a,s){return typeof s=="function"?s(a):s}function dh(a){var s=Er();return xp(s,Wt,a)}function xp(a,s,l){var f=a.queue;if(f===null)throw Error(n(311));f.lastRenderedReducer=l;var m=a.baseQueue,v=f.pending;if(v!==null){if(m!==null){var b=m.next;m.next=v.next,v.next=b}s.baseQueue=m=v,f.pending=null}if(v=a.baseState,m===null)a.memoizedState=v;else{s=m.next;var M=b=null,te=null,pe=s,Ae=!1;do{var Re=pe.lane&-536870913;if(Re!==pe.lane?(bt&Re)===Re:(ts&Re)===Re){var ve=pe.revertLane;if(ve===0)te!==null&&(te=te.next={lane:0,revertLane:0,action:pe.action,hasEagerState:pe.hasEagerState,eagerState:pe.eagerState,next:null}),Re===El&&(Ae=!0);else if((ts&ve)===ve){pe=pe.next,ve===El&&(Ae=!0);continue}else Re={lane:0,revertLane:pe.revertLane,action:pe.action,hasEagerState:pe.hasEagerState,eagerState:pe.eagerState,next:null},te===null?(M=te=Re,b=v):te=te.next=Re,pt.lanes|=ve,ls|=ve;Re=pe.action,xo&&l(v,Re),v=pe.hasEagerState?pe.eagerState:l(v,Re)}else ve={lane:Re,revertLane:pe.revertLane,action:pe.action,hasEagerState:pe.hasEagerState,eagerState:pe.eagerState,next:null},te===null?(M=te=ve,b=v):te=te.next=ve,pt.lanes|=Re,ls|=Re;pe=pe.next}while(pe!==null&&pe!==s);if(te===null?b=v:te.next=M,!Vn(v,a.memoizedState)&&(Br=!0,Ae&&(l=Tl,l!==null)))throw l;a.memoizedState=v,a.baseState=b,a.baseQueue=te,f.lastRenderedState=v}return m===null&&(f.lanes=0),[a.memoizedState,f.dispatch]}function yp(a){var s=Er(),l=s.queue;if(l===null)throw Error(n(311));l.lastRenderedReducer=a;var f=l.dispatch,m=l.pending,v=s.memoizedState;if(m!==null){l.pending=null;var b=m=m.next;do v=a(v,b.action),b=b.next;while(b!==m);Vn(v,s.memoizedState)||(Br=!0),s.memoizedState=v,s.baseQueue===null&&(s.baseState=v),l.lastRenderedState=v}return[v,f]}function Hv(a,s,l){var f=pt,m=Er(),v=Ut;if(v){if(l===void 0)throw Error(n(407));l=l()}else l=s();var b=!Vn((Wt||m).memoizedState,l);b&&(m.memoizedState=l,Br=!0),m=m.queue;var M=Kv.bind(null,f,m,a);if(Xc(2048,8,M,[a]),m.getSnapshot!==s||b||yr!==null&&yr.memoizedState.tag&1){if(f.flags|=2048,Cl(9,ph(),qv.bind(null,f,m,l,s),null),Zt===null)throw Error(n(349));v||(ts&124)!==0||Gv(f,s,l)}return l}function Gv(a,s,l){a.flags|=16384,a={getSnapshot:s,value:l},s=pt.updateQueue,s===null?(s=vp(),pt.updateQueue=s,s.stores=[a]):(l=s.stores,l===null?s.stores=[a]:l.push(a))}function qv(a,s,l,f){s.value=l,s.getSnapshot=f,Wv(s)&&Xv(a)}function Kv(a,s,l){return l(function(){Wv(s)&&Xv(a)})}function Wv(a){var s=a.getSnapshot;a=a.value;try{var l=s();return!Vn(a,l)}catch{return!0}}function Xv(a){var s=vl(a,2);s!==null&&Gn(s,a,2)}function Ep(a){var s=bn();if(typeof a=="function"){var l=a;if(a=l(),xo){dt(!0);try{l()}finally{dt(!1)}}}return s.memoizedState=s.baseState=a,s.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ti,lastRenderedState:a},s}function Yv(a,s,l,f){return a.baseState=l,xp(a,Wt,typeof f=="function"?f:Ti)}function $4(a,s,l,f,m){if(gh(a))throw Error(n(485));if(a=s.action,a!==null){var v={payload:m,action:a,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(b){v.listeners.push(b)}};ae.T!==null?l(!0):v.isTransition=!1,f(v),l=s.pending,l===null?(v.next=s.pending=v,$v(s,v)):(v.next=l.next,s.pending=l.next=v)}}function $v(a,s){var l=s.action,f=s.payload,m=a.state;if(s.isTransition){var v=ae.T,b={};ae.T=b;try{var M=l(m,f),te=ae.S;te!==null&&te(b,M),Qv(a,s,M)}catch(pe){Tp(a,s,pe)}finally{ae.T=v}}else try{v=l(m,f),Qv(a,s,v)}catch(pe){Tp(a,s,pe)}}function Qv(a,s,l){l!==null&&typeof l=="object"&&typeof l.then=="function"?l.then(function(f){Zv(a,s,f)},function(f){return Tp(a,s,f)}):Zv(a,s,l)}function Zv(a,s,l){s.status="fulfilled",s.value=l,Jv(s),a.state=l,s=a.pending,s!==null&&(l=s.next,l===s?a.pending=null:(l=l.next,s.next=l,$v(a,l)))}function Tp(a,s,l){var f=a.pending;if(a.pending=null,f!==null){f=f.next;do s.status="rejected",s.reason=l,Jv(s),s=s.next;while(s!==f)}a.action=null}function Jv(a){a=a.listeners;for(var s=0;s<a.length;s++)(0,a[s])()}function e_(a,s){return s}function t_(a,s){if(Ut){var l=Zt.formState;if(l!==null){e:{var f=pt;if(Ut){if(cr){t:{for(var m=cr,v=qa;m.nodeType!==8;){if(!v){m=null;break t}if(m=Aa(m.nextSibling),m===null){m=null;break t}}v=m.data,m=v==="F!"||v==="F"?m:null}if(m){cr=Aa(m.nextSibling),f=m.data==="F!";break e}}mo(f)}f=!1}f&&(s=l[0])}}return l=bn(),l.memoizedState=l.baseState=s,f={pending:null,lanes:0,dispatch:null,lastRenderedReducer:e_,lastRenderedState:s},l.queue=f,l=y_.bind(null,pt,f),f.dispatch=l,f=Ep(!1),v=Rp.bind(null,pt,!1,f.queue),f=bn(),m={state:s,dispatch:null,action:a,pending:null},f.queue=m,l=$4.bind(null,pt,m,v,l),m.dispatch=l,f.memoizedState=a,[s,l,!1]}function r_(a){var s=Er();return n_(s,Wt,a)}function n_(a,s,l){if(s=xp(a,s,e_)[0],a=dh(Ti)[0],typeof s=="object"&&s!==null&&typeof s.then=="function")try{var f=Wc(s)}catch(b){throw b===jc?oh:b}else f=s;s=Er();var m=s.queue,v=m.dispatch;return l!==s.memoizedState&&(pt.flags|=2048,Cl(9,ph(),Q4.bind(null,m,l),null)),[f,v,a]}function Q4(a,s){a.action=s}function a_(a){var s=Er(),l=Wt;if(l!==null)return n_(s,l,a);Er(),s=s.memoizedState,l=Er();var f=l.queue.dispatch;return l.memoizedState=a,[s,f,!1]}function Cl(a,s,l,f){return a={tag:a,create:l,deps:f,inst:s,next:null},s=pt.updateQueue,s===null&&(s=vp(),pt.updateQueue=s),l=s.lastEffect,l===null?s.lastEffect=a.next=a:(f=l.next,l.next=a,a.next=f,s.lastEffect=a),a}function ph(){return{destroy:void 0,resource:void 0}}function i_(){return Er().memoizedState}function mh(a,s,l,f){var m=bn();f=f===void 0?null:f,pt.flags|=a,m.memoizedState=Cl(1|s,ph(),l,f)}function Xc(a,s,l,f){var m=Er();f=f===void 0?null:f;var v=m.memoizedState.inst;Wt!==null&&f!==null&&hp(f,Wt.memoizedState.deps)?m.memoizedState=Cl(s,v,l,f):(pt.flags|=a,m.memoizedState=Cl(1|s,v,l,f))}function s_(a,s){mh(8390656,8,a,s)}function o_(a,s){Xc(2048,8,a,s)}function l_(a,s){return Xc(4,2,a,s)}function c_(a,s){return Xc(4,4,a,s)}function u_(a,s){if(typeof s=="function"){a=a();var l=s(a);return function(){typeof l=="function"?l():s(null)}}if(s!=null)return a=a(),s.current=a,function(){s.current=null}}function f_(a,s,l){l=l!=null?l.concat([a]):null,Xc(4,4,u_.bind(null,s,a),l)}function Ap(){}function h_(a,s){var l=Er();s=s===void 0?null:s;var f=l.memoizedState;return s!==null&&hp(s,f[1])?f[0]:(l.memoizedState=[a,s],a)}function d_(a,s){var l=Er();s=s===void 0?null:s;var f=l.memoizedState;if(s!==null&&hp(s,f[1]))return f[0];if(f=a(),xo){dt(!0);try{a()}finally{dt(!1)}}return l.memoizedState=[f,s],f}function wp(a,s,l){return l===void 0||(ts&1073741824)!==0?a.memoizedState=s:(a.memoizedState=l,a=gx(),pt.lanes|=a,ls|=a,l)}function p_(a,s,l,f){return Vn(l,s)?l:Al.current!==null?(a=wp(a,l,f),Vn(a,s)||(Br=!0),a):(ts&42)===0?(Br=!0,a.memoizedState=l):(a=gx(),pt.lanes|=a,ls|=a,s)}function m_(a,s,l,f,m){var v=oe.p;oe.p=v!==0&&8>v?v:8;var b=ae.T,M={};ae.T=M,Rp(a,!1,s,l);try{var te=m(),pe=ae.S;if(pe!==null&&pe(M,te),te!==null&&typeof te=="object"&&typeof te.then=="function"){var Ae=W4(te,f);Yc(a,s,Ae,Hn(a))}else Yc(a,s,f,Hn(a))}catch(Re){Yc(a,s,{then:function(){},status:"rejected",reason:Re},Hn())}finally{oe.p=v,ae.T=b}}function Z4(){}function Sp(a,s,l,f){if(a.tag!==5)throw Error(n(476));var m=g_(a).queue;m_(a,m,s,be,l===null?Z4:function(){return v_(a),l(f)})}function g_(a){var s=a.memoizedState;if(s!==null)return s;s={memoizedState:be,baseState:be,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ti,lastRenderedState:be},next:null};var l={};return s.next={memoizedState:l,baseState:l,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ti,lastRenderedState:l},next:null},a.memoizedState=s,a=a.alternate,a!==null&&(a.memoizedState=s),s}function v_(a){var s=g_(a).next.queue;Yc(a,s,{},Hn())}function Cp(){return nn(du)}function __(){return Er().memoizedState}function x_(){return Er().memoizedState}function J4(a){for(var s=a.return;s!==null;){switch(s.tag){case 24:case 3:var l=Hn();a=Ji(l);var f=es(s,a,l);f!==null&&(Gn(f,s,l),Hc(f,s,l)),s={cache:rp()},a.payload=s;return}s=s.return}}function eC(a,s,l){var f=Hn();l={lane:f,revertLane:0,action:l,hasEagerState:!1,eagerState:null,next:null},gh(a)?E_(s,l):(l=Kd(a,s,l,f),l!==null&&(Gn(l,a,f),T_(l,s,f)))}function y_(a,s,l){var f=Hn();Yc(a,s,l,f)}function Yc(a,s,l,f){var m={lane:f,revertLane:0,action:l,hasEagerState:!1,eagerState:null,next:null};if(gh(a))E_(s,m);else{var v=a.alternate;if(a.lanes===0&&(v===null||v.lanes===0)&&(v=s.lastRenderedReducer,v!==null))try{var b=s.lastRenderedState,M=v(b,l);if(m.hasEagerState=!0,m.eagerState=M,Vn(M,b))return Jf(a,s,m,0),Zt===null&&Zf(),!1}catch{}finally{}if(l=Kd(a,s,m,f),l!==null)return Gn(l,a,f),T_(l,s,f),!0}return!1}function Rp(a,s,l,f){if(f={lane:2,revertLane:im(),action:f,hasEagerState:!1,eagerState:null,next:null},gh(a)){if(s)throw Error(n(479))}else s=Kd(a,l,f,2),s!==null&&Gn(s,a,2)}function gh(a){var s=a.alternate;return a===pt||s!==null&&s===pt}function E_(a,s){wl=uh=!0;var l=a.pending;l===null?s.next=s:(s.next=l.next,l.next=s),a.pending=s}function T_(a,s,l){if((l&4194048)!==0){var f=s.lanes;f&=a.pendingLanes,l|=f,s.lanes=l,Ys(a,l)}}var vh={readContext:nn,use:hh,useCallback:pr,useContext:pr,useEffect:pr,useImperativeHandle:pr,useLayoutEffect:pr,useInsertionEffect:pr,useMemo:pr,useReducer:pr,useRef:pr,useState:pr,useDebugValue:pr,useDeferredValue:pr,useTransition:pr,useSyncExternalStore:pr,useId:pr,useHostTransitionStatus:pr,useFormState:pr,useActionState:pr,useOptimistic:pr,useMemoCache:pr,useCacheRefresh:pr},A_={readContext:nn,use:hh,useCallback:function(a,s){return bn().memoizedState=[a,s===void 0?null:s],a},useContext:nn,useEffect:s_,useImperativeHandle:function(a,s,l){l=l!=null?l.concat([a]):null,mh(4194308,4,u_.bind(null,s,a),l)},useLayoutEffect:function(a,s){return mh(4194308,4,a,s)},useInsertionEffect:function(a,s){mh(4,2,a,s)},useMemo:function(a,s){var l=bn();s=s===void 0?null:s;var f=a();if(xo){dt(!0);try{a()}finally{dt(!1)}}return l.memoizedState=[f,s],f},useReducer:function(a,s,l){var f=bn();if(l!==void 0){var m=l(s);if(xo){dt(!0);try{l(s)}finally{dt(!1)}}}else m=s;return f.memoizedState=f.baseState=m,a={pending:null,lanes:0,dispatch:null,lastRenderedReducer:a,lastRenderedState:m},f.queue=a,a=a.dispatch=eC.bind(null,pt,a),[f.memoizedState,a]},useRef:function(a){var s=bn();return a={current:a},s.memoizedState=a},useState:function(a){a=Ep(a);var s=a.queue,l=y_.bind(null,pt,s);return s.dispatch=l,[a.memoizedState,l]},useDebugValue:Ap,useDeferredValue:function(a,s){var l=bn();return wp(l,a,s)},useTransition:function(){var a=Ep(!1);return a=m_.bind(null,pt,a.queue,!0,!1),bn().memoizedState=a,[!1,a]},useSyncExternalStore:function(a,s,l){var f=pt,m=bn();if(Ut){if(l===void 0)throw Error(n(407));l=l()}else{if(l=s(),Zt===null)throw Error(n(349));(bt&124)!==0||Gv(f,s,l)}m.memoizedState=l;var v={value:l,getSnapshot:s};return m.queue=v,s_(Kv.bind(null,f,v,a),[a]),f.flags|=2048,Cl(9,ph(),qv.bind(null,f,v,l,s),null),l},useId:function(){var a=bn(),s=Zt.identifierPrefix;if(Ut){var l=xi,f=_i;l=(f&~(1<<32-Lt(f)-1)).toString(32)+l,s=""+s+"R"+l,l=fh++,0<l&&(s+="H"+l.toString(32)),s+=""}else l=X4++,s=""+s+"r"+l.toString(32)+"";return a.memoizedState=s},useHostTransitionStatus:Cp,useFormState:t_,useActionState:t_,useOptimistic:function(a){var s=bn();s.memoizedState=s.baseState=a;var l={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return s.queue=l,s=Rp.bind(null,pt,!0,l),l.dispatch=s,[a,s]},useMemoCache:_p,useCacheRefresh:function(){return bn().memoizedState=J4.bind(null,pt)}},w_={readContext:nn,use:hh,useCallback:h_,useContext:nn,useEffect:o_,useImperativeHandle:f_,useInsertionEffect:l_,useLayoutEffect:c_,useMemo:d_,useReducer:dh,useRef:i_,useState:function(){return dh(Ti)},useDebugValue:Ap,useDeferredValue:function(a,s){var l=Er();return p_(l,Wt.memoizedState,a,s)},useTransition:function(){var a=dh(Ti)[0],s=Er().memoizedState;return[typeof a=="boolean"?a:Wc(a),s]},useSyncExternalStore:Hv,useId:__,useHostTransitionStatus:Cp,useFormState:r_,useActionState:r_,useOptimistic:function(a,s){var l=Er();return Yv(l,Wt,a,s)},useMemoCache:_p,useCacheRefresh:x_},tC={readContext:nn,use:hh,useCallback:h_,useContext:nn,useEffect:o_,useImperativeHandle:f_,useInsertionEffect:l_,useLayoutEffect:c_,useMemo:d_,useReducer:yp,useRef:i_,useState:function(){return yp(Ti)},useDebugValue:Ap,useDeferredValue:function(a,s){var l=Er();return Wt===null?wp(l,a,s):p_(l,Wt.memoizedState,a,s)},useTransition:function(){var a=yp(Ti)[0],s=Er().memoizedState;return[typeof a=="boolean"?a:Wc(a),s]},useSyncExternalStore:Hv,useId:__,useHostTransitionStatus:Cp,useFormState:a_,useActionState:a_,useOptimistic:function(a,s){var l=Er();return Wt!==null?Yv(l,Wt,a,s):(l.baseState=a,[a,l.queue.dispatch])},useMemoCache:_p,useCacheRefresh:x_},Rl=null,$c=0;function _h(a){var s=$c;return $c+=1,Rl===null&&(Rl=[]),Pv(Rl,a,s)}function Qc(a,s){s=s.props.ref,a.ref=s!==void 0?s:null}function xh(a,s){throw s.$$typeof===_?Error(n(525)):(a=Object.prototype.toString.call(s),Error(n(31,a==="[object Object]"?"object with keys {"+Object.keys(s).join(", ")+"}":a)))}function S_(a){var s=a._init;return s(a._payload)}function C_(a){function s(le,ie){if(a){var he=le.deletions;he===null?(le.deletions=[ie],le.flags|=16):he.push(ie)}}function l(le,ie){if(!a)return null;for(;ie!==null;)s(le,ie),ie=ie.sibling;return null}function f(le){for(var ie=new Map;le!==null;)le.key!==null?ie.set(le.key,le):ie.set(le.index,le),le=le.sibling;return ie}function m(le,ie){return le=vi(le,ie),le.index=0,le.sibling=null,le}function v(le,ie,he){return le.index=he,a?(he=le.alternate,he!==null?(he=he.index,he<ie?(le.flags|=67108866,ie):he):(le.flags|=67108866,ie)):(le.flags|=1048576,ie)}function b(le){return a&&le.alternate===null&&(le.flags|=67108866),le}function M(le,ie,he,Se){return ie===null||ie.tag!==6?(ie=Xd(he,le.mode,Se),ie.return=le,ie):(ie=m(ie,he),ie.return=le,ie)}function te(le,ie,he,Se){var qe=he.type;return qe===w?Ae(le,ie,he.props.children,Se,he.key):ie!==null&&(ie.elementType===qe||typeof qe=="object"&&qe!==null&&qe.$$typeof===A&&S_(qe)===ie.type)?(ie=m(ie,he.props),Qc(ie,he),ie.return=le,ie):(ie=th(he.type,he.key,he.props,null,le.mode,Se),Qc(ie,he),ie.return=le,ie)}function pe(le,ie,he,Se){return ie===null||ie.tag!==4||ie.stateNode.containerInfo!==he.containerInfo||ie.stateNode.implementation!==he.implementation?(ie=Yd(he,le.mode,Se),ie.return=le,ie):(ie=m(ie,he.children||[]),ie.return=le,ie)}function Ae(le,ie,he,Se,qe){return ie===null||ie.tag!==7?(ie=uo(he,le.mode,Se,qe),ie.return=le,ie):(ie=m(ie,he),ie.return=le,ie)}function Re(le,ie,he){if(typeof ie=="string"&&ie!==""||typeof ie=="number"||typeof ie=="bigint")return ie=Xd(""+ie,le.mode,he),ie.return=le,ie;if(typeof ie=="object"&&ie!==null){switch(ie.$$typeof){case x:return he=th(ie.type,ie.key,ie.props,null,le.mode,he),Qc(he,ie),he.return=le,he;case T:return ie=Yd(ie,le.mode,he),ie.return=le,ie;case A:var Se=ie._init;return ie=Se(ie._payload),Re(le,ie,he)}if(Ce(ie)||D(ie))return ie=uo(ie,le.mode,he,null),ie.return=le,ie;if(typeof ie.then=="function")return Re(le,_h(ie),he);if(ie.$$typeof===L)return Re(le,ih(le,ie),he);xh(le,ie)}return null}function ve(le,ie,he,Se){var qe=ie!==null?ie.key:null;if(typeof he=="string"&&he!==""||typeof he=="number"||typeof he=="bigint")return qe!==null?null:M(le,ie,""+he,Se);if(typeof he=="object"&&he!==null){switch(he.$$typeof){case x:return he.key===qe?te(le,ie,he,Se):null;case T:return he.key===qe?pe(le,ie,he,Se):null;case A:return qe=he._init,he=qe(he._payload),ve(le,ie,he,Se)}if(Ce(he)||D(he))return qe!==null?null:Ae(le,ie,he,Se,null);if(typeof he.then=="function")return ve(le,ie,_h(he),Se);if(he.$$typeof===L)return ve(le,ie,ih(le,he),Se);xh(le,he)}return null}function _e(le,ie,he,Se,qe){if(typeof Se=="string"&&Se!==""||typeof Se=="number"||typeof Se=="bigint")return le=le.get(he)||null,M(ie,le,""+Se,qe);if(typeof Se=="object"&&Se!==null){switch(Se.$$typeof){case x:return le=le.get(Se.key===null?he:Se.key)||null,te(ie,le,Se,qe);case T:return le=le.get(Se.key===null?he:Se.key)||null,pe(ie,le,Se,qe);case A:var gt=Se._init;return Se=gt(Se._payload),_e(le,ie,he,Se,qe)}if(Ce(Se)||D(Se))return le=le.get(he)||null,Ae(ie,le,Se,qe,null);if(typeof Se.then=="function")return _e(le,ie,he,_h(Se),qe);if(Se.$$typeof===L)return _e(le,ie,he,ih(ie,Se),qe);xh(ie,Se)}return null}function it(le,ie,he,Se){for(var qe=null,gt=null,Xe=ie,et=ie=0,zr=null;Xe!==null&&et<he.length;et++){Xe.index>et?(zr=Xe,Xe=null):zr=Xe.sibling;var Mt=ve(le,Xe,he[et],Se);if(Mt===null){Xe===null&&(Xe=zr);break}a&&Xe&&Mt.alternate===null&&s(le,Xe),ie=v(Mt,ie,et),gt===null?qe=Mt:gt.sibling=Mt,gt=Mt,Xe=zr}if(et===he.length)return l(le,Xe),Ut&&ho(le,et),qe;if(Xe===null){for(;et<he.length;et++)Xe=Re(le,he[et],Se),Xe!==null&&(ie=v(Xe,ie,et),gt===null?qe=Xe:gt.sibling=Xe,gt=Xe);return Ut&&ho(le,et),qe}for(Xe=f(Xe);et<he.length;et++)zr=_e(Xe,le,et,he[et],Se),zr!==null&&(a&&zr.alternate!==null&&Xe.delete(zr.key===null?et:zr.key),ie=v(zr,ie,et),gt===null?qe=zr:gt.sibling=zr,gt=zr);return a&&Xe.forEach(function(vs){return s(le,vs)}),Ut&&ho(le,et),qe}function Qe(le,ie,he,Se){if(he==null)throw Error(n(151));for(var qe=null,gt=null,Xe=ie,et=ie=0,zr=null,Mt=he.next();Xe!==null&&!Mt.done;et++,Mt=he.next()){Xe.index>et?(zr=Xe,Xe=null):zr=Xe.sibling;var vs=ve(le,Xe,Mt.value,Se);if(vs===null){Xe===null&&(Xe=zr);break}a&&Xe&&vs.alternate===null&&s(le,Xe),ie=v(vs,ie,et),gt===null?qe=vs:gt.sibling=vs,gt=vs,Xe=zr}if(Mt.done)return l(le,Xe),Ut&&ho(le,et),qe;if(Xe===null){for(;!Mt.done;et++,Mt=he.next())Mt=Re(le,Mt.value,Se),Mt!==null&&(ie=v(Mt,ie,et),gt===null?qe=Mt:gt.sibling=Mt,gt=Mt);return Ut&&ho(le,et),qe}for(Xe=f(Xe);!Mt.done;et++,Mt=he.next())Mt=_e(Xe,le,et,Mt.value,Se),Mt!==null&&(a&&Mt.alternate!==null&&Xe.delete(Mt.key===null?et:Mt.key),ie=v(Mt,ie,et),gt===null?qe=Mt:gt.sibling=Mt,gt=Mt);return a&&Xe.forEach(function(rR){return s(le,rR)}),Ut&&ho(le,et),qe}function Yt(le,ie,he,Se){if(typeof he=="object"&&he!==null&&he.type===w&&he.key===null&&(he=he.props.children),typeof he=="object"&&he!==null){switch(he.$$typeof){case x:e:{for(var qe=he.key;ie!==null;){if(ie.key===qe){if(qe=he.type,qe===w){if(ie.tag===7){l(le,ie.sibling),Se=m(ie,he.props.children),Se.return=le,le=Se;break e}}else if(ie.elementType===qe||typeof qe=="object"&&qe!==null&&qe.$$typeof===A&&S_(qe)===ie.type){l(le,ie.sibling),Se=m(ie,he.props),Qc(Se,he),Se.return=le,le=Se;break e}l(le,ie);break}else s(le,ie);ie=ie.sibling}he.type===w?(Se=uo(he.props.children,le.mode,Se,he.key),Se.return=le,le=Se):(Se=th(he.type,he.key,he.props,null,le.mode,Se),Qc(Se,he),Se.return=le,le=Se)}return b(le);case T:e:{for(qe=he.key;ie!==null;){if(ie.key===qe)if(ie.tag===4&&ie.stateNode.containerInfo===he.containerInfo&&ie.stateNode.implementation===he.implementation){l(le,ie.sibling),Se=m(ie,he.children||[]),Se.return=le,le=Se;break e}else{l(le,ie);break}else s(le,ie);ie=ie.sibling}Se=Yd(he,le.mode,Se),Se.return=le,le=Se}return b(le);case A:return qe=he._init,he=qe(he._payload),Yt(le,ie,he,Se)}if(Ce(he))return it(le,ie,he,Se);if(D(he)){if(qe=D(he),typeof qe!="function")throw Error(n(150));return he=qe.call(he),Qe(le,ie,he,Se)}if(typeof he.then=="function")return Yt(le,ie,_h(he),Se);if(he.$$typeof===L)return Yt(le,ie,ih(le,he),Se);xh(le,he)}return typeof he=="string"&&he!==""||typeof he=="number"||typeof he=="bigint"?(he=""+he,ie!==null&&ie.tag===6?(l(le,ie.sibling),Se=m(ie,he),Se.return=le,le=Se):(l(le,ie),Se=Xd(he,le.mode,Se),Se.return=le,le=Se),b(le)):l(le,ie)}return function(le,ie,he,Se){try{$c=0;var qe=Yt(le,ie,he,Se);return Rl=null,qe}catch(Xe){if(Xe===jc||Xe===oh)throw Xe;var gt=Un(29,Xe,null,le.mode);return gt.lanes=Se,gt.return=le,gt}finally{}}}var kl=C_(!0),R_=C_(!1),sa=se(null),Ka=null;function rs(a){var s=a.alternate;j(Or,Or.current&1),j(sa,a),Ka===null&&(s===null||Al.current!==null||s.memoizedState!==null)&&(Ka=a)}function k_(a){if(a.tag===22){if(j(Or,Or.current),j(sa,a),Ka===null){var s=a.alternate;s!==null&&s.memoizedState!==null&&(Ka=a)}}else ns()}function ns(){j(Or,Or.current),j(sa,sa.current)}function Ai(a){P(sa),Ka===a&&(Ka=null),P(Or)}var Or=se(0);function yh(a){for(var s=a;s!==null;){if(s.tag===13){var l=s.memoizedState;if(l!==null&&(l=l.dehydrated,l===null||l.data==="$?"||vm(l)))return s}else if(s.tag===19&&s.memoizedProps.revealOrder!==void 0){if((s.flags&128)!==0)return s}else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===a)break;for(;s.sibling===null;){if(s.return===null||s.return===a)return null;s=s.return}s.sibling.return=s.return,s=s.sibling}return null}function kp(a,s,l,f){s=a.memoizedState,l=l(f,s),l=l==null?s:g({},s,l),a.memoizedState=l,a.lanes===0&&(a.updateQueue.baseState=l)}var bp={enqueueSetState:function(a,s,l){a=a._reactInternals;var f=Hn(),m=Ji(f);m.payload=s,l!=null&&(m.callback=l),s=es(a,m,f),s!==null&&(Gn(s,a,f),Hc(s,a,f))},enqueueReplaceState:function(a,s,l){a=a._reactInternals;var f=Hn(),m=Ji(f);m.tag=1,m.payload=s,l!=null&&(m.callback=l),s=es(a,m,f),s!==null&&(Gn(s,a,f),Hc(s,a,f))},enqueueForceUpdate:function(a,s){a=a._reactInternals;var l=Hn(),f=Ji(l);f.tag=2,s!=null&&(f.callback=s),s=es(a,f,l),s!==null&&(Gn(s,a,l),Hc(s,a,l))}};function b_(a,s,l,f,m,v,b){return a=a.stateNode,typeof a.shouldComponentUpdate=="function"?a.shouldComponentUpdate(f,v,b):s.prototype&&s.prototype.isPureReactComponent?!Nc(l,f)||!Nc(m,v):!0}function I_(a,s,l,f){a=s.state,typeof s.componentWillReceiveProps=="function"&&s.componentWillReceiveProps(l,f),typeof s.UNSAFE_componentWillReceiveProps=="function"&&s.UNSAFE_componentWillReceiveProps(l,f),s.state!==a&&bp.enqueueReplaceState(s,s.state,null)}function yo(a,s){var l=s;if("ref"in s){l={};for(var f in s)f!=="ref"&&(l[f]=s[f])}if(a=a.defaultProps){l===s&&(l=g({},l));for(var m in a)l[m]===void 0&&(l[m]=a[m])}return l}var Eh=typeof reportError=="function"?reportError:function(a){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var s=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof a=="object"&&a!==null&&typeof a.message=="string"?String(a.message):String(a),error:a});if(!window.dispatchEvent(s))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",a);return}console.error(a)};function D_(a){Eh(a)}function O_(a){console.error(a)}function N_(a){Eh(a)}function Th(a,s){try{var l=a.onUncaughtError;l(s.value,{componentStack:s.stack})}catch(f){setTimeout(function(){throw f})}}function F_(a,s,l){try{var f=a.onCaughtError;f(l.value,{componentStack:l.stack,errorBoundary:s.tag===1?s.stateNode:null})}catch(m){setTimeout(function(){throw m})}}function Ip(a,s,l){return l=Ji(l),l.tag=3,l.payload={element:null},l.callback=function(){Th(a,s)},l}function P_(a){return a=Ji(a),a.tag=3,a}function M_(a,s,l,f){var m=l.type.getDerivedStateFromError;if(typeof m=="function"){var v=f.value;a.payload=function(){return m(v)},a.callback=function(){F_(s,l,f)}}var b=l.stateNode;b!==null&&typeof b.componentDidCatch=="function"&&(a.callback=function(){F_(s,l,f),typeof m!="function"&&(cs===null?cs=new Set([this]):cs.add(this));var M=f.stack;this.componentDidCatch(f.value,{componentStack:M!==null?M:""})})}function rC(a,s,l,f,m){if(l.flags|=32768,f!==null&&typeof f=="object"&&typeof f.then=="function"){if(s=l.alternate,s!==null&&Vc(s,l,m,!0),l=sa.current,l!==null){switch(l.tag){case 13:return Ka===null?em():l.alternate===null&&ur===0&&(ur=3),l.flags&=-257,l.flags|=65536,l.lanes=m,f===ip?l.flags|=16384:(s=l.updateQueue,s===null?l.updateQueue=new Set([f]):s.add(f),rm(a,f,m)),!1;case 22:return l.flags|=65536,f===ip?l.flags|=16384:(s=l.updateQueue,s===null?(s={transitions:null,markerInstances:null,retryQueue:new Set([f])},l.updateQueue=s):(l=s.retryQueue,l===null?s.retryQueue=new Set([f]):l.add(f)),rm(a,f,m)),!1}throw Error(n(435,l.tag))}return rm(a,f,m),em(),!1}if(Ut)return s=sa.current,s!==null?((s.flags&65536)===0&&(s.flags|=256),s.flags|=65536,s.lanes=m,f!==Zd&&(a=Error(n(422),{cause:f}),Lc(ra(a,l)))):(f!==Zd&&(s=Error(n(423),{cause:f}),Lc(ra(s,l))),a=a.current.alternate,a.flags|=65536,m&=-m,a.lanes|=m,f=ra(f,l),m=Ip(a.stateNode,f,m),lp(a,m),ur!==4&&(ur=2)),!1;var v=Error(n(520),{cause:f});if(v=ra(v,l),au===null?au=[v]:au.push(v),ur!==4&&(ur=2),s===null)return!0;f=ra(f,l),l=s;do{switch(l.tag){case 3:return l.flags|=65536,a=m&-m,l.lanes|=a,a=Ip(l.stateNode,f,a),lp(l,a),!1;case 1:if(s=l.type,v=l.stateNode,(l.flags&128)===0&&(typeof s.getDerivedStateFromError=="function"||v!==null&&typeof v.componentDidCatch=="function"&&(cs===null||!cs.has(v))))return l.flags|=65536,m&=-m,l.lanes|=m,m=P_(m),M_(m,a,l,f),lp(l,m),!1}l=l.return}while(l!==null);return!1}var L_=Error(n(461)),Br=!1;function Wr(a,s,l,f){s.child=a===null?R_(s,null,l,f):kl(s,a.child,l,f)}function V_(a,s,l,f,m){l=l.render;var v=s.ref;if("ref"in f){var b={};for(var M in f)M!=="ref"&&(b[M]=f[M])}else b=f;return vo(s),f=dp(a,s,l,b,v,m),M=pp(),a!==null&&!Br?(mp(a,s,m),wi(a,s,m)):(Ut&&M&&$d(s),s.flags|=1,Wr(a,s,f,m),s.child)}function U_(a,s,l,f,m){if(a===null){var v=l.type;return typeof v=="function"&&!Wd(v)&&v.defaultProps===void 0&&l.compare===null?(s.tag=15,s.type=v,B_(a,s,v,f,m)):(a=th(l.type,null,f,s,s.mode,m),a.ref=s.ref,a.return=s,s.child=a)}if(v=a.child,!Vp(a,m)){var b=v.memoizedProps;if(l=l.compare,l=l!==null?l:Nc,l(b,f)&&a.ref===s.ref)return wi(a,s,m)}return s.flags|=1,a=vi(v,f),a.ref=s.ref,a.return=s,s.child=a}function B_(a,s,l,f,m){if(a!==null){var v=a.memoizedProps;if(Nc(v,f)&&a.ref===s.ref)if(Br=!1,s.pendingProps=f=v,Vp(a,m))(a.flags&131072)!==0&&(Br=!0);else return s.lanes=a.lanes,wi(a,s,m)}return Dp(a,s,l,f,m)}function j_(a,s,l){var f=s.pendingProps,m=f.children,v=a!==null?a.memoizedState:null;if(f.mode==="hidden"){if((s.flags&128)!==0){if(f=v!==null?v.baseLanes|l:l,a!==null){for(m=s.child=a.child,v=0;m!==null;)v=v|m.lanes|m.childLanes,m=m.sibling;s.childLanes=v&~f}else s.childLanes=0,s.child=null;return z_(a,s,f,l)}if((l&536870912)!==0)s.memoizedState={baseLanes:0,cachePool:null},a!==null&&sh(s,v!==null?v.cachePool:null),v!==null?Bv(s,v):up(),k_(s);else return s.lanes=s.childLanes=536870912,z_(a,s,v!==null?v.baseLanes|l:l,l)}else v!==null?(sh(s,v.cachePool),Bv(s,v),ns(),s.memoizedState=null):(a!==null&&sh(s,null),up(),ns());return Wr(a,s,m,l),s.child}function z_(a,s,l,f){var m=ap();return m=m===null?null:{parent:Dr._currentValue,pool:m},s.memoizedState={baseLanes:l,cachePool:m},a!==null&&sh(s,null),up(),k_(s),a!==null&&Vc(a,s,f,!0),null}function Ah(a,s){var l=s.ref;if(l===null)a!==null&&a.ref!==null&&(s.flags|=4194816);else{if(typeof l!="function"&&typeof l!="object")throw Error(n(284));(a===null||a.ref!==l)&&(s.flags|=4194816)}}function Dp(a,s,l,f,m){return vo(s),l=dp(a,s,l,f,void 0,m),f=pp(),a!==null&&!Br?(mp(a,s,m),wi(a,s,m)):(Ut&&f&&$d(s),s.flags|=1,Wr(a,s,l,m),s.child)}function H_(a,s,l,f,m,v){return vo(s),s.updateQueue=null,l=zv(s,f,l,m),jv(a),f=pp(),a!==null&&!Br?(mp(a,s,v),wi(a,s,v)):(Ut&&f&&$d(s),s.flags|=1,Wr(a,s,l,v),s.child)}function G_(a,s,l,f,m){if(vo(s),s.stateNode===null){var v=_l,b=l.contextType;typeof b=="object"&&b!==null&&(v=nn(b)),v=new l(f,v),s.memoizedState=v.state!==null&&v.state!==void 0?v.state:null,v.updater=bp,s.stateNode=v,v._reactInternals=s,v=s.stateNode,v.props=f,v.state=s.memoizedState,v.refs={},sp(s),b=l.contextType,v.context=typeof b=="object"&&b!==null?nn(b):_l,v.state=s.memoizedState,b=l.getDerivedStateFromProps,typeof b=="function"&&(kp(s,l,b,f),v.state=s.memoizedState),typeof l.getDerivedStateFromProps=="function"||typeof v.getSnapshotBeforeUpdate=="function"||typeof v.UNSAFE_componentWillMount!="function"&&typeof v.componentWillMount!="function"||(b=v.state,typeof v.componentWillMount=="function"&&v.componentWillMount(),typeof v.UNSAFE_componentWillMount=="function"&&v.UNSAFE_componentWillMount(),b!==v.state&&bp.enqueueReplaceState(v,v.state,null),qc(s,f,v,m),Gc(),v.state=s.memoizedState),typeof v.componentDidMount=="function"&&(s.flags|=4194308),f=!0}else if(a===null){v=s.stateNode;var M=s.memoizedProps,te=yo(l,M);v.props=te;var pe=v.context,Ae=l.contextType;b=_l,typeof Ae=="object"&&Ae!==null&&(b=nn(Ae));var Re=l.getDerivedStateFromProps;Ae=typeof Re=="function"||typeof v.getSnapshotBeforeUpdate=="function",M=s.pendingProps!==M,Ae||typeof v.UNSAFE_componentWillReceiveProps!="function"&&typeof v.componentWillReceiveProps!="function"||(M||pe!==b)&&I_(s,v,f,b),Zi=!1;var ve=s.memoizedState;v.state=ve,qc(s,f,v,m),Gc(),pe=s.memoizedState,M||ve!==pe||Zi?(typeof Re=="function"&&(kp(s,l,Re,f),pe=s.memoizedState),(te=Zi||b_(s,l,te,f,ve,pe,b))?(Ae||typeof v.UNSAFE_componentWillMount!="function"&&typeof v.componentWillMount!="function"||(typeof v.componentWillMount=="function"&&v.componentWillMount(),typeof v.UNSAFE_componentWillMount=="function"&&v.UNSAFE_componentWillMount()),typeof v.componentDidMount=="function"&&(s.flags|=4194308)):(typeof v.componentDidMount=="function"&&(s.flags|=4194308),s.memoizedProps=f,s.memoizedState=pe),v.props=f,v.state=pe,v.context=b,f=te):(typeof v.componentDidMount=="function"&&(s.flags|=4194308),f=!1)}else{v=s.stateNode,op(a,s),b=s.memoizedProps,Ae=yo(l,b),v.props=Ae,Re=s.pendingProps,ve=v.context,pe=l.contextType,te=_l,typeof pe=="object"&&pe!==null&&(te=nn(pe)),M=l.getDerivedStateFromProps,(pe=typeof M=="function"||typeof v.getSnapshotBeforeUpdate=="function")||typeof v.UNSAFE_componentWillReceiveProps!="function"&&typeof v.componentWillReceiveProps!="function"||(b!==Re||ve!==te)&&I_(s,v,f,te),Zi=!1,ve=s.memoizedState,v.state=ve,qc(s,f,v,m),Gc();var _e=s.memoizedState;b!==Re||ve!==_e||Zi||a!==null&&a.dependencies!==null&&ah(a.dependencies)?(typeof M=="function"&&(kp(s,l,M,f),_e=s.memoizedState),(Ae=Zi||b_(s,l,Ae,f,ve,_e,te)||a!==null&&a.dependencies!==null&&ah(a.dependencies))?(pe||typeof v.UNSAFE_componentWillUpdate!="function"&&typeof v.componentWillUpdate!="function"||(typeof v.componentWillUpdate=="function"&&v.componentWillUpdate(f,_e,te),typeof v.UNSAFE_componentWillUpdate=="function"&&v.UNSAFE_componentWillUpdate(f,_e,te)),typeof v.componentDidUpdate=="function"&&(s.flags|=4),typeof v.getSnapshotBeforeUpdate=="function"&&(s.flags|=1024)):(typeof v.componentDidUpdate!="function"||b===a.memoizedProps&&ve===a.memoizedState||(s.flags|=4),typeof v.getSnapshotBeforeUpdate!="function"||b===a.memoizedProps&&ve===a.memoizedState||(s.flags|=1024),s.memoizedProps=f,s.memoizedState=_e),v.props=f,v.state=_e,v.context=te,f=Ae):(typeof v.componentDidUpdate!="function"||b===a.memoizedProps&&ve===a.memoizedState||(s.flags|=4),typeof v.getSnapshotBeforeUpdate!="function"||b===a.memoizedProps&&ve===a.memoizedState||(s.flags|=1024),f=!1)}return v=f,Ah(a,s),f=(s.flags&128)!==0,v||f?(v=s.stateNode,l=f&&typeof l.getDerivedStateFromError!="function"?null:v.render(),s.flags|=1,a!==null&&f?(s.child=kl(s,a.child,null,m),s.child=kl(s,null,l,m)):Wr(a,s,l,m),s.memoizedState=v.state,a=s.child):a=wi(a,s,m),a}function q_(a,s,l,f){return Mc(),s.flags|=256,Wr(a,s,l,f),s.child}var Op={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Np(a){return{baseLanes:a,cachePool:Ov()}}function Fp(a,s,l){return a=a!==null?a.childLanes&~l:0,s&&(a|=oa),a}function K_(a,s,l){var f=s.pendingProps,m=!1,v=(s.flags&128)!==0,b;if((b=v)||(b=a!==null&&a.memoizedState===null?!1:(Or.current&2)!==0),b&&(m=!0,s.flags&=-129),b=(s.flags&32)!==0,s.flags&=-33,a===null){if(Ut){if(m?rs(s):ns(),Ut){var M=cr,te;if(te=M){e:{for(te=M,M=qa;te.nodeType!==8;){if(!M){M=null;break e}if(te=Aa(te.nextSibling),te===null){M=null;break e}}M=te}M!==null?(s.memoizedState={dehydrated:M,treeContext:fo!==null?{id:_i,overflow:xi}:null,retryLane:536870912,hydrationErrors:null},te=Un(18,null,null,0),te.stateNode=M,te.return=s,s.child=te,En=s,cr=null,te=!0):te=!1}te||mo(s)}if(M=s.memoizedState,M!==null&&(M=M.dehydrated,M!==null))return vm(M)?s.lanes=32:s.lanes=536870912,null;Ai(s)}return M=f.children,f=f.fallback,m?(ns(),m=s.mode,M=wh({mode:"hidden",children:M},m),f=uo(f,m,l,null),M.return=s,f.return=s,M.sibling=f,s.child=M,m=s.child,m.memoizedState=Np(l),m.childLanes=Fp(a,b,l),s.memoizedState=Op,f):(rs(s),Pp(s,M))}if(te=a.memoizedState,te!==null&&(M=te.dehydrated,M!==null)){if(v)s.flags&256?(rs(s),s.flags&=-257,s=Mp(a,s,l)):s.memoizedState!==null?(ns(),s.child=a.child,s.flags|=128,s=null):(ns(),m=f.fallback,M=s.mode,f=wh({mode:"visible",children:f.children},M),m=uo(m,M,l,null),m.flags|=2,f.return=s,m.return=s,f.sibling=m,s.child=f,kl(s,a.child,null,l),f=s.child,f.memoizedState=Np(l),f.childLanes=Fp(a,b,l),s.memoizedState=Op,s=m);else if(rs(s),vm(M)){if(b=M.nextSibling&&M.nextSibling.dataset,b)var pe=b.dgst;b=pe,f=Error(n(419)),f.stack="",f.digest=b,Lc({value:f,source:null,stack:null}),s=Mp(a,s,l)}else if(Br||Vc(a,s,l,!1),b=(l&a.childLanes)!==0,Br||b){if(b=Zt,b!==null&&(f=l&-l,f=(f&42)!==0?1:Fa(f),f=(f&(b.suspendedLanes|l))!==0?0:f,f!==0&&f!==te.retryLane))throw te.retryLane=f,vl(a,f),Gn(b,a,f),L_;M.data==="$?"||em(),s=Mp(a,s,l)}else M.data==="$?"?(s.flags|=192,s.child=a.child,s=null):(a=te.treeContext,cr=Aa(M.nextSibling),En=s,Ut=!0,po=null,qa=!1,a!==null&&(aa[ia++]=_i,aa[ia++]=xi,aa[ia++]=fo,_i=a.id,xi=a.overflow,fo=s),s=Pp(s,f.children),s.flags|=4096);return s}return m?(ns(),m=f.fallback,M=s.mode,te=a.child,pe=te.sibling,f=vi(te,{mode:"hidden",children:f.children}),f.subtreeFlags=te.subtreeFlags&65011712,pe!==null?m=vi(pe,m):(m=uo(m,M,l,null),m.flags|=2),m.return=s,f.return=s,f.sibling=m,s.child=f,f=m,m=s.child,M=a.child.memoizedState,M===null?M=Np(l):(te=M.cachePool,te!==null?(pe=Dr._currentValue,te=te.parent!==pe?{parent:pe,pool:pe}:te):te=Ov(),M={baseLanes:M.baseLanes|l,cachePool:te}),m.memoizedState=M,m.childLanes=Fp(a,b,l),s.memoizedState=Op,f):(rs(s),l=a.child,a=l.sibling,l=vi(l,{mode:"visible",children:f.children}),l.return=s,l.sibling=null,a!==null&&(b=s.deletions,b===null?(s.deletions=[a],s.flags|=16):b.push(a)),s.child=l,s.memoizedState=null,l)}function Pp(a,s){return s=wh({mode:"visible",children:s},a.mode),s.return=a,a.child=s}function wh(a,s){return a=Un(22,a,null,s),a.lanes=0,a.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},a}function Mp(a,s,l){return kl(s,a.child,null,l),a=Pp(s,s.pendingProps.children),a.flags|=2,s.memoizedState=null,a}function W_(a,s,l){a.lanes|=s;var f=a.alternate;f!==null&&(f.lanes|=s),ep(a.return,s,l)}function Lp(a,s,l,f,m){var v=a.memoizedState;v===null?a.memoizedState={isBackwards:s,rendering:null,renderingStartTime:0,last:f,tail:l,tailMode:m}:(v.isBackwards=s,v.rendering=null,v.renderingStartTime=0,v.last=f,v.tail=l,v.tailMode=m)}function X_(a,s,l){var f=s.pendingProps,m=f.revealOrder,v=f.tail;if(Wr(a,s,f.children,l),f=Or.current,(f&2)!==0)f=f&1|2,s.flags|=128;else{if(a!==null&&(a.flags&128)!==0)e:for(a=s.child;a!==null;){if(a.tag===13)a.memoizedState!==null&&W_(a,l,s);else if(a.tag===19)W_(a,l,s);else if(a.child!==null){a.child.return=a,a=a.child;continue}if(a===s)break e;for(;a.sibling===null;){if(a.return===null||a.return===s)break e;a=a.return}a.sibling.return=a.return,a=a.sibling}f&=1}switch(j(Or,f),m){case"forwards":for(l=s.child,m=null;l!==null;)a=l.alternate,a!==null&&yh(a)===null&&(m=l),l=l.sibling;l=m,l===null?(m=s.child,s.child=null):(m=l.sibling,l.sibling=null),Lp(s,!1,m,l,v);break;case"backwards":for(l=null,m=s.child,s.child=null;m!==null;){if(a=m.alternate,a!==null&&yh(a)===null){s.child=m;break}a=m.sibling,m.sibling=l,l=m,m=a}Lp(s,!0,l,null,v);break;case"together":Lp(s,!1,null,null,void 0);break;default:s.memoizedState=null}return s.child}function wi(a,s,l){if(a!==null&&(s.dependencies=a.dependencies),ls|=s.lanes,(l&s.childLanes)===0)if(a!==null){if(Vc(a,s,l,!1),(l&s.childLanes)===0)return null}else return null;if(a!==null&&s.child!==a.child)throw Error(n(153));if(s.child!==null){for(a=s.child,l=vi(a,a.pendingProps),s.child=l,l.return=s;a.sibling!==null;)a=a.sibling,l=l.sibling=vi(a,a.pendingProps),l.return=s;l.sibling=null}return s.child}function Vp(a,s){return(a.lanes&s)!==0?!0:(a=a.dependencies,!!(a!==null&&ah(a)))}function nC(a,s,l){switch(s.tag){case 3:Ee(s,s.stateNode.containerInfo),Qi(s,Dr,a.memoizedState.cache),Mc();break;case 27:case 5:Te(s);break;case 4:Ee(s,s.stateNode.containerInfo);break;case 10:Qi(s,s.type,s.memoizedProps.value);break;case 13:var f=s.memoizedState;if(f!==null)return f.dehydrated!==null?(rs(s),s.flags|=128,null):(l&s.child.childLanes)!==0?K_(a,s,l):(rs(s),a=wi(a,s,l),a!==null?a.sibling:null);rs(s);break;case 19:var m=(a.flags&128)!==0;if(f=(l&s.childLanes)!==0,f||(Vc(a,s,l,!1),f=(l&s.childLanes)!==0),m){if(f)return X_(a,s,l);s.flags|=128}if(m=s.memoizedState,m!==null&&(m.rendering=null,m.tail=null,m.lastEffect=null),j(Or,Or.current),f)break;return null;case 22:case 23:return s.lanes=0,j_(a,s,l);case 24:Qi(s,Dr,a.memoizedState.cache)}return wi(a,s,l)}function Y_(a,s,l){if(a!==null)if(a.memoizedProps!==s.pendingProps)Br=!0;else{if(!Vp(a,l)&&(s.flags&128)===0)return Br=!1,nC(a,s,l);Br=(a.flags&131072)!==0}else Br=!1,Ut&&(s.flags&1048576)!==0&&Sv(s,nh,s.index);switch(s.lanes=0,s.tag){case 16:e:{a=s.pendingProps;var f=s.elementType,m=f._init;if(f=m(f._payload),s.type=f,typeof f=="function")Wd(f)?(a=yo(f,a),s.tag=1,s=G_(null,s,f,a,l)):(s.tag=0,s=Dp(null,s,f,a,l));else{if(f!=null){if(m=f.$$typeof,m===K){s.tag=11,s=V_(null,s,f,a,l);break e}else if(m===k){s.tag=14,s=U_(null,s,f,a,l);break e}}throw s=Fe(f)||f,Error(n(306,s,""))}}return s;case 0:return Dp(a,s,s.type,s.pendingProps,l);case 1:return f=s.type,m=yo(f,s.pendingProps),G_(a,s,f,m,l);case 3:e:{if(Ee(s,s.stateNode.containerInfo),a===null)throw Error(n(387));f=s.pendingProps;var v=s.memoizedState;m=v.element,op(a,s),qc(s,f,null,l);var b=s.memoizedState;if(f=b.cache,Qi(s,Dr,f),f!==v.cache&&tp(s,[Dr],l,!0),Gc(),f=b.element,v.isDehydrated)if(v={element:f,isDehydrated:!1,cache:b.cache},s.updateQueue.baseState=v,s.memoizedState=v,s.flags&256){s=q_(a,s,f,l);break e}else if(f!==m){m=ra(Error(n(424)),s),Lc(m),s=q_(a,s,f,l);break e}else{switch(a=s.stateNode.containerInfo,a.nodeType){case 9:a=a.body;break;default:a=a.nodeName==="HTML"?a.ownerDocument.body:a}for(cr=Aa(a.firstChild),En=s,Ut=!0,po=null,qa=!0,l=R_(s,null,f,l),s.child=l;l;)l.flags=l.flags&-3|4096,l=l.sibling}else{if(Mc(),f===m){s=wi(a,s,l);break e}Wr(a,s,f,l)}s=s.child}return s;case 26:return Ah(a,s),a===null?(l=Jx(s.type,null,s.pendingProps,null))?s.memoizedState=l:Ut||(l=s.type,a=s.pendingProps,f=Vh(ue.current).createElement(l),f[dr]=s,f[nr]=a,Yr(f,l,a),ce(f),s.stateNode=f):s.memoizedState=Jx(s.type,a.memoizedProps,s.pendingProps,a.memoizedState),null;case 27:return Te(s),a===null&&Ut&&(f=s.stateNode=$x(s.type,s.pendingProps,ue.current),En=s,qa=!0,m=cr,hs(s.type)?(_m=m,cr=Aa(f.firstChild)):cr=m),Wr(a,s,s.pendingProps.children,l),Ah(a,s),a===null&&(s.flags|=4194304),s.child;case 5:return a===null&&Ut&&((m=f=cr)&&(f=DC(f,s.type,s.pendingProps,qa),f!==null?(s.stateNode=f,En=s,cr=Aa(f.firstChild),qa=!1,m=!0):m=!1),m||mo(s)),Te(s),m=s.type,v=s.pendingProps,b=a!==null?a.memoizedProps:null,f=v.children,pm(m,v)?f=null:b!==null&&pm(m,b)&&(s.flags|=32),s.memoizedState!==null&&(m=dp(a,s,Y4,null,null,l),du._currentValue=m),Ah(a,s),Wr(a,s,f,l),s.child;case 6:return a===null&&Ut&&((a=l=cr)&&(l=OC(l,s.pendingProps,qa),l!==null?(s.stateNode=l,En=s,cr=null,a=!0):a=!1),a||mo(s)),null;case 13:return K_(a,s,l);case 4:return Ee(s,s.stateNode.containerInfo),f=s.pendingProps,a===null?s.child=kl(s,null,f,l):Wr(a,s,f,l),s.child;case 11:return V_(a,s,s.type,s.pendingProps,l);case 7:return Wr(a,s,s.pendingProps,l),s.child;case 8:return Wr(a,s,s.pendingProps.children,l),s.child;case 12:return Wr(a,s,s.pendingProps.children,l),s.child;case 10:return f=s.pendingProps,Qi(s,s.type,f.value),Wr(a,s,f.children,l),s.child;case 9:return m=s.type._context,f=s.pendingProps.children,vo(s),m=nn(m),f=f(m),s.flags|=1,Wr(a,s,f,l),s.child;case 14:return U_(a,s,s.type,s.pendingProps,l);case 15:return B_(a,s,s.type,s.pendingProps,l);case 19:return X_(a,s,l);case 31:return f=s.pendingProps,l=s.mode,f={mode:f.mode,children:f.children},a===null?(l=wh(f,l),l.ref=s.ref,s.child=l,l.return=s,s=l):(l=vi(a.child,f),l.ref=s.ref,s.child=l,l.return=s,s=l),s;case 22:return j_(a,s,l);case 24:return vo(s),f=nn(Dr),a===null?(m=ap(),m===null&&(m=Zt,v=rp(),m.pooledCache=v,v.refCount++,v!==null&&(m.pooledCacheLanes|=l),m=v),s.memoizedState={parent:f,cache:m},sp(s),Qi(s,Dr,m)):((a.lanes&l)!==0&&(op(a,s),qc(s,null,null,l),Gc()),m=a.memoizedState,v=s.memoizedState,m.parent!==f?(m={parent:f,cache:f},s.memoizedState=m,s.lanes===0&&(s.memoizedState=s.updateQueue.baseState=m),Qi(s,Dr,f)):(f=v.cache,Qi(s,Dr,f),f!==m.cache&&tp(s,[Dr],l,!0))),Wr(a,s,s.pendingProps.children,l),s.child;case 29:throw s.pendingProps}throw Error(n(156,s.tag))}function Si(a){a.flags|=4}function $_(a,s){if(s.type!=="stylesheet"||(s.state.loading&4)!==0)a.flags&=-16777217;else if(a.flags|=16777216,!ay(s)){if(s=sa.current,s!==null&&((bt&4194048)===bt?Ka!==null:(bt&62914560)!==bt&&(bt&536870912)===0||s!==Ka))throw zc=ip,Nv;a.flags|=8192}}function Sh(a,s){s!==null&&(a.flags|=4),a.flags&16384&&(s=a.tag!==22?Wi():536870912,a.lanes|=s,Ol|=s)}function Zc(a,s){if(!Ut)switch(a.tailMode){case"hidden":s=a.tail;for(var l=null;s!==null;)s.alternate!==null&&(l=s),s=s.sibling;l===null?a.tail=null:l.sibling=null;break;case"collapsed":l=a.tail;for(var f=null;l!==null;)l.alternate!==null&&(f=l),l=l.sibling;f===null?s||a.tail===null?a.tail=null:a.tail.sibling=null:f.sibling=null}}function sr(a){var s=a.alternate!==null&&a.alternate.child===a.child,l=0,f=0;if(s)for(var m=a.child;m!==null;)l|=m.lanes|m.childLanes,f|=m.subtreeFlags&65011712,f|=m.flags&65011712,m.return=a,m=m.sibling;else for(m=a.child;m!==null;)l|=m.lanes|m.childLanes,f|=m.subtreeFlags,f|=m.flags,m.return=a,m=m.sibling;return a.subtreeFlags|=f,a.childLanes=l,s}function aC(a,s,l){var f=s.pendingProps;switch(Qd(s),s.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return sr(s),null;case 1:return sr(s),null;case 3:return l=s.stateNode,f=null,a!==null&&(f=a.memoizedState.cache),s.memoizedState.cache!==f&&(s.flags|=2048),Ei(Dr),we(),l.pendingContext&&(l.context=l.pendingContext,l.pendingContext=null),(a===null||a.child===null)&&(Pc(s)?Si(s):a===null||a.memoizedState.isDehydrated&&(s.flags&256)===0||(s.flags|=1024,kv())),sr(s),null;case 26:return l=s.memoizedState,a===null?(Si(s),l!==null?(sr(s),$_(s,l)):(sr(s),s.flags&=-16777217)):l?l!==a.memoizedState?(Si(s),sr(s),$_(s,l)):(sr(s),s.flags&=-16777217):(a.memoizedProps!==f&&Si(s),sr(s),s.flags&=-16777217),null;case 27:Ue(s),l=ue.current;var m=s.type;if(a!==null&&s.stateNode!=null)a.memoizedProps!==f&&Si(s);else{if(!f){if(s.stateNode===null)throw Error(n(166));return sr(s),null}a=J.current,Pc(s)?Cv(s):(a=$x(m,f,l),s.stateNode=a,Si(s))}return sr(s),null;case 5:if(Ue(s),l=s.type,a!==null&&s.stateNode!=null)a.memoizedProps!==f&&Si(s);else{if(!f){if(s.stateNode===null)throw Error(n(166));return sr(s),null}if(a=J.current,Pc(s))Cv(s);else{switch(m=Vh(ue.current),a){case 1:a=m.createElementNS("http://www.w3.org/2000/svg",l);break;case 2:a=m.createElementNS("http://www.w3.org/1998/Math/MathML",l);break;default:switch(l){case"svg":a=m.createElementNS("http://www.w3.org/2000/svg",l);break;case"math":a=m.createElementNS("http://www.w3.org/1998/Math/MathML",l);break;case"script":a=m.createElement("div"),a.innerHTML="<script><\/script>",a=a.removeChild(a.firstChild);break;case"select":a=typeof f.is=="string"?m.createElement("select",{is:f.is}):m.createElement("select"),f.multiple?a.multiple=!0:f.size&&(a.size=f.size);break;default:a=typeof f.is=="string"?m.createElement(l,{is:f.is}):m.createElement(l)}}a[dr]=s,a[nr]=f;e:for(m=s.child;m!==null;){if(m.tag===5||m.tag===6)a.appendChild(m.stateNode);else if(m.tag!==4&&m.tag!==27&&m.child!==null){m.child.return=m,m=m.child;continue}if(m===s)break e;for(;m.sibling===null;){if(m.return===null||m.return===s)break e;m=m.return}m.sibling.return=m.return,m=m.sibling}s.stateNode=a;e:switch(Yr(a,l,f),l){case"button":case"input":case"select":case"textarea":a=!!f.autoFocus;break e;case"img":a=!0;break e;default:a=!1}a&&Si(s)}}return sr(s),s.flags&=-16777217,null;case 6:if(a&&s.stateNode!=null)a.memoizedProps!==f&&Si(s);else{if(typeof f!="string"&&s.stateNode===null)throw Error(n(166));if(a=ue.current,Pc(s)){if(a=s.stateNode,l=s.memoizedProps,f=null,m=En,m!==null)switch(m.tag){case 27:case 5:f=m.memoizedProps}a[dr]=s,a=!!(a.nodeValue===l||f!==null&&f.suppressHydrationWarning===!0||Hx(a.nodeValue,l)),a||mo(s)}else a=Vh(a).createTextNode(f),a[dr]=s,s.stateNode=a}return sr(s),null;case 13:if(f=s.memoizedState,a===null||a.memoizedState!==null&&a.memoizedState.dehydrated!==null){if(m=Pc(s),f!==null&&f.dehydrated!==null){if(a===null){if(!m)throw Error(n(318));if(m=s.memoizedState,m=m!==null?m.dehydrated:null,!m)throw Error(n(317));m[dr]=s}else Mc(),(s.flags&128)===0&&(s.memoizedState=null),s.flags|=4;sr(s),m=!1}else m=kv(),a!==null&&a.memoizedState!==null&&(a.memoizedState.hydrationErrors=m),m=!0;if(!m)return s.flags&256?(Ai(s),s):(Ai(s),null)}if(Ai(s),(s.flags&128)!==0)return s.lanes=l,s;if(l=f!==null,a=a!==null&&a.memoizedState!==null,l){f=s.child,m=null,f.alternate!==null&&f.alternate.memoizedState!==null&&f.alternate.memoizedState.cachePool!==null&&(m=f.alternate.memoizedState.cachePool.pool);var v=null;f.memoizedState!==null&&f.memoizedState.cachePool!==null&&(v=f.memoizedState.cachePool.pool),v!==m&&(f.flags|=2048)}return l!==a&&l&&(s.child.flags|=8192),Sh(s,s.updateQueue),sr(s),null;case 4:return we(),a===null&&cm(s.stateNode.containerInfo),sr(s),null;case 10:return Ei(s.type),sr(s),null;case 19:if(P(Or),m=s.memoizedState,m===null)return sr(s),null;if(f=(s.flags&128)!==0,v=m.rendering,v===null)if(f)Zc(m,!1);else{if(ur!==0||a!==null&&(a.flags&128)!==0)for(a=s.child;a!==null;){if(v=yh(a),v!==null){for(s.flags|=128,Zc(m,!1),a=v.updateQueue,s.updateQueue=a,Sh(s,a),s.subtreeFlags=0,a=l,l=s.child;l!==null;)wv(l,a),l=l.sibling;return j(Or,Or.current&1|2),s.child}a=a.sibling}m.tail!==null&&Ne()>kh&&(s.flags|=128,f=!0,Zc(m,!1),s.lanes=4194304)}else{if(!f)if(a=yh(v),a!==null){if(s.flags|=128,f=!0,a=a.updateQueue,s.updateQueue=a,Sh(s,a),Zc(m,!0),m.tail===null&&m.tailMode==="hidden"&&!v.alternate&&!Ut)return sr(s),null}else 2*Ne()-m.renderingStartTime>kh&&l!==536870912&&(s.flags|=128,f=!0,Zc(m,!1),s.lanes=4194304);m.isBackwards?(v.sibling=s.child,s.child=v):(a=m.last,a!==null?a.sibling=v:s.child=v,m.last=v)}return m.tail!==null?(s=m.tail,m.rendering=s,m.tail=s.sibling,m.renderingStartTime=Ne(),s.sibling=null,a=Or.current,j(Or,f?a&1|2:a&1),s):(sr(s),null);case 22:case 23:return Ai(s),fp(),f=s.memoizedState!==null,a!==null?a.memoizedState!==null!==f&&(s.flags|=8192):f&&(s.flags|=8192),f?(l&536870912)!==0&&(s.flags&128)===0&&(sr(s),s.subtreeFlags&6&&(s.flags|=8192)):sr(s),l=s.updateQueue,l!==null&&Sh(s,l.retryQueue),l=null,a!==null&&a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(l=a.memoizedState.cachePool.pool),f=null,s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(f=s.memoizedState.cachePool.pool),f!==l&&(s.flags|=2048),a!==null&&P(_o),null;case 24:return l=null,a!==null&&(l=a.memoizedState.cache),s.memoizedState.cache!==l&&(s.flags|=2048),Ei(Dr),sr(s),null;case 25:return null;case 30:return null}throw Error(n(156,s.tag))}function iC(a,s){switch(Qd(s),s.tag){case 1:return a=s.flags,a&65536?(s.flags=a&-65537|128,s):null;case 3:return Ei(Dr),we(),a=s.flags,(a&65536)!==0&&(a&128)===0?(s.flags=a&-65537|128,s):null;case 26:case 27:case 5:return Ue(s),null;case 13:if(Ai(s),a=s.memoizedState,a!==null&&a.dehydrated!==null){if(s.alternate===null)throw Error(n(340));Mc()}return a=s.flags,a&65536?(s.flags=a&-65537|128,s):null;case 19:return P(Or),null;case 4:return we(),null;case 10:return Ei(s.type),null;case 22:case 23:return Ai(s),fp(),a!==null&&P(_o),a=s.flags,a&65536?(s.flags=a&-65537|128,s):null;case 24:return Ei(Dr),null;case 25:return null;default:return null}}function Q_(a,s){switch(Qd(s),s.tag){case 3:Ei(Dr),we();break;case 26:case 27:case 5:Ue(s);break;case 4:we();break;case 13:Ai(s);break;case 19:P(Or);break;case 10:Ei(s.type);break;case 22:case 23:Ai(s),fp(),a!==null&&P(_o);break;case 24:Ei(Dr)}}function Jc(a,s){try{var l=s.updateQueue,f=l!==null?l.lastEffect:null;if(f!==null){var m=f.next;l=m;do{if((l.tag&a)===a){f=void 0;var v=l.create,b=l.inst;f=v(),b.destroy=f}l=l.next}while(l!==m)}}catch(M){$t(s,s.return,M)}}function as(a,s,l){try{var f=s.updateQueue,m=f!==null?f.lastEffect:null;if(m!==null){var v=m.next;f=v;do{if((f.tag&a)===a){var b=f.inst,M=b.destroy;if(M!==void 0){b.destroy=void 0,m=s;var te=l,pe=M;try{pe()}catch(Ae){$t(m,te,Ae)}}}f=f.next}while(f!==v)}}catch(Ae){$t(s,s.return,Ae)}}function Z_(a){var s=a.updateQueue;if(s!==null){var l=a.stateNode;try{Uv(s,l)}catch(f){$t(a,a.return,f)}}}function J_(a,s,l){l.props=yo(a.type,a.memoizedProps),l.state=a.memoizedState;try{l.componentWillUnmount()}catch(f){$t(a,s,f)}}function eu(a,s){try{var l=a.ref;if(l!==null){switch(a.tag){case 26:case 27:case 5:var f=a.stateNode;break;case 30:f=a.stateNode;break;default:f=a.stateNode}typeof l=="function"?a.refCleanup=l(f):l.current=f}}catch(m){$t(a,s,m)}}function Wa(a,s){var l=a.ref,f=a.refCleanup;if(l!==null)if(typeof f=="function")try{f()}catch(m){$t(a,s,m)}finally{a.refCleanup=null,a=a.alternate,a!=null&&(a.refCleanup=null)}else if(typeof l=="function")try{l(null)}catch(m){$t(a,s,m)}else l.current=null}function ex(a){var s=a.type,l=a.memoizedProps,f=a.stateNode;try{e:switch(s){case"button":case"input":case"select":case"textarea":l.autoFocus&&f.focus();break e;case"img":l.src?f.src=l.src:l.srcSet&&(f.srcset=l.srcSet)}}catch(m){$t(a,a.return,m)}}function Up(a,s,l){try{var f=a.stateNode;CC(f,a.type,l,s),f[nr]=s}catch(m){$t(a,a.return,m)}}function tx(a){return a.tag===5||a.tag===3||a.tag===26||a.tag===27&&hs(a.type)||a.tag===4}function Bp(a){e:for(;;){for(;a.sibling===null;){if(a.return===null||tx(a.return))return null;a=a.return}for(a.sibling.return=a.return,a=a.sibling;a.tag!==5&&a.tag!==6&&a.tag!==18;){if(a.tag===27&&hs(a.type)||a.flags&2||a.child===null||a.tag===4)continue e;a.child.return=a,a=a.child}if(!(a.flags&2))return a.stateNode}}function jp(a,s,l){var f=a.tag;if(f===5||f===6)a=a.stateNode,s?(l.nodeType===9?l.body:l.nodeName==="HTML"?l.ownerDocument.body:l).insertBefore(a,s):(s=l.nodeType===9?l.body:l.nodeName==="HTML"?l.ownerDocument.body:l,s.appendChild(a),l=l._reactRootContainer,l!=null||s.onclick!==null||(s.onclick=Lh));else if(f!==4&&(f===27&&hs(a.type)&&(l=a.stateNode,s=null),a=a.child,a!==null))for(jp(a,s,l),a=a.sibling;a!==null;)jp(a,s,l),a=a.sibling}function Ch(a,s,l){var f=a.tag;if(f===5||f===6)a=a.stateNode,s?l.insertBefore(a,s):l.appendChild(a);else if(f!==4&&(f===27&&hs(a.type)&&(l=a.stateNode),a=a.child,a!==null))for(Ch(a,s,l),a=a.sibling;a!==null;)Ch(a,s,l),a=a.sibling}function rx(a){var s=a.stateNode,l=a.memoizedProps;try{for(var f=a.type,m=s.attributes;m.length;)s.removeAttributeNode(m[0]);Yr(s,f,l),s[dr]=a,s[nr]=l}catch(v){$t(a,a.return,v)}}var Ci=!1,mr=!1,zp=!1,nx=typeof WeakSet=="function"?WeakSet:Set,jr=null;function sC(a,s){if(a=a.containerInfo,hm=Gh,a=pv(a),Bd(a)){if("selectionStart"in a)var l={start:a.selectionStart,end:a.selectionEnd};else e:{l=(l=a.ownerDocument)&&l.defaultView||window;var f=l.getSelection&&l.getSelection();if(f&&f.rangeCount!==0){l=f.anchorNode;var m=f.anchorOffset,v=f.focusNode;f=f.focusOffset;try{l.nodeType,v.nodeType}catch{l=null;break e}var b=0,M=-1,te=-1,pe=0,Ae=0,Re=a,ve=null;t:for(;;){for(var _e;Re!==l||m!==0&&Re.nodeType!==3||(M=b+m),Re!==v||f!==0&&Re.nodeType!==3||(te=b+f),Re.nodeType===3&&(b+=Re.nodeValue.length),(_e=Re.firstChild)!==null;)ve=Re,Re=_e;for(;;){if(Re===a)break t;if(ve===l&&++pe===m&&(M=b),ve===v&&++Ae===f&&(te=b),(_e=Re.nextSibling)!==null)break;Re=ve,ve=Re.parentNode}Re=_e}l=M===-1||te===-1?null:{start:M,end:te}}else l=null}l=l||{start:0,end:0}}else l=null;for(dm={focusedElem:a,selectionRange:l},Gh=!1,jr=s;jr!==null;)if(s=jr,a=s.child,(s.subtreeFlags&1024)!==0&&a!==null)a.return=s,jr=a;else for(;jr!==null;){switch(s=jr,v=s.alternate,a=s.flags,s.tag){case 0:break;case 11:case 15:break;case 1:if((a&1024)!==0&&v!==null){a=void 0,l=s,m=v.memoizedProps,v=v.memoizedState,f=l.stateNode;try{var it=yo(l.type,m,l.elementType===l.type);a=f.getSnapshotBeforeUpdate(it,v),f.__reactInternalSnapshotBeforeUpdate=a}catch(Qe){$t(l,l.return,Qe)}}break;case 3:if((a&1024)!==0){if(a=s.stateNode.containerInfo,l=a.nodeType,l===9)gm(a);else if(l===1)switch(a.nodeName){case"HEAD":case"HTML":case"BODY":gm(a);break;default:a.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((a&1024)!==0)throw Error(n(163))}if(a=s.sibling,a!==null){a.return=s.return,jr=a;break}jr=s.return}}function ax(a,s,l){var f=l.flags;switch(l.tag){case 0:case 11:case 15:is(a,l),f&4&&Jc(5,l);break;case 1:if(is(a,l),f&4)if(a=l.stateNode,s===null)try{a.componentDidMount()}catch(b){$t(l,l.return,b)}else{var m=yo(l.type,s.memoizedProps);s=s.memoizedState;try{a.componentDidUpdate(m,s,a.__reactInternalSnapshotBeforeUpdate)}catch(b){$t(l,l.return,b)}}f&64&&Z_(l),f&512&&eu(l,l.return);break;case 3:if(is(a,l),f&64&&(a=l.updateQueue,a!==null)){if(s=null,l.child!==null)switch(l.child.tag){case 27:case 5:s=l.child.stateNode;break;case 1:s=l.child.stateNode}try{Uv(a,s)}catch(b){$t(l,l.return,b)}}break;case 27:s===null&&f&4&&rx(l);case 26:case 5:is(a,l),s===null&&f&4&&ex(l),f&512&&eu(l,l.return);break;case 12:is(a,l);break;case 13:is(a,l),f&4&&ox(a,l),f&64&&(a=l.memoizedState,a!==null&&(a=a.dehydrated,a!==null&&(l=mC.bind(null,l),NC(a,l))));break;case 22:if(f=l.memoizedState!==null||Ci,!f){s=s!==null&&s.memoizedState!==null||mr,m=Ci;var v=mr;Ci=f,(mr=s)&&!v?ss(a,l,(l.subtreeFlags&8772)!==0):is(a,l),Ci=m,mr=v}break;case 30:break;default:is(a,l)}}function ix(a){var s=a.alternate;s!==null&&(a.alternate=null,ix(s)),a.child=null,a.deletions=null,a.sibling=null,a.tag===5&&(s=a.stateNode,s!==null&&B(s)),a.stateNode=null,a.return=null,a.dependencies=null,a.memoizedProps=null,a.memoizedState=null,a.pendingProps=null,a.stateNode=null,a.updateQueue=null}var ar=null,In=!1;function Ri(a,s,l){for(l=l.child;l!==null;)sx(a,s,l),l=l.sibling}function sx(a,s,l){if(Je&&typeof Je.onCommitFiberUnmount=="function")try{Je.onCommitFiberUnmount(Ze,l)}catch{}switch(l.tag){case 26:mr||Wa(l,s),Ri(a,s,l),l.memoizedState?l.memoizedState.count--:l.stateNode&&(l=l.stateNode,l.parentNode.removeChild(l));break;case 27:mr||Wa(l,s);var f=ar,m=In;hs(l.type)&&(ar=l.stateNode,In=!1),Ri(a,s,l),cu(l.stateNode),ar=f,In=m;break;case 5:mr||Wa(l,s);case 6:if(f=ar,m=In,ar=null,Ri(a,s,l),ar=f,In=m,ar!==null)if(In)try{(ar.nodeType===9?ar.body:ar.nodeName==="HTML"?ar.ownerDocument.body:ar).removeChild(l.stateNode)}catch(v){$t(l,s,v)}else try{ar.removeChild(l.stateNode)}catch(v){$t(l,s,v)}break;case 18:ar!==null&&(In?(a=ar,Xx(a.nodeType===9?a.body:a.nodeName==="HTML"?a.ownerDocument.body:a,l.stateNode),vu(a)):Xx(ar,l.stateNode));break;case 4:f=ar,m=In,ar=l.stateNode.containerInfo,In=!0,Ri(a,s,l),ar=f,In=m;break;case 0:case 11:case 14:case 15:mr||as(2,l,s),mr||as(4,l,s),Ri(a,s,l);break;case 1:mr||(Wa(l,s),f=l.stateNode,typeof f.componentWillUnmount=="function"&&J_(l,s,f)),Ri(a,s,l);break;case 21:Ri(a,s,l);break;case 22:mr=(f=mr)||l.memoizedState!==null,Ri(a,s,l),mr=f;break;default:Ri(a,s,l)}}function ox(a,s){if(s.memoizedState===null&&(a=s.alternate,a!==null&&(a=a.memoizedState,a!==null&&(a=a.dehydrated,a!==null))))try{vu(a)}catch(l){$t(s,s.return,l)}}function oC(a){switch(a.tag){case 13:case 19:var s=a.stateNode;return s===null&&(s=a.stateNode=new nx),s;case 22:return a=a.stateNode,s=a._retryCache,s===null&&(s=a._retryCache=new nx),s;default:throw Error(n(435,a.tag))}}function Hp(a,s){var l=oC(a);s.forEach(function(f){var m=gC.bind(null,a,f);l.has(f)||(l.add(f),f.then(m,m))})}function Bn(a,s){var l=s.deletions;if(l!==null)for(var f=0;f<l.length;f++){var m=l[f],v=a,b=s,M=b;e:for(;M!==null;){switch(M.tag){case 27:if(hs(M.type)){ar=M.stateNode,In=!1;break e}break;case 5:ar=M.stateNode,In=!1;break e;case 3:case 4:ar=M.stateNode.containerInfo,In=!0;break e}M=M.return}if(ar===null)throw Error(n(160));sx(v,b,m),ar=null,In=!1,v=m.alternate,v!==null&&(v.return=null),m.return=null}if(s.subtreeFlags&13878)for(s=s.child;s!==null;)lx(s,a),s=s.sibling}var Ta=null;function lx(a,s){var l=a.alternate,f=a.flags;switch(a.tag){case 0:case 11:case 14:case 15:Bn(s,a),jn(a),f&4&&(as(3,a,a.return),Jc(3,a),as(5,a,a.return));break;case 1:Bn(s,a),jn(a),f&512&&(mr||l===null||Wa(l,l.return)),f&64&&Ci&&(a=a.updateQueue,a!==null&&(f=a.callbacks,f!==null&&(l=a.shared.hiddenCallbacks,a.shared.hiddenCallbacks=l===null?f:l.concat(f))));break;case 26:var m=Ta;if(Bn(s,a),jn(a),f&512&&(mr||l===null||Wa(l,l.return)),f&4){var v=l!==null?l.memoizedState:null;if(f=a.memoizedState,l===null)if(f===null)if(a.stateNode===null){e:{f=a.type,l=a.memoizedProps,m=m.ownerDocument||m;t:switch(f){case"title":v=m.getElementsByTagName("title")[0],(!v||v[U]||v[dr]||v.namespaceURI==="http://www.w3.org/2000/svg"||v.hasAttribute("itemprop"))&&(v=m.createElement(f),m.head.insertBefore(v,m.querySelector("head > title"))),Yr(v,f,l),v[dr]=a,ce(v),f=v;break e;case"link":var b=ry("link","href",m).get(f+(l.href||""));if(b){for(var M=0;M<b.length;M++)if(v=b[M],v.getAttribute("href")===(l.href==null||l.href===""?null:l.href)&&v.getAttribute("rel")===(l.rel==null?null:l.rel)&&v.getAttribute("title")===(l.title==null?null:l.title)&&v.getAttribute("crossorigin")===(l.crossOrigin==null?null:l.crossOrigin)){b.splice(M,1);break t}}v=m.createElement(f),Yr(v,f,l),m.head.appendChild(v);break;case"meta":if(b=ry("meta","content",m).get(f+(l.content||""))){for(M=0;M<b.length;M++)if(v=b[M],v.getAttribute("content")===(l.content==null?null:""+l.content)&&v.getAttribute("name")===(l.name==null?null:l.name)&&v.getAttribute("property")===(l.property==null?null:l.property)&&v.getAttribute("http-equiv")===(l.httpEquiv==null?null:l.httpEquiv)&&v.getAttribute("charset")===(l.charSet==null?null:l.charSet)){b.splice(M,1);break t}}v=m.createElement(f),Yr(v,f,l),m.head.appendChild(v);break;default:throw Error(n(468,f))}v[dr]=a,ce(v),f=v}a.stateNode=f}else ny(m,a.type,a.stateNode);else a.stateNode=ty(m,f,a.memoizedProps);else v!==f?(v===null?l.stateNode!==null&&(l=l.stateNode,l.parentNode.removeChild(l)):v.count--,f===null?ny(m,a.type,a.stateNode):ty(m,f,a.memoizedProps)):f===null&&a.stateNode!==null&&Up(a,a.memoizedProps,l.memoizedProps)}break;case 27:Bn(s,a),jn(a),f&512&&(mr||l===null||Wa(l,l.return)),l!==null&&f&4&&Up(a,a.memoizedProps,l.memoizedProps);break;case 5:if(Bn(s,a),jn(a),f&512&&(mr||l===null||Wa(l,l.return)),a.flags&32){m=a.stateNode;try{Zn(m,"")}catch(_e){$t(a,a.return,_e)}}f&4&&a.stateNode!=null&&(m=a.memoizedProps,Up(a,m,l!==null?l.memoizedProps:m)),f&1024&&(zp=!0);break;case 6:if(Bn(s,a),jn(a),f&4){if(a.stateNode===null)throw Error(n(162));f=a.memoizedProps,l=a.stateNode;try{l.nodeValue=f}catch(_e){$t(a,a.return,_e)}}break;case 3:if(jh=null,m=Ta,Ta=Uh(s.containerInfo),Bn(s,a),Ta=m,jn(a),f&4&&l!==null&&l.memoizedState.isDehydrated)try{vu(s.containerInfo)}catch(_e){$t(a,a.return,_e)}zp&&(zp=!1,cx(a));break;case 4:f=Ta,Ta=Uh(a.stateNode.containerInfo),Bn(s,a),jn(a),Ta=f;break;case 12:Bn(s,a),jn(a);break;case 13:Bn(s,a),jn(a),a.child.flags&8192&&a.memoizedState!==null!=(l!==null&&l.memoizedState!==null)&&(Yp=Ne()),f&4&&(f=a.updateQueue,f!==null&&(a.updateQueue=null,Hp(a,f)));break;case 22:m=a.memoizedState!==null;var te=l!==null&&l.memoizedState!==null,pe=Ci,Ae=mr;if(Ci=pe||m,mr=Ae||te,Bn(s,a),mr=Ae,Ci=pe,jn(a),f&8192)e:for(s=a.stateNode,s._visibility=m?s._visibility&-2:s._visibility|1,m&&(l===null||te||Ci||mr||Eo(a)),l=null,s=a;;){if(s.tag===5||s.tag===26){if(l===null){te=l=s;try{if(v=te.stateNode,m)b=v.style,typeof b.setProperty=="function"?b.setProperty("display","none","important"):b.display="none";else{M=te.stateNode;var Re=te.memoizedProps.style,ve=Re!=null&&Re.hasOwnProperty("display")?Re.display:null;M.style.display=ve==null||typeof ve=="boolean"?"":(""+ve).trim()}}catch(_e){$t(te,te.return,_e)}}}else if(s.tag===6){if(l===null){te=s;try{te.stateNode.nodeValue=m?"":te.memoizedProps}catch(_e){$t(te,te.return,_e)}}}else if((s.tag!==22&&s.tag!==23||s.memoizedState===null||s===a)&&s.child!==null){s.child.return=s,s=s.child;continue}if(s===a)break e;for(;s.sibling===null;){if(s.return===null||s.return===a)break e;l===s&&(l=null),s=s.return}l===s&&(l=null),s.sibling.return=s.return,s=s.sibling}f&4&&(f=a.updateQueue,f!==null&&(l=f.retryQueue,l!==null&&(f.retryQueue=null,Hp(a,l))));break;case 19:Bn(s,a),jn(a),f&4&&(f=a.updateQueue,f!==null&&(a.updateQueue=null,Hp(a,f)));break;case 30:break;case 21:break;default:Bn(s,a),jn(a)}}function jn(a){var s=a.flags;if(s&2){try{for(var l,f=a.return;f!==null;){if(tx(f)){l=f;break}f=f.return}if(l==null)throw Error(n(160));switch(l.tag){case 27:var m=l.stateNode,v=Bp(a);Ch(a,v,m);break;case 5:var b=l.stateNode;l.flags&32&&(Zn(b,""),l.flags&=-33);var M=Bp(a);Ch(a,M,b);break;case 3:case 4:var te=l.stateNode.containerInfo,pe=Bp(a);jp(a,pe,te);break;default:throw Error(n(161))}}catch(Ae){$t(a,a.return,Ae)}a.flags&=-3}s&4096&&(a.flags&=-4097)}function cx(a){if(a.subtreeFlags&1024)for(a=a.child;a!==null;){var s=a;cx(s),s.tag===5&&s.flags&1024&&s.stateNode.reset(),a=a.sibling}}function is(a,s){if(s.subtreeFlags&8772)for(s=s.child;s!==null;)ax(a,s.alternate,s),s=s.sibling}function Eo(a){for(a=a.child;a!==null;){var s=a;switch(s.tag){case 0:case 11:case 14:case 15:as(4,s,s.return),Eo(s);break;case 1:Wa(s,s.return);var l=s.stateNode;typeof l.componentWillUnmount=="function"&&J_(s,s.return,l),Eo(s);break;case 27:cu(s.stateNode);case 26:case 5:Wa(s,s.return),Eo(s);break;case 22:s.memoizedState===null&&Eo(s);break;case 30:Eo(s);break;default:Eo(s)}a=a.sibling}}function ss(a,s,l){for(l=l&&(s.subtreeFlags&8772)!==0,s=s.child;s!==null;){var f=s.alternate,m=a,v=s,b=v.flags;switch(v.tag){case 0:case 11:case 15:ss(m,v,l),Jc(4,v);break;case 1:if(ss(m,v,l),f=v,m=f.stateNode,typeof m.componentDidMount=="function")try{m.componentDidMount()}catch(pe){$t(f,f.return,pe)}if(f=v,m=f.updateQueue,m!==null){var M=f.stateNode;try{var te=m.shared.hiddenCallbacks;if(te!==null)for(m.shared.hiddenCallbacks=null,m=0;m<te.length;m++)Vv(te[m],M)}catch(pe){$t(f,f.return,pe)}}l&&b&64&&Z_(v),eu(v,v.return);break;case 27:rx(v);case 26:case 5:ss(m,v,l),l&&f===null&&b&4&&ex(v),eu(v,v.return);break;case 12:ss(m,v,l);break;case 13:ss(m,v,l),l&&b&4&&ox(m,v);break;case 22:v.memoizedState===null&&ss(m,v,l),eu(v,v.return);break;case 30:break;default:ss(m,v,l)}s=s.sibling}}function Gp(a,s){var l=null;a!==null&&a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(l=a.memoizedState.cachePool.pool),a=null,s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(a=s.memoizedState.cachePool.pool),a!==l&&(a!=null&&a.refCount++,l!=null&&Uc(l))}function qp(a,s){a=null,s.alternate!==null&&(a=s.alternate.memoizedState.cache),s=s.memoizedState.cache,s!==a&&(s.refCount++,a!=null&&Uc(a))}function Xa(a,s,l,f){if(s.subtreeFlags&10256)for(s=s.child;s!==null;)ux(a,s,l,f),s=s.sibling}function ux(a,s,l,f){var m=s.flags;switch(s.tag){case 0:case 11:case 15:Xa(a,s,l,f),m&2048&&Jc(9,s);break;case 1:Xa(a,s,l,f);break;case 3:Xa(a,s,l,f),m&2048&&(a=null,s.alternate!==null&&(a=s.alternate.memoizedState.cache),s=s.memoizedState.cache,s!==a&&(s.refCount++,a!=null&&Uc(a)));break;case 12:if(m&2048){Xa(a,s,l,f),a=s.stateNode;try{var v=s.memoizedProps,b=v.id,M=v.onPostCommit;typeof M=="function"&&M(b,s.alternate===null?"mount":"update",a.passiveEffectDuration,-0)}catch(te){$t(s,s.return,te)}}else Xa(a,s,l,f);break;case 13:Xa(a,s,l,f);break;case 23:break;case 22:v=s.stateNode,b=s.alternate,s.memoizedState!==null?v._visibility&2?Xa(a,s,l,f):tu(a,s):v._visibility&2?Xa(a,s,l,f):(v._visibility|=2,bl(a,s,l,f,(s.subtreeFlags&10256)!==0)),m&2048&&Gp(b,s);break;case 24:Xa(a,s,l,f),m&2048&&qp(s.alternate,s);break;default:Xa(a,s,l,f)}}function bl(a,s,l,f,m){for(m=m&&(s.subtreeFlags&10256)!==0,s=s.child;s!==null;){var v=a,b=s,M=l,te=f,pe=b.flags;switch(b.tag){case 0:case 11:case 15:bl(v,b,M,te,m),Jc(8,b);break;case 23:break;case 22:var Ae=b.stateNode;b.memoizedState!==null?Ae._visibility&2?bl(v,b,M,te,m):tu(v,b):(Ae._visibility|=2,bl(v,b,M,te,m)),m&&pe&2048&&Gp(b.alternate,b);break;case 24:bl(v,b,M,te,m),m&&pe&2048&&qp(b.alternate,b);break;default:bl(v,b,M,te,m)}s=s.sibling}}function tu(a,s){if(s.subtreeFlags&10256)for(s=s.child;s!==null;){var l=a,f=s,m=f.flags;switch(f.tag){case 22:tu(l,f),m&2048&&Gp(f.alternate,f);break;case 24:tu(l,f),m&2048&&qp(f.alternate,f);break;default:tu(l,f)}s=s.sibling}}var ru=8192;function Il(a){if(a.subtreeFlags&ru)for(a=a.child;a!==null;)fx(a),a=a.sibling}function fx(a){switch(a.tag){case 26:Il(a),a.flags&ru&&a.memoizedState!==null&&KC(Ta,a.memoizedState,a.memoizedProps);break;case 5:Il(a);break;case 3:case 4:var s=Ta;Ta=Uh(a.stateNode.containerInfo),Il(a),Ta=s;break;case 22:a.memoizedState===null&&(s=a.alternate,s!==null&&s.memoizedState!==null?(s=ru,ru=16777216,Il(a),ru=s):Il(a));break;default:Il(a)}}function hx(a){var s=a.alternate;if(s!==null&&(a=s.child,a!==null)){s.child=null;do s=a.sibling,a.sibling=null,a=s;while(a!==null)}}function nu(a){var s=a.deletions;if((a.flags&16)!==0){if(s!==null)for(var l=0;l<s.length;l++){var f=s[l];jr=f,px(f,a)}hx(a)}if(a.subtreeFlags&10256)for(a=a.child;a!==null;)dx(a),a=a.sibling}function dx(a){switch(a.tag){case 0:case 11:case 15:nu(a),a.flags&2048&&as(9,a,a.return);break;case 3:nu(a);break;case 12:nu(a);break;case 22:var s=a.stateNode;a.memoizedState!==null&&s._visibility&2&&(a.return===null||a.return.tag!==13)?(s._visibility&=-3,Rh(a)):nu(a);break;default:nu(a)}}function Rh(a){var s=a.deletions;if((a.flags&16)!==0){if(s!==null)for(var l=0;l<s.length;l++){var f=s[l];jr=f,px(f,a)}hx(a)}for(a=a.child;a!==null;){switch(s=a,s.tag){case 0:case 11:case 15:as(8,s,s.return),Rh(s);break;case 22:l=s.stateNode,l._visibility&2&&(l._visibility&=-3,Rh(s));break;default:Rh(s)}a=a.sibling}}function px(a,s){for(;jr!==null;){var l=jr;switch(l.tag){case 0:case 11:case 15:as(8,l,s);break;case 23:case 22:if(l.memoizedState!==null&&l.memoizedState.cachePool!==null){var f=l.memoizedState.cachePool.pool;f!=null&&f.refCount++}break;case 24:Uc(l.memoizedState.cache)}if(f=l.child,f!==null)f.return=l,jr=f;else e:for(l=a;jr!==null;){f=jr;var m=f.sibling,v=f.return;if(ix(f),f===l){jr=null;break e}if(m!==null){m.return=v,jr=m;break e}jr=v}}}var lC={getCacheForType:function(a){var s=nn(Dr),l=s.data.get(a);return l===void 0&&(l=a(),s.data.set(a,l)),l}},cC=typeof WeakMap=="function"?WeakMap:Map,zt=0,Zt=null,xt=null,bt=0,Ht=0,zn=null,os=!1,Dl=!1,Kp=!1,ki=0,ur=0,ls=0,To=0,Wp=0,oa=0,Ol=0,au=null,Dn=null,Xp=!1,Yp=0,kh=1/0,bh=null,cs=null,Xr=0,us=null,Nl=null,Fl=0,$p=0,Qp=null,mx=null,iu=0,Zp=null;function Hn(){if((zt&2)!==0&&bt!==0)return bt&-bt;if(ae.T!==null){var a=El;return a!==0?a:im()}return Pa()}function gx(){oa===0&&(oa=(bt&536870912)===0||Ut?Ki():536870912);var a=sa.current;return a!==null&&(a.flags|=32),oa}function Gn(a,s,l){(a===Zt&&(Ht===2||Ht===9)||a.cancelPendingCommit!==null)&&(Pl(a,0),fs(a,bt,oa,!1)),xa(a,l),((zt&2)===0||a!==Zt)&&(a===Zt&&((zt&2)===0&&(To|=l),ur===4&&fs(a,bt,oa,!1)),Ya(a))}function vx(a,s,l){if((zt&6)!==0)throw Error(n(327));var f=!l&&(s&124)===0&&(s&a.expiredLanes)===0||ci(a,s),m=f?hC(a,s):tm(a,s,!0),v=f;do{if(m===0){Dl&&!f&&fs(a,s,0,!1);break}else{if(l=a.current.alternate,v&&!uC(l)){m=tm(a,s,!1),v=!1;continue}if(m===2){if(v=s,a.errorRecoveryDisabledLanes&v)var b=0;else b=a.pendingLanes&-536870913,b=b!==0?b:b&536870912?536870912:0;if(b!==0){s=b;e:{var M=a;m=au;var te=M.current.memoizedState.isDehydrated;if(te&&(Pl(M,b).flags|=256),b=tm(M,b,!1),b!==2){if(Kp&&!te){M.errorRecoveryDisabledLanes|=v,To|=v,m=4;break e}v=Dn,Dn=m,v!==null&&(Dn===null?Dn=v:Dn.push.apply(Dn,v))}m=b}if(v=!1,m!==2)continue}}if(m===1){Pl(a,0),fs(a,s,0,!0);break}e:{switch(f=a,v=m,v){case 0:case 1:throw Error(n(345));case 4:if((s&4194048)!==s)break;case 6:fs(f,s,oa,!os);break e;case 2:Dn=null;break;case 3:case 5:break;default:throw Error(n(329))}if((s&62914560)===s&&(m=Yp+300-Ne(),10<m)){if(fs(f,s,oa,!os),Gi(f,0,!0)!==0)break e;f.timeoutHandle=Kx(_x.bind(null,f,l,Dn,bh,Xp,s,oa,To,Ol,os,v,2,-0,0),m);break e}_x(f,l,Dn,bh,Xp,s,oa,To,Ol,os,v,0,-0,0)}}break}while(!0);Ya(a)}function _x(a,s,l,f,m,v,b,M,te,pe,Ae,Re,ve,_e){if(a.timeoutHandle=-1,Re=s.subtreeFlags,(Re&8192||(Re&16785408)===16785408)&&(hu={stylesheets:null,count:0,unsuspend:qC},fx(s),Re=WC(),Re!==null)){a.cancelPendingCommit=Re(Sx.bind(null,a,s,v,l,f,m,b,M,te,Ae,1,ve,_e)),fs(a,v,b,!pe);return}Sx(a,s,v,l,f,m,b,M,te)}function uC(a){for(var s=a;;){var l=s.tag;if((l===0||l===11||l===15)&&s.flags&16384&&(l=s.updateQueue,l!==null&&(l=l.stores,l!==null)))for(var f=0;f<l.length;f++){var m=l[f],v=m.getSnapshot;m=m.value;try{if(!Vn(v(),m))return!1}catch{return!1}}if(l=s.child,s.subtreeFlags&16384&&l!==null)l.return=s,s=l;else{if(s===a)break;for(;s.sibling===null;){if(s.return===null||s.return===a)return!0;s=s.return}s.sibling.return=s.return,s=s.sibling}}return!0}function fs(a,s,l,f){s&=~Wp,s&=~To,a.suspendedLanes|=s,a.pingedLanes&=~s,f&&(a.warmLanes|=s),f=a.expirationTimes;for(var m=s;0<m;){var v=31-Lt(m),b=1<<v;f[v]=-1,m&=~b}l!==0&&Qn(a,l,s)}function Ih(){return(zt&6)===0?(su(0),!1):!0}function Jp(){if(xt!==null){if(Ht===0)var a=xt.return;else a=xt,yi=go=null,gp(a),Rl=null,$c=0,a=xt;for(;a!==null;)Q_(a.alternate,a),a=a.return;xt=null}}function Pl(a,s){var l=a.timeoutHandle;l!==-1&&(a.timeoutHandle=-1,kC(l)),l=a.cancelPendingCommit,l!==null&&(a.cancelPendingCommit=null,l()),Jp(),Zt=a,xt=l=vi(a.current,null),bt=s,Ht=0,zn=null,os=!1,Dl=ci(a,s),Kp=!1,Ol=oa=Wp=To=ls=ur=0,Dn=au=null,Xp=!1,(s&8)!==0&&(s|=s&32);var f=a.entangledLanes;if(f!==0)for(a=a.entanglements,f&=s;0<f;){var m=31-Lt(f),v=1<<m;s|=a[m],f&=~v}return ki=s,Zf(),l}function xx(a,s){pt=null,ae.H=vh,s===jc||s===oh?(s=Mv(),Ht=3):s===Nv?(s=Mv(),Ht=4):Ht=s===L_?8:s!==null&&typeof s=="object"&&typeof s.then=="function"?6:1,zn=s,xt===null&&(ur=1,Th(a,ra(s,a.current)))}function yx(){var a=ae.H;return ae.H=vh,a===null?vh:a}function Ex(){var a=ae.A;return ae.A=lC,a}function em(){ur=4,os||(bt&4194048)!==bt&&sa.current!==null||(Dl=!0),(ls&134217727)===0&&(To&134217727)===0||Zt===null||fs(Zt,bt,oa,!1)}function tm(a,s,l){var f=zt;zt|=2;var m=yx(),v=Ex();(Zt!==a||bt!==s)&&(bh=null,Pl(a,s)),s=!1;var b=ur;e:do try{if(Ht!==0&&xt!==null){var M=xt,te=zn;switch(Ht){case 8:Jp(),b=6;break e;case 3:case 2:case 9:case 6:sa.current===null&&(s=!0);var pe=Ht;if(Ht=0,zn=null,Ml(a,M,te,pe),l&&Dl){b=0;break e}break;default:pe=Ht,Ht=0,zn=null,Ml(a,M,te,pe)}}fC(),b=ur;break}catch(Ae){xx(a,Ae)}while(!0);return s&&a.shellSuspendCounter++,yi=go=null,zt=f,ae.H=m,ae.A=v,xt===null&&(Zt=null,bt=0,Zf()),b}function fC(){for(;xt!==null;)Tx(xt)}function hC(a,s){var l=zt;zt|=2;var f=yx(),m=Ex();Zt!==a||bt!==s?(bh=null,kh=Ne()+500,Pl(a,s)):Dl=ci(a,s);e:do try{if(Ht!==0&&xt!==null){s=xt;var v=zn;t:switch(Ht){case 1:Ht=0,zn=null,Ml(a,s,v,1);break;case 2:case 9:if(Fv(v)){Ht=0,zn=null,Ax(s);break}s=function(){Ht!==2&&Ht!==9||Zt!==a||(Ht=7),Ya(a)},v.then(s,s);break e;case 3:Ht=7;break e;case 4:Ht=5;break e;case 7:Fv(v)?(Ht=0,zn=null,Ax(s)):(Ht=0,zn=null,Ml(a,s,v,7));break;case 5:var b=null;switch(xt.tag){case 26:b=xt.memoizedState;case 5:case 27:var M=xt;if(!b||ay(b)){Ht=0,zn=null;var te=M.sibling;if(te!==null)xt=te;else{var pe=M.return;pe!==null?(xt=pe,Dh(pe)):xt=null}break t}}Ht=0,zn=null,Ml(a,s,v,5);break;case 6:Ht=0,zn=null,Ml(a,s,v,6);break;case 8:Jp(),ur=6;break e;default:throw Error(n(462))}}dC();break}catch(Ae){xx(a,Ae)}while(!0);return yi=go=null,ae.H=f,ae.A=m,zt=l,xt!==null?0:(Zt=null,bt=0,Zf(),ur)}function dC(){for(;xt!==null&&!Ke();)Tx(xt)}function Tx(a){var s=Y_(a.alternate,a,ki);a.memoizedProps=a.pendingProps,s===null?Dh(a):xt=s}function Ax(a){var s=a,l=s.alternate;switch(s.tag){case 15:case 0:s=H_(l,s,s.pendingProps,s.type,void 0,bt);break;case 11:s=H_(l,s,s.pendingProps,s.type.render,s.ref,bt);break;case 5:gp(s);default:Q_(l,s),s=xt=wv(s,ki),s=Y_(l,s,ki)}a.memoizedProps=a.pendingProps,s===null?Dh(a):xt=s}function Ml(a,s,l,f){yi=go=null,gp(s),Rl=null,$c=0;var m=s.return;try{if(rC(a,m,s,l,bt)){ur=1,Th(a,ra(l,a.current)),xt=null;return}}catch(v){if(m!==null)throw xt=m,v;ur=1,Th(a,ra(l,a.current)),xt=null;return}s.flags&32768?(Ut||f===1?a=!0:Dl||(bt&536870912)!==0?a=!1:(os=a=!0,(f===2||f===9||f===3||f===6)&&(f=sa.current,f!==null&&f.tag===13&&(f.flags|=16384))),wx(s,a)):Dh(s)}function Dh(a){var s=a;do{if((s.flags&32768)!==0){wx(s,os);return}a=s.return;var l=aC(s.alternate,s,ki);if(l!==null){xt=l;return}if(s=s.sibling,s!==null){xt=s;return}xt=s=a}while(s!==null);ur===0&&(ur=5)}function wx(a,s){do{var l=iC(a.alternate,a);if(l!==null){l.flags&=32767,xt=l;return}if(l=a.return,l!==null&&(l.flags|=32768,l.subtreeFlags=0,l.deletions=null),!s&&(a=a.sibling,a!==null)){xt=a;return}xt=a=l}while(a!==null);ur=6,xt=null}function Sx(a,s,l,f,m,v,b,M,te){a.cancelPendingCommit=null;do Oh();while(Xr!==0);if((zt&6)!==0)throw Error(n(327));if(s!==null){if(s===a.current)throw Error(n(177));if(v=s.lanes|s.childLanes,v|=qd,Na(a,l,v,b,M,te),a===Zt&&(xt=Zt=null,bt=0),Nl=s,us=a,Fl=l,$p=v,Qp=m,mx=f,(s.subtreeFlags&10256)!==0||(s.flags&10256)!==0?(a.callbackNode=null,a.callbackPriority=0,vC(rr,function(){return Ix(),null})):(a.callbackNode=null,a.callbackPriority=0),f=(s.flags&13878)!==0,(s.subtreeFlags&13878)!==0||f){f=ae.T,ae.T=null,m=oe.p,oe.p=2,b=zt,zt|=4;try{sC(a,s,l)}finally{zt=b,oe.p=m,ae.T=f}}Xr=1,Cx(),Rx(),kx()}}function Cx(){if(Xr===1){Xr=0;var a=us,s=Nl,l=(s.flags&13878)!==0;if((s.subtreeFlags&13878)!==0||l){l=ae.T,ae.T=null;var f=oe.p;oe.p=2;var m=zt;zt|=4;try{lx(s,a);var v=dm,b=pv(a.containerInfo),M=v.focusedElem,te=v.selectionRange;if(b!==M&&M&&M.ownerDocument&&dv(M.ownerDocument.documentElement,M)){if(te!==null&&Bd(M)){var pe=te.start,Ae=te.end;if(Ae===void 0&&(Ae=pe),"selectionStart"in M)M.selectionStart=pe,M.selectionEnd=Math.min(Ae,M.value.length);else{var Re=M.ownerDocument||document,ve=Re&&Re.defaultView||window;if(ve.getSelection){var _e=ve.getSelection(),it=M.textContent.length,Qe=Math.min(te.start,it),Yt=te.end===void 0?Qe:Math.min(te.end,it);!_e.extend&&Qe>Yt&&(b=Yt,Yt=Qe,Qe=b);var le=hv(M,Qe),ie=hv(M,Yt);if(le&&ie&&(_e.rangeCount!==1||_e.anchorNode!==le.node||_e.anchorOffset!==le.offset||_e.focusNode!==ie.node||_e.focusOffset!==ie.offset)){var he=Re.createRange();he.setStart(le.node,le.offset),_e.removeAllRanges(),Qe>Yt?(_e.addRange(he),_e.extend(ie.node,ie.offset)):(he.setEnd(ie.node,ie.offset),_e.addRange(he))}}}}for(Re=[],_e=M;_e=_e.parentNode;)_e.nodeType===1&&Re.push({element:_e,left:_e.scrollLeft,top:_e.scrollTop});for(typeof M.focus=="function"&&M.focus(),M=0;M<Re.length;M++){var Se=Re[M];Se.element.scrollLeft=Se.left,Se.element.scrollTop=Se.top}}Gh=!!hm,dm=hm=null}finally{zt=m,oe.p=f,ae.T=l}}a.current=s,Xr=2}}function Rx(){if(Xr===2){Xr=0;var a=us,s=Nl,l=(s.flags&8772)!==0;if((s.subtreeFlags&8772)!==0||l){l=ae.T,ae.T=null;var f=oe.p;oe.p=2;var m=zt;zt|=4;try{ax(a,s.alternate,s)}finally{zt=m,oe.p=f,ae.T=l}}Xr=3}}function kx(){if(Xr===4||Xr===3){Xr=0,Be();var a=us,s=Nl,l=Fl,f=mx;(s.subtreeFlags&10256)!==0||(s.flags&10256)!==0?Xr=5:(Xr=0,Nl=us=null,bx(a,a.pendingLanes));var m=a.pendingLanes;if(m===0&&(cs=null),Xi(l),s=s.stateNode,Je&&typeof Je.onCommitFiberRoot=="function")try{Je.onCommitFiberRoot(Ze,s,void 0,(s.current.flags&128)===128)}catch{}if(f!==null){s=ae.T,m=oe.p,oe.p=2,ae.T=null;try{for(var v=a.onRecoverableError,b=0;b<f.length;b++){var M=f[b];v(M.value,{componentStack:M.stack})}}finally{ae.T=s,oe.p=m}}(Fl&3)!==0&&Oh(),Ya(a),m=a.pendingLanes,(l&4194090)!==0&&(m&42)!==0?a===Zp?iu++:(iu=0,Zp=a):iu=0,su(0)}}function bx(a,s){(a.pooledCacheLanes&=s)===0&&(s=a.pooledCache,s!=null&&(a.pooledCache=null,Uc(s)))}function Oh(a){return Cx(),Rx(),kx(),Ix()}function Ix(){if(Xr!==5)return!1;var a=us,s=$p;$p=0;var l=Xi(Fl),f=ae.T,m=oe.p;try{oe.p=32>l?32:l,ae.T=null,l=Qp,Qp=null;var v=us,b=Fl;if(Xr=0,Nl=us=null,Fl=0,(zt&6)!==0)throw Error(n(331));var M=zt;if(zt|=4,dx(v.current),ux(v,v.current,b,l),zt=M,su(0,!1),Je&&typeof Je.onPostCommitFiberRoot=="function")try{Je.onPostCommitFiberRoot(Ze,v)}catch{}return!0}finally{oe.p=m,ae.T=f,bx(a,s)}}function Dx(a,s,l){s=ra(l,s),s=Ip(a.stateNode,s,2),a=es(a,s,2),a!==null&&(xa(a,2),Ya(a))}function $t(a,s,l){if(a.tag===3)Dx(a,a,l);else for(;s!==null;){if(s.tag===3){Dx(s,a,l);break}else if(s.tag===1){var f=s.stateNode;if(typeof s.type.getDerivedStateFromError=="function"||typeof f.componentDidCatch=="function"&&(cs===null||!cs.has(f))){a=ra(l,a),l=P_(2),f=es(s,l,2),f!==null&&(M_(l,f,s,a),xa(f,2),Ya(f));break}}s=s.return}}function rm(a,s,l){var f=a.pingCache;if(f===null){f=a.pingCache=new cC;var m=new Set;f.set(s,m)}else m=f.get(s),m===void 0&&(m=new Set,f.set(s,m));m.has(l)||(Kp=!0,m.add(l),a=pC.bind(null,a,s,l),s.then(a,a))}function pC(a,s,l){var f=a.pingCache;f!==null&&f.delete(s),a.pingedLanes|=a.suspendedLanes&l,a.warmLanes&=~l,Zt===a&&(bt&l)===l&&(ur===4||ur===3&&(bt&62914560)===bt&&300>Ne()-Yp?(zt&2)===0&&Pl(a,0):Wp|=l,Ol===bt&&(Ol=0)),Ya(a)}function Ox(a,s){s===0&&(s=Wi()),a=vl(a,s),a!==null&&(xa(a,s),Ya(a))}function mC(a){var s=a.memoizedState,l=0;s!==null&&(l=s.retryLane),Ox(a,l)}function gC(a,s){var l=0;switch(a.tag){case 13:var f=a.stateNode,m=a.memoizedState;m!==null&&(l=m.retryLane);break;case 19:f=a.stateNode;break;case 22:f=a.stateNode._retryCache;break;default:throw Error(n(314))}f!==null&&f.delete(s),Ox(a,l)}function vC(a,s){return nt(a,s)}var Nh=null,Ll=null,nm=!1,Fh=!1,am=!1,Ao=0;function Ya(a){a!==Ll&&a.next===null&&(Ll===null?Nh=Ll=a:Ll=Ll.next=a),Fh=!0,nm||(nm=!0,xC())}function su(a,s){if(!am&&Fh){am=!0;do for(var l=!1,f=Nh;f!==null;){if(a!==0){var m=f.pendingLanes;if(m===0)var v=0;else{var b=f.suspendedLanes,M=f.pingedLanes;v=(1<<31-Lt(42|a)+1)-1,v&=m&~(b&~M),v=v&201326741?v&201326741|1:v?v|2:0}v!==0&&(l=!0,Mx(f,v))}else v=bt,v=Gi(f,f===Zt?v:0,f.cancelPendingCommit!==null||f.timeoutHandle!==-1),(v&3)===0||ci(f,v)||(l=!0,Mx(f,v));f=f.next}while(l);am=!1}}function _C(){Nx()}function Nx(){Fh=nm=!1;var a=0;Ao!==0&&(RC()&&(a=Ao),Ao=0);for(var s=Ne(),l=null,f=Nh;f!==null;){var m=f.next,v=Fx(f,s);v===0?(f.next=null,l===null?Nh=m:l.next=m,m===null&&(Ll=l)):(l=f,(a!==0||(v&3)!==0)&&(Fh=!0)),f=m}su(a)}function Fx(a,s){for(var l=a.suspendedLanes,f=a.pingedLanes,m=a.expirationTimes,v=a.pendingLanes&-62914561;0<v;){var b=31-Lt(v),M=1<<b,te=m[b];te===-1?((M&l)===0||(M&f)!==0)&&(m[b]=qi(M,s)):te<=s&&(a.expiredLanes|=M),v&=~M}if(s=Zt,l=bt,l=Gi(a,a===s?l:0,a.cancelPendingCommit!==null||a.timeoutHandle!==-1),f=a.callbackNode,l===0||a===s&&(Ht===2||Ht===9)||a.cancelPendingCommit!==null)return f!==null&&f!==null&&Ge(f),a.callbackNode=null,a.callbackPriority=0;if((l&3)===0||ci(a,l)){if(s=l&-l,s===a.callbackPriority)return s;switch(f!==null&&Ge(f),Xi(l)){case 2:case 8:l=_t;break;case 32:l=rr;break;case 268435456:l=hr;break;default:l=rr}return f=Px.bind(null,a),l=nt(l,f),a.callbackPriority=s,a.callbackNode=l,s}return f!==null&&f!==null&&Ge(f),a.callbackPriority=2,a.callbackNode=null,2}function Px(a,s){if(Xr!==0&&Xr!==5)return a.callbackNode=null,a.callbackPriority=0,null;var l=a.callbackNode;if(Oh()&&a.callbackNode!==l)return null;var f=bt;return f=Gi(a,a===Zt?f:0,a.cancelPendingCommit!==null||a.timeoutHandle!==-1),f===0?null:(vx(a,f,s),Fx(a,Ne()),a.callbackNode!=null&&a.callbackNode===l?Px.bind(null,a):null)}function Mx(a,s){if(Oh())return null;vx(a,s,!0)}function xC(){bC(function(){(zt&6)!==0?nt(ut,_C):Nx()})}function im(){return Ao===0&&(Ao=Ki()),Ao}function Lx(a){return a==null||typeof a=="symbol"||typeof a=="boolean"?null:typeof a=="function"?a:il(""+a)}function Vx(a,s){var l=s.ownerDocument.createElement("input");return l.name=s.name,l.value=s.value,a.id&&l.setAttribute("form",a.id),s.parentNode.insertBefore(l,s),a=new FormData(a),l.parentNode.removeChild(l),a}function yC(a,s,l,f,m){if(s==="submit"&&l&&l.stateNode===m){var v=Lx((m[nr]||null).action),b=f.submitter;b&&(s=(s=b[nr]||null)?Lx(s.formAction):b.getAttribute("formAction"),s!==null&&(v=s,b=null));var M=new sl("action","action",null,f,m);a.push({event:M,listeners:[{instance:null,listener:function(){if(f.defaultPrevented){if(Ao!==0){var te=b?Vx(m,b):new FormData(m);Sp(l,{pending:!0,data:te,method:m.method,action:v},null,te)}}else typeof v=="function"&&(M.preventDefault(),te=b?Vx(m,b):new FormData(m),Sp(l,{pending:!0,data:te,method:m.method,action:v},v,te))},currentTarget:m}]})}}for(var sm=0;sm<Gd.length;sm++){var om=Gd[sm],EC=om.toLowerCase(),TC=om[0].toUpperCase()+om.slice(1);Ea(EC,"on"+TC)}Ea(vv,"onAnimationEnd"),Ea(_v,"onAnimationIteration"),Ea(xv,"onAnimationStart"),Ea("dblclick","onDoubleClick"),Ea("focusin","onFocus"),Ea("focusout","onBlur"),Ea(U4,"onTransitionRun"),Ea(B4,"onTransitionStart"),Ea(j4,"onTransitionCancel"),Ea(yv,"onTransitionEnd"),Le("onMouseEnter",["mouseout","mouseover"]),Le("onMouseLeave",["mouseout","mouseover"]),Le("onPointerEnter",["pointerout","pointerover"]),Le("onPointerLeave",["pointerout","pointerover"]),Oe("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Oe("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Oe("onBeforeInput",["compositionend","keypress","textInput","paste"]),Oe("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Oe("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Oe("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var ou="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),AC=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(ou));function Ux(a,s){s=(s&4)!==0;for(var l=0;l<a.length;l++){var f=a[l],m=f.event;f=f.listeners;e:{var v=void 0;if(s)for(var b=f.length-1;0<=b;b--){var M=f[b],te=M.instance,pe=M.currentTarget;if(M=M.listener,te!==v&&m.isPropagationStopped())break e;v=M,m.currentTarget=pe;try{v(m)}catch(Ae){Eh(Ae)}m.currentTarget=null,v=te}else for(b=0;b<f.length;b++){if(M=f[b],te=M.instance,pe=M.currentTarget,M=M.listener,te!==v&&m.isPropagationStopped())break e;v=M,m.currentTarget=pe;try{v(m)}catch(Ae){Eh(Ae)}m.currentTarget=null,v=te}}}}function yt(a,s){var l=s[$s];l===void 0&&(l=s[$s]=new Set);var f=a+"__bubble";l.has(f)||(Bx(s,a,2,!1),l.add(f))}function lm(a,s,l){var f=0;s&&(f|=4),Bx(l,a,f,s)}var Ph="_reactListening"+Math.random().toString(36).slice(2);function cm(a){if(!a[Ph]){a[Ph]=!0,me.forEach(function(l){l!=="selectionchange"&&(AC.has(l)||lm(l,!1,a),lm(l,!0,a))});var s=a.nodeType===9?a:a.ownerDocument;s===null||s[Ph]||(s[Ph]=!0,lm("selectionchange",!1,s))}}function Bx(a,s,l,f){switch(uy(s)){case 2:var m=$C;break;case 8:m=QC;break;default:m=Am}l=m.bind(null,s,l,a),m=void 0,!ea||s!=="touchstart"&&s!=="touchmove"&&s!=="wheel"||(m=!0),f?m!==void 0?a.addEventListener(s,l,{capture:!0,passive:m}):a.addEventListener(s,l,!0):m!==void 0?a.addEventListener(s,l,{passive:m}):a.addEventListener(s,l,!1)}function um(a,s,l,f,m){var v=f;if((s&1)===0&&(s&2)===0&&f!==null)e:for(;;){if(f===null)return;var b=f.tag;if(b===3||b===4){var M=f.stateNode.containerInfo;if(M===m)break;if(b===4)for(b=f.return;b!==null;){var te=b.tag;if((te===3||te===4)&&b.stateNode.containerInfo===m)return;b=b.return}for(;M!==null;){if(b=H(M),b===null)return;if(te=b.tag,te===5||te===6||te===26||te===27){f=v=b;continue e}M=M.parentNode}}f=f.return}Lf(function(){var pe=v,Ae=Jn(l),Re=[];e:{var ve=Ev.get(a);if(ve!==void 0){var _e=sl,it=a;switch(a){case"keypress":if(Ba(l)===0)break e;case"keydown":case"keyup":_e=hl;break;case"focusin":it="focus",_e=cl;break;case"focusout":it="blur",_e=cl;break;case"beforeblur":case"afterblur":_e=cl;break;case"click":if(l.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":_e=ta;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":_e=Md;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":_e=qf;break;case vv:case _v:case xv:_e=ul;break;case yv:_e=Wf;break;case"scroll":case"scrollend":_e=Vf;break;case"wheel":_e=dl;break;case"copy":case"cut":case"paste":_e=fl;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":_e=Dc;break;case"toggle":case"beforetoggle":_e=Yf}var Qe=(s&4)!==0,Yt=!Qe&&(a==="scroll"||a==="scrollend"),le=Qe?ve!==null?ve+"Capture":null:ve;Qe=[];for(var ie=pe,he;ie!==null;){var Se=ie;if(he=Se.stateNode,Se=Se.tag,Se!==5&&Se!==26&&Se!==27||he===null||le===null||(Se=to(ie,le),Se!=null&&Qe.push(lu(ie,Se,he))),Yt)break;ie=ie.return}0<Qe.length&&(ve=new _e(ve,it,null,l,Ae),Re.push({event:ve,listeners:Qe}))}}if((s&7)===0){e:{if(ve=a==="mouseover"||a==="pointerover",_e=a==="mouseout"||a==="pointerout",ve&&l!==fi&&(it=l.relatedTarget||l.fromElement)&&(H(it)||it[Rn]))break e;if((_e||ve)&&(ve=Ae.window===Ae?Ae:(ve=Ae.ownerDocument)?ve.defaultView||ve.parentWindow:window,_e?(it=l.relatedTarget||l.toElement,_e=pe,it=it?H(it):null,it!==null&&(Yt=o(it),Qe=it.tag,it!==Yt||Qe!==5&&Qe!==27&&Qe!==6)&&(it=null)):(_e=null,it=pe),_e!==it)){if(Qe=ta,Se="onMouseLeave",le="onMouseEnter",ie="mouse",(a==="pointerout"||a==="pointerover")&&(Qe=Dc,Se="onPointerLeave",le="onPointerEnter",ie="pointer"),Yt=_e==null?ve:de(_e),he=it==null?ve:de(it),ve=new Qe(Se,ie+"leave",_e,l,Ae),ve.target=Yt,ve.relatedTarget=he,Se=null,H(Ae)===pe&&(Qe=new Qe(le,ie+"enter",it,l,Ae),Qe.target=he,Qe.relatedTarget=Yt,Se=Qe),Yt=Se,_e&&it)t:{for(Qe=_e,le=it,ie=0,he=Qe;he;he=Vl(he))ie++;for(he=0,Se=le;Se;Se=Vl(Se))he++;for(;0<ie-he;)Qe=Vl(Qe),ie--;for(;0<he-ie;)le=Vl(le),he--;for(;ie--;){if(Qe===le||le!==null&&Qe===le.alternate)break t;Qe=Vl(Qe),le=Vl(le)}Qe=null}else Qe=null;_e!==null&&jx(Re,ve,_e,Qe,!1),it!==null&&Yt!==null&&jx(Re,Yt,it,Qe,!0)}}e:{if(ve=pe?de(pe):window,_e=ve.nodeName&&ve.nodeName.toLowerCase(),_e==="select"||_e==="input"&&ve.type==="file")var qe=sv;else if(Ir(ve))if(ov)qe=M4;else{qe=F4;var gt=N4}else _e=ve.nodeName,!_e||_e.toLowerCase()!=="input"||ve.type!=="checkbox"&&ve.type!=="radio"?pe&&wc(pe.elementType)&&(qe=sv):qe=P4;if(qe&&(qe=qe(a,pe))){gi(Re,qe,l,Ae);break e}gt&&gt(a,ve,pe),a==="focusout"&&pe&&ve.type==="number"&&pe.memoizedProps.value!=null&&Yi(ve,"number",ve.value)}switch(gt=pe?de(pe):window,a){case"focusin":(Ir(gt)||gt.contentEditable==="true")&&(pl=gt,jd=pe,Fc=null);break;case"focusout":Fc=jd=pl=null;break;case"mousedown":zd=!0;break;case"contextmenu":case"mouseup":case"dragend":zd=!1,mv(Re,l,Ae);break;case"selectionchange":if(V4)break;case"keydown":case"keyup":mv(Re,l,Ae)}var Xe;if(Ha)e:{switch(a){case"compositionstart":var et="onCompositionStart";break e;case"compositionend":et="onCompositionEnd";break e;case"compositionupdate":et="onCompositionUpdate";break e}et=void 0}else Rt?ye(a,l)&&(et="onCompositionEnd"):a==="keydown"&&l.keyCode===229&&(et="onCompositionStart");et&&(R&&l.locale!=="ko"&&(Rt||et!=="onCompositionStart"?et==="onCompositionEnd"&&Rt&&(Xe=Cc()):(Ua=Ae,$i="value"in Ua?Ua.value:Ua.textContent,Rt=!0)),gt=Mh(pe,et),0<gt.length&&(et=new bc(et,a,null,l,Ae),Re.push({event:et,listeners:gt}),Xe?et.data=Xe:(Xe=Ve(l),Xe!==null&&(et.data=Xe)))),(Xe=y?br(a,l):kt(a,l))&&(et=Mh(pe,"onBeforeInput"),0<et.length&&(gt=new bc("onBeforeInput","beforeinput",null,l,Ae),Re.push({event:gt,listeners:et}),gt.data=Xe)),yC(Re,a,pe,l,Ae)}Ux(Re,s)})}function lu(a,s,l){return{instance:a,listener:s,currentTarget:l}}function Mh(a,s){for(var l=s+"Capture",f=[];a!==null;){var m=a,v=m.stateNode;if(m=m.tag,m!==5&&m!==26&&m!==27||v===null||(m=to(a,l),m!=null&&f.unshift(lu(a,m,v)),m=to(a,s),m!=null&&f.push(lu(a,m,v))),a.tag===3)return f;a=a.return}return[]}function Vl(a){if(a===null)return null;do a=a.return;while(a&&a.tag!==5&&a.tag!==27);return a||null}function jx(a,s,l,f,m){for(var v=s._reactName,b=[];l!==null&&l!==f;){var M=l,te=M.alternate,pe=M.stateNode;if(M=M.tag,te!==null&&te===f)break;M!==5&&M!==26&&M!==27||pe===null||(te=pe,m?(pe=to(l,v),pe!=null&&b.unshift(lu(l,pe,te))):m||(pe=to(l,v),pe!=null&&b.push(lu(l,pe,te)))),l=l.return}b.length!==0&&a.push({event:s,listeners:b})}var wC=/\r\n?/g,SC=/\u0000|\uFFFD/g;function zx(a){return(typeof a=="string"?a:""+a).replace(wC,`
`).replace(SC,"")}function Hx(a,s){return s=zx(s),zx(a)===s}function Lh(){}function Xt(a,s,l,f,m,v){switch(l){case"children":typeof f=="string"?s==="body"||s==="textarea"&&f===""||Zn(a,f):(typeof f=="number"||typeof f=="bigint")&&s!=="body"&&Zn(a,""+f);break;case"className":St(a,"class",f);break;case"tabIndex":St(a,"tabindex",f);break;case"dir":case"role":case"viewBox":case"width":case"height":St(a,l,f);break;case"style":Ac(a,f,v);break;case"data":if(s!=="object"){St(a,"data",f);break}case"src":case"href":if(f===""&&(s!=="a"||l!=="href")){a.removeAttribute(l);break}if(f==null||typeof f=="function"||typeof f=="symbol"||typeof f=="boolean"){a.removeAttribute(l);break}f=il(""+f),a.setAttribute(l,f);break;case"action":case"formAction":if(typeof f=="function"){a.setAttribute(l,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof v=="function"&&(l==="formAction"?(s!=="input"&&Xt(a,s,"name",m.name,m,null),Xt(a,s,"formEncType",m.formEncType,m,null),Xt(a,s,"formMethod",m.formMethod,m,null),Xt(a,s,"formTarget",m.formTarget,m,null)):(Xt(a,s,"encType",m.encType,m,null),Xt(a,s,"method",m.method,m,null),Xt(a,s,"target",m.target,m,null)));if(f==null||typeof f=="symbol"||typeof f=="boolean"){a.removeAttribute(l);break}f=il(""+f),a.setAttribute(l,f);break;case"onClick":f!=null&&(a.onclick=Lh);break;case"onScroll":f!=null&&yt("scroll",a);break;case"onScrollEnd":f!=null&&yt("scrollend",a);break;case"dangerouslySetInnerHTML":if(f!=null){if(typeof f!="object"||!("__html"in f))throw Error(n(61));if(l=f.__html,l!=null){if(m.children!=null)throw Error(n(60));a.innerHTML=l}}break;case"multiple":a.multiple=f&&typeof f!="function"&&typeof f!="symbol";break;case"muted":a.muted=f&&typeof f!="function"&&typeof f!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(f==null||typeof f=="function"||typeof f=="boolean"||typeof f=="symbol"){a.removeAttribute("xlink:href");break}l=il(""+f),a.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",l);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":f!=null&&typeof f!="function"&&typeof f!="symbol"?a.setAttribute(l,""+f):a.removeAttribute(l);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":f&&typeof f!="function"&&typeof f!="symbol"?a.setAttribute(l,""):a.removeAttribute(l);break;case"capture":case"download":f===!0?a.setAttribute(l,""):f!==!1&&f!=null&&typeof f!="function"&&typeof f!="symbol"?a.setAttribute(l,f):a.removeAttribute(l);break;case"cols":case"rows":case"size":case"span":f!=null&&typeof f!="function"&&typeof f!="symbol"&&!isNaN(f)&&1<=f?a.setAttribute(l,f):a.removeAttribute(l);break;case"rowSpan":case"start":f==null||typeof f=="function"||typeof f=="symbol"||isNaN(f)?a.removeAttribute(l):a.setAttribute(l,f);break;case"popover":yt("beforetoggle",a),yt("toggle",a),Pt(a,"popover",f);break;case"xlinkActuate":Ct(a,"http://www.w3.org/1999/xlink","xlink:actuate",f);break;case"xlinkArcrole":Ct(a,"http://www.w3.org/1999/xlink","xlink:arcrole",f);break;case"xlinkRole":Ct(a,"http://www.w3.org/1999/xlink","xlink:role",f);break;case"xlinkShow":Ct(a,"http://www.w3.org/1999/xlink","xlink:show",f);break;case"xlinkTitle":Ct(a,"http://www.w3.org/1999/xlink","xlink:title",f);break;case"xlinkType":Ct(a,"http://www.w3.org/1999/xlink","xlink:type",f);break;case"xmlBase":Ct(a,"http://www.w3.org/XML/1998/namespace","xml:base",f);break;case"xmlLang":Ct(a,"http://www.w3.org/XML/1998/namespace","xml:lang",f);break;case"xmlSpace":Ct(a,"http://www.w3.org/XML/1998/namespace","xml:space",f);break;case"is":Pt(a,"is",f);break;case"innerText":case"textContent":break;default:(!(2<l.length)||l[0]!=="o"&&l[0]!=="O"||l[1]!=="n"&&l[1]!=="N")&&(l=Fd.get(l)||l,Pt(a,l,f))}}function fm(a,s,l,f,m,v){switch(l){case"style":Ac(a,f,v);break;case"dangerouslySetInnerHTML":if(f!=null){if(typeof f!="object"||!("__html"in f))throw Error(n(61));if(l=f.__html,l!=null){if(m.children!=null)throw Error(n(60));a.innerHTML=l}}break;case"children":typeof f=="string"?Zn(a,f):(typeof f=="number"||typeof f=="bigint")&&Zn(a,""+f);break;case"onScroll":f!=null&&yt("scroll",a);break;case"onScrollEnd":f!=null&&yt("scrollend",a);break;case"onClick":f!=null&&(a.onclick=Lh);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!ge.hasOwnProperty(l))e:{if(l[0]==="o"&&l[1]==="n"&&(m=l.endsWith("Capture"),s=l.slice(2,m?l.length-7:void 0),v=a[nr]||null,v=v!=null?v[l]:null,typeof v=="function"&&a.removeEventListener(s,v,m),typeof f=="function")){typeof v!="function"&&v!==null&&(l in a?a[l]=null:a.hasAttribute(l)&&a.removeAttribute(l)),a.addEventListener(s,f,m);break e}l in a?a[l]=f:f===!0?a.setAttribute(l,""):Pt(a,l,f)}}}function Yr(a,s,l){switch(s){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":yt("error",a),yt("load",a);var f=!1,m=!1,v;for(v in l)if(l.hasOwnProperty(v)){var b=l[v];if(b!=null)switch(v){case"src":f=!0;break;case"srcSet":m=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(n(137,s));default:Xt(a,s,v,b,l,null)}}m&&Xt(a,s,"srcSet",l.srcSet,l,null),f&&Xt(a,s,"src",l.src,l,null);return;case"input":yt("invalid",a);var M=v=b=m=null,te=null,pe=null;for(f in l)if(l.hasOwnProperty(f)){var Ae=l[f];if(Ae!=null)switch(f){case"name":m=Ae;break;case"type":b=Ae;break;case"checked":te=Ae;break;case"defaultChecked":pe=Ae;break;case"value":v=Ae;break;case"defaultValue":M=Ae;break;case"children":case"dangerouslySetInnerHTML":if(Ae!=null)throw Error(n(137,s));break;default:Xt(a,s,f,Ae,l,null)}}Zs(a,v,M,te,pe,b,m,!1),al(a);return;case"select":yt("invalid",a),f=b=v=null;for(m in l)if(l.hasOwnProperty(m)&&(M=l[m],M!=null))switch(m){case"value":v=M;break;case"defaultValue":b=M;break;case"multiple":f=M;default:Xt(a,s,m,M,l,null)}s=v,l=b,a.multiple=!!f,s!=null?ui(a,!!f,s,!1):l!=null&&ui(a,!!f,l,!0);return;case"textarea":yt("invalid",a),v=m=f=null;for(b in l)if(l.hasOwnProperty(b)&&(M=l[b],M!=null))switch(b){case"value":f=M;break;case"defaultValue":m=M;break;case"children":v=M;break;case"dangerouslySetInnerHTML":if(M!=null)throw Error(n(91));break;default:Xt(a,s,b,M,l,null)}Js(a,f,m,v),al(a);return;case"option":for(te in l)if(l.hasOwnProperty(te)&&(f=l[te],f!=null))switch(te){case"selected":a.selected=f&&typeof f!="function"&&typeof f!="symbol";break;default:Xt(a,s,te,f,l,null)}return;case"dialog":yt("beforetoggle",a),yt("toggle",a),yt("cancel",a),yt("close",a);break;case"iframe":case"object":yt("load",a);break;case"video":case"audio":for(f=0;f<ou.length;f++)yt(ou[f],a);break;case"image":yt("error",a),yt("load",a);break;case"details":yt("toggle",a);break;case"embed":case"source":case"link":yt("error",a),yt("load",a);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(pe in l)if(l.hasOwnProperty(pe)&&(f=l[pe],f!=null))switch(pe){case"children":case"dangerouslySetInnerHTML":throw Error(n(137,s));default:Xt(a,s,pe,f,l,null)}return;default:if(wc(s)){for(Ae in l)l.hasOwnProperty(Ae)&&(f=l[Ae],f!==void 0&&fm(a,s,Ae,f,l,void 0));return}}for(M in l)l.hasOwnProperty(M)&&(f=l[M],f!=null&&Xt(a,s,M,f,l,null))}function CC(a,s,l,f){switch(s){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var m=null,v=null,b=null,M=null,te=null,pe=null,Ae=null;for(_e in l){var Re=l[_e];if(l.hasOwnProperty(_e)&&Re!=null)switch(_e){case"checked":break;case"value":break;case"defaultValue":te=Re;default:f.hasOwnProperty(_e)||Xt(a,s,_e,null,f,Re)}}for(var ve in f){var _e=f[ve];if(Re=l[ve],f.hasOwnProperty(ve)&&(_e!=null||Re!=null))switch(ve){case"type":v=_e;break;case"name":m=_e;break;case"checked":pe=_e;break;case"defaultChecked":Ae=_e;break;case"value":b=_e;break;case"defaultValue":M=_e;break;case"children":case"dangerouslySetInnerHTML":if(_e!=null)throw Error(n(137,s));break;default:_e!==Re&&Xt(a,s,ve,_e,f,Re)}}Ln(a,b,M,te,pe,Ae,v,m);return;case"select":_e=b=M=ve=null;for(v in l)if(te=l[v],l.hasOwnProperty(v)&&te!=null)switch(v){case"value":break;case"multiple":_e=te;default:f.hasOwnProperty(v)||Xt(a,s,v,null,f,te)}for(m in f)if(v=f[m],te=l[m],f.hasOwnProperty(m)&&(v!=null||te!=null))switch(m){case"value":ve=v;break;case"defaultValue":M=v;break;case"multiple":b=v;default:v!==te&&Xt(a,s,m,v,f,te)}s=M,l=b,f=_e,ve!=null?ui(a,!!l,ve,!1):!!f!=!!l&&(s!=null?ui(a,!!l,s,!0):ui(a,!!l,l?[]:"",!1));return;case"textarea":_e=ve=null;for(M in l)if(m=l[M],l.hasOwnProperty(M)&&m!=null&&!f.hasOwnProperty(M))switch(M){case"value":break;case"children":break;default:Xt(a,s,M,null,f,m)}for(b in f)if(m=f[b],v=l[b],f.hasOwnProperty(b)&&(m!=null||v!=null))switch(b){case"value":ve=m;break;case"defaultValue":_e=m;break;case"children":break;case"dangerouslySetInnerHTML":if(m!=null)throw Error(n(91));break;default:m!==v&&Xt(a,s,b,m,f,v)}Kt(a,ve,_e);return;case"option":for(var it in l)if(ve=l[it],l.hasOwnProperty(it)&&ve!=null&&!f.hasOwnProperty(it))switch(it){case"selected":a.selected=!1;break;default:Xt(a,s,it,null,f,ve)}for(te in f)if(ve=f[te],_e=l[te],f.hasOwnProperty(te)&&ve!==_e&&(ve!=null||_e!=null))switch(te){case"selected":a.selected=ve&&typeof ve!="function"&&typeof ve!="symbol";break;default:Xt(a,s,te,ve,f,_e)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Qe in l)ve=l[Qe],l.hasOwnProperty(Qe)&&ve!=null&&!f.hasOwnProperty(Qe)&&Xt(a,s,Qe,null,f,ve);for(pe in f)if(ve=f[pe],_e=l[pe],f.hasOwnProperty(pe)&&ve!==_e&&(ve!=null||_e!=null))switch(pe){case"children":case"dangerouslySetInnerHTML":if(ve!=null)throw Error(n(137,s));break;default:Xt(a,s,pe,ve,f,_e)}return;default:if(wc(s)){for(var Yt in l)ve=l[Yt],l.hasOwnProperty(Yt)&&ve!==void 0&&!f.hasOwnProperty(Yt)&&fm(a,s,Yt,void 0,f,ve);for(Ae in f)ve=f[Ae],_e=l[Ae],!f.hasOwnProperty(Ae)||ve===_e||ve===void 0&&_e===void 0||fm(a,s,Ae,ve,f,_e);return}}for(var le in l)ve=l[le],l.hasOwnProperty(le)&&ve!=null&&!f.hasOwnProperty(le)&&Xt(a,s,le,null,f,ve);for(Re in f)ve=f[Re],_e=l[Re],!f.hasOwnProperty(Re)||ve===_e||ve==null&&_e==null||Xt(a,s,Re,ve,f,_e)}var hm=null,dm=null;function Vh(a){return a.nodeType===9?a:a.ownerDocument}function Gx(a){switch(a){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function qx(a,s){if(a===0)switch(s){case"svg":return 1;case"math":return 2;default:return 0}return a===1&&s==="foreignObject"?0:a}function pm(a,s){return a==="textarea"||a==="noscript"||typeof s.children=="string"||typeof s.children=="number"||typeof s.children=="bigint"||typeof s.dangerouslySetInnerHTML=="object"&&s.dangerouslySetInnerHTML!==null&&s.dangerouslySetInnerHTML.__html!=null}var mm=null;function RC(){var a=window.event;return a&&a.type==="popstate"?a===mm?!1:(mm=a,!0):(mm=null,!1)}var Kx=typeof setTimeout=="function"?setTimeout:void 0,kC=typeof clearTimeout=="function"?clearTimeout:void 0,Wx=typeof Promise=="function"?Promise:void 0,bC=typeof queueMicrotask=="function"?queueMicrotask:typeof Wx<"u"?function(a){return Wx.resolve(null).then(a).catch(IC)}:Kx;function IC(a){setTimeout(function(){throw a})}function hs(a){return a==="head"}function Xx(a,s){var l=s,f=0,m=0;do{var v=l.nextSibling;if(a.removeChild(l),v&&v.nodeType===8)if(l=v.data,l==="/$"){if(0<f&&8>f){l=f;var b=a.ownerDocument;if(l&1&&cu(b.documentElement),l&2&&cu(b.body),l&4)for(l=b.head,cu(l),b=l.firstChild;b;){var M=b.nextSibling,te=b.nodeName;b[U]||te==="SCRIPT"||te==="STYLE"||te==="LINK"&&b.rel.toLowerCase()==="stylesheet"||l.removeChild(b),b=M}}if(m===0){a.removeChild(v),vu(s);return}m--}else l==="$"||l==="$?"||l==="$!"?m++:f=l.charCodeAt(0)-48;else f=0;l=v}while(l);vu(s)}function gm(a){var s=a.firstChild;for(s&&s.nodeType===10&&(s=s.nextSibling);s;){var l=s;switch(s=s.nextSibling,l.nodeName){case"HTML":case"HEAD":case"BODY":gm(l),B(l);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(l.rel.toLowerCase()==="stylesheet")continue}a.removeChild(l)}}function DC(a,s,l,f){for(;a.nodeType===1;){var m=l;if(a.nodeName.toLowerCase()!==s.toLowerCase()){if(!f&&(a.nodeName!=="INPUT"||a.type!=="hidden"))break}else if(f){if(!a[U])switch(s){case"meta":if(!a.hasAttribute("itemprop"))break;return a;case"link":if(v=a.getAttribute("rel"),v==="stylesheet"&&a.hasAttribute("data-precedence"))break;if(v!==m.rel||a.getAttribute("href")!==(m.href==null||m.href===""?null:m.href)||a.getAttribute("crossorigin")!==(m.crossOrigin==null?null:m.crossOrigin)||a.getAttribute("title")!==(m.title==null?null:m.title))break;return a;case"style":if(a.hasAttribute("data-precedence"))break;return a;case"script":if(v=a.getAttribute("src"),(v!==(m.src==null?null:m.src)||a.getAttribute("type")!==(m.type==null?null:m.type)||a.getAttribute("crossorigin")!==(m.crossOrigin==null?null:m.crossOrigin))&&v&&a.hasAttribute("async")&&!a.hasAttribute("itemprop"))break;return a;default:return a}}else if(s==="input"&&a.type==="hidden"){var v=m.name==null?null:""+m.name;if(m.type==="hidden"&&a.getAttribute("name")===v)return a}else return a;if(a=Aa(a.nextSibling),a===null)break}return null}function OC(a,s,l){if(s==="")return null;for(;a.nodeType!==3;)if((a.nodeType!==1||a.nodeName!=="INPUT"||a.type!=="hidden")&&!l||(a=Aa(a.nextSibling),a===null))return null;return a}function vm(a){return a.data==="$!"||a.data==="$?"&&a.ownerDocument.readyState==="complete"}function NC(a,s){var l=a.ownerDocument;if(a.data!=="$?"||l.readyState==="complete")s();else{var f=function(){s(),l.removeEventListener("DOMContentLoaded",f)};l.addEventListener("DOMContentLoaded",f),a._reactRetry=f}}function Aa(a){for(;a!=null;a=a.nextSibling){var s=a.nodeType;if(s===1||s===3)break;if(s===8){if(s=a.data,s==="$"||s==="$!"||s==="$?"||s==="F!"||s==="F")break;if(s==="/$")return null}}return a}var _m=null;function Yx(a){a=a.previousSibling;for(var s=0;a;){if(a.nodeType===8){var l=a.data;if(l==="$"||l==="$!"||l==="$?"){if(s===0)return a;s--}else l==="/$"&&s++}a=a.previousSibling}return null}function $x(a,s,l){switch(s=Vh(l),a){case"html":if(a=s.documentElement,!a)throw Error(n(452));return a;case"head":if(a=s.head,!a)throw Error(n(453));return a;case"body":if(a=s.body,!a)throw Error(n(454));return a;default:throw Error(n(451))}}function cu(a){for(var s=a.attributes;s.length;)a.removeAttributeNode(s[0]);B(a)}var la=new Map,Qx=new Set;function Uh(a){return typeof a.getRootNode=="function"?a.getRootNode():a.nodeType===9?a:a.ownerDocument}var bi=oe.d;oe.d={f:FC,r:PC,D:MC,C:LC,L:VC,m:UC,X:jC,S:BC,M:zC};function FC(){var a=bi.f(),s=Ih();return a||s}function PC(a){var s=X(a);s!==null&&s.tag===5&&s.type==="form"?v_(s):bi.r(a)}var Ul=typeof document>"u"?null:document;function Zx(a,s,l){var f=Ul;if(f&&typeof s=="string"&&s){var m=xr(s);m='link[rel="'+a+'"][href="'+m+'"]',typeof l=="string"&&(m+='[crossorigin="'+l+'"]'),Qx.has(m)||(Qx.add(m),a={rel:a,crossOrigin:l,href:s},f.querySelector(m)===null&&(s=f.createElement("link"),Yr(s,"link",a),ce(s),f.head.appendChild(s)))}}function MC(a){bi.D(a),Zx("dns-prefetch",a,null)}function LC(a,s){bi.C(a,s),Zx("preconnect",a,s)}function VC(a,s,l){bi.L(a,s,l);var f=Ul;if(f&&a&&s){var m='link[rel="preload"][as="'+xr(s)+'"]';s==="image"&&l&&l.imageSrcSet?(m+='[imagesrcset="'+xr(l.imageSrcSet)+'"]',typeof l.imageSizes=="string"&&(m+='[imagesizes="'+xr(l.imageSizes)+'"]')):m+='[href="'+xr(a)+'"]';var v=m;switch(s){case"style":v=Bl(a);break;case"script":v=jl(a)}la.has(v)||(a=g({rel:"preload",href:s==="image"&&l&&l.imageSrcSet?void 0:a,as:s},l),la.set(v,a),f.querySelector(m)!==null||s==="style"&&f.querySelector(uu(v))||s==="script"&&f.querySelector(fu(v))||(s=f.createElement("link"),Yr(s,"link",a),ce(s),f.head.appendChild(s)))}}function UC(a,s){bi.m(a,s);var l=Ul;if(l&&a){var f=s&&typeof s.as=="string"?s.as:"script",m='link[rel="modulepreload"][as="'+xr(f)+'"][href="'+xr(a)+'"]',v=m;switch(f){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":v=jl(a)}if(!la.has(v)&&(a=g({rel:"modulepreload",href:a},s),la.set(v,a),l.querySelector(m)===null)){switch(f){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(l.querySelector(fu(v)))return}f=l.createElement("link"),Yr(f,"link",a),ce(f),l.head.appendChild(f)}}}function BC(a,s,l){bi.S(a,s,l);var f=Ul;if(f&&a){var m=xe(f).hoistableStyles,v=Bl(a);s=s||"default";var b=m.get(v);if(!b){var M={loading:0,preload:null};if(b=f.querySelector(uu(v)))M.loading=5;else{a=g({rel:"stylesheet",href:a,"data-precedence":s},l),(l=la.get(v))&&xm(a,l);var te=b=f.createElement("link");ce(te),Yr(te,"link",a),te._p=new Promise(function(pe,Ae){te.onload=pe,te.onerror=Ae}),te.addEventListener("load",function(){M.loading|=1}),te.addEventListener("error",function(){M.loading|=2}),M.loading|=4,Bh(b,s,f)}b={type:"stylesheet",instance:b,count:1,state:M},m.set(v,b)}}}function jC(a,s){bi.X(a,s);var l=Ul;if(l&&a){var f=xe(l).hoistableScripts,m=jl(a),v=f.get(m);v||(v=l.querySelector(fu(m)),v||(a=g({src:a,async:!0},s),(s=la.get(m))&&ym(a,s),v=l.createElement("script"),ce(v),Yr(v,"link",a),l.head.appendChild(v)),v={type:"script",instance:v,count:1,state:null},f.set(m,v))}}function zC(a,s){bi.M(a,s);var l=Ul;if(l&&a){var f=xe(l).hoistableScripts,m=jl(a),v=f.get(m);v||(v=l.querySelector(fu(m)),v||(a=g({src:a,async:!0,type:"module"},s),(s=la.get(m))&&ym(a,s),v=l.createElement("script"),ce(v),Yr(v,"link",a),l.head.appendChild(v)),v={type:"script",instance:v,count:1,state:null},f.set(m,v))}}function Jx(a,s,l,f){var m=(m=ue.current)?Uh(m):null;if(!m)throw Error(n(446));switch(a){case"meta":case"title":return null;case"style":return typeof l.precedence=="string"&&typeof l.href=="string"?(s=Bl(l.href),l=xe(m).hoistableStyles,f=l.get(s),f||(f={type:"style",instance:null,count:0,state:null},l.set(s,f)),f):{type:"void",instance:null,count:0,state:null};case"link":if(l.rel==="stylesheet"&&typeof l.href=="string"&&typeof l.precedence=="string"){a=Bl(l.href);var v=xe(m).hoistableStyles,b=v.get(a);if(b||(m=m.ownerDocument||m,b={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},v.set(a,b),(v=m.querySelector(uu(a)))&&!v._p&&(b.instance=v,b.state.loading=5),la.has(a)||(l={rel:"preload",as:"style",href:l.href,crossOrigin:l.crossOrigin,integrity:l.integrity,media:l.media,hrefLang:l.hrefLang,referrerPolicy:l.referrerPolicy},la.set(a,l),v||HC(m,a,l,b.state))),s&&f===null)throw Error(n(528,""));return b}if(s&&f!==null)throw Error(n(529,""));return null;case"script":return s=l.async,l=l.src,typeof l=="string"&&s&&typeof s!="function"&&typeof s!="symbol"?(s=jl(l),l=xe(m).hoistableScripts,f=l.get(s),f||(f={type:"script",instance:null,count:0,state:null},l.set(s,f)),f):{type:"void",instance:null,count:0,state:null};default:throw Error(n(444,a))}}function Bl(a){return'href="'+xr(a)+'"'}function uu(a){return'link[rel="stylesheet"]['+a+"]"}function ey(a){return g({},a,{"data-precedence":a.precedence,precedence:null})}function HC(a,s,l,f){a.querySelector('link[rel="preload"][as="style"]['+s+"]")?f.loading=1:(s=a.createElement("link"),f.preload=s,s.addEventListener("load",function(){return f.loading|=1}),s.addEventListener("error",function(){return f.loading|=2}),Yr(s,"link",l),ce(s),a.head.appendChild(s))}function jl(a){return'[src="'+xr(a)+'"]'}function fu(a){return"script[async]"+a}function ty(a,s,l){if(s.count++,s.instance===null)switch(s.type){case"style":var f=a.querySelector('style[data-href~="'+xr(l.href)+'"]');if(f)return s.instance=f,ce(f),f;var m=g({},l,{"data-href":l.href,"data-precedence":l.precedence,href:null,precedence:null});return f=(a.ownerDocument||a).createElement("style"),ce(f),Yr(f,"style",m),Bh(f,l.precedence,a),s.instance=f;case"stylesheet":m=Bl(l.href);var v=a.querySelector(uu(m));if(v)return s.state.loading|=4,s.instance=v,ce(v),v;f=ey(l),(m=la.get(m))&&xm(f,m),v=(a.ownerDocument||a).createElement("link"),ce(v);var b=v;return b._p=new Promise(function(M,te){b.onload=M,b.onerror=te}),Yr(v,"link",f),s.state.loading|=4,Bh(v,l.precedence,a),s.instance=v;case"script":return v=jl(l.src),(m=a.querySelector(fu(v)))?(s.instance=m,ce(m),m):(f=l,(m=la.get(v))&&(f=g({},l),ym(f,m)),a=a.ownerDocument||a,m=a.createElement("script"),ce(m),Yr(m,"link",f),a.head.appendChild(m),s.instance=m);case"void":return null;default:throw Error(n(443,s.type))}else s.type==="stylesheet"&&(s.state.loading&4)===0&&(f=s.instance,s.state.loading|=4,Bh(f,l.precedence,a));return s.instance}function Bh(a,s,l){for(var f=l.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),m=f.length?f[f.length-1]:null,v=m,b=0;b<f.length;b++){var M=f[b];if(M.dataset.precedence===s)v=M;else if(v!==m)break}v?v.parentNode.insertBefore(a,v.nextSibling):(s=l.nodeType===9?l.head:l,s.insertBefore(a,s.firstChild))}function xm(a,s){a.crossOrigin==null&&(a.crossOrigin=s.crossOrigin),a.referrerPolicy==null&&(a.referrerPolicy=s.referrerPolicy),a.title==null&&(a.title=s.title)}function ym(a,s){a.crossOrigin==null&&(a.crossOrigin=s.crossOrigin),a.referrerPolicy==null&&(a.referrerPolicy=s.referrerPolicy),a.integrity==null&&(a.integrity=s.integrity)}var jh=null;function ry(a,s,l){if(jh===null){var f=new Map,m=jh=new Map;m.set(l,f)}else m=jh,f=m.get(l),f||(f=new Map,m.set(l,f));if(f.has(a))return f;for(f.set(a,null),l=l.getElementsByTagName(a),m=0;m<l.length;m++){var v=l[m];if(!(v[U]||v[dr]||a==="link"&&v.getAttribute("rel")==="stylesheet")&&v.namespaceURI!=="http://www.w3.org/2000/svg"){var b=v.getAttribute(s)||"";b=a+b;var M=f.get(b);M?M.push(v):f.set(b,[v])}}return f}function ny(a,s,l){a=a.ownerDocument||a,a.head.insertBefore(l,s==="title"?a.querySelector("head > title"):null)}function GC(a,s,l){if(l===1||s.itemProp!=null)return!1;switch(a){case"meta":case"title":return!0;case"style":if(typeof s.precedence!="string"||typeof s.href!="string"||s.href==="")break;return!0;case"link":if(typeof s.rel!="string"||typeof s.href!="string"||s.href===""||s.onLoad||s.onError)break;switch(s.rel){case"stylesheet":return a=s.disabled,typeof s.precedence=="string"&&a==null;default:return!0}case"script":if(s.async&&typeof s.async!="function"&&typeof s.async!="symbol"&&!s.onLoad&&!s.onError&&s.src&&typeof s.src=="string")return!0}return!1}function ay(a){return!(a.type==="stylesheet"&&(a.state.loading&3)===0)}var hu=null;function qC(){}function KC(a,s,l){if(hu===null)throw Error(n(475));var f=hu;if(s.type==="stylesheet"&&(typeof l.media!="string"||matchMedia(l.media).matches!==!1)&&(s.state.loading&4)===0){if(s.instance===null){var m=Bl(l.href),v=a.querySelector(uu(m));if(v){a=v._p,a!==null&&typeof a=="object"&&typeof a.then=="function"&&(f.count++,f=zh.bind(f),a.then(f,f)),s.state.loading|=4,s.instance=v,ce(v);return}v=a.ownerDocument||a,l=ey(l),(m=la.get(m))&&xm(l,m),v=v.createElement("link"),ce(v);var b=v;b._p=new Promise(function(M,te){b.onload=M,b.onerror=te}),Yr(v,"link",l),s.instance=v}f.stylesheets===null&&(f.stylesheets=new Map),f.stylesheets.set(s,a),(a=s.state.preload)&&(s.state.loading&3)===0&&(f.count++,s=zh.bind(f),a.addEventListener("load",s),a.addEventListener("error",s))}}function WC(){if(hu===null)throw Error(n(475));var a=hu;return a.stylesheets&&a.count===0&&Em(a,a.stylesheets),0<a.count?function(s){var l=setTimeout(function(){if(a.stylesheets&&Em(a,a.stylesheets),a.unsuspend){var f=a.unsuspend;a.unsuspend=null,f()}},6e4);return a.unsuspend=s,function(){a.unsuspend=null,clearTimeout(l)}}:null}function zh(){if(this.count--,this.count===0){if(this.stylesheets)Em(this,this.stylesheets);else if(this.unsuspend){var a=this.unsuspend;this.unsuspend=null,a()}}}var Hh=null;function Em(a,s){a.stylesheets=null,a.unsuspend!==null&&(a.count++,Hh=new Map,s.forEach(XC,a),Hh=null,zh.call(a))}function XC(a,s){if(!(s.state.loading&4)){var l=Hh.get(a);if(l)var f=l.get(null);else{l=new Map,Hh.set(a,l);for(var m=a.querySelectorAll("link[data-precedence],style[data-precedence]"),v=0;v<m.length;v++){var b=m[v];(b.nodeName==="LINK"||b.getAttribute("media")!=="not all")&&(l.set(b.dataset.precedence,b),f=b)}f&&l.set(null,f)}m=s.instance,b=m.getAttribute("data-precedence"),v=l.get(b)||f,v===f&&l.set(null,m),l.set(b,m),this.count++,f=zh.bind(this),m.addEventListener("load",f),m.addEventListener("error",f),v?v.parentNode.insertBefore(m,v.nextSibling):(a=a.nodeType===9?a.head:a,a.insertBefore(m,a.firstChild)),s.state.loading|=4}}var du={$$typeof:L,Provider:null,Consumer:null,_currentValue:be,_currentValue2:be,_threadCount:0};function YC(a,s,l,f,m,v,b,M){this.tag=1,this.containerInfo=a,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=_a(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=_a(0),this.hiddenUpdates=_a(null),this.identifierPrefix=f,this.onUncaughtError=m,this.onCaughtError=v,this.onRecoverableError=b,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=M,this.incompleteTransitions=new Map}function iy(a,s,l,f,m,v,b,M,te,pe,Ae,Re){return a=new YC(a,s,l,b,M,te,pe,Re),s=1,v===!0&&(s|=24),v=Un(3,null,null,s),a.current=v,v.stateNode=a,s=rp(),s.refCount++,a.pooledCache=s,s.refCount++,v.memoizedState={element:f,isDehydrated:l,cache:s},sp(v),a}function sy(a){return a?(a=_l,a):_l}function oy(a,s,l,f,m,v){m=sy(m),f.context===null?f.context=m:f.pendingContext=m,f=Ji(s),f.payload={element:l},v=v===void 0?null:v,v!==null&&(f.callback=v),l=es(a,f,s),l!==null&&(Gn(l,a,s),Hc(l,a,s))}function ly(a,s){if(a=a.memoizedState,a!==null&&a.dehydrated!==null){var l=a.retryLane;a.retryLane=l!==0&&l<s?l:s}}function Tm(a,s){ly(a,s),(a=a.alternate)&&ly(a,s)}function cy(a){if(a.tag===13){var s=vl(a,67108864);s!==null&&Gn(s,a,67108864),Tm(a,67108864)}}var Gh=!0;function $C(a,s,l,f){var m=ae.T;ae.T=null;var v=oe.p;try{oe.p=2,Am(a,s,l,f)}finally{oe.p=v,ae.T=m}}function QC(a,s,l,f){var m=ae.T;ae.T=null;var v=oe.p;try{oe.p=8,Am(a,s,l,f)}finally{oe.p=v,ae.T=m}}function Am(a,s,l,f){if(Gh){var m=wm(f);if(m===null)um(a,s,f,qh,l),fy(a,f);else if(JC(m,a,s,l,f))f.stopPropagation();else if(fy(a,f),s&4&&-1<ZC.indexOf(a)){for(;m!==null;){var v=X(m);if(v!==null)switch(v.tag){case 3:if(v=v.stateNode,v.current.memoizedState.isDehydrated){var b=Cn(v.pendingLanes);if(b!==0){var M=v;for(M.pendingLanes|=2,M.entangledLanes|=2;b;){var te=1<<31-Lt(b);M.entanglements[1]|=te,b&=~te}Ya(v),(zt&6)===0&&(kh=Ne()+500,su(0))}}break;case 13:M=vl(v,2),M!==null&&Gn(M,v,2),Ih(),Tm(v,2)}if(v=wm(f),v===null&&um(a,s,f,qh,l),v===m)break;m=v}m!==null&&f.stopPropagation()}else um(a,s,f,null,l)}}function wm(a){return a=Jn(a),Sm(a)}var qh=null;function Sm(a){if(qh=null,a=H(a),a!==null){var s=o(a);if(s===null)a=null;else{var l=s.tag;if(l===13){if(a=c(s),a!==null)return a;a=null}else if(l===3){if(s.stateNode.current.memoizedState.isDehydrated)return s.tag===3?s.stateNode.containerInfo:null;a=null}else s!==a&&(a=null)}}return qh=a,null}function uy(a){switch(a){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Ye()){case ut:return 2;case _t:return 8;case rr:case _r:return 32;case hr:return 268435456;default:return 32}default:return 32}}var Cm=!1,ds=null,ps=null,ms=null,pu=new Map,mu=new Map,gs=[],ZC="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function fy(a,s){switch(a){case"focusin":case"focusout":ds=null;break;case"dragenter":case"dragleave":ps=null;break;case"mouseover":case"mouseout":ms=null;break;case"pointerover":case"pointerout":pu.delete(s.pointerId);break;case"gotpointercapture":case"lostpointercapture":mu.delete(s.pointerId)}}function gu(a,s,l,f,m,v){return a===null||a.nativeEvent!==v?(a={blockedOn:s,domEventName:l,eventSystemFlags:f,nativeEvent:v,targetContainers:[m]},s!==null&&(s=X(s),s!==null&&cy(s)),a):(a.eventSystemFlags|=f,s=a.targetContainers,m!==null&&s.indexOf(m)===-1&&s.push(m),a)}function JC(a,s,l,f,m){switch(s){case"focusin":return ds=gu(ds,a,s,l,f,m),!0;case"dragenter":return ps=gu(ps,a,s,l,f,m),!0;case"mouseover":return ms=gu(ms,a,s,l,f,m),!0;case"pointerover":var v=m.pointerId;return pu.set(v,gu(pu.get(v)||null,a,s,l,f,m)),!0;case"gotpointercapture":return v=m.pointerId,mu.set(v,gu(mu.get(v)||null,a,s,l,f,m)),!0}return!1}function hy(a){var s=H(a.target);if(s!==null){var l=o(s);if(l!==null){if(s=l.tag,s===13){if(s=c(l),s!==null){a.blockedOn=s,rl(a.priority,function(){if(l.tag===13){var f=Hn();f=Fa(f);var m=vl(l,f);m!==null&&Gn(m,l,f),Tm(l,f)}});return}}else if(s===3&&l.stateNode.current.memoizedState.isDehydrated){a.blockedOn=l.tag===3?l.stateNode.containerInfo:null;return}}}a.blockedOn=null}function Kh(a){if(a.blockedOn!==null)return!1;for(var s=a.targetContainers;0<s.length;){var l=wm(a.nativeEvent);if(l===null){l=a.nativeEvent;var f=new l.constructor(l.type,l);fi=f,l.target.dispatchEvent(f),fi=null}else return s=X(l),s!==null&&cy(s),a.blockedOn=l,!1;s.shift()}return!0}function dy(a,s,l){Kh(a)&&l.delete(s)}function eR(){Cm=!1,ds!==null&&Kh(ds)&&(ds=null),ps!==null&&Kh(ps)&&(ps=null),ms!==null&&Kh(ms)&&(ms=null),pu.forEach(dy),mu.forEach(dy)}function Wh(a,s){a.blockedOn===s&&(a.blockedOn=null,Cm||(Cm=!0,t.unstable_scheduleCallback(t.unstable_NormalPriority,eR)))}var Xh=null;function py(a){Xh!==a&&(Xh=a,t.unstable_scheduleCallback(t.unstable_NormalPriority,function(){Xh===a&&(Xh=null);for(var s=0;s<a.length;s+=3){var l=a[s],f=a[s+1],m=a[s+2];if(typeof f!="function"){if(Sm(f||l)===null)continue;break}var v=X(l);v!==null&&(a.splice(s,3),s-=3,Sp(v,{pending:!0,data:m,method:l.method,action:f},f,m))}}))}function vu(a){function s(te){return Wh(te,a)}ds!==null&&Wh(ds,a),ps!==null&&Wh(ps,a),ms!==null&&Wh(ms,a),pu.forEach(s),mu.forEach(s);for(var l=0;l<gs.length;l++){var f=gs[l];f.blockedOn===a&&(f.blockedOn=null)}for(;0<gs.length&&(l=gs[0],l.blockedOn===null);)hy(l),l.blockedOn===null&&gs.shift();if(l=(a.ownerDocument||a).$$reactFormReplay,l!=null)for(f=0;f<l.length;f+=3){var m=l[f],v=l[f+1],b=m[nr]||null;if(typeof v=="function")b||py(l);else if(b){var M=null;if(v&&v.hasAttribute("formAction")){if(m=v,b=v[nr]||null)M=b.formAction;else if(Sm(m)!==null)continue}else M=b.action;typeof M=="function"?l[f+1]=M:(l.splice(f,3),f-=3),py(l)}}}function Rm(a){this._internalRoot=a}Yh.prototype.render=Rm.prototype.render=function(a){var s=this._internalRoot;if(s===null)throw Error(n(409));var l=s.current,f=Hn();oy(l,f,a,s,null,null)},Yh.prototype.unmount=Rm.prototype.unmount=function(){var a=this._internalRoot;if(a!==null){this._internalRoot=null;var s=a.containerInfo;oy(a.current,2,null,a,null,null),Ih(),s[Rn]=null}};function Yh(a){this._internalRoot=a}Yh.prototype.unstable_scheduleHydration=function(a){if(a){var s=Pa();a={blockedOn:null,target:a,priority:s};for(var l=0;l<gs.length&&s!==0&&s<gs[l].priority;l++);gs.splice(l,0,a),l===0&&hy(a)}};var my=e.version;if(my!=="19.1.0")throw Error(n(527,my,"19.1.0"));oe.findDOMNode=function(a){var s=a._reactInternals;if(s===void 0)throw typeof a.render=="function"?Error(n(188)):(a=Object.keys(a).join(","),Error(n(268,a)));return a=h(s),a=a!==null?p(a):null,a=a===null?null:a.stateNode,a};var tR={bundleType:0,version:"19.1.0",rendererPackageName:"react-dom",currentDispatcherRef:ae,reconcilerVersion:"19.1.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var $h=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!$h.isDisabled&&$h.supportsFiber)try{Ze=$h.inject(tR),Je=$h}catch{}}return xu.createRoot=function(a,s){if(!i(a))throw Error(n(299));var l=!1,f="",m=D_,v=O_,b=N_,M=null;return s!=null&&(s.unstable_strictMode===!0&&(l=!0),s.identifierPrefix!==void 0&&(f=s.identifierPrefix),s.onUncaughtError!==void 0&&(m=s.onUncaughtError),s.onCaughtError!==void 0&&(v=s.onCaughtError),s.onRecoverableError!==void 0&&(b=s.onRecoverableError),s.unstable_transitionCallbacks!==void 0&&(M=s.unstable_transitionCallbacks)),s=iy(a,1,!1,null,null,l,f,m,v,b,M,null),a[Rn]=s.current,cm(a),new Rm(s)},xu.hydrateRoot=function(a,s,l){if(!i(a))throw Error(n(299));var f=!1,m="",v=D_,b=O_,M=N_,te=null,pe=null;return l!=null&&(l.unstable_strictMode===!0&&(f=!0),l.identifierPrefix!==void 0&&(m=l.identifierPrefix),l.onUncaughtError!==void 0&&(v=l.onUncaughtError),l.onCaughtError!==void 0&&(b=l.onCaughtError),l.onRecoverableError!==void 0&&(M=l.onRecoverableError),l.unstable_transitionCallbacks!==void 0&&(te=l.unstable_transitionCallbacks),l.formState!==void 0&&(pe=l.formState)),s=iy(a,1,!0,s,l??null,f,m,v,b,M,te,pe),s.context=sy(null),l=s.current,f=Hn(),f=Fa(f),m=Ji(f),m.callback=null,es(l,m,f),l=f,s.current.lanes=l,xa(s,l),Ya(s),a[Rn]=s.current,cm(a),new Yh(s)},xu.version="19.1.0",xu}var Sy;function hR(){if(Sy)return Im.exports;Sy=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}return t(),Im.exports=fR(),Im.exports}var dR=hR();const pR=Ug(dR);f2();/**
 * @remix-run/router v1.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Ku(){return Ku=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Ku.apply(this,arguments)}var Ss;(function(t){t.Pop="POP",t.Push="PUSH",t.Replace="REPLACE"})(Ss||(Ss={}));const Cy="popstate";function mR(t){t===void 0&&(t={});function e(i,o){let{pathname:c="/",search:u="",hash:h=""}=zo(i.location.hash.substr(1));return!c.startsWith("/")&&!c.startsWith(".")&&(c="/"+c),rg("",{pathname:c,search:u,hash:h},o.state&&o.state.usr||null,o.state&&o.state.key||"default")}function r(i,o){let c=i.document.querySelector("base"),u="";if(c&&c.getAttribute("href")){let h=i.location.href,p=h.indexOf("#");u=p===-1?h:h.slice(0,p)}return u+"#"+(typeof o=="string"?o:h2(o))}function n(i,o){jg(i.pathname.charAt(0)==="/","relative pathnames are not supported in hash history.push("+JSON.stringify(o)+")")}return vR(e,r,n,t)}function kr(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function jg(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function gR(){return Math.random().toString(36).substr(2,8)}function Ry(t,e){return{usr:t.state,key:t.key,idx:e}}function rg(t,e,r,n){return r===void 0&&(r=null),Ku({pathname:typeof t=="string"?t:t.pathname,search:"",hash:""},typeof e=="string"?zo(e):e,{state:r,key:e&&e.key||n||gR()})}function h2(t){let{pathname:e="/",search:r="",hash:n=""}=t;return r&&r!=="?"&&(e+=r.charAt(0)==="?"?r:"?"+r),n&&n!=="#"&&(e+=n.charAt(0)==="#"?n:"#"+n),e}function zo(t){let e={};if(t){let r=t.indexOf("#");r>=0&&(e.hash=t.substr(r),t=t.substr(0,r));let n=t.indexOf("?");n>=0&&(e.search=t.substr(n),t=t.substr(0,n)),t&&(e.pathname=t)}return e}function vR(t,e,r,n){n===void 0&&(n={});let{window:i=document.defaultView,v5Compat:o=!1}=n,c=i.history,u=Ss.Pop,h=null,p=g();p==null&&(p=0,c.replaceState(Ku({},c.state,{idx:p}),""));function g(){return(c.state||{idx:null}).idx}function _(){u=Ss.Pop;let C=g(),z=C==null?null:C-p;p=C,h&&h({action:u,location:S.location,delta:z})}function x(C,z){u=Ss.Push;let Y=rg(S.location,C,z);r&&r(Y,C),p=g()+1;let L=Ry(Y,p),K=S.createHref(Y);try{c.pushState(L,"",K)}catch(Z){if(Z instanceof DOMException&&Z.name==="DataCloneError")throw Z;i.location.assign(K)}o&&h&&h({action:u,location:S.location,delta:1})}function T(C,z){u=Ss.Replace;let Y=rg(S.location,C,z);r&&r(Y,C),p=g();let L=Ry(Y,p),K=S.createHref(Y);c.replaceState(L,"",K),o&&h&&h({action:u,location:S.location,delta:0})}function w(C){let z=i.location.origin!=="null"?i.location.origin:i.location.href,Y=typeof C=="string"?C:h2(C);return Y=Y.replace(/ $/,"%20"),kr(z,"No window.location.(origin|href) available to create URL for href: "+Y),new URL(Y,z)}let S={get action(){return u},get location(){return t(i,c)},listen(C){if(h)throw new Error("A history only accepts one active listener");return i.addEventListener(Cy,_),h=C,()=>{i.removeEventListener(Cy,_),h=null}},createHref(C){return e(i,C)},createURL:w,encodeLocation(C){let z=w(C);return{pathname:z.pathname,search:z.search,hash:z.hash}},push:x,replace:T,go(C){return c.go(C)}};return S}var ky;(function(t){t.data="data",t.deferred="deferred",t.redirect="redirect",t.error="error"})(ky||(ky={}));function _R(t,e,r){return r===void 0&&(r="/"),xR(t,e,r)}function xR(t,e,r,n){let i=typeof e=="string"?zo(e):e,o=m2(i.pathname||"/",r);if(o==null)return null;let c=d2(t);yR(c);let u=null;for(let h=0;u==null&&h<c.length;++h){let p=OR(o);u=bR(c[h],p)}return u}function d2(t,e,r,n){e===void 0&&(e=[]),r===void 0&&(r=[]),n===void 0&&(n="");let i=(o,c,u)=>{let h={relativePath:u===void 0?o.path||"":u,caseSensitive:o.caseSensitive===!0,childrenIndex:c,route:o};h.relativePath.startsWith("/")&&(kr(h.relativePath.startsWith(n),'Absolute route path "'+h.relativePath+'" nested under path '+('"'+n+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),h.relativePath=h.relativePath.slice(n.length));let p=Io([n,h.relativePath]),g=r.concat(h);o.children&&o.children.length>0&&(kr(o.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+p+'".')),d2(o.children,e,g,p)),!(o.path==null&&!o.index)&&e.push({path:p,score:RR(p,o.index),routesMeta:g})};return t.forEach((o,c)=>{var u;if(o.path===""||!((u=o.path)!=null&&u.includes("?")))i(o,c);else for(let h of p2(o.path))i(o,c,h)}),e}function p2(t){let e=t.split("/");if(e.length===0)return[];let[r,...n]=e,i=r.endsWith("?"),o=r.replace(/\?$/,"");if(n.length===0)return i?[o,""]:[o];let c=p2(n.join("/")),u=[];return u.push(...c.map(h=>h===""?o:[o,h].join("/"))),i&&u.push(...c),u.map(h=>t.startsWith("/")&&h===""?"/":h)}function yR(t){t.sort((e,r)=>e.score!==r.score?r.score-e.score:kR(e.routesMeta.map(n=>n.childrenIndex),r.routesMeta.map(n=>n.childrenIndex)))}const ER=/^:[\w-]+$/,TR=3,AR=2,wR=1,SR=10,CR=-2,by=t=>t==="*";function RR(t,e){let r=t.split("/"),n=r.length;return r.some(by)&&(n+=CR),e&&(n+=AR),r.filter(i=>!by(i)).reduce((i,o)=>i+(ER.test(o)?TR:o===""?wR:SR),n)}function kR(t,e){return t.length===e.length&&t.slice(0,-1).every((n,i)=>n===e[i])?t[t.length-1]-e[e.length-1]:0}function bR(t,e,r){let{routesMeta:n}=t,i={},o="/",c=[];for(let u=0;u<n.length;++u){let h=n[u],p=u===n.length-1,g=o==="/"?e:e.slice(o.length)||"/",_=IR({path:h.relativePath,caseSensitive:h.caseSensitive,end:p},g),x=h.route;if(!_)return null;Object.assign(i,_.params),c.push({params:i,pathname:Io([o,_.pathname]),pathnameBase:MR(Io([o,_.pathnameBase])),route:x}),_.pathnameBase!=="/"&&(o=Io([o,_.pathnameBase]))}return c}function IR(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[r,n]=DR(t.path,t.caseSensitive,t.end),i=e.match(r);if(!i)return null;let o=i[0],c=o.replace(/(.)\/+$/,"$1"),u=i.slice(1);return{params:n.reduce((p,g,_)=>{let{paramName:x,isOptional:T}=g;if(x==="*"){let S=u[_]||"";c=o.slice(0,o.length-S.length).replace(/(.)\/+$/,"$1")}const w=u[_];return T&&!w?p[x]=void 0:p[x]=(w||"").replace(/%2F/g,"/"),p},{}),pathname:o,pathnameBase:c,pattern:t}}function DR(t,e,r){e===void 0&&(e=!1),r===void 0&&(r=!0),jg(t==="*"||!t.endsWith("*")||t.endsWith("/*"),'Route path "'+t+'" will be treated as if it were '+('"'+t.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+t.replace(/\*$/,"/*")+'".'));let n=[],i="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(c,u,h)=>(n.push({paramName:u,isOptional:h!=null}),h?"/?([^\\/]+)?":"/([^\\/]+)"));return t.endsWith("*")?(n.push({paramName:"*"}),i+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?i+="\\/*$":t!==""&&t!=="/"&&(i+="(?:(?=\\/|$))"),[new RegExp(i,e?void 0:"i"),n]}function OR(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return jg(!1,'The URL path "'+t+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),t}}function m2(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let r=e.endsWith("/")?e.length-1:e.length,n=t.charAt(r);return n&&n!=="/"?null:t.slice(r)||"/"}function NR(t,e){e===void 0&&(e="/");let{pathname:r,search:n="",hash:i=""}=typeof t=="string"?zo(t):t;return{pathname:r?r.startsWith("/")?r:FR(r,e):e,search:LR(n),hash:VR(i)}}function FR(t,e){let r=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(i=>{i===".."?r.length>1&&r.pop():i!=="."&&r.push(i)}),r.length>1?r.join("/"):"/"}function Fm(t,e,r,n){return"Cannot include a '"+t+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(n)+"].  Please separate it out to the ")+("`to."+r+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function PR(t){return t.filter((e,r)=>r===0||e.route.path&&e.route.path.length>0)}function g2(t,e){let r=PR(t);return e?r.map((n,i)=>i===r.length-1?n.pathname:n.pathnameBase):r.map(n=>n.pathnameBase)}function v2(t,e,r,n){n===void 0&&(n=!1);let i;typeof t=="string"?i=zo(t):(i=Ku({},t),kr(!i.pathname||!i.pathname.includes("?"),Fm("?","pathname","search",i)),kr(!i.pathname||!i.pathname.includes("#"),Fm("#","pathname","hash",i)),kr(!i.search||!i.search.includes("#"),Fm("#","search","hash",i)));let o=t===""||i.pathname==="",c=o?"/":i.pathname,u;if(c==null)u=r;else{let _=e.length-1;if(!n&&c.startsWith("..")){let x=c.split("/");for(;x[0]==="..";)x.shift(),_-=1;i.pathname=x.join("/")}u=_>=0?e[_]:"/"}let h=NR(i,u),p=c&&c!=="/"&&c.endsWith("/"),g=(o||c===".")&&r.endsWith("/");return!h.pathname.endsWith("/")&&(p||g)&&(h.pathname+="/"),h}const Io=t=>t.join("/").replace(/\/\/+/g,"/"),MR=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),LR=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,VR=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function UR(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}const _2=["post","put","patch","delete"];new Set(_2);const BR=["get",..._2];new Set(BR);/**
 * React Router v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Wu(){return Wu=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Wu.apply(this,arguments)}const zg=Pe.createContext(null),jR=Pe.createContext(null),df=Pe.createContext(null),rd=Pe.createContext(null),Ho=Pe.createContext({outlet:null,matches:[],isDataRoute:!1}),x2=Pe.createContext(null);function pf(){return Pe.useContext(rd)!=null}function Hg(){return pf()||kr(!1),Pe.useContext(rd).location}function y2(t){Pe.useContext(df).static||Pe.useLayoutEffect(t)}function E2(){let{isDataRoute:t}=Pe.useContext(Ho);return t?ek():zR()}function zR(){pf()||kr(!1);let t=Pe.useContext(zg),{basename:e,future:r,navigator:n}=Pe.useContext(df),{matches:i}=Pe.useContext(Ho),{pathname:o}=Hg(),c=JSON.stringify(g2(i,r.v7_relativeSplatPath)),u=Pe.useRef(!1);return y2(()=>{u.current=!0}),Pe.useCallback(function(p,g){if(g===void 0&&(g={}),!u.current)return;if(typeof p=="number"){n.go(p);return}let _=v2(p,JSON.parse(c),o,g.relative==="path");t==null&&e!=="/"&&(_.pathname=_.pathname==="/"?e:Io([e,_.pathname])),(g.replace?n.replace:n.push)(_,g.state,g)},[e,n,c,o,t])}function HR(t,e){return GR(t,e)}function GR(t,e,r,n){pf()||kr(!1);let{navigator:i}=Pe.useContext(df),{matches:o}=Pe.useContext(Ho),c=o[o.length-1],u=c?c.params:{};c&&c.pathname;let h=c?c.pathnameBase:"/";c&&c.route;let p=Hg(),g;if(e){var _;let C=typeof e=="string"?zo(e):e;h==="/"||(_=C.pathname)!=null&&_.startsWith(h)||kr(!1),g=C}else g=p;let x=g.pathname||"/",T=x;if(h!=="/"){let C=h.replace(/^\//,"").split("/");T="/"+x.replace(/^\//,"").split("/").slice(C.length).join("/")}let w=_R(t,{pathname:T}),S=YR(w&&w.map(C=>Object.assign({},C,{params:Object.assign({},u,C.params),pathname:Io([h,i.encodeLocation?i.encodeLocation(C.pathname).pathname:C.pathname]),pathnameBase:C.pathnameBase==="/"?h:Io([h,i.encodeLocation?i.encodeLocation(C.pathnameBase).pathname:C.pathnameBase])})),o,r,n);return e&&S?Pe.createElement(rd.Provider,{value:{location:Wu({pathname:"/",search:"",hash:"",state:null,key:"default"},g),navigationType:Ss.Pop}},S):S}function qR(){let t=JR(),e=UR(t)?t.status+" "+t.statusText:t instanceof Error?t.message:JSON.stringify(t),r=t instanceof Error?t.stack:null,i={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return Pe.createElement(Pe.Fragment,null,Pe.createElement("h2",null,"Unexpected Application Error!"),Pe.createElement("h3",{style:{fontStyle:"italic"}},e),r?Pe.createElement("pre",{style:i},r):null,null)}const KR=Pe.createElement(qR,null);class WR extends Pe.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,r){return r.location!==e.location||r.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:r.error,location:r.location,revalidation:e.revalidation||r.revalidation}}componentDidCatch(e,r){console.error("React Router caught the following error during render",e,r)}render(){return this.state.error!==void 0?Pe.createElement(Ho.Provider,{value:this.props.routeContext},Pe.createElement(x2.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function XR(t){let{routeContext:e,match:r,children:n}=t,i=Pe.useContext(zg);return i&&i.static&&i.staticContext&&(r.route.errorElement||r.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=r.route.id),Pe.createElement(Ho.Provider,{value:e},n)}function YR(t,e,r,n){var i;if(e===void 0&&(e=[]),r===void 0&&(r=null),n===void 0&&(n=null),t==null){var o;if(!r)return null;if(r.errors)t=r.matches;else if((o=n)!=null&&o.v7_partialHydration&&e.length===0&&!r.initialized&&r.matches.length>0)t=r.matches;else return null}let c=t,u=(i=r)==null?void 0:i.errors;if(u!=null){let g=c.findIndex(_=>_.route.id&&u?.[_.route.id]!==void 0);g>=0||kr(!1),c=c.slice(0,Math.min(c.length,g+1))}let h=!1,p=-1;if(r&&n&&n.v7_partialHydration)for(let g=0;g<c.length;g++){let _=c[g];if((_.route.HydrateFallback||_.route.hydrateFallbackElement)&&(p=g),_.route.id){let{loaderData:x,errors:T}=r,w=_.route.loader&&x[_.route.id]===void 0&&(!T||T[_.route.id]===void 0);if(_.route.lazy||w){h=!0,p>=0?c=c.slice(0,p+1):c=[c[0]];break}}}return c.reduceRight((g,_,x)=>{let T,w=!1,S=null,C=null;r&&(T=u&&_.route.id?u[_.route.id]:void 0,S=_.route.errorElement||KR,h&&(p<0&&x===0?(tk("route-fallback"),w=!0,C=null):p===x&&(w=!0,C=_.route.hydrateFallbackElement||null)));let z=e.concat(c.slice(0,x+1)),Y=()=>{let L;return T?L=S:w?L=C:_.route.Component?L=Pe.createElement(_.route.Component,null):_.route.element?L=_.route.element:L=g,Pe.createElement(XR,{match:_,routeContext:{outlet:g,matches:z,isDataRoute:r!=null},children:L})};return r&&(_.route.ErrorBoundary||_.route.errorElement||x===0)?Pe.createElement(WR,{location:r.location,revalidation:r.revalidation,component:S,error:T,children:Y(),routeContext:{outlet:null,matches:z,isDataRoute:!0}}):Y()},null)}var T2=function(t){return t.UseBlocker="useBlocker",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t}(T2||{}),A2=function(t){return t.UseBlocker="useBlocker",t.UseLoaderData="useLoaderData",t.UseActionData="useActionData",t.UseRouteError="useRouteError",t.UseNavigation="useNavigation",t.UseRouteLoaderData="useRouteLoaderData",t.UseMatches="useMatches",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t.UseRouteId="useRouteId",t}(A2||{});function $R(t){let e=Pe.useContext(zg);return e||kr(!1),e}function QR(t){let e=Pe.useContext(jR);return e||kr(!1),e}function ZR(t){let e=Pe.useContext(Ho);return e||kr(!1),e}function w2(t){let e=ZR(),r=e.matches[e.matches.length-1];return r.route.id||kr(!1),r.route.id}function JR(){var t;let e=Pe.useContext(x2),r=QR(),n=w2();return e!==void 0?e:(t=r.errors)==null?void 0:t[n]}function ek(){let{router:t}=$R(T2.UseNavigateStable),e=w2(A2.UseNavigateStable),r=Pe.useRef(!1);return y2(()=>{r.current=!0}),Pe.useCallback(function(i,o){o===void 0&&(o={}),r.current&&(typeof i=="number"?t.navigate(i):t.navigate(i,Wu({fromRouteId:e},o)))},[t,e])}const Iy={};function tk(t,e,r){Iy[t]||(Iy[t]=!0)}function rk(t,e){t?.v7_startTransition,t?.v7_relativeSplatPath}function S2(t){let{to:e,replace:r,state:n,relative:i}=t;pf()||kr(!1);let{future:o,static:c}=Pe.useContext(df),{matches:u}=Pe.useContext(Ho),{pathname:h}=Hg(),p=E2(),g=v2(e,g2(u,o.v7_relativeSplatPath),h,i==="path"),_=JSON.stringify(g);return Pe.useEffect(()=>p(JSON.parse(_),{replace:r,state:n,relative:i}),[p,_,i,r,n]),null}function ys(t){kr(!1)}function nk(t){let{basename:e="/",children:r=null,location:n,navigationType:i=Ss.Pop,navigator:o,static:c=!1,future:u}=t;pf()&&kr(!1);let h=e.replace(/^\/*/,"/"),p=Pe.useMemo(()=>({basename:h,navigator:o,static:c,future:Wu({v7_relativeSplatPath:!1},u)}),[h,u,o,c]);typeof n=="string"&&(n=zo(n));let{pathname:g="/",search:_="",hash:x="",state:T=null,key:w="default"}=n,S=Pe.useMemo(()=>{let C=m2(g,h);return C==null?null:{location:{pathname:C,search:_,hash:x,state:T,key:w},navigationType:i}},[h,g,_,x,T,w,i]);return S==null?null:Pe.createElement(df.Provider,{value:p},Pe.createElement(rd.Provider,{children:r,value:S}))}function ak(t){let{children:e,location:r}=t;return HR(ng(e),r)}new Promise(()=>{});function ng(t,e){e===void 0&&(e=[]);let r=[];return Pe.Children.forEach(t,(n,i)=>{if(!Pe.isValidElement(n))return;let o=[...e,i];if(n.type===Pe.Fragment){r.push.apply(r,ng(n.props.children,o));return}n.type!==ys&&kr(!1),!n.props.index||!n.props.children||kr(!1);let c={id:n.props.id||o.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,loader:n.props.loader,action:n.props.action,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(c.children=ng(n.props.children,o)),r.push(c)}),r}/**
 * React Router DOM v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */const ik="6";try{window.__reactRouterVersion=ik}catch{}const sk="startTransition",Dy=oR[sk];function ok(t){let{basename:e,children:r,future:n,window:i}=t,o=Pe.useRef();o.current==null&&(o.current=mR({window:i,v5Compat:!0}));let c=o.current,[u,h]=Pe.useState({action:c.action,location:c.location}),{v7_startTransition:p}=n||{},g=Pe.useCallback(_=>{p&&Dy?Dy(()=>h(_)):h(_)},[h,p]);return Pe.useLayoutEffect(()=>c.listen(g),[c,g]),Pe.useEffect(()=>rk(n),[n]),Pe.createElement(nk,{basename:e,children:r,location:u.location,navigationType:u.action,navigator:c,future:n})}var Oy;(function(t){t.UseScrollRestoration="useScrollRestoration",t.UseSubmit="useSubmit",t.UseSubmitFetcher="useSubmitFetcher",t.UseFetcher="useFetcher",t.useViewTransitionState="useViewTransitionState"})(Oy||(Oy={}));var Ny;(function(t){t.UseFetcher="useFetcher",t.UseFetchers="useFetchers",t.UseScrollRestoration="useScrollRestoration"})(Ny||(Ny={}));const lk=()=>{};var Fy={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const C2=function(t){const e=[];let r=0;for(let n=0;n<t.length;n++){let i=t.charCodeAt(n);i<128?e[r++]=i:i<2048?(e[r++]=i>>6|192,e[r++]=i&63|128):(i&64512)===55296&&n+1<t.length&&(t.charCodeAt(n+1)&64512)===56320?(i=65536+((i&1023)<<10)+(t.charCodeAt(++n)&1023),e[r++]=i>>18|240,e[r++]=i>>12&63|128,e[r++]=i>>6&63|128,e[r++]=i&63|128):(e[r++]=i>>12|224,e[r++]=i>>6&63|128,e[r++]=i&63|128)}return e},ck=function(t){const e=[];let r=0,n=0;for(;r<t.length;){const i=t[r++];if(i<128)e[n++]=String.fromCharCode(i);else if(i>191&&i<224){const o=t[r++];e[n++]=String.fromCharCode((i&31)<<6|o&63)}else if(i>239&&i<365){const o=t[r++],c=t[r++],u=t[r++],h=((i&7)<<18|(o&63)<<12|(c&63)<<6|u&63)-65536;e[n++]=String.fromCharCode(55296+(h>>10)),e[n++]=String.fromCharCode(56320+(h&1023))}else{const o=t[r++],c=t[r++];e[n++]=String.fromCharCode((i&15)<<12|(o&63)<<6|c&63)}}return e.join("")},R2={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const r=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,n=[];for(let i=0;i<t.length;i+=3){const o=t[i],c=i+1<t.length,u=c?t[i+1]:0,h=i+2<t.length,p=h?t[i+2]:0,g=o>>2,_=(o&3)<<4|u>>4;let x=(u&15)<<2|p>>6,T=p&63;h||(T=64,c||(x=64)),n.push(r[g],r[_],r[x],r[T])}return n.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(C2(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):ck(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const r=e?this.charToByteMapWebSafe_:this.charToByteMap_,n=[];for(let i=0;i<t.length;){const o=r[t.charAt(i++)],u=i<t.length?r[t.charAt(i)]:0;++i;const p=i<t.length?r[t.charAt(i)]:64;++i;const _=i<t.length?r[t.charAt(i)]:64;if(++i,o==null||u==null||p==null||_==null)throw new uk;const x=o<<2|u>>4;if(n.push(x),p!==64){const T=u<<4&240|p>>2;if(n.push(T),_!==64){const w=p<<6&192|_;n.push(w)}}}return n},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class uk extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const fk=function(t){const e=C2(t);return R2.encodeByteArray(e,!0)},S0=function(t){return fk(t).replace(/\./g,"")},k2=function(t){try{return R2.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hk(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dk=()=>hk().__FIREBASE_DEFAULTS__,pk=()=>{if(typeof process>"u"||typeof Fy>"u")return;const t=Fy.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},mk=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&k2(t[1]);return e&&JSON.parse(e)},nd=()=>{try{return lk()||dk()||pk()||mk()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},b2=t=>{var e,r;return(r=(e=nd())===null||e===void 0?void 0:e.emulatorHosts)===null||r===void 0?void 0:r[t]},gk=t=>{const e=b2(t);if(!e)return;const r=e.lastIndexOf(":");if(r<=0||r+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const n=parseInt(e.substring(r+1),10);return e[0]==="["?[e.substring(1,r-1),n]:[e.substring(0,r),n]},I2=()=>{var t;return(t=nd())===null||t===void 0?void 0:t.config},D2=t=>{var e;return(e=nd())===null||e===void 0?void 0:e[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vk{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,r)=>{this.resolve=e,this.reject=r})}wrapCallback(e){return(r,n)=>{r?this.reject(r):this.resolve(n),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(r):e(r,n))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hc(t){try{return(t.startsWith("http://")||t.startsWith("https://")?new URL(t).hostname:t).endsWith(".cloudworkstations.dev")}catch{return!1}}async function O2(t){return(await fetch(t,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _k(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const r={alg:"none",type:"JWT"},n=e||"demo-project",i=t.iat||0,o=t.sub||t.user_id;if(!o)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const c=Object.assign({iss:`https://securetoken.google.com/${n}`,aud:n,iat:i,exp:i+3600,auth_time:i,sub:o,user_id:o,firebase:{sign_in_provider:"custom",identities:{}}},t);return[S0(JSON.stringify(r)),S0(JSON.stringify(c)),""].join(".")}const Du={};function xk(){const t={prod:[],emulator:[]};for(const e of Object.keys(Du))Du[e]?t.emulator.push(e):t.prod.push(e);return t}function yk(t){let e=document.getElementById(t),r=!1;return e||(e=document.createElement("div"),e.setAttribute("id",t),r=!0),{created:r,element:e}}let Py=!1;function N2(t,e){if(typeof window>"u"||typeof document>"u"||!hc(window.location.host)||Du[t]===e||Du[t]||Py)return;Du[t]=e;function r(x){return`__firebase__banner__${x}`}const n="__firebase__banner",o=xk().prod.length>0;function c(){const x=document.getElementById(n);x&&x.remove()}function u(x){x.style.display="flex",x.style.background="#7faaf0",x.style.position="fixed",x.style.bottom="5px",x.style.left="5px",x.style.padding=".5em",x.style.borderRadius="5px",x.style.alignItems="center"}function h(x,T){x.setAttribute("width","24"),x.setAttribute("id",T),x.setAttribute("height","24"),x.setAttribute("viewBox","0 0 24 24"),x.setAttribute("fill","none"),x.style.marginLeft="-6px"}function p(){const x=document.createElement("span");return x.style.cursor="pointer",x.style.marginLeft="16px",x.style.fontSize="24px",x.innerHTML=" &times;",x.onclick=()=>{Py=!0,c()},x}function g(x,T){x.setAttribute("id",T),x.innerText="Learn more",x.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",x.setAttribute("target","__blank"),x.style.paddingLeft="5px",x.style.textDecoration="underline"}function _(){const x=yk(n),T=r("text"),w=document.getElementById(T)||document.createElement("span"),S=r("learnmore"),C=document.getElementById(S)||document.createElement("a"),z=r("preprendIcon"),Y=document.getElementById(z)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(x.created){const L=x.element;u(L),g(C,S);const K=p();h(Y,z),L.append(Y,w,C,K),document.body.appendChild(L)}o?(w.innerText="Preview backend disconnected.",Y.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(Y.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,w.innerText="Preview backend running in this workspace."),w.setAttribute("id",T)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",_):_()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pn(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function Ek(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(pn())}function Tk(){var t;const e=(t=nd())===null||t===void 0?void 0:t.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function Ak(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function wk(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function Sk(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function Ck(){const t=pn();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function Rk(){return!Tk()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function kk(){try{return typeof indexedDB=="object"}catch{return!1}}function bk(){return new Promise((t,e)=>{try{let r=!0;const n="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(n);i.onsuccess=()=>{i.result.close(),r||self.indexedDB.deleteDatabase(n),t(!0)},i.onupgradeneeded=()=>{r=!1},i.onerror=()=>{var o;e(((o=i.error)===null||o===void 0?void 0:o.message)||"")}}catch(r){e(r)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ik="FirebaseError";class zi extends Error{constructor(e,r,n){super(r),this.code=e,this.customData=n,this.name=Ik,Object.setPrototypeOf(this,zi.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,mf.prototype.create)}}class mf{constructor(e,r,n){this.service=e,this.serviceName=r,this.errors=n}create(e,...r){const n=r[0]||{},i=`${this.service}/${e}`,o=this.errors[e],c=o?Dk(o,n):"Error",u=`${this.serviceName}: ${c} (${i}).`;return new zi(i,u,n)}}function Dk(t,e){return t.replace(Ok,(r,n)=>{const i=e[n];return i!=null?String(i):`<${n}?>`})}const Ok=/\{\$([^}]+)}/g;function Nk(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function Fo(t,e){if(t===e)return!0;const r=Object.keys(t),n=Object.keys(e);for(const i of r){if(!n.includes(i))return!1;const o=t[i],c=e[i];if(My(o)&&My(c)){if(!Fo(o,c))return!1}else if(o!==c)return!1}for(const i of n)if(!r.includes(i))return!1;return!0}function My(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gf(t){const e=[];for(const[r,n]of Object.entries(t))Array.isArray(n)?n.forEach(i=>{e.push(encodeURIComponent(r)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(r)+"="+encodeURIComponent(n));return e.length?"&"+e.join("&"):""}function Eu(t){const e={};return t.replace(/^\?/,"").split("&").forEach(n=>{if(n){const[i,o]=n.split("=");e[decodeURIComponent(i)]=decodeURIComponent(o)}}),e}function Tu(t){const e=t.indexOf("?");if(!e)return"";const r=t.indexOf("#",e);return t.substring(e,r>0?r:void 0)}function Fk(t,e){const r=new Pk(t,e);return r.subscribe.bind(r)}class Pk{constructor(e,r){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=r,this.task.then(()=>{e(this)}).catch(n=>{this.error(n)})}next(e){this.forEachObserver(r=>{r.next(e)})}error(e){this.forEachObserver(r=>{r.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,r,n){let i;if(e===void 0&&r===void 0&&n===void 0)throw new Error("Missing Observer.");Mk(e,["next","error","complete"])?i=e:i={next:e,error:r,complete:n},i.next===void 0&&(i.next=Pm),i.error===void 0&&(i.error=Pm),i.complete===void 0&&(i.complete=Pm);const o=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),o}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let r=0;r<this.observers.length;r++)this.sendOne(r,e)}sendOne(e,r){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{r(this.observers[e])}catch(n){typeof console<"u"&&console.error&&console.error(n)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function Mk(t,e){if(typeof t!="object"||t===null)return!1;for(const r of e)if(r in t&&typeof t[r]=="function")return!0;return!1}function Pm(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tn(t){return t&&t._delegate?t._delegate:t}class Po{constructor(e,r,n){this.name=e,this.instanceFactory=r,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wo="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lk{constructor(e,r){this.name=e,this.container=r,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const r=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(r)){const n=new vk;if(this.instancesDeferred.set(r,n),this.isInitialized(r)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:r});i&&n.resolve(i)}catch{}}return this.instancesDeferred.get(r).promise}getImmediate(e){var r;const n=this.normalizeInstanceIdentifier(e?.identifier),i=(r=e?.optional)!==null&&r!==void 0?r:!1;if(this.isInitialized(n)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:n})}catch(o){if(i)return null;throw o}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(Uk(e))try{this.getOrInitializeService({instanceIdentifier:wo})}catch{}for(const[r,n]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(r);try{const o=this.getOrInitializeService({instanceIdentifier:i});n.resolve(o)}catch{}}}}clearInstance(e=wo){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(r=>"INTERNAL"in r).map(r=>r.INTERNAL.delete()),...e.filter(r=>"_delete"in r).map(r=>r._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=wo){return this.instances.has(e)}getOptions(e=wo){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:r={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:n,options:r});for(const[o,c]of this.instancesDeferred.entries()){const u=this.normalizeInstanceIdentifier(o);n===u&&c.resolve(i)}return i}onInit(e,r){var n;const i=this.normalizeInstanceIdentifier(r),o=(n=this.onInitCallbacks.get(i))!==null&&n!==void 0?n:new Set;o.add(e),this.onInitCallbacks.set(i,o);const c=this.instances.get(i);return c&&e(c,i),()=>{o.delete(e)}}invokeOnInitCallbacks(e,r){const n=this.onInitCallbacks.get(r);if(n)for(const i of n)try{i(e,r)}catch{}}getOrInitializeService({instanceIdentifier:e,options:r={}}){let n=this.instances.get(e);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:Vk(e),options:r}),this.instances.set(e,n),this.instancesOptions.set(e,r),this.invokeOnInitCallbacks(n,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,n)}catch{}return n||null}normalizeInstanceIdentifier(e=wo){return this.component?this.component.multipleInstances?e:wo:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function Vk(t){return t===wo?void 0:t}function Uk(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bk{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const r=this.getProvider(e.name);if(r.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);r.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const r=new Lk(e,this);return this.providers.set(e,r),r}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Tt;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(Tt||(Tt={}));const jk={debug:Tt.DEBUG,verbose:Tt.VERBOSE,info:Tt.INFO,warn:Tt.WARN,error:Tt.ERROR,silent:Tt.SILENT},zk=Tt.INFO,Hk={[Tt.DEBUG]:"log",[Tt.VERBOSE]:"log",[Tt.INFO]:"info",[Tt.WARN]:"warn",[Tt.ERROR]:"error"},Gk=(t,e,...r)=>{if(e<t.logLevel)return;const n=new Date().toISOString(),i=Hk[e];if(i)console[i](`[${n}]  ${t.name}:`,...r);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Gg{constructor(e){this.name=e,this._logLevel=zk,this._logHandler=Gk,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Tt))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?jk[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Tt.DEBUG,...e),this._logHandler(this,Tt.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Tt.VERBOSE,...e),this._logHandler(this,Tt.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Tt.INFO,...e),this._logHandler(this,Tt.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Tt.WARN,...e),this._logHandler(this,Tt.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Tt.ERROR,...e),this._logHandler(this,Tt.ERROR,...e)}}const qk=(t,e)=>e.some(r=>t instanceof r);let Ly,Vy;function Kk(){return Ly||(Ly=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function Wk(){return Vy||(Vy=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const F2=new WeakMap,ag=new WeakMap,P2=new WeakMap,Mm=new WeakMap,qg=new WeakMap;function Xk(t){const e=new Promise((r,n)=>{const i=()=>{t.removeEventListener("success",o),t.removeEventListener("error",c)},o=()=>{r(bs(t.result)),i()},c=()=>{n(t.error),i()};t.addEventListener("success",o),t.addEventListener("error",c)});return e.then(r=>{r instanceof IDBCursor&&F2.set(r,t)}).catch(()=>{}),qg.set(e,t),e}function Yk(t){if(ag.has(t))return;const e=new Promise((r,n)=>{const i=()=>{t.removeEventListener("complete",o),t.removeEventListener("error",c),t.removeEventListener("abort",c)},o=()=>{r(),i()},c=()=>{n(t.error||new DOMException("AbortError","AbortError")),i()};t.addEventListener("complete",o),t.addEventListener("error",c),t.addEventListener("abort",c)});ag.set(t,e)}let ig={get(t,e,r){if(t instanceof IDBTransaction){if(e==="done")return ag.get(t);if(e==="objectStoreNames")return t.objectStoreNames||P2.get(t);if(e==="store")return r.objectStoreNames[1]?void 0:r.objectStore(r.objectStoreNames[0])}return bs(t[e])},set(t,e,r){return t[e]=r,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function $k(t){ig=t(ig)}function Qk(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...r){const n=t.call(Lm(this),e,...r);return P2.set(n,e.sort?e.sort():[e]),bs(n)}:Wk().includes(t)?function(...e){return t.apply(Lm(this),e),bs(F2.get(this))}:function(...e){return bs(t.apply(Lm(this),e))}}function Zk(t){return typeof t=="function"?Qk(t):(t instanceof IDBTransaction&&Yk(t),qk(t,Kk())?new Proxy(t,ig):t)}function bs(t){if(t instanceof IDBRequest)return Xk(t);if(Mm.has(t))return Mm.get(t);const e=Zk(t);return e!==t&&(Mm.set(t,e),qg.set(e,t)),e}const Lm=t=>qg.get(t);function Jk(t,e,{blocked:r,upgrade:n,blocking:i,terminated:o}={}){const c=indexedDB.open(t,e),u=bs(c);return n&&c.addEventListener("upgradeneeded",h=>{n(bs(c.result),h.oldVersion,h.newVersion,bs(c.transaction),h)}),r&&c.addEventListener("blocked",h=>r(h.oldVersion,h.newVersion,h)),u.then(h=>{o&&h.addEventListener("close",()=>o()),i&&h.addEventListener("versionchange",p=>i(p.oldVersion,p.newVersion,p))}).catch(()=>{}),u}const eb=["get","getKey","getAll","getAllKeys","count"],tb=["put","add","delete","clear"],Vm=new Map;function Uy(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(Vm.get(e))return Vm.get(e);const r=e.replace(/FromIndex$/,""),n=e!==r,i=tb.includes(r);if(!(r in(n?IDBIndex:IDBObjectStore).prototype)||!(i||eb.includes(r)))return;const o=async function(c,...u){const h=this.transaction(c,i?"readwrite":"readonly");let p=h.store;return n&&(p=p.index(u.shift())),(await Promise.all([p[r](...u),i&&h.done]))[0]};return Vm.set(e,o),o}$k(t=>({...t,get:(e,r,n)=>Uy(e,r)||t.get(e,r,n),has:(e,r)=>!!Uy(e,r)||t.has(e,r)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rb{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(r=>{if(nb(r)){const n=r.getImmediate();return`${n.library}/${n.version}`}else return null}).filter(r=>r).join(" ")}}function nb(t){const e=t.getComponent();return e?.type==="VERSION"}const sg="@firebase/app",By="0.13.2";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vi=new Gg("@firebase/app"),ab="@firebase/app-compat",ib="@firebase/analytics-compat",sb="@firebase/analytics",ob="@firebase/app-check-compat",lb="@firebase/app-check",cb="@firebase/auth",ub="@firebase/auth-compat",fb="@firebase/database",hb="@firebase/data-connect",db="@firebase/database-compat",pb="@firebase/functions",mb="@firebase/functions-compat",gb="@firebase/installations",vb="@firebase/installations-compat",_b="@firebase/messaging",xb="@firebase/messaging-compat",yb="@firebase/performance",Eb="@firebase/performance-compat",Tb="@firebase/remote-config",Ab="@firebase/remote-config-compat",wb="@firebase/storage",Sb="@firebase/storage-compat",Cb="@firebase/firestore",Rb="@firebase/ai",kb="@firebase/firestore-compat",bb="firebase",Ib="11.10.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const og="[DEFAULT]",Db={[sg]:"fire-core",[ab]:"fire-core-compat",[sb]:"fire-analytics",[ib]:"fire-analytics-compat",[lb]:"fire-app-check",[ob]:"fire-app-check-compat",[cb]:"fire-auth",[ub]:"fire-auth-compat",[fb]:"fire-rtdb",[hb]:"fire-data-connect",[db]:"fire-rtdb-compat",[pb]:"fire-fn",[mb]:"fire-fn-compat",[gb]:"fire-iid",[vb]:"fire-iid-compat",[_b]:"fire-fcm",[xb]:"fire-fcm-compat",[yb]:"fire-perf",[Eb]:"fire-perf-compat",[Tb]:"fire-rc",[Ab]:"fire-rc-compat",[wb]:"fire-gcs",[Sb]:"fire-gcs-compat",[Cb]:"fire-fst",[kb]:"fire-fst-compat",[Rb]:"fire-vertex","fire-js":"fire-js",[bb]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const C0=new Map,Ob=new Map,lg=new Map;function jy(t,e){try{t.container.addComponent(e)}catch(r){Vi.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,r)}}function nc(t){const e=t.name;if(lg.has(e))return Vi.debug(`There were multiple attempts to register component ${e}.`),!1;lg.set(e,t);for(const r of C0.values())jy(r,t);for(const r of Ob.values())jy(r,t);return!0}function Kg(t,e){const r=t.container.getProvider("heartbeat").getImmediate({optional:!0});return r&&r.triggerHeartbeat(),t.container.getProvider(e)}function ha(t){return t==null?!1:t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Nb={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Is=new mf("app","Firebase",Nb);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fb{constructor(e,r,n){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},r),this._name=r.name,this._automaticDataCollectionEnabled=r.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new Po("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Is.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dc=Ib;function M2(t,e={}){let r=t;typeof e!="object"&&(e={name:e});const n=Object.assign({name:og,automaticDataCollectionEnabled:!0},e),i=n.name;if(typeof i!="string"||!i)throw Is.create("bad-app-name",{appName:String(i)});if(r||(r=I2()),!r)throw Is.create("no-options");const o=C0.get(i);if(o){if(Fo(r,o.options)&&Fo(n,o.config))return o;throw Is.create("duplicate-app",{appName:i})}const c=new Bk(i);for(const h of lg.values())c.addComponent(h);const u=new Fb(r,n,c);return C0.set(i,u),u}function L2(t=og){const e=C0.get(t);if(!e&&t===og&&I2())return M2();if(!e)throw Is.create("no-app",{appName:t});return e}function Ds(t,e,r){var n;let i=(n=Db[t])!==null&&n!==void 0?n:t;r&&(i+=`-${r}`);const o=i.match(/\s|\//),c=e.match(/\s|\//);if(o||c){const u=[`Unable to register library "${i}" with version "${e}":`];o&&u.push(`library name "${i}" contains illegal characters (whitespace or "/")`),o&&c&&u.push("and"),c&&u.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Vi.warn(u.join(" "));return}nc(new Po(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Pb="firebase-heartbeat-database",Mb=1,Xu="firebase-heartbeat-store";let Um=null;function V2(){return Um||(Um=Jk(Pb,Mb,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(Xu)}catch(r){console.warn(r)}}}}).catch(t=>{throw Is.create("idb-open",{originalErrorMessage:t.message})})),Um}async function Lb(t){try{const r=(await V2()).transaction(Xu),n=await r.objectStore(Xu).get(U2(t));return await r.done,n}catch(e){if(e instanceof zi)Vi.warn(e.message);else{const r=Is.create("idb-get",{originalErrorMessage:e?.message});Vi.warn(r.message)}}}async function zy(t,e){try{const n=(await V2()).transaction(Xu,"readwrite");await n.objectStore(Xu).put(e,U2(t)),await n.done}catch(r){if(r instanceof zi)Vi.warn(r.message);else{const n=Is.create("idb-set",{originalErrorMessage:r?.message});Vi.warn(n.message)}}}function U2(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vb=1024,Ub=30;class Bb{constructor(e){this.container=e,this._heartbeatsCache=null;const r=this.container.getProvider("app").getImmediate();this._storage=new zb(r),this._heartbeatsCachePromise=this._storage.read().then(n=>(this._heartbeatsCache=n,n))}async triggerHeartbeat(){var e,r;try{const i=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),o=Hy();if(((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((r=this._heartbeatsCache)===null||r===void 0?void 0:r.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===o||this._heartbeatsCache.heartbeats.some(c=>c.date===o))return;if(this._heartbeatsCache.heartbeats.push({date:o,agent:i}),this._heartbeatsCache.heartbeats.length>Ub){const c=Hb(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(c,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(n){Vi.warn(n)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const r=Hy(),{heartbeatsToSend:n,unsentEntries:i}=jb(this._heartbeatsCache.heartbeats),o=S0(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=r,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),o}catch(r){return Vi.warn(r),""}}}function Hy(){return new Date().toISOString().substring(0,10)}function jb(t,e=Vb){const r=[];let n=t.slice();for(const i of t){const o=r.find(c=>c.agent===i.agent);if(o){if(o.dates.push(i.date),Gy(r)>e){o.dates.pop();break}}else if(r.push({agent:i.agent,dates:[i.date]}),Gy(r)>e){r.pop();break}n=n.slice(1)}return{heartbeatsToSend:r,unsentEntries:n}}class zb{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return kk()?bk().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const r=await Lb(this.app);return r?.heartbeats?r:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var r;if(await this._canUseIndexedDBPromise){const i=await this.read();return zy(this.app,{lastSentHeartbeatDate:(r=e.lastSentHeartbeatDate)!==null&&r!==void 0?r:i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var r;if(await this._canUseIndexedDBPromise){const i=await this.read();return zy(this.app,{lastSentHeartbeatDate:(r=e.lastSentHeartbeatDate)!==null&&r!==void 0?r:i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return}}function Gy(t){return S0(JSON.stringify({version:2,heartbeats:t})).length}function Hb(t){if(t.length===0)return-1;let e=0,r=t[0].date;for(let n=1;n<t.length;n++)t[n].date<r&&(r=t[n].date,e=n);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Gb(t){nc(new Po("platform-logger",e=>new rb(e),"PRIVATE")),nc(new Po("heartbeat",e=>new Bb(e),"PRIVATE")),Ds(sg,By,t),Ds(sg,By,"esm2017"),Ds("fire-js","")}Gb("");function Wg(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(t);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(t,n[i])&&(r[n[i]]=t[n[i]]);return r}function B2(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const qb=B2,j2=new mf("auth","Firebase",B2());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const R0=new Gg("@firebase/auth");function Kb(t,...e){R0.logLevel<=Tt.WARN&&R0.warn(`Auth (${dc}): ${t}`,...e)}function p0(t,...e){R0.logLevel<=Tt.ERROR&&R0.error(`Auth (${dc}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ma(t,...e){throw Yg(t,...e)}function Da(t,...e){return Yg(t,...e)}function Xg(t,e,r){const n=Object.assign(Object.assign({},qb()),{[e]:r});return new mf("auth","Firebase",n).create(e,{appName:t.name})}function Os(t){return Xg(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function Wb(t,e,r){const n=r;if(!(e instanceof n))throw n.name!==e.constructor.name&&ma(t,"argument-error"),Xg(t,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function Yg(t,...e){if(typeof t!="string"){const r=e[0],n=[...e.slice(1)];return n[0]&&(n[0].appName=t.name),t._errorFactory.create(r,...n)}return j2.create(t,...e)}function tt(t,e,...r){if(!t)throw Yg(e,...r)}function Di(t){const e="INTERNAL ASSERTION FAILED: "+t;throw p0(e),new Error(e)}function Ui(t,e){t||Di(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cg(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.href)||""}function Xb(){return qy()==="http:"||qy()==="https:"}function qy(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Yb(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(Xb()||wk()||"connection"in navigator)?navigator.onLine:!0}function $b(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vf{constructor(e,r){this.shortDelay=e,this.longDelay=r,Ui(r>e,"Short delay should be less than long delay!"),this.isMobile=Ek()||Sk()}get(){return Yb()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $g(t,e){Ui(t.emulator,"Emulator should always be set here");const{url:r}=t.emulator;return e?`${r}${e.startsWith("/")?e.slice(1):e}`:r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class z2{static initialize(e,r,n){this.fetchImpl=e,r&&(this.headersImpl=r),n&&(this.responseImpl=n)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Di("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Di("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Di("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qb={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zb=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],Jb=new vf(3e4,6e4);function Go(t,e){return t.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:t.tenantId}):e}async function Ks(t,e,r,n,i={}){return H2(t,i,async()=>{let o={},c={};n&&(e==="GET"?c=n:o={body:JSON.stringify(n)});const u=gf(Object.assign({key:t.config.apiKey},c)).slice(1),h=await t._getAdditionalHeaders();h["Content-Type"]="application/json",t.languageCode&&(h["X-Firebase-Locale"]=t.languageCode);const p=Object.assign({method:e,headers:h},o);return Ak()||(p.referrerPolicy="no-referrer"),t.emulatorConfig&&hc(t.emulatorConfig.host)&&(p.credentials="include"),z2.fetch()(await G2(t,t.config.apiHost,r,u),p)})}async function H2(t,e,r){t._canInitEmulator=!1;const n=Object.assign(Object.assign({},Qb),e);try{const i=new tI(t),o=await Promise.race([r(),i.promise]);i.clearNetworkTimeout();const c=await o.json();if("needConfirmation"in c)throw Qh(t,"account-exists-with-different-credential",c);if(o.ok&&!("errorMessage"in c))return c;{const u=o.ok?c.errorMessage:c.error.message,[h,p]=u.split(" : ");if(h==="FEDERATED_USER_ID_ALREADY_LINKED")throw Qh(t,"credential-already-in-use",c);if(h==="EMAIL_EXISTS")throw Qh(t,"email-already-in-use",c);if(h==="USER_DISABLED")throw Qh(t,"user-disabled",c);const g=n[h]||h.toLowerCase().replace(/[_\s]+/g,"-");if(p)throw Xg(t,g,p);ma(t,g)}}catch(i){if(i instanceof zi)throw i;ma(t,"network-request-failed",{message:String(i)})}}async function ad(t,e,r,n,i={}){const o=await Ks(t,e,r,n,i);return"mfaPendingCredential"in o&&ma(t,"multi-factor-auth-required",{_serverResponse:o}),o}async function G2(t,e,r,n){const i=`${e}${r}?${n}`,o=t,c=o.config.emulator?$g(t.config,i):`${t.config.apiScheme}://${i}`;return Zb.includes(r)&&(await o._persistenceManagerAvailable,o._getPersistenceType()==="COOKIE")?o._getPersistence()._getFinalTarget(c).toString():c}function eI(t){switch(t){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class tI{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((r,n)=>{this.timer=setTimeout(()=>n(Da(this.auth,"network-request-failed")),Jb.get())})}}function Qh(t,e,r){const n={appName:t.name};r.email&&(n.email=r.email),r.phoneNumber&&(n.phoneNumber=r.phoneNumber);const i=Da(t,e,n);return i.customData._tokenResponse=r,i}function Ky(t){return t!==void 0&&t.enterprise!==void 0}class rI{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const r of this.recaptchaEnforcementState)if(r.provider&&r.provider===e)return eI(r.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function nI(t,e){return Ks(t,"GET","/v2/recaptchaConfig",Go(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function aI(t,e){return Ks(t,"POST","/v1/accounts:delete",e)}async function k0(t,e){return Ks(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ou(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function iI(t,e=!1){const r=tn(t),n=await r.getIdToken(e),i=Qg(n);tt(i&&i.exp&&i.auth_time&&i.iat,r.auth,"internal-error");const o=typeof i.firebase=="object"?i.firebase:void 0,c=o?.sign_in_provider;return{claims:i,token:n,authTime:Ou(Bm(i.auth_time)),issuedAtTime:Ou(Bm(i.iat)),expirationTime:Ou(Bm(i.exp)),signInProvider:c||null,signInSecondFactor:o?.sign_in_second_factor||null}}function Bm(t){return Number(t)*1e3}function Qg(t){const[e,r,n]=t.split(".");if(e===void 0||r===void 0||n===void 0)return p0("JWT malformed, contained fewer than 3 sections"),null;try{const i=k2(r);return i?JSON.parse(i):(p0("Failed to decode base64 JWT payload"),null)}catch(i){return p0("Caught error parsing JWT payload as JSON",i?.toString()),null}}function Wy(t){const e=Qg(t);return tt(e,"internal-error"),tt(typeof e.exp<"u","internal-error"),tt(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Yu(t,e,r=!1){if(r)return e;try{return await e}catch(n){throw n instanceof zi&&sI(n)&&t.auth.currentUser===t&&await t.auth.signOut(),n}}function sI({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oI{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var r;if(e){const n=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),n}else{this.errorBackoff=3e4;const i=((r=this.user.stsTokenManager.expirationTime)!==null&&r!==void 0?r:0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;const r=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},r)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ug{constructor(e,r){this.createdAt=e,this.lastLoginAt=r,this._initializeTime()}_initializeTime(){this.lastSignInTime=Ou(this.lastLoginAt),this.creationTime=Ou(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function b0(t){var e;const r=t.auth,n=await t.getIdToken(),i=await Yu(t,k0(r,{idToken:n}));tt(i?.users.length,r,"internal-error");const o=i.users[0];t._notifyReloadListener(o);const c=!((e=o.providerUserInfo)===null||e===void 0)&&e.length?q2(o.providerUserInfo):[],u=cI(t.providerData,c),h=t.isAnonymous,p=!(t.email&&o.passwordHash)&&!u?.length,g=h?p:!1,_={uid:o.localId,displayName:o.displayName||null,photoURL:o.photoUrl||null,email:o.email||null,emailVerified:o.emailVerified||!1,phoneNumber:o.phoneNumber||null,tenantId:o.tenantId||null,providerData:u,metadata:new ug(o.createdAt,o.lastLoginAt),isAnonymous:g};Object.assign(t,_)}async function lI(t){const e=tn(t);await b0(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function cI(t,e){return[...t.filter(n=>!e.some(i=>i.providerId===n.providerId)),...e]}function q2(t){return t.map(e=>{var{providerId:r}=e,n=Wg(e,["providerId"]);return{providerId:r,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function uI(t,e){const r=await H2(t,{},async()=>{const n=gf({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:o}=t.config,c=await G2(t,i,"/v1/token",`key=${o}`),u=await t._getAdditionalHeaders();u["Content-Type"]="application/x-www-form-urlencoded";const h={method:"POST",headers:u,body:n};return t.emulatorConfig&&hc(t.emulatorConfig.host)&&(h.credentials="include"),z2.fetch()(c,h)});return{accessToken:r.access_token,expiresIn:r.expires_in,refreshToken:r.refresh_token}}async function fI(t,e){return Ks(t,"POST","/v2/accounts:revokeToken",Go(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yl{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){tt(e.idToken,"internal-error"),tt(typeof e.idToken<"u","internal-error"),tt(typeof e.refreshToken<"u","internal-error");const r="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):Wy(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,r)}updateFromIdToken(e){tt(e.length!==0,"internal-error");const r=Wy(e);this.updateTokensAndExpiration(e,null,r)}async getToken(e,r=!1){return!r&&this.accessToken&&!this.isExpired?this.accessToken:(tt(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,r){const{accessToken:n,refreshToken:i,expiresIn:o}=await uI(e,r);this.updateTokensAndExpiration(n,i,Number(o))}updateTokensAndExpiration(e,r,n){this.refreshToken=r||null,this.accessToken=e||null,this.expirationTime=Date.now()+n*1e3}static fromJSON(e,r){const{refreshToken:n,accessToken:i,expirationTime:o}=r,c=new Yl;return n&&(tt(typeof n=="string","internal-error",{appName:e}),c.refreshToken=n),i&&(tt(typeof i=="string","internal-error",{appName:e}),c.accessToken=i),o&&(tt(typeof o=="number","internal-error",{appName:e}),c.expirationTime=o),c}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Yl,this.toJSON())}_performRefresh(){return Di("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _s(t,e){tt(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class Ra{constructor(e){var{uid:r,auth:n,stsTokenManager:i}=e,o=Wg(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new oI(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=r,this.auth=n,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=o.displayName||null,this.email=o.email||null,this.emailVerified=o.emailVerified||!1,this.phoneNumber=o.phoneNumber||null,this.photoURL=o.photoURL||null,this.isAnonymous=o.isAnonymous||!1,this.tenantId=o.tenantId||null,this.providerData=o.providerData?[...o.providerData]:[],this.metadata=new ug(o.createdAt||void 0,o.lastLoginAt||void 0)}async getIdToken(e){const r=await Yu(this,this.stsTokenManager.getToken(this.auth,e));return tt(r,this.auth,"internal-error"),this.accessToken!==r&&(this.accessToken=r,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),r}getIdTokenResult(e){return iI(this,e)}reload(){return lI(this)}_assign(e){this!==e&&(tt(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(r=>Object.assign({},r)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const r=new Ra(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return r.metadata._copy(this.metadata),r}_onReload(e){tt(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,r=!1){let n=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),n=!0),r&&await b0(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(ha(this.auth.app))return Promise.reject(Os(this.auth));const e=await this.getIdToken();return await Yu(this,aI(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,r){var n,i,o,c,u,h,p,g;const _=(n=r.displayName)!==null&&n!==void 0?n:void 0,x=(i=r.email)!==null&&i!==void 0?i:void 0,T=(o=r.phoneNumber)!==null&&o!==void 0?o:void 0,w=(c=r.photoURL)!==null&&c!==void 0?c:void 0,S=(u=r.tenantId)!==null&&u!==void 0?u:void 0,C=(h=r._redirectEventId)!==null&&h!==void 0?h:void 0,z=(p=r.createdAt)!==null&&p!==void 0?p:void 0,Y=(g=r.lastLoginAt)!==null&&g!==void 0?g:void 0,{uid:L,emailVerified:K,isAnonymous:Z,providerData:re,stsTokenManager:k}=r;tt(L&&k,e,"internal-error");const A=Yl.fromJSON(this.name,k);tt(typeof L=="string",e,"internal-error"),_s(_,e.name),_s(x,e.name),tt(typeof K=="boolean",e,"internal-error"),tt(typeof Z=="boolean",e,"internal-error"),_s(T,e.name),_s(w,e.name),_s(S,e.name),_s(C,e.name),_s(z,e.name),_s(Y,e.name);const E=new Ra({uid:L,auth:e,email:x,emailVerified:K,displayName:_,isAnonymous:Z,photoURL:w,phoneNumber:T,tenantId:S,stsTokenManager:A,createdAt:z,lastLoginAt:Y});return re&&Array.isArray(re)&&(E.providerData=re.map(I=>Object.assign({},I))),C&&(E._redirectEventId=C),E}static async _fromIdTokenResponse(e,r,n=!1){const i=new Yl;i.updateFromServerResponse(r);const o=new Ra({uid:r.localId,auth:e,stsTokenManager:i,isAnonymous:n});return await b0(o),o}static async _fromGetAccountInfoResponse(e,r,n){const i=r.users[0];tt(i.localId!==void 0,"internal-error");const o=i.providerUserInfo!==void 0?q2(i.providerUserInfo):[],c=!(i.email&&i.passwordHash)&&!o?.length,u=new Yl;u.updateFromIdToken(n);const h=new Ra({uid:i.localId,auth:e,stsTokenManager:u,isAnonymous:c}),p={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:o,metadata:new ug(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!o?.length};return Object.assign(h,p),h}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xy=new Map;function Oi(t){Ui(t instanceof Function,"Expected a class definition");let e=Xy.get(t);return e?(Ui(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,Xy.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class K2{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,r){this.storage[e]=r}async _get(e){const r=this.storage[e];return r===void 0?null:r}async _remove(e){delete this.storage[e]}_addListener(e,r){}_removeListener(e,r){}}K2.type="NONE";const Yy=K2;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function m0(t,e,r){return`firebase:${t}:${e}:${r}`}class $l{constructor(e,r,n){this.persistence=e,this.auth=r,this.userKey=n;const{config:i,name:o}=this.auth;this.fullUserKey=m0(this.userKey,i.apiKey,o),this.fullPersistenceKey=m0("persistence",i.apiKey,o),this.boundEventHandler=r._onStorageEvent.bind(r),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const r=await k0(this.auth,{idToken:e}).catch(()=>{});return r?Ra._fromGetAccountInfoResponse(this.auth,r,e):null}return Ra._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const r=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,r)return this.setCurrentUser(r)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,r,n="authUser"){if(!r.length)return new $l(Oi(Yy),e,n);const i=(await Promise.all(r.map(async p=>{if(await p._isAvailable())return p}))).filter(p=>p);let o=i[0]||Oi(Yy);const c=m0(n,e.config.apiKey,e.name);let u=null;for(const p of r)try{const g=await p._get(c);if(g){let _;if(typeof g=="string"){const x=await k0(e,{idToken:g}).catch(()=>{});if(!x)break;_=await Ra._fromGetAccountInfoResponse(e,x,g)}else _=Ra._fromJSON(e,g);p!==o&&(u=_),o=p;break}}catch{}const h=i.filter(p=>p._shouldAllowMigration);return!o._shouldAllowMigration||!h.length?new $l(o,e,n):(o=h[0],u&&await o._set(c,u.toJSON()),await Promise.all(r.map(async p=>{if(p!==o)try{await p._remove(c)}catch{}})),new $l(o,e,n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $y(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if($2(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(W2(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(Z2(e))return"Blackberry";if(J2(e))return"Webos";if(X2(e))return"Safari";if((e.includes("chrome/")||Y2(e))&&!e.includes("edge/"))return"Chrome";if(Q2(e))return"Android";{const r=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=t.match(r);if(n?.length===2)return n[1]}return"Other"}function W2(t=pn()){return/firefox\//i.test(t)}function X2(t=pn()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function Y2(t=pn()){return/crios\//i.test(t)}function $2(t=pn()){return/iemobile/i.test(t)}function Q2(t=pn()){return/android/i.test(t)}function Z2(t=pn()){return/blackberry/i.test(t)}function J2(t=pn()){return/webos/i.test(t)}function Zg(t=pn()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function hI(t=pn()){var e;return Zg(t)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function dI(){return Ck()&&document.documentMode===10}function eA(t=pn()){return Zg(t)||Q2(t)||J2(t)||Z2(t)||/windows phone/i.test(t)||$2(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tA(t,e=[]){let r;switch(t){case"Browser":r=$y(pn());break;case"Worker":r=`${$y(pn())}-${t}`;break;default:r=t}const n=e.length?e.join(","):"FirebaseCore-web";return`${r}/JsCore/${dc}/${n}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pI{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,r){const n=o=>new Promise((c,u)=>{try{const h=e(o);c(h)}catch(h){u(h)}});n.onAbort=r,this.queue.push(n);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const r=[];try{for(const n of this.queue)await n(e),n.onAbort&&r.push(n.onAbort)}catch(n){r.reverse();for(const i of r)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:n?.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function mI(t,e={}){return Ks(t,"GET","/v2/passwordPolicy",Go(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gI=6;class vI{constructor(e){var r,n,i,o;const c=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(r=c.minPasswordLength)!==null&&r!==void 0?r:gI,c.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=c.maxPasswordLength),c.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=c.containsLowercaseCharacter),c.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=c.containsUppercaseCharacter),c.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=c.containsNumericCharacter),c.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=c.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(i=(n=e.allowedNonAlphanumericCharacters)===null||n===void 0?void 0:n.join(""))!==null&&i!==void 0?i:"",this.forceUpgradeOnSignin=(o=e.forceUpgradeOnSignin)!==null&&o!==void 0?o:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var r,n,i,o,c,u;const h={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,h),this.validatePasswordCharacterOptions(e,h),h.isValid&&(h.isValid=(r=h.meetsMinPasswordLength)!==null&&r!==void 0?r:!0),h.isValid&&(h.isValid=(n=h.meetsMaxPasswordLength)!==null&&n!==void 0?n:!0),h.isValid&&(h.isValid=(i=h.containsLowercaseLetter)!==null&&i!==void 0?i:!0),h.isValid&&(h.isValid=(o=h.containsUppercaseLetter)!==null&&o!==void 0?o:!0),h.isValid&&(h.isValid=(c=h.containsNumericCharacter)!==null&&c!==void 0?c:!0),h.isValid&&(h.isValid=(u=h.containsNonAlphanumericCharacter)!==null&&u!==void 0?u:!0),h}validatePasswordLengthOptions(e,r){const n=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;n&&(r.meetsMinPasswordLength=e.length>=n),i&&(r.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,r){this.updatePasswordCharacterOptionsStatuses(r,!1,!1,!1,!1);let n;for(let i=0;i<e.length;i++)n=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(r,n>="a"&&n<="z",n>="A"&&n<="Z",n>="0"&&n<="9",this.allowedNonAlphanumericCharacters.includes(n))}updatePasswordCharacterOptionsStatuses(e,r,n,i,o){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=r)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=n)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=o))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _I{constructor(e,r,n,i){this.app=e,this.heartbeatServiceProvider=r,this.appCheckServiceProvider=n,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Qy(this),this.idTokenSubscription=new Qy(this),this.beforeStateQueue=new pI(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=j2,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion,this._persistenceManagerAvailable=new Promise(o=>this._resolvePersistenceManagerAvailable=o)}_initializeWithPersistence(e,r){return r&&(this._popupRedirectResolver=Oi(r)),this._initializationPromise=this.queue(async()=>{var n,i,o;if(!this._deleted&&(this.persistenceManager=await $l.create(this,e),(n=this._resolvePersistenceManagerAvailable)===null||n===void 0||n.call(this),!this._deleted)){if(!((i=this._popupRedirectResolver)===null||i===void 0)&&i._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(r),this.lastNotifiedUid=((o=this.currentUser)===null||o===void 0?void 0:o.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const r=await k0(this,{idToken:e}),n=await Ra._fromGetAccountInfoResponse(this,r,e);await this.directlySetCurrentUser(n)}catch(r){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",r),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var r;if(ha(this.app)){const c=this.app.settings.authIdToken;return c?new Promise(u=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(c).then(u,u))}):this.directlySetCurrentUser(null)}const n=await this.assertedPersistence.getCurrentUser();let i=n,o=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const c=(r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId,u=i?._redirectEventId,h=await this.tryRedirectSignIn(e);(!c||c===u)&&h?.user&&(i=h.user,o=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(o)try{await this.beforeStateQueue.runMiddleware(i)}catch(c){i=n,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(c))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return tt(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(e){let r=null;try{r=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return r}async reloadAndSetCurrentUserOrClear(e){try{await b0(e)}catch(r){if(r?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=$b()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(ha(this.app))return Promise.reject(Os(this));const r=e?tn(e):null;return r&&tt(r.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(r&&r._clone(this))}async _updateCurrentUser(e,r=!1){if(!this._deleted)return e&&tt(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),r||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return ha(this.app)?Promise.reject(Os(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return ha(this.app)?Promise.reject(Os(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Oi(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const r=this._getPasswordPolicyInternal();return r.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):r.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await mI(this),r=new vI(e);this.tenantId===null?this._projectPasswordPolicy=r:this._tenantPasswordPolicies[this.tenantId]=r}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new mf("auth","Firebase",e())}onAuthStateChanged(e,r,n){return this.registerStateListener(this.authStateSubscription,e,r,n)}beforeAuthStateChanged(e,r){return this.beforeStateQueue.pushCallback(e,r)}onIdTokenChanged(e,r,n){return this.registerStateListener(this.idTokenSubscription,e,r,n)}authStateReady(){return new Promise((e,r)=>{if(this.currentUser)e();else{const n=this.onAuthStateChanged(()=>{n(),e()},r)}})}async revokeAccessToken(e){if(this.currentUser){const r=await this.currentUser.getIdToken(),n={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:r};this.tenantId!=null&&(n.tenantId=this.tenantId),await fI(this,n)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,r){const n=await this.getOrInitRedirectPersistenceManager(r);return e===null?n.removeCurrentUser():n.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const r=e&&Oi(e)||this._popupRedirectResolver;tt(r,this,"argument-error"),this.redirectPersistenceManager=await $l.create(this,[Oi(r._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var r,n;return this._isInitialized&&await this.queue(async()=>{}),((r=this._currentUser)===null||r===void 0?void 0:r._redirectEventId)===e?this._currentUser:((n=this.redirectUser)===null||n===void 0?void 0:n._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,r;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const n=(r=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&r!==void 0?r:null;this.lastNotifiedUid!==n&&(this.lastNotifiedUid=n,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,r,n,i){if(this._deleted)return()=>{};const o=typeof r=="function"?r:r.next.bind(r);let c=!1;const u=this._isInitialized?Promise.resolve():this._initializationPromise;if(tt(u,this,"internal-error"),u.then(()=>{c||o(this.currentUser)}),typeof r=="function"){const h=e.addObserver(r,n,i);return()=>{c=!0,h()}}else{const h=e.addObserver(r);return()=>{c=!0,h()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return tt(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=tA(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const r={"X-Client-Version":this.clientVersion};this.app.options.appId&&(r["X-Firebase-gmpid"]=this.app.options.appId);const n=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());n&&(r["X-Firebase-Client"]=n);const i=await this._getAppCheckToken();return i&&(r["X-Firebase-AppCheck"]=i),r}async _getAppCheckToken(){var e;if(ha(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const r=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return r?.error&&Kb(`Error while retrieving App Check token: ${r.error}`),r?.token}}function qo(t){return tn(t)}class Qy{constructor(e){this.auth=e,this.observer=null,this.addObserver=Fk(r=>this.observer=r)}get next(){return tt(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let id={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function xI(t){id=t}function rA(t){return id.loadJS(t)}function yI(){return id.recaptchaEnterpriseScript}function EI(){return id.gapiScript}function TI(t){return`__${t}${Math.floor(Math.random()*1e6)}`}class AI{constructor(){this.enterprise=new wI}ready(e){e()}execute(e,r){return Promise.resolve("token")}render(e,r){return""}}class wI{ready(e){e()}execute(e,r){return Promise.resolve("token")}render(e,r){return""}}const SI="recaptcha-enterprise",nA="NO_RECAPTCHA";class CI{constructor(e){this.type=SI,this.auth=qo(e)}async verify(e="verify",r=!1){async function n(o){if(!r){if(o.tenantId==null&&o._agentRecaptchaConfig!=null)return o._agentRecaptchaConfig.siteKey;if(o.tenantId!=null&&o._tenantRecaptchaConfigs[o.tenantId]!==void 0)return o._tenantRecaptchaConfigs[o.tenantId].siteKey}return new Promise(async(c,u)=>{nI(o,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(h=>{if(h.recaptchaKey===void 0)u(new Error("recaptcha Enterprise site key undefined"));else{const p=new rI(h);return o.tenantId==null?o._agentRecaptchaConfig=p:o._tenantRecaptchaConfigs[o.tenantId]=p,c(p.siteKey)}}).catch(h=>{u(h)})})}function i(o,c,u){const h=window.grecaptcha;Ky(h)?h.enterprise.ready(()=>{h.enterprise.execute(o,{action:e}).then(p=>{c(p)}).catch(()=>{c(nA)})}):u(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new AI().execute("siteKey",{action:"verify"}):new Promise((o,c)=>{n(this.auth).then(u=>{if(!r&&Ky(window.grecaptcha))i(u,o,c);else{if(typeof window>"u"){c(new Error("RecaptchaVerifier is only supported in browser"));return}let h=yI();h.length!==0&&(h+=u),rA(h).then(()=>{i(u,o,c)}).catch(p=>{c(p)})}}).catch(u=>{c(u)})})}}async function Zy(t,e,r,n=!1,i=!1){const o=new CI(t);let c;if(i)c=nA;else try{c=await o.verify(r)}catch{c=await o.verify(r,!0)}const u=Object.assign({},e);if(r==="mfaSmsEnrollment"||r==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in u){const h=u.phoneEnrollmentInfo.phoneNumber,p=u.phoneEnrollmentInfo.recaptchaToken;Object.assign(u,{phoneEnrollmentInfo:{phoneNumber:h,recaptchaToken:p,captchaResponse:c,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in u){const h=u.phoneSignInInfo.recaptchaToken;Object.assign(u,{phoneSignInInfo:{recaptchaToken:h,captchaResponse:c,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return u}return n?Object.assign(u,{captchaResp:c}):Object.assign(u,{captchaResponse:c}),Object.assign(u,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(u,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),u}async function Jy(t,e,r,n,i){var o;if(!((o=t._getRecaptchaConfig())===null||o===void 0)&&o.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const c=await Zy(t,e,r,r==="getOobCode");return n(t,c)}else return n(t,e).catch(async c=>{if(c.code==="auth/missing-recaptcha-token"){console.log(`${r} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const u=await Zy(t,e,r,r==="getOobCode");return n(t,u)}else return Promise.reject(c)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function RI(t,e){const r=Kg(t,"auth");if(r.isInitialized()){const i=r.getImmediate(),o=r.getOptions();if(Fo(o,e??{}))return i;ma(i,"already-initialized")}return r.initialize({options:e})}function kI(t,e){const r=e?.persistence||[],n=(Array.isArray(r)?r:[r]).map(Oi);e?.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(n,e?.popupRedirectResolver)}function bI(t,e,r){const n=qo(t);tt(/^https?:\/\//.test(e),n,"invalid-emulator-scheme");const i=!1,o=aA(e),{host:c,port:u}=II(e),h=u===null?"":`:${u}`,p={url:`${o}//${c}${h}/`},g=Object.freeze({host:c,port:u,protocol:o.replace(":",""),options:Object.freeze({disableWarnings:i})});if(!n._canInitEmulator){tt(n.config.emulator&&n.emulatorConfig,n,"emulator-config-failed"),tt(Fo(p,n.config.emulator)&&Fo(g,n.emulatorConfig),n,"emulator-config-failed");return}n.config.emulator=p,n.emulatorConfig=g,n.settings.appVerificationDisabledForTesting=!0,hc(c)?(O2(`${o}//${c}${h}`),N2("Auth",!0)):DI()}function aA(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function II(t){const e=aA(t),r=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!r)return{host:"",port:null};const n=r[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(n);if(i){const o=i[1];return{host:o,port:eE(n.substr(o.length+1))}}else{const[o,c]=n.split(":");return{host:o,port:eE(c)}}}function eE(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function DI(){function t(){const e=document.createElement("p"),r=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",r.position="fixed",r.width="100%",r.backgroundColor="#ffffff",r.border=".1em solid #000000",r.color="#b50000",r.bottom="0px",r.left="0px",r.margin="0px",r.zIndex="10000",r.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jg{constructor(e,r){this.providerId=e,this.signInMethod=r}toJSON(){return Di("not implemented")}_getIdTokenResponse(e){return Di("not implemented")}_linkToIdToken(e,r){return Di("not implemented")}_getReauthenticationResolver(e){return Di("not implemented")}}async function OI(t,e){return Ks(t,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function NI(t,e){return ad(t,"POST","/v1/accounts:signInWithPassword",Go(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function FI(t,e){return ad(t,"POST","/v1/accounts:signInWithEmailLink",Go(t,e))}async function PI(t,e){return ad(t,"POST","/v1/accounts:signInWithEmailLink",Go(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $u extends Jg{constructor(e,r,n,i=null){super("password",n),this._email=e,this._password=r,this._tenantId=i}static _fromEmailAndPassword(e,r){return new $u(e,r,"password")}static _fromEmailAndCode(e,r,n=null){return new $u(e,r,"emailLink",n)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const r=typeof e=="string"?JSON.parse(e):e;if(r?.email&&r?.password){if(r.signInMethod==="password")return this._fromEmailAndPassword(r.email,r.password);if(r.signInMethod==="emailLink")return this._fromEmailAndCode(r.email,r.password,r.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const r={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Jy(e,r,"signInWithPassword",NI);case"emailLink":return FI(e,{email:this._email,oobCode:this._password});default:ma(e,"internal-error")}}async _linkToIdToken(e,r){switch(this.signInMethod){case"password":const n={idToken:r,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Jy(e,n,"signUpPassword",OI);case"emailLink":return PI(e,{idToken:r,email:this._email,oobCode:this._password});default:ma(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ql(t,e){return ad(t,"POST","/v1/accounts:signInWithIdp",Go(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const MI="http://localhost";class Mo extends Jg{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const r=new Mo(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(r.idToken=e.idToken),e.accessToken&&(r.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(r.nonce=e.nonce),e.pendingToken&&(r.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(r.accessToken=e.oauthToken,r.secret=e.oauthTokenSecret):ma("argument-error"),r}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const r=typeof e=="string"?JSON.parse(e):e,{providerId:n,signInMethod:i}=r,o=Wg(r,["providerId","signInMethod"]);if(!n||!i)return null;const c=new Mo(n,i);return c.idToken=o.idToken||void 0,c.accessToken=o.accessToken||void 0,c.secret=o.secret,c.nonce=o.nonce,c.pendingToken=o.pendingToken||null,c}_getIdTokenResponse(e){const r=this.buildRequest();return Ql(e,r)}_linkToIdToken(e,r){const n=this.buildRequest();return n.idToken=r,Ql(e,n)}_getReauthenticationResolver(e){const r=this.buildRequest();return r.autoCreate=!1,Ql(e,r)}buildRequest(){const e={requestUri:MI,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const r={};this.idToken&&(r.id_token=this.idToken),this.accessToken&&(r.access_token=this.accessToken),this.secret&&(r.oauth_token_secret=this.secret),r.providerId=this.providerId,this.nonce&&!this.pendingToken&&(r.nonce=this.nonce),e.postBody=gf(r)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function LI(t){switch(t){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function VI(t){const e=Eu(Tu(t)).link,r=e?Eu(Tu(e)).deep_link_id:null,n=Eu(Tu(t)).deep_link_id;return(n?Eu(Tu(n)).link:null)||n||r||e||t}class e1{constructor(e){var r,n,i,o,c,u;const h=Eu(Tu(e)),p=(r=h.apiKey)!==null&&r!==void 0?r:null,g=(n=h.oobCode)!==null&&n!==void 0?n:null,_=LI((i=h.mode)!==null&&i!==void 0?i:null);tt(p&&g&&_,"argument-error"),this.apiKey=p,this.operation=_,this.code=g,this.continueUrl=(o=h.continueUrl)!==null&&o!==void 0?o:null,this.languageCode=(c=h.lang)!==null&&c!==void 0?c:null,this.tenantId=(u=h.tenantId)!==null&&u!==void 0?u:null}static parseLink(e){const r=VI(e);try{return new e1(r)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pc{constructor(){this.providerId=pc.PROVIDER_ID}static credential(e,r){return $u._fromEmailAndPassword(e,r)}static credentialWithLink(e,r){const n=e1.parseLink(r);return tt(n,"argument-error"),$u._fromEmailAndCode(e,n.code,n.tenantId)}}pc.PROVIDER_ID="password";pc.EMAIL_PASSWORD_SIGN_IN_METHOD="password";pc.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class t1{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _f extends t1{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Es extends _f{constructor(){super("facebook.com")}static credential(e){return Mo._fromParams({providerId:Es.PROVIDER_ID,signInMethod:Es.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Es.credentialFromTaggedObject(e)}static credentialFromError(e){return Es.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Es.credential(e.oauthAccessToken)}catch{return null}}}Es.FACEBOOK_SIGN_IN_METHOD="facebook.com";Es.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ii extends _f{constructor(){super("google.com"),this.addScope("profile")}static credential(e,r){return Mo._fromParams({providerId:Ii.PROVIDER_ID,signInMethod:Ii.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:r})}static credentialFromResult(e){return Ii.credentialFromTaggedObject(e)}static credentialFromError(e){return Ii.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:r,oauthAccessToken:n}=e;if(!r&&!n)return null;try{return Ii.credential(r,n)}catch{return null}}}Ii.GOOGLE_SIGN_IN_METHOD="google.com";Ii.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ts extends _f{constructor(){super("github.com")}static credential(e){return Mo._fromParams({providerId:Ts.PROVIDER_ID,signInMethod:Ts.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Ts.credentialFromTaggedObject(e)}static credentialFromError(e){return Ts.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Ts.credential(e.oauthAccessToken)}catch{return null}}}Ts.GITHUB_SIGN_IN_METHOD="github.com";Ts.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class As extends _f{constructor(){super("twitter.com")}static credential(e,r){return Mo._fromParams({providerId:As.PROVIDER_ID,signInMethod:As.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:r})}static credentialFromResult(e){return As.credentialFromTaggedObject(e)}static credentialFromError(e){return As.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:r,oauthTokenSecret:n}=e;if(!r||!n)return null;try{return As.credential(r,n)}catch{return null}}}As.TWITTER_SIGN_IN_METHOD="twitter.com";As.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ac{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,r,n,i=!1){const o=await Ra._fromIdTokenResponse(e,n,i),c=tE(n);return new ac({user:o,providerId:c,_tokenResponse:n,operationType:r})}static async _forOperation(e,r,n){await e._updateTokensIfNecessary(n,!0);const i=tE(n);return new ac({user:e,providerId:i,_tokenResponse:n,operationType:r})}}function tE(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class I0 extends zi{constructor(e,r,n,i){var o;super(r.code,r.message),this.operationType=n,this.user=i,Object.setPrototypeOf(this,I0.prototype),this.customData={appName:e.name,tenantId:(o=e.tenantId)!==null&&o!==void 0?o:void 0,_serverResponse:r.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(e,r,n,i){return new I0(e,r,n,i)}}function iA(t,e,r,n){return(e==="reauthenticate"?r._getReauthenticationResolver(t):r._getIdTokenResponse(t)).catch(o=>{throw o.code==="auth/multi-factor-auth-required"?I0._fromErrorAndOperation(t,o,e,n):o})}async function UI(t,e,r=!1){const n=await Yu(t,e._linkToIdToken(t.auth,await t.getIdToken()),r);return ac._forOperation(t,"link",n)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function BI(t,e,r=!1){const{auth:n}=t;if(ha(n.app))return Promise.reject(Os(n));const i="reauthenticate";try{const o=await Yu(t,iA(n,i,e,t),r);tt(o.idToken,n,"internal-error");const c=Qg(o.idToken);tt(c,n,"internal-error");const{sub:u}=c;return tt(t.uid===u,n,"user-mismatch"),ac._forOperation(t,i,o)}catch(o){throw o?.code==="auth/user-not-found"&&ma(n,"user-mismatch"),o}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function sA(t,e,r=!1){if(ha(t.app))return Promise.reject(Os(t));const n="signIn",i=await iA(t,n,e),o=await ac._fromIdTokenResponse(t,n,i);return r||await t._updateCurrentUser(o.user),o}async function jI(t,e){return sA(qo(t),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function zI(t){const e=qo(t);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}function HI(t,e,r){return ha(t.app)?Promise.reject(Os(t)):jI(tn(t),pc.credential(e,r)).catch(async n=>{throw n.code==="auth/password-does-not-meet-requirements"&&zI(t),n})}function GI(t,e,r,n){return tn(t).onIdTokenChanged(e,r,n)}function qI(t,e,r){return tn(t).beforeAuthStateChanged(e,r)}function KI(t,e,r,n){return tn(t).onAuthStateChanged(e,r,n)}function WI(t){return tn(t).signOut()}const D0="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oA{constructor(e,r){this.storageRetriever=e,this.type=r}_isAvailable(){try{return this.storage?(this.storage.setItem(D0,"1"),this.storage.removeItem(D0),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,r){return this.storage.setItem(e,JSON.stringify(r)),Promise.resolve()}_get(e){const r=this.storage.getItem(e);return Promise.resolve(r?JSON.parse(r):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const XI=1e3,YI=10;class lA extends oA{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,r)=>this.onStorageEvent(e,r),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=eA(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const r of Object.keys(this.listeners)){const n=this.storage.getItem(r),i=this.localCache[r];n!==i&&e(r,i,n)}}onStorageEvent(e,r=!1){if(!e.key){this.forAllChangedKeys((c,u,h)=>{this.notifyListeners(c,h)});return}const n=e.key;r?this.detachListener():this.stopPolling();const i=()=>{const c=this.storage.getItem(n);!r&&this.localCache[n]===c||this.notifyListeners(n,c)},o=this.storage.getItem(n);dI()&&o!==e.newValue&&e.newValue!==e.oldValue?setTimeout(i,YI):i()}notifyListeners(e,r){this.localCache[e]=r;const n=this.listeners[e];if(n)for(const i of Array.from(n))i(r&&JSON.parse(r))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,r,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:r,newValue:n}),!0)})},XI)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,r){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,r){await super._set(e,r),this.localCache[e]=JSON.stringify(r)}async _get(e){const r=await super._get(e);return this.localCache[e]=JSON.stringify(r),r}async _remove(e){await super._remove(e),delete this.localCache[e]}}lA.type="LOCAL";const $I=lA;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cA extends oA{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,r){}_removeListener(e,r){}}cA.type="SESSION";const uA=cA;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function QI(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(r){return{fulfilled:!1,reason:r}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sd{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const r=this.receivers.find(i=>i.isListeningto(e));if(r)return r;const n=new sd(e);return this.receivers.push(n),n}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const r=e,{eventId:n,eventType:i,data:o}=r.data,c=this.handlersMap[i];if(!c?.size)return;r.ports[0].postMessage({status:"ack",eventId:n,eventType:i});const u=Array.from(c).map(async p=>p(r.origin,o)),h=await QI(u);r.ports[0].postMessage({status:"done",eventId:n,eventType:i,response:h})}_subscribe(e,r){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(r)}_unsubscribe(e,r){this.handlersMap[e]&&r&&this.handlersMap[e].delete(r),(!r||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}sd.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function r1(t="",e=10){let r="";for(let n=0;n<e;n++)r+=Math.floor(Math.random()*10);return t+r}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZI{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,r,n=50){const i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let o,c;return new Promise((u,h)=>{const p=r1("",20);i.port1.start();const g=setTimeout(()=>{h(new Error("unsupported_event"))},n);c={messageChannel:i,onMessage(_){const x=_;if(x.data.eventId===p)switch(x.data.status){case"ack":clearTimeout(g),o=setTimeout(()=>{h(new Error("timeout"))},3e3);break;case"done":clearTimeout(o),u(x.data.response);break;default:clearTimeout(g),clearTimeout(o),h(new Error("invalid_response"));break}}},this.handlers.add(c),i.port1.addEventListener("message",c.onMessage),this.target.postMessage({eventType:e,eventId:p,data:r},[i.port2])}).finally(()=>{c&&this.removeMessageHandler(c)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ja(){return window}function JI(t){Ja().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fA(){return typeof Ja().WorkerGlobalScope<"u"&&typeof Ja().importScripts=="function"}async function e3(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function t3(){var t;return((t=navigator?.serviceWorker)===null||t===void 0?void 0:t.controller)||null}function r3(){return fA()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hA="firebaseLocalStorageDb",n3=1,O0="firebaseLocalStorage",dA="fbase_key";class xf{constructor(e){this.request=e}toPromise(){return new Promise((e,r)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{r(this.request.error)})})}}function od(t,e){return t.transaction([O0],e?"readwrite":"readonly").objectStore(O0)}function a3(){const t=indexedDB.deleteDatabase(hA);return new xf(t).toPromise()}function fg(){const t=indexedDB.open(hA,n3);return new Promise((e,r)=>{t.addEventListener("error",()=>{r(t.error)}),t.addEventListener("upgradeneeded",()=>{const n=t.result;try{n.createObjectStore(O0,{keyPath:dA})}catch(i){r(i)}}),t.addEventListener("success",async()=>{const n=t.result;n.objectStoreNames.contains(O0)?e(n):(n.close(),await a3(),e(await fg()))})})}async function rE(t,e,r){const n=od(t,!0).put({[dA]:e,value:r});return new xf(n).toPromise()}async function i3(t,e){const r=od(t,!1).get(e),n=await new xf(r).toPromise();return n===void 0?null:n.value}function nE(t,e){const r=od(t,!0).delete(e);return new xf(r).toPromise()}const s3=800,o3=3;class pA{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await fg(),this.db)}async _withRetries(e){let r=0;for(;;)try{const n=await this._openDb();return await e(n)}catch(n){if(r++>o3)throw n;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return fA()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=sd._getInstance(r3()),this.receiver._subscribe("keyChanged",async(e,r)=>({keyProcessed:(await this._poll()).includes(r.key)})),this.receiver._subscribe("ping",async(e,r)=>["keyChanged"])}async initializeSender(){var e,r;if(this.activeServiceWorker=await e3(),!this.activeServiceWorker)return;this.sender=new ZI(this.activeServiceWorker);const n=await this.sender._send("ping",{},800);n&&!((e=n[0])===null||e===void 0)&&e.fulfilled&&!((r=n[0])===null||r===void 0)&&r.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||t3()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await fg();return await rE(e,D0,"1"),await nE(e,D0),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,r){return this._withPendingWrite(async()=>(await this._withRetries(n=>rE(n,e,r)),this.localCache[e]=r,this.notifyServiceWorker(e)))}async _get(e){const r=await this._withRetries(n=>i3(n,e));return this.localCache[e]=r,r}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(r=>nE(r,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(i=>{const o=od(i,!1).getAll();return new xf(o).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const r=[],n=new Set;if(e.length!==0)for(const{fbase_key:i,value:o}of e)n.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(o)&&(this.notifyListeners(i,o),r.push(i));for(const i of Object.keys(this.localCache))this.localCache[i]&&!n.has(i)&&(this.notifyListeners(i,null),r.push(i));return r}notifyListeners(e,r){this.localCache[e]=r;const n=this.listeners[e];if(n)for(const i of Array.from(n))i(r)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),s3)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,r){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}pA.type="LOCAL";const l3=pA;new vf(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mA(t,e){return e?Oi(e):(tt(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class n1 extends Jg{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Ql(e,this._buildIdpRequest())}_linkToIdToken(e,r){return Ql(e,this._buildIdpRequest(r))}_getReauthenticationResolver(e){return Ql(e,this._buildIdpRequest())}_buildIdpRequest(e){const r={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(r.idToken=e),r}}function c3(t){return sA(t.auth,new n1(t),t.bypassAuthState)}function u3(t){const{auth:e,user:r}=t;return tt(r,e,"internal-error"),BI(r,new n1(t),t.bypassAuthState)}async function f3(t){const{auth:e,user:r}=t;return tt(r,e,"internal-error"),UI(r,new n1(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gA{constructor(e,r,n,i,o=!1){this.auth=e,this.resolver=n,this.user=i,this.bypassAuthState=o,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(r)?r:[r]}execute(){return new Promise(async(e,r)=>{this.pendingPromise={resolve:e,reject:r};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(n){this.reject(n)}})}async onAuthEvent(e){const{urlResponse:r,sessionId:n,postBody:i,tenantId:o,error:c,type:u}=e;if(c){this.reject(c);return}const h={auth:this.auth,requestUri:r,sessionId:n,tenantId:o||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(u)(h))}catch(p){this.reject(p)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return c3;case"linkViaPopup":case"linkViaRedirect":return f3;case"reauthViaPopup":case"reauthViaRedirect":return u3;default:ma(this.auth,"internal-error")}}resolve(e){Ui(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Ui(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const h3=new vf(2e3,1e4);async function d3(t,e,r){if(ha(t.app))return Promise.reject(Da(t,"operation-not-supported-in-this-environment"));const n=qo(t);Wb(t,e,t1);const i=mA(n,r);return new Ro(n,"signInViaPopup",e,i).executeNotNull()}class Ro extends gA{constructor(e,r,n,i,o){super(e,r,i,o),this.provider=n,this.authWindow=null,this.pollId=null,Ro.currentPopupAction&&Ro.currentPopupAction.cancel(),Ro.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return tt(e,this.auth,"internal-error"),e}async onExecution(){Ui(this.filter.length===1,"Popup operations only handle one event");const e=r1();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(r=>{this.reject(r)}),this.resolver._isIframeWebStorageSupported(this.auth,r=>{r||this.reject(Da(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(Da(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Ro.currentPopupAction=null}pollUserCancellation(){const e=()=>{var r,n;if(!((n=(r=this.authWindow)===null||r===void 0?void 0:r.window)===null||n===void 0)&&n.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Da(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,h3.get())};e()}}Ro.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const p3="pendingRedirect",g0=new Map;class m3 extends gA{constructor(e,r,n=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],r,void 0,n),this.eventId=null}async execute(){let e=g0.get(this.auth._key());if(!e){try{const n=await g3(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(n)}catch(r){e=()=>Promise.reject(r)}g0.set(this.auth._key(),e)}return this.bypassAuthState||g0.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const r=await this.auth._redirectUserForId(e.eventId);if(r)return this.user=r,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function g3(t,e){const r=x3(e),n=_3(t);if(!await n._isAvailable())return!1;const i=await n._get(r)==="true";return await n._remove(r),i}function v3(t,e){g0.set(t._key(),e)}function _3(t){return Oi(t._redirectPersistence)}function x3(t){return m0(p3,t.config.apiKey,t.name)}async function y3(t,e,r=!1){if(ha(t.app))return Promise.reject(Os(t));const n=qo(t),i=mA(n,e),c=await new m3(n,i,r).execute();return c&&!r&&(delete c.user._redirectEventId,await n._persistUserIfCurrent(c.user),await n._setRedirectUser(null,e)),c}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const E3=10*60*1e3;class T3{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let r=!1;return this.consumers.forEach(n=>{this.isEventForConsumer(e,n)&&(r=!0,this.sendToConsumer(e,n),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!A3(e)||(this.hasHandledPotentialRedirect=!0,r||(this.queuedRedirectEvent=e,r=!0)),r}sendToConsumer(e,r){var n;if(e.error&&!vA(e)){const i=((n=e.error.code)===null||n===void 0?void 0:n.split("auth/")[1])||"internal-error";r.onError(Da(this.auth,i))}else r.onAuthEvent(e)}isEventForConsumer(e,r){const n=r.eventId===null||!!e.eventId&&e.eventId===r.eventId;return r.filter.includes(e.type)&&n}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=E3&&this.cachedEventUids.clear(),this.cachedEventUids.has(aE(e))}saveEventToCache(e){this.cachedEventUids.add(aE(e)),this.lastProcessedEventTime=Date.now()}}function aE(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function vA({type:t,error:e}){return t==="unknown"&&e?.code==="auth/no-auth-event"}function A3(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return vA(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function w3(t,e={}){return Ks(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const S3=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,C3=/^https?/;async function R3(t){if(t.config.emulator)return;const{authorizedDomains:e}=await w3(t);for(const r of e)try{if(k3(r))return}catch{}ma(t,"unauthorized-domain")}function k3(t){const e=cg(),{protocol:r,hostname:n}=new URL(e);if(t.startsWith("chrome-extension://")){const c=new URL(t);return c.hostname===""&&n===""?r==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):r==="chrome-extension:"&&c.hostname===n}if(!C3.test(r))return!1;if(S3.test(t))return n===t;const i=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(n)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const b3=new vf(3e4,6e4);function iE(){const t=Ja().___jsl;if(t?.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let r=0;r<t.CP.length;r++)t.CP[r]=null}}function I3(t){return new Promise((e,r)=>{var n,i,o;function c(){iE(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{iE(),r(Da(t,"network-request-failed"))},timeout:b3.get()})}if(!((i=(n=Ja().gapi)===null||n===void 0?void 0:n.iframes)===null||i===void 0)&&i.Iframe)e(gapi.iframes.getContext());else if(!((o=Ja().gapi)===null||o===void 0)&&o.load)c();else{const u=TI("iframefcb");return Ja()[u]=()=>{gapi.load?c():r(Da(t,"network-request-failed"))},rA(`${EI()}?onload=${u}`).catch(h=>r(h))}}).catch(e=>{throw v0=null,e})}let v0=null;function D3(t){return v0=v0||I3(t),v0}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const O3=new vf(5e3,15e3),N3="__/auth/iframe",F3="emulator/auth/iframe",P3={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},M3=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function L3(t){const e=t.config;tt(e.authDomain,t,"auth-domain-config-required");const r=e.emulator?$g(e,F3):`https://${t.config.authDomain}/${N3}`,n={apiKey:e.apiKey,appName:t.name,v:dc},i=M3.get(t.config.apiHost);i&&(n.eid=i);const o=t._getFrameworks();return o.length&&(n.fw=o.join(",")),`${r}?${gf(n).slice(1)}`}async function V3(t){const e=await D3(t),r=Ja().gapi;return tt(r,t,"internal-error"),e.open({where:document.body,url:L3(t),messageHandlersFilter:r.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:P3,dontclear:!0},n=>new Promise(async(i,o)=>{await n.restyle({setHideOnLeave:!1});const c=Da(t,"network-request-failed"),u=Ja().setTimeout(()=>{o(c)},O3.get());function h(){Ja().clearTimeout(u),i(n)}n.ping(h).then(h,()=>{o(c)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const U3={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},B3=500,j3=600,z3="_blank",H3="http://localhost";class sE{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function G3(t,e,r,n=B3,i=j3){const o=Math.max((window.screen.availHeight-i)/2,0).toString(),c=Math.max((window.screen.availWidth-n)/2,0).toString();let u="";const h=Object.assign(Object.assign({},U3),{width:n.toString(),height:i.toString(),top:o,left:c}),p=pn().toLowerCase();r&&(u=Y2(p)?z3:r),W2(p)&&(e=e||H3,h.scrollbars="yes");const g=Object.entries(h).reduce((x,[T,w])=>`${x}${T}=${w},`,"");if(hI(p)&&u!=="_self")return q3(e||"",u),new sE(null);const _=window.open(e||"",u,g);tt(_,t,"popup-blocked");try{_.focus()}catch{}return new sE(_)}function q3(t,e){const r=document.createElement("a");r.href=t,r.target=e;const n=document.createEvent("MouseEvent");n.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),r.dispatchEvent(n)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const K3="__/auth/handler",W3="emulator/auth/handler",X3=encodeURIComponent("fac");async function oE(t,e,r,n,i,o){tt(t.config.authDomain,t,"auth-domain-config-required"),tt(t.config.apiKey,t,"invalid-api-key");const c={apiKey:t.config.apiKey,appName:t.name,authType:r,redirectUrl:n,v:dc,eventId:i};if(e instanceof t1){e.setDefaultLanguage(t.languageCode),c.providerId=e.providerId||"",Nk(e.getCustomParameters())||(c.customParameters=JSON.stringify(e.getCustomParameters()));for(const[g,_]of Object.entries({}))c[g]=_}if(e instanceof _f){const g=e.getScopes().filter(_=>_!=="");g.length>0&&(c.scopes=g.join(","))}t.tenantId&&(c.tid=t.tenantId);const u=c;for(const g of Object.keys(u))u[g]===void 0&&delete u[g];const h=await t._getAppCheckToken(),p=h?`#${X3}=${encodeURIComponent(h)}`:"";return`${Y3(t)}?${gf(u).slice(1)}${p}`}function Y3({config:t}){return t.emulator?$g(t,W3):`https://${t.authDomain}/${K3}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jm="webStorageSupport";class $3{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=uA,this._completeRedirectFn=y3,this._overrideRedirectResult=v3}async _openPopup(e,r,n,i){var o;Ui((o=this.eventManagers[e._key()])===null||o===void 0?void 0:o.manager,"_initialize() not called before _openPopup()");const c=await oE(e,r,n,cg(),i);return G3(e,c,r1())}async _openRedirect(e,r,n,i){await this._originValidation(e);const o=await oE(e,r,n,cg(),i);return JI(o),new Promise(()=>{})}_initialize(e){const r=e._key();if(this.eventManagers[r]){const{manager:i,promise:o}=this.eventManagers[r];return i?Promise.resolve(i):(Ui(o,"If manager is not set, promise should be"),o)}const n=this.initAndGetManager(e);return this.eventManagers[r]={promise:n},n.catch(()=>{delete this.eventManagers[r]}),n}async initAndGetManager(e){const r=await V3(e),n=new T3(e);return r.register("authEvent",i=>(tt(i?.authEvent,e,"invalid-auth-event"),{status:n.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:n},this.iframes[e._key()]=r,n}_isIframeWebStorageSupported(e,r){this.iframes[e._key()].send(jm,{type:jm},i=>{var o;const c=(o=i?.[0])===null||o===void 0?void 0:o[jm];c!==void 0&&r(!!c),ma(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const r=e._key();return this.originValidationPromises[r]||(this.originValidationPromises[r]=R3(e)),this.originValidationPromises[r]}get _shouldInitProactively(){return eA()||X2()||Zg()}}const Q3=$3;var lE="@firebase/auth",cE="1.10.8";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Z3{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const r=this.auth.onIdTokenChanged(n=>{e(n?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,r),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const r=this.internalListeners.get(e);r&&(this.internalListeners.delete(e),r(),this.updateProactiveRefresh())}assertAuthConfigured(){tt(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function J3(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function eD(t){nc(new Po("auth",(e,{options:r})=>{const n=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),o=e.getProvider("app-check-internal"),{apiKey:c,authDomain:u}=n.options;tt(c&&!c.includes(":"),"invalid-api-key",{appName:n.name});const h={apiKey:c,authDomain:u,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:tA(t)},p=new _I(n,i,o,h);return kI(p,r),p},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,r,n)=>{e.getProvider("auth-internal").initialize()})),nc(new Po("auth-internal",e=>{const r=qo(e.getProvider("auth").getImmediate());return(n=>new Z3(n))(r)},"PRIVATE").setInstantiationMode("EXPLICIT")),Ds(lE,cE,J3(t)),Ds(lE,cE,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tD=5*60,rD=D2("authIdTokenMaxAge")||tD;let uE=null;const nD=t=>async e=>{const r=e&&await e.getIdTokenResult(),n=r&&(new Date().getTime()-Date.parse(r.issuedAtTime))/1e3;if(n&&n>rD)return;const i=r?.token;uE!==i&&(uE=i,await fetch(t,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))};function aD(t=L2()){const e=Kg(t,"auth");if(e.isInitialized())return e.getImmediate();const r=RI(t,{popupRedirectResolver:Q3,persistence:[l3,$I,uA]}),n=D2("authTokenSyncURL");if(n&&typeof isSecureContext=="boolean"&&isSecureContext){const o=new URL(n,location.origin);if(location.origin===o.origin){const c=nD(o.toString());qI(r,c,()=>c(r.currentUser)),GI(r,u=>c(u))}}const i=b2("auth");return i&&bI(r,`http://${i}`),r}function iD(){var t,e;return(e=(t=document.getElementsByTagName("head"))===null||t===void 0?void 0:t[0])!==null&&e!==void 0?e:document}xI({loadJS(t){return new Promise((e,r)=>{const n=document.createElement("script");n.setAttribute("src",t),n.onload=e,n.onerror=i=>{const o=Da("internal-error");o.customData=i,r(o)},n.type="text/javascript",n.charset="UTF-8",iD().appendChild(n)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});eD("Browser");var fE=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Ns,_A;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(k,A){function E(){}E.prototype=A.prototype,k.D=A.prototype,k.prototype=new E,k.prototype.constructor=k,k.C=function(I,O,D){for(var F=Array(arguments.length-2),Fe=2;Fe<arguments.length;Fe++)F[Fe-2]=arguments[Fe];return A.prototype[O].apply(I,F)}}function r(){this.blockSize=-1}function n(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(n,r),n.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(k,A,E){E||(E=0);var I=Array(16);if(typeof A=="string")for(var O=0;16>O;++O)I[O]=A.charCodeAt(E++)|A.charCodeAt(E++)<<8|A.charCodeAt(E++)<<16|A.charCodeAt(E++)<<24;else for(O=0;16>O;++O)I[O]=A[E++]|A[E++]<<8|A[E++]<<16|A[E++]<<24;A=k.g[0],E=k.g[1],O=k.g[2];var D=k.g[3],F=A+(D^E&(O^D))+I[0]+3614090360&4294967295;A=E+(F<<7&4294967295|F>>>25),F=D+(O^A&(E^O))+I[1]+3905402710&4294967295,D=A+(F<<12&4294967295|F>>>20),F=O+(E^D&(A^E))+I[2]+606105819&4294967295,O=D+(F<<17&4294967295|F>>>15),F=E+(A^O&(D^A))+I[3]+3250441966&4294967295,E=O+(F<<22&4294967295|F>>>10),F=A+(D^E&(O^D))+I[4]+4118548399&4294967295,A=E+(F<<7&4294967295|F>>>25),F=D+(O^A&(E^O))+I[5]+1200080426&4294967295,D=A+(F<<12&4294967295|F>>>20),F=O+(E^D&(A^E))+I[6]+2821735955&4294967295,O=D+(F<<17&4294967295|F>>>15),F=E+(A^O&(D^A))+I[7]+4249261313&4294967295,E=O+(F<<22&4294967295|F>>>10),F=A+(D^E&(O^D))+I[8]+1770035416&4294967295,A=E+(F<<7&4294967295|F>>>25),F=D+(O^A&(E^O))+I[9]+2336552879&4294967295,D=A+(F<<12&4294967295|F>>>20),F=O+(E^D&(A^E))+I[10]+4294925233&4294967295,O=D+(F<<17&4294967295|F>>>15),F=E+(A^O&(D^A))+I[11]+2304563134&4294967295,E=O+(F<<22&4294967295|F>>>10),F=A+(D^E&(O^D))+I[12]+1804603682&4294967295,A=E+(F<<7&4294967295|F>>>25),F=D+(O^A&(E^O))+I[13]+4254626195&4294967295,D=A+(F<<12&4294967295|F>>>20),F=O+(E^D&(A^E))+I[14]+2792965006&4294967295,O=D+(F<<17&4294967295|F>>>15),F=E+(A^O&(D^A))+I[15]+1236535329&4294967295,E=O+(F<<22&4294967295|F>>>10),F=A+(O^D&(E^O))+I[1]+4129170786&4294967295,A=E+(F<<5&4294967295|F>>>27),F=D+(E^O&(A^E))+I[6]+3225465664&4294967295,D=A+(F<<9&4294967295|F>>>23),F=O+(A^E&(D^A))+I[11]+643717713&4294967295,O=D+(F<<14&4294967295|F>>>18),F=E+(D^A&(O^D))+I[0]+3921069994&4294967295,E=O+(F<<20&4294967295|F>>>12),F=A+(O^D&(E^O))+I[5]+3593408605&4294967295,A=E+(F<<5&4294967295|F>>>27),F=D+(E^O&(A^E))+I[10]+38016083&4294967295,D=A+(F<<9&4294967295|F>>>23),F=O+(A^E&(D^A))+I[15]+3634488961&4294967295,O=D+(F<<14&4294967295|F>>>18),F=E+(D^A&(O^D))+I[4]+3889429448&4294967295,E=O+(F<<20&4294967295|F>>>12),F=A+(O^D&(E^O))+I[9]+568446438&4294967295,A=E+(F<<5&4294967295|F>>>27),F=D+(E^O&(A^E))+I[14]+3275163606&4294967295,D=A+(F<<9&4294967295|F>>>23),F=O+(A^E&(D^A))+I[3]+4107603335&4294967295,O=D+(F<<14&4294967295|F>>>18),F=E+(D^A&(O^D))+I[8]+1163531501&4294967295,E=O+(F<<20&4294967295|F>>>12),F=A+(O^D&(E^O))+I[13]+2850285829&4294967295,A=E+(F<<5&4294967295|F>>>27),F=D+(E^O&(A^E))+I[2]+4243563512&4294967295,D=A+(F<<9&4294967295|F>>>23),F=O+(A^E&(D^A))+I[7]+1735328473&4294967295,O=D+(F<<14&4294967295|F>>>18),F=E+(D^A&(O^D))+I[12]+2368359562&4294967295,E=O+(F<<20&4294967295|F>>>12),F=A+(E^O^D)+I[5]+4294588738&4294967295,A=E+(F<<4&4294967295|F>>>28),F=D+(A^E^O)+I[8]+2272392833&4294967295,D=A+(F<<11&4294967295|F>>>21),F=O+(D^A^E)+I[11]+1839030562&4294967295,O=D+(F<<16&4294967295|F>>>16),F=E+(O^D^A)+I[14]+4259657740&4294967295,E=O+(F<<23&4294967295|F>>>9),F=A+(E^O^D)+I[1]+2763975236&4294967295,A=E+(F<<4&4294967295|F>>>28),F=D+(A^E^O)+I[4]+1272893353&4294967295,D=A+(F<<11&4294967295|F>>>21),F=O+(D^A^E)+I[7]+4139469664&4294967295,O=D+(F<<16&4294967295|F>>>16),F=E+(O^D^A)+I[10]+3200236656&4294967295,E=O+(F<<23&4294967295|F>>>9),F=A+(E^O^D)+I[13]+681279174&4294967295,A=E+(F<<4&4294967295|F>>>28),F=D+(A^E^O)+I[0]+3936430074&4294967295,D=A+(F<<11&4294967295|F>>>21),F=O+(D^A^E)+I[3]+3572445317&4294967295,O=D+(F<<16&4294967295|F>>>16),F=E+(O^D^A)+I[6]+76029189&4294967295,E=O+(F<<23&4294967295|F>>>9),F=A+(E^O^D)+I[9]+3654602809&4294967295,A=E+(F<<4&4294967295|F>>>28),F=D+(A^E^O)+I[12]+3873151461&4294967295,D=A+(F<<11&4294967295|F>>>21),F=O+(D^A^E)+I[15]+530742520&4294967295,O=D+(F<<16&4294967295|F>>>16),F=E+(O^D^A)+I[2]+3299628645&4294967295,E=O+(F<<23&4294967295|F>>>9),F=A+(O^(E|~D))+I[0]+4096336452&4294967295,A=E+(F<<6&4294967295|F>>>26),F=D+(E^(A|~O))+I[7]+1126891415&4294967295,D=A+(F<<10&4294967295|F>>>22),F=O+(A^(D|~E))+I[14]+2878612391&4294967295,O=D+(F<<15&4294967295|F>>>17),F=E+(D^(O|~A))+I[5]+4237533241&4294967295,E=O+(F<<21&4294967295|F>>>11),F=A+(O^(E|~D))+I[12]+1700485571&4294967295,A=E+(F<<6&4294967295|F>>>26),F=D+(E^(A|~O))+I[3]+2399980690&4294967295,D=A+(F<<10&4294967295|F>>>22),F=O+(A^(D|~E))+I[10]+4293915773&4294967295,O=D+(F<<15&4294967295|F>>>17),F=E+(D^(O|~A))+I[1]+2240044497&4294967295,E=O+(F<<21&4294967295|F>>>11),F=A+(O^(E|~D))+I[8]+1873313359&4294967295,A=E+(F<<6&4294967295|F>>>26),F=D+(E^(A|~O))+I[15]+4264355552&4294967295,D=A+(F<<10&4294967295|F>>>22),F=O+(A^(D|~E))+I[6]+2734768916&4294967295,O=D+(F<<15&4294967295|F>>>17),F=E+(D^(O|~A))+I[13]+1309151649&4294967295,E=O+(F<<21&4294967295|F>>>11),F=A+(O^(E|~D))+I[4]+4149444226&4294967295,A=E+(F<<6&4294967295|F>>>26),F=D+(E^(A|~O))+I[11]+3174756917&4294967295,D=A+(F<<10&4294967295|F>>>22),F=O+(A^(D|~E))+I[2]+718787259&4294967295,O=D+(F<<15&4294967295|F>>>17),F=E+(D^(O|~A))+I[9]+3951481745&4294967295,k.g[0]=k.g[0]+A&4294967295,k.g[1]=k.g[1]+(O+(F<<21&4294967295|F>>>11))&4294967295,k.g[2]=k.g[2]+O&4294967295,k.g[3]=k.g[3]+D&4294967295}n.prototype.u=function(k,A){A===void 0&&(A=k.length);for(var E=A-this.blockSize,I=this.B,O=this.h,D=0;D<A;){if(O==0)for(;D<=E;)i(this,k,D),D+=this.blockSize;if(typeof k=="string"){for(;D<A;)if(I[O++]=k.charCodeAt(D++),O==this.blockSize){i(this,I),O=0;break}}else for(;D<A;)if(I[O++]=k[D++],O==this.blockSize){i(this,I),O=0;break}}this.h=O,this.o+=A},n.prototype.v=function(){var k=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);k[0]=128;for(var A=1;A<k.length-8;++A)k[A]=0;var E=8*this.o;for(A=k.length-8;A<k.length;++A)k[A]=E&255,E/=256;for(this.u(k),k=Array(16),A=E=0;4>A;++A)for(var I=0;32>I;I+=8)k[E++]=this.g[A]>>>I&255;return k};function o(k,A){var E=u;return Object.prototype.hasOwnProperty.call(E,k)?E[k]:E[k]=A(k)}function c(k,A){this.h=A;for(var E=[],I=!0,O=k.length-1;0<=O;O--){var D=k[O]|0;I&&D==A||(E[O]=D,I=!1)}this.g=E}var u={};function h(k){return-128<=k&&128>k?o(k,function(A){return new c([A|0],0>A?-1:0)}):new c([k|0],0>k?-1:0)}function p(k){if(isNaN(k)||!isFinite(k))return _;if(0>k)return C(p(-k));for(var A=[],E=1,I=0;k>=E;I++)A[I]=k/E|0,E*=4294967296;return new c(A,0)}function g(k,A){if(k.length==0)throw Error("number format error: empty string");if(A=A||10,2>A||36<A)throw Error("radix out of range: "+A);if(k.charAt(0)=="-")return C(g(k.substring(1),A));if(0<=k.indexOf("-"))throw Error('number format error: interior "-" character');for(var E=p(Math.pow(A,8)),I=_,O=0;O<k.length;O+=8){var D=Math.min(8,k.length-O),F=parseInt(k.substring(O,O+D),A);8>D?(D=p(Math.pow(A,D)),I=I.j(D).add(p(F))):(I=I.j(E),I=I.add(p(F)))}return I}var _=h(0),x=h(1),T=h(16777216);t=c.prototype,t.m=function(){if(S(this))return-C(this).m();for(var k=0,A=1,E=0;E<this.g.length;E++){var I=this.i(E);k+=(0<=I?I:4294967296+I)*A,A*=4294967296}return k},t.toString=function(k){if(k=k||10,2>k||36<k)throw Error("radix out of range: "+k);if(w(this))return"0";if(S(this))return"-"+C(this).toString(k);for(var A=p(Math.pow(k,6)),E=this,I="";;){var O=K(E,A).g;E=z(E,O.j(A));var D=((0<E.g.length?E.g[0]:E.h)>>>0).toString(k);if(E=O,w(E))return D+I;for(;6>D.length;)D="0"+D;I=D+I}},t.i=function(k){return 0>k?0:k<this.g.length?this.g[k]:this.h};function w(k){if(k.h!=0)return!1;for(var A=0;A<k.g.length;A++)if(k.g[A]!=0)return!1;return!0}function S(k){return k.h==-1}t.l=function(k){return k=z(this,k),S(k)?-1:w(k)?0:1};function C(k){for(var A=k.g.length,E=[],I=0;I<A;I++)E[I]=~k.g[I];return new c(E,~k.h).add(x)}t.abs=function(){return S(this)?C(this):this},t.add=function(k){for(var A=Math.max(this.g.length,k.g.length),E=[],I=0,O=0;O<=A;O++){var D=I+(this.i(O)&65535)+(k.i(O)&65535),F=(D>>>16)+(this.i(O)>>>16)+(k.i(O)>>>16);I=F>>>16,D&=65535,F&=65535,E[O]=F<<16|D}return new c(E,E[E.length-1]&-2147483648?-1:0)};function z(k,A){return k.add(C(A))}t.j=function(k){if(w(this)||w(k))return _;if(S(this))return S(k)?C(this).j(C(k)):C(C(this).j(k));if(S(k))return C(this.j(C(k)));if(0>this.l(T)&&0>k.l(T))return p(this.m()*k.m());for(var A=this.g.length+k.g.length,E=[],I=0;I<2*A;I++)E[I]=0;for(I=0;I<this.g.length;I++)for(var O=0;O<k.g.length;O++){var D=this.i(I)>>>16,F=this.i(I)&65535,Fe=k.i(O)>>>16,Ce=k.i(O)&65535;E[2*I+2*O]+=F*Ce,Y(E,2*I+2*O),E[2*I+2*O+1]+=D*Ce,Y(E,2*I+2*O+1),E[2*I+2*O+1]+=F*Fe,Y(E,2*I+2*O+1),E[2*I+2*O+2]+=D*Fe,Y(E,2*I+2*O+2)}for(I=0;I<A;I++)E[I]=E[2*I+1]<<16|E[2*I];for(I=A;I<2*A;I++)E[I]=0;return new c(E,0)};function Y(k,A){for(;(k[A]&65535)!=k[A];)k[A+1]+=k[A]>>>16,k[A]&=65535,A++}function L(k,A){this.g=k,this.h=A}function K(k,A){if(w(A))throw Error("division by zero");if(w(k))return new L(_,_);if(S(k))return A=K(C(k),A),new L(C(A.g),C(A.h));if(S(A))return A=K(k,C(A)),new L(C(A.g),A.h);if(30<k.g.length){if(S(k)||S(A))throw Error("slowDivide_ only works with positive integers.");for(var E=x,I=A;0>=I.l(k);)E=Z(E),I=Z(I);var O=re(E,1),D=re(I,1);for(I=re(I,2),E=re(E,2);!w(I);){var F=D.add(I);0>=F.l(k)&&(O=O.add(E),D=F),I=re(I,1),E=re(E,1)}return A=z(k,O.j(A)),new L(O,A)}for(O=_;0<=k.l(A);){for(E=Math.max(1,Math.floor(k.m()/A.m())),I=Math.ceil(Math.log(E)/Math.LN2),I=48>=I?1:Math.pow(2,I-48),D=p(E),F=D.j(A);S(F)||0<F.l(k);)E-=I,D=p(E),F=D.j(A);w(D)&&(D=x),O=O.add(D),k=z(k,F)}return new L(O,k)}t.A=function(k){return K(this,k).h},t.and=function(k){for(var A=Math.max(this.g.length,k.g.length),E=[],I=0;I<A;I++)E[I]=this.i(I)&k.i(I);return new c(E,this.h&k.h)},t.or=function(k){for(var A=Math.max(this.g.length,k.g.length),E=[],I=0;I<A;I++)E[I]=this.i(I)|k.i(I);return new c(E,this.h|k.h)},t.xor=function(k){for(var A=Math.max(this.g.length,k.g.length),E=[],I=0;I<A;I++)E[I]=this.i(I)^k.i(I);return new c(E,this.h^k.h)};function Z(k){for(var A=k.g.length+1,E=[],I=0;I<A;I++)E[I]=k.i(I)<<1|k.i(I-1)>>>31;return new c(E,k.h)}function re(k,A){var E=A>>5;A%=32;for(var I=k.g.length-E,O=[],D=0;D<I;D++)O[D]=0<A?k.i(D+E)>>>A|k.i(D+E+1)<<32-A:k.i(D+E);return new c(O,k.h)}n.prototype.digest=n.prototype.v,n.prototype.reset=n.prototype.s,n.prototype.update=n.prototype.u,_A=n,c.prototype.add=c.prototype.add,c.prototype.multiply=c.prototype.j,c.prototype.modulo=c.prototype.A,c.prototype.compare=c.prototype.l,c.prototype.toNumber=c.prototype.m,c.prototype.toString=c.prototype.toString,c.prototype.getBits=c.prototype.i,c.fromNumber=p,c.fromString=g,Ns=c}).apply(typeof fE<"u"?fE:typeof self<"u"?self:typeof window<"u"?window:{});var Zh=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var xA,Au,yA,_0,hg,EA,TA,AA;(function(){var t,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(d,y,R){return d==Array.prototype||d==Object.prototype||(d[y]=R.value),d};function r(d){d=[typeof globalThis=="object"&&globalThis,d,typeof window=="object"&&window,typeof self=="object"&&self,typeof Zh=="object"&&Zh];for(var y=0;y<d.length;++y){var R=d[y];if(R&&R.Math==Math)return R}throw Error("Cannot find global object")}var n=r(this);function i(d,y){if(y)e:{var R=n;d=d.split(".");for(var V=0;V<d.length-1;V++){var fe=d[V];if(!(fe in R))break e;R=R[fe]}d=d[d.length-1],V=R[d],y=y(V),y!=V&&y!=null&&e(R,d,{configurable:!0,writable:!0,value:y})}}function o(d,y){d instanceof String&&(d+="");var R=0,V=!1,fe={next:function(){if(!V&&R<d.length){var ye=R++;return{value:y(ye,d[ye]),done:!1}}return V=!0,{done:!0,value:void 0}}};return fe[Symbol.iterator]=function(){return fe},fe}i("Array.prototype.values",function(d){return d||function(){return o(this,function(y,R){return R})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var c=c||{},u=this||self;function h(d){var y=typeof d;return y=y!="object"?y:d?Array.isArray(d)?"array":y:"null",y=="array"||y=="object"&&typeof d.length=="number"}function p(d){var y=typeof d;return y=="object"&&d!=null||y=="function"}function g(d,y,R){return d.call.apply(d.bind,arguments)}function _(d,y,R){if(!d)throw Error();if(2<arguments.length){var V=Array.prototype.slice.call(arguments,2);return function(){var fe=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(fe,V),d.apply(y,fe)}}return function(){return d.apply(y,arguments)}}function x(d,y,R){return x=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?g:_,x.apply(null,arguments)}function T(d,y){var R=Array.prototype.slice.call(arguments,1);return function(){var V=R.slice();return V.push.apply(V,arguments),d.apply(this,V)}}function w(d,y){function R(){}R.prototype=y.prototype,d.aa=y.prototype,d.prototype=new R,d.prototype.constructor=d,d.Qb=function(V,fe,ye){for(var Ve=Array(arguments.length-2),Rt=2;Rt<arguments.length;Rt++)Ve[Rt-2]=arguments[Rt];return y.prototype[fe].apply(V,Ve)}}function S(d){const y=d.length;if(0<y){const R=Array(y);for(let V=0;V<y;V++)R[V]=d[V];return R}return[]}function C(d,y){for(let R=1;R<arguments.length;R++){const V=arguments[R];if(h(V)){const fe=d.length||0,ye=V.length||0;d.length=fe+ye;for(let Ve=0;Ve<ye;Ve++)d[fe+Ve]=V[Ve]}else d.push(V)}}class z{constructor(y,R){this.i=y,this.j=R,this.h=0,this.g=null}get(){let y;return 0<this.h?(this.h--,y=this.g,this.g=y.next,y.next=null):y=this.i(),y}}function Y(d){return/^[\s\xa0]*$/.test(d)}function L(){var d=u.navigator;return d&&(d=d.userAgent)?d:""}function K(d){return K[" "](d),d}K[" "]=function(){};var Z=L().indexOf("Gecko")!=-1&&!(L().toLowerCase().indexOf("webkit")!=-1&&L().indexOf("Edge")==-1)&&!(L().indexOf("Trident")!=-1||L().indexOf("MSIE")!=-1)&&L().indexOf("Edge")==-1;function re(d,y,R){for(const V in d)y.call(R,d[V],V,d)}function k(d,y){for(const R in d)y.call(void 0,d[R],R,d)}function A(d){const y={};for(const R in d)y[R]=d[R];return y}const E="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function I(d,y){let R,V;for(let fe=1;fe<arguments.length;fe++){V=arguments[fe];for(R in V)d[R]=V[R];for(let ye=0;ye<E.length;ye++)R=E[ye],Object.prototype.hasOwnProperty.call(V,R)&&(d[R]=V[R])}}function O(d){var y=1;d=d.split(":");const R=[];for(;0<y&&d.length;)R.push(d.shift()),y--;return d.length&&R.push(d.join(":")),R}function D(d){u.setTimeout(()=>{throw d},0)}function F(){var d=ne;let y=null;return d.g&&(y=d.g,d.g=d.g.next,d.g||(d.h=null),y.next=null),y}class Fe{constructor(){this.h=this.g=null}add(y,R){const V=Ce.get();V.set(y,R),this.h?this.h.next=V:this.g=V,this.h=V}}var Ce=new z(()=>new ae,d=>d.reset());class ae{constructor(){this.next=this.g=this.h=null}set(y,R){this.h=y,this.g=R,this.next=null}reset(){this.next=this.g=this.h=null}}let oe,be=!1,ne=new Fe,G=()=>{const d=u.Promise.resolve(void 0);oe=()=>{d.then(se)}};var se=()=>{for(var d;d=F();){try{d.h.call(d.g)}catch(R){D(R)}var y=Ce;y.j(d),100>y.h&&(y.h++,d.next=y.g,y.g=d)}be=!1};function P(){this.s=this.s,this.C=this.C}P.prototype.s=!1,P.prototype.ma=function(){this.s||(this.s=!0,this.N())},P.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function j(d,y){this.type=d,this.g=this.target=y,this.defaultPrevented=!1}j.prototype.h=function(){this.defaultPrevented=!0};var J=function(){if(!u.addEventListener||!Object.defineProperty)return!1;var d=!1,y=Object.defineProperty({},"passive",{get:function(){d=!0}});try{const R=()=>{};u.addEventListener("test",R,y),u.removeEventListener("test",R,y)}catch{}return d}();function ee(d,y){if(j.call(this,d?d.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,d){var R=this.type=d.type,V=d.changedTouches&&d.changedTouches.length?d.changedTouches[0]:null;if(this.target=d.target||d.srcElement,this.g=y,y=d.relatedTarget){if(Z){e:{try{K(y.nodeName);var fe=!0;break e}catch{}fe=!1}fe||(y=null)}}else R=="mouseover"?y=d.fromElement:R=="mouseout"&&(y=d.toElement);this.relatedTarget=y,V?(this.clientX=V.clientX!==void 0?V.clientX:V.pageX,this.clientY=V.clientY!==void 0?V.clientY:V.pageY,this.screenX=V.screenX||0,this.screenY=V.screenY||0):(this.clientX=d.clientX!==void 0?d.clientX:d.pageX,this.clientY=d.clientY!==void 0?d.clientY:d.pageY,this.screenX=d.screenX||0,this.screenY=d.screenY||0),this.button=d.button,this.key=d.key||"",this.ctrlKey=d.ctrlKey,this.altKey=d.altKey,this.shiftKey=d.shiftKey,this.metaKey=d.metaKey,this.pointerId=d.pointerId||0,this.pointerType=typeof d.pointerType=="string"?d.pointerType:ue[d.pointerType]||"",this.state=d.state,this.i=d,d.defaultPrevented&&ee.aa.h.call(this)}}w(ee,j);var ue={2:"touch",3:"pen",4:"mouse"};ee.prototype.h=function(){ee.aa.h.call(this);var d=this.i;d.preventDefault?d.preventDefault():d.returnValue=!1};var Ie="closure_listenable_"+(1e6*Math.random()|0),Ee=0;function we(d,y,R,V,fe){this.listener=d,this.proxy=null,this.src=y,this.type=R,this.capture=!!V,this.ha=fe,this.key=++Ee,this.da=this.fa=!1}function Te(d){d.da=!0,d.listener=null,d.proxy=null,d.src=null,d.ha=null}function Ue(d){this.src=d,this.g={},this.h=0}Ue.prototype.add=function(d,y,R,V,fe){var ye=d.toString();d=this.g[ye],d||(d=this.g[ye]=[],this.h++);var Ve=nt(d,y,V,fe);return-1<Ve?(y=d[Ve],R||(y.fa=!1)):(y=new we(y,this.src,ye,!!V,fe),y.fa=R,d.push(y)),y};function W(d,y){var R=y.type;if(R in d.g){var V=d.g[R],fe=Array.prototype.indexOf.call(V,y,void 0),ye;(ye=0<=fe)&&Array.prototype.splice.call(V,fe,1),ye&&(Te(y),d.g[R].length==0&&(delete d.g[R],d.h--))}}function nt(d,y,R,V){for(var fe=0;fe<d.length;++fe){var ye=d[fe];if(!ye.da&&ye.listener==y&&ye.capture==!!R&&ye.ha==V)return fe}return-1}var Ge="closure_lm_"+(1e6*Math.random()|0),Ke={};function Be(d,y,R,V,fe){if(Array.isArray(y)){for(var ye=0;ye<y.length;ye++)Be(d,y[ye],R,V,fe);return null}return R=er(R),d&&d[Ie]?d.K(y,R,p(V)?!!V.capture:!1,fe):Ne(d,y,R,!1,V,fe)}function Ne(d,y,R,V,fe,ye){if(!y)throw Error("Invalid event type");var Ve=p(fe)?!!fe.capture:!!fe,Rt=hr(d);if(Rt||(d[Ge]=Rt=new Ue(d)),R=Rt.add(y,R,V,Ve,ye),R.proxy)return R;if(V=Ye(),R.proxy=V,V.src=d,V.listener=R,d.addEventListener)J||(fe=Ve),fe===void 0&&(fe=!1),d.addEventListener(y.toString(),V,fe);else if(d.attachEvent)d.attachEvent(rr(y.toString()),V);else if(d.addListener&&d.removeListener)d.addListener(V);else throw Error("addEventListener and attachEvent are unavailable.");return R}function Ye(){function d(R){return y.call(d.src,d.listener,R)}const y=_r;return d}function ut(d,y,R,V,fe){if(Array.isArray(y))for(var ye=0;ye<y.length;ye++)ut(d,y[ye],R,V,fe);else V=p(V)?!!V.capture:!!V,R=er(R),d&&d[Ie]?(d=d.i,y=String(y).toString(),y in d.g&&(ye=d.g[y],R=nt(ye,R,V,fe),-1<R&&(Te(ye[R]),Array.prototype.splice.call(ye,R,1),ye.length==0&&(delete d.g[y],d.h--)))):d&&(d=hr(d))&&(y=d.g[y.toString()],d=-1,y&&(d=nt(y,R,V,fe)),(R=-1<d?y[d]:null)&&_t(R))}function _t(d){if(typeof d!="number"&&d&&!d.da){var y=d.src;if(y&&y[Ie])W(y.i,d);else{var R=d.type,V=d.proxy;y.removeEventListener?y.removeEventListener(R,V,d.capture):y.detachEvent?y.detachEvent(rr(R),V):y.addListener&&y.removeListener&&y.removeListener(V),(R=hr(y))?(W(R,d),R.h==0&&(R.src=null,y[Ge]=null)):Te(d)}}}function rr(d){return d in Ke?Ke[d]:Ke[d]="on"+d}function _r(d,y){if(d.da)d=!0;else{y=new ee(y,this);var R=d.listener,V=d.ha||d.src;d.fa&&_t(d),d=R.call(V,y)}return d}function hr(d){return d=d[Ge],d instanceof Ue?d:null}var Et="__closure_events_fn_"+(1e9*Math.random()>>>0);function er(d){return typeof d=="function"?d:(d[Et]||(d[Et]=function(y){return d.handleEvent(y)}),d[Et])}function Ze(){P.call(this),this.i=new Ue(this),this.M=this,this.F=null}w(Ze,P),Ze.prototype[Ie]=!0,Ze.prototype.removeEventListener=function(d,y,R,V){ut(this,d,y,R,V)};function Je(d,y){var R,V=d.F;if(V)for(R=[];V;V=V.F)R.push(V);if(d=d.M,V=y.type||y,typeof y=="string")y=new j(y,d);else if(y instanceof j)y.target=y.target||d;else{var fe=y;y=new j(V,d),I(y,fe)}if(fe=!0,R)for(var ye=R.length-1;0<=ye;ye--){var Ve=y.g=R[ye];fe=dt(Ve,V,!0,y)&&fe}if(Ve=y.g=d,fe=dt(Ve,V,!0,y)&&fe,fe=dt(Ve,V,!1,y)&&fe,R)for(ye=0;ye<R.length;ye++)Ve=y.g=R[ye],fe=dt(Ve,V,!1,y)&&fe}Ze.prototype.N=function(){if(Ze.aa.N.call(this),this.i){var d=this.i,y;for(y in d.g){for(var R=d.g[y],V=0;V<R.length;V++)Te(R[V]);delete d.g[y],d.h--}}this.F=null},Ze.prototype.K=function(d,y,R,V){return this.i.add(String(d),y,!1,R,V)},Ze.prototype.L=function(d,y,R,V){return this.i.add(String(d),y,!0,R,V)};function dt(d,y,R,V){if(y=d.i.g[String(y)],!y)return!0;y=y.concat();for(var fe=!0,ye=0;ye<y.length;++ye){var Ve=y[ye];if(Ve&&!Ve.da&&Ve.capture==R){var Rt=Ve.listener,br=Ve.ha||Ve.src;Ve.fa&&W(d.i,Ve),fe=Rt.call(br,V)!==!1&&fe}}return fe&&!V.defaultPrevented}function Lt(d,y,R){if(typeof d=="function")R&&(d=x(d,R));else if(d&&typeof d.handleEvent=="function")d=x(d.handleEvent,d);else throw Error("Invalid listener argument");return 2147483647<Number(y)?-1:u.setTimeout(d,y||0)}function ot(d){d.g=Lt(()=>{d.g=null,d.i&&(d.i=!1,ot(d))},d.l);const y=d.h;d.h=null,d.m.apply(null,y)}class Ft extends P{constructor(y,R){super(),this.m=y,this.l=R,this.h=null,this.i=!1,this.g=null}j(y){this.h=arguments,this.g?this.i=!0:ot(this)}N(){super.N(),this.g&&(u.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Vt(d){P.call(this),this.h=d,this.g={}}w(Vt,P);var Ot=[];function Lr(d){re(d.g,function(y,R){this.g.hasOwnProperty(R)&&_t(y)},d),d.g={}}Vt.prototype.N=function(){Vt.aa.N.call(this),Lr(this)},Vt.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Cn=u.JSON.stringify,Gi=u.JSON.parse,ci=class{stringify(d){return u.JSON.stringify(d,void 0)}parse(d){return u.JSON.parse(d,void 0)}};function qi(){}qi.prototype.h=null;function Ki(d){return d.h||(d.h=d.i())}function Wi(){}var _a={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function xa(){j.call(this,"d")}w(xa,j);function Na(){j.call(this,"c")}w(Na,j);var Qn={},Ys=null;function Fa(){return Ys=Ys||new Ze}Qn.La="serverreachability";function Xi(d){j.call(this,Qn.La,d)}w(Xi,j);function Pa(d){const y=Fa();Je(y,new Xi(y))}Qn.STAT_EVENT="statevent";function rl(d,y){j.call(this,Qn.STAT_EVENT,d),this.stat=y}w(rl,j);function Qt(d){const y=Fa();Je(y,new rl(y,d))}Qn.Ma="timingevent";function dr(d,y){j.call(this,Qn.Ma,d),this.size=y}w(dr,j);function nr(d,y){if(typeof d!="function")throw Error("Fn must not be null and must be a function");return u.setTimeout(function(){d()},y)}function Rn(){this.g=!0}Rn.prototype.xa=function(){this.g=!1};function $s(d,y,R,V,fe,ye){d.info(function(){if(d.g)if(ye)for(var Ve="",Rt=ye.split("&"),br=0;br<Rt.length;br++){var kt=Rt[br].split("=");if(1<kt.length){var Ur=kt[0];kt=kt[1];var Ir=Ur.split("_");Ve=2<=Ir.length&&Ir[1]=="type"?Ve+(Ur+"="+kt+"&"):Ve+(Ur+"=redacted&")}}else Ve=null;else Ve=ye;return"XMLHTTP REQ ("+V+") [attempt "+fe+"]: "+y+`
`+R+`
`+Ve})}function yc(d,y,R,V,fe,ye,Ve){d.info(function(){return"XMLHTTP RESP ("+V+") [ attempt "+fe+"]: "+y+`
`+R+`
`+ye+" "+Ve})}function N(d,y,R,V){d.info(function(){return"XMLHTTP TEXT ("+y+"): "+U(d,R)+(V?" "+V:"")})}function q(d,y){d.info(function(){return"TIMEOUT: "+y})}Rn.prototype.info=function(){};function U(d,y){if(!d.g)return y;if(!y)return null;try{var R=JSON.parse(y);if(R){for(d=0;d<R.length;d++)if(Array.isArray(R[d])){var V=R[d];if(!(2>V.length)){var fe=V[1];if(Array.isArray(fe)&&!(1>fe.length)){var ye=fe[0];if(ye!="noop"&&ye!="stop"&&ye!="close")for(var Ve=1;Ve<fe.length;Ve++)fe[Ve]=""}}}}return Cn(R)}catch{return y}}var B={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},H={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},X;function de(){}w(de,qi),de.prototype.g=function(){return new XMLHttpRequest},de.prototype.i=function(){return{}},X=new de;function xe(d,y,R,V){this.j=d,this.i=y,this.l=R,this.R=V||1,this.U=new Vt(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new ce}function ce(){this.i=null,this.g="",this.h=!1}var me={},ge={};function Oe(d,y,R){d.L=1,d.v=Js(Ln(y)),d.m=R,d.P=!0,Le(d,null)}function Le(d,y){d.F=Date.now(),je(d),d.A=Ln(d.v);var R=d.A,V=d.R;Array.isArray(V)||(V=[String(V)]),Sc(R.i,"t",V),d.C=0,R=d.j.J,d.h=new ce,d.g=Wf(d.j,R?y:null,!d.m),0<d.O&&(d.M=new Ft(x(d.Y,d,d.g),d.O)),y=d.U,R=d.g,V=d.ca;var fe="readystatechange";Array.isArray(fe)||(fe&&(Ot[0]=fe.toString()),fe=Ot);for(var ye=0;ye<fe.length;ye++){var Ve=Be(R,fe[ye],V||y.handleEvent,!1,y.h||y);if(!Ve)break;y.g[Ve.key]=Ve}y=d.H?A(d.H):{},d.m?(d.u||(d.u="POST"),y["Content-Type"]="application/x-www-form-urlencoded",d.g.ea(d.A,d.u,d.m,y)):(d.u="GET",d.g.ea(d.A,d.u,null,y)),Pa(),$s(d.i,d.u,d.A,d.l,d.R,d.m)}xe.prototype.ca=function(d){d=d.target;const y=this.M;y&&ta(d)==3?y.j():this.Y(d)},xe.prototype.Y=function(d){try{if(d==this.g)e:{const Ir=ta(this.g);var y=this.g.Ba();const gi=this.g.Z();if(!(3>Ir)&&(Ir!=3||this.g&&(this.h.h||this.g.oa()||Uf(this.g)))){this.J||Ir!=4||y==7||(y==8||0>=gi?Pa(3):Pa(2)),Pt(this);var R=this.g.Z();this.X=R;t:if(ze(this)){var V=Uf(this.g);d="";var fe=V.length,ye=ta(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){Ct(this),St(this);var Ve="";break t}this.h.i=new u.TextDecoder}for(y=0;y<fe;y++)this.h.h=!0,d+=this.h.i.decode(V[y],{stream:!(ye&&y==fe-1)});V.length=0,this.h.g+=d,this.C=0,Ve=this.h.g}else Ve=this.g.oa();if(this.o=R==200,yc(this.i,this.u,this.A,this.l,this.R,Ir,R),this.o){if(this.T&&!this.K){t:{if(this.g){var Rt,br=this.g;if((Rt=br.g?br.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!Y(Rt)){var kt=Rt;break t}}kt=null}if(R=kt)N(this.i,this.l,R,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Mn(this,R);else{this.o=!1,this.s=3,Qt(12),Ct(this),St(this);break e}}if(this.P){R=!0;let Kr;for(;!this.J&&this.C<Ve.length;)if(Kr=Me(this,Ve),Kr==ge){Ir==4&&(this.s=4,Qt(14),R=!1),N(this.i,this.l,null,"[Incomplete Response]");break}else if(Kr==me){this.s=4,Qt(15),N(this.i,this.l,Ve,"[Invalid Chunk]"),R=!1;break}else N(this.i,this.l,Kr,null),Mn(this,Kr);if(ze(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Ir!=4||Ve.length!=0||this.h.h||(this.s=1,Qt(16),R=!1),this.o=this.o&&R,!R)N(this.i,this.l,Ve,"[Invalid Chunked Response]"),Ct(this),St(this);else if(0<Ve.length&&!this.W){this.W=!0;var Ur=this.j;Ur.g==this&&Ur.ba&&!Ur.M&&(Ur.j.info("Great, no buffering proxy detected. Bytes received: "+Ve.length),oo(Ur),Ur.M=!0,Qt(11))}}else N(this.i,this.l,Ve,null),Mn(this,Ve);Ir==4&&Ct(this),this.o&&!this.J&&(Ir==4?Gf(this.j,this):(this.o=!1,je(this)))}else Md(this.g),R==400&&0<Ve.indexOf("Unknown SID")?(this.s=3,Qt(12)):(this.s=0,Qt(13)),Ct(this),St(this)}}}catch{}finally{}};function ze(d){return d.g?d.u=="GET"&&d.L!=2&&d.j.Ca:!1}function Me(d,y){var R=d.C,V=y.indexOf(`
`,R);return V==-1?ge:(R=Number(y.substring(R,V)),isNaN(R)?me:(V+=1,V+R>y.length?ge:(y=y.slice(V,V+R),d.C=V+R,y)))}xe.prototype.cancel=function(){this.J=!0,Ct(this)};function je(d){d.S=Date.now()+d.I,at(d,d.I)}function at(d,y){if(d.B!=null)throw Error("WatchDog timer not null");d.B=nr(x(d.ba,d),y)}function Pt(d){d.B&&(u.clearTimeout(d.B),d.B=null)}xe.prototype.ba=function(){this.B=null;const d=Date.now();0<=d-this.S?(q(this.i,this.A),this.L!=2&&(Pa(),Qt(17)),Ct(this),this.s=2,St(this)):at(this,this.S-d)};function St(d){d.j.G==0||d.J||Gf(d.j,d)}function Ct(d){Pt(d);var y=d.M;y&&typeof y.ma=="function"&&y.ma(),d.M=null,Lr(d.U),d.g&&(y=d.g,d.g=null,y.abort(),y.ma())}function Mn(d,y){try{var R=d.j;if(R.G!=0&&(R.g==d||_n(R.h,d))){if(!d.K&&_n(R.h,d)&&R.G==3){try{var V=R.Da.g.parse(y)}catch{V=null}if(Array.isArray(V)&&V.length==3){var fe=V;if(fe[0]==0){e:if(!R.u){if(R.g)if(R.g.F+3e3<d.F)hl(R),ul(R);else break e;Ic(R),Qt(18)}}else R.za=fe[1],0<R.za-R.T&&37500>fe[2]&&R.F&&R.v==0&&!R.C&&(R.C=nr(x(R.Za,R),6e3));if(1>=La(R.h)&&R.ca){try{R.ca()}catch{}R.ca=void 0}}else mi(R,11)}else if((d.K||R.g==d)&&hl(R),!Y(y))for(fe=R.Da.g.parse(y),y=0;y<fe.length;y++){let kt=fe[y];if(R.T=kt[0],kt=kt[1],R.G==2)if(kt[0]=="c"){R.K=kt[1],R.ia=kt[2];const Ur=kt[3];Ur!=null&&(R.la=Ur,R.j.info("VER="+R.la));const Ir=kt[4];Ir!=null&&(R.Aa=Ir,R.j.info("SVER="+R.Aa));const gi=kt[5];gi!=null&&typeof gi=="number"&&0<gi&&(V=1.5*gi,R.L=V,R.j.info("backChannelRequestTimeoutMs_="+V)),V=R;const Kr=d.g;if(Kr){const Ga=Kr.g?Kr.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Ga){var ye=V.h;ye.g||Ga.indexOf("spdy")==-1&&Ga.indexOf("quic")==-1&&Ga.indexOf("h2")==-1||(ye.j=ye.l,ye.g=new Set,ye.h&&(nl(ye,ye.h),ye.h=null))}if(V.D){const Oc=Kr.g?Kr.g.getResponseHeader("X-HTTP-Session-Id"):null;Oc&&(V.ya=Oc,Kt(V.I,V.D,Oc))}}R.G=3,R.l&&R.l.ua(),R.ba&&(R.R=Date.now()-d.F,R.j.info("Handshake RTT: "+R.R+"ms")),V=R;var Ve=d;if(V.qa=Kf(V,V.J?V.ia:null,V.W),Ve.K){xn(V.h,Ve);var Rt=Ve,br=V.L;br&&(Rt.I=br),Rt.B&&(Pt(Rt),je(Rt)),V.g=Ve}else zf(V);0<R.i.length&&fl(R)}else kt[0]!="stop"&&kt[0]!="close"||mi(R,7);else R.G==3&&(kt[0]=="stop"||kt[0]=="close"?kt[0]=="stop"?mi(R,7):kc(R):kt[0]!="noop"&&R.l&&R.l.ta(kt),R.v=0)}}Pa(4)}catch{}}var Ma=class{constructor(d,y){this.g=d,this.map=y}};function vn(d){this.l=d||10,u.PerformanceNavigationTiming?(d=u.performance.getEntriesByType("navigation"),d=0<d.length&&(d[0].nextHopProtocol=="hq"||d[0].nextHopProtocol=="h2")):d=!!(u.chrome&&u.chrome.loadTimes&&u.chrome.loadTimes()&&u.chrome.loadTimes().wasFetchedViaSpdy),this.j=d?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function kn(d){return d.h?!0:d.g?d.g.size>=d.j:!1}function La(d){return d.h?1:d.g?d.g.size:0}function _n(d,y){return d.h?d.h==y:d.g?d.g.has(y):!1}function nl(d,y){d.g?d.g.add(y):d.h=y}function xn(d,y){d.h&&d.h==y?d.h=null:d.g&&d.g.has(y)&&d.g.delete(y)}vn.prototype.cancel=function(){if(this.i=Ec(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const d of this.g.values())d.cancel();this.g.clear()}};function Ec(d){if(d.h!=null)return d.i.concat(d.h.D);if(d.g!=null&&d.g.size!==0){let y=d.i;for(const R of d.g.values())y=y.concat(R.D);return y}return S(d.i)}function Od(d){if(d.V&&typeof d.V=="function")return d.V();if(typeof Map<"u"&&d instanceof Map||typeof Set<"u"&&d instanceof Set)return Array.from(d.values());if(typeof d=="string")return d.split("");if(h(d)){for(var y=[],R=d.length,V=0;V<R;V++)y.push(d[V]);return y}y=[],R=0;for(V in d)y[R++]=d[V];return y}function al(d){if(d.na&&typeof d.na=="function")return d.na();if(!d.V||typeof d.V!="function"){if(typeof Map<"u"&&d instanceof Map)return Array.from(d.keys());if(!(typeof Set<"u"&&d instanceof Set)){if(h(d)||typeof d=="string"){var y=[];d=d.length;for(var R=0;R<d;R++)y.push(R);return y}y=[],R=0;for(const V in d)y[R++]=V;return y}}}function Tc(d,y){if(d.forEach&&typeof d.forEach=="function")d.forEach(y,void 0);else if(h(d)||typeof d=="string")Array.prototype.forEach.call(d,y,void 0);else for(var R=al(d),V=Od(d),fe=V.length,ye=0;ye<fe;ye++)y.call(void 0,V[ye],R&&R[ye],d)}var Qs=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Nd(d,y){if(d){d=d.split("&");for(var R=0;R<d.length;R++){var V=d[R].indexOf("="),fe=null;if(0<=V){var ye=d[R].substring(0,V);fe=d[R].substring(V+1)}else ye=d[R];y(ye,fe?decodeURIComponent(fe.replace(/\+/g," ")):"")}}}function xr(d){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,d instanceof xr){this.h=d.h,Zs(this,d.j),this.o=d.o,this.g=d.g,Yi(this,d.s),this.l=d.l;var y=d.i,R=new fi;R.i=y.i,y.g&&(R.g=new Map(y.g),R.h=y.h),ui(this,R),this.m=d.m}else d&&(y=String(d).match(Qs))?(this.h=!1,Zs(this,y[1]||"",!0),this.o=Zn(y[2]||""),this.g=Zn(y[3]||"",!0),Yi(this,y[4]),this.l=Zn(y[5]||"",!0),ui(this,y[6]||"",!0),this.m=Zn(y[7]||"")):(this.h=!1,this.i=new fi(null,this.h))}xr.prototype.toString=function(){var d=[],y=this.j;y&&d.push(eo(y,Ac,!0),":");var R=this.g;return(R||y=="file")&&(d.push("//"),(y=this.o)&&d.push(eo(y,Ac,!0),"@"),d.push(encodeURIComponent(String(R)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),R=this.s,R!=null&&d.push(":",String(R))),(R=this.l)&&(this.g&&R.charAt(0)!="/"&&d.push("/"),d.push(eo(R,R.charAt(0)=="/"?Fd:wc,!0))),(R=this.i.toString())&&d.push("?",R),(R=this.m)&&d.push("#",eo(R,il)),d.join("")};function Ln(d){return new xr(d)}function Zs(d,y,R){d.j=R?Zn(y,!0):y,d.j&&(d.j=d.j.replace(/:$/,""))}function Yi(d,y){if(y){if(y=Number(y),isNaN(y)||0>y)throw Error("Bad port number "+y);d.s=y}else d.s=null}function ui(d,y,R){y instanceof fi?(d.i=y,Lf(d.i,d.h)):(R||(y=eo(y,Pd)),d.i=new fi(y,d.h))}function Kt(d,y,R){d.i.set(y,R)}function Js(d){return Kt(d,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),d}function Zn(d,y){return d?y?decodeURI(d.replace(/%25/g,"%2525")):decodeURIComponent(d):""}function eo(d,y,R){return typeof d=="string"?(d=encodeURI(d).replace(y,Mf),R&&(d=d.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),d):null}function Mf(d){return d=d.charCodeAt(0),"%"+(d>>4&15).toString(16)+(d&15).toString(16)}var Ac=/[#\/\?@]/g,wc=/[#\?:]/g,Fd=/[#\?]/g,Pd=/[#\?@]/g,il=/#/g;function fi(d,y){this.h=this.g=null,this.i=d||null,this.j=!!y}function Jn(d){d.g||(d.g=new Map,d.h=0,d.i&&Nd(d.i,function(y,R){d.add(decodeURIComponent(y.replace(/\+/g," ")),R)}))}t=fi.prototype,t.add=function(d,y){Jn(this),this.i=null,d=Va(this,d);var R=this.g.get(d);return R||this.g.set(d,R=[]),R.push(y),this.h+=1,this};function hi(d,y){Jn(d),y=Va(d,y),d.g.has(y)&&(d.i=null,d.h-=d.g.get(y).length,d.g.delete(y))}function di(d,y){return Jn(d),y=Va(d,y),d.g.has(y)}t.forEach=function(d,y){Jn(this),this.g.forEach(function(R,V){R.forEach(function(fe){d.call(y,fe,V,this)},this)},this)},t.na=function(){Jn(this);const d=Array.from(this.g.values()),y=Array.from(this.g.keys()),R=[];for(let V=0;V<y.length;V++){const fe=d[V];for(let ye=0;ye<fe.length;ye++)R.push(y[V])}return R},t.V=function(d){Jn(this);let y=[];if(typeof d=="string")di(this,d)&&(y=y.concat(this.g.get(Va(this,d))));else{d=Array.from(this.g.values());for(let R=0;R<d.length;R++)y=y.concat(d[R])}return y},t.set=function(d,y){return Jn(this),this.i=null,d=Va(this,d),di(this,d)&&(this.h-=this.g.get(d).length),this.g.set(d,[y]),this.h+=1,this},t.get=function(d,y){return d?(d=this.V(d),0<d.length?String(d[0]):y):y};function Sc(d,y,R){hi(d,y),0<R.length&&(d.i=null,d.g.set(Va(d,y),S(R)),d.h+=R.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const d=[],y=Array.from(this.g.keys());for(var R=0;R<y.length;R++){var V=y[R];const ye=encodeURIComponent(String(V)),Ve=this.V(V);for(V=0;V<Ve.length;V++){var fe=ye;Ve[V]!==""&&(fe+="="+encodeURIComponent(String(Ve[V]))),d.push(fe)}}return this.i=d.join("&")};function Va(d,y){return y=String(y),d.j&&(y=y.toLowerCase()),y}function Lf(d,y){y&&!d.j&&(Jn(d),d.i=null,d.g.forEach(function(R,V){var fe=V.toLowerCase();V!=fe&&(hi(this,V),Sc(this,fe,R))},d)),d.j=y}function to(d,y){const R=new Rn;if(u.Image){const V=new Image;V.onload=T(ea,R,"TestLoadImage: loaded",!0,y,V),V.onerror=T(ea,R,"TestLoadImage: error",!1,y,V),V.onabort=T(ea,R,"TestLoadImage: abort",!1,y,V),V.ontimeout=T(ea,R,"TestLoadImage: timeout",!1,y,V),u.setTimeout(function(){V.ontimeout&&V.ontimeout()},1e4),V.src=d}else y(!1)}function ya(d,y){const R=new Rn,V=new AbortController,fe=setTimeout(()=>{V.abort(),ea(R,"TestPingServer: timeout",!1,y)},1e4);fetch(d,{signal:V.signal}).then(ye=>{clearTimeout(fe),ye.ok?ea(R,"TestPingServer: ok",!0,y):ea(R,"TestPingServer: server error",!1,y)}).catch(()=>{clearTimeout(fe),ea(R,"TestPingServer: error",!1,y)})}function ea(d,y,R,V,fe){try{fe&&(fe.onload=null,fe.onerror=null,fe.onabort=null,fe.ontimeout=null),V(R)}catch{}}function ro(){this.g=new ci}function Ua(d,y,R){const V=R||"";try{Tc(d,function(fe,ye){let Ve=fe;p(fe)&&(Ve=Cn(fe)),y.push(V+ye+"="+encodeURIComponent(Ve))})}catch(fe){throw y.push(V+"type="+encodeURIComponent("_badmap")),fe}}function $i(d){this.l=d.Ub||null,this.j=d.eb||!1}w($i,qi),$i.prototype.g=function(){return new pi(this.l,this.j)},$i.prototype.i=function(d){return function(){return d}}({});function pi(d,y){Ze.call(this),this.D=d,this.o=y,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}w(pi,Ze),t=pi.prototype,t.open=function(d,y){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=d,this.A=y,this.readyState=1,ja(this)},t.send=function(d){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const y={headers:this.u,method:this.B,credentials:this.m,cache:void 0};d&&(y.body=d),(this.D||u).fetch(new Request(this.A,y)).then(this.Sa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Ba(this)),this.readyState=0},t.Sa=function(d){if(this.g&&(this.l=d,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=d.headers,this.readyState=2,ja(this)),this.g&&(this.readyState=3,ja(this),this.g)))if(this.responseType==="arraybuffer")d.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof u.ReadableStream<"u"&&"body"in d){if(this.j=d.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;Cc(this)}else d.text().then(this.Ra.bind(this),this.ga.bind(this))};function Cc(d){d.j.read().then(d.Pa.bind(d)).catch(d.ga.bind(d))}t.Pa=function(d){if(this.g){if(this.o&&d.value)this.response.push(d.value);else if(!this.o){var y=d.value?d.value:new Uint8Array(0);(y=this.v.decode(y,{stream:!d.done}))&&(this.response=this.responseText+=y)}d.done?Ba(this):ja(this),this.readyState==3&&Cc(this)}},t.Ra=function(d){this.g&&(this.response=this.responseText=d,Ba(this))},t.Qa=function(d){this.g&&(this.response=d,Ba(this))},t.ga=function(){this.g&&Ba(this)};function Ba(d){d.readyState=4,d.l=null,d.j=null,d.v=null,ja(d)}t.setRequestHeader=function(d,y){this.u.append(d,y)},t.getResponseHeader=function(d){return this.h&&this.h.get(d.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const d=[],y=this.h.entries();for(var R=y.next();!R.done;)R=R.value,d.push(R[0]+": "+R[1]),R=y.next();return d.join(`\r
`)};function ja(d){d.onreadystatechange&&d.onreadystatechange.call(d)}Object.defineProperty(pi.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(d){this.m=d?"include":"same-origin"}});function Rc(d){let y="";return re(d,function(R,V){y+=V,y+=":",y+=R,y+=`\r
`}),y}function Vr(d,y,R){e:{for(V in R){var V=!1;break e}V=!0}V||(R=Rc(R),typeof d=="string"?R!=null&&encodeURIComponent(String(R)):Kt(d,y,R))}function Bt(d){Ze.call(this),this.headers=new Map,this.o=d||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}w(Bt,Ze);var sl=/^https?$/i,no=["POST","PUT"];t=Bt.prototype,t.Ha=function(d){this.J=d},t.ea=function(d,y,R,V){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+d);y=y?y.toUpperCase():"GET",this.D=d,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():X.g(),this.v=this.o?Ki(this.o):Ki(X),this.g.onreadystatechange=x(this.Ea,this);try{this.B=!0,this.g.open(y,String(d),!0),this.B=!1}catch(ye){Vf(this,ye);return}if(d=R||"",R=new Map(this.headers),V)if(Object.getPrototypeOf(V)===Object.prototype)for(var fe in V)R.set(fe,V[fe]);else if(typeof V.keys=="function"&&typeof V.get=="function")for(const ye of V.keys())R.set(ye,V.get(ye));else throw Error("Unknown input type for opt_headers: "+String(V));V=Array.from(R.keys()).find(ye=>ye.toLowerCase()=="content-type"),fe=u.FormData&&d instanceof u.FormData,!(0<=Array.prototype.indexOf.call(no,y,void 0))||V||fe||R.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[ye,Ve]of R)this.g.setRequestHeader(ye,Ve);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{ao(this),this.u=!0,this.g.send(d),this.u=!1}catch(ye){Vf(this,ye)}};function Vf(d,y){d.h=!1,d.g&&(d.j=!0,d.g.abort(),d.j=!1),d.l=y,d.m=5,ol(d),za(d)}function ol(d){d.A||(d.A=!0,Je(d,"complete"),Je(d,"error"))}t.abort=function(d){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=d||7,Je(this,"complete"),Je(this,"abort"),za(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),za(this,!0)),Bt.aa.N.call(this)},t.Ea=function(){this.s||(this.B||this.u||this.j?ll(this):this.bb())},t.bb=function(){ll(this)};function ll(d){if(d.h&&typeof c<"u"&&(!d.v[1]||ta(d)!=4||d.Z()!=2)){if(d.u&&ta(d)==4)Lt(d.Ea,0,d);else if(Je(d,"readystatechange"),ta(d)==4){d.h=!1;try{const Ve=d.Z();e:switch(Ve){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var y=!0;break e;default:y=!1}var R;if(!(R=y)){var V;if(V=Ve===0){var fe=String(d.D).match(Qs)[1]||null;!fe&&u.self&&u.self.location&&(fe=u.self.location.protocol.slice(0,-1)),V=!sl.test(fe?fe.toLowerCase():"")}R=V}if(R)Je(d,"complete"),Je(d,"success");else{d.m=6;try{var ye=2<ta(d)?d.g.statusText:""}catch{ye=""}d.l=ye+" ["+d.Z()+"]",ol(d)}}finally{za(d)}}}}function za(d,y){if(d.g){ao(d);const R=d.g,V=d.v[0]?()=>{}:null;d.g=null,d.v=null,y||Je(d,"ready");try{R.onreadystatechange=V}catch{}}}function ao(d){d.I&&(u.clearTimeout(d.I),d.I=null)}t.isActive=function(){return!!this.g};function ta(d){return d.g?d.g.readyState:0}t.Z=function(){try{return 2<ta(this)?this.g.status:-1}catch{return-1}},t.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.Oa=function(d){if(this.g){var y=this.g.responseText;return d&&y.indexOf(d)==0&&(y=y.substring(d.length)),Gi(y)}};function Uf(d){try{if(!d.g)return null;if("response"in d.g)return d.g.response;switch(d.H){case"":case"text":return d.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in d.g)return d.g.mozResponseArrayBuffer}return null}catch{return null}}function Md(d){const y={};d=(d.g&&2<=ta(d)&&d.g.getAllResponseHeaders()||"").split(`\r
`);for(let V=0;V<d.length;V++){if(Y(d[V]))continue;var R=O(d[V]);const fe=R[0];if(R=R[1],typeof R!="string")continue;R=R.trim();const ye=y[fe]||[];y[fe]=ye,ye.push(R)}k(y,function(V){return V.join(", ")})}t.Ba=function(){return this.m},t.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function io(d,y,R){return R&&R.internalChannelParams&&R.internalChannelParams[d]||y}function cl(d){this.Aa=0,this.i=[],this.j=new Rn,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=io("failFast",!1,d),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=io("baseRetryDelayMs",5e3,d),this.cb=io("retryDelaySeedMs",1e4,d),this.Wa=io("forwardChannelMaxRetries",2,d),this.wa=io("forwardChannelRequestTimeoutMs",2e4,d),this.pa=d&&d.xmlHttpFactory||void 0,this.Xa=d&&d.Tb||void 0,this.Ca=d&&d.useFetchStreams||!1,this.L=void 0,this.J=d&&d.supportsCrossDomainXhr||!1,this.K="",this.h=new vn(d&&d.concurrentRequestLimit),this.Da=new ro,this.P=d&&d.fastHandshake||!1,this.O=d&&d.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=d&&d.Rb||!1,d&&d.xa&&this.j.xa(),d&&d.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&d&&d.detectBufferingProxy||!1,this.ja=void 0,d&&d.longPollingTimeout&&0<d.longPollingTimeout&&(this.ja=d.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}t=cl.prototype,t.la=8,t.G=1,t.connect=function(d,y,R,V){Qt(0),this.W=d,this.H=y||{},R&&V!==void 0&&(this.H.OSID=R,this.H.OAID=V),this.F=this.X,this.I=Kf(this,null,this.W),fl(this)};function kc(d){if(Bf(d),d.G==3){var y=d.U++,R=Ln(d.I);if(Kt(R,"SID",d.K),Kt(R,"RID",y),Kt(R,"TYPE","terminate"),so(d,R),y=new xe(d,d.j,y),y.L=2,y.v=Js(Ln(R)),R=!1,u.navigator&&u.navigator.sendBeacon)try{R=u.navigator.sendBeacon(y.v.toString(),"")}catch{}!R&&u.Image&&(new Image().src=y.v,R=!0),R||(y.g=Wf(y.j,null),y.g.ea(y.v)),y.F=Date.now(),je(y)}qf(d)}function ul(d){d.g&&(oo(d),d.g.cancel(),d.g=null)}function Bf(d){ul(d),d.u&&(u.clearTimeout(d.u),d.u=null),hl(d),d.h.cancel(),d.s&&(typeof d.s=="number"&&u.clearTimeout(d.s),d.s=null)}function fl(d){if(!kn(d.h)&&!d.s){d.s=!0;var y=d.Ga;oe||G(),be||(oe(),be=!0),ne.add(y,d),d.B=0}}function Ld(d,y){return La(d.h)>=d.h.j-(d.s?1:0)?!1:d.s?(d.i=y.D.concat(d.i),!0):d.G==1||d.G==2||d.B>=(d.Va?0:d.Wa)?!1:(d.s=nr(x(d.Ga,d,y),Dc(d,d.B)),d.B++,!0)}t.Ga=function(d){if(this.s)if(this.s=null,this.G==1){if(!d){this.U=Math.floor(1e5*Math.random()),d=this.U++;const fe=new xe(this,this.j,d);let ye=this.o;if(this.S&&(ye?(ye=A(ye),I(ye,this.S)):ye=this.S),this.m!==null||this.O||(fe.H=ye,ye=null),this.P)e:{for(var y=0,R=0;R<this.i.length;R++){t:{var V=this.i[R];if("__data__"in V.map&&(V=V.map.__data__,typeof V=="string")){V=V.length;break t}V=void 0}if(V===void 0)break;if(y+=V,4096<y){y=R;break e}if(y===4096||R===this.i.length-1){y=R+1;break e}}y=1e3}else y=1e3;y=jf(this,fe,y),R=Ln(this.I),Kt(R,"RID",d),Kt(R,"CVER",22),this.D&&Kt(R,"X-HTTP-Session-Id",this.D),so(this,R),ye&&(this.O?y="headers="+encodeURIComponent(String(Rc(ye)))+"&"+y:this.m&&Vr(R,this.m,ye)),nl(this.h,fe),this.Ua&&Kt(R,"TYPE","init"),this.P?(Kt(R,"$req",y),Kt(R,"SID","null"),fe.T=!0,Oe(fe,R,null)):Oe(fe,R,y),this.G=2}}else this.G==3&&(d?bc(this,d):this.i.length==0||kn(this.h)||bc(this))};function bc(d,y){var R;y?R=y.l:R=d.U++;const V=Ln(d.I);Kt(V,"SID",d.K),Kt(V,"RID",R),Kt(V,"AID",d.T),so(d,V),d.m&&d.o&&Vr(V,d.m,d.o),R=new xe(d,d.j,R,d.B+1),d.m===null&&(R.H=d.o),y&&(d.i=y.D.concat(d.i)),y=jf(d,R,1e3),R.I=Math.round(.5*d.wa)+Math.round(.5*d.wa*Math.random()),nl(d.h,R),Oe(R,V,y)}function so(d,y){d.H&&re(d.H,function(R,V){Kt(y,V,R)}),d.l&&Tc({},function(R,V){Kt(y,V,R)})}function jf(d,y,R){R=Math.min(d.i.length,R);var V=d.l?x(d.l.Na,d.l,d):null;e:{var fe=d.i;let ye=-1;for(;;){const Ve=["count="+R];ye==-1?0<R?(ye=fe[0].g,Ve.push("ofs="+ye)):ye=0:Ve.push("ofs="+ye);let Rt=!0;for(let br=0;br<R;br++){let kt=fe[br].g;const Ur=fe[br].map;if(kt-=ye,0>kt)ye=Math.max(0,fe[br].g-100),Rt=!1;else try{Ua(Ur,Ve,"req"+kt+"_")}catch{V&&V(Ur)}}if(Rt){V=Ve.join("&");break e}}}return d=d.i.splice(0,R),y.D=d,V}function zf(d){if(!d.g&&!d.u){d.Y=1;var y=d.Fa;oe||G(),be||(oe(),be=!0),ne.add(y,d),d.v=0}}function Ic(d){return d.g||d.u||3<=d.v?!1:(d.Y++,d.u=nr(x(d.Fa,d),Dc(d,d.v)),d.v++,!0)}t.Fa=function(){if(this.u=null,Hf(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var d=2*this.R;this.j.info("BP detection timer enabled: "+d),this.A=nr(x(this.ab,this),d)}},t.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,Qt(10),ul(this),Hf(this))};function oo(d){d.A!=null&&(u.clearTimeout(d.A),d.A=null)}function Hf(d){d.g=new xe(d,d.j,"rpc",d.Y),d.m===null&&(d.g.H=d.o),d.g.O=0;var y=Ln(d.qa);Kt(y,"RID","rpc"),Kt(y,"SID",d.K),Kt(y,"AID",d.T),Kt(y,"CI",d.F?"0":"1"),!d.F&&d.ja&&Kt(y,"TO",d.ja),Kt(y,"TYPE","xmlhttp"),so(d,y),d.m&&d.o&&Vr(y,d.m,d.o),d.L&&(d.g.I=d.L);var R=d.g;d=d.ia,R.L=1,R.v=Js(Ln(y)),R.m=null,R.P=!0,Le(R,d)}t.Za=function(){this.C!=null&&(this.C=null,ul(this),Ic(this),Qt(19))};function hl(d){d.C!=null&&(u.clearTimeout(d.C),d.C=null)}function Gf(d,y){var R=null;if(d.g==y){hl(d),oo(d),d.g=null;var V=2}else if(_n(d.h,y))R=y.D,xn(d.h,y),V=1;else return;if(d.G!=0){if(y.o)if(V==1){R=y.m?y.m.length:0,y=Date.now()-y.F;var fe=d.B;V=Fa(),Je(V,new dr(V,R)),fl(d)}else zf(d);else if(fe=y.s,fe==3||fe==0&&0<y.X||!(V==1&&Ld(d,y)||V==2&&Ic(d)))switch(R&&0<R.length&&(y=d.h,y.i=y.i.concat(R)),fe){case 1:mi(d,5);break;case 4:mi(d,10);break;case 3:mi(d,6);break;default:mi(d,2)}}}function Dc(d,y){let R=d.Ta+Math.floor(Math.random()*d.cb);return d.isActive()||(R*=2),R*y}function mi(d,y){if(d.j.info("Error code "+y),y==2){var R=x(d.fb,d),V=d.Xa;const fe=!V;V=new xr(V||"//www.google.com/images/cleardot.gif"),u.location&&u.location.protocol=="http"||Zs(V,"https"),Js(V),fe?to(V.toString(),R):ya(V.toString(),R)}else Qt(2);d.G=0,d.l&&d.l.sa(y),qf(d),Bf(d)}t.fb=function(d){d?(this.j.info("Successfully pinged google.com"),Qt(2)):(this.j.info("Failed to ping google.com"),Qt(1))};function qf(d){if(d.G=0,d.ka=[],d.l){const y=Ec(d.h);(y.length!=0||d.i.length!=0)&&(C(d.ka,y),C(d.ka,d.i),d.h.i.length=0,S(d.i),d.i.length=0),d.l.ra()}}function Kf(d,y,R){var V=R instanceof xr?Ln(R):new xr(R);if(V.g!="")y&&(V.g=y+"."+V.g),Yi(V,V.s);else{var fe=u.location;V=fe.protocol,y=y?y+"."+fe.hostname:fe.hostname,fe=+fe.port;var ye=new xr(null);V&&Zs(ye,V),y&&(ye.g=y),fe&&Yi(ye,fe),R&&(ye.l=R),V=ye}return R=d.D,y=d.ya,R&&y&&Kt(V,R,y),Kt(V,"VER",d.la),so(d,V),V}function Wf(d,y,R){if(y&&!d.J)throw Error("Can't create secondary domain capable XhrIo object.");return y=d.Ca&&!d.pa?new Bt(new $i({eb:R})):new Bt(d.pa),y.Ha(d.J),y}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function Xf(){}t=Xf.prototype,t.ua=function(){},t.ta=function(){},t.sa=function(){},t.ra=function(){},t.isActive=function(){return!0},t.Na=function(){};function dl(){}dl.prototype.g=function(d,y){return new yn(d,y)};function yn(d,y){Ze.call(this),this.g=new cl(y),this.l=d,this.h=y&&y.messageUrlParams||null,d=y&&y.messageHeaders||null,y&&y.clientProtocolHeaderRequired&&(d?d["X-Client-Protocol"]="webchannel":d={"X-Client-Protocol":"webchannel"}),this.g.o=d,d=y&&y.initMessageHeaders||null,y&&y.messageContentType&&(d?d["X-WebChannel-Content-Type"]=y.messageContentType:d={"X-WebChannel-Content-Type":y.messageContentType}),y&&y.va&&(d?d["X-WebChannel-Client-Profile"]=y.va:d={"X-WebChannel-Client-Profile":y.va}),this.g.S=d,(d=y&&y.Sb)&&!Y(d)&&(this.g.m=d),this.v=y&&y.supportsCrossDomainXhr||!1,this.u=y&&y.sendRawJson||!1,(y=y&&y.httpSessionIdParam)&&!Y(y)&&(this.g.D=y,d=this.h,d!==null&&y in d&&(d=this.h,y in d&&delete d[y])),this.j=new Ha(this)}w(yn,Ze),yn.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},yn.prototype.close=function(){kc(this.g)},yn.prototype.o=function(d){var y=this.g;if(typeof d=="string"){var R={};R.__data__=d,d=R}else this.u&&(R={},R.__data__=Cn(d),d=R);y.i.push(new Ma(y.Ya++,d)),y.G==3&&fl(y)},yn.prototype.N=function(){this.g.l=null,delete this.j,kc(this.g),delete this.g,yn.aa.N.call(this)};function Yf(d){xa.call(this),d.__headers__&&(this.headers=d.__headers__,this.statusCode=d.__status__,delete d.__headers__,delete d.__status__);var y=d.__sm__;if(y){e:{for(const R in y){d=R;break e}d=void 0}(this.i=d)&&(d=this.i,y=y!==null&&d in y?y[d]:void 0),this.data=y}else this.data=d}w(Yf,xa);function $f(){Na.call(this),this.status=1}w($f,Na);function Ha(d){this.g=d}w(Ha,Xf),Ha.prototype.ua=function(){Je(this.g,"a")},Ha.prototype.ta=function(d){Je(this.g,new Yf(d))},Ha.prototype.sa=function(d){Je(this.g,new $f)},Ha.prototype.ra=function(){Je(this.g,"b")},dl.prototype.createWebChannel=dl.prototype.g,yn.prototype.send=yn.prototype.o,yn.prototype.open=yn.prototype.m,yn.prototype.close=yn.prototype.close,AA=function(){return new dl},TA=function(){return Fa()},EA=Qn,hg={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},B.NO_ERROR=0,B.TIMEOUT=8,B.HTTP_ERROR=6,_0=B,H.COMPLETE="complete",yA=H,Wi.EventType=_a,_a.OPEN="a",_a.CLOSE="b",_a.ERROR="c",_a.MESSAGE="d",Ze.prototype.listen=Ze.prototype.K,Au=Wi,Bt.prototype.listenOnce=Bt.prototype.L,Bt.prototype.getLastError=Bt.prototype.Ka,Bt.prototype.getLastErrorCode=Bt.prototype.Ba,Bt.prototype.getStatus=Bt.prototype.Z,Bt.prototype.getResponseJson=Bt.prototype.Oa,Bt.prototype.getResponseText=Bt.prototype.oa,Bt.prototype.send=Bt.prototype.ea,Bt.prototype.setWithCredentials=Bt.prototype.Ha,xA=Bt}).apply(typeof Zh<"u"?Zh:typeof self<"u"?self:typeof window<"u"?window:{});const hE="@firebase/firestore",dE="4.8.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ln{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}ln.UNAUTHENTICATED=new ln(null),ln.GOOGLE_CREDENTIALS=new ln("google-credentials-uid"),ln.FIRST_PARTY=new ln("first-party-uid"),ln.MOCK_USER=new ln("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let mc="11.10.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Lo=new Gg("@firebase/firestore");function Hl(){return Lo.logLevel}function He(t,...e){if(Lo.logLevel<=Tt.DEBUG){const r=e.map(a1);Lo.debug(`Firestore (${mc}): ${t}`,...r)}}function Bi(t,...e){if(Lo.logLevel<=Tt.ERROR){const r=e.map(a1);Lo.error(`Firestore (${mc}): ${t}`,...r)}}function Ms(t,...e){if(Lo.logLevel<=Tt.WARN){const r=e.map(a1);Lo.warn(`Firestore (${mc}): ${t}`,...r)}}function a1(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(r){return JSON.stringify(r)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rt(t,e,r){let n="Unexpected state";typeof e=="string"?n=e:r=e,wA(t,n,r)}function wA(t,e,r){let n=`FIRESTORE (${mc}) INTERNAL ASSERTION FAILED: ${e} (ID: ${t.toString(16)})`;if(r!==void 0)try{n+=" CONTEXT: "+JSON.stringify(r)}catch{n+=" CONTEXT: "+r}throw Bi(n),new Error(n)}function jt(t,e,r,n){let i="Unexpected state";typeof r=="string"?i=r:n=r,t||wA(e,i,n)}function ct(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const De={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class We extends zi{constructor(e,r){super(e,r),this.code=e,this.message=r,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fi{constructor(){this.promise=new Promise((e,r)=>{this.resolve=e,this.reject=r})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SA{constructor(e,r){this.user=r,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class sD{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,r){e.enqueueRetryable(()=>r(ln.UNAUTHENTICATED))}shutdown(){}}class oD{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,r){this.changeListener=r,e.enqueueRetryable(()=>r(this.token.user))}shutdown(){this.changeListener=null}}class lD{constructor(e){this.t=e,this.currentUser=ln.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,r){jt(this.o===void 0,42304);let n=this.i;const i=h=>this.i!==n?(n=this.i,r(h)):Promise.resolve();let o=new Fi;this.o=()=>{this.i++,this.currentUser=this.u(),o.resolve(),o=new Fi,e.enqueueRetryable(()=>i(this.currentUser))};const c=()=>{const h=o;e.enqueueRetryable(async()=>{await h.promise,await i(this.currentUser)})},u=h=>{He("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=h,this.o&&(this.auth.addAuthTokenListener(this.o),c())};this.t.onInit(h=>u(h)),setTimeout(()=>{if(!this.auth){const h=this.t.getImmediate({optional:!0});h?u(h):(He("FirebaseAuthCredentialsProvider","Auth not yet detected"),o.resolve(),o=new Fi)}},0),c()}getToken(){const e=this.i,r=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(r).then(n=>this.i!==e?(He("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):n?(jt(typeof n.accessToken=="string",31837,{l:n}),new SA(n.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return jt(e===null||typeof e=="string",2055,{h:e}),new ln(e)}}class cD{constructor(e,r,n){this.P=e,this.T=r,this.I=n,this.type="FirstParty",this.user=ln.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class uD{constructor(e,r,n){this.P=e,this.T=r,this.I=n}getToken(){return Promise.resolve(new cD(this.P,this.T,this.I))}start(e,r){e.enqueueRetryable(()=>r(ln.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class pE{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class fD{constructor(e,r){this.V=r,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,ha(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,r){jt(this.o===void 0,3512);const n=o=>{o.error!=null&&He("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${o.error.message}`);const c=o.token!==this.m;return this.m=o.token,He("FirebaseAppCheckTokenProvider",`Received ${c?"new":"existing"} token.`),c?r(o.token):Promise.resolve()};this.o=o=>{e.enqueueRetryable(()=>n(o))};const i=o=>{He("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=o,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(o=>i(o)),setTimeout(()=>{if(!this.appCheck){const o=this.V.getImmediate({optional:!0});o?i(o):He("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new pE(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(r=>r?(jt(typeof r.token=="string",44558,{tokenResult:r}),this.m=r.token,new pE(r.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hD(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),r=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(r);else for(let n=0;n<t;n++)r[n]=Math.floor(256*Math.random());return r}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function CA(){return new TextEncoder}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class i1{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",r=62*Math.floor(4.129032258064516);let n="";for(;n.length<20;){const i=hD(40);for(let o=0;o<i.length;++o)n.length<20&&i[o]<r&&(n+=e.charAt(i[o]%62))}return n}}function mt(t,e){return t<e?-1:t>e?1:0}function dg(t,e){let r=0;for(;r<t.length&&r<e.length;){const n=t.codePointAt(r),i=e.codePointAt(r);if(n!==i){if(n<128&&i<128)return mt(n,i);{const o=CA(),c=dD(o.encode(mE(t,r)),o.encode(mE(e,r)));return c!==0?c:mt(n,i)}}r+=n>65535?2:1}return mt(t.length,e.length)}function mE(t,e){return t.codePointAt(e)>65535?t.substring(e,e+2):t.substring(e,e+1)}function dD(t,e){for(let r=0;r<t.length&&r<e.length;++r)if(t[r]!==e[r])return mt(t[r],e[r]);return mt(t.length,e.length)}function ic(t,e,r){return t.length===e.length&&t.every((n,i)=>r(n,e[i]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gE="__name__";class Za{constructor(e,r,n){r===void 0?r=0:r>e.length&&rt(637,{offset:r,range:e.length}),n===void 0?n=e.length-r:n>e.length-r&&rt(1746,{length:n,range:e.length-r}),this.segments=e,this.offset=r,this.len=n}get length(){return this.len}isEqual(e){return Za.comparator(this,e)===0}child(e){const r=this.segments.slice(this.offset,this.limit());return e instanceof Za?e.forEach(n=>{r.push(n)}):r.push(e),this.construct(r)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==e.get(r))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==e.get(r))return!1;return!0}forEach(e){for(let r=this.offset,n=this.limit();r<n;r++)e(this.segments[r])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,r){const n=Math.min(e.length,r.length);for(let i=0;i<n;i++){const o=Za.compareSegments(e.get(i),r.get(i));if(o!==0)return o}return mt(e.length,r.length)}static compareSegments(e,r){const n=Za.isNumericId(e),i=Za.isNumericId(r);return n&&!i?-1:!n&&i?1:n&&i?Za.extractNumericId(e).compare(Za.extractNumericId(r)):dg(e,r)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return Ns.fromString(e.substring(4,e.length-2))}}class tr extends Za{construct(e,r,n){return new tr(e,r,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const r=[];for(const n of e){if(n.indexOf("//")>=0)throw new We(De.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);r.push(...n.split("/").filter(i=>i.length>0))}return new tr(r)}static emptyPath(){return new tr([])}}const pD=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Zr extends Za{construct(e,r,n){return new Zr(e,r,n)}static isValidIdentifier(e){return pD.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Zr.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===gE}static keyField(){return new Zr([gE])}static fromServerFormat(e){const r=[];let n="",i=0;const o=()=>{if(n.length===0)throw new We(De.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);r.push(n),n=""};let c=!1;for(;i<e.length;){const u=e[i];if(u==="\\"){if(i+1===e.length)throw new We(De.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const h=e[i+1];if(h!=="\\"&&h!=="."&&h!=="`")throw new We(De.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=h,i+=2}else u==="`"?(c=!c,i++):u!=="."||c?(n+=u,i++):(o(),i++)}if(o(),c)throw new We(De.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Zr(r)}static emptyPath(){return new Zr([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $e{constructor(e){this.path=e}static fromPath(e){return new $e(tr.fromString(e))}static fromName(e){return new $e(tr.fromString(e).popFirst(5))}static empty(){return new $e(tr.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&tr.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,r){return tr.comparator(e.path,r.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new $e(new tr(e.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function RA(t,e,r){if(!r)throw new We(De.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function mD(t,e,r,n){if(e===!0&&n===!0)throw new We(De.INVALID_ARGUMENT,`${t} and ${r} cannot be used together.`)}function vE(t){if(!$e.isDocumentKey(t))throw new We(De.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function _E(t){if($e.isDocumentKey(t))throw new We(De.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function kA(t){return typeof t=="object"&&t!==null&&(Object.getPrototypeOf(t)===Object.prototype||Object.getPrototypeOf(t)===null)}function s1(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(n){return n.constructor?n.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":rt(12329,{type:typeof t})}function Oa(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new We(De.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const r=s1(t);throw new We(De.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${r}`)}}return t}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Cr(t,e){const r={typeString:t};return e&&(r.value=e),r}function yf(t,e){if(!kA(t))throw new We(De.INVALID_ARGUMENT,"JSON must be an object");let r;for(const n in e)if(e[n]){const i=e[n].typeString,o="value"in e[n]?{value:e[n].value}:void 0;if(!(n in t)){r=`JSON missing required field: '${n}'`;break}const c=t[n];if(i&&typeof c!==i){r=`JSON field '${n}' must be a ${i}.`;break}if(o!==void 0&&c!==o.value){r=`Expected '${n}' field to equal '${o.value}'`;break}}if(r)throw new We(De.INVALID_ARGUMENT,r);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xE=-62135596800,yE=1e6;class Gt{static now(){return Gt.fromMillis(Date.now())}static fromDate(e){return Gt.fromMillis(e.getTime())}static fromMillis(e){const r=Math.floor(e/1e3),n=Math.floor((e-1e3*r)*yE);return new Gt(r,n)}constructor(e,r){if(this.seconds=e,this.nanoseconds=r,r<0)throw new We(De.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(r>=1e9)throw new We(De.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(e<xE)throw new We(De.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new We(De.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/yE}_compareTo(e){return this.seconds===e.seconds?mt(this.nanoseconds,e.nanoseconds):mt(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:Gt._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(yf(e,Gt._jsonSchema))return new Gt(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-xE;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}Gt._jsonSchemaVersion="firestore/timestamp/1.0",Gt._jsonSchema={type:Cr("string",Gt._jsonSchemaVersion),seconds:Cr("number"),nanoseconds:Cr("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lt{static fromTimestamp(e){return new lt(e)}static min(){return new lt(new Gt(0,0))}static max(){return new lt(new Gt(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qu=-1;function gD(t,e){const r=t.toTimestamp().seconds,n=t.toTimestamp().nanoseconds+1,i=lt.fromTimestamp(n===1e9?new Gt(r+1,0):new Gt(r,n));return new Ls(i,$e.empty(),e)}function vD(t){return new Ls(t.readTime,t.key,Qu)}class Ls{constructor(e,r,n){this.readTime=e,this.documentKey=r,this.largestBatchId=n}static min(){return new Ls(lt.min(),$e.empty(),Qu)}static max(){return new Ls(lt.max(),$e.empty(),Qu)}}function _D(t,e){let r=t.readTime.compareTo(e.readTime);return r!==0?r:(r=$e.comparator(t.documentKey,e.documentKey),r!==0?r:mt(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xD="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class yD{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function gc(t){if(t.code!==De.FAILED_PRECONDITION||t.message!==xD)throw t;He("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ke{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(r=>{this.isDone=!0,this.result=r,this.nextCallback&&this.nextCallback(r)},r=>{this.isDone=!0,this.error=r,this.catchCallback&&this.catchCallback(r)})}catch(e){return this.next(void 0,e)}next(e,r){return this.callbackAttached&&rt(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(r,this.error):this.wrapSuccess(e,this.result):new ke((n,i)=>{this.nextCallback=o=>{this.wrapSuccess(e,o).next(n,i)},this.catchCallback=o=>{this.wrapFailure(r,o).next(n,i)}})}toPromise(){return new Promise((e,r)=>{this.next(e,r)})}wrapUserFunction(e){try{const r=e();return r instanceof ke?r:ke.resolve(r)}catch(r){return ke.reject(r)}}wrapSuccess(e,r){return e?this.wrapUserFunction(()=>e(r)):ke.resolve(r)}wrapFailure(e,r){return e?this.wrapUserFunction(()=>e(r)):ke.reject(r)}static resolve(e){return new ke((r,n)=>{r(e)})}static reject(e){return new ke((r,n)=>{n(e)})}static waitFor(e){return new ke((r,n)=>{let i=0,o=0,c=!1;e.forEach(u=>{++i,u.next(()=>{++o,c&&o===i&&r()},h=>n(h))}),c=!0,o===i&&r()})}static or(e){let r=ke.resolve(!1);for(const n of e)r=r.next(i=>i?ke.resolve(i):n());return r}static forEach(e,r){const n=[];return e.forEach((i,o)=>{n.push(r.call(this,i,o))}),this.waitFor(n)}static mapArray(e,r){return new ke((n,i)=>{const o=e.length,c=new Array(o);let u=0;for(let h=0;h<o;h++){const p=h;r(e[p]).next(g=>{c[p]=g,++u,u===o&&n(c)},g=>i(g))}})}static doWhile(e,r){return new ke((n,i)=>{const o=()=>{e()===!0?r().next(()=>{o()},i):n()};o()})}}function ED(t){const e=t.match(/Android ([\d.]+)/i),r=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(r)}function vc(t){return t.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ld{constructor(e,r){this.previousValue=e,r&&(r.sequenceNumberHandler=n=>this._e(n),this.ae=n=>r.writeSequenceNumber(n))}_e(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ae&&this.ae(e),e}}ld.ue=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const o1=-1;function cd(t){return t==null}function N0(t){return t===0&&1/t==-1/0}function TD(t){return typeof t=="number"&&Number.isInteger(t)&&!N0(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bA="";function AD(t){let e="";for(let r=0;r<t.length;r++)e.length>0&&(e=EE(e)),e=wD(t.get(r),e);return EE(e)}function wD(t,e){let r=e;const n=t.length;for(let i=0;i<n;i++){const o=t.charAt(i);switch(o){case"\0":r+="";break;case bA:r+="";break;default:r+=o}}return r}function EE(t){return t+bA+""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function TE(t){let e=0;for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&e++;return e}function Ws(t,e){for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&e(r,t[r])}function IA(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lr{constructor(e,r){this.comparator=e,this.root=r||$r.EMPTY}insert(e,r){return new lr(this.comparator,this.root.insert(e,r,this.comparator).copy(null,null,$r.BLACK,null,null))}remove(e){return new lr(this.comparator,this.root.remove(e,this.comparator).copy(null,null,$r.BLACK,null,null))}get(e){let r=this.root;for(;!r.isEmpty();){const n=this.comparator(e,r.key);if(n===0)return r.value;n<0?r=r.left:n>0&&(r=r.right)}return null}indexOf(e){let r=0,n=this.root;for(;!n.isEmpty();){const i=this.comparator(e,n.key);if(i===0)return r+n.left.size;i<0?n=n.left:(r+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((r,n)=>(e(r,n),!1))}toString(){const e=[];return this.inorderTraversal((r,n)=>(e.push(`${r}:${n}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Jh(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Jh(this.root,e,this.comparator,!1)}getReverseIterator(){return new Jh(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Jh(this.root,e,this.comparator,!0)}}class Jh{constructor(e,r,n,i){this.isReverse=i,this.nodeStack=[];let o=1;for(;!e.isEmpty();)if(o=r?n(e.key,r):1,r&&i&&(o*=-1),o<0)e=this.isReverse?e.left:e.right;else{if(o===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const r={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return r}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class $r{constructor(e,r,n,i,o){this.key=e,this.value=r,this.color=n??$r.RED,this.left=i??$r.EMPTY,this.right=o??$r.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,r,n,i,o){return new $r(e??this.key,r??this.value,n??this.color,i??this.left,o??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,r,n){let i=this;const o=n(e,i.key);return i=o<0?i.copy(null,null,null,i.left.insert(e,r,n),null):o===0?i.copy(null,r,null,null,null):i.copy(null,null,null,null,i.right.insert(e,r,n)),i.fixUp()}removeMin(){if(this.left.isEmpty())return $r.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,r){let n,i=this;if(r(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,r),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),r(e,i.key)===0){if(i.right.isEmpty())return $r.EMPTY;n=i.right.min(),i=i.copy(n.key,n.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,r))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,$r.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,$r.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),r=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,r)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw rt(43730,{key:this.key,value:this.value});if(this.right.isRed())throw rt(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw rt(27949);return e+(this.isRed()?0:1)}}$r.EMPTY=null,$r.RED=!0,$r.BLACK=!1;$r.EMPTY=new class{constructor(){this.size=0}get key(){throw rt(57766)}get value(){throw rt(16141)}get color(){throw rt(16727)}get left(){throw rt(29726)}get right(){throw rt(36894)}copy(e,r,n,i,o){return this}insert(e,r,n){return new $r(e,r)}remove(e,r){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pr{constructor(e){this.comparator=e,this.data=new lr(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((r,n)=>(e(r),!1))}forEachInRange(e,r){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const i=n.getNext();if(this.comparator(i.key,e[1])>=0)return;r(i.key)}}forEachWhile(e,r){let n;for(n=r!==void 0?this.data.getIteratorFrom(r):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const r=this.data.getIteratorFrom(e);return r.hasNext()?r.getNext().key:null}getIterator(){return new AE(this.data.getIterator())}getIteratorFrom(e){return new AE(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let r=this;return r.size<e.size&&(r=e,e=this),e.forEach(n=>{r=r.add(n)}),r}isEqual(e){if(!(e instanceof Pr)||this.size!==e.size)return!1;const r=this.data.getIterator(),n=e.data.getIterator();for(;r.hasNext();){const i=r.getNext().key,o=n.getNext().key;if(this.comparator(i,o)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(r=>{e.push(r)}),e}toString(){const e=[];return this.forEach(r=>e.push(r)),"SortedSet("+e.toString()+")"}copy(e){const r=new Pr(this.comparator);return r.data=e,r}}class AE{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wn{constructor(e){this.fields=e,e.sort(Zr.comparator)}static empty(){return new Wn([])}unionWith(e){let r=new Pr(Zr.comparator);for(const n of this.fields)r=r.add(n);for(const n of e)r=r.add(n);return new Wn(r.toArray())}covers(e){for(const r of this.fields)if(r.isPrefixOf(e))return!0;return!1}isEqual(e){return ic(this.fields,e.fields,(r,n)=>r.isEqual(n))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DA extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rn{constructor(e){this.binaryString=e}static fromBase64String(e){const r=function(i){try{return atob(i)}catch(o){throw typeof DOMException<"u"&&o instanceof DOMException?new DA("Invalid base64 string: "+o):o}}(e);return new rn(r)}static fromUint8Array(e){const r=function(i){let o="";for(let c=0;c<i.length;++c)o+=String.fromCharCode(i[c]);return o}(e);return new rn(r)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(r){return btoa(r)}(this.binaryString)}toUint8Array(){return function(r){const n=new Uint8Array(r.length);for(let i=0;i<r.length;i++)n[i]=r.charCodeAt(i);return n}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return mt(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}rn.EMPTY_BYTE_STRING=new rn("");const SD=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Vs(t){if(jt(!!t,39018),typeof t=="string"){let e=0;const r=SD.exec(t);if(jt(!!r,46558,{timestamp:t}),r[1]){let i=r[1];i=(i+"000000000").substr(0,9),e=Number(i)}const n=new Date(t);return{seconds:Math.floor(n.getTime()/1e3),nanos:e}}return{seconds:vr(t.seconds),nanos:vr(t.nanos)}}function vr(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function Us(t){return typeof t=="string"?rn.fromBase64String(t):rn.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const OA="server_timestamp",NA="__type__",FA="__previous_value__",PA="__local_write_time__";function l1(t){var e,r;return((r=(((e=t?.mapValue)===null||e===void 0?void 0:e.fields)||{})[NA])===null||r===void 0?void 0:r.stringValue)===OA}function ud(t){const e=t.mapValue.fields[FA];return l1(e)?ud(e):e}function Zu(t){const e=Vs(t.mapValue.fields[PA].timestampValue);return new Gt(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CD{constructor(e,r,n,i,o,c,u,h,p,g){this.databaseId=e,this.appId=r,this.persistenceKey=n,this.host=i,this.ssl=o,this.forceLongPolling=c,this.autoDetectLongPolling=u,this.longPollingOptions=h,this.useFetchStreams=p,this.isUsingEmulator=g}}const F0="(default)";class Ju{constructor(e,r){this.projectId=e,this.database=r||F0}static empty(){return new Ju("","")}get isDefaultDatabase(){return this.database===F0}isEqual(e){return e instanceof Ju&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const MA="__type__",RD="__max__",e0={mapValue:{}},LA="__vector__",P0="value";function Bs(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?l1(t)?4:bD(t)?9007199254740991:kD(t)?10:11:rt(28295,{value:t})}function ai(t,e){if(t===e)return!0;const r=Bs(t);if(r!==Bs(e))return!1;switch(r){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return Zu(t).isEqual(Zu(e));case 3:return function(i,o){if(typeof i.timestampValue=="string"&&typeof o.timestampValue=="string"&&i.timestampValue.length===o.timestampValue.length)return i.timestampValue===o.timestampValue;const c=Vs(i.timestampValue),u=Vs(o.timestampValue);return c.seconds===u.seconds&&c.nanos===u.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(i,o){return Us(i.bytesValue).isEqual(Us(o.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(i,o){return vr(i.geoPointValue.latitude)===vr(o.geoPointValue.latitude)&&vr(i.geoPointValue.longitude)===vr(o.geoPointValue.longitude)}(t,e);case 2:return function(i,o){if("integerValue"in i&&"integerValue"in o)return vr(i.integerValue)===vr(o.integerValue);if("doubleValue"in i&&"doubleValue"in o){const c=vr(i.doubleValue),u=vr(o.doubleValue);return c===u?N0(c)===N0(u):isNaN(c)&&isNaN(u)}return!1}(t,e);case 9:return ic(t.arrayValue.values||[],e.arrayValue.values||[],ai);case 10:case 11:return function(i,o){const c=i.mapValue.fields||{},u=o.mapValue.fields||{};if(TE(c)!==TE(u))return!1;for(const h in c)if(c.hasOwnProperty(h)&&(u[h]===void 0||!ai(c[h],u[h])))return!1;return!0}(t,e);default:return rt(52216,{left:t})}}function ef(t,e){return(t.values||[]).find(r=>ai(r,e))!==void 0}function sc(t,e){if(t===e)return 0;const r=Bs(t),n=Bs(e);if(r!==n)return mt(r,n);switch(r){case 0:case 9007199254740991:return 0;case 1:return mt(t.booleanValue,e.booleanValue);case 2:return function(o,c){const u=vr(o.integerValue||o.doubleValue),h=vr(c.integerValue||c.doubleValue);return u<h?-1:u>h?1:u===h?0:isNaN(u)?isNaN(h)?0:-1:1}(t,e);case 3:return wE(t.timestampValue,e.timestampValue);case 4:return wE(Zu(t),Zu(e));case 5:return dg(t.stringValue,e.stringValue);case 6:return function(o,c){const u=Us(o),h=Us(c);return u.compareTo(h)}(t.bytesValue,e.bytesValue);case 7:return function(o,c){const u=o.split("/"),h=c.split("/");for(let p=0;p<u.length&&p<h.length;p++){const g=mt(u[p],h[p]);if(g!==0)return g}return mt(u.length,h.length)}(t.referenceValue,e.referenceValue);case 8:return function(o,c){const u=mt(vr(o.latitude),vr(c.latitude));return u!==0?u:mt(vr(o.longitude),vr(c.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return SE(t.arrayValue,e.arrayValue);case 10:return function(o,c){var u,h,p,g;const _=o.fields||{},x=c.fields||{},T=(u=_[P0])===null||u===void 0?void 0:u.arrayValue,w=(h=x[P0])===null||h===void 0?void 0:h.arrayValue,S=mt(((p=T?.values)===null||p===void 0?void 0:p.length)||0,((g=w?.values)===null||g===void 0?void 0:g.length)||0);return S!==0?S:SE(T,w)}(t.mapValue,e.mapValue);case 11:return function(o,c){if(o===e0.mapValue&&c===e0.mapValue)return 0;if(o===e0.mapValue)return 1;if(c===e0.mapValue)return-1;const u=o.fields||{},h=Object.keys(u),p=c.fields||{},g=Object.keys(p);h.sort(),g.sort();for(let _=0;_<h.length&&_<g.length;++_){const x=dg(h[_],g[_]);if(x!==0)return x;const T=sc(u[h[_]],p[g[_]]);if(T!==0)return T}return mt(h.length,g.length)}(t.mapValue,e.mapValue);default:throw rt(23264,{le:r})}}function wE(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return mt(t,e);const r=Vs(t),n=Vs(e),i=mt(r.seconds,n.seconds);return i!==0?i:mt(r.nanos,n.nanos)}function SE(t,e){const r=t.values||[],n=e.values||[];for(let i=0;i<r.length&&i<n.length;++i){const o=sc(r[i],n[i]);if(o)return o}return mt(r.length,n.length)}function oc(t){return pg(t)}function pg(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(r){const n=Vs(r);return`time(${n.seconds},${n.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(r){return Us(r).toBase64()}(t.bytesValue):"referenceValue"in t?function(r){return $e.fromName(r).toString()}(t.referenceValue):"geoPointValue"in t?function(r){return`geo(${r.latitude},${r.longitude})`}(t.geoPointValue):"arrayValue"in t?function(r){let n="[",i=!0;for(const o of r.values||[])i?i=!1:n+=",",n+=pg(o);return n+"]"}(t.arrayValue):"mapValue"in t?function(r){const n=Object.keys(r.fields||{}).sort();let i="{",o=!0;for(const c of n)o?o=!1:i+=",",i+=`${c}:${pg(r.fields[c])}`;return i+"}"}(t.mapValue):rt(61005,{value:t})}function x0(t){switch(Bs(t)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=ud(t);return e?16+x0(e):16;case 5:return 2*t.stringValue.length;case 6:return Us(t.bytesValue).approximateByteSize();case 7:return t.referenceValue.length;case 9:return function(n){return(n.values||[]).reduce((i,o)=>i+x0(o),0)}(t.arrayValue);case 10:case 11:return function(n){let i=0;return Ws(n.fields,(o,c)=>{i+=o.length+x0(c)}),i}(t.mapValue);default:throw rt(13486,{value:t})}}function mg(t){return!!t&&"integerValue"in t}function c1(t){return!!t&&"arrayValue"in t}function CE(t){return!!t&&"nullValue"in t}function RE(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function y0(t){return!!t&&"mapValue"in t}function kD(t){var e,r;return((r=(((e=t?.mapValue)===null||e===void 0?void 0:e.fields)||{})[MA])===null||r===void 0?void 0:r.stringValue)===LA}function Nu(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return Ws(t.mapValue.fields,(r,n)=>e.mapValue.fields[r]=Nu(n)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let r=0;r<(t.arrayValue.values||[]).length;++r)e.arrayValue.values[r]=Nu(t.arrayValue.values[r]);return e}return Object.assign({},t)}function bD(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue===RD}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fn{constructor(e){this.value=e}static empty(){return new Fn({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let r=this.value;for(let n=0;n<e.length-1;++n)if(r=(r.mapValue.fields||{})[e.get(n)],!y0(r))return null;return r=(r.mapValue.fields||{})[e.lastSegment()],r||null}}set(e,r){this.getFieldsMap(e.popLast())[e.lastSegment()]=Nu(r)}setAll(e){let r=Zr.emptyPath(),n={},i=[];e.forEach((c,u)=>{if(!r.isImmediateParentOf(u)){const h=this.getFieldsMap(r);this.applyChanges(h,n,i),n={},i=[],r=u.popLast()}c?n[u.lastSegment()]=Nu(c):i.push(u.lastSegment())});const o=this.getFieldsMap(r);this.applyChanges(o,n,i)}delete(e){const r=this.field(e.popLast());y0(r)&&r.mapValue.fields&&delete r.mapValue.fields[e.lastSegment()]}isEqual(e){return ai(this.value,e.value)}getFieldsMap(e){let r=this.value;r.mapValue.fields||(r.mapValue={fields:{}});for(let n=0;n<e.length;++n){let i=r.mapValue.fields[e.get(n)];y0(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},r.mapValue.fields[e.get(n)]=i),r=i}return r.mapValue.fields}applyChanges(e,r,n){Ws(r,(i,o)=>e[i]=o);for(const i of n)delete e[i]}clone(){return new Fn(Nu(this.value))}}function VA(t){const e=[];return Ws(t.fields,(r,n)=>{const i=new Zr([r]);if(y0(n)){const o=VA(n.mapValue).fields;if(o.length===0)e.push(i);else for(const c of o)e.push(i.child(c))}else e.push(i)}),new Wn(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class un{constructor(e,r,n,i,o,c,u){this.key=e,this.documentType=r,this.version=n,this.readTime=i,this.createTime=o,this.data=c,this.documentState=u}static newInvalidDocument(e){return new un(e,0,lt.min(),lt.min(),lt.min(),Fn.empty(),0)}static newFoundDocument(e,r,n,i){return new un(e,1,r,lt.min(),n,i,0)}static newNoDocument(e,r){return new un(e,2,r,lt.min(),lt.min(),Fn.empty(),0)}static newUnknownDocument(e,r){return new un(e,3,r,lt.min(),lt.min(),Fn.empty(),2)}convertToFoundDocument(e,r){return!this.createTime.isEqual(lt.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=r,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Fn.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Fn.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=lt.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof un&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new un(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class M0{constructor(e,r){this.position=e,this.inclusive=r}}function kE(t,e,r){let n=0;for(let i=0;i<t.position.length;i++){const o=e[i],c=t.position[i];if(o.field.isKeyField()?n=$e.comparator($e.fromName(c.referenceValue),r.key):n=sc(c,r.data.field(o.field)),o.dir==="desc"&&(n*=-1),n!==0)break}return n}function bE(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let r=0;r<t.position.length;r++)if(!ai(t.position[r],e.position[r]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class L0{constructor(e,r="asc"){this.field=e,this.dir=r}}function ID(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UA{}class Fr extends UA{constructor(e,r,n){super(),this.field=e,this.op=r,this.value=n}static create(e,r,n){return e.isKeyField()?r==="in"||r==="not-in"?this.createKeyFieldInFilter(e,r,n):new OD(e,r,n):r==="array-contains"?new PD(e,n):r==="in"?new MD(e,n):r==="not-in"?new LD(e,n):r==="array-contains-any"?new VD(e,n):new Fr(e,r,n)}static createKeyFieldInFilter(e,r,n){return r==="in"?new ND(e,n):new FD(e,n)}matches(e){const r=e.data.field(this.field);return this.op==="!="?r!==null&&r.nullValue===void 0&&this.matchesComparison(sc(r,this.value)):r!==null&&Bs(this.value)===Bs(r)&&this.matchesComparison(sc(r,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return rt(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class ii extends UA{constructor(e,r){super(),this.filters=e,this.op=r,this.he=null}static create(e,r){return new ii(e,r)}matches(e){return BA(this)?this.filters.find(r=>!r.matches(e))===void 0:this.filters.find(r=>r.matches(e))!==void 0}getFlattenedFilters(){return this.he!==null||(this.he=this.filters.reduce((e,r)=>e.concat(r.getFlattenedFilters()),[])),this.he}getFilters(){return Object.assign([],this.filters)}}function BA(t){return t.op==="and"}function jA(t){return DD(t)&&BA(t)}function DD(t){for(const e of t.filters)if(e instanceof ii)return!1;return!0}function gg(t){if(t instanceof Fr)return t.field.canonicalString()+t.op.toString()+oc(t.value);if(jA(t))return t.filters.map(e=>gg(e)).join(",");{const e=t.filters.map(r=>gg(r)).join(",");return`${t.op}(${e})`}}function zA(t,e){return t instanceof Fr?function(n,i){return i instanceof Fr&&n.op===i.op&&n.field.isEqual(i.field)&&ai(n.value,i.value)}(t,e):t instanceof ii?function(n,i){return i instanceof ii&&n.op===i.op&&n.filters.length===i.filters.length?n.filters.reduce((o,c,u)=>o&&zA(c,i.filters[u]),!0):!1}(t,e):void rt(19439)}function HA(t){return t instanceof Fr?function(r){return`${r.field.canonicalString()} ${r.op} ${oc(r.value)}`}(t):t instanceof ii?function(r){return r.op.toString()+" {"+r.getFilters().map(HA).join(" ,")+"}"}(t):"Filter"}class OD extends Fr{constructor(e,r,n){super(e,r,n),this.key=$e.fromName(n.referenceValue)}matches(e){const r=$e.comparator(e.key,this.key);return this.matchesComparison(r)}}class ND extends Fr{constructor(e,r){super(e,"in",r),this.keys=GA("in",r)}matches(e){return this.keys.some(r=>r.isEqual(e.key))}}class FD extends Fr{constructor(e,r){super(e,"not-in",r),this.keys=GA("not-in",r)}matches(e){return!this.keys.some(r=>r.isEqual(e.key))}}function GA(t,e){var r;return(((r=e.arrayValue)===null||r===void 0?void 0:r.values)||[]).map(n=>$e.fromName(n.referenceValue))}class PD extends Fr{constructor(e,r){super(e,"array-contains",r)}matches(e){const r=e.data.field(this.field);return c1(r)&&ef(r.arrayValue,this.value)}}class MD extends Fr{constructor(e,r){super(e,"in",r)}matches(e){const r=e.data.field(this.field);return r!==null&&ef(this.value.arrayValue,r)}}class LD extends Fr{constructor(e,r){super(e,"not-in",r)}matches(e){if(ef(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const r=e.data.field(this.field);return r!==null&&r.nullValue===void 0&&!ef(this.value.arrayValue,r)}}class VD extends Fr{constructor(e,r){super(e,"array-contains-any",r)}matches(e){const r=e.data.field(this.field);return!(!c1(r)||!r.arrayValue.values)&&r.arrayValue.values.some(n=>ef(this.value.arrayValue,n))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UD{constructor(e,r=null,n=[],i=[],o=null,c=null,u=null){this.path=e,this.collectionGroup=r,this.orderBy=n,this.filters=i,this.limit=o,this.startAt=c,this.endAt=u,this.Pe=null}}function IE(t,e=null,r=[],n=[],i=null,o=null,c=null){return new UD(t,e,r,n,i,o,c)}function u1(t){const e=ct(t);if(e.Pe===null){let r=e.path.canonicalString();e.collectionGroup!==null&&(r+="|cg:"+e.collectionGroup),r+="|f:",r+=e.filters.map(n=>gg(n)).join(","),r+="|ob:",r+=e.orderBy.map(n=>function(o){return o.field.canonicalString()+o.dir}(n)).join(","),cd(e.limit)||(r+="|l:",r+=e.limit),e.startAt&&(r+="|lb:",r+=e.startAt.inclusive?"b:":"a:",r+=e.startAt.position.map(n=>oc(n)).join(",")),e.endAt&&(r+="|ub:",r+=e.endAt.inclusive?"a:":"b:",r+=e.endAt.position.map(n=>oc(n)).join(",")),e.Pe=r}return e.Pe}function f1(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let r=0;r<t.orderBy.length;r++)if(!ID(t.orderBy[r],e.orderBy[r]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let r=0;r<t.filters.length;r++)if(!zA(t.filters[r],e.filters[r]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!bE(t.startAt,e.startAt)&&bE(t.endAt,e.endAt)}function vg(t){return $e.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fd{constructor(e,r=null,n=[],i=[],o=null,c="F",u=null,h=null){this.path=e,this.collectionGroup=r,this.explicitOrderBy=n,this.filters=i,this.limit=o,this.limitType=c,this.startAt=u,this.endAt=h,this.Te=null,this.Ie=null,this.de=null,this.startAt,this.endAt}}function BD(t,e,r,n,i,o,c,u){return new fd(t,e,r,n,i,o,c,u)}function h1(t){return new fd(t)}function DE(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function jD(t){return t.collectionGroup!==null}function Fu(t){const e=ct(t);if(e.Te===null){e.Te=[];const r=new Set;for(const o of e.explicitOrderBy)e.Te.push(o),r.add(o.field.canonicalString());const n=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(c){let u=new Pr(Zr.comparator);return c.filters.forEach(h=>{h.getFlattenedFilters().forEach(p=>{p.isInequality()&&(u=u.add(p.field))})}),u})(e).forEach(o=>{r.has(o.canonicalString())||o.isKeyField()||e.Te.push(new L0(o,n))}),r.has(Zr.keyField().canonicalString())||e.Te.push(new L0(Zr.keyField(),n))}return e.Te}function ei(t){const e=ct(t);return e.Ie||(e.Ie=zD(e,Fu(t))),e.Ie}function zD(t,e){if(t.limitType==="F")return IE(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(i=>{const o=i.dir==="desc"?"asc":"desc";return new L0(i.field,o)});const r=t.endAt?new M0(t.endAt.position,t.endAt.inclusive):null,n=t.startAt?new M0(t.startAt.position,t.startAt.inclusive):null;return IE(t.path,t.collectionGroup,e,t.filters,t.limit,r,n)}}function _g(t,e,r){return new fd(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,r,t.startAt,t.endAt)}function hd(t,e){return f1(ei(t),ei(e))&&t.limitType===e.limitType}function qA(t){return`${u1(ei(t))}|lt:${t.limitType}`}function Gl(t){return`Query(target=${function(r){let n=r.path.canonicalString();return r.collectionGroup!==null&&(n+=" collectionGroup="+r.collectionGroup),r.filters.length>0&&(n+=`, filters: [${r.filters.map(i=>HA(i)).join(", ")}]`),cd(r.limit)||(n+=", limit: "+r.limit),r.orderBy.length>0&&(n+=`, orderBy: [${r.orderBy.map(i=>function(c){return`${c.field.canonicalString()} (${c.dir})`}(i)).join(", ")}]`),r.startAt&&(n+=", startAt: ",n+=r.startAt.inclusive?"b:":"a:",n+=r.startAt.position.map(i=>oc(i)).join(",")),r.endAt&&(n+=", endAt: ",n+=r.endAt.inclusive?"a:":"b:",n+=r.endAt.position.map(i=>oc(i)).join(",")),`Target(${n})`}(ei(t))}; limitType=${t.limitType})`}function dd(t,e){return e.isFoundDocument()&&function(n,i){const o=i.key.path;return n.collectionGroup!==null?i.key.hasCollectionId(n.collectionGroup)&&n.path.isPrefixOf(o):$e.isDocumentKey(n.path)?n.path.isEqual(o):n.path.isImmediateParentOf(o)}(t,e)&&function(n,i){for(const o of Fu(n))if(!o.field.isKeyField()&&i.data.field(o.field)===null)return!1;return!0}(t,e)&&function(n,i){for(const o of n.filters)if(!o.matches(i))return!1;return!0}(t,e)&&function(n,i){return!(n.startAt&&!function(c,u,h){const p=kE(c,u,h);return c.inclusive?p<=0:p<0}(n.startAt,Fu(n),i)||n.endAt&&!function(c,u,h){const p=kE(c,u,h);return c.inclusive?p>=0:p>0}(n.endAt,Fu(n),i))}(t,e)}function HD(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function KA(t){return(e,r)=>{let n=!1;for(const i of Fu(t)){const o=GD(i,e,r);if(o!==0)return o;n=n||i.field.isKeyField()}return 0}}function GD(t,e,r){const n=t.field.isKeyField()?$e.comparator(e.key,r.key):function(o,c,u){const h=c.data.field(o),p=u.data.field(o);return h!==null&&p!==null?sc(h,p):rt(42886)}(t.field,e,r);switch(t.dir){case"asc":return n;case"desc":return-1*n;default:return rt(19790,{direction:t.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ko{constructor(e,r){this.mapKeyFn=e,this.equalsFn=r,this.inner={},this.innerSize=0}get(e){const r=this.mapKeyFn(e),n=this.inner[r];if(n!==void 0){for(const[i,o]of n)if(this.equalsFn(i,e))return o}}has(e){return this.get(e)!==void 0}set(e,r){const n=this.mapKeyFn(e),i=this.inner[n];if(i===void 0)return this.inner[n]=[[e,r]],void this.innerSize++;for(let o=0;o<i.length;o++)if(this.equalsFn(i[o][0],e))return void(i[o]=[e,r]);i.push([e,r]),this.innerSize++}delete(e){const r=this.mapKeyFn(e),n=this.inner[r];if(n===void 0)return!1;for(let i=0;i<n.length;i++)if(this.equalsFn(n[i][0],e))return n.length===1?delete this.inner[r]:n.splice(i,1),this.innerSize--,!0;return!1}forEach(e){Ws(this.inner,(r,n)=>{for(const[i,o]of n)e(i,o)})}isEmpty(){return IA(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qD=new lr($e.comparator);function ji(){return qD}const WA=new lr($e.comparator);function wu(...t){let e=WA;for(const r of t)e=e.insert(r.key,r);return e}function XA(t){let e=WA;return t.forEach((r,n)=>e=e.insert(r,n.overlayedDocument)),e}function ko(){return Pu()}function YA(){return Pu()}function Pu(){return new Ko(t=>t.toString(),(t,e)=>t.isEqual(e))}const KD=new lr($e.comparator),WD=new Pr($e.comparator);function At(...t){let e=WD;for(const r of t)e=e.add(r);return e}const XD=new Pr(mt);function YD(){return XD}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function d1(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:N0(e)?"-0":e}}function $A(t){return{integerValue:""+t}}function $D(t,e){return TD(e)?$A(e):d1(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pd{constructor(){this._=void 0}}function QD(t,e,r){return t instanceof V0?function(i,o){const c={fields:{[NA]:{stringValue:OA},[PA]:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return o&&l1(o)&&(o=ud(o)),o&&(c.fields[FA]=o),{mapValue:c}}(r,e):t instanceof tf?ZA(t,e):t instanceof rf?JA(t,e):function(i,o){const c=QA(i,o),u=OE(c)+OE(i.Ee);return mg(c)&&mg(i.Ee)?$A(u):d1(i.serializer,u)}(t,e)}function ZD(t,e,r){return t instanceof tf?ZA(t,e):t instanceof rf?JA(t,e):r}function QA(t,e){return t instanceof U0?function(n){return mg(n)||function(o){return!!o&&"doubleValue"in o}(n)}(e)?e:{integerValue:0}:null}class V0 extends pd{}class tf extends pd{constructor(e){super(),this.elements=e}}function ZA(t,e){const r=ew(e);for(const n of t.elements)r.some(i=>ai(i,n))||r.push(n);return{arrayValue:{values:r}}}class rf extends pd{constructor(e){super(),this.elements=e}}function JA(t,e){let r=ew(e);for(const n of t.elements)r=r.filter(i=>!ai(i,n));return{arrayValue:{values:r}}}class U0 extends pd{constructor(e,r){super(),this.serializer=e,this.Ee=r}}function OE(t){return vr(t.integerValue||t.doubleValue)}function ew(t){return c1(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}function JD(t,e){return t.field.isEqual(e.field)&&function(n,i){return n instanceof tf&&i instanceof tf||n instanceof rf&&i instanceof rf?ic(n.elements,i.elements,ai):n instanceof U0&&i instanceof U0?ai(n.Ee,i.Ee):n instanceof V0&&i instanceof V0}(t.transform,e.transform)}class eO{constructor(e,r){this.version=e,this.transformResults=r}}class pa{constructor(e,r){this.updateTime=e,this.exists=r}static none(){return new pa}static exists(e){return new pa(void 0,e)}static updateTime(e){return new pa(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function E0(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class md{}function tw(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new p1(t.key,pa.none()):new Ef(t.key,t.data,pa.none());{const r=t.data,n=Fn.empty();let i=new Pr(Zr.comparator);for(let o of e.fields)if(!i.has(o)){let c=r.field(o);c===null&&o.length>1&&(o=o.popLast(),c=r.field(o)),c===null?n.delete(o):n.set(o,c),i=i.add(o)}return new Xs(t.key,n,new Wn(i.toArray()),pa.none())}}function tO(t,e,r){t instanceof Ef?function(i,o,c){const u=i.value.clone(),h=FE(i.fieldTransforms,o,c.transformResults);u.setAll(h),o.convertToFoundDocument(c.version,u).setHasCommittedMutations()}(t,e,r):t instanceof Xs?function(i,o,c){if(!E0(i.precondition,o))return void o.convertToUnknownDocument(c.version);const u=FE(i.fieldTransforms,o,c.transformResults),h=o.data;h.setAll(rw(i)),h.setAll(u),o.convertToFoundDocument(c.version,h).setHasCommittedMutations()}(t,e,r):function(i,o,c){o.convertToNoDocument(c.version).setHasCommittedMutations()}(0,e,r)}function Mu(t,e,r,n){return t instanceof Ef?function(o,c,u,h){if(!E0(o.precondition,c))return u;const p=o.value.clone(),g=PE(o.fieldTransforms,h,c);return p.setAll(g),c.convertToFoundDocument(c.version,p).setHasLocalMutations(),null}(t,e,r,n):t instanceof Xs?function(o,c,u,h){if(!E0(o.precondition,c))return u;const p=PE(o.fieldTransforms,h,c),g=c.data;return g.setAll(rw(o)),g.setAll(p),c.convertToFoundDocument(c.version,g).setHasLocalMutations(),u===null?null:u.unionWith(o.fieldMask.fields).unionWith(o.fieldTransforms.map(_=>_.field))}(t,e,r,n):function(o,c,u){return E0(o.precondition,c)?(c.convertToNoDocument(c.version).setHasLocalMutations(),null):u}(t,e,r)}function rO(t,e){let r=null;for(const n of t.fieldTransforms){const i=e.data.field(n.field),o=QA(n.transform,i||null);o!=null&&(r===null&&(r=Fn.empty()),r.set(n.field,o))}return r||null}function NE(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(n,i){return n===void 0&&i===void 0||!(!n||!i)&&ic(n,i,(o,c)=>JD(o,c))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class Ef extends md{constructor(e,r,n,i=[]){super(),this.key=e,this.value=r,this.precondition=n,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class Xs extends md{constructor(e,r,n,i,o=[]){super(),this.key=e,this.data=r,this.fieldMask=n,this.precondition=i,this.fieldTransforms=o,this.type=1}getFieldMask(){return this.fieldMask}}function rw(t){const e=new Map;return t.fieldMask.fields.forEach(r=>{if(!r.isEmpty()){const n=t.data.field(r);e.set(r,n)}}),e}function FE(t,e,r){const n=new Map;jt(t.length===r.length,32656,{Ae:r.length,Re:t.length});for(let i=0;i<r.length;i++){const o=t[i],c=o.transform,u=e.data.field(o.field);n.set(o.field,ZD(c,u,r[i]))}return n}function PE(t,e,r){const n=new Map;for(const i of t){const o=i.transform,c=r.data.field(i.field);n.set(i.field,QD(o,c,e))}return n}class p1 extends md{constructor(e,r){super(),this.key=e,this.precondition=r,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class nO extends md{constructor(e,r){super(),this.key=e,this.precondition=r,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aO{constructor(e,r,n,i){this.batchId=e,this.localWriteTime=r,this.baseMutations=n,this.mutations=i}applyToRemoteDocument(e,r){const n=r.mutationResults;for(let i=0;i<this.mutations.length;i++){const o=this.mutations[i];o.key.isEqual(e.key)&&tO(o,e,n[i])}}applyToLocalView(e,r){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(r=Mu(n,e,r,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(r=Mu(n,e,r,this.localWriteTime));return r}applyToLocalDocumentSet(e,r){const n=YA();return this.mutations.forEach(i=>{const o=e.get(i.key),c=o.overlayedDocument;let u=this.applyToLocalView(c,o.mutatedFields);u=r.has(i.key)?null:u;const h=tw(c,u);h!==null&&n.set(i.key,h),c.isValidDocument()||c.convertToNoDocument(lt.min())}),n}keys(){return this.mutations.reduce((e,r)=>e.add(r.key),At())}isEqual(e){return this.batchId===e.batchId&&ic(this.mutations,e.mutations,(r,n)=>NE(r,n))&&ic(this.baseMutations,e.baseMutations,(r,n)=>NE(r,n))}}class m1{constructor(e,r,n,i){this.batch=e,this.commitVersion=r,this.mutationResults=n,this.docVersions=i}static from(e,r,n){jt(e.mutations.length===n.length,58842,{Ve:e.mutations.length,me:n.length});let i=function(){return KD}();const o=e.mutations;for(let c=0;c<o.length;c++)i=i.insert(o[c].key,n[c].version);return new m1(e,r,n,i)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iO{constructor(e,r){this.largestBatchId=e,this.mutation=r}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sO{constructor(e,r){this.count=e,this.unchangedNames=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ar,It;function oO(t){switch(t){case De.OK:return rt(64938);case De.CANCELLED:case De.UNKNOWN:case De.DEADLINE_EXCEEDED:case De.RESOURCE_EXHAUSTED:case De.INTERNAL:case De.UNAVAILABLE:case De.UNAUTHENTICATED:return!1;case De.INVALID_ARGUMENT:case De.NOT_FOUND:case De.ALREADY_EXISTS:case De.PERMISSION_DENIED:case De.FAILED_PRECONDITION:case De.ABORTED:case De.OUT_OF_RANGE:case De.UNIMPLEMENTED:case De.DATA_LOSS:return!0;default:return rt(15467,{code:t})}}function nw(t){if(t===void 0)return Bi("GRPC error has no .code"),De.UNKNOWN;switch(t){case Ar.OK:return De.OK;case Ar.CANCELLED:return De.CANCELLED;case Ar.UNKNOWN:return De.UNKNOWN;case Ar.DEADLINE_EXCEEDED:return De.DEADLINE_EXCEEDED;case Ar.RESOURCE_EXHAUSTED:return De.RESOURCE_EXHAUSTED;case Ar.INTERNAL:return De.INTERNAL;case Ar.UNAVAILABLE:return De.UNAVAILABLE;case Ar.UNAUTHENTICATED:return De.UNAUTHENTICATED;case Ar.INVALID_ARGUMENT:return De.INVALID_ARGUMENT;case Ar.NOT_FOUND:return De.NOT_FOUND;case Ar.ALREADY_EXISTS:return De.ALREADY_EXISTS;case Ar.PERMISSION_DENIED:return De.PERMISSION_DENIED;case Ar.FAILED_PRECONDITION:return De.FAILED_PRECONDITION;case Ar.ABORTED:return De.ABORTED;case Ar.OUT_OF_RANGE:return De.OUT_OF_RANGE;case Ar.UNIMPLEMENTED:return De.UNIMPLEMENTED;case Ar.DATA_LOSS:return De.DATA_LOSS;default:return rt(39323,{code:t})}}(It=Ar||(Ar={}))[It.OK=0]="OK",It[It.CANCELLED=1]="CANCELLED",It[It.UNKNOWN=2]="UNKNOWN",It[It.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",It[It.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",It[It.NOT_FOUND=5]="NOT_FOUND",It[It.ALREADY_EXISTS=6]="ALREADY_EXISTS",It[It.PERMISSION_DENIED=7]="PERMISSION_DENIED",It[It.UNAUTHENTICATED=16]="UNAUTHENTICATED",It[It.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",It[It.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",It[It.ABORTED=10]="ABORTED",It[It.OUT_OF_RANGE=11]="OUT_OF_RANGE",It[It.UNIMPLEMENTED=12]="UNIMPLEMENTED",It[It.INTERNAL=13]="INTERNAL",It[It.UNAVAILABLE=14]="UNAVAILABLE",It[It.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lO=new Ns([4294967295,4294967295],0);function ME(t){const e=CA().encode(t),r=new _A;return r.update(e),new Uint8Array(r.digest())}function LE(t){const e=new DataView(t.buffer),r=e.getUint32(0,!0),n=e.getUint32(4,!0),i=e.getUint32(8,!0),o=e.getUint32(12,!0);return[new Ns([r,n],0),new Ns([i,o],0)]}class g1{constructor(e,r,n){if(this.bitmap=e,this.padding=r,this.hashCount=n,r<0||r>=8)throw new Su(`Invalid padding: ${r}`);if(n<0)throw new Su(`Invalid hash count: ${n}`);if(e.length>0&&this.hashCount===0)throw new Su(`Invalid hash count: ${n}`);if(e.length===0&&r!==0)throw new Su(`Invalid padding when bitmap length is 0: ${r}`);this.fe=8*e.length-r,this.ge=Ns.fromNumber(this.fe)}pe(e,r,n){let i=e.add(r.multiply(Ns.fromNumber(n)));return i.compare(lO)===1&&(i=new Ns([i.getBits(0),i.getBits(1)],0)),i.modulo(this.ge).toNumber()}ye(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.fe===0)return!1;const r=ME(e),[n,i]=LE(r);for(let o=0;o<this.hashCount;o++){const c=this.pe(n,i,o);if(!this.ye(c))return!1}return!0}static create(e,r,n){const i=e%8==0?0:8-e%8,o=new Uint8Array(Math.ceil(e/8)),c=new g1(o,i,r);return n.forEach(u=>c.insert(u)),c}insert(e){if(this.fe===0)return;const r=ME(e),[n,i]=LE(r);for(let o=0;o<this.hashCount;o++){const c=this.pe(n,i,o);this.we(c)}}we(e){const r=Math.floor(e/8),n=e%8;this.bitmap[r]|=1<<n}}class Su extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gd{constructor(e,r,n,i,o){this.snapshotVersion=e,this.targetChanges=r,this.targetMismatches=n,this.documentUpdates=i,this.resolvedLimboDocuments=o}static createSynthesizedRemoteEventForCurrentChange(e,r,n){const i=new Map;return i.set(e,Tf.createSynthesizedTargetChangeForCurrentChange(e,r,n)),new gd(lt.min(),i,new lr(mt),ji(),At())}}class Tf{constructor(e,r,n,i,o){this.resumeToken=e,this.current=r,this.addedDocuments=n,this.modifiedDocuments=i,this.removedDocuments=o}static createSynthesizedTargetChangeForCurrentChange(e,r,n){return new Tf(n,r,At(),At(),At())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class T0{constructor(e,r,n,i){this.Se=e,this.removedTargetIds=r,this.key=n,this.be=i}}class aw{constructor(e,r){this.targetId=e,this.De=r}}class iw{constructor(e,r,n=rn.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=r,this.resumeToken=n,this.cause=i}}class VE{constructor(){this.ve=0,this.Ce=UE(),this.Fe=rn.EMPTY_BYTE_STRING,this.Me=!1,this.xe=!0}get current(){return this.Me}get resumeToken(){return this.Fe}get Oe(){return this.ve!==0}get Ne(){return this.xe}Be(e){e.approximateByteSize()>0&&(this.xe=!0,this.Fe=e)}Le(){let e=At(),r=At(),n=At();return this.Ce.forEach((i,o)=>{switch(o){case 0:e=e.add(i);break;case 2:r=r.add(i);break;case 1:n=n.add(i);break;default:rt(38017,{changeType:o})}}),new Tf(this.Fe,this.Me,e,r,n)}ke(){this.xe=!1,this.Ce=UE()}qe(e,r){this.xe=!0,this.Ce=this.Ce.insert(e,r)}Qe(e){this.xe=!0,this.Ce=this.Ce.remove(e)}$e(){this.ve+=1}Ue(){this.ve-=1,jt(this.ve>=0,3241,{ve:this.ve})}Ke(){this.xe=!0,this.Me=!0}}class cO{constructor(e){this.We=e,this.Ge=new Map,this.ze=ji(),this.je=t0(),this.Je=t0(),this.He=new lr(mt)}Ye(e){for(const r of e.Se)e.be&&e.be.isFoundDocument()?this.Ze(r,e.be):this.Xe(r,e.key,e.be);for(const r of e.removedTargetIds)this.Xe(r,e.key,e.be)}et(e){this.forEachTarget(e,r=>{const n=this.tt(r);switch(e.state){case 0:this.nt(r)&&n.Be(e.resumeToken);break;case 1:n.Ue(),n.Oe||n.ke(),n.Be(e.resumeToken);break;case 2:n.Ue(),n.Oe||this.removeTarget(r);break;case 3:this.nt(r)&&(n.Ke(),n.Be(e.resumeToken));break;case 4:this.nt(r)&&(this.rt(r),n.Be(e.resumeToken));break;default:rt(56790,{state:e.state})}})}forEachTarget(e,r){e.targetIds.length>0?e.targetIds.forEach(r):this.Ge.forEach((n,i)=>{this.nt(i)&&r(i)})}it(e){const r=e.targetId,n=e.De.count,i=this.st(r);if(i){const o=i.target;if(vg(o))if(n===0){const c=new $e(o.path);this.Xe(r,c,un.newNoDocument(c,lt.min()))}else jt(n===1,20013,{expectedCount:n});else{const c=this.ot(r);if(c!==n){const u=this._t(e),h=u?this.ut(u,e,c):1;if(h!==0){this.rt(r);const p=h===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.He=this.He.insert(r,p)}}}}}_t(e){const r=e.De.unchangedNames;if(!r||!r.bits)return null;const{bits:{bitmap:n="",padding:i=0},hashCount:o=0}=r;let c,u;try{c=Us(n).toUint8Array()}catch(h){if(h instanceof DA)return Ms("Decoding the base64 bloom filter in existence filter failed ("+h.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw h}try{u=new g1(c,i,o)}catch(h){return Ms(h instanceof Su?"BloomFilter error: ":"Applying bloom filter failed: ",h),null}return u.fe===0?null:u}ut(e,r,n){return r.De.count===n-this.ht(e,r.targetId)?0:2}ht(e,r){const n=this.We.getRemoteKeysForTarget(r);let i=0;return n.forEach(o=>{const c=this.We.lt(),u=`projects/${c.projectId}/databases/${c.database}/documents/${o.path.canonicalString()}`;e.mightContain(u)||(this.Xe(r,o,null),i++)}),i}Pt(e){const r=new Map;this.Ge.forEach((o,c)=>{const u=this.st(c);if(u){if(o.current&&vg(u.target)){const h=new $e(u.target.path);this.Tt(h).has(c)||this.It(c,h)||this.Xe(c,h,un.newNoDocument(h,e))}o.Ne&&(r.set(c,o.Le()),o.ke())}});let n=At();this.Je.forEach((o,c)=>{let u=!0;c.forEachWhile(h=>{const p=this.st(h);return!p||p.purpose==="TargetPurposeLimboResolution"||(u=!1,!1)}),u&&(n=n.add(o))}),this.ze.forEach((o,c)=>c.setReadTime(e));const i=new gd(e,r,this.He,this.ze,n);return this.ze=ji(),this.je=t0(),this.Je=t0(),this.He=new lr(mt),i}Ze(e,r){if(!this.nt(e))return;const n=this.It(e,r.key)?2:0;this.tt(e).qe(r.key,n),this.ze=this.ze.insert(r.key,r),this.je=this.je.insert(r.key,this.Tt(r.key).add(e)),this.Je=this.Je.insert(r.key,this.dt(r.key).add(e))}Xe(e,r,n){if(!this.nt(e))return;const i=this.tt(e);this.It(e,r)?i.qe(r,1):i.Qe(r),this.Je=this.Je.insert(r,this.dt(r).delete(e)),this.Je=this.Je.insert(r,this.dt(r).add(e)),n&&(this.ze=this.ze.insert(r,n))}removeTarget(e){this.Ge.delete(e)}ot(e){const r=this.tt(e).Le();return this.We.getRemoteKeysForTarget(e).size+r.addedDocuments.size-r.removedDocuments.size}$e(e){this.tt(e).$e()}tt(e){let r=this.Ge.get(e);return r||(r=new VE,this.Ge.set(e,r)),r}dt(e){let r=this.Je.get(e);return r||(r=new Pr(mt),this.Je=this.Je.insert(e,r)),r}Tt(e){let r=this.je.get(e);return r||(r=new Pr(mt),this.je=this.je.insert(e,r)),r}nt(e){const r=this.st(e)!==null;return r||He("WatchChangeAggregator","Detected inactive target",e),r}st(e){const r=this.Ge.get(e);return r&&r.Oe?null:this.We.Et(e)}rt(e){this.Ge.set(e,new VE),this.We.getRemoteKeysForTarget(e).forEach(r=>{this.Xe(e,r,null)})}It(e,r){return this.We.getRemoteKeysForTarget(e).has(r)}}function t0(){return new lr($e.comparator)}function UE(){return new lr($e.comparator)}const uO={asc:"ASCENDING",desc:"DESCENDING"},fO={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},hO={and:"AND",or:"OR"};class dO{constructor(e,r){this.databaseId=e,this.useProto3Json=r}}function xg(t,e){return t.useProto3Json||cd(e)?e:{value:e}}function B0(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function sw(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function pO(t,e){return B0(t,e.toTimestamp())}function ti(t){return jt(!!t,49232),lt.fromTimestamp(function(r){const n=Vs(r);return new Gt(n.seconds,n.nanos)}(t))}function v1(t,e){return yg(t,e).canonicalString()}function yg(t,e){const r=function(i){return new tr(["projects",i.projectId,"databases",i.database])}(t).child("documents");return e===void 0?r:r.child(e)}function ow(t){const e=tr.fromString(t);return jt(hw(e),10190,{key:e.toString()}),e}function Eg(t,e){return v1(t.databaseId,e.path)}function zm(t,e){const r=ow(e);if(r.get(1)!==t.databaseId.projectId)throw new We(De.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+r.get(1)+" vs "+t.databaseId.projectId);if(r.get(3)!==t.databaseId.database)throw new We(De.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+r.get(3)+" vs "+t.databaseId.database);return new $e(cw(r))}function lw(t,e){return v1(t.databaseId,e)}function mO(t){const e=ow(t);return e.length===4?tr.emptyPath():cw(e)}function Tg(t){return new tr(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function cw(t){return jt(t.length>4&&t.get(4)==="documents",29091,{key:t.toString()}),t.popFirst(5)}function BE(t,e,r){return{name:Eg(t,e),fields:r.value.mapValue.fields}}function gO(t,e){let r;if("targetChange"in e){e.targetChange;const n=function(p){return p==="NO_CHANGE"?0:p==="ADD"?1:p==="REMOVE"?2:p==="CURRENT"?3:p==="RESET"?4:rt(39313,{state:p})}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],o=function(p,g){return p.useProto3Json?(jt(g===void 0||typeof g=="string",58123),rn.fromBase64String(g||"")):(jt(g===void 0||g instanceof Buffer||g instanceof Uint8Array,16193),rn.fromUint8Array(g||new Uint8Array))}(t,e.targetChange.resumeToken),c=e.targetChange.cause,u=c&&function(p){const g=p.code===void 0?De.UNKNOWN:nw(p.code);return new We(g,p.message||"")}(c);r=new iw(n,i,o,u||null)}else if("documentChange"in e){e.documentChange;const n=e.documentChange;n.document,n.document.name,n.document.updateTime;const i=zm(t,n.document.name),o=ti(n.document.updateTime),c=n.document.createTime?ti(n.document.createTime):lt.min(),u=new Fn({mapValue:{fields:n.document.fields}}),h=un.newFoundDocument(i,o,c,u),p=n.targetIds||[],g=n.removedTargetIds||[];r=new T0(p,g,h.key,h)}else if("documentDelete"in e){e.documentDelete;const n=e.documentDelete;n.document;const i=zm(t,n.document),o=n.readTime?ti(n.readTime):lt.min(),c=un.newNoDocument(i,o),u=n.removedTargetIds||[];r=new T0([],u,c.key,c)}else if("documentRemove"in e){e.documentRemove;const n=e.documentRemove;n.document;const i=zm(t,n.document),o=n.removedTargetIds||[];r=new T0([],o,i,null)}else{if(!("filter"in e))return rt(11601,{At:e});{e.filter;const n=e.filter;n.targetId;const{count:i=0,unchangedNames:o}=n,c=new sO(i,o),u=n.targetId;r=new aw(u,c)}}return r}function vO(t,e){let r;if(e instanceof Ef)r={update:BE(t,e.key,e.value)};else if(e instanceof p1)r={delete:Eg(t,e.key)};else if(e instanceof Xs)r={update:BE(t,e.key,e.data),updateMask:CO(e.fieldMask)};else{if(!(e instanceof nO))return rt(16599,{Rt:e.type});r={verify:Eg(t,e.key)}}return e.fieldTransforms.length>0&&(r.updateTransforms=e.fieldTransforms.map(n=>function(o,c){const u=c.transform;if(u instanceof V0)return{fieldPath:c.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(u instanceof tf)return{fieldPath:c.field.canonicalString(),appendMissingElements:{values:u.elements}};if(u instanceof rf)return{fieldPath:c.field.canonicalString(),removeAllFromArray:{values:u.elements}};if(u instanceof U0)return{fieldPath:c.field.canonicalString(),increment:u.Ee};throw rt(20930,{transform:c.transform})}(0,n))),e.precondition.isNone||(r.currentDocument=function(i,o){return o.updateTime!==void 0?{updateTime:pO(i,o.updateTime)}:o.exists!==void 0?{exists:o.exists}:rt(27497)}(t,e.precondition)),r}function _O(t,e){return t&&t.length>0?(jt(e!==void 0,14353),t.map(r=>function(i,o){let c=i.updateTime?ti(i.updateTime):ti(o);return c.isEqual(lt.min())&&(c=ti(o)),new eO(c,i.transformResults||[])}(r,e))):[]}function xO(t,e){return{documents:[lw(t,e.path)]}}function yO(t,e){const r={structuredQuery:{}},n=e.path;let i;e.collectionGroup!==null?(i=n,r.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=n.popLast(),r.structuredQuery.from=[{collectionId:n.lastSegment()}]),r.parent=lw(t,i);const o=function(p){if(p.length!==0)return fw(ii.create(p,"and"))}(e.filters);o&&(r.structuredQuery.where=o);const c=function(p){if(p.length!==0)return p.map(g=>function(x){return{field:ql(x.field),direction:AO(x.dir)}}(g))}(e.orderBy);c&&(r.structuredQuery.orderBy=c);const u=xg(t,e.limit);return u!==null&&(r.structuredQuery.limit=u),e.startAt&&(r.structuredQuery.startAt=function(p){return{before:p.inclusive,values:p.position}}(e.startAt)),e.endAt&&(r.structuredQuery.endAt=function(p){return{before:!p.inclusive,values:p.position}}(e.endAt)),{Vt:r,parent:i}}function EO(t){let e=mO(t.parent);const r=t.structuredQuery,n=r.from?r.from.length:0;let i=null;if(n>0){jt(n===1,65062);const g=r.from[0];g.allDescendants?i=g.collectionId:e=e.child(g.collectionId)}let o=[];r.where&&(o=function(_){const x=uw(_);return x instanceof ii&&jA(x)?x.getFilters():[x]}(r.where));let c=[];r.orderBy&&(c=function(_){return _.map(x=>function(w){return new L0(Kl(w.field),function(C){switch(C){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(w.direction))}(x))}(r.orderBy));let u=null;r.limit&&(u=function(_){let x;return x=typeof _=="object"?_.value:_,cd(x)?null:x}(r.limit));let h=null;r.startAt&&(h=function(_){const x=!!_.before,T=_.values||[];return new M0(T,x)}(r.startAt));let p=null;return r.endAt&&(p=function(_){const x=!_.before,T=_.values||[];return new M0(T,x)}(r.endAt)),BD(e,i,c,o,u,"F",h,p)}function TO(t,e){const r=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return rt(28987,{purpose:i})}}(e.purpose);return r==null?null:{"goog-listen-tags":r}}function uw(t){return t.unaryFilter!==void 0?function(r){switch(r.unaryFilter.op){case"IS_NAN":const n=Kl(r.unaryFilter.field);return Fr.create(n,"==",{doubleValue:NaN});case"IS_NULL":const i=Kl(r.unaryFilter.field);return Fr.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const o=Kl(r.unaryFilter.field);return Fr.create(o,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const c=Kl(r.unaryFilter.field);return Fr.create(c,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return rt(61313);default:return rt(60726)}}(t):t.fieldFilter!==void 0?function(r){return Fr.create(Kl(r.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return rt(58110);default:return rt(50506)}}(r.fieldFilter.op),r.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(r){return ii.create(r.compositeFilter.filters.map(n=>uw(n)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return rt(1026)}}(r.compositeFilter.op))}(t):rt(30097,{filter:t})}function AO(t){return uO[t]}function wO(t){return fO[t]}function SO(t){return hO[t]}function ql(t){return{fieldPath:t.canonicalString()}}function Kl(t){return Zr.fromServerFormat(t.fieldPath)}function fw(t){return t instanceof Fr?function(r){if(r.op==="=="){if(RE(r.value))return{unaryFilter:{field:ql(r.field),op:"IS_NAN"}};if(CE(r.value))return{unaryFilter:{field:ql(r.field),op:"IS_NULL"}}}else if(r.op==="!="){if(RE(r.value))return{unaryFilter:{field:ql(r.field),op:"IS_NOT_NAN"}};if(CE(r.value))return{unaryFilter:{field:ql(r.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:ql(r.field),op:wO(r.op),value:r.value}}}(t):t instanceof ii?function(r){const n=r.getFilters().map(i=>fw(i));return n.length===1?n[0]:{compositeFilter:{op:SO(r.op),filters:n}}}(t):rt(54877,{filter:t})}function CO(t){const e=[];return t.fields.forEach(r=>e.push(r.canonicalString())),{fieldPaths:e}}function hw(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cs{constructor(e,r,n,i,o=lt.min(),c=lt.min(),u=rn.EMPTY_BYTE_STRING,h=null){this.target=e,this.targetId=r,this.purpose=n,this.sequenceNumber=i,this.snapshotVersion=o,this.lastLimboFreeSnapshotVersion=c,this.resumeToken=u,this.expectedCount=h}withSequenceNumber(e){return new Cs(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,r){return new Cs(this.target,this.targetId,this.purpose,this.sequenceNumber,r,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Cs(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Cs(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RO{constructor(e){this.gt=e}}function kO(t){const e=EO({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?_g(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bO{constructor(){this.Dn=new IO}addToCollectionParentIndex(e,r){return this.Dn.add(r),ke.resolve()}getCollectionParents(e,r){return ke.resolve(this.Dn.getEntries(r))}addFieldIndex(e,r){return ke.resolve()}deleteFieldIndex(e,r){return ke.resolve()}deleteAllFieldIndexes(e){return ke.resolve()}createTargetIndexes(e,r){return ke.resolve()}getDocumentsMatchingTarget(e,r){return ke.resolve(null)}getIndexType(e,r){return ke.resolve(0)}getFieldIndexes(e,r){return ke.resolve([])}getNextCollectionGroupToUpdate(e){return ke.resolve(null)}getMinOffset(e,r){return ke.resolve(Ls.min())}getMinOffsetFromCollectionGroup(e,r){return ke.resolve(Ls.min())}updateCollectionGroup(e,r,n){return ke.resolve()}updateIndexEntries(e,r){return ke.resolve()}}class IO{constructor(){this.index={}}add(e){const r=e.lastSegment(),n=e.popLast(),i=this.index[r]||new Pr(tr.comparator),o=!i.has(n);return this.index[r]=i.add(n),o}has(e){const r=e.lastSegment(),n=e.popLast(),i=this.index[r];return i&&i.has(n)}getEntries(e){return(this.index[e]||new Pr(tr.comparator)).toArray()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jE={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},dw=41943040;class Nn{static withCacheSize(e){return new Nn(e,Nn.DEFAULT_COLLECTION_PERCENTILE,Nn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,r,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=r,this.maximumSequenceNumbersToCollect=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Nn.DEFAULT_COLLECTION_PERCENTILE=10,Nn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Nn.DEFAULT=new Nn(dw,Nn.DEFAULT_COLLECTION_PERCENTILE,Nn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Nn.DISABLED=new Nn(-1,0,0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lc{constructor(e){this._r=e}next(){return this._r+=2,this._r}static ar(){return new lc(0)}static ur(){return new lc(-1)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zE="LruGarbageCollector",DO=1048576;function HE([t,e],[r,n]){const i=mt(t,r);return i===0?mt(e,n):i}class OO{constructor(e){this.Tr=e,this.buffer=new Pr(HE),this.Ir=0}dr(){return++this.Ir}Er(e){const r=[e,this.dr()];if(this.buffer.size<this.Tr)this.buffer=this.buffer.add(r);else{const n=this.buffer.last();HE(r,n)<0&&(this.buffer=this.buffer.delete(n).add(r))}}get maxValue(){return this.buffer.last()[0]}}class NO{constructor(e,r,n){this.garbageCollector=e,this.asyncQueue=r,this.localStore=n,this.Ar=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Rr(6e4)}stop(){this.Ar&&(this.Ar.cancel(),this.Ar=null)}get started(){return this.Ar!==null}Rr(e){He(zE,`Garbage collection scheduled in ${e}ms`),this.Ar=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Ar=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(r){vc(r)?He(zE,"Ignoring IndexedDB error during garbage collection: ",r):await gc(r)}await this.Rr(3e5)})}}class FO{constructor(e,r){this.Vr=e,this.params=r}calculateTargetCount(e,r){return this.Vr.mr(e).next(n=>Math.floor(r/100*n))}nthSequenceNumber(e,r){if(r===0)return ke.resolve(ld.ue);const n=new OO(r);return this.Vr.forEachTarget(e,i=>n.Er(i.sequenceNumber)).next(()=>this.Vr.gr(e,i=>n.Er(i))).next(()=>n.maxValue)}removeTargets(e,r,n){return this.Vr.removeTargets(e,r,n)}removeOrphanedDocuments(e,r){return this.Vr.removeOrphanedDocuments(e,r)}collect(e,r){return this.params.cacheSizeCollectionThreshold===-1?(He("LruGarbageCollector","Garbage collection skipped; disabled"),ke.resolve(jE)):this.getCacheSize(e).next(n=>n<this.params.cacheSizeCollectionThreshold?(He("LruGarbageCollector",`Garbage collection skipped; Cache size ${n} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),jE):this.pr(e,r))}getCacheSize(e){return this.Vr.getCacheSize(e)}pr(e,r){let n,i,o,c,u,h,p;const g=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(_=>(_>this.params.maximumSequenceNumbersToCollect?(He("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${_}`),i=this.params.maximumSequenceNumbersToCollect):i=_,c=Date.now(),this.nthSequenceNumber(e,i))).next(_=>(n=_,u=Date.now(),this.removeTargets(e,n,r))).next(_=>(o=_,h=Date.now(),this.removeOrphanedDocuments(e,n))).next(_=>(p=Date.now(),Hl()<=Tt.DEBUG&&He("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${c-g}ms
	Determined least recently used ${i} in `+(u-c)+`ms
	Removed ${o} targets in `+(h-u)+`ms
	Removed ${_} documents in `+(p-h)+`ms
Total Duration: ${p-g}ms`),ke.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:o,documentsRemoved:_})))}}function PO(t,e){return new FO(t,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MO{constructor(){this.changes=new Ko(e=>e.toString(),(e,r)=>e.isEqual(r)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,r){this.assertNotApplied(),this.changes.set(e,un.newInvalidDocument(e).setReadTime(r))}getEntry(e,r){this.assertNotApplied();const n=this.changes.get(r);return n!==void 0?ke.resolve(n):this.getFromCache(e,r)}getEntries(e,r){return this.getAllFromCache(e,r)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LO{constructor(e,r){this.overlayedDocument=e,this.mutatedFields=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VO{constructor(e,r,n,i){this.remoteDocumentCache=e,this.mutationQueue=r,this.documentOverlayCache=n,this.indexManager=i}getDocument(e,r){let n=null;return this.documentOverlayCache.getOverlay(e,r).next(i=>(n=i,this.remoteDocumentCache.getEntry(e,r))).next(i=>(n!==null&&Mu(n.mutation,i,Wn.empty(),Gt.now()),i))}getDocuments(e,r){return this.remoteDocumentCache.getEntries(e,r).next(n=>this.getLocalViewOfDocuments(e,n,At()).next(()=>n))}getLocalViewOfDocuments(e,r,n=At()){const i=ko();return this.populateOverlays(e,i,r).next(()=>this.computeViews(e,r,i,n).next(o=>{let c=wu();return o.forEach((u,h)=>{c=c.insert(u,h.overlayedDocument)}),c}))}getOverlayedDocuments(e,r){const n=ko();return this.populateOverlays(e,n,r).next(()=>this.computeViews(e,r,n,At()))}populateOverlays(e,r,n){const i=[];return n.forEach(o=>{r.has(o)||i.push(o)}),this.documentOverlayCache.getOverlays(e,i).next(o=>{o.forEach((c,u)=>{r.set(c,u)})})}computeViews(e,r,n,i){let o=ji();const c=Pu(),u=function(){return Pu()}();return r.forEach((h,p)=>{const g=n.get(p.key);i.has(p.key)&&(g===void 0||g.mutation instanceof Xs)?o=o.insert(p.key,p):g!==void 0?(c.set(p.key,g.mutation.getFieldMask()),Mu(g.mutation,p,g.mutation.getFieldMask(),Gt.now())):c.set(p.key,Wn.empty())}),this.recalculateAndSaveOverlays(e,o).next(h=>(h.forEach((p,g)=>c.set(p,g)),r.forEach((p,g)=>{var _;return u.set(p,new LO(g,(_=c.get(p))!==null&&_!==void 0?_:null))}),u))}recalculateAndSaveOverlays(e,r){const n=Pu();let i=new lr((c,u)=>c-u),o=At();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,r).next(c=>{for(const u of c)u.keys().forEach(h=>{const p=r.get(h);if(p===null)return;let g=n.get(h)||Wn.empty();g=u.applyToLocalView(p,g),n.set(h,g);const _=(i.get(u.batchId)||At()).add(h);i=i.insert(u.batchId,_)})}).next(()=>{const c=[],u=i.getReverseIterator();for(;u.hasNext();){const h=u.getNext(),p=h.key,g=h.value,_=YA();g.forEach(x=>{if(!o.has(x)){const T=tw(r.get(x),n.get(x));T!==null&&_.set(x,T),o=o.add(x)}}),c.push(this.documentOverlayCache.saveOverlays(e,p,_))}return ke.waitFor(c)}).next(()=>n)}recalculateAndSaveOverlaysForDocumentKeys(e,r){return this.remoteDocumentCache.getEntries(e,r).next(n=>this.recalculateAndSaveOverlays(e,n))}getDocumentsMatchingQuery(e,r,n,i){return function(c){return $e.isDocumentKey(c.path)&&c.collectionGroup===null&&c.filters.length===0}(r)?this.getDocumentsMatchingDocumentQuery(e,r.path):jD(r)?this.getDocumentsMatchingCollectionGroupQuery(e,r,n,i):this.getDocumentsMatchingCollectionQuery(e,r,n,i)}getNextDocuments(e,r,n,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,r,n,i).next(o=>{const c=i-o.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,r,n.largestBatchId,i-o.size):ke.resolve(ko());let u=Qu,h=o;return c.next(p=>ke.forEach(p,(g,_)=>(u<_.largestBatchId&&(u=_.largestBatchId),o.get(g)?ke.resolve():this.remoteDocumentCache.getEntry(e,g).next(x=>{h=h.insert(g,x)}))).next(()=>this.populateOverlays(e,p,o)).next(()=>this.computeViews(e,h,p,At())).next(g=>({batchId:u,changes:XA(g)})))})}getDocumentsMatchingDocumentQuery(e,r){return this.getDocument(e,new $e(r)).next(n=>{let i=wu();return n.isFoundDocument()&&(i=i.insert(n.key,n)),i})}getDocumentsMatchingCollectionGroupQuery(e,r,n,i){const o=r.collectionGroup;let c=wu();return this.indexManager.getCollectionParents(e,o).next(u=>ke.forEach(u,h=>{const p=function(_,x){return new fd(x,null,_.explicitOrderBy.slice(),_.filters.slice(),_.limit,_.limitType,_.startAt,_.endAt)}(r,h.child(o));return this.getDocumentsMatchingCollectionQuery(e,p,n,i).next(g=>{g.forEach((_,x)=>{c=c.insert(_,x)})})}).next(()=>c))}getDocumentsMatchingCollectionQuery(e,r,n,i){let o;return this.documentOverlayCache.getOverlaysForCollection(e,r.path,n.largestBatchId).next(c=>(o=c,this.remoteDocumentCache.getDocumentsMatchingQuery(e,r,n,o,i))).next(c=>{o.forEach((h,p)=>{const g=p.getKey();c.get(g)===null&&(c=c.insert(g,un.newInvalidDocument(g)))});let u=wu();return c.forEach((h,p)=>{const g=o.get(h);g!==void 0&&Mu(g.mutation,p,Wn.empty(),Gt.now()),dd(r,p)&&(u=u.insert(h,p))}),u})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UO{constructor(e){this.serializer=e,this.Br=new Map,this.Lr=new Map}getBundleMetadata(e,r){return ke.resolve(this.Br.get(r))}saveBundleMetadata(e,r){return this.Br.set(r.id,function(i){return{id:i.id,version:i.version,createTime:ti(i.createTime)}}(r)),ke.resolve()}getNamedQuery(e,r){return ke.resolve(this.Lr.get(r))}saveNamedQuery(e,r){return this.Lr.set(r.name,function(i){return{name:i.name,query:kO(i.bundledQuery),readTime:ti(i.readTime)}}(r)),ke.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BO{constructor(){this.overlays=new lr($e.comparator),this.kr=new Map}getOverlay(e,r){return ke.resolve(this.overlays.get(r))}getOverlays(e,r){const n=ko();return ke.forEach(r,i=>this.getOverlay(e,i).next(o=>{o!==null&&n.set(i,o)})).next(()=>n)}saveOverlays(e,r,n){return n.forEach((i,o)=>{this.wt(e,r,o)}),ke.resolve()}removeOverlaysForBatchId(e,r,n){const i=this.kr.get(n);return i!==void 0&&(i.forEach(o=>this.overlays=this.overlays.remove(o)),this.kr.delete(n)),ke.resolve()}getOverlaysForCollection(e,r,n){const i=ko(),o=r.length+1,c=new $e(r.child("")),u=this.overlays.getIteratorFrom(c);for(;u.hasNext();){const h=u.getNext().value,p=h.getKey();if(!r.isPrefixOf(p.path))break;p.path.length===o&&h.largestBatchId>n&&i.set(h.getKey(),h)}return ke.resolve(i)}getOverlaysForCollectionGroup(e,r,n,i){let o=new lr((p,g)=>p-g);const c=this.overlays.getIterator();for(;c.hasNext();){const p=c.getNext().value;if(p.getKey().getCollectionGroup()===r&&p.largestBatchId>n){let g=o.get(p.largestBatchId);g===null&&(g=ko(),o=o.insert(p.largestBatchId,g)),g.set(p.getKey(),p)}}const u=ko(),h=o.getIterator();for(;h.hasNext()&&(h.getNext().value.forEach((p,g)=>u.set(p,g)),!(u.size()>=i)););return ke.resolve(u)}wt(e,r,n){const i=this.overlays.get(n.key);if(i!==null){const c=this.kr.get(i.largestBatchId).delete(n.key);this.kr.set(i.largestBatchId,c)}this.overlays=this.overlays.insert(n.key,new iO(r,n));let o=this.kr.get(r);o===void 0&&(o=At(),this.kr.set(r,o)),this.kr.set(r,o.add(n.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jO{constructor(){this.sessionToken=rn.EMPTY_BYTE_STRING}getSessionToken(e){return ke.resolve(this.sessionToken)}setSessionToken(e,r){return this.sessionToken=r,ke.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _1{constructor(){this.qr=new Pr(Hr.Qr),this.$r=new Pr(Hr.Ur)}isEmpty(){return this.qr.isEmpty()}addReference(e,r){const n=new Hr(e,r);this.qr=this.qr.add(n),this.$r=this.$r.add(n)}Kr(e,r){e.forEach(n=>this.addReference(n,r))}removeReference(e,r){this.Wr(new Hr(e,r))}Gr(e,r){e.forEach(n=>this.removeReference(n,r))}zr(e){const r=new $e(new tr([])),n=new Hr(r,e),i=new Hr(r,e+1),o=[];return this.$r.forEachInRange([n,i],c=>{this.Wr(c),o.push(c.key)}),o}jr(){this.qr.forEach(e=>this.Wr(e))}Wr(e){this.qr=this.qr.delete(e),this.$r=this.$r.delete(e)}Jr(e){const r=new $e(new tr([])),n=new Hr(r,e),i=new Hr(r,e+1);let o=At();return this.$r.forEachInRange([n,i],c=>{o=o.add(c.key)}),o}containsKey(e){const r=new Hr(e,0),n=this.qr.firstAfterOrEqual(r);return n!==null&&e.isEqual(n.key)}}class Hr{constructor(e,r){this.key=e,this.Hr=r}static Qr(e,r){return $e.comparator(e.key,r.key)||mt(e.Hr,r.Hr)}static Ur(e,r){return mt(e.Hr,r.Hr)||$e.comparator(e.key,r.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zO{constructor(e,r){this.indexManager=e,this.referenceDelegate=r,this.mutationQueue=[],this.er=1,this.Yr=new Pr(Hr.Qr)}checkEmpty(e){return ke.resolve(this.mutationQueue.length===0)}addMutationBatch(e,r,n,i){const o=this.er;this.er++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const c=new aO(o,r,n,i);this.mutationQueue.push(c);for(const u of i)this.Yr=this.Yr.add(new Hr(u.key,o)),this.indexManager.addToCollectionParentIndex(e,u.key.path.popLast());return ke.resolve(c)}lookupMutationBatch(e,r){return ke.resolve(this.Zr(r))}getNextMutationBatchAfterBatchId(e,r){const n=r+1,i=this.Xr(n),o=i<0?0:i;return ke.resolve(this.mutationQueue.length>o?this.mutationQueue[o]:null)}getHighestUnacknowledgedBatchId(){return ke.resolve(this.mutationQueue.length===0?o1:this.er-1)}getAllMutationBatches(e){return ke.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,r){const n=new Hr(r,0),i=new Hr(r,Number.POSITIVE_INFINITY),o=[];return this.Yr.forEachInRange([n,i],c=>{const u=this.Zr(c.Hr);o.push(u)}),ke.resolve(o)}getAllMutationBatchesAffectingDocumentKeys(e,r){let n=new Pr(mt);return r.forEach(i=>{const o=new Hr(i,0),c=new Hr(i,Number.POSITIVE_INFINITY);this.Yr.forEachInRange([o,c],u=>{n=n.add(u.Hr)})}),ke.resolve(this.ei(n))}getAllMutationBatchesAffectingQuery(e,r){const n=r.path,i=n.length+1;let o=n;$e.isDocumentKey(o)||(o=o.child(""));const c=new Hr(new $e(o),0);let u=new Pr(mt);return this.Yr.forEachWhile(h=>{const p=h.key.path;return!!n.isPrefixOf(p)&&(p.length===i&&(u=u.add(h.Hr)),!0)},c),ke.resolve(this.ei(u))}ei(e){const r=[];return e.forEach(n=>{const i=this.Zr(n);i!==null&&r.push(i)}),r}removeMutationBatch(e,r){jt(this.ti(r.batchId,"removed")===0,55003),this.mutationQueue.shift();let n=this.Yr;return ke.forEach(r.mutations,i=>{const o=new Hr(i.key,r.batchId);return n=n.delete(o),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.Yr=n})}rr(e){}containsKey(e,r){const n=new Hr(r,0),i=this.Yr.firstAfterOrEqual(n);return ke.resolve(r.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,ke.resolve()}ti(e,r){return this.Xr(e)}Xr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Zr(e){const r=this.Xr(e);return r<0||r>=this.mutationQueue.length?null:this.mutationQueue[r]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HO{constructor(e){this.ni=e,this.docs=function(){return new lr($e.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,r){const n=r.key,i=this.docs.get(n),o=i?i.size:0,c=this.ni(r);return this.docs=this.docs.insert(n,{document:r.mutableCopy(),size:c}),this.size+=c-o,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const r=this.docs.get(e);r&&(this.docs=this.docs.remove(e),this.size-=r.size)}getEntry(e,r){const n=this.docs.get(r);return ke.resolve(n?n.document.mutableCopy():un.newInvalidDocument(r))}getEntries(e,r){let n=ji();return r.forEach(i=>{const o=this.docs.get(i);n=n.insert(i,o?o.document.mutableCopy():un.newInvalidDocument(i))}),ke.resolve(n)}getDocumentsMatchingQuery(e,r,n,i){let o=ji();const c=r.path,u=new $e(c.child("__id-9223372036854775808__")),h=this.docs.getIteratorFrom(u);for(;h.hasNext();){const{key:p,value:{document:g}}=h.getNext();if(!c.isPrefixOf(p.path))break;p.path.length>c.length+1||_D(vD(g),n)<=0||(i.has(g.key)||dd(r,g))&&(o=o.insert(g.key,g.mutableCopy()))}return ke.resolve(o)}getAllFromCollectionGroup(e,r,n,i){rt(9500)}ri(e,r){return ke.forEach(this.docs,n=>r(n))}newChangeBuffer(e){return new GO(this)}getSize(e){return ke.resolve(this.size)}}class GO extends MO{constructor(e){super(),this.Or=e}applyChanges(e){const r=[];return this.changes.forEach((n,i)=>{i.isValidDocument()?r.push(this.Or.addEntry(e,i)):this.Or.removeEntry(n)}),ke.waitFor(r)}getFromCache(e,r){return this.Or.getEntry(e,r)}getAllFromCache(e,r){return this.Or.getEntries(e,r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qO{constructor(e){this.persistence=e,this.ii=new Ko(r=>u1(r),f1),this.lastRemoteSnapshotVersion=lt.min(),this.highestTargetId=0,this.si=0,this.oi=new _1,this.targetCount=0,this._i=lc.ar()}forEachTarget(e,r){return this.ii.forEach((n,i)=>r(i)),ke.resolve()}getLastRemoteSnapshotVersion(e){return ke.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return ke.resolve(this.si)}allocateTargetId(e){return this.highestTargetId=this._i.next(),ke.resolve(this.highestTargetId)}setTargetsMetadata(e,r,n){return n&&(this.lastRemoteSnapshotVersion=n),r>this.si&&(this.si=r),ke.resolve()}hr(e){this.ii.set(e.target,e);const r=e.targetId;r>this.highestTargetId&&(this._i=new lc(r),this.highestTargetId=r),e.sequenceNumber>this.si&&(this.si=e.sequenceNumber)}addTargetData(e,r){return this.hr(r),this.targetCount+=1,ke.resolve()}updateTargetData(e,r){return this.hr(r),ke.resolve()}removeTargetData(e,r){return this.ii.delete(r.target),this.oi.zr(r.targetId),this.targetCount-=1,ke.resolve()}removeTargets(e,r,n){let i=0;const o=[];return this.ii.forEach((c,u)=>{u.sequenceNumber<=r&&n.get(u.targetId)===null&&(this.ii.delete(c),o.push(this.removeMatchingKeysForTargetId(e,u.targetId)),i++)}),ke.waitFor(o).next(()=>i)}getTargetCount(e){return ke.resolve(this.targetCount)}getTargetData(e,r){const n=this.ii.get(r)||null;return ke.resolve(n)}addMatchingKeys(e,r,n){return this.oi.Kr(r,n),ke.resolve()}removeMatchingKeys(e,r,n){this.oi.Gr(r,n);const i=this.persistence.referenceDelegate,o=[];return i&&r.forEach(c=>{o.push(i.markPotentiallyOrphaned(e,c))}),ke.waitFor(o)}removeMatchingKeysForTargetId(e,r){return this.oi.zr(r),ke.resolve()}getMatchingKeysForTargetId(e,r){const n=this.oi.Jr(r);return ke.resolve(n)}containsKey(e,r){return ke.resolve(this.oi.containsKey(r))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pw{constructor(e,r){this.ai={},this.overlays={},this.ui=new ld(0),this.ci=!1,this.ci=!0,this.li=new jO,this.referenceDelegate=e(this),this.hi=new qO(this),this.indexManager=new bO,this.remoteDocumentCache=function(i){return new HO(i)}(n=>this.referenceDelegate.Pi(n)),this.serializer=new RO(r),this.Ti=new UO(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.ci=!1,Promise.resolve()}get started(){return this.ci}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let r=this.overlays[e.toKey()];return r||(r=new BO,this.overlays[e.toKey()]=r),r}getMutationQueue(e,r){let n=this.ai[e.toKey()];return n||(n=new zO(r,this.referenceDelegate),this.ai[e.toKey()]=n),n}getGlobalsCache(){return this.li}getTargetCache(){return this.hi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ti}runTransaction(e,r,n){He("MemoryPersistence","Starting transaction:",e);const i=new KO(this.ui.next());return this.referenceDelegate.Ii(),n(i).next(o=>this.referenceDelegate.di(i).next(()=>o)).toPromise().then(o=>(i.raiseOnCommittedEvent(),o))}Ei(e,r){return ke.or(Object.values(this.ai).map(n=>()=>n.containsKey(e,r)))}}class KO extends yD{constructor(e){super(),this.currentSequenceNumber=e}}class x1{constructor(e){this.persistence=e,this.Ai=new _1,this.Ri=null}static Vi(e){return new x1(e)}get mi(){if(this.Ri)return this.Ri;throw rt(60996)}addReference(e,r,n){return this.Ai.addReference(n,r),this.mi.delete(n.toString()),ke.resolve()}removeReference(e,r,n){return this.Ai.removeReference(n,r),this.mi.add(n.toString()),ke.resolve()}markPotentiallyOrphaned(e,r){return this.mi.add(r.toString()),ke.resolve()}removeTarget(e,r){this.Ai.zr(r.targetId).forEach(i=>this.mi.add(i.toString()));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,r.targetId).next(i=>{i.forEach(o=>this.mi.add(o.toString()))}).next(()=>n.removeTargetData(e,r))}Ii(){this.Ri=new Set}di(e){const r=this.persistence.getRemoteDocumentCache().newChangeBuffer();return ke.forEach(this.mi,n=>{const i=$e.fromPath(n);return this.fi(e,i).next(o=>{o||r.removeEntry(i,lt.min())})}).next(()=>(this.Ri=null,r.apply(e)))}updateLimboDocument(e,r){return this.fi(e,r).next(n=>{n?this.mi.delete(r.toString()):this.mi.add(r.toString())})}Pi(e){return 0}fi(e,r){return ke.or([()=>ke.resolve(this.Ai.containsKey(r)),()=>this.persistence.getTargetCache().containsKey(e,r),()=>this.persistence.Ei(e,r)])}}class j0{constructor(e,r){this.persistence=e,this.gi=new Ko(n=>AD(n.path),(n,i)=>n.isEqual(i)),this.garbageCollector=PO(this,r)}static Vi(e,r){return new j0(e,r)}Ii(){}di(e){return ke.resolve()}forEachTarget(e,r){return this.persistence.getTargetCache().forEachTarget(e,r)}mr(e){const r=this.yr(e);return this.persistence.getTargetCache().getTargetCount(e).next(n=>r.next(i=>n+i))}yr(e){let r=0;return this.gr(e,n=>{r++}).next(()=>r)}gr(e,r){return ke.forEach(this.gi,(n,i)=>this.Sr(e,n,i).next(o=>o?ke.resolve():r(i)))}removeTargets(e,r,n){return this.persistence.getTargetCache().removeTargets(e,r,n)}removeOrphanedDocuments(e,r){let n=0;const i=this.persistence.getRemoteDocumentCache(),o=i.newChangeBuffer();return i.ri(e,c=>this.Sr(e,c,r).next(u=>{u||(n++,o.removeEntry(c,lt.min()))})).next(()=>o.apply(e)).next(()=>n)}markPotentiallyOrphaned(e,r){return this.gi.set(r,e.currentSequenceNumber),ke.resolve()}removeTarget(e,r){const n=r.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,n)}addReference(e,r,n){return this.gi.set(n,e.currentSequenceNumber),ke.resolve()}removeReference(e,r,n){return this.gi.set(n,e.currentSequenceNumber),ke.resolve()}updateLimboDocument(e,r){return this.gi.set(r,e.currentSequenceNumber),ke.resolve()}Pi(e){let r=e.key.toString().length;return e.isFoundDocument()&&(r+=x0(e.data.value)),r}Sr(e,r,n){return ke.or([()=>this.persistence.Ei(e,r),()=>this.persistence.getTargetCache().containsKey(e,r),()=>{const i=this.gi.get(r);return ke.resolve(i!==void 0&&i>n)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class y1{constructor(e,r,n,i){this.targetId=e,this.fromCache=r,this.Is=n,this.ds=i}static Es(e,r){let n=At(),i=At();for(const o of r.docChanges)switch(o.type){case 0:n=n.add(o.doc.key);break;case 1:i=i.add(o.doc.key)}return new y1(e,r.fromCache,n,i)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WO{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XO{constructor(){this.As=!1,this.Rs=!1,this.Vs=100,this.fs=function(){return Rk()?8:ED(pn())>0?6:4}()}initialize(e,r){this.gs=e,this.indexManager=r,this.As=!0}getDocumentsMatchingQuery(e,r,n,i){const o={result:null};return this.ps(e,r).next(c=>{o.result=c}).next(()=>{if(!o.result)return this.ys(e,r,i,n).next(c=>{o.result=c})}).next(()=>{if(o.result)return;const c=new WO;return this.ws(e,r,c).next(u=>{if(o.result=u,this.Rs)return this.Ss(e,r,c,u.size)})}).next(()=>o.result)}Ss(e,r,n,i){return n.documentReadCount<this.Vs?(Hl()<=Tt.DEBUG&&He("QueryEngine","SDK will not create cache indexes for query:",Gl(r),"since it only creates cache indexes for collection contains","more than or equal to",this.Vs,"documents"),ke.resolve()):(Hl()<=Tt.DEBUG&&He("QueryEngine","Query:",Gl(r),"scans",n.documentReadCount,"local documents and returns",i,"documents as results."),n.documentReadCount>this.fs*i?(Hl()<=Tt.DEBUG&&He("QueryEngine","The SDK decides to create cache indexes for query:",Gl(r),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,ei(r))):ke.resolve())}ps(e,r){if(DE(r))return ke.resolve(null);let n=ei(r);return this.indexManager.getIndexType(e,n).next(i=>i===0?null:(r.limit!==null&&i===1&&(r=_g(r,null,"F"),n=ei(r)),this.indexManager.getDocumentsMatchingTarget(e,n).next(o=>{const c=At(...o);return this.gs.getDocuments(e,c).next(u=>this.indexManager.getMinOffset(e,n).next(h=>{const p=this.bs(r,u);return this.Ds(r,p,c,h.readTime)?this.ps(e,_g(r,null,"F")):this.vs(e,p,r,h)}))})))}ys(e,r,n,i){return DE(r)||i.isEqual(lt.min())?ke.resolve(null):this.gs.getDocuments(e,n).next(o=>{const c=this.bs(r,o);return this.Ds(r,c,n,i)?ke.resolve(null):(Hl()<=Tt.DEBUG&&He("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),Gl(r)),this.vs(e,c,r,gD(i,Qu)).next(u=>u))})}bs(e,r){let n=new Pr(KA(e));return r.forEach((i,o)=>{dd(e,o)&&(n=n.add(o))}),n}Ds(e,r,n,i){if(e.limit===null)return!1;if(n.size!==r.size)return!0;const o=e.limitType==="F"?r.last():r.first();return!!o&&(o.hasPendingWrites||o.version.compareTo(i)>0)}ws(e,r,n){return Hl()<=Tt.DEBUG&&He("QueryEngine","Using full collection scan to execute query:",Gl(r)),this.gs.getDocumentsMatchingQuery(e,r,Ls.min(),n)}vs(e,r,n,i){return this.gs.getDocumentsMatchingQuery(e,n,i).next(o=>(r.forEach(c=>{o=o.insert(c.key,c)}),o))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const E1="LocalStore",YO=3e8;class $O{constructor(e,r,n,i){this.persistence=e,this.Cs=r,this.serializer=i,this.Fs=new lr(mt),this.Ms=new Ko(o=>u1(o),f1),this.xs=new Map,this.Os=e.getRemoteDocumentCache(),this.hi=e.getTargetCache(),this.Ti=e.getBundleCache(),this.Ns(n)}Ns(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new VO(this.Os,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Os.setIndexManager(this.indexManager),this.Cs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",r=>e.collect(r,this.Fs))}}function QO(t,e,r,n){return new $O(t,e,r,n)}async function mw(t,e){const r=ct(t);return await r.persistence.runTransaction("Handle user change","readonly",n=>{let i;return r.mutationQueue.getAllMutationBatches(n).next(o=>(i=o,r.Ns(e),r.mutationQueue.getAllMutationBatches(n))).next(o=>{const c=[],u=[];let h=At();for(const p of i){c.push(p.batchId);for(const g of p.mutations)h=h.add(g.key)}for(const p of o){u.push(p.batchId);for(const g of p.mutations)h=h.add(g.key)}return r.localDocuments.getDocuments(n,h).next(p=>({Bs:p,removedBatchIds:c,addedBatchIds:u}))})})}function ZO(t,e){const r=ct(t);return r.persistence.runTransaction("Acknowledge batch","readwrite-primary",n=>{const i=e.batch.keys(),o=r.Os.newChangeBuffer({trackRemovals:!0});return function(u,h,p,g){const _=p.batch,x=_.keys();let T=ke.resolve();return x.forEach(w=>{T=T.next(()=>g.getEntry(h,w)).next(S=>{const C=p.docVersions.get(w);jt(C!==null,48541),S.version.compareTo(C)<0&&(_.applyToRemoteDocument(S,p),S.isValidDocument()&&(S.setReadTime(p.commitVersion),g.addEntry(S)))})}),T.next(()=>u.mutationQueue.removeMutationBatch(h,_))}(r,n,e,o).next(()=>o.apply(n)).next(()=>r.mutationQueue.performConsistencyCheck(n)).next(()=>r.documentOverlayCache.removeOverlaysForBatchId(n,i,e.batch.batchId)).next(()=>r.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(n,function(u){let h=At();for(let p=0;p<u.mutationResults.length;++p)u.mutationResults[p].transformResults.length>0&&(h=h.add(u.batch.mutations[p].key));return h}(e))).next(()=>r.localDocuments.getDocuments(n,i))})}function gw(t){const e=ct(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",r=>e.hi.getLastRemoteSnapshotVersion(r))}function JO(t,e){const r=ct(t),n=e.snapshotVersion;let i=r.Fs;return r.persistence.runTransaction("Apply remote event","readwrite-primary",o=>{const c=r.Os.newChangeBuffer({trackRemovals:!0});i=r.Fs;const u=[];e.targetChanges.forEach((g,_)=>{const x=i.get(_);if(!x)return;u.push(r.hi.removeMatchingKeys(o,g.removedDocuments,_).next(()=>r.hi.addMatchingKeys(o,g.addedDocuments,_)));let T=x.withSequenceNumber(o.currentSequenceNumber);e.targetMismatches.get(_)!==null?T=T.withResumeToken(rn.EMPTY_BYTE_STRING,lt.min()).withLastLimboFreeSnapshotVersion(lt.min()):g.resumeToken.approximateByteSize()>0&&(T=T.withResumeToken(g.resumeToken,n)),i=i.insert(_,T),function(S,C,z){return S.resumeToken.approximateByteSize()===0||C.snapshotVersion.toMicroseconds()-S.snapshotVersion.toMicroseconds()>=YO?!0:z.addedDocuments.size+z.modifiedDocuments.size+z.removedDocuments.size>0}(x,T,g)&&u.push(r.hi.updateTargetData(o,T))});let h=ji(),p=At();if(e.documentUpdates.forEach(g=>{e.resolvedLimboDocuments.has(g)&&u.push(r.persistence.referenceDelegate.updateLimboDocument(o,g))}),u.push(eN(o,c,e.documentUpdates).next(g=>{h=g.Ls,p=g.ks})),!n.isEqual(lt.min())){const g=r.hi.getLastRemoteSnapshotVersion(o).next(_=>r.hi.setTargetsMetadata(o,o.currentSequenceNumber,n));u.push(g)}return ke.waitFor(u).next(()=>c.apply(o)).next(()=>r.localDocuments.getLocalViewOfDocuments(o,h,p)).next(()=>h)}).then(o=>(r.Fs=i,o))}function eN(t,e,r){let n=At(),i=At();return r.forEach(o=>n=n.add(o)),e.getEntries(t,n).next(o=>{let c=ji();return r.forEach((u,h)=>{const p=o.get(u);h.isFoundDocument()!==p.isFoundDocument()&&(i=i.add(u)),h.isNoDocument()&&h.version.isEqual(lt.min())?(e.removeEntry(u,h.readTime),c=c.insert(u,h)):!p.isValidDocument()||h.version.compareTo(p.version)>0||h.version.compareTo(p.version)===0&&p.hasPendingWrites?(e.addEntry(h),c=c.insert(u,h)):He(E1,"Ignoring outdated watch update for ",u,". Current version:",p.version," Watch version:",h.version)}),{Ls:c,ks:i}})}function tN(t,e){const r=ct(t);return r.persistence.runTransaction("Get next mutation batch","readonly",n=>(e===void 0&&(e=o1),r.mutationQueue.getNextMutationBatchAfterBatchId(n,e)))}function rN(t,e){const r=ct(t);return r.persistence.runTransaction("Allocate target","readwrite",n=>{let i;return r.hi.getTargetData(n,e).next(o=>o?(i=o,ke.resolve(i)):r.hi.allocateTargetId(n).next(c=>(i=new Cs(e,c,"TargetPurposeListen",n.currentSequenceNumber),r.hi.addTargetData(n,i).next(()=>i))))}).then(n=>{const i=r.Fs.get(n.targetId);return(i===null||n.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(r.Fs=r.Fs.insert(n.targetId,n),r.Ms.set(e,n.targetId)),n})}async function Ag(t,e,r){const n=ct(t),i=n.Fs.get(e),o=r?"readwrite":"readwrite-primary";try{r||await n.persistence.runTransaction("Release target",o,c=>n.persistence.referenceDelegate.removeTarget(c,i))}catch(c){if(!vc(c))throw c;He(E1,`Failed to update sequence numbers for target ${e}: ${c}`)}n.Fs=n.Fs.remove(e),n.Ms.delete(i.target)}function GE(t,e,r){const n=ct(t);let i=lt.min(),o=At();return n.persistence.runTransaction("Execute query","readwrite",c=>function(h,p,g){const _=ct(h),x=_.Ms.get(g);return x!==void 0?ke.resolve(_.Fs.get(x)):_.hi.getTargetData(p,g)}(n,c,ei(e)).next(u=>{if(u)return i=u.lastLimboFreeSnapshotVersion,n.hi.getMatchingKeysForTargetId(c,u.targetId).next(h=>{o=h})}).next(()=>n.Cs.getDocumentsMatchingQuery(c,e,r?i:lt.min(),r?o:At())).next(u=>(nN(n,HD(e),u),{documents:u,qs:o})))}function nN(t,e,r){let n=t.xs.get(e)||lt.min();r.forEach((i,o)=>{o.readTime.compareTo(n)>0&&(n=o.readTime)}),t.xs.set(e,n)}class qE{constructor(){this.activeTargetIds=YD()}Gs(e){this.activeTargetIds=this.activeTargetIds.add(e)}zs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Ws(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class aN{constructor(){this.Fo=new qE,this.Mo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,r,n){}addLocalQueryTarget(e,r=!0){return r&&this.Fo.Gs(e),this.Mo[e]||"not-current"}updateQueryState(e,r,n){this.Mo[e]=r}removeLocalQueryTarget(e){this.Fo.zs(e)}isLocalQueryTarget(e){return this.Fo.activeTargetIds.has(e)}clearQueryState(e){delete this.Mo[e]}getAllActiveQueryTargets(){return this.Fo.activeTargetIds}isActiveQueryTarget(e){return this.Fo.activeTargetIds.has(e)}start(){return this.Fo=new qE,Promise.resolve()}handleUserChange(e,r,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iN{xo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const KE="ConnectivityMonitor";class WE{constructor(){this.Oo=()=>this.No(),this.Bo=()=>this.Lo(),this.ko=[],this.qo()}xo(e){this.ko.push(e)}shutdown(){window.removeEventListener("online",this.Oo),window.removeEventListener("offline",this.Bo)}qo(){window.addEventListener("online",this.Oo),window.addEventListener("offline",this.Bo)}No(){He(KE,"Network connectivity changed: AVAILABLE");for(const e of this.ko)e(0)}Lo(){He(KE,"Network connectivity changed: UNAVAILABLE");for(const e of this.ko)e(1)}static C(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let r0=null;function wg(){return r0===null?r0=function(){return 268435456+Math.round(2147483648*Math.random())}():r0++,"0x"+r0.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hm="RestConnection",sN={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class oN{get Qo(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const r=e.ssl?"https":"http",n=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.$o=r+"://"+e.host,this.Uo=`projects/${n}/databases/${i}`,this.Ko=this.databaseId.database===F0?`project_id=${n}`:`project_id=${n}&database_id=${i}`}Wo(e,r,n,i,o){const c=wg(),u=this.Go(e,r.toUriEncodedString());He(Hm,`Sending RPC '${e}' ${c}:`,u,n);const h={"google-cloud-resource-prefix":this.Uo,"x-goog-request-params":this.Ko};this.zo(h,i,o);const{host:p}=new URL(u),g=hc(p);return this.jo(e,u,h,n,g).then(_=>(He(Hm,`Received RPC '${e}' ${c}: `,_),_),_=>{throw Ms(Hm,`RPC '${e}' ${c} failed with error: `,_,"url: ",u,"request:",n),_})}Jo(e,r,n,i,o,c){return this.Wo(e,r,n,i,o)}zo(e,r,n){e["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+mc}(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((i,o)=>e[o]=i),n&&n.headers.forEach((i,o)=>e[o]=i)}Go(e,r){const n=sN[e];return`${this.$o}/v1/${r}:${n}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lN{constructor(e){this.Ho=e.Ho,this.Yo=e.Yo}Zo(e){this.Xo=e}e_(e){this.t_=e}n_(e){this.r_=e}onMessage(e){this.i_=e}close(){this.Yo()}send(e){this.Ho(e)}s_(){this.Xo()}o_(){this.t_()}__(e){this.r_(e)}a_(e){this.i_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sn="WebChannelConnection";class cN extends oN{constructor(e){super(e),this.u_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}jo(e,r,n,i,o){const c=wg();return new Promise((u,h)=>{const p=new xA;p.setWithCredentials(!0),p.listenOnce(yA.COMPLETE,()=>{try{switch(p.getLastErrorCode()){case _0.NO_ERROR:const _=p.getResponseJson();He(sn,`XHR for RPC '${e}' ${c} received:`,JSON.stringify(_)),u(_);break;case _0.TIMEOUT:He(sn,`RPC '${e}' ${c} timed out`),h(new We(De.DEADLINE_EXCEEDED,"Request time out"));break;case _0.HTTP_ERROR:const x=p.getStatus();if(He(sn,`RPC '${e}' ${c} failed with status:`,x,"response text:",p.getResponseText()),x>0){let T=p.getResponseJson();Array.isArray(T)&&(T=T[0]);const w=T?.error;if(w&&w.status&&w.message){const S=function(z){const Y=z.toLowerCase().replace(/_/g,"-");return Object.values(De).indexOf(Y)>=0?Y:De.UNKNOWN}(w.status);h(new We(S,w.message))}else h(new We(De.UNKNOWN,"Server responded with status "+p.getStatus()))}else h(new We(De.UNAVAILABLE,"Connection failed."));break;default:rt(9055,{c_:e,streamId:c,l_:p.getLastErrorCode(),h_:p.getLastError()})}}finally{He(sn,`RPC '${e}' ${c} completed.`)}});const g=JSON.stringify(i);He(sn,`RPC '${e}' ${c} sending request:`,i),p.send(r,"POST",g,n,15)})}P_(e,r,n){const i=wg(),o=[this.$o,"/","google.firestore.v1.Firestore","/",e,"/channel"],c=AA(),u=TA(),h={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},p=this.longPollingOptions.timeoutSeconds;p!==void 0&&(h.longPollingTimeout=Math.round(1e3*p)),this.useFetchStreams&&(h.useFetchStreams=!0),this.zo(h.initMessageHeaders,r,n),h.encodeInitMessageHeaders=!0;const g=o.join("");He(sn,`Creating RPC '${e}' stream ${i}: ${g}`,h);const _=c.createWebChannel(g,h);this.T_(_);let x=!1,T=!1;const w=new lN({Ho:C=>{T?He(sn,`Not sending because RPC '${e}' stream ${i} is closed:`,C):(x||(He(sn,`Opening RPC '${e}' stream ${i} transport.`),_.open(),x=!0),He(sn,`RPC '${e}' stream ${i} sending:`,C),_.send(C))},Yo:()=>_.close()}),S=(C,z,Y)=>{C.listen(z,L=>{try{Y(L)}catch(K){setTimeout(()=>{throw K},0)}})};return S(_,Au.EventType.OPEN,()=>{T||(He(sn,`RPC '${e}' stream ${i} transport opened.`),w.s_())}),S(_,Au.EventType.CLOSE,()=>{T||(T=!0,He(sn,`RPC '${e}' stream ${i} transport closed`),w.__(),this.I_(_))}),S(_,Au.EventType.ERROR,C=>{T||(T=!0,Ms(sn,`RPC '${e}' stream ${i} transport errored. Name:`,C.name,"Message:",C.message),w.__(new We(De.UNAVAILABLE,"The operation could not be completed")))}),S(_,Au.EventType.MESSAGE,C=>{var z;if(!T){const Y=C.data[0];jt(!!Y,16349);const L=Y,K=L?.error||((z=L[0])===null||z===void 0?void 0:z.error);if(K){He(sn,`RPC '${e}' stream ${i} received error:`,K);const Z=K.status;let re=function(E){const I=Ar[E];if(I!==void 0)return nw(I)}(Z),k=K.message;re===void 0&&(re=De.INTERNAL,k="Unknown error status: "+Z+" with message "+K.message),T=!0,w.__(new We(re,k)),_.close()}else He(sn,`RPC '${e}' stream ${i} received:`,Y),w.a_(Y)}}),S(u,EA.STAT_EVENT,C=>{C.stat===hg.PROXY?He(sn,`RPC '${e}' stream ${i} detected buffering proxy`):C.stat===hg.NOPROXY&&He(sn,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{w.o_()},0),w}terminate(){this.u_.forEach(e=>e.close()),this.u_=[]}T_(e){this.u_.push(e)}I_(e){this.u_=this.u_.filter(r=>r===e)}}function Gm(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vd(t){return new dO(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vw{constructor(e,r,n=1e3,i=1.5,o=6e4){this.Fi=e,this.timerId=r,this.d_=n,this.E_=i,this.A_=o,this.R_=0,this.V_=null,this.m_=Date.now(),this.reset()}reset(){this.R_=0}f_(){this.R_=this.A_}g_(e){this.cancel();const r=Math.floor(this.R_+this.p_()),n=Math.max(0,Date.now()-this.m_),i=Math.max(0,r-n);i>0&&He("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.R_} ms, delay with jitter: ${r} ms, last attempt: ${n} ms ago)`),this.V_=this.Fi.enqueueAfterDelay(this.timerId,i,()=>(this.m_=Date.now(),e())),this.R_*=this.E_,this.R_<this.d_&&(this.R_=this.d_),this.R_>this.A_&&(this.R_=this.A_)}y_(){this.V_!==null&&(this.V_.skipDelay(),this.V_=null)}cancel(){this.V_!==null&&(this.V_.cancel(),this.V_=null)}p_(){return(Math.random()-.5)*this.R_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const XE="PersistentStream";class _w{constructor(e,r,n,i,o,c,u,h){this.Fi=e,this.w_=n,this.S_=i,this.connection=o,this.authCredentialsProvider=c,this.appCheckCredentialsProvider=u,this.listener=h,this.state=0,this.b_=0,this.D_=null,this.v_=null,this.stream=null,this.C_=0,this.F_=new vw(e,r)}M_(){return this.state===1||this.state===5||this.x_()}x_(){return this.state===2||this.state===3}start(){this.C_=0,this.state!==4?this.auth():this.O_()}async stop(){this.M_()&&await this.close(0)}N_(){this.state=0,this.F_.reset()}B_(){this.x_()&&this.D_===null&&(this.D_=this.Fi.enqueueAfterDelay(this.w_,6e4,()=>this.L_()))}k_(e){this.q_(),this.stream.send(e)}async L_(){if(this.x_())return this.close(0)}q_(){this.D_&&(this.D_.cancel(),this.D_=null)}Q_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,r){this.q_(),this.Q_(),this.F_.cancel(),this.b_++,e!==4?this.F_.reset():r&&r.code===De.RESOURCE_EXHAUSTED?(Bi(r.toString()),Bi("Using maximum backoff delay to prevent overloading the backend."),this.F_.f_()):r&&r.code===De.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.U_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.n_(r)}U_(){}auth(){this.state=1;const e=this.K_(this.b_),r=this.b_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([n,i])=>{this.b_===r&&this.W_(n,i)},n=>{e(()=>{const i=new We(De.UNKNOWN,"Fetching auth token failed: "+n.message);return this.G_(i)})})}W_(e,r){const n=this.K_(this.b_);this.stream=this.z_(e,r),this.stream.Zo(()=>{n(()=>this.listener.Zo())}),this.stream.e_(()=>{n(()=>(this.state=2,this.v_=this.Fi.enqueueAfterDelay(this.S_,1e4,()=>(this.x_()&&(this.state=3),Promise.resolve())),this.listener.e_()))}),this.stream.n_(i=>{n(()=>this.G_(i))}),this.stream.onMessage(i=>{n(()=>++this.C_==1?this.j_(i):this.onNext(i))})}O_(){this.state=5,this.F_.g_(async()=>{this.state=0,this.start()})}G_(e){return He(XE,`close with error: ${e}`),this.stream=null,this.close(4,e)}K_(e){return r=>{this.Fi.enqueueAndForget(()=>this.b_===e?r():(He(XE,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class uN extends _w{constructor(e,r,n,i,o,c){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",r,n,i,c),this.serializer=o}z_(e,r){return this.connection.P_("Listen",e,r)}j_(e){return this.onNext(e)}onNext(e){this.F_.reset();const r=gO(this.serializer,e),n=function(o){if(!("targetChange"in o))return lt.min();const c=o.targetChange;return c.targetIds&&c.targetIds.length?lt.min():c.readTime?ti(c.readTime):lt.min()}(e);return this.listener.J_(r,n)}H_(e){const r={};r.database=Tg(this.serializer),r.addTarget=function(o,c){let u;const h=c.target;if(u=vg(h)?{documents:xO(o,h)}:{query:yO(o,h).Vt},u.targetId=c.targetId,c.resumeToken.approximateByteSize()>0){u.resumeToken=sw(o,c.resumeToken);const p=xg(o,c.expectedCount);p!==null&&(u.expectedCount=p)}else if(c.snapshotVersion.compareTo(lt.min())>0){u.readTime=B0(o,c.snapshotVersion.toTimestamp());const p=xg(o,c.expectedCount);p!==null&&(u.expectedCount=p)}return u}(this.serializer,e);const n=TO(this.serializer,e);n&&(r.labels=n),this.k_(r)}Y_(e){const r={};r.database=Tg(this.serializer),r.removeTarget=e,this.k_(r)}}class fN extends _w{constructor(e,r,n,i,o,c){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",r,n,i,c),this.serializer=o}get Z_(){return this.C_>0}start(){this.lastStreamToken=void 0,super.start()}U_(){this.Z_&&this.X_([])}z_(e,r){return this.connection.P_("Write",e,r)}j_(e){return jt(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,jt(!e.writeResults||e.writeResults.length===0,55816),this.listener.ea()}onNext(e){jt(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.F_.reset();const r=_O(e.writeResults,e.commitTime),n=ti(e.commitTime);return this.listener.ta(n,r)}na(){const e={};e.database=Tg(this.serializer),this.k_(e)}X_(e){const r={streamToken:this.lastStreamToken,writes:e.map(n=>vO(this.serializer,n))};this.k_(r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hN{}class dN extends hN{constructor(e,r,n,i){super(),this.authCredentials=e,this.appCheckCredentials=r,this.connection=n,this.serializer=i,this.ra=!1}ia(){if(this.ra)throw new We(De.FAILED_PRECONDITION,"The client has already been terminated.")}Wo(e,r,n,i){return this.ia(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,c])=>this.connection.Wo(e,yg(r,n),i,o,c)).catch(o=>{throw o.name==="FirebaseError"?(o.code===De.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new We(De.UNKNOWN,o.toString())})}Jo(e,r,n,i,o){return this.ia(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([c,u])=>this.connection.Jo(e,yg(r,n),i,c,u,o)).catch(c=>{throw c.name==="FirebaseError"?(c.code===De.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),c):new We(De.UNKNOWN,c.toString())})}terminate(){this.ra=!0,this.connection.terminate()}}class pN{constructor(e,r){this.asyncQueue=e,this.onlineStateHandler=r,this.state="Unknown",this.sa=0,this.oa=null,this._a=!0}aa(){this.sa===0&&(this.ua("Unknown"),this.oa=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.oa=null,this.ca("Backend didn't respond within 10 seconds."),this.ua("Offline"),Promise.resolve())))}la(e){this.state==="Online"?this.ua("Unknown"):(this.sa++,this.sa>=1&&(this.ha(),this.ca(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ua("Offline")))}set(e){this.ha(),this.sa=0,e==="Online"&&(this._a=!1),this.ua(e)}ua(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}ca(e){const r=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this._a?(Bi(r),this._a=!1):He("OnlineStateTracker",r)}ha(){this.oa!==null&&(this.oa.cancel(),this.oa=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vo="RemoteStore";class mN{constructor(e,r,n,i,o){this.localStore=e,this.datastore=r,this.asyncQueue=n,this.remoteSyncer={},this.Pa=[],this.Ta=new Map,this.Ia=new Set,this.da=[],this.Ea=o,this.Ea.xo(c=>{n.enqueueAndForget(async()=>{Wo(this)&&(He(Vo,"Restarting streams for network reachability change."),await async function(h){const p=ct(h);p.Ia.add(4),await Af(p),p.Aa.set("Unknown"),p.Ia.delete(4),await _d(p)}(this))})}),this.Aa=new pN(n,i)}}async function _d(t){if(Wo(t))for(const e of t.da)await e(!0)}async function Af(t){for(const e of t.da)await e(!1)}function xw(t,e){const r=ct(t);r.Ta.has(e.targetId)||(r.Ta.set(e.targetId,e),S1(r)?w1(r):_c(r).x_()&&A1(r,e))}function T1(t,e){const r=ct(t),n=_c(r);r.Ta.delete(e),n.x_()&&yw(r,e),r.Ta.size===0&&(n.x_()?n.B_():Wo(r)&&r.Aa.set("Unknown"))}function A1(t,e){if(t.Ra.$e(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(lt.min())>0){const r=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(r)}_c(t).H_(e)}function yw(t,e){t.Ra.$e(e),_c(t).Y_(e)}function w1(t){t.Ra=new cO({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),Et:e=>t.Ta.get(e)||null,lt:()=>t.datastore.serializer.databaseId}),_c(t).start(),t.Aa.aa()}function S1(t){return Wo(t)&&!_c(t).M_()&&t.Ta.size>0}function Wo(t){return ct(t).Ia.size===0}function Ew(t){t.Ra=void 0}async function gN(t){t.Aa.set("Online")}async function vN(t){t.Ta.forEach((e,r)=>{A1(t,e)})}async function _N(t,e){Ew(t),S1(t)?(t.Aa.la(e),w1(t)):t.Aa.set("Unknown")}async function xN(t,e,r){if(t.Aa.set("Online"),e instanceof iw&&e.state===2&&e.cause)try{await async function(i,o){const c=o.cause;for(const u of o.targetIds)i.Ta.has(u)&&(await i.remoteSyncer.rejectListen(u,c),i.Ta.delete(u),i.Ra.removeTarget(u))}(t,e)}catch(n){He(Vo,"Failed to remove targets %s: %s ",e.targetIds.join(","),n),await z0(t,n)}else if(e instanceof T0?t.Ra.Ye(e):e instanceof aw?t.Ra.it(e):t.Ra.et(e),!r.isEqual(lt.min()))try{const n=await gw(t.localStore);r.compareTo(n)>=0&&await function(o,c){const u=o.Ra.Pt(c);return u.targetChanges.forEach((h,p)=>{if(h.resumeToken.approximateByteSize()>0){const g=o.Ta.get(p);g&&o.Ta.set(p,g.withResumeToken(h.resumeToken,c))}}),u.targetMismatches.forEach((h,p)=>{const g=o.Ta.get(h);if(!g)return;o.Ta.set(h,g.withResumeToken(rn.EMPTY_BYTE_STRING,g.snapshotVersion)),yw(o,h);const _=new Cs(g.target,h,p,g.sequenceNumber);A1(o,_)}),o.remoteSyncer.applyRemoteEvent(u)}(t,r)}catch(n){He(Vo,"Failed to raise snapshot:",n),await z0(t,n)}}async function z0(t,e,r){if(!vc(e))throw e;t.Ia.add(1),await Af(t),t.Aa.set("Offline"),r||(r=()=>gw(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{He(Vo,"Retrying IndexedDB access"),await r(),t.Ia.delete(1),await _d(t)})}function Tw(t,e){return e().catch(r=>z0(t,r,e))}async function xd(t){const e=ct(t),r=js(e);let n=e.Pa.length>0?e.Pa[e.Pa.length-1].batchId:o1;for(;yN(e);)try{const i=await tN(e.localStore,n);if(i===null){e.Pa.length===0&&r.B_();break}n=i.batchId,EN(e,i)}catch(i){await z0(e,i)}Aw(e)&&ww(e)}function yN(t){return Wo(t)&&t.Pa.length<10}function EN(t,e){t.Pa.push(e);const r=js(t);r.x_()&&r.Z_&&r.X_(e.mutations)}function Aw(t){return Wo(t)&&!js(t).M_()&&t.Pa.length>0}function ww(t){js(t).start()}async function TN(t){js(t).na()}async function AN(t){const e=js(t);for(const r of t.Pa)e.X_(r.mutations)}async function wN(t,e,r){const n=t.Pa.shift(),i=m1.from(n,e,r);await Tw(t,()=>t.remoteSyncer.applySuccessfulWrite(i)),await xd(t)}async function SN(t,e){e&&js(t).Z_&&await async function(n,i){if(function(c){return oO(c)&&c!==De.ABORTED}(i.code)){const o=n.Pa.shift();js(n).N_(),await Tw(n,()=>n.remoteSyncer.rejectFailedWrite(o.batchId,i)),await xd(n)}}(t,e),Aw(t)&&ww(t)}async function YE(t,e){const r=ct(t);r.asyncQueue.verifyOperationInProgress(),He(Vo,"RemoteStore received new credentials");const n=Wo(r);r.Ia.add(3),await Af(r),n&&r.Aa.set("Unknown"),await r.remoteSyncer.handleCredentialChange(e),r.Ia.delete(3),await _d(r)}async function CN(t,e){const r=ct(t);e?(r.Ia.delete(2),await _d(r)):e||(r.Ia.add(2),await Af(r),r.Aa.set("Unknown"))}function _c(t){return t.Va||(t.Va=function(r,n,i){const o=ct(r);return o.ia(),new uN(n,o.connection,o.authCredentials,o.appCheckCredentials,o.serializer,i)}(t.datastore,t.asyncQueue,{Zo:gN.bind(null,t),e_:vN.bind(null,t),n_:_N.bind(null,t),J_:xN.bind(null,t)}),t.da.push(async e=>{e?(t.Va.N_(),S1(t)?w1(t):t.Aa.set("Unknown")):(await t.Va.stop(),Ew(t))})),t.Va}function js(t){return t.ma||(t.ma=function(r,n,i){const o=ct(r);return o.ia(),new fN(n,o.connection,o.authCredentials,o.appCheckCredentials,o.serializer,i)}(t.datastore,t.asyncQueue,{Zo:()=>Promise.resolve(),e_:TN.bind(null,t),n_:SN.bind(null,t),ea:AN.bind(null,t),ta:wN.bind(null,t)}),t.da.push(async e=>{e?(t.ma.N_(),await xd(t)):(await t.ma.stop(),t.Pa.length>0&&(He(Vo,`Stopping write stream with ${t.Pa.length} pending writes`),t.Pa=[]))})),t.ma}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class C1{constructor(e,r,n,i,o){this.asyncQueue=e,this.timerId=r,this.targetTimeMs=n,this.op=i,this.removalCallback=o,this.deferred=new Fi,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(c=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,r,n,i,o){const c=Date.now()+n,u=new C1(e,r,c,i,o);return u.start(n),u}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new We(De.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function R1(t,e){if(Bi("AsyncQueue",`${e}: ${t}`),vc(t))return new We(De.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zl{static emptySet(e){return new Zl(e.comparator)}constructor(e){this.comparator=e?(r,n)=>e(r,n)||$e.comparator(r.key,n.key):(r,n)=>$e.comparator(r.key,n.key),this.keyedMap=wu(),this.sortedSet=new lr(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const r=this.keyedMap.get(e);return r?this.sortedSet.indexOf(r):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((r,n)=>(e(r),!1))}add(e){const r=this.delete(e.key);return r.copy(r.keyedMap.insert(e.key,e),r.sortedSet.insert(e,null))}delete(e){const r=this.get(e);return r?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(r)):this}isEqual(e){if(!(e instanceof Zl)||this.size!==e.size)return!1;const r=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;r.hasNext();){const i=r.getNext().key,o=n.getNext().key;if(!i.isEqual(o))return!1}return!0}toString(){const e=[];return this.forEach(r=>{e.push(r.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,r){const n=new Zl;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=r,n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $E{constructor(){this.fa=new lr($e.comparator)}track(e){const r=e.doc.key,n=this.fa.get(r);n?e.type!==0&&n.type===3?this.fa=this.fa.insert(r,e):e.type===3&&n.type!==1?this.fa=this.fa.insert(r,{type:n.type,doc:e.doc}):e.type===2&&n.type===2?this.fa=this.fa.insert(r,{type:2,doc:e.doc}):e.type===2&&n.type===0?this.fa=this.fa.insert(r,{type:0,doc:e.doc}):e.type===1&&n.type===0?this.fa=this.fa.remove(r):e.type===1&&n.type===2?this.fa=this.fa.insert(r,{type:1,doc:n.doc}):e.type===0&&n.type===1?this.fa=this.fa.insert(r,{type:2,doc:e.doc}):rt(63341,{At:e,ga:n}):this.fa=this.fa.insert(r,e)}pa(){const e=[];return this.fa.inorderTraversal((r,n)=>{e.push(n)}),e}}class cc{constructor(e,r,n,i,o,c,u,h,p){this.query=e,this.docs=r,this.oldDocs=n,this.docChanges=i,this.mutatedKeys=o,this.fromCache=c,this.syncStateChanged=u,this.excludesMetadataChanges=h,this.hasCachedResults=p}static fromInitialDocuments(e,r,n,i,o){const c=[];return r.forEach(u=>{c.push({type:0,doc:u})}),new cc(e,r,Zl.emptySet(r),c,n,i,!0,!1,o)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&hd(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const r=this.docChanges,n=e.docChanges;if(r.length!==n.length)return!1;for(let i=0;i<r.length;i++)if(r[i].type!==n[i].type||!r[i].doc.isEqual(n[i].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RN{constructor(){this.ya=void 0,this.wa=[]}Sa(){return this.wa.some(e=>e.ba())}}class kN{constructor(){this.queries=QE(),this.onlineState="Unknown",this.Da=new Set}terminate(){(function(r,n){const i=ct(r),o=i.queries;i.queries=QE(),o.forEach((c,u)=>{for(const h of u.wa)h.onError(n)})})(this,new We(De.ABORTED,"Firestore shutting down"))}}function QE(){return new Ko(t=>qA(t),hd)}async function Sw(t,e){const r=ct(t);let n=3;const i=e.query;let o=r.queries.get(i);o?!o.Sa()&&e.ba()&&(n=2):(o=new RN,n=e.ba()?0:1);try{switch(n){case 0:o.ya=await r.onListen(i,!0);break;case 1:o.ya=await r.onListen(i,!1);break;case 2:await r.onFirstRemoteStoreListen(i)}}catch(c){const u=R1(c,`Initialization of query '${Gl(e.query)}' failed`);return void e.onError(u)}r.queries.set(i,o),o.wa.push(e),e.va(r.onlineState),o.ya&&e.Ca(o.ya)&&k1(r)}async function Cw(t,e){const r=ct(t),n=e.query;let i=3;const o=r.queries.get(n);if(o){const c=o.wa.indexOf(e);c>=0&&(o.wa.splice(c,1),o.wa.length===0?i=e.ba()?0:1:!o.Sa()&&e.ba()&&(i=2))}switch(i){case 0:return r.queries.delete(n),r.onUnlisten(n,!0);case 1:return r.queries.delete(n),r.onUnlisten(n,!1);case 2:return r.onLastRemoteStoreUnlisten(n);default:return}}function bN(t,e){const r=ct(t);let n=!1;for(const i of e){const o=i.query,c=r.queries.get(o);if(c){for(const u of c.wa)u.Ca(i)&&(n=!0);c.ya=i}}n&&k1(r)}function IN(t,e,r){const n=ct(t),i=n.queries.get(e);if(i)for(const o of i.wa)o.onError(r);n.queries.delete(e)}function k1(t){t.Da.forEach(e=>{e.next()})}var Sg,ZE;(ZE=Sg||(Sg={})).Fa="default",ZE.Cache="cache";class Rw{constructor(e,r,n){this.query=e,this.Ma=r,this.xa=!1,this.Oa=null,this.onlineState="Unknown",this.options=n||{}}Ca(e){if(!this.options.includeMetadataChanges){const n=[];for(const i of e.docChanges)i.type!==3&&n.push(i);e=new cc(e.query,e.docs,e.oldDocs,n,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let r=!1;return this.xa?this.Na(e)&&(this.Ma.next(e),r=!0):this.Ba(e,this.onlineState)&&(this.La(e),r=!0),this.Oa=e,r}onError(e){this.Ma.error(e)}va(e){this.onlineState=e;let r=!1;return this.Oa&&!this.xa&&this.Ba(this.Oa,e)&&(this.La(this.Oa),r=!0),r}Ba(e,r){if(!e.fromCache||!this.ba())return!0;const n=r!=="Offline";return(!this.options.ka||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||r==="Offline")}Na(e){if(e.docChanges.length>0)return!0;const r=this.Oa&&this.Oa.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!r)&&this.options.includeMetadataChanges===!0}La(e){e=cc.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.xa=!0,this.Ma.next(e)}ba(){return this.options.source!==Sg.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kw{constructor(e){this.key=e}}class bw{constructor(e){this.key=e}}class DN{constructor(e,r){this.query=e,this.Ha=r,this.Ya=null,this.hasCachedResults=!1,this.current=!1,this.Za=At(),this.mutatedKeys=At(),this.Xa=KA(e),this.eu=new Zl(this.Xa)}get tu(){return this.Ha}nu(e,r){const n=r?r.ru:new $E,i=r?r.eu:this.eu;let o=r?r.mutatedKeys:this.mutatedKeys,c=i,u=!1;const h=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,p=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((g,_)=>{const x=i.get(g),T=dd(this.query,_)?_:null,w=!!x&&this.mutatedKeys.has(x.key),S=!!T&&(T.hasLocalMutations||this.mutatedKeys.has(T.key)&&T.hasCommittedMutations);let C=!1;x&&T?x.data.isEqual(T.data)?w!==S&&(n.track({type:3,doc:T}),C=!0):this.iu(x,T)||(n.track({type:2,doc:T}),C=!0,(h&&this.Xa(T,h)>0||p&&this.Xa(T,p)<0)&&(u=!0)):!x&&T?(n.track({type:0,doc:T}),C=!0):x&&!T&&(n.track({type:1,doc:x}),C=!0,(h||p)&&(u=!0)),C&&(T?(c=c.add(T),o=S?o.add(g):o.delete(g)):(c=c.delete(g),o=o.delete(g)))}),this.query.limit!==null)for(;c.size>this.query.limit;){const g=this.query.limitType==="F"?c.last():c.first();c=c.delete(g.key),o=o.delete(g.key),n.track({type:1,doc:g})}return{eu:c,ru:n,Ds:u,mutatedKeys:o}}iu(e,r){return e.hasLocalMutations&&r.hasCommittedMutations&&!r.hasLocalMutations}applyChanges(e,r,n,i){const o=this.eu;this.eu=e.eu,this.mutatedKeys=e.mutatedKeys;const c=e.ru.pa();c.sort((g,_)=>function(T,w){const S=C=>{switch(C){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return rt(20277,{At:C})}};return S(T)-S(w)}(g.type,_.type)||this.Xa(g.doc,_.doc)),this.su(n),i=i!=null&&i;const u=r&&!i?this.ou():[],h=this.Za.size===0&&this.current&&!i?1:0,p=h!==this.Ya;return this.Ya=h,c.length!==0||p?{snapshot:new cc(this.query,e.eu,o,c,e.mutatedKeys,h===0,p,!1,!!n&&n.resumeToken.approximateByteSize()>0),_u:u}:{_u:u}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({eu:this.eu,ru:new $E,mutatedKeys:this.mutatedKeys,Ds:!1},!1)):{_u:[]}}au(e){return!this.Ha.has(e)&&!!this.eu.has(e)&&!this.eu.get(e).hasLocalMutations}su(e){e&&(e.addedDocuments.forEach(r=>this.Ha=this.Ha.add(r)),e.modifiedDocuments.forEach(r=>{}),e.removedDocuments.forEach(r=>this.Ha=this.Ha.delete(r)),this.current=e.current)}ou(){if(!this.current)return[];const e=this.Za;this.Za=At(),this.eu.forEach(n=>{this.au(n.key)&&(this.Za=this.Za.add(n.key))});const r=[];return e.forEach(n=>{this.Za.has(n)||r.push(new bw(n))}),this.Za.forEach(n=>{e.has(n)||r.push(new kw(n))}),r}uu(e){this.Ha=e.qs,this.Za=At();const r=this.nu(e.documents);return this.applyChanges(r,!0)}cu(){return cc.fromInitialDocuments(this.query,this.eu,this.mutatedKeys,this.Ya===0,this.hasCachedResults)}}const b1="SyncEngine";class ON{constructor(e,r,n){this.query=e,this.targetId=r,this.view=n}}class NN{constructor(e){this.key=e,this.lu=!1}}class FN{constructor(e,r,n,i,o,c){this.localStore=e,this.remoteStore=r,this.eventManager=n,this.sharedClientState=i,this.currentUser=o,this.maxConcurrentLimboResolutions=c,this.hu={},this.Pu=new Ko(u=>qA(u),hd),this.Tu=new Map,this.Iu=new Set,this.du=new lr($e.comparator),this.Eu=new Map,this.Au=new _1,this.Ru={},this.Vu=new Map,this.mu=lc.ur(),this.onlineState="Unknown",this.fu=void 0}get isPrimaryClient(){return this.fu===!0}}async function PN(t,e,r=!0){const n=Pw(t);let i;const o=n.Pu.get(e);return o?(n.sharedClientState.addLocalQueryTarget(o.targetId),i=o.view.cu()):i=await Iw(n,e,r,!0),i}async function MN(t,e){const r=Pw(t);await Iw(r,e,!0,!1)}async function Iw(t,e,r,n){const i=await rN(t.localStore,ei(e)),o=i.targetId,c=t.sharedClientState.addLocalQueryTarget(o,r);let u;return n&&(u=await LN(t,e,o,c==="current",i.resumeToken)),t.isPrimaryClient&&r&&xw(t.remoteStore,i),u}async function LN(t,e,r,n,i){t.gu=(_,x,T)=>async function(S,C,z,Y){let L=C.view.nu(z);L.Ds&&(L=await GE(S.localStore,C.query,!1).then(({documents:k})=>C.view.nu(k,L)));const K=Y&&Y.targetChanges.get(C.targetId),Z=Y&&Y.targetMismatches.get(C.targetId)!=null,re=C.view.applyChanges(L,S.isPrimaryClient,K,Z);return eT(S,C.targetId,re._u),re.snapshot}(t,_,x,T);const o=await GE(t.localStore,e,!0),c=new DN(e,o.qs),u=c.nu(o.documents),h=Tf.createSynthesizedTargetChangeForCurrentChange(r,n&&t.onlineState!=="Offline",i),p=c.applyChanges(u,t.isPrimaryClient,h);eT(t,r,p._u);const g=new ON(e,r,c);return t.Pu.set(e,g),t.Tu.has(r)?t.Tu.get(r).push(e):t.Tu.set(r,[e]),p.snapshot}async function VN(t,e,r){const n=ct(t),i=n.Pu.get(e),o=n.Tu.get(i.targetId);if(o.length>1)return n.Tu.set(i.targetId,o.filter(c=>!hd(c,e))),void n.Pu.delete(e);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(i.targetId),n.sharedClientState.isActiveQueryTarget(i.targetId)||await Ag(n.localStore,i.targetId,!1).then(()=>{n.sharedClientState.clearQueryState(i.targetId),r&&T1(n.remoteStore,i.targetId),Cg(n,i.targetId)}).catch(gc)):(Cg(n,i.targetId),await Ag(n.localStore,i.targetId,!0))}async function UN(t,e){const r=ct(t),n=r.Pu.get(e),i=r.Tu.get(n.targetId);r.isPrimaryClient&&i.length===1&&(r.sharedClientState.removeLocalQueryTarget(n.targetId),T1(r.remoteStore,n.targetId))}async function BN(t,e,r){const n=WN(t);try{const i=await function(c,u){const h=ct(c),p=Gt.now(),g=u.reduce((T,w)=>T.add(w.key),At());let _,x;return h.persistence.runTransaction("Locally write mutations","readwrite",T=>{let w=ji(),S=At();return h.Os.getEntries(T,g).next(C=>{w=C,w.forEach((z,Y)=>{Y.isValidDocument()||(S=S.add(z))})}).next(()=>h.localDocuments.getOverlayedDocuments(T,w)).next(C=>{_=C;const z=[];for(const Y of u){const L=rO(Y,_.get(Y.key).overlayedDocument);L!=null&&z.push(new Xs(Y.key,L,VA(L.value.mapValue),pa.exists(!0)))}return h.mutationQueue.addMutationBatch(T,p,z,u)}).next(C=>{x=C;const z=C.applyToLocalDocumentSet(_,S);return h.documentOverlayCache.saveOverlays(T,C.batchId,z)})}).then(()=>({batchId:x.batchId,changes:XA(_)}))}(n.localStore,e);n.sharedClientState.addPendingMutation(i.batchId),function(c,u,h){let p=c.Ru[c.currentUser.toKey()];p||(p=new lr(mt)),p=p.insert(u,h),c.Ru[c.currentUser.toKey()]=p}(n,i.batchId,r),await wf(n,i.changes),await xd(n.remoteStore)}catch(i){const o=R1(i,"Failed to persist write");r.reject(o)}}async function Dw(t,e){const r=ct(t);try{const n=await JO(r.localStore,e);e.targetChanges.forEach((i,o)=>{const c=r.Eu.get(o);c&&(jt(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1,22616),i.addedDocuments.size>0?c.lu=!0:i.modifiedDocuments.size>0?jt(c.lu,14607):i.removedDocuments.size>0&&(jt(c.lu,42227),c.lu=!1))}),await wf(r,n,e)}catch(n){await gc(n)}}function JE(t,e,r){const n=ct(t);if(n.isPrimaryClient&&r===0||!n.isPrimaryClient&&r===1){const i=[];n.Pu.forEach((o,c)=>{const u=c.view.va(e);u.snapshot&&i.push(u.snapshot)}),function(c,u){const h=ct(c);h.onlineState=u;let p=!1;h.queries.forEach((g,_)=>{for(const x of _.wa)x.va(u)&&(p=!0)}),p&&k1(h)}(n.eventManager,e),i.length&&n.hu.J_(i),n.onlineState=e,n.isPrimaryClient&&n.sharedClientState.setOnlineState(e)}}async function jN(t,e,r){const n=ct(t);n.sharedClientState.updateQueryState(e,"rejected",r);const i=n.Eu.get(e),o=i&&i.key;if(o){let c=new lr($e.comparator);c=c.insert(o,un.newNoDocument(o,lt.min()));const u=At().add(o),h=new gd(lt.min(),new Map,new lr(mt),c,u);await Dw(n,h),n.du=n.du.remove(o),n.Eu.delete(e),I1(n)}else await Ag(n.localStore,e,!1).then(()=>Cg(n,e,r)).catch(gc)}async function zN(t,e){const r=ct(t),n=e.batch.batchId;try{const i=await ZO(r.localStore,e);Nw(r,n,null),Ow(r,n),r.sharedClientState.updateMutationState(n,"acknowledged"),await wf(r,i)}catch(i){await gc(i)}}async function HN(t,e,r){const n=ct(t);try{const i=await function(c,u){const h=ct(c);return h.persistence.runTransaction("Reject batch","readwrite-primary",p=>{let g;return h.mutationQueue.lookupMutationBatch(p,u).next(_=>(jt(_!==null,37113),g=_.keys(),h.mutationQueue.removeMutationBatch(p,_))).next(()=>h.mutationQueue.performConsistencyCheck(p)).next(()=>h.documentOverlayCache.removeOverlaysForBatchId(p,g,u)).next(()=>h.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(p,g)).next(()=>h.localDocuments.getDocuments(p,g))})}(n.localStore,e);Nw(n,e,r),Ow(n,e),n.sharedClientState.updateMutationState(e,"rejected",r),await wf(n,i)}catch(i){await gc(i)}}function Ow(t,e){(t.Vu.get(e)||[]).forEach(r=>{r.resolve()}),t.Vu.delete(e)}function Nw(t,e,r){const n=ct(t);let i=n.Ru[n.currentUser.toKey()];if(i){const o=i.get(e);o&&(r?o.reject(r):o.resolve(),i=i.remove(e)),n.Ru[n.currentUser.toKey()]=i}}function Cg(t,e,r=null){t.sharedClientState.removeLocalQueryTarget(e);for(const n of t.Tu.get(e))t.Pu.delete(n),r&&t.hu.pu(n,r);t.Tu.delete(e),t.isPrimaryClient&&t.Au.zr(e).forEach(n=>{t.Au.containsKey(n)||Fw(t,n)})}function Fw(t,e){t.Iu.delete(e.path.canonicalString());const r=t.du.get(e);r!==null&&(T1(t.remoteStore,r),t.du=t.du.remove(e),t.Eu.delete(r),I1(t))}function eT(t,e,r){for(const n of r)n instanceof kw?(t.Au.addReference(n.key,e),GN(t,n)):n instanceof bw?(He(b1,"Document no longer in limbo: "+n.key),t.Au.removeReference(n.key,e),t.Au.containsKey(n.key)||Fw(t,n.key)):rt(19791,{yu:n})}function GN(t,e){const r=e.key,n=r.path.canonicalString();t.du.get(r)||t.Iu.has(n)||(He(b1,"New document in limbo: "+r),t.Iu.add(n),I1(t))}function I1(t){for(;t.Iu.size>0&&t.du.size<t.maxConcurrentLimboResolutions;){const e=t.Iu.values().next().value;t.Iu.delete(e);const r=new $e(tr.fromString(e)),n=t.mu.next();t.Eu.set(n,new NN(r)),t.du=t.du.insert(r,n),xw(t.remoteStore,new Cs(ei(h1(r.path)),n,"TargetPurposeLimboResolution",ld.ue))}}async function wf(t,e,r){const n=ct(t),i=[],o=[],c=[];n.Pu.isEmpty()||(n.Pu.forEach((u,h)=>{c.push(n.gu(h,e,r).then(p=>{var g;if((p||r)&&n.isPrimaryClient){const _=p?!p.fromCache:(g=r?.targetChanges.get(h.targetId))===null||g===void 0?void 0:g.current;n.sharedClientState.updateQueryState(h.targetId,_?"current":"not-current")}if(p){i.push(p);const _=y1.Es(h.targetId,p);o.push(_)}}))}),await Promise.all(c),n.hu.J_(i),await async function(h,p){const g=ct(h);try{await g.persistence.runTransaction("notifyLocalViewChanges","readwrite",_=>ke.forEach(p,x=>ke.forEach(x.Is,T=>g.persistence.referenceDelegate.addReference(_,x.targetId,T)).next(()=>ke.forEach(x.ds,T=>g.persistence.referenceDelegate.removeReference(_,x.targetId,T)))))}catch(_){if(!vc(_))throw _;He(E1,"Failed to update sequence numbers: "+_)}for(const _ of p){const x=_.targetId;if(!_.fromCache){const T=g.Fs.get(x),w=T.snapshotVersion,S=T.withLastLimboFreeSnapshotVersion(w);g.Fs=g.Fs.insert(x,S)}}}(n.localStore,o))}async function qN(t,e){const r=ct(t);if(!r.currentUser.isEqual(e)){He(b1,"User change. New user:",e.toKey());const n=await mw(r.localStore,e);r.currentUser=e,function(o,c){o.Vu.forEach(u=>{u.forEach(h=>{h.reject(new We(De.CANCELLED,c))})}),o.Vu.clear()}(r,"'waitForPendingWrites' promise is rejected due to a user change."),r.sharedClientState.handleUserChange(e,n.removedBatchIds,n.addedBatchIds),await wf(r,n.Bs)}}function KN(t,e){const r=ct(t),n=r.Eu.get(e);if(n&&n.lu)return At().add(n.key);{let i=At();const o=r.Tu.get(e);if(!o)return i;for(const c of o){const u=r.Pu.get(c);i=i.unionWith(u.view.tu)}return i}}function Pw(t){const e=ct(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=Dw.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=KN.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=jN.bind(null,e),e.hu.J_=bN.bind(null,e.eventManager),e.hu.pu=IN.bind(null,e.eventManager),e}function WN(t){const e=ct(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=zN.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=HN.bind(null,e),e}class H0{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=vd(e.databaseInfo.databaseId),this.sharedClientState=this.bu(e),this.persistence=this.Du(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Cu(e,this.localStore),this.indexBackfillerScheduler=this.Fu(e,this.localStore)}Cu(e,r){return null}Fu(e,r){return null}vu(e){return QO(this.persistence,new XO,e.initialUser,this.serializer)}Du(e){return new pw(x1.Vi,this.serializer)}bu(e){return new aN}async terminate(){var e,r;(e=this.gcScheduler)===null||e===void 0||e.stop(),(r=this.indexBackfillerScheduler)===null||r===void 0||r.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}H0.provider={build:()=>new H0};class XN extends H0{constructor(e){super(),this.cacheSizeBytes=e}Cu(e,r){jt(this.persistence.referenceDelegate instanceof j0,46915);const n=this.persistence.referenceDelegate.garbageCollector;return new NO(n,e.asyncQueue,r)}Du(e){const r=this.cacheSizeBytes!==void 0?Nn.withCacheSize(this.cacheSizeBytes):Nn.DEFAULT;return new pw(n=>j0.Vi(n,r),this.serializer)}}class Rg{async initialize(e,r){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(r),this.remoteStore=this.createRemoteStore(r),this.eventManager=this.createEventManager(r),this.syncEngine=this.createSyncEngine(r,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=n=>JE(this.syncEngine,n,1),this.remoteStore.remoteSyncer.handleCredentialChange=qN.bind(null,this.syncEngine),await CN(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new kN}()}createDatastore(e){const r=vd(e.databaseInfo.databaseId),n=function(o){return new cN(o)}(e.databaseInfo);return function(o,c,u,h){return new dN(o,c,u,h)}(e.authCredentials,e.appCheckCredentials,n,r)}createRemoteStore(e){return function(n,i,o,c,u){return new mN(n,i,o,c,u)}(this.localStore,this.datastore,e.asyncQueue,r=>JE(this.syncEngine,r,0),function(){return WE.C()?new WE:new iN}())}createSyncEngine(e,r){return function(i,o,c,u,h,p,g){const _=new FN(i,o,c,u,h,p);return g&&(_.fu=!0),_}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,r)}async terminate(){var e,r;await async function(i){const o=ct(i);He(Vo,"RemoteStore shutting down."),o.Ia.add(5),await Af(o),o.Ea.shutdown(),o.Aa.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(r=this.eventManager)===null||r===void 0||r.terminate()}}Rg.provider={build:()=>new Rg};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mw{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.xu(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.xu(this.observer.error,e):Bi("Uncaught Error in snapshot listener:",e.toString()))}Ou(){this.muted=!0}xu(e,r){setTimeout(()=>{this.muted||e(r)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zs="FirestoreClient";class YN{constructor(e,r,n,i,o){this.authCredentials=e,this.appCheckCredentials=r,this.asyncQueue=n,this.databaseInfo=i,this.user=ln.UNAUTHENTICATED,this.clientId=i1.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=o,this.authCredentials.start(n,async c=>{He(zs,"Received user=",c.uid),await this.authCredentialListener(c),this.user=c}),this.appCheckCredentials.start(n,c=>(He(zs,"Received new app check token=",c),this.appCheckCredentialListener(c,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Fi;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(r){const n=R1(r,"Failed to shutdown persistence");e.reject(n)}}),e.promise}}async function qm(t,e){t.asyncQueue.verifyOperationInProgress(),He(zs,"Initializing OfflineComponentProvider");const r=t.configuration;await e.initialize(r);let n=r.initialUser;t.setCredentialChangeListener(async i=>{n.isEqual(i)||(await mw(e.localStore,i),n=i)}),e.persistence.setDatabaseDeletedListener(()=>{Ms("Terminating Firestore due to IndexedDb database deletion"),t.terminate().then(()=>{He("Terminating Firestore due to IndexedDb database deletion completed successfully")}).catch(i=>{Ms("Terminating Firestore due to IndexedDb database deletion failed",i)})}),t._offlineComponents=e}async function tT(t,e){t.asyncQueue.verifyOperationInProgress();const r=await $N(t);He(zs,"Initializing OnlineComponentProvider"),await e.initialize(r,t.configuration),t.setCredentialChangeListener(n=>YE(e.remoteStore,n)),t.setAppCheckTokenChangeListener((n,i)=>YE(e.remoteStore,i)),t._onlineComponents=e}async function $N(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){He(zs,"Using user provided OfflineComponentProvider");try{await qm(t,t._uninitializedComponentsProvider._offline)}catch(e){const r=e;if(!function(i){return i.name==="FirebaseError"?i.code===De.FAILED_PRECONDITION||i.code===De.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11}(r))throw r;Ms("Error using user provided cache. Falling back to memory cache: "+r),await qm(t,new H0)}}else He(zs,"Using default OfflineComponentProvider"),await qm(t,new XN(void 0));return t._offlineComponents}async function Lw(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(He(zs,"Using user provided OnlineComponentProvider"),await tT(t,t._uninitializedComponentsProvider._online)):(He(zs,"Using default OnlineComponentProvider"),await tT(t,new Rg))),t._onlineComponents}function QN(t){return Lw(t).then(e=>e.syncEngine)}async function Vw(t){const e=await Lw(t),r=e.eventManager;return r.onListen=PN.bind(null,e.syncEngine),r.onUnlisten=VN.bind(null,e.syncEngine),r.onFirstRemoteStoreListen=MN.bind(null,e.syncEngine),r.onLastRemoteStoreUnlisten=UN.bind(null,e.syncEngine),r}function ZN(t,e,r={}){const n=new Fi;return t.asyncQueue.enqueueAndForget(async()=>function(o,c,u,h,p){const g=new Mw({next:x=>{g.Ou(),c.enqueueAndForget(()=>Cw(o,_));const T=x.docs.has(u);!T&&x.fromCache?p.reject(new We(De.UNAVAILABLE,"Failed to get document because the client is offline.")):T&&x.fromCache&&h&&h.source==="server"?p.reject(new We(De.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):p.resolve(x)},error:x=>p.reject(x)}),_=new Rw(h1(u.path),g,{includeMetadataChanges:!0,ka:!0});return Sw(o,_)}(await Vw(t),t.asyncQueue,e,r,n)),n.promise}function JN(t,e,r={}){const n=new Fi;return t.asyncQueue.enqueueAndForget(async()=>function(o,c,u,h,p){const g=new Mw({next:x=>{g.Ou(),c.enqueueAndForget(()=>Cw(o,_)),x.fromCache&&h.source==="server"?p.reject(new We(De.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):p.resolve(x)},error:x=>p.reject(x)}),_=new Rw(u,g,{includeMetadataChanges:!0,ka:!0});return Sw(o,_)}(await Vw(t),t.asyncQueue,e,r,n)),n.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Uw(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rT=new Map;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Bw="firestore.googleapis.com",nT=!0;class aT{constructor(e){var r,n;if(e.host===void 0){if(e.ssl!==void 0)throw new We(De.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=Bw,this.ssl=nT}else this.host=e.host,this.ssl=(r=e.ssl)!==null&&r!==void 0?r:nT;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=dw;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<DO)throw new We(De.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}mD("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=Uw((n=e.experimentalLongPollingOptions)!==null&&n!==void 0?n:{}),function(o){if(o.timeoutSeconds!==void 0){if(isNaN(o.timeoutSeconds))throw new We(De.INVALID_ARGUMENT,`invalid long polling timeout: ${o.timeoutSeconds} (must not be NaN)`);if(o.timeoutSeconds<5)throw new We(De.INVALID_ARGUMENT,`invalid long polling timeout: ${o.timeoutSeconds} (minimum allowed value is 5)`);if(o.timeoutSeconds>30)throw new We(De.INVALID_ARGUMENT,`invalid long polling timeout: ${o.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(n,i){return n.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class yd{constructor(e,r,n,i){this._authCredentials=e,this._appCheckCredentials=r,this._databaseId=n,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new aT({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new We(De.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new We(De.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new aT(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=function(n){if(!n)return new sD;switch(n.type){case"firstParty":return new uD(n.sessionIndex||"0",n.iamToken||null,n.authTokenFactory||null);case"provider":return n.client;default:throw new We(De.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(r){const n=rT.get(r);n&&(He("ComponentProvider","Removing Datastore"),rT.delete(r),n.terminate())}(this),Promise.resolve()}}function e6(t,e,r,n={}){var i;t=Oa(t,yd);const o=hc(e),c=t._getSettings(),u=Object.assign(Object.assign({},c),{emulatorOptions:t._getEmulatorOptions()}),h=`${e}:${r}`;o&&(O2(`https://${h}`),N2("Firestore",!0)),c.host!==Bw&&c.host!==h&&Ms("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const p=Object.assign(Object.assign({},c),{host:h,ssl:o,emulatorOptions:n});if(!Fo(p,u)&&(t._setSettings(p),n.mockUserToken)){let g,_;if(typeof n.mockUserToken=="string")g=n.mockUserToken,_=ln.MOCK_USER;else{g=_k(n.mockUserToken,(i=t._app)===null||i===void 0?void 0:i.options.projectId);const x=n.mockUserToken.sub||n.mockUserToken.user_id;if(!x)throw new We(De.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");_=new ln(x)}t._authCredentials=new oD(new SA(g,_))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ed{constructor(e,r,n){this.converter=r,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new Ed(this.firestore,e,this._query)}}class Rr{constructor(e,r,n){this.converter=r,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Fs(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Rr(this.firestore,e,this._key)}toJSON(){return{type:Rr._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,r,n){if(yf(r,Rr._jsonSchema))return new Rr(e,n||null,new $e(tr.fromString(r.referencePath)))}}Rr._jsonSchemaVersion="firestore/documentReference/1.0",Rr._jsonSchema={type:Cr("string",Rr._jsonSchemaVersion),referencePath:Cr("string")};class Fs extends Ed{constructor(e,r,n){super(e,r,h1(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Rr(this.firestore,null,new $e(e))}withConverter(e){return new Fs(this.firestore,e,this._path)}}function si(t,e,...r){if(t=tn(t),RA("collection","path",e),t instanceof yd){const n=tr.fromString(e,...r);return _E(n),new Fs(t,null,n)}{if(!(t instanceof Rr||t instanceof Fs))throw new We(De.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=t._path.child(tr.fromString(e,...r));return _E(n),new Fs(t.firestore,null,n)}}function Pn(t,e,...r){if(t=tn(t),arguments.length===1&&(e=i1.newId()),RA("doc","path",e),t instanceof yd){const n=tr.fromString(e,...r);return vE(n),new Rr(t,null,new $e(n))}{if(!(t instanceof Rr||t instanceof Fs))throw new We(De.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=t._path.child(tr.fromString(e,...r));return vE(n),new Rr(t.firestore,t instanceof Fs?t.converter:null,new $e(n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iT="AsyncQueue";class sT{constructor(e=Promise.resolve()){this.Zu=[],this.Xu=!1,this.ec=[],this.tc=null,this.nc=!1,this.rc=!1,this.sc=[],this.F_=new vw(this,"async_queue_retry"),this.oc=()=>{const n=Gm();n&&He(iT,"Visibility state changed to "+n.visibilityState),this.F_.y_()},this._c=e;const r=Gm();r&&typeof r.addEventListener=="function"&&r.addEventListener("visibilitychange",this.oc)}get isShuttingDown(){return this.Xu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.ac(),this.uc(e)}enterRestrictedMode(e){if(!this.Xu){this.Xu=!0,this.rc=e||!1;const r=Gm();r&&typeof r.removeEventListener=="function"&&r.removeEventListener("visibilitychange",this.oc)}}enqueue(e){if(this.ac(),this.Xu)return new Promise(()=>{});const r=new Fi;return this.uc(()=>this.Xu&&this.rc?Promise.resolve():(e().then(r.resolve,r.reject),r.promise)).then(()=>r.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Zu.push(e),this.cc()))}async cc(){if(this.Zu.length!==0){try{await this.Zu[0](),this.Zu.shift(),this.F_.reset()}catch(e){if(!vc(e))throw e;He(iT,"Operation failed with retryable error: "+e)}this.Zu.length>0&&this.F_.g_(()=>this.cc())}}uc(e){const r=this._c.then(()=>(this.nc=!0,e().catch(n=>{throw this.tc=n,this.nc=!1,Bi("INTERNAL UNHANDLED ERROR: ",oT(n)),n}).then(n=>(this.nc=!1,n))));return this._c=r,r}enqueueAfterDelay(e,r,n){this.ac(),this.sc.indexOf(e)>-1&&(r=0);const i=C1.createAndSchedule(this,e,r,n,o=>this.lc(o));return this.ec.push(i),i}ac(){this.tc&&rt(47125,{hc:oT(this.tc)})}verifyOperationInProgress(){}async Pc(){let e;do e=this._c,await e;while(e!==this._c)}Tc(e){for(const r of this.ec)if(r.timerId===e)return!0;return!1}Ic(e){return this.Pc().then(()=>{this.ec.sort((r,n)=>r.targetTimeMs-n.targetTimeMs);for(const r of this.ec)if(r.skipDelay(),e!=="all"&&r.timerId===e)break;return this.Pc()})}dc(e){this.sc.push(e)}lc(e){const r=this.ec.indexOf(e);this.ec.splice(r,1)}}function oT(t){let e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+`
`+t.stack),e}class Xo extends yd{constructor(e,r,n,i){super(e,r,n,i),this.type="firestore",this._queue=new sT,this._persistenceKey=i?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new sT(e),this._firestoreClient=void 0,await e}}}function t6(t,e){const r=typeof t=="object"?t:L2(),n=typeof t=="string"?t:F0,i=Kg(r,"firestore").getImmediate({identifier:n});if(!i._initialized){const o=gk("firestore");o&&e6(i,...o)}return i}function D1(t){if(t._terminated)throw new We(De.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||r6(t),t._firestoreClient}function r6(t){var e,r,n;const i=t._freezeSettings(),o=function(u,h,p,g){return new CD(u,h,p,g.host,g.ssl,g.experimentalForceLongPolling,g.experimentalAutoDetectLongPolling,Uw(g.experimentalLongPollingOptions),g.useFetchStreams,g.isUsingEmulator)}(t._databaseId,((e=t._app)===null||e===void 0?void 0:e.options.appId)||"",t._persistenceKey,i);t._componentsProvider||!((r=i.localCache)===null||r===void 0)&&r._offlineComponentProvider&&(!((n=i.localCache)===null||n===void 0)&&n._onlineComponentProvider)&&(t._componentsProvider={_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider}),t._firestoreClient=new YN(t._authCredentials,t._appCheckCredentials,t._queue,o,t._componentsProvider&&function(u){const h=u?._online.build();return{_offline:u?._offline.build(h),_online:h}}(t._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class da{constructor(e){this._byteString=e}static fromBase64String(e){try{return new da(rn.fromBase64String(e))}catch(r){throw new We(De.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+r)}}static fromUint8Array(e){return new da(rn.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:da._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(yf(e,da._jsonSchema))return da.fromBase64String(e.bytes)}}da._jsonSchemaVersion="firestore/bytes/1.0",da._jsonSchema={type:Cr("string",da._jsonSchemaVersion),bytes:Cr("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Td{constructor(...e){for(let r=0;r<e.length;++r)if(e[r].length===0)throw new We(De.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Zr(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class O1{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ri{constructor(e,r){if(!isFinite(e)||e<-90||e>90)throw new We(De.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(r)||r<-180||r>180)throw new We(De.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+r);this._lat=e,this._long=r}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return mt(this._lat,e._lat)||mt(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:ri._jsonSchemaVersion}}static fromJSON(e){if(yf(e,ri._jsonSchema))return new ri(e.latitude,e.longitude)}}ri._jsonSchemaVersion="firestore/geoPoint/1.0",ri._jsonSchema={type:Cr("string",ri._jsonSchemaVersion),latitude:Cr("number"),longitude:Cr("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ni{constructor(e){this._values=(e||[]).map(r=>r)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(n,i){if(n.length!==i.length)return!1;for(let o=0;o<n.length;++o)if(n[o]!==i[o])return!1;return!0}(this._values,e._values)}toJSON(){return{type:ni._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(yf(e,ni._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every(r=>typeof r=="number"))return new ni(e.vectorValues);throw new We(De.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}ni._jsonSchemaVersion="firestore/vectorValue/1.0",ni._jsonSchema={type:Cr("string",ni._jsonSchemaVersion),vectorValues:Cr("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const n6=/^__.*__$/;class a6{constructor(e,r,n){this.data=e,this.fieldMask=r,this.fieldTransforms=n}toMutation(e,r){return this.fieldMask!==null?new Xs(e,this.data,this.fieldMask,r,this.fieldTransforms):new Ef(e,this.data,r,this.fieldTransforms)}}class jw{constructor(e,r,n){this.data=e,this.fieldMask=r,this.fieldTransforms=n}toMutation(e,r){return new Xs(e,this.data,this.fieldMask,r,this.fieldTransforms)}}function zw(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw rt(40011,{Ec:t})}}class N1{constructor(e,r,n,i,o,c){this.settings=e,this.databaseId=r,this.serializer=n,this.ignoreUndefinedProperties=i,o===void 0&&this.Ac(),this.fieldTransforms=o||[],this.fieldMask=c||[]}get path(){return this.settings.path}get Ec(){return this.settings.Ec}Rc(e){return new N1(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Vc(e){var r;const n=(r=this.path)===null||r===void 0?void 0:r.child(e),i=this.Rc({path:n,mc:!1});return i.fc(e),i}gc(e){var r;const n=(r=this.path)===null||r===void 0?void 0:r.child(e),i=this.Rc({path:n,mc:!1});return i.Ac(),i}yc(e){return this.Rc({path:void 0,mc:!0})}wc(e){return G0(e,this.settings.methodName,this.settings.Sc||!1,this.path,this.settings.bc)}contains(e){return this.fieldMask.find(r=>e.isPrefixOf(r))!==void 0||this.fieldTransforms.find(r=>e.isPrefixOf(r.field))!==void 0}Ac(){if(this.path)for(let e=0;e<this.path.length;e++)this.fc(this.path.get(e))}fc(e){if(e.length===0)throw this.wc("Document fields must not be empty");if(zw(this.Ec)&&n6.test(e))throw this.wc('Document fields cannot begin and end with "__"')}}class i6{constructor(e,r,n){this.databaseId=e,this.ignoreUndefinedProperties=r,this.serializer=n||vd(e)}Dc(e,r,n,i=!1){return new N1({Ec:e,methodName:r,bc:n,path:Zr.emptyPath(),mc:!1,Sc:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function F1(t){const e=t._freezeSettings(),r=vd(t._databaseId);return new i6(t._databaseId,!!e.ignoreUndefinedProperties,r)}function Hw(t,e,r,n,i,o={}){const c=t.Dc(o.merge||o.mergeFields?2:0,e,r,i);P1("Data must be an object, but it was:",c,n);const u=Gw(n,c);let h,p;if(o.merge)h=new Wn(c.fieldMask),p=c.fieldTransforms;else if(o.mergeFields){const g=[];for(const _ of o.mergeFields){const x=kg(e,_,r);if(!c.contains(x))throw new We(De.INVALID_ARGUMENT,`Field '${x}' is specified in your field mask but missing from your input data.`);Kw(g,x)||g.push(x)}h=new Wn(g),p=c.fieldTransforms.filter(_=>h.covers(_.field))}else h=null,p=c.fieldTransforms;return new a6(new Fn(u),h,p)}class Ad extends O1{_toFieldTransform(e){if(e.Ec!==2)throw e.Ec===1?e.wc(`${this._methodName}() can only appear at the top level of your update data`):e.wc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Ad}}function s6(t,e,r,n){const i=t.Dc(1,e,r);P1("Data must be an object, but it was:",i,n);const o=[],c=Fn.empty();Ws(n,(h,p)=>{const g=M1(e,h,r);p=tn(p);const _=i.gc(g);if(p instanceof Ad)o.push(g);else{const x=wd(p,_);x!=null&&(o.push(g),c.set(g,x))}});const u=new Wn(o);return new jw(c,u,i.fieldTransforms)}function o6(t,e,r,n,i,o){const c=t.Dc(1,e,r),u=[kg(e,n,r)],h=[i];if(o.length%2!=0)throw new We(De.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let x=0;x<o.length;x+=2)u.push(kg(e,o[x])),h.push(o[x+1]);const p=[],g=Fn.empty();for(let x=u.length-1;x>=0;--x)if(!Kw(p,u[x])){const T=u[x];let w=h[x];w=tn(w);const S=c.gc(T);if(w instanceof Ad)p.push(T);else{const C=wd(w,S);C!=null&&(p.push(T),g.set(T,C))}}const _=new Wn(p);return new jw(g,_,c.fieldTransforms)}function wd(t,e){if(qw(t=tn(t)))return P1("Unsupported field value:",e,t),Gw(t,e);if(t instanceof O1)return function(n,i){if(!zw(i.Ec))throw i.wc(`${n._methodName}() can only be used with update() and set()`);if(!i.path)throw i.wc(`${n._methodName}() is not currently supported inside arrays`);const o=n._toFieldTransform(i);o&&i.fieldTransforms.push(o)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.mc&&e.Ec!==4)throw e.wc("Nested arrays are not supported");return function(n,i){const o=[];let c=0;for(const u of n){let h=wd(u,i.yc(c));h==null&&(h={nullValue:"NULL_VALUE"}),o.push(h),c++}return{arrayValue:{values:o}}}(t,e)}return function(n,i){if((n=tn(n))===null)return{nullValue:"NULL_VALUE"};if(typeof n=="number")return $D(i.serializer,n);if(typeof n=="boolean")return{booleanValue:n};if(typeof n=="string")return{stringValue:n};if(n instanceof Date){const o=Gt.fromDate(n);return{timestampValue:B0(i.serializer,o)}}if(n instanceof Gt){const o=new Gt(n.seconds,1e3*Math.floor(n.nanoseconds/1e3));return{timestampValue:B0(i.serializer,o)}}if(n instanceof ri)return{geoPointValue:{latitude:n.latitude,longitude:n.longitude}};if(n instanceof da)return{bytesValue:sw(i.serializer,n._byteString)};if(n instanceof Rr){const o=i.databaseId,c=n.firestore._databaseId;if(!c.isEqual(o))throw i.wc(`Document reference is for database ${c.projectId}/${c.database} but should be for database ${o.projectId}/${o.database}`);return{referenceValue:v1(n.firestore._databaseId||i.databaseId,n._key.path)}}if(n instanceof ni)return function(c,u){return{mapValue:{fields:{[MA]:{stringValue:LA},[P0]:{arrayValue:{values:c.toArray().map(p=>{if(typeof p!="number")throw u.wc("VectorValues must only contain numeric values.");return d1(u.serializer,p)})}}}}}}(n,i);throw i.wc(`Unsupported field value: ${s1(n)}`)}(t,e)}function Gw(t,e){const r={};return IA(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Ws(t,(n,i)=>{const o=wd(i,e.Vc(n));o!=null&&(r[n]=o)}),{mapValue:{fields:r}}}function qw(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof Gt||t instanceof ri||t instanceof da||t instanceof Rr||t instanceof O1||t instanceof ni)}function P1(t,e,r){if(!qw(r)||!kA(r)){const n=s1(r);throw n==="an object"?e.wc(t+" a custom object"):e.wc(t+" "+n)}}function kg(t,e,r){if((e=tn(e))instanceof Td)return e._internalPath;if(typeof e=="string")return M1(t,e);throw G0("Field path arguments must be of type string or ",t,!1,void 0,r)}const l6=new RegExp("[~\\*/\\[\\]]");function M1(t,e,r){if(e.search(l6)>=0)throw G0(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,r);try{return new Td(...e.split("."))._internalPath}catch{throw G0(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,r)}}function G0(t,e,r,n,i){const o=n&&!n.isEmpty(),c=i!==void 0;let u=`Function ${e}() called with invalid data`;r&&(u+=" (via `toFirestore()`)"),u+=". ";let h="";return(o||c)&&(h+=" (found",o&&(h+=` in field ${n}`),c&&(h+=` in document ${i}`),h+=")"),new We(De.INVALID_ARGUMENT,u+t+h)}function Kw(t,e){return t.some(r=>r.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ww{constructor(e,r,n,i,o){this._firestore=e,this._userDataWriter=r,this._key=n,this._document=i,this._converter=o}get id(){return this._key.path.lastSegment()}get ref(){return new Rr(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new c6(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const r=this._document.data.field(Xw("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r)}}}class c6 extends Ww{data(){return super.data()}}function Xw(t,e){return typeof e=="string"?M1(t,e):e instanceof Td?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function u6(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new We(De.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class f6{convertValue(e,r="none"){switch(Bs(e)){case 0:return null;case 1:return e.booleanValue;case 2:return vr(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,r);case 5:return e.stringValue;case 6:return this.convertBytes(Us(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,r);case 11:return this.convertObject(e.mapValue,r);case 10:return this.convertVectorValue(e.mapValue);default:throw rt(62114,{value:e})}}convertObject(e,r){return this.convertObjectMap(e.fields,r)}convertObjectMap(e,r="none"){const n={};return Ws(e,(i,o)=>{n[i]=this.convertValue(o,r)}),n}convertVectorValue(e){var r,n,i;const o=(i=(n=(r=e.fields)===null||r===void 0?void 0:r[P0].arrayValue)===null||n===void 0?void 0:n.values)===null||i===void 0?void 0:i.map(c=>vr(c.doubleValue));return new ni(o)}convertGeoPoint(e){return new ri(vr(e.latitude),vr(e.longitude))}convertArray(e,r){return(e.values||[]).map(n=>this.convertValue(n,r))}convertServerTimestamp(e,r){switch(r){case"previous":const n=ud(e);return n==null?null:this.convertValue(n,r);case"estimate":return this.convertTimestamp(Zu(e));default:return null}}convertTimestamp(e){const r=Vs(e);return new Gt(r.seconds,r.nanos)}convertDocumentKey(e,r){const n=tr.fromString(e);jt(hw(n),9688,{name:e});const i=new Ju(n.get(1),n.get(3)),o=new $e(n.popFirst(5));return i.isEqual(r)||Bi(`Document ${o} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${r.projectId}/${r.database}) instead.`),o}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Yw(t,e,r){let n;return n=t?t.toFirestore(e):e,n}class Cu{constructor(e,r){this.hasPendingWrites=e,this.fromCache=r}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Do extends Ww{constructor(e,r,n,i,o,c){super(e,r,n,i,c),this._firestore=e,this._firestoreImpl=e,this.metadata=o}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const r=new A0(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(r,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,r={}){if(this._document){const n=this._document.data.field(Xw("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n,r.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new We(De.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,r={};return r.type=Do._jsonSchemaVersion,r.bundle="",r.bundleSource="DocumentSnapshot",r.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?r:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),r.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),r)}}Do._jsonSchemaVersion="firestore/documentSnapshot/1.0",Do._jsonSchema={type:Cr("string",Do._jsonSchemaVersion),bundleSource:Cr("string","DocumentSnapshot"),bundleName:Cr("string"),bundle:Cr("string")};class A0 extends Do{data(e={}){return super.data(e)}}class Jl{constructor(e,r,n,i){this._firestore=e,this._userDataWriter=r,this._snapshot=i,this.metadata=new Cu(i.hasPendingWrites,i.fromCache),this.query=n}get docs(){const e=[];return this.forEach(r=>e.push(r)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,r){this._snapshot.docs.forEach(n=>{e.call(r,new A0(this._firestore,this._userDataWriter,n.key,n,new Cu(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const r=!!e.includeMetadataChanges;if(r&&this._snapshot.excludesMetadataChanges)throw new We(De.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===r||(this._cachedChanges=function(i,o){if(i._snapshot.oldDocs.isEmpty()){let c=0;return i._snapshot.docChanges.map(u=>{const h=new A0(i._firestore,i._userDataWriter,u.doc.key,u.doc,new Cu(i._snapshot.mutatedKeys.has(u.doc.key),i._snapshot.fromCache),i.query.converter);return u.doc,{type:"added",doc:h,oldIndex:-1,newIndex:c++}})}{let c=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(u=>o||u.type!==3).map(u=>{const h=new A0(i._firestore,i._userDataWriter,u.doc.key,u.doc,new Cu(i._snapshot.mutatedKeys.has(u.doc.key),i._snapshot.fromCache),i.query.converter);let p=-1,g=-1;return u.type!==0&&(p=c.indexOf(u.doc.key),c=c.delete(u.doc.key)),u.type!==1&&(c=c.add(u.doc),g=c.indexOf(u.doc.key)),{type:h6(u.type),doc:h,oldIndex:p,newIndex:g}})}}(this,r),this._cachedChangesIncludeMetadataChanges=r),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new We(De.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=Jl._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=i1.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const r=[],n=[],i=[];return this.docs.forEach(o=>{o._document!==null&&(r.push(o._document),n.push(this._userDataWriter.convertObjectMap(o._document.data.value.mapValue.fields,"previous")),i.push(o.ref.path))}),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function h6(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return rt(61501,{type:t})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $w(t){t=Oa(t,Rr);const e=Oa(t.firestore,Xo);return ZN(D1(e),t._key).then(r=>p6(e,t,r))}Jl._jsonSchemaVersion="firestore/querySnapshot/1.0",Jl._jsonSchema={type:Cr("string",Jl._jsonSchemaVersion),bundleSource:Cr("string","QuerySnapshot"),bundleName:Cr("string"),bundle:Cr("string")};class Qw extends f6{constructor(e){super(),this.firestore=e}convertBytes(e){return new da(e)}convertReference(e){const r=this.convertDocumentKey(e,this.firestore._databaseId);return new Rr(this.firestore,null,r)}}function Sf(t){t=Oa(t,Ed);const e=Oa(t.firestore,Xo),r=D1(e),n=new Qw(e);return u6(t._query),JN(r,t._query).then(i=>new Jl(e,n,t,i))}function d6(t,e,r){t=Oa(t,Rr);const n=Oa(t.firestore,Xo),i=Yw(t.converter,e);return Sd(n,[Hw(F1(n),"setDoc",t._key,i,t.converter!==null,r).toMutation(t._key,pa.none())])}function Cf(t,e,r,...n){t=Oa(t,Rr);const i=Oa(t.firestore,Xo),o=F1(i);let c;return c=typeof(e=tn(e))=="string"||e instanceof Td?o6(o,"updateDoc",t._key,e,r,n):s6(o,"updateDoc",t._key,e),Sd(i,[c.toMutation(t._key,pa.exists(!0))])}function Rf(t){return Sd(Oa(t.firestore,Xo),[new p1(t._key,pa.none())])}function kf(t,e){const r=Oa(t.firestore,Xo),n=Pn(t),i=Yw(t.converter,e);return Sd(r,[Hw(F1(t.firestore),"addDoc",n._key,i,t.converter!==null,{}).toMutation(n._key,pa.exists(!1))]).then(()=>n)}function Sd(t,e){return function(n,i){const o=new Fi;return n.asyncQueue.enqueueAndForget(async()=>BN(await QN(n),i,o)),o.promise}(D1(t),e)}function p6(t,e,r){const n=r.docs.get(e._key),i=new Qw(t);return new Do(t,i,e._key,n,new Cu(r.hasPendingWrites,r.fromCache),e.converter)}(function(e,r=!0){(function(i){mc=i})(dc),nc(new Po("firestore",(n,{instanceIdentifier:i,options:o})=>{const c=n.getProvider("app").getImmediate(),u=new Xo(new lD(n.getProvider("auth-internal")),new fD(c,n.getProvider("app-check-internal")),function(p,g){if(!Object.prototype.hasOwnProperty.apply(p.options,["projectId"]))throw new We(De.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Ju(p.options.projectId,g)}(c,i),c);return o=Object.assign({useFetchStreams:r},o),u._setSettings(o),u},"PUBLIC").setMultipleInstances(!0)),Ds(hE,dE,e),Ds(hE,dE,"esm2017")})();var m6="firebase",g6="11.10.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Ds(m6,g6,"app");const v6={apiKey:"AIzaSyAADvft0ne-CpB00qBPOkJMcFqCGe-tOaU",authDomain:"evalstage2-lucas2025.firebaseapp.com",projectId:"evalstage2-lucas2025",storageBucket:"evalstage2-lucas2025.appspot.com",messagingSenderId:"1074657513257",appId:"1:1074657513257:web:f3fcc8ec7a421801277138"},Zw=M2(v6),n0=aD(Zw),or=t6(Zw),Jw=Pe.createContext(void 0),Cd=()=>{const t=Pe.useContext(Jw);if(t===void 0)throw new Error("useAuth must be used within an AuthProvider");return t},_6=({children:t})=>{const[e,r]=Pe.useState(null),[n,i]=Pe.useState(null),[o,c]=Pe.useState(!0);Pe.useEffect(()=>KI(n0,async x=>{if(i(x),x)try{const T=await $w(Pn(or,"users",x.uid));if(T.exists()){const w=T.data(),S=w.createdAt?.toDate?.()||new Date(w.createdAt)||new Date;r({id:x.uid,email:w.email||x.email||"",nom:w.nom||"Utilisateur",prenom:w.prenom||"Test",role:w.role||"professeur",createdAt:S}),console.log(" Connexion russie:",w)}else{const w={id:x.uid,email:x.email||"",nom:"Utilisateur",prenom:"Test",role:"professeur",createdAt:new Date};await d6(Pn(or,"users",x.uid),w),r(w),console.log(" Document utilisateur cr:",w)}}catch(T){console.error(" Erreur utilisateur:",T);const w={id:x.uid,email:x.email||"",nom:"Utilisateur",prenom:"Test",role:"professeur",createdAt:new Date};r(w)}else r(null),console.log(" Utilisateur dconnect");c(!1)}),[]);const g={currentUser:e,firebaseUser:n,loading:o,login:async(_,x)=>{try{await HI(n0,_,x)}catch(T){throw T}},loginWithGoogle:async()=>{const _=new Ii;try{await d3(n0,_)}catch(x){throw x}},logout:async()=>{try{await WI(n0)}catch(_){throw _}}};return Q.jsx(Jw.Provider,{value:g,children:t})},x6=({width:t=160})=>Q.jsxs("svg",{width:t,viewBox:"0 0 400 120",xmlns:"http://www.w3.org/2000/svg","aria-label":"Logo EvalStage2",children:[Q.jsx("rect",{x:"5",y:"5",width:"390",height:"110",rx:"25",fill:"#ffffff",stroke:"#3ecf8e",strokeWidth:"4"}),Q.jsxs("text",{x:"40",y:"78",fontFamily:"'Nunito', 'Inter', sans-serif",fontWeight:"700",fontSize:"64",letterSpacing:"8",children:[Q.jsx("tspan",{fill:"#ffb347",children:"E"}),Q.jsx("tspan",{fill:"#6ec1e4",dx:"-2",children:"V"}),Q.jsx("tspan",{fill:"#b39ddb",dx:"-2",children:"A"}),Q.jsx("tspan",{fill:"#3ecf8e",dx:"-2",children:"L"})]}),Q.jsx("text",{x:"250",y:"78",fontFamily:"'Nunito', 'Inter', sans-serif",fontWeight:"700",fontSize:"64",fill:"#ffe066",children:"2"})]}),y6=({onToggleTheme:t,isDarkMode:e})=>{const[r,n]=Pe.useState(!1),{currentUser:i,logout:o}=Cd(),c=async()=>{try{await o(),n(!1)}catch(h){console.error("Erreur lors de la dconnexion:",h)}},u=()=>{n(!r)};return Q.jsxs("nav",{className:"navigation",children:[Q.jsxs("div",{className:"nav-header",children:[Q.jsx(x6,{width:140}),Q.jsxs("div",{className:"nav-controls",children:[Q.jsx("button",{className:"theme-toggle",onClick:t,children:e?"":""}),i&&Q.jsx("button",{onClick:c,className:"logout-button",style:{marginLeft:"1em",background:"#dc2626",color:"white",border:"none",padding:"0.5rem 1rem",borderRadius:"8px",cursor:"pointer",fontWeight:"600"},children:"Se dconnecter"}),Q.jsx("button",{onClick:u,className:"menu-toggle",children:Q.jsx("span",{className:`hamburger ${r?"open":""}`})})]})]}),Q.jsx("div",{className:`nav-menu ${r?"open":""}`,style:{display:"flex",flexDirection:"column",minHeight:"300px"},children:i&&Q.jsxs(Q.Fragment,{children:[Q.jsxs("div",{className:"user-info",children:[Q.jsx("p",{children:"Connect en tant que :"}),Q.jsxs("strong",{children:[i.prenom," ",i.nom]}),Q.jsxs("span",{className:"user-role",children:["(",i.role,")"]})]}),Q.jsxs("div",{className:"nav-links",children:[Q.jsx("a",{href:"/",className:"nav-link",children:"Accueil"}),i.role==="admin"&&Q.jsx("a",{href:"/classes",className:"nav-link",children:"Grer les classes"}),Q.jsx("a",{href:"/eleves",className:"nav-link",children:"Grer les lves"}),Q.jsx("a",{href:"/stages",className:"nav-link",children:"Grer les stages"}),Q.jsx("a",{href:"/evaluations",className:"nav-link",children:"valuer un lve"}),Q.jsx("a",{href:"/rapports",className:"nav-link",children:"Exporter rapports"}),i.role==="admin"&&Q.jsx("a",{href:"/comptes",className:"nav-link",children:"Gestion des comptes"}),i.role==="admin"&&Q.jsx("a",{href:"/periodes-stage",className:"nav-link",children:"Priodes de stage"})]})]})})]})},E6=()=>{const[t,e]=Pe.useState(""),[r,n]=Pe.useState(""),[i,o]=Pe.useState(""),[c,u]=Pe.useState(!1),{login:h,loginWithGoogle:p}=Cd(),g=E2(),_=async T=>{if(T.preventDefault(),!t||!r){o("Veuillez remplir tous les champs");return}try{o(""),u(!0),await h(t,r),g("/")}catch(w){o("Email ou mot de passe incorrect"),console.error("Erreur de connexion:",w)}finally{u(!1)}},x=async()=>{try{o(""),u(!0),await p(),g("/")}catch(T){console.error("Erreur Google Auth:",T),o("La connexion Google a chou")}finally{u(!1)}};return Q.jsx("div",{className:"login-container",children:Q.jsxs("div",{className:"login-card",children:[Q.jsxs("div",{className:"login-header",children:[Q.jsx("h1",{children:"evalstage2"}),Q.jsx("p",{children:"Connexion"})]}),i&&Q.jsx("div",{className:"error-message",children:i}),Q.jsxs("form",{onSubmit:_,className:"login-form",children:[Q.jsxs("div",{className:"form-group",children:[Q.jsx("label",{htmlFor:"email",children:"Email"}),Q.jsx("input",{type:"email",id:"email",value:t,onChange:T=>e(T.target.value),placeholder:"votre.email@exemple.com",required:!0})]}),Q.jsxs("div",{className:"form-group",children:[Q.jsx("label",{htmlFor:"password",children:"Mot de passe"}),Q.jsx("input",{type:"password",id:"password",value:r,onChange:T=>n(T.target.value),placeholder:"Votre mot de passe",required:!0})]}),Q.jsx("button",{type:"submit",className:"login-button",disabled:c,children:c?"Connexion...":"Se connecter"}),Q.jsx("button",{type:"button",className:"google-button",onClick:x,disabled:c,children:"Se connecter avec Google"})]}),Q.jsx("div",{className:"login-footer",children:Q.jsx("p",{children:"Application d'valuation des stages"})})]})})},T6=()=>{const[t,e]=Pe.useState([]),[r,n]=Pe.useState(!0),[i,o]=Pe.useState(!1),[c,u]=Pe.useState(null),[h,p]=Pe.useState({nom:"",annee:new Date().getFullYear().toString(),effectif:0,professeurPrincipal:""});Pe.useEffect(()=>{g()},[]);const g=async()=>{try{const S=(await Sf(si(or,"classes"))).docs.map(C=>({id:C.id,...C.data(),createdAt:C.data().createdAt?.toDate()||new Date}));e(S)}catch(w){console.error("Erreur lors du chargement des classes:",w)}finally{n(!1)}},_=async w=>{w.preventDefault();try{c?(await Cf(Pn(or,"classes",c.id),{...h,updatedAt:new Date}),u(null)):await kf(si(or,"classes"),{...h,createdAt:new Date}),p({nom:"",annee:new Date().getFullYear().toString(),effectif:0,professeurPrincipal:""}),o(!1),g()}catch(S){console.error("Erreur lors de la sauvegarde:",S)}},x=w=>{u(w),p({nom:w.nom,annee:w.annee,effectif:w.effectif,professeurPrincipal:w.professeurPrincipal}),o(!0)},T=async w=>{if(window.confirm("tes-vous sr de vouloir supprimer cette classe ?"))try{await Rf(Pn(or,"classes",w)),g()}catch(S){console.error("Erreur lors de la suppression:",S)}};return r?Q.jsx("div",{className:"loading",children:"Chargement des classes..."}):Q.jsxs("div",{className:"gestion-classes",children:[Q.jsxs("div",{className:"header",children:[Q.jsx("h1",{children:"Gestion des Classes"}),Q.jsx("button",{className:"btn-primary",onClick:()=>{o(!0),u(null),p({nom:"",annee:new Date().getFullYear().toString(),effectif:0,professeurPrincipal:""})},children:"Ajouter une classe"})]}),i&&Q.jsx("div",{className:"form-overlay",children:Q.jsxs("div",{className:"form-container",children:[Q.jsx("h2",{children:c?"Modifier la classe":"Nouvelle classe"}),Q.jsxs("form",{onSubmit:_,children:[Q.jsxs("div",{className:"form-group",children:[Q.jsx("label",{children:"Nom de la classe:"}),Q.jsx("input",{type:"text",value:h.nom,onChange:w=>p({...h,nom:w.target.value}),required:!0})]}),Q.jsxs("div",{className:"form-group",children:[Q.jsx("label",{children:"Anne scolaire:"}),Q.jsx("input",{type:"text",value:h.annee,onChange:w=>p({...h,annee:w.target.value}),required:!0})]}),Q.jsxs("div",{className:"form-group",children:[Q.jsx("label",{children:"Effectif:"}),Q.jsx("input",{type:"number",value:h.effectif,onChange:w=>p({...h,effectif:parseInt(w.target.value)}),required:!0})]}),Q.jsxs("div",{className:"form-group",children:[Q.jsx("label",{children:"Professeur principal:"}),Q.jsx("input",{type:"text",value:h.professeurPrincipal,onChange:w=>p({...h,professeurPrincipal:w.target.value}),required:!0})]}),Q.jsxs("div",{className:"form-actions",children:[Q.jsx("button",{type:"submit",className:"btn-primary",children:c?"Modifier":"Ajouter"}),Q.jsx("button",{type:"button",className:"btn-secondary",onClick:()=>{o(!1),u(null)},children:"Annuler"})]})]})]})}),Q.jsx("div",{className:"classes-grid",children:t.map(w=>Q.jsxs("div",{className:"class-card",children:[Q.jsxs("div",{className:"class-header",children:[Q.jsx("h3",{children:w.nom}),Q.jsxs("div",{className:"class-actions",children:[Q.jsx("button",{className:"btn-edit",onClick:()=>x(w),children:""}),Q.jsx("button",{className:"btn-delete",onClick:()=>T(w.id),children:""})]})]}),Q.jsxs("div",{className:"class-info",children:[Q.jsxs("p",{children:[Q.jsx("strong",{children:"Anne:"})," ",w.annee]}),Q.jsxs("p",{children:[Q.jsx("strong",{children:"Effectif:"})," ",w.effectif," lves"]}),Q.jsxs("p",{children:[Q.jsx("strong",{children:"Professeur:"})," ",w.professeurPrincipal]}),Q.jsxs("p",{children:[Q.jsx("strong",{children:"Cre le:"})," ",w.createdAt.toLocaleDateString()]})]})]},w.id))}),t.length===0&&Q.jsxs("div",{className:"empty-state",children:[Q.jsx("p",{children:"Aucune classe enregistre"}),Q.jsx("button",{className:"btn-primary",onClick:()=>o(!0),children:"Crer la premire classe"})]})]})},So={async getAllEleves(){return(await Sf(si(or,"eleves"))).docs.map(e=>{const r=e.data();return{id:e.id,nom:r.nom,prenom:r.prenom,classeId:r.classeId,email:r.email||"",dateNaissance:r.dateNaissance||"",createdAt:r.createdAt?.toDate?r.createdAt.toDate():new Date(r.createdAt)}})},async createEleve(t){await kf(si(or,"eleves"),{...t,createdAt:new Date})},async updateEleve(t,e){await Cf(Pn(or,"eleves",t),e)},async deleteEleve(t){await Rf(Pn(or,"eleves",t))}};class A6{collectionName="classes";async getClasseById(e){try{const r=await $w(Pn(or,this.collectionName,e));if(r.exists()){const n=r.data();return{...n,id:r.id,createdAt:n.createdAt instanceof Gt?n.createdAt.toDate():new Date(n.createdAt),updatedAt:n.updatedAt instanceof Gt?n.updatedAt.toDate():new Date(n.updatedAt)}}return null}catch(r){throw console.error("Erreur lors de la rcupration de la classe:",r),r}}async getAllClasses(){try{return(await Sf(si(or,this.collectionName))).docs.map(r=>{const n=r.data();return{...n,id:r.id,createdAt:n.createdAt instanceof Gt?n.createdAt.toDate():new Date(n.createdAt),updatedAt:n.updatedAt instanceof Gt?n.updatedAt.toDate():new Date(n.updatedAt)}})}catch(e){throw console.error("Erreur lors de la rcupration des classes:",e),e}}async createClasse(e){try{const r=new Date;return(await kf(si(or,this.collectionName),{...e,createdAt:r,updatedAt:r})).id}catch(r){throw console.error("Erreur lors de la cration de la classe:",r),r}}async updateClasse(e,r){try{await Cf(Pn(or,this.collectionName,e),{...r,updatedAt:new Date})}catch(n){throw console.error("Erreur lors de la mise  jour de la classe:",n),n}}async deleteClasse(e){try{await Rf(Pn(or,this.collectionName,e))}catch(r){throw console.error("Erreur lors de la suppression de la classe:",r),r}}}const w6=new A6;/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var eS=1252,S6=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],L1={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},V1=function(t){S6.indexOf(t)!=-1&&(eS=L1[0]=t)};function C6(){V1(1252)}var ka=function(t){V1(t)};function tS(){ka(1200),C6()}function lT(t){for(var e=[],r=0,n=t.length;r<n;++r)e[r]=t.charCodeAt(r);return e}function R6(t){for(var e=[],r=0;r<t.length>>1;++r)e[r]=String.fromCharCode(t.charCodeAt(2*r)+(t.charCodeAt(2*r+1)<<8));return e.join("")}function rS(t){for(var e=[],r=0;r<t.length>>1;++r)e[r]=String.fromCharCode(t.charCodeAt(2*r+1)+(t.charCodeAt(2*r)<<8));return e.join("")}var Ru=function(t){var e=t.charCodeAt(0),r=t.charCodeAt(1);return e==255&&r==254?R6(t.slice(2)):e==254&&r==255?rS(t.slice(2)):e==65279?t.slice(1):t},a0=function(e){return String.fromCharCode(e)},cT=function(e){return String.fromCharCode(e)},nf,Rs="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function uT(t){for(var e="",r=0,n=0,i=0,o=0,c=0,u=0,h=0,p=0;p<t.length;)r=t.charCodeAt(p++),o=r>>2,n=t.charCodeAt(p++),c=(r&3)<<4|n>>4,i=t.charCodeAt(p++),u=(n&15)<<2|i>>6,h=i&63,isNaN(n)?u=h=64:isNaN(i)&&(h=64),e+=Rs.charAt(o)+Rs.charAt(c)+Rs.charAt(u)+Rs.charAt(h);return e}function Yn(t){var e="",r=0,n=0,i=0,o=0,c=0,u=0,h=0;t=t.replace(/[^\w\+\/\=]/g,"");for(var p=0;p<t.length;)o=Rs.indexOf(t.charAt(p++)),c=Rs.indexOf(t.charAt(p++)),r=o<<2|c>>4,e+=String.fromCharCode(r),u=Rs.indexOf(t.charAt(p++)),n=(c&15)<<4|u>>2,u!==64&&(e+=String.fromCharCode(n)),h=Rs.indexOf(t.charAt(p++)),i=(u&3)<<6|h,h!==64&&(e+=String.fromCharCode(i));return e}var wt=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),Yo=function(){if(typeof Buffer<"u"){var t=!Buffer.from;if(!t)try{Buffer.from("foo","utf8")}catch{t=!0}return t?function(e,r){return r?new Buffer(e,r):new Buffer(e)}:Buffer.from.bind(Buffer)}return function(){}}();function Hs(t){return wt?Buffer.alloc?Buffer.alloc(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}function fT(t){return wt?Buffer.allocUnsafe?Buffer.allocUnsafe(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}var Ca=function(e){return wt?Yo(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)&255})};function $o(t){if(Array.isArray(t))return t.map(function(n){return String.fromCharCode(n)}).join("");for(var e=[],r=0;r<t.length;++r)e[r]=String.fromCharCode(t[r]);return e.join("")}function U1(t){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(t instanceof ArrayBuffer)return U1(new Uint8Array(t));for(var e=new Array(t.length),r=0;r<t.length;++r)e[r]=t[r];return e}var ws=wt?function(t){return Buffer.concat(t.map(function(e){return Buffer.isBuffer(e)?e:Yo(e)}))}:function(t){if(typeof Uint8Array<"u"){var e=0,r=0;for(e=0;e<t.length;++e)r+=t[e].length;var n=new Uint8Array(r),i=0;for(e=0,r=0;e<t.length;r+=i,++e)if(i=t[e].length,t[e]instanceof Uint8Array)n.set(t[e],r);else{if(typeof t[e]=="string")throw"wtf";n.set(new Uint8Array(t[e]),r)}return n}return[].concat.apply([],t.map(function(o){return Array.isArray(o)?o:[].slice.call(o)}))};function k6(t){for(var e=[],r=0,n=t.length+250,i=Hs(t.length+255),o=0;o<t.length;++o){var c=t.charCodeAt(o);if(c<128)i[r++]=c;else if(c<2048)i[r++]=192|c>>6&31,i[r++]=128|c&63;else if(c>=55296&&c<57344){c=(c&1023)+64;var u=t.charCodeAt(++o)&1023;i[r++]=240|c>>8&7,i[r++]=128|c>>2&63,i[r++]=128|u>>6&15|(c&3)<<4,i[r++]=128|u&63}else i[r++]=224|c>>12&15,i[r++]=128|c>>6&63,i[r++]=128|c&63;r>n&&(e.push(i.slice(0,r)),r=0,i=Hs(65535),n=65530)}return e.push(i.slice(0,r)),ws(e)}var Sn=/\u0000/g,ku=/[\u0001-\u0006]/g;function ec(t){for(var e="",r=t.length-1;r>=0;)e+=t.charAt(r--);return e}function ba(t,e){var r=""+t;return r.length>=e?r:fr("0",e-r.length)+r}function B1(t,e){var r=""+t;return r.length>=e?r:fr(" ",e-r.length)+r}function q0(t,e){var r=""+t;return r.length>=e?r:r+fr(" ",e-r.length)}function b6(t,e){var r=""+Math.round(t);return r.length>=e?r:fr("0",e-r.length)+r}function I6(t,e){var r=""+t;return r.length>=e?r:fr("0",e-r.length)+r}var hT=Math.pow(2,32);function zl(t,e){if(t>hT||t<-hT)return b6(t,e);var r=Math.round(t);return I6(r,e)}function K0(t,e){return e=e||0,t.length>=7+e&&(t.charCodeAt(e)|32)===103&&(t.charCodeAt(e+1)|32)===101&&(t.charCodeAt(e+2)|32)===110&&(t.charCodeAt(e+3)|32)===101&&(t.charCodeAt(e+4)|32)===114&&(t.charCodeAt(e+5)|32)===97&&(t.charCodeAt(e+6)|32)===108}var dT=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],Km=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function D6(t){return t||(t={}),t[0]="General",t[1]="0",t[2]="0.00",t[3]="#,##0",t[4]="#,##0.00",t[9]="0%",t[10]="0.00%",t[11]="0.00E+00",t[12]="# ?/?",t[13]="# ??/??",t[14]="m/d/yy",t[15]="d-mmm-yy",t[16]="d-mmm",t[17]="mmm-yy",t[18]="h:mm AM/PM",t[19]="h:mm:ss AM/PM",t[20]="h:mm",t[21]="h:mm:ss",t[22]="m/d/yy h:mm",t[37]="#,##0 ;(#,##0)",t[38]="#,##0 ;[Red](#,##0)",t[39]="#,##0.00;(#,##0.00)",t[40]="#,##0.00;[Red](#,##0.00)",t[45]="mm:ss",t[46]="[h]:mm:ss",t[47]="mmss.0",t[48]="##0.0E+0",t[49]="@",t[56]='"/ "hh""mm""ss" "',t}var ht={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},pT={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},O6={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function W0(t,e,r){for(var n=t<0?-1:1,i=t*n,o=0,c=1,u=0,h=1,p=0,g=0,_=Math.floor(i);p<e&&(_=Math.floor(i),u=_*c+o,g=_*p+h,!(i-_<5e-8));)i=1/(i-_),o=c,c=u,h=p,p=g;if(g>e&&(p>e?(g=h,u=o):(g=p,u=c)),!r)return[0,n*u,g];var x=Math.floor(n*u/g);return[x,n*u-x*g,g]}function bo(t,e,r){if(t>2958465||t<0)return null;var n=t|0,i=Math.floor(86400*(t-n)),o=0,c=[],u={D:n,T:i,u:86400*(t-n)-i,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(u.u)<1e-6&&(u.u=0),e&&e.date1904&&(n+=1462),u.u>.9999&&(u.u=0,++i==86400&&(u.T=i=0,++n,++u.D)),n===60)c=r?[1317,10,29]:[1900,2,29],o=3;else if(n===0)c=r?[1317,8,29]:[1900,1,0],o=6;else{n>60&&--n;var h=new Date(1900,0,1);h.setDate(h.getDate()+n-1),c=[h.getFullYear(),h.getMonth()+1,h.getDate()],o=h.getDay(),n<60&&(o=(o+6)%7),r&&(o=V6(h,c))}return u.y=c[0],u.m=c[1],u.d=c[2],u.S=i%60,i=Math.floor(i/60),u.M=i%60,i=Math.floor(i/60),u.H=i,u.q=o,u}var nS=new Date(1899,11,31,0,0,0),N6=nS.getTime(),F6=new Date(1900,2,1,0,0,0);function aS(t,e){var r=t.getTime();return e?r-=1461*24*60*60*1e3:t>=F6&&(r+=24*60*60*1e3),(r-(N6+(t.getTimezoneOffset()-nS.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function j1(t){return t.indexOf(".")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function P6(t){return t.indexOf("E")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function M6(t){var e=t<0?12:11,r=j1(t.toFixed(12));return r.length<=e||(r=t.toPrecision(10),r.length<=e)?r:t.toExponential(5)}function L6(t){var e=j1(t.toFixed(11));return e.length>(t<0?12:11)||e==="0"||e==="-0"?t.toPrecision(6):e}function af(t){var e=Math.floor(Math.log(Math.abs(t))*Math.LOG10E),r;return e>=-4&&e<=-1?r=t.toPrecision(10+e):Math.abs(e)<=9?r=M6(t):e===10?r=t.toFixed(10).substr(0,12):r=L6(t),j1(P6(r.toUpperCase()))}function Uo(t,e){switch(typeof t){case"string":return t;case"boolean":return t?"TRUE":"FALSE";case"number":return(t|0)===t?t.toString(10):af(t);case"undefined":return"";case"object":if(t==null)return"";if(t instanceof Date)return ga(14,aS(t,e&&e.date1904),e)}throw new Error("unsupported value in General format: "+t)}function V6(t,e){e[0]-=581;var r=t.getDay();return t<60&&(r=(r+6)%7),r}function U6(t,e,r,n){var i="",o=0,c=0,u=r.y,h,p=0;switch(t){case 98:u=r.y+543;case 121:switch(e.length){case 1:case 2:h=u%100,p=2;break;default:h=u%1e4,p=4;break}break;case 109:switch(e.length){case 1:case 2:h=r.m,p=e.length;break;case 3:return Km[r.m-1][1];case 5:return Km[r.m-1][0];default:return Km[r.m-1][2]}break;case 100:switch(e.length){case 1:case 2:h=r.d,p=e.length;break;case 3:return dT[r.q][0];default:return dT[r.q][1]}break;case 104:switch(e.length){case 1:case 2:h=1+(r.H+11)%12,p=e.length;break;default:throw"bad hour format: "+e}break;case 72:switch(e.length){case 1:case 2:h=r.H,p=e.length;break;default:throw"bad hour format: "+e}break;case 77:switch(e.length){case 1:case 2:h=r.M,p=e.length;break;default:throw"bad minute format: "+e}break;case 115:if(e!="s"&&e!="ss"&&e!=".0"&&e!=".00"&&e!=".000")throw"bad second format: "+e;return r.u===0&&(e=="s"||e=="ss")?ba(r.S,e.length):(n>=2?c=n===3?1e3:100:c=n===1?10:1,o=Math.round(c*(r.S+r.u)),o>=60*c&&(o=0),e==="s"?o===0?"0":""+o/c:(i=ba(o,2+n),e==="ss"?i.substr(0,2):"."+i.substr(2,e.length-1)));case 90:switch(e){case"[h]":case"[hh]":h=r.D*24+r.H;break;case"[m]":case"[mm]":h=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":h=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+e}p=e.length===3?1:2;break;case 101:h=u,p=1;break}var g=p>0?ba(h,p):"";return g}function ks(t){var e=3;if(t.length<=e)return t;for(var r=t.length%e,n=t.substr(0,r);r!=t.length;r+=e)n+=(n.length>0?",":"")+t.substr(r,e);return n}var iS=/%/g;function B6(t,e,r){var n=e.replace(iS,""),i=e.length-n.length;return Pi(t,n,r*Math.pow(10,2*i))+fr("%",i)}function j6(t,e,r){for(var n=e.length-1;e.charCodeAt(n-1)===44;)--n;return Pi(t,e.substr(0,n),r/Math.pow(10,3*(e.length-n)))}function sS(t,e){var r,n=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+sS(t,-e);var i=t.indexOf(".");i===-1&&(i=t.indexOf("E"));var o=Math.floor(Math.log(e)*Math.LOG10E)%i;if(o<0&&(o+=i),r=(e/Math.pow(10,o)).toPrecision(n+1+(i+o)%i),r.indexOf("e")===-1){var c=Math.floor(Math.log(e)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(c-r.length+o):r+="E+"+(c-o);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,i)+"."+r.substr(2+i),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(u,h,p,g){return h+p+g.substr(0,(i+o)%i)+"."+g.substr(o)+"E"})}else r=e.toExponential(n);return t.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),t.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var oS=/# (\?+)( ?)\/( ?)(\d+)/;function z6(t,e,r){var n=parseInt(t[4],10),i=Math.round(e*n),o=Math.floor(i/n),c=i-o*n,u=n;return r+(o===0?"":""+o)+" "+(c===0?fr(" ",t[1].length+1+t[4].length):B1(c,t[1].length)+t[2]+"/"+t[3]+ba(u,t[4].length))}function H6(t,e,r){return r+(e===0?"":""+e)+fr(" ",t[1].length+2+t[4].length)}var lS=/^#*0*\.([0#]+)/,cS=/\).*[0#]/,uS=/\(###\) ###\\?-####/;function Tn(t){for(var e="",r,n=0;n!=t.length;++n)switch(r=t.charCodeAt(n)){case 35:break;case 63:e+=" ";break;case 48:e+="0";break;default:e+=String.fromCharCode(r)}return e}function mT(t,e){var r=Math.pow(10,e);return""+Math.round(t*r)/r}function gT(t,e){var r=t-Math.floor(t),n=Math.pow(10,e);return e<(""+Math.round(r*n)).length?0:Math.round(r*n)}function G6(t,e){return e<(""+Math.round((t-Math.floor(t))*Math.pow(10,e))).length?1:0}function q6(t){return t<2147483647&&t>-2147483648?""+(t>=0?t|0:t-1|0):""+Math.floor(t)}function ua(t,e,r){if(t.charCodeAt(0)===40&&!e.match(cS)){var n=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?ua("n",n,r):"("+ua("n",n,-r)+")"}if(e.charCodeAt(e.length-1)===44)return j6(t,e,r);if(e.indexOf("%")!==-1)return B6(t,e,r);if(e.indexOf("E")!==-1)return sS(e,r);if(e.charCodeAt(0)===36)return"$"+ua(t,e.substr(e.charAt(1)==" "?2:1),r);var i,o,c,u,h=Math.abs(r),p=r<0?"-":"";if(e.match(/^00+$/))return p+zl(h,e.length);if(e.match(/^[#?]+$/))return i=zl(r,0),i==="0"&&(i=""),i.length>e.length?i:Tn(e.substr(0,e.length-i.length))+i;if(o=e.match(oS))return z6(o,h,p);if(e.match(/^#+0+$/))return p+zl(h,e.length-e.indexOf("0"));if(o=e.match(lS))return i=mT(r,o[1].length).replace(/^([^\.]+)$/,"$1."+Tn(o[1])).replace(/\.$/,"."+Tn(o[1])).replace(/\.(\d*)$/,function(w,S){return"."+S+fr("0",Tn(o[1]).length-S.length)}),e.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),o=e.match(/^(0*)\.(#*)$/))return p+mT(h,o[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,o[1].length?"0.":".");if(o=e.match(/^#{1,3},##0(\.?)$/))return p+ks(zl(h,0));if(o=e.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+ua(t,e,-r):ks(""+(Math.floor(r)+G6(r,o[1].length)))+"."+ba(gT(r,o[1].length),o[1].length);if(o=e.match(/^#,#*,#0/))return ua(t,e.replace(/^#,#*,/,""),r);if(o=e.match(/^([0#]+)(\\?-([0#]+))+$/))return i=ec(ua(t,e.replace(/[\\-]/g,""),r)),c=0,ec(ec(e.replace(/\\/g,"")).replace(/[0#]/g,function(w){return c<i.length?i.charAt(c++):w==="0"?"0":""}));if(e.match(uS))return i=ua(t,"##########",r),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var g="";if(o=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return c=Math.min(o[4].length,7),u=W0(h,Math.pow(10,c)-1,!1),i=""+p,g=Pi("n",o[1],u[1]),g.charAt(g.length-1)==" "&&(g=g.substr(0,g.length-1)+"0"),i+=g+o[2]+"/"+o[3],g=q0(u[2],c),g.length<o[4].length&&(g=Tn(o[4].substr(o[4].length-g.length))+g),i+=g,i;if(o=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return c=Math.min(Math.max(o[1].length,o[4].length),7),u=W0(h,Math.pow(10,c)-1,!0),p+(u[0]||(u[1]?"":"0"))+" "+(u[1]?B1(u[1],c)+o[2]+"/"+o[3]+q0(u[2],c):fr(" ",2*c+1+o[2].length+o[3].length));if(o=e.match(/^[#0?]+$/))return i=zl(r,0),e.length<=i.length?i:Tn(e.substr(0,e.length-i.length))+i;if(o=e.match(/^([#0?]+)\.([#0]+)$/)){i=""+r.toFixed(Math.min(o[2].length,10)).replace(/([^0])0+$/,"$1"),c=i.indexOf(".");var _=e.indexOf(".")-c,x=e.length-i.length-_;return Tn(e.substr(0,_)+i+e.substr(e.length-x))}if(o=e.match(/^00,000\.([#0]*0)$/))return c=gT(r,o[1].length),r<0?"-"+ua(t,e,-r):ks(q6(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(w){return"00,"+(w.length<3?ba(0,3-w.length):"")+w})+"."+ba(c,o[1].length);switch(e){case"###,##0.00":return ua(t,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var T=ks(zl(h,0));return T!=="0"?p+T:"";case"###,###.00":return ua(t,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return ua(t,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+e+"|")}function K6(t,e,r){for(var n=e.length-1;e.charCodeAt(n-1)===44;)--n;return Pi(t,e.substr(0,n),r/Math.pow(10,3*(e.length-n)))}function W6(t,e,r){var n=e.replace(iS,""),i=e.length-n.length;return Pi(t,n,r*Math.pow(10,2*i))+fr("%",i)}function fS(t,e){var r,n=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+fS(t,-e);var i=t.indexOf(".");i===-1&&(i=t.indexOf("E"));var o=Math.floor(Math.log(e)*Math.LOG10E)%i;if(o<0&&(o+=i),r=(e/Math.pow(10,o)).toPrecision(n+1+(i+o)%i),!r.match(/[Ee]/)){var c=Math.floor(Math.log(e)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(c-r.length+o):r+="E+"+(c-o),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(u,h,p,g){return h+p+g.substr(0,(i+o)%i)+"."+g.substr(o)+"E"})}else r=e.toExponential(n);return t.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),t.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function Qa(t,e,r){if(t.charCodeAt(0)===40&&!e.match(cS)){var n=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Qa("n",n,r):"("+Qa("n",n,-r)+")"}if(e.charCodeAt(e.length-1)===44)return K6(t,e,r);if(e.indexOf("%")!==-1)return W6(t,e,r);if(e.indexOf("E")!==-1)return fS(e,r);if(e.charCodeAt(0)===36)return"$"+Qa(t,e.substr(e.charAt(1)==" "?2:1),r);var i,o,c,u,h=Math.abs(r),p=r<0?"-":"";if(e.match(/^00+$/))return p+ba(h,e.length);if(e.match(/^[#?]+$/))return i=""+r,r===0&&(i=""),i.length>e.length?i:Tn(e.substr(0,e.length-i.length))+i;if(o=e.match(oS))return H6(o,h,p);if(e.match(/^#+0+$/))return p+ba(h,e.length-e.indexOf("0"));if(o=e.match(lS))return i=(""+r).replace(/^([^\.]+)$/,"$1."+Tn(o[1])).replace(/\.$/,"."+Tn(o[1])),i=i.replace(/\.(\d*)$/,function(w,S){return"."+S+fr("0",Tn(o[1]).length-S.length)}),e.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),o=e.match(/^(0*)\.(#*)$/))return p+(""+h).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,o[1].length?"0.":".");if(o=e.match(/^#{1,3},##0(\.?)$/))return p+ks(""+h);if(o=e.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Qa(t,e,-r):ks(""+r)+"."+fr("0",o[1].length);if(o=e.match(/^#,#*,#0/))return Qa(t,e.replace(/^#,#*,/,""),r);if(o=e.match(/^([0#]+)(\\?-([0#]+))+$/))return i=ec(Qa(t,e.replace(/[\\-]/g,""),r)),c=0,ec(ec(e.replace(/\\/g,"")).replace(/[0#]/g,function(w){return c<i.length?i.charAt(c++):w==="0"?"0":""}));if(e.match(uS))return i=Qa(t,"##########",r),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var g="";if(o=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return c=Math.min(o[4].length,7),u=W0(h,Math.pow(10,c)-1,!1),i=""+p,g=Pi("n",o[1],u[1]),g.charAt(g.length-1)==" "&&(g=g.substr(0,g.length-1)+"0"),i+=g+o[2]+"/"+o[3],g=q0(u[2],c),g.length<o[4].length&&(g=Tn(o[4].substr(o[4].length-g.length))+g),i+=g,i;if(o=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return c=Math.min(Math.max(o[1].length,o[4].length),7),u=W0(h,Math.pow(10,c)-1,!0),p+(u[0]||(u[1]?"":"0"))+" "+(u[1]?B1(u[1],c)+o[2]+"/"+o[3]+q0(u[2],c):fr(" ",2*c+1+o[2].length+o[3].length));if(o=e.match(/^[#0?]+$/))return i=""+r,e.length<=i.length?i:Tn(e.substr(0,e.length-i.length))+i;if(o=e.match(/^([#0]+)\.([#0]+)$/)){i=""+r.toFixed(Math.min(o[2].length,10)).replace(/([^0])0+$/,"$1"),c=i.indexOf(".");var _=e.indexOf(".")-c,x=e.length-i.length-_;return Tn(e.substr(0,_)+i+e.substr(e.length-x))}if(o=e.match(/^00,000\.([#0]*0)$/))return r<0?"-"+Qa(t,e,-r):ks(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(w){return"00,"+(w.length<3?ba(0,3-w.length):"")+w})+"."+ba(0,o[1].length);switch(e){case"###,###":case"##,###":case"#,###":var T=ks(""+h);return T!=="0"?p+T:"";default:if(e.match(/\.[0#?]*$/))return Qa(t,e.slice(0,e.lastIndexOf(".")),r)+Tn(e.slice(e.lastIndexOf(".")))}throw new Error("unsupported format |"+e+"|")}function Pi(t,e,r){return(r|0)===r?Qa(t,e,r):ua(t,e,r)}function X6(t){for(var e=[],r=!1,n=0,i=0;n<t.length;++n)switch(t.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:e[e.length]=t.substr(i,n-i),i=n+1}if(e[e.length]=t.substr(i),r===!0)throw new Error("Format |"+t+"| unterminated string ");return e}var hS=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function xc(t){for(var e=0,r="",n="";e<t.length;)switch(r=t.charAt(e)){case"G":K0(t,e)&&(e+=6),e++;break;case'"':for(;t.charCodeAt(++e)!==34&&e<t.length;);++e;break;case"\\":e+=2;break;case"_":e+=2;break;case"@":++e;break;case"B":case"b":if(t.charAt(e+1)==="1"||t.charAt(e+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(t.substr(e,3).toUpperCase()==="A/P"||t.substr(e,5).toUpperCase()==="AM/PM"||t.substr(e,5).toUpperCase()==="/")return!0;++e;break;case"[":for(n=r;t.charAt(e++)!=="]"&&e<t.length;)n+=t.charAt(e);if(n.match(hS))return!0;break;case".":case"0":case"#":for(;e<t.length&&("0#?.,E+-%".indexOf(r=t.charAt(++e))>-1||r=="\\"&&t.charAt(e+1)=="-"&&"0#".indexOf(t.charAt(e+2))>-1););break;case"?":for(;t.charAt(++e)===r;);break;case"*":++e,(t.charAt(e)==" "||t.charAt(e)=="*")&&++e;break;case"(":case")":++e;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;e<t.length&&"0123456789".indexOf(t.charAt(++e))>-1;);break;case" ":++e;break;default:++e;break}return!1}function Y6(t,e,r,n){for(var i=[],o="",c=0,u="",h="t",p,g,_,x="H";c<t.length;)switch(u=t.charAt(c)){case"G":if(!K0(t,c))throw new Error("unrecognized character "+u+" in "+t);i[i.length]={t:"G",v:"General"},c+=7;break;case'"':for(o="";(_=t.charCodeAt(++c))!==34&&c<t.length;)o+=String.fromCharCode(_);i[i.length]={t:"t",v:o},++c;break;case"\\":var T=t.charAt(++c),w=T==="("||T===")"?T:"t";i[i.length]={t:w,v:T},++c;break;case"_":i[i.length]={t:"t",v:" "},c+=2;break;case"@":i[i.length]={t:"T",v:e},++c;break;case"B":case"b":if(t.charAt(c+1)==="1"||t.charAt(c+1)==="2"){if(p==null&&(p=bo(e,r,t.charAt(c+1)==="2"),p==null))return"";i[i.length]={t:"X",v:t.substr(c,2)},h=u,c+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":u=u.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(e<0||p==null&&(p=bo(e,r),p==null))return"";for(o=u;++c<t.length&&t.charAt(c).toLowerCase()===u;)o+=u;u==="m"&&h.toLowerCase()==="h"&&(u="M"),u==="h"&&(u=x),i[i.length]={t:u,v:o},h=u;break;case"A":case"a":case"":var S={t:u,v:u};if(p==null&&(p=bo(e,r)),t.substr(c,3).toUpperCase()==="A/P"?(p!=null&&(S.v=p.H>=12?"P":"A"),S.t="T",x="h",c+=3):t.substr(c,5).toUpperCase()==="AM/PM"?(p!=null&&(S.v=p.H>=12?"PM":"AM"),S.t="T",c+=5,x="h"):t.substr(c,5).toUpperCase()==="/"?(p!=null&&(S.v=p.H>=12?"":""),S.t="T",c+=5,x="h"):(S.t="t",++c),p==null&&S.t==="T")return"";i[i.length]=S,h=u;break;case"[":for(o=u;t.charAt(c++)!=="]"&&c<t.length;)o+=t.charAt(c);if(o.slice(-1)!=="]")throw'unterminated "[" block: |'+o+"|";if(o.match(hS)){if(p==null&&(p=bo(e,r),p==null))return"";i[i.length]={t:"Z",v:o.toLowerCase()},h=o.charAt(1)}else o.indexOf("$")>-1&&(o=(o.match(/\$([^-\[\]]*)/)||[])[1]||"$",xc(t)||(i[i.length]={t:"t",v:o}));break;case".":if(p!=null){for(o=u;++c<t.length&&(u=t.charAt(c))==="0";)o+=u;i[i.length]={t:"s",v:o};break}case"0":case"#":for(o=u;++c<t.length&&"0#?.,E+-%".indexOf(u=t.charAt(c))>-1;)o+=u;i[i.length]={t:"n",v:o};break;case"?":for(o=u;t.charAt(++c)===u;)o+=u;i[i.length]={t:u,v:o},h=u;break;case"*":++c,(t.charAt(c)==" "||t.charAt(c)=="*")&&++c;break;case"(":case")":i[i.length]={t:n===1?"t":u,v:u},++c;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(o=u;c<t.length&&"0123456789".indexOf(t.charAt(++c))>-1;)o+=t.charAt(c);i[i.length]={t:"D",v:o};break;case" ":i[i.length]={t:u,v:u},++c;break;case"$":i[i.length]={t:"t",v:"$"},++c;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(u)===-1)throw new Error("unrecognized character "+u+" in "+t);i[i.length]={t:"t",v:u},++c;break}var C=0,z=0,Y;for(c=i.length-1,h="t";c>=0;--c)switch(i[c].t){case"h":case"H":i[c].t=x,h="h",C<1&&(C=1);break;case"s":(Y=i[c].v.match(/\.0+$/))&&(z=Math.max(z,Y[0].length-1)),C<3&&(C=3);case"d":case"y":case"M":case"e":h=i[c].t;break;case"m":h==="s"&&(i[c].t="M",C<2&&(C=2));break;case"X":break;case"Z":C<1&&i[c].v.match(/[Hh]/)&&(C=1),C<2&&i[c].v.match(/[Mm]/)&&(C=2),C<3&&i[c].v.match(/[Ss]/)&&(C=3)}switch(C){case 0:break;case 1:p.u>=.5&&(p.u=0,++p.S),p.S>=60&&(p.S=0,++p.M),p.M>=60&&(p.M=0,++p.H);break;case 2:p.u>=.5&&(p.u=0,++p.S),p.S>=60&&(p.S=0,++p.M);break}var L="",K;for(c=0;c<i.length;++c)switch(i[c].t){case"t":case"T":case" ":case"D":break;case"X":i[c].v="",i[c].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":i[c].v=U6(i[c].t.charCodeAt(0),i[c].v,p,z),i[c].t="t";break;case"n":case"?":for(K=c+1;i[K]!=null&&((u=i[K].t)==="?"||u==="D"||(u===" "||u==="t")&&i[K+1]!=null&&(i[K+1].t==="?"||i[K+1].t==="t"&&i[K+1].v==="/")||i[c].t==="("&&(u===" "||u==="n"||u===")")||u==="t"&&(i[K].v==="/"||i[K].v===" "&&i[K+1]!=null&&i[K+1].t=="?"));)i[c].v+=i[K].v,i[K]={v:"",t:";"},++K;L+=i[c].v,c=K-1;break;case"G":i[c].t="t",i[c].v=Uo(e,r);break}var Z="",re,k;if(L.length>0){L.charCodeAt(0)==40?(re=e<0&&L.charCodeAt(0)===45?-e:e,k=Pi("n",L,re)):(re=e<0&&n>1?-e:e,k=Pi("n",L,re),re<0&&i[0]&&i[0].t=="t"&&(k=k.substr(1),i[0].v="-"+i[0].v)),K=k.length-1;var A=i.length;for(c=0;c<i.length;++c)if(i[c]!=null&&i[c].t!="t"&&i[c].v.indexOf(".")>-1){A=c;break}var E=i.length;if(A===i.length&&k.indexOf("E")===-1){for(c=i.length-1;c>=0;--c)i[c]==null||"n?".indexOf(i[c].t)===-1||(K>=i[c].v.length-1?(K-=i[c].v.length,i[c].v=k.substr(K+1,i[c].v.length)):K<0?i[c].v="":(i[c].v=k.substr(0,K+1),K=-1),i[c].t="t",E=c);K>=0&&E<i.length&&(i[E].v=k.substr(0,K+1)+i[E].v)}else if(A!==i.length&&k.indexOf("E")===-1){for(K=k.indexOf(".")-1,c=A;c>=0;--c)if(!(i[c]==null||"n?".indexOf(i[c].t)===-1)){for(g=i[c].v.indexOf(".")>-1&&c===A?i[c].v.indexOf(".")-1:i[c].v.length-1,Z=i[c].v.substr(g+1);g>=0;--g)K>=0&&(i[c].v.charAt(g)==="0"||i[c].v.charAt(g)==="#")&&(Z=k.charAt(K--)+Z);i[c].v=Z,i[c].t="t",E=c}for(K>=0&&E<i.length&&(i[E].v=k.substr(0,K+1)+i[E].v),K=k.indexOf(".")+1,c=A;c<i.length;++c)if(!(i[c]==null||"n?(".indexOf(i[c].t)===-1&&c!==A)){for(g=i[c].v.indexOf(".")>-1&&c===A?i[c].v.indexOf(".")+1:0,Z=i[c].v.substr(0,g);g<i[c].v.length;++g)K<k.length&&(Z+=k.charAt(K++));i[c].v=Z,i[c].t="t",E=c}}}for(c=0;c<i.length;++c)i[c]!=null&&"n?".indexOf(i[c].t)>-1&&(re=n>1&&e<0&&c>0&&i[c-1].v==="-"?-e:e,i[c].v=Pi(i[c].t,i[c].v,re),i[c].t="t");var I="";for(c=0;c!==i.length;++c)i[c]!=null&&(I+=i[c].v);return I}var vT=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function _T(t,e){if(e==null)return!1;var r=parseFloat(e[2]);switch(e[1]){case"=":if(t==r)return!0;break;case">":if(t>r)return!0;break;case"<":if(t<r)return!0;break;case"<>":if(t!=r)return!0;break;case">=":if(t>=r)return!0;break;case"<=":if(t<=r)return!0;break}return!1}function $6(t,e){var r=X6(t),n=r.length,i=r[n-1].indexOf("@");if(n<4&&i>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof e!="number")return[4,r.length===4||i>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=i>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=i>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=i>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var o=e>0?r[0]:e<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,o];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var c=r[0].match(vT),u=r[1].match(vT);return _T(e,c)?[n,r[0]]:_T(e,u)?[n,r[1]]:[n,r[c!=null&&u!=null?2:1]]}return[n,o]}function ga(t,e,r){r==null&&(r={});var n="";switch(typeof t){case"string":t=="m/d/yy"&&r.dateNF?n=r.dateNF:n=t;break;case"number":t==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:ht)[t],n==null&&(n=r.table&&r.table[pT[t]]||ht[pT[t]]),n==null&&(n=O6[t]||"General");break}if(K0(n,0))return Uo(e,r);e instanceof Date&&(e=aS(e,r.date1904));var i=$6(n,e);if(K0(i[1]))return Uo(e,r);if(e===!0)e="TRUE";else if(e===!1)e="FALSE";else if(e===""||e==null)return"";return Y6(i[1],e,r,i[0])}function Oo(t,e){if(typeof e!="number"){e=+e||-1;for(var r=0;r<392;++r){if(ht[r]==null){e<0&&(e=r);continue}if(ht[r]==t){e=r;break}}e<0&&(e=391)}return ht[e]=t,e}function dS(){ht=D6()}var Q6={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},pS=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function Z6(t){var e=typeof t=="number"?ht[t]:t;return e=e.replace(pS,"(\\d+)"),new RegExp("^"+e+"$")}function J6(t,e,r){var n=-1,i=-1,o=-1,c=-1,u=-1,h=-1;(e.match(pS)||[]).forEach(function(_,x){var T=parseInt(r[x+1],10);switch(_.toLowerCase().charAt(0)){case"y":n=T;break;case"d":o=T;break;case"h":c=T;break;case"s":h=T;break;case"m":c>=0?u=T:i=T;break}}),h>=0&&u==-1&&i>=0&&(u=i,i=-1);var p=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(i>=1?i:1)).slice(-2)+"-"+("00"+(o>=1?o:1)).slice(-2);p.length==7&&(p="0"+p),p.length==8&&(p="20"+p);var g=("00"+(c>=0?c:0)).slice(-2)+":"+("00"+(u>=0?u:0)).slice(-2)+":"+("00"+(h>=0?h:0)).slice(-2);return c==-1&&u==-1&&h==-1?p:n==-1&&i==-1&&o==-1?g:p+"T"+g}var eF=function(){var t={};t.version="1.2.0";function e(){for(var k=0,A=new Array(256),E=0;E!=256;++E)k=E,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,A[E]=k;return typeof Int32Array<"u"?new Int32Array(A):A}var r=e();function n(k){var A=0,E=0,I=0,O=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(I=0;I!=256;++I)O[I]=k[I];for(I=0;I!=256;++I)for(E=k[I],A=256+I;A<4096;A+=256)E=O[A]=E>>>8^k[E&255];var D=[];for(I=1;I!=16;++I)D[I-1]=typeof Int32Array<"u"?O.subarray(I*256,I*256+256):O.slice(I*256,I*256+256);return D}var i=n(r),o=i[0],c=i[1],u=i[2],h=i[3],p=i[4],g=i[5],_=i[6],x=i[7],T=i[8],w=i[9],S=i[10],C=i[11],z=i[12],Y=i[13],L=i[14];function K(k,A){for(var E=A^-1,I=0,O=k.length;I<O;)E=E>>>8^r[(E^k.charCodeAt(I++))&255];return~E}function Z(k,A){for(var E=A^-1,I=k.length-15,O=0;O<I;)E=L[k[O++]^E&255]^Y[k[O++]^E>>8&255]^z[k[O++]^E>>16&255]^C[k[O++]^E>>>24]^S[k[O++]]^w[k[O++]]^T[k[O++]]^x[k[O++]]^_[k[O++]]^g[k[O++]]^p[k[O++]]^h[k[O++]]^u[k[O++]]^c[k[O++]]^o[k[O++]]^r[k[O++]];for(I+=15;O<I;)E=E>>>8^r[(E^k[O++])&255];return~E}function re(k,A){for(var E=A^-1,I=0,O=k.length,D=0,F=0;I<O;)D=k.charCodeAt(I++),D<128?E=E>>>8^r[(E^D)&255]:D<2048?(E=E>>>8^r[(E^(192|D>>6&31))&255],E=E>>>8^r[(E^(128|D&63))&255]):D>=55296&&D<57344?(D=(D&1023)+64,F=k.charCodeAt(I++)&1023,E=E>>>8^r[(E^(240|D>>8&7))&255],E=E>>>8^r[(E^(128|D>>2&63))&255],E=E>>>8^r[(E^(128|F>>6&15|(D&3)<<4))&255],E=E>>>8^r[(E^(128|F&63))&255]):(E=E>>>8^r[(E^(224|D>>12&15))&255],E=E>>>8^r[(E^(128|D>>6&63))&255],E=E>>>8^r[(E^(128|D&63))&255]);return~E}return t.table=r,t.bstr=K,t.buf=Z,t.str=re,t}(),Dt=function(){var e={};e.version="1.2.1";function r(N,q){for(var U=N.split("/"),B=q.split("/"),H=0,X=0,de=Math.min(U.length,B.length);H<de;++H){if(X=U[H].length-B[H].length)return X;if(U[H]!=B[H])return U[H]<B[H]?-1:1}return U.length-B.length}function n(N){if(N.charAt(N.length-1)=="/")return N.slice(0,-1).indexOf("/")===-1?N:n(N.slice(0,-1));var q=N.lastIndexOf("/");return q===-1?N:N.slice(0,q+1)}function i(N){if(N.charAt(N.length-1)=="/")return i(N.slice(0,-1));var q=N.lastIndexOf("/");return q===-1?N:N.slice(q+1)}function o(N,q){typeof q=="string"&&(q=new Date(q));var U=q.getHours();U=U<<6|q.getMinutes(),U=U<<5|q.getSeconds()>>>1,N.write_shift(2,U);var B=q.getFullYear()-1980;B=B<<4|q.getMonth()+1,B=B<<5|q.getDate(),N.write_shift(2,B)}function c(N){var q=N.read_shift(2)&65535,U=N.read_shift(2)&65535,B=new Date,H=U&31;U>>>=5;var X=U&15;U>>>=4,B.setMilliseconds(0),B.setFullYear(U+1980),B.setMonth(X-1),B.setDate(H);var de=q&31;q>>>=5;var xe=q&63;return q>>>=6,B.setHours(q),B.setMinutes(xe),B.setSeconds(de<<1),B}function u(N){Qr(N,0);for(var q={},U=0;N.l<=N.length-4;){var B=N.read_shift(2),H=N.read_shift(2),X=N.l+H,de={};switch(B){case 21589:U=N.read_shift(1),U&1&&(de.mtime=N.read_shift(4)),H>5&&(U&2&&(de.atime=N.read_shift(4)),U&4&&(de.ctime=N.read_shift(4))),de.mtime&&(de.mt=new Date(de.mtime*1e3));break}N.l=X,q[B]=de}return q}var h;function p(){return h||(h={})}function g(N,q){if(N[0]==80&&N[1]==75)return Wi(N,q);if((N[0]|32)==109&&(N[1]|32)==105)return rl(N,q);if(N.length<512)throw new Error("CFB file size "+N.length+" < 512");var U=3,B=512,H=0,X=0,de=0,xe=0,ce=0,me=[],ge=N.slice(0,512);Qr(ge,0);var Oe=_(ge);switch(U=Oe[0],U){case 3:B=512;break;case 4:B=4096;break;case 0:if(Oe[1]==0)return Wi(N,q);default:throw new Error("Major Version: Expected 3 or 4 saw "+U)}B!==512&&(ge=N.slice(0,B),Qr(ge,28));var Le=N.slice(0,B);x(ge,U);var ze=ge.read_shift(4,"i");if(U===3&&ze!==0)throw new Error("# Directory Sectors: Expected 0 saw "+ze);ge.l+=4,de=ge.read_shift(4,"i"),ge.l+=4,ge.chk("00100000","Mini Stream Cutoff Size: "),xe=ge.read_shift(4,"i"),H=ge.read_shift(4,"i"),ce=ge.read_shift(4,"i"),X=ge.read_shift(4,"i");for(var Me=-1,je=0;je<109&&(Me=ge.read_shift(4,"i"),!(Me<0));++je)me[je]=Me;var at=T(N,B);C(ce,X,at,B,me);var Pt=Y(at,de,me,B);Pt[de].name="!Directory",H>0&&xe!==F&&(Pt[xe].name="!MiniFAT"),Pt[me[0]].name="!FAT",Pt.fat_addrs=me,Pt.ssz=B;var St={},Ct=[],Mn=[],Ma=[];L(de,Pt,at,Ct,H,St,Mn,xe),w(Mn,Ma,Ct),Ct.shift();var vn={FileIndex:Mn,FullPaths:Ma};return q&&q.raw&&(vn.raw={header:Le,sectors:at}),vn}function _(N){if(N[N.l]==80&&N[N.l+1]==75)return[0,0];N.chk(Fe,"Header Signature: "),N.l+=16;var q=N.read_shift(2,"u");return[N.read_shift(2,"u"),q]}function x(N,q){var U=9;switch(N.l+=2,U=N.read_shift(2)){case 9:if(q!=3)throw new Error("Sector Shift: Expected 9 saw "+U);break;case 12:if(q!=4)throw new Error("Sector Shift: Expected 12 saw "+U);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+U)}N.chk("0600","Mini Sector Shift: "),N.chk("000000000000","Reserved: ")}function T(N,q){for(var U=Math.ceil(N.length/q)-1,B=[],H=1;H<U;++H)B[H-1]=N.slice(H*q,(H+1)*q);return B[U-1]=N.slice(U*q),B}function w(N,q,U){for(var B=0,H=0,X=0,de=0,xe=0,ce=U.length,me=[],ge=[];B<ce;++B)me[B]=ge[B]=B,q[B]=U[B];for(;xe<ge.length;++xe)B=ge[xe],H=N[B].L,X=N[B].R,de=N[B].C,me[B]===B&&(H!==-1&&me[H]!==H&&(me[B]=me[H]),X!==-1&&me[X]!==X&&(me[B]=me[X])),de!==-1&&(me[de]=B),H!==-1&&B!=me[B]&&(me[H]=me[B],ge.lastIndexOf(H)<xe&&ge.push(H)),X!==-1&&B!=me[B]&&(me[X]=me[B],ge.lastIndexOf(X)<xe&&ge.push(X));for(B=1;B<ce;++B)me[B]===B&&(X!==-1&&me[X]!==X?me[B]=me[X]:H!==-1&&me[H]!==H&&(me[B]=me[H]));for(B=1;B<ce;++B)if(N[B].type!==0){if(xe=B,xe!=me[xe])do xe=me[xe],q[B]=q[xe]+"/"+q[B];while(xe!==0&&me[xe]!==-1&&xe!=me[xe]);me[B]=-1}for(q[0]+="/",B=1;B<ce;++B)N[B].type!==2&&(q[B]+="/")}function S(N,q,U){for(var B=N.start,H=N.size,X=[],de=B;U&&H>0&&de>=0;)X.push(q.slice(de*D,de*D+D)),H-=D,de=Co(U,de*4);return X.length===0?Nr(0):ws(X).slice(0,N.size)}function C(N,q,U,B,H){var X=F;if(N===F){if(q!==0)throw new Error("DIFAT chain shorter than expected")}else if(N!==-1){var de=U[N],xe=(B>>>2)-1;if(!de)return;for(var ce=0;ce<xe&&(X=Co(de,ce*4))!==F;++ce)H.push(X);C(Co(de,B-4),q-1,U,B,H)}}function z(N,q,U,B,H){var X=[],de=[];H||(H=[]);var xe=B-1,ce=0,me=0;for(ce=q;ce>=0;){H[ce]=!0,X[X.length]=ce,de.push(N[ce]);var ge=U[Math.floor(ce*4/B)];if(me=ce*4&xe,B<4+me)throw new Error("FAT boundary crossed: "+ce+" 4 "+B);if(!N[ge])break;ce=Co(N[ge],me)}return{nodes:X,data:kT([de])}}function Y(N,q,U,B){var H=N.length,X=[],de=[],xe=[],ce=[],me=B-1,ge=0,Oe=0,Le=0,ze=0;for(ge=0;ge<H;++ge)if(xe=[],Le=ge+q,Le>=H&&(Le-=H),!de[Le]){ce=[];var Me=[];for(Oe=Le;Oe>=0;){Me[Oe]=!0,de[Oe]=!0,xe[xe.length]=Oe,ce.push(N[Oe]);var je=U[Math.floor(Oe*4/B)];if(ze=Oe*4&me,B<4+ze)throw new Error("FAT boundary crossed: "+Oe+" 4 "+B);if(!N[je]||(Oe=Co(N[je],ze),Me[Oe]))break}X[Le]={nodes:xe,data:kT([ce])}}return X}function L(N,q,U,B,H,X,de,xe){for(var ce=0,me=B.length?2:0,ge=q[N].data,Oe=0,Le=0,ze;Oe<ge.length;Oe+=128){var Me=ge.slice(Oe,Oe+128);Qr(Me,64),Le=Me.read_shift(2),ze=q1(Me,0,Le-me),B.push(ze);var je={name:ze,type:Me.read_shift(1),color:Me.read_shift(1),L:Me.read_shift(4,"i"),R:Me.read_shift(4,"i"),C:Me.read_shift(4,"i"),clsid:Me.read_shift(16),state:Me.read_shift(4,"i"),start:0,size:0},at=Me.read_shift(2)+Me.read_shift(2)+Me.read_shift(2)+Me.read_shift(2);at!==0&&(je.ct=K(Me,Me.l-8));var Pt=Me.read_shift(2)+Me.read_shift(2)+Me.read_shift(2)+Me.read_shift(2);Pt!==0&&(je.mt=K(Me,Me.l-8)),je.start=Me.read_shift(4,"i"),je.size=Me.read_shift(4,"i"),je.size<0&&je.start<0&&(je.size=je.type=0,je.start=F,je.name=""),je.type===5?(ce=je.start,H>0&&ce!==F&&(q[ce].name="!StreamData")):je.size>=4096?(je.storage="fat",q[je.start]===void 0&&(q[je.start]=z(U,je.start,q.fat_addrs,q.ssz)),q[je.start].name=je.name,je.content=q[je.start].data.slice(0,je.size)):(je.storage="minifat",je.size<0?je.size=0:ce!==F&&je.start!==F&&q[ce]&&(je.content=S(je,q[ce].data,(q[xe]||{}).data))),je.content&&Qr(je.content,0),X[ze]=je,de.push(je)}}function K(N,q){return new Date((qn(N,q+4)/1e7*Math.pow(2,32)+qn(N,q)/1e7-11644473600)*1e3)}function Z(N,q){return p(),g(h.readFileSync(N),q)}function re(N,q){var U=q&&q.type;switch(U||wt&&Buffer.isBuffer(N)&&(U="buffer"),U||"base64"){case"file":return Z(N,q);case"base64":return g(Ca(Yn(N)),q);case"binary":return g(Ca(N),q)}return g(N,q)}function k(N,q){var U=q||{},B=U.root||"Root Entry";if(N.FullPaths||(N.FullPaths=[]),N.FileIndex||(N.FileIndex=[]),N.FullPaths.length!==N.FileIndex.length)throw new Error("inconsistent CFB structure");N.FullPaths.length===0&&(N.FullPaths[0]=B+"/",N.FileIndex[0]={name:B,type:5}),U.CLSID&&(N.FileIndex[0].clsid=U.CLSID),A(N)}function A(N){var q="Sh33tJ5";if(!Dt.find(N,"/"+q)){var U=Nr(4);U[0]=55,U[1]=U[3]=50,U[2]=54,N.FileIndex.push({name:q,type:2,content:U,size:4,L:69,R:69,C:69}),N.FullPaths.push(N.FullPaths[0]+q),E(N)}}function E(N,q){k(N);for(var U=!1,B=!1,H=N.FullPaths.length-1;H>=0;--H){var X=N.FileIndex[H];switch(X.type){case 0:B?U=!0:(N.FileIndex.pop(),N.FullPaths.pop());break;case 1:case 2:case 5:B=!0,isNaN(X.R*X.L*X.C)&&(U=!0),X.R>-1&&X.L>-1&&X.R==X.L&&(U=!0);break;default:U=!0;break}}if(!(!U&&!q)){var de=new Date(1987,1,19),xe=0,ce=Object.create?Object.create(null):{},me=[];for(H=0;H<N.FullPaths.length;++H)ce[N.FullPaths[H]]=!0,N.FileIndex[H].type!==0&&me.push([N.FullPaths[H],N.FileIndex[H]]);for(H=0;H<me.length;++H){var ge=n(me[H][0]);B=ce[ge],B||(me.push([ge,{name:i(ge).replace("/",""),type:1,clsid:ae,ct:de,mt:de,content:null}]),ce[ge]=!0)}for(me.sort(function(ze,Me){return r(ze[0],Me[0])}),N.FullPaths=[],N.FileIndex=[],H=0;H<me.length;++H)N.FullPaths[H]=me[H][0],N.FileIndex[H]=me[H][1];for(H=0;H<me.length;++H){var Oe=N.FileIndex[H],Le=N.FullPaths[H];if(Oe.name=i(Le).replace("/",""),Oe.L=Oe.R=Oe.C=-(Oe.color=1),Oe.size=Oe.content?Oe.content.length:0,Oe.start=0,Oe.clsid=Oe.clsid||ae,H===0)Oe.C=me.length>1?1:-1,Oe.size=0,Oe.type=5;else if(Le.slice(-1)=="/"){for(xe=H+1;xe<me.length&&n(N.FullPaths[xe])!=Le;++xe);for(Oe.C=xe>=me.length?-1:xe,xe=H+1;xe<me.length&&n(N.FullPaths[xe])!=n(Le);++xe);Oe.R=xe>=me.length?-1:xe,Oe.type=1}else n(N.FullPaths[H+1]||"")==n(Le)&&(Oe.R=H+1),Oe.type=2}}}function I(N,q){var U=q||{};if(U.fileType=="mad")return Qt(N,U);switch(E(N),U.fileType){case"zip":return xa(N,U)}var B=function(ze){for(var Me=0,je=0,at=0;at<ze.FileIndex.length;++at){var Pt=ze.FileIndex[at];if(Pt.content){var St=Pt.content.length;St>0&&(St<4096?Me+=St+63>>6:je+=St+511>>9)}}for(var Ct=ze.FullPaths.length+3>>2,Mn=Me+7>>3,Ma=Me+127>>7,vn=Mn+je+Ct+Ma,kn=vn+127>>7,La=kn<=109?0:Math.ceil((kn-109)/127);vn+kn+La+127>>7>kn;)La=++kn<=109?0:Math.ceil((kn-109)/127);var _n=[1,La,kn,Ma,Ct,je,Me,0];return ze.FileIndex[0].size=Me<<6,_n[7]=(ze.FileIndex[0].start=_n[0]+_n[1]+_n[2]+_n[3]+_n[4]+_n[5])+(_n[6]+7>>3),_n}(N),H=Nr(B[7]<<9),X=0,de=0;{for(X=0;X<8;++X)H.write_shift(1,Ce[X]);for(X=0;X<8;++X)H.write_shift(2,0);for(H.write_shift(2,62),H.write_shift(2,3),H.write_shift(2,65534),H.write_shift(2,9),H.write_shift(2,6),X=0;X<3;++X)H.write_shift(2,0);for(H.write_shift(4,0),H.write_shift(4,B[2]),H.write_shift(4,B[0]+B[1]+B[2]+B[3]-1),H.write_shift(4,0),H.write_shift(4,4096),H.write_shift(4,B[3]?B[0]+B[1]+B[2]-1:F),H.write_shift(4,B[3]),H.write_shift(-4,B[1]?B[0]-1:F),H.write_shift(4,B[1]),X=0;X<109;++X)H.write_shift(-4,X<B[2]?B[1]+X:-1)}if(B[1])for(de=0;de<B[1];++de){for(;X<236+de*127;++X)H.write_shift(-4,X<B[2]?B[1]+X:-1);H.write_shift(-4,de===B[1]-1?F:de+1)}var xe=function(ze){for(de+=ze;X<de-1;++X)H.write_shift(-4,X+1);ze&&(++X,H.write_shift(-4,F))};for(de=X=0,de+=B[1];X<de;++X)H.write_shift(-4,oe.DIFSECT);for(de+=B[2];X<de;++X)H.write_shift(-4,oe.FATSECT);xe(B[3]),xe(B[4]);for(var ce=0,me=0,ge=N.FileIndex[0];ce<N.FileIndex.length;++ce)ge=N.FileIndex[ce],ge.content&&(me=ge.content.length,!(me<4096)&&(ge.start=de,xe(me+511>>9)));for(xe(B[6]+7>>3);H.l&511;)H.write_shift(-4,oe.ENDOFCHAIN);for(de=X=0,ce=0;ce<N.FileIndex.length;++ce)ge=N.FileIndex[ce],ge.content&&(me=ge.content.length,!(!me||me>=4096)&&(ge.start=de,xe(me+63>>6)));for(;H.l&511;)H.write_shift(-4,oe.ENDOFCHAIN);for(X=0;X<B[4]<<2;++X){var Oe=N.FullPaths[X];if(!Oe||Oe.length===0){for(ce=0;ce<17;++ce)H.write_shift(4,0);for(ce=0;ce<3;++ce)H.write_shift(4,-1);for(ce=0;ce<12;++ce)H.write_shift(4,0);continue}ge=N.FileIndex[X],X===0&&(ge.start=ge.size?ge.start-1:F);var Le=X===0&&U.root||ge.name;if(me=2*(Le.length+1),H.write_shift(64,Le,"utf16le"),H.write_shift(2,me),H.write_shift(1,ge.type),H.write_shift(1,ge.color),H.write_shift(-4,ge.L),H.write_shift(-4,ge.R),H.write_shift(-4,ge.C),ge.clsid)H.write_shift(16,ge.clsid,"hex");else for(ce=0;ce<4;++ce)H.write_shift(4,0);H.write_shift(4,ge.state||0),H.write_shift(4,0),H.write_shift(4,0),H.write_shift(4,0),H.write_shift(4,0),H.write_shift(4,ge.start),H.write_shift(4,ge.size),H.write_shift(4,0)}for(X=1;X<N.FileIndex.length;++X)if(ge=N.FileIndex[X],ge.size>=4096)if(H.l=ge.start+1<<9,wt&&Buffer.isBuffer(ge.content))ge.content.copy(H,H.l,0,ge.size),H.l+=ge.size+511&-512;else{for(ce=0;ce<ge.size;++ce)H.write_shift(1,ge.content[ce]);for(;ce&511;++ce)H.write_shift(1,0)}for(X=1;X<N.FileIndex.length;++X)if(ge=N.FileIndex[X],ge.size>0&&ge.size<4096)if(wt&&Buffer.isBuffer(ge.content))ge.content.copy(H,H.l,0,ge.size),H.l+=ge.size+63&-64;else{for(ce=0;ce<ge.size;++ce)H.write_shift(1,ge.content[ce]);for(;ce&63;++ce)H.write_shift(1,0)}if(wt)H.l=H.length;else for(;H.l<H.length;)H.write_shift(1,0);return H}function O(N,q){var U=N.FullPaths.map(function(ce){return ce.toUpperCase()}),B=U.map(function(ce){var me=ce.split("/");return me[me.length-(ce.slice(-1)=="/"?2:1)]}),H=!1;q.charCodeAt(0)===47?(H=!0,q=U[0].slice(0,-1)+q):H=q.indexOf("/")!==-1;var X=q.toUpperCase(),de=H===!0?U.indexOf(X):B.indexOf(X);if(de!==-1)return N.FileIndex[de];var xe=!X.match(ku);for(X=X.replace(Sn,""),xe&&(X=X.replace(ku,"!")),de=0;de<U.length;++de)if((xe?U[de].replace(ku,"!"):U[de]).replace(Sn,"")==X||(xe?B[de].replace(ku,"!"):B[de]).replace(Sn,"")==X)return N.FileIndex[de];return null}var D=64,F=-2,Fe="d0cf11e0a1b11ae1",Ce=[208,207,17,224,161,177,26,225],ae="00000000000000000000000000000000",oe={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:F,FREESECT:-1,HEADER_SIGNATURE:Fe,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:ae,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function be(N,q,U){p();var B=I(N,U);h.writeFileSync(q,B)}function ne(N){for(var q=new Array(N.length),U=0;U<N.length;++U)q[U]=String.fromCharCode(N[U]);return q.join("")}function G(N,q){var U=I(N,q);switch(q&&q.type||"buffer"){case"file":return p(),h.writeFileSync(q.filename,U),U;case"binary":return typeof U=="string"?U:ne(U);case"base64":return uT(typeof U=="string"?U:ne(U));case"buffer":if(wt)return Buffer.isBuffer(U)?U:Yo(U);case"array":return typeof U=="string"?Ca(U):U}return U}var se;function P(N){try{var q=N.InflateRaw,U=new q;if(U._processChunk(new Uint8Array([3,0]),U._finishFlushFlag),U.bytesRead)se=N;else throw new Error("zlib does not expose bytesRead")}catch(B){console.error("cannot use native zlib: "+(B.message||B))}}function j(N,q){if(!se)return qi(N,q);var U=se.InflateRaw,B=new U,H=B._processChunk(N.slice(N.l),B._finishFlushFlag);return N.l+=B.bytesRead,H}function J(N){return se?se.deflateRawSync(N):ot(N)}var ee=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],ue=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],Ie=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function Ee(N){var q=(N<<1|N<<11)&139536|(N<<5|N<<15)&558144;return(q>>16|q>>8|q)&255}for(var we=typeof Uint8Array<"u",Te=we?new Uint8Array(256):[],Ue=0;Ue<256;++Ue)Te[Ue]=Ee(Ue);function W(N,q){var U=Te[N&255];return q<=8?U>>>8-q:(U=U<<8|Te[N>>8&255],q<=16?U>>>16-q:(U=U<<8|Te[N>>16&255],U>>>24-q))}function nt(N,q){var U=q&7,B=q>>>3;return(N[B]|(U<=6?0:N[B+1]<<8))>>>U&3}function Ge(N,q){var U=q&7,B=q>>>3;return(N[B]|(U<=5?0:N[B+1]<<8))>>>U&7}function Ke(N,q){var U=q&7,B=q>>>3;return(N[B]|(U<=4?0:N[B+1]<<8))>>>U&15}function Be(N,q){var U=q&7,B=q>>>3;return(N[B]|(U<=3?0:N[B+1]<<8))>>>U&31}function Ne(N,q){var U=q&7,B=q>>>3;return(N[B]|(U<=1?0:N[B+1]<<8))>>>U&127}function Ye(N,q,U){var B=q&7,H=q>>>3,X=(1<<U)-1,de=N[H]>>>B;return U<8-B||(de|=N[H+1]<<8-B,U<16-B)||(de|=N[H+2]<<16-B,U<24-B)||(de|=N[H+3]<<24-B),de&X}function ut(N,q,U){var B=q&7,H=q>>>3;return B<=5?N[H]|=(U&7)<<B:(N[H]|=U<<B&255,N[H+1]=(U&7)>>8-B),q+3}function _t(N,q,U){var B=q&7,H=q>>>3;return U=(U&1)<<B,N[H]|=U,q+1}function rr(N,q,U){var B=q&7,H=q>>>3;return U<<=B,N[H]|=U&255,U>>>=8,N[H+1]=U,q+8}function _r(N,q,U){var B=q&7,H=q>>>3;return U<<=B,N[H]|=U&255,U>>>=8,N[H+1]=U&255,N[H+2]=U>>>8,q+16}function hr(N,q){var U=N.length,B=2*U>q?2*U:q+5,H=0;if(U>=q)return N;if(wt){var X=fT(B);if(N.copy)N.copy(X);else for(;H<N.length;++H)X[H]=N[H];return X}else if(we){var de=new Uint8Array(B);if(de.set)de.set(N);else for(;H<U;++H)de[H]=N[H];return de}return N.length=B,N}function Et(N){for(var q=new Array(N),U=0;U<N;++U)q[U]=0;return q}function er(N,q,U){var B=1,H=0,X=0,de=0,xe=0,ce=N.length,me=we?new Uint16Array(32):Et(32);for(X=0;X<32;++X)me[X]=0;for(X=ce;X<U;++X)N[X]=0;ce=N.length;var ge=we?new Uint16Array(ce):Et(ce);for(X=0;X<ce;++X)me[H=N[X]]++,B<H&&(B=H),ge[X]=0;for(me[0]=0,X=1;X<=B;++X)me[X+16]=xe=xe+me[X-1]<<1;for(X=0;X<ce;++X)xe=N[X],xe!=0&&(ge[X]=me[xe+16]++);var Oe=0;for(X=0;X<ce;++X)if(Oe=N[X],Oe!=0)for(xe=W(ge[X],B)>>B-Oe,de=(1<<B+4-Oe)-1;de>=0;--de)q[xe|de<<Oe]=Oe&15|X<<4;return B}var Ze=we?new Uint16Array(512):Et(512),Je=we?new Uint16Array(32):Et(32);if(!we){for(var dt=0;dt<512;++dt)Ze[dt]=0;for(dt=0;dt<32;++dt)Je[dt]=0}(function(){for(var N=[],q=0;q<32;q++)N.push(5);er(N,Je,32);var U=[];for(q=0;q<=143;q++)U.push(8);for(;q<=255;q++)U.push(9);for(;q<=279;q++)U.push(7);for(;q<=287;q++)U.push(8);er(U,Ze,288)})();var Lt=function(){for(var q=we?new Uint8Array(32768):[],U=0,B=0;U<Ie.length-1;++U)for(;B<Ie[U+1];++B)q[B]=U;for(;B<32768;++B)q[B]=29;var H=we?new Uint8Array(259):[];for(U=0,B=0;U<ue.length-1;++U)for(;B<ue[U+1];++B)H[B]=U;function X(xe,ce){for(var me=0;me<xe.length;){var ge=Math.min(65535,xe.length-me),Oe=me+ge==xe.length;for(ce.write_shift(1,+Oe),ce.write_shift(2,ge),ce.write_shift(2,~ge&65535);ge-- >0;)ce[ce.l++]=xe[me++]}return ce.l}function de(xe,ce){for(var me=0,ge=0,Oe=we?new Uint16Array(32768):[];ge<xe.length;){var Le=Math.min(65535,xe.length-ge);if(Le<10){for(me=ut(ce,me,+(ge+Le==xe.length)),me&7&&(me+=8-(me&7)),ce.l=me/8|0,ce.write_shift(2,Le),ce.write_shift(2,~Le&65535);Le-- >0;)ce[ce.l++]=xe[ge++];me=ce.l*8;continue}me=ut(ce,me,+(ge+Le==xe.length)+2);for(var ze=0;Le-- >0;){var Me=xe[ge];ze=(ze<<5^Me)&32767;var je=-1,at=0;if((je=Oe[ze])&&(je|=ge&-32768,je>ge&&(je-=32768),je<ge))for(;xe[je+at]==xe[ge+at]&&at<250;)++at;if(at>2){Me=H[at],Me<=22?me=rr(ce,me,Te[Me+1]>>1)-1:(rr(ce,me,3),me+=5,rr(ce,me,Te[Me-23]>>5),me+=3);var Pt=Me<8?0:Me-4>>2;Pt>0&&(_r(ce,me,at-ue[Me]),me+=Pt),Me=q[ge-je],me=rr(ce,me,Te[Me]>>3),me-=3;var St=Me<4?0:Me-2>>1;St>0&&(_r(ce,me,ge-je-Ie[Me]),me+=St);for(var Ct=0;Ct<at;++Ct)Oe[ze]=ge&32767,ze=(ze<<5^xe[ge])&32767,++ge;Le-=at-1}else Me<=143?Me=Me+48:me=_t(ce,me,1),me=rr(ce,me,Te[Me]),Oe[ze]=ge&32767,++ge}me=rr(ce,me,0)-1}return ce.l=(me+7)/8|0,ce.l}return function(ce,me){return ce.length<8?X(ce,me):de(ce,me)}}();function ot(N){var q=Nr(50+Math.floor(N.length*1.1)),U=Lt(N,q);return q.slice(0,U)}var Ft=we?new Uint16Array(32768):Et(32768),Vt=we?new Uint16Array(32768):Et(32768),Ot=we?new Uint16Array(128):Et(128),Lr=1,Cn=1;function Gi(N,q){var U=Be(N,q)+257;q+=5;var B=Be(N,q)+1;q+=5;var H=Ke(N,q)+4;q+=4;for(var X=0,de=we?new Uint8Array(19):Et(19),xe=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],ce=1,me=we?new Uint8Array(8):Et(8),ge=we?new Uint8Array(8):Et(8),Oe=de.length,Le=0;Le<H;++Le)de[ee[Le]]=X=Ge(N,q),ce<X&&(ce=X),me[X]++,q+=3;var ze=0;for(me[0]=0,Le=1;Le<=ce;++Le)ge[Le]=ze=ze+me[Le-1]<<1;for(Le=0;Le<Oe;++Le)(ze=de[Le])!=0&&(xe[Le]=ge[ze]++);var Me=0;for(Le=0;Le<Oe;++Le)if(Me=de[Le],Me!=0){ze=Te[xe[Le]]>>8-Me;for(var je=(1<<7-Me)-1;je>=0;--je)Ot[ze|je<<Me]=Me&7|Le<<3}var at=[];for(ce=1;at.length<U+B;)switch(ze=Ot[Ne(N,q)],q+=ze&7,ze>>>=3){case 16:for(X=3+nt(N,q),q+=2,ze=at[at.length-1];X-- >0;)at.push(ze);break;case 17:for(X=3+Ge(N,q),q+=3;X-- >0;)at.push(0);break;case 18:for(X=11+Ne(N,q),q+=7;X-- >0;)at.push(0);break;default:at.push(ze),ce<ze&&(ce=ze);break}var Pt=at.slice(0,U),St=at.slice(U);for(Le=U;Le<286;++Le)Pt[Le]=0;for(Le=B;Le<30;++Le)St[Le]=0;return Lr=er(Pt,Ft,286),Cn=er(St,Vt,30),q}function ci(N,q){if(N[0]==3&&!(N[1]&3))return[Hs(q),2];for(var U=0,B=0,H=fT(q||1<<18),X=0,de=H.length>>>0,xe=0,ce=0;(B&1)==0;){if(B=Ge(N,U),U+=3,B>>>1)B>>1==1?(xe=9,ce=5):(U=Gi(N,U),xe=Lr,ce=Cn);else{U&7&&(U+=8-(U&7));var me=N[U>>>3]|N[(U>>>3)+1]<<8;if(U+=32,me>0)for(!q&&de<X+me&&(H=hr(H,X+me),de=H.length);me-- >0;)H[X++]=N[U>>>3],U+=8;continue}for(;;){!q&&de<X+32767&&(H=hr(H,X+32767),de=H.length);var ge=Ye(N,U,xe),Oe=B>>>1==1?Ze[ge]:Ft[ge];if(U+=Oe&15,Oe>>>=4,(Oe>>>8&255)===0)H[X++]=Oe;else{if(Oe==256)break;Oe-=257;var Le=Oe<8?0:Oe-4>>2;Le>5&&(Le=0);var ze=X+ue[Oe];Le>0&&(ze+=Ye(N,U,Le),U+=Le),ge=Ye(N,U,ce),Oe=B>>>1==1?Je[ge]:Vt[ge],U+=Oe&15,Oe>>>=4;var Me=Oe<4?0:Oe-2>>1,je=Ie[Oe];for(Me>0&&(je+=Ye(N,U,Me),U+=Me),!q&&de<ze&&(H=hr(H,ze+100),de=H.length);X<ze;)H[X]=H[X-je],++X}}}return q?[H,U+7>>>3]:[H.slice(0,X),U+7>>>3]}function qi(N,q){var U=N.slice(N.l||0),B=ci(U,q);return N.l+=B[1],B[0]}function Ki(N,q){if(N)typeof console<"u"&&console.error(q);else throw new Error(q)}function Wi(N,q){var U=N;Qr(U,0);var B=[],H=[],X={FileIndex:B,FullPaths:H};k(X,{root:q.root});for(var de=U.length-4;(U[de]!=80||U[de+1]!=75||U[de+2]!=5||U[de+3]!=6)&&de>=0;)--de;U.l=de+4,U.l+=4;var xe=U.read_shift(2);U.l+=6;var ce=U.read_shift(4);for(U.l=ce,de=0;de<xe;++de){U.l+=20;var me=U.read_shift(4),ge=U.read_shift(4),Oe=U.read_shift(2),Le=U.read_shift(2),ze=U.read_shift(2);U.l+=8;var Me=U.read_shift(4),je=u(U.slice(U.l+Oe,U.l+Oe+Le));U.l+=Oe+Le+ze;var at=U.l;U.l=Me+4,_a(U,me,ge,X,je),U.l=at}return X}function _a(N,q,U,B,H){N.l+=2;var X=N.read_shift(2),de=N.read_shift(2),xe=c(N);if(X&8257)throw new Error("Unsupported ZIP encryption");for(var ce=N.read_shift(4),me=N.read_shift(4),ge=N.read_shift(4),Oe=N.read_shift(2),Le=N.read_shift(2),ze="",Me=0;Me<Oe;++Me)ze+=String.fromCharCode(N[N.l++]);if(Le){var je=u(N.slice(N.l,N.l+Le));(je[21589]||{}).mt&&(xe=je[21589].mt),((H||{})[21589]||{}).mt&&(xe=H[21589].mt)}N.l+=Le;var at=N.slice(N.l,N.l+me);switch(de){case 8:at=j(N,ge);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+de)}var Pt=!1;X&8&&(ce=N.read_shift(4),ce==134695760&&(ce=N.read_shift(4),Pt=!0),me=N.read_shift(4),ge=N.read_shift(4)),me!=q&&Ki(Pt,"Bad compressed size: "+q+" != "+me),ge!=U&&Ki(Pt,"Bad uncompressed size: "+U+" != "+ge),nr(B,ze,at,{unsafe:!0,mt:xe})}function xa(N,q){var U=q||{},B=[],H=[],X=Nr(1),de=U.compression?8:0,xe=0,ce=0,me=0,ge=0,Oe=0,Le=N.FullPaths[0],ze=Le,Me=N.FileIndex[0],je=[],at=0;for(ce=1;ce<N.FullPaths.length;++ce)if(ze=N.FullPaths[ce].slice(Le.length),Me=N.FileIndex[ce],!(!Me.size||!Me.content||ze=="Sh33tJ5")){var Pt=ge,St=Nr(ze.length);for(me=0;me<ze.length;++me)St.write_shift(1,ze.charCodeAt(me)&127);St=St.slice(0,St.l),je[Oe]=eF.buf(Me.content,0);var Ct=Me.content;de==8&&(Ct=J(Ct)),X=Nr(30),X.write_shift(4,67324752),X.write_shift(2,20),X.write_shift(2,xe),X.write_shift(2,de),Me.mt?o(X,Me.mt):X.write_shift(4,0),X.write_shift(-4,je[Oe]),X.write_shift(4,Ct.length),X.write_shift(4,Me.content.length),X.write_shift(2,St.length),X.write_shift(2,0),ge+=X.length,B.push(X),ge+=St.length,B.push(St),ge+=Ct.length,B.push(Ct),X=Nr(46),X.write_shift(4,33639248),X.write_shift(2,0),X.write_shift(2,20),X.write_shift(2,xe),X.write_shift(2,de),X.write_shift(4,0),X.write_shift(-4,je[Oe]),X.write_shift(4,Ct.length),X.write_shift(4,Me.content.length),X.write_shift(2,St.length),X.write_shift(2,0),X.write_shift(2,0),X.write_shift(2,0),X.write_shift(2,0),X.write_shift(4,0),X.write_shift(4,Pt),at+=X.l,H.push(X),at+=St.length,H.push(St),++Oe}return X=Nr(22),X.write_shift(4,101010256),X.write_shift(2,0),X.write_shift(2,0),X.write_shift(2,Oe),X.write_shift(2,Oe),X.write_shift(4,at),X.write_shift(4,ge),X.write_shift(2,0),ws([ws(B),ws(H),X])}var Na={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function Qn(N,q){if(N.ctype)return N.ctype;var U=N.name||"",B=U.match(/\.([^\.]+)$/);return B&&Na[B[1]]||q&&(B=(U=q).match(/[\.\\]([^\.\\])+$/),B&&Na[B[1]])?Na[B[1]]:"application/octet-stream"}function Ys(N){for(var q=uT(N),U=[],B=0;B<q.length;B+=76)U.push(q.slice(B,B+76));return U.join(`\r
`)+`\r
`}function Fa(N){var q=N.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(me){var ge=me.charCodeAt(0).toString(16).toUpperCase();return"="+(ge.length==1?"0"+ge:ge)});q=q.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),q.charAt(0)==`
`&&(q="=0D"+q.slice(1)),q=q.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var U=[],B=q.split(`\r
`),H=0;H<B.length;++H){var X=B[H];if(X.length==0){U.push("");continue}for(var de=0;de<X.length;){var xe=76,ce=X.slice(de,de+xe);ce.charAt(xe-1)=="="?xe--:ce.charAt(xe-2)=="="?xe-=2:ce.charAt(xe-3)=="="&&(xe-=3),ce=X.slice(de,de+xe),de+=xe,de<X.length&&(ce+="="),U.push(ce)}}return U.join(`\r
`)}function Xi(N){for(var q=[],U=0;U<N.length;++U){for(var B=N[U];U<=N.length&&B.charAt(B.length-1)=="=";)B=B.slice(0,B.length-1)+N[++U];q.push(B)}for(var H=0;H<q.length;++H)q[H]=q[H].replace(/[=][0-9A-Fa-f]{2}/g,function(X){return String.fromCharCode(parseInt(X.slice(1),16))});return Ca(q.join(`\r
`))}function Pa(N,q,U){for(var B="",H="",X="",de,xe=0;xe<10;++xe){var ce=q[xe];if(!ce||ce.match(/^\s*$/))break;var me=ce.match(/^(.*?):\s*([^\s].*)$/);if(me)switch(me[1].toLowerCase()){case"content-location":B=me[2].trim();break;case"content-type":X=me[2].trim();break;case"content-transfer-encoding":H=me[2].trim();break}}switch(++xe,H.toLowerCase()){case"base64":de=Ca(Yn(q.slice(xe).join("")));break;case"quoted-printable":de=Xi(q.slice(xe));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+H)}var ge=nr(N,B.slice(U.length),de,{unsafe:!0});X&&(ge.ctype=X)}function rl(N,q){if(ne(N.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var U=q&&q.root||"",B=(wt&&Buffer.isBuffer(N)?N.toString("binary"):ne(N)).split(`\r
`),H=0,X="";for(H=0;H<B.length;++H)if(X=B[H],!!/^Content-Location:/i.test(X)&&(X=X.slice(X.indexOf("file")),U||(U=X.slice(0,X.lastIndexOf("/")+1)),X.slice(0,U.length)!=U))for(;U.length>0&&(U=U.slice(0,U.length-1),U=U.slice(0,U.lastIndexOf("/")+1),X.slice(0,U.length)!=U););var de=(B[1]||"").match(/boundary="(.*?)"/);if(!de)throw new Error("MAD cannot find boundary");var xe="--"+(de[1]||""),ce=[],me=[],ge={FileIndex:ce,FullPaths:me};k(ge);var Oe,Le=0;for(H=0;H<B.length;++H){var ze=B[H];ze!==xe&&ze!==xe+"--"||(Le++&&Pa(ge,B.slice(Oe,H),U),Oe=H)}return ge}function Qt(N,q){var U=q||{},B=U.boundary||"SheetJS";B="------="+B;for(var H=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+B.slice(2)+'"',"","",""],X=N.FullPaths[0],de=X,xe=N.FileIndex[0],ce=1;ce<N.FullPaths.length;++ce)if(de=N.FullPaths[ce].slice(X.length),xe=N.FileIndex[ce],!(!xe.size||!xe.content||de=="Sh33tJ5")){de=de.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(at){return"_x"+at.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(at){return"_u"+at.charCodeAt(0).toString(16)+"_"});for(var me=xe.content,ge=wt&&Buffer.isBuffer(me)?me.toString("binary"):ne(me),Oe=0,Le=Math.min(1024,ge.length),ze=0,Me=0;Me<=Le;++Me)(ze=ge.charCodeAt(Me))>=32&&ze<128&&++Oe;var je=Oe>=Le*4/5;H.push(B),H.push("Content-Location: "+(U.root||"file:///C:/SheetJS/")+de),H.push("Content-Transfer-Encoding: "+(je?"quoted-printable":"base64")),H.push("Content-Type: "+Qn(xe,de)),H.push(""),H.push(je?Fa(ge):Ys(ge))}return H.push(B+`--\r
`),H.join(`\r
`)}function dr(N){var q={};return k(q,N),q}function nr(N,q,U,B){var H=B&&B.unsafe;H||k(N);var X=!H&&Dt.find(N,q);if(!X){var de=N.FullPaths[0];q.slice(0,de.length)==de?de=q:(de.slice(-1)!="/"&&(de+="/"),de=(de+q).replace("//","/")),X={name:i(q),type:2},N.FileIndex.push(X),N.FullPaths.push(de),H||Dt.utils.cfb_gc(N)}return X.content=U,X.size=U?U.length:0,B&&(B.CLSID&&(X.clsid=B.CLSID),B.mt&&(X.mt=B.mt),B.ct&&(X.ct=B.ct)),X}function Rn(N,q){k(N);var U=Dt.find(N,q);if(U){for(var B=0;B<N.FileIndex.length;++B)if(N.FileIndex[B]==U)return N.FileIndex.splice(B,1),N.FullPaths.splice(B,1),!0}return!1}function $s(N,q,U){k(N);var B=Dt.find(N,q);if(B){for(var H=0;H<N.FileIndex.length;++H)if(N.FileIndex[H]==B)return N.FileIndex[H].name=i(U),N.FullPaths[H]=U,!0}return!1}function yc(N){E(N,!0)}return e.find=O,e.read=re,e.parse=g,e.write=G,e.writeFile=be,e.utils={cfb_new:dr,cfb_add:nr,cfb_del:Rn,cfb_mov:$s,cfb_gc:yc,ReadShift:Lu,CheckField:MS,prep_blob:Qr,bconcat:ws,use_zlib:P,_deflateRaw:ot,_inflateRaw:qi,consts:oe},e}();function tF(t){if(typeof Deno<"u")return Deno.readFileSync(t);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var e=File(t);e.open("r"),e.encoding="binary";var r=e.read();return e.close(),r}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+t)}function Gs(t){for(var e=Object.keys(t),r=[],n=0;n<e.length;++n)Object.prototype.hasOwnProperty.call(t,e[n])&&r.push(e[n]);return r}function z1(t){for(var e=[],r=Gs(t),n=0;n!==r.length;++n)e[t[r[n]]]=r[n];return e}var X0=new Date(1899,11,30,0,0,0);function $n(t,e){var r=t.getTime(),n=X0.getTime()+(t.getTimezoneOffset()-X0.getTimezoneOffset())*6e4;return(r-n)/(24*60*60*1e3)}var mS=new Date,rF=X0.getTime()+(mS.getTimezoneOffset()-X0.getTimezoneOffset())*6e4,xT=mS.getTimezoneOffset();function Rd(t){var e=new Date;return e.setTime(t*24*60*60*1e3+rF),e.getTimezoneOffset()!==xT&&e.setTime(e.getTime()+(e.getTimezoneOffset()-xT)*6e4),e}function nF(t){var e=0,r=0,n=!1,i=t.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!i)throw new Error("|"+t+"| is not an ISO8601 Duration");for(var o=1;o!=i.length;++o)if(i[o]){switch(r=1,o>3&&(n=!0),i[o].slice(i[o].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+i[o].slice(i[o].length-1));case"D":r*=24;case"H":r*=60;case"M":if(n)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}e+=r*parseInt(i[o],10)}return e}var yT=new Date("2017-02-19T19:06:09.000Z"),gS=isNaN(yT.getFullYear())?new Date("2/19/17"):yT,aF=gS.getFullYear()==2017;function Jr(t,e){var r=new Date(t);if(aF)return e>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):e<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(t instanceof Date)return t;if(gS.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return t.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var i=t.match(/\d+/g)||["2017","2","19","0","0","0"],o=new Date(+i[0],+i[1]-1,+i[2],+i[3]||0,+i[4]||0,+i[5]||0);return t.indexOf("Z")>-1&&(o=new Date(o.getTime()-o.getTimezoneOffset()*60*1e3)),o}function Bo(t,e){if(wt&&Buffer.isBuffer(t)){if(e){if(t[0]==255&&t[1]==254)return Iu(t.slice(2).toString("utf16le"));if(t[1]==254&&t[2]==255)return Iu(rS(t.slice(2).toString("binary")))}return t.toString("binary")}if(typeof TextDecoder<"u")try{if(e){if(t[0]==255&&t[1]==254)return Iu(new TextDecoder("utf-16le").decode(t.slice(2)));if(t[0]==254&&t[1]==255)return Iu(new TextDecoder("utf-16be").decode(t.slice(2)))}var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(t)&&(t=new Uint8Array(t)),new TextDecoder("latin1").decode(t).replace(/[]/g,function(o){return r[o]||o})}catch{}for(var n=[],i=0;i!=t.length;++i)n.push(String.fromCharCode(t[i]));return n.join("")}function en(t){if(typeof JSON<"u"&&!Array.isArray(t))return JSON.parse(JSON.stringify(t));if(typeof t!="object"||t==null)return t;if(t instanceof Date)return new Date(t.getTime());var e={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=en(t[r]));return e}function fr(t,e){for(var r="";r.length<e;)r+=t;return r}function Mi(t){var e=Number(t);if(!isNaN(e))return isFinite(e)?e:NaN;if(!/\d/.test(t))return e;var r=1,n=t.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(e=Number(n))||(n=n.replace(/[(](.*)[)]/,function(i,o){return r=-r,o}),!isNaN(e=Number(n)))?e/r:e}var iF=["january","february","march","april","may","june","july","august","september","october","november","december"];function sf(t){var e=new Date(t),r=new Date(NaN),n=e.getYear(),i=e.getMonth(),o=e.getDate();if(isNaN(o))return r;var c=t.toLowerCase();if(c.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(c=c.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),c.length>3&&iF.indexOf(c)==-1)return r}else if(c.match(/[a-z]/))return r;return n<0||n>8099?r:(i>0||o>1)&&n!=101?e:t.match(/[^-0-9:,\/\\]/)?r:e}var sF=function(){var t="abacaba".split(/(:?b)/i).length==5;return function(r,n,i){if(t||typeof n=="string")return r.split(n);for(var o=r.split(n),c=[o[0]],u=1;u<o.length;++u)c.push(i),c.push(o[u]);return c}}();function vS(t){return t?t.content&&t.type?Bo(t.content,!0):t.data?Ru(t.data):t.asNodeBuffer&&wt?Ru(t.asNodeBuffer().toString("binary")):t.asBinary?Ru(t.asBinary()):t._data&&t._data.getContent?Ru(Bo(Array.prototype.slice.call(t._data.getContent(),0))):null:null}function _S(t){if(!t)return null;if(t.data)return lT(t.data);if(t.asNodeBuffer&&wt)return t.asNodeBuffer();if(t._data&&t._data.getContent){var e=t._data.getContent();return typeof e=="string"?lT(e):Array.prototype.slice.call(e)}return t.content&&t.type?t.content:null}function oF(t){return t&&t.name.slice(-4)===".bin"?_S(t):vS(t)}function fa(t,e){for(var r=t.FullPaths||Gs(t.files),n=e.toLowerCase().replace(/[\/]/g,"\\"),i=n.replace(/\\/g,"/"),o=0;o<r.length;++o){var c=r[o].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==c||i==c)return t.files?t.files[r[o]]:t.FileIndex[o]}return null}function H1(t,e){var r=fa(t,e);if(r==null)throw new Error("Cannot find file "+e+" in zip");return r}function wr(t,e,r){if(!r)return oF(H1(t,e));if(!e)return null;try{return wr(t,e)}catch{return null}}function Kn(t,e,r){if(!r)return vS(H1(t,e));if(!e)return null;try{return Kn(t,e)}catch{return null}}function lF(t,e,r){return _S(H1(t,e))}function ET(t){for(var e=t.FullPaths||Gs(t.files),r=[],n=0;n<e.length;++n)e[n].slice(-1)!="/"&&r.push(e[n].replace(/^Root Entry[\/]/,""));return r.sort()}function cF(t,e,r){if(t.FullPaths){if(typeof r=="string"){var n;return wt?n=Yo(r):n=k6(r),Dt.utils.cfb_add(t,e,n)}Dt.utils.cfb_add(t,e,r)}else t.file(e,r)}function xS(t,e){switch(e.type){case"base64":return Dt.read(t,{type:"base64"});case"binary":return Dt.read(t,{type:"binary"});case"buffer":case"array":return Dt.read(t,{type:"buffer"})}throw new Error("Unrecognized type "+e.type)}function bu(t,e){if(t.charAt(0)=="/")return t.slice(1);var r=e.split("/");e.slice(-1)!="/"&&r.pop();for(var n=t.split("/");n.length!==0;){var i=n.shift();i===".."?r.pop():i!=="."&&r.push(i)}return r.join("/")}var yS=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,uF=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,TT=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,fF=/<[^>]*>/g,gn=yS.match(TT)?TT:fF,hF=/<\w*:/,dF=/<(\/?)\w+:/;function st(t,e,r){for(var n={},i=0,o=0;i!==t.length&&!((o=t.charCodeAt(i))===32||o===10||o===13);++i);if(e||(n[0]=t.slice(0,i)),i===t.length)return n;var c=t.match(uF),u=0,h="",p=0,g="",_="",x=1;if(c)for(p=0;p!=c.length;++p){for(_=c[p],o=0;o!=_.length&&_.charCodeAt(o)!==61;++o);for(g=_.slice(0,o).trim();_.charCodeAt(o+1)==32;)++o;for(x=(i=_.charCodeAt(o+1))==34||i==39?1:0,h=_.slice(o+1+x,_.length-x),u=0;u!=g.length&&g.charCodeAt(u)!==58;++u);if(u===g.length)g.indexOf("_")>0&&(g=g.slice(0,g.indexOf("_"))),n[g]=h,n[g.toLowerCase()]=h;else{var T=(u===5&&g.slice(0,5)==="xmlns"?"xmlns":"")+g.slice(u+1);if(n[T]&&g.slice(u-3,u)=="ext")continue;n[T]=h,n[T.toLowerCase()]=h}}return n}function oi(t){return t.replace(dF,"<$1")}var ES={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},pF=z1(ES),Nt=function(){var t=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,e=/_x([\da-fA-F]{4})_/ig;return function r(n){var i=n+"",o=i.indexOf("<![CDATA[");if(o==-1)return i.replace(t,function(u,h){return ES[u]||String.fromCharCode(parseInt(h,u.indexOf("x")>-1?16:10))||u}).replace(e,function(u,h){return String.fromCharCode(parseInt(h,16))});var c=i.indexOf("]]>");return r(i.slice(0,o))+i.slice(o+9,c)+r(i.slice(c+3))}}(),mF=/[&<>'"]/g,gF=/[\u0000-\u001f]/g;function TS(t){var e=t+"";return e.replace(mF,function(r){return pF[r]}).replace(/\n/g,"<br/>").replace(gF,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}var AT=function(){var t=/&#(\d+);/g;function e(r,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(t,e)}}();function ir(t){switch(t){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function Wm(t){for(var e="",r=0,n=0,i=0,o=0,c=0,u=0;r<t.length;){if(n=t.charCodeAt(r++),n<128){e+=String.fromCharCode(n);continue}if(i=t.charCodeAt(r++),n>191&&n<224){c=(n&31)<<6,c|=i&63,e+=String.fromCharCode(c);continue}if(o=t.charCodeAt(r++),n<240){e+=String.fromCharCode((n&15)<<12|(i&63)<<6|o&63);continue}c=t.charCodeAt(r++),u=((n&7)<<18|(i&63)<<12|(o&63)<<6|c&63)-65536,e+=String.fromCharCode(55296+(u>>>10&1023)),e+=String.fromCharCode(56320+(u&1023))}return e}function wT(t){var e=Hs(2*t.length),r,n,i=1,o=0,c=0,u;for(n=0;n<t.length;n+=i)i=1,(u=t.charCodeAt(n))<128?r=u:u<224?(r=(u&31)*64+(t.charCodeAt(n+1)&63),i=2):u<240?(r=(u&15)*4096+(t.charCodeAt(n+1)&63)*64+(t.charCodeAt(n+2)&63),i=3):(i=4,r=(u&7)*262144+(t.charCodeAt(n+1)&63)*4096+(t.charCodeAt(n+2)&63)*64+(t.charCodeAt(n+3)&63),r-=65536,c=55296+(r>>>10&1023),r=56320+(r&1023)),c!==0&&(e[o++]=c&255,e[o++]=c>>>8,c=0),e[o++]=r%256,e[o++]=r>>>8;return e.slice(0,o).toString("ucs2")}function ST(t){return Yo(t,"binary").toString("utf8")}var i0="foo bar baz",Jt=wt&&(ST(i0)==Wm(i0)&&ST||wT(i0)==Wm(i0)&&wT)||Wm,Iu=wt?function(t){return Yo(t,"utf8").toString("binary")}:function(t){for(var e=[],r=0,n=0,i=0;r<t.length;)switch(n=t.charCodeAt(r++),!0){case n<128:e.push(String.fromCharCode(n));break;case n<2048:e.push(String.fromCharCode(192+(n>>6))),e.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,i=t.charCodeAt(r++)-56320+(n<<10),e.push(String.fromCharCode(240+(i>>18&7))),e.push(String.fromCharCode(144+(i>>12&63))),e.push(String.fromCharCode(128+(i>>6&63))),e.push(String.fromCharCode(128+(i&63)));break;default:e.push(String.fromCharCode(224+(n>>12))),e.push(String.fromCharCode(128+(n>>6&63))),e.push(String.fromCharCode(128+(n&63)))}return e.join("")},of=function(){var t={};return function(r,n){var i=r+"|"+(n||"");return t[i]?t[i]:t[i]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",n||"")}}(),vF=function(){var t=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(e){return[new RegExp("&"+e[0]+";","ig"),e[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),i=0;i<t.length;++i)n=n.replace(t[i][0],t[i][1]);return n}}(),_F=function(){var t={};return function(r){return t[r]!==void 0?t[r]:t[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}}(),xF=/<\/?(?:vt:)?variant>/g,yF=/<(?:vt:)([^>]*)>([\s\S]*)</;function CT(t,e){var r=st(t),n=t.match(_F(r.baseType))||[],i=[];if(n.length!=r.size){if(e.WTF)throw new Error("unexpected vector length "+n.length+" != "+r.size);return i}return n.forEach(function(o){var c=o.replace(xF,"").match(yF);c&&i.push({v:Jt(c[2]),t:c[1]})}),i}function G1(t){if(wt&&Buffer.isBuffer(t))return t.toString("utf8");if(typeof t=="string")return t;if(typeof Uint8Array<"u"&&t instanceof Uint8Array)return Jt($o(U1(t)));throw new Error("Bad input format: expected Buffer or string")}var lf=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,EF={CT:"http://schemas.openxmlformats.org/package/2006/content-types"},TF=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"];function AF(t,e){for(var r=1-2*(t[e+7]>>>7),n=((t[e+7]&127)<<4)+(t[e+6]>>>4&15),i=t[e+6]&15,o=5;o>=0;--o)i=i*256+t[e+o];return n==2047?i==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,i+=Math.pow(2,52)),r*Math.pow(2,n-52)*i)}function wF(t,e,r){var n=(e<0||1/e==-1/0?1:0)<<7,i=0,o=0,c=n?-e:e;isFinite(c)?c==0?i=o=0:(i=Math.floor(Math.log(c)/Math.LN2),o=c*Math.pow(2,52-i),i<=-1023&&(!isFinite(o)||o<Math.pow(2,52))?i=-1022:(o-=Math.pow(2,52),i+=1023)):(i=2047,o=isNaN(e)?26985:0);for(var u=0;u<=5;++u,o/=256)t[r+u]=o&255;t[r+6]=(i&15)<<4|o&15,t[r+7]=i>>4|n}var RT=function(t){for(var e=[],r=10240,n=0;n<t[0].length;++n)if(t[0][n])for(var i=0,o=t[0][n].length;i<o;i+=r)e.push.apply(e,t[0][n].slice(i,i+r));return e},kT=wt?function(t){return t[0].length>0&&Buffer.isBuffer(t[0][0])?Buffer.concat(t[0].map(function(e){return Buffer.isBuffer(e)?e:Yo(e)})):RT(t)}:RT,bT=function(t,e,r){for(var n=[],i=e;i<r;i+=2)n.push(String.fromCharCode(Ni(t,i)));return n.join("").replace(Sn,"")},q1=wt?function(t,e,r){return Buffer.isBuffer(t)?t.toString("utf16le",e,r).replace(Sn,""):bT(t,e,r)}:bT,IT=function(t,e,r){for(var n=[],i=e;i<e+r;++i)n.push(("0"+t[i].toString(16)).slice(-2));return n.join("")},AS=wt?function(t,e,r){return Buffer.isBuffer(t)?t.toString("hex",e,e+r):IT(t,e,r)}:IT,DT=function(t,e,r){for(var n=[],i=e;i<r;i++)n.push(String.fromCharCode(Wl(t,i)));return n.join("")},bf=wt?function(e,r,n){return Buffer.isBuffer(e)?e.toString("utf8",r,n):DT(e,r,n)}:DT,wS=function(t,e){var r=qn(t,e);return r>0?bf(t,e+4,e+4+r-1):""},SS=wS,CS=function(t,e){var r=qn(t,e);return r>0?bf(t,e+4,e+4+r-1):""},RS=CS,kS=function(t,e){var r=2*qn(t,e);return r>0?bf(t,e+4,e+4+r-1):""},bS=kS,IS=function(e,r){var n=qn(e,r);return n>0?q1(e,r+4,r+4+n):""},DS=IS,OS=function(t,e){var r=qn(t,e);return r>0?bf(t,e+4,e+4+r):""},NS=OS,FS=function(t,e){return AF(t,e)},Y0=FS,PS=function(e){return Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array};wt&&(SS=function(e,r){if(!Buffer.isBuffer(e))return wS(e,r);var n=e.readUInt32LE(r);return n>0?e.toString("utf8",r+4,r+4+n-1):""},RS=function(e,r){if(!Buffer.isBuffer(e))return CS(e,r);var n=e.readUInt32LE(r);return n>0?e.toString("utf8",r+4,r+4+n-1):""},bS=function(e,r){if(!Buffer.isBuffer(e))return kS(e,r);var n=2*e.readUInt32LE(r);return e.toString("utf16le",r+4,r+4+n-1)},DS=function(e,r){if(!Buffer.isBuffer(e))return IS(e,r);var n=e.readUInt32LE(r);return e.toString("utf16le",r+4,r+4+n)},NS=function(e,r){if(!Buffer.isBuffer(e))return OS(e,r);var n=e.readUInt32LE(r);return e.toString("utf8",r+4,r+4+n)},Y0=function(e,r){return Buffer.isBuffer(e)?e.readDoubleLE(r):FS(e,r)},PS=function(e){return Buffer.isBuffer(e)||Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array});var Wl=function(t,e){return t[e]},Ni=function(t,e){return t[e+1]*256+t[e]},SF=function(t,e){var r=t[e+1]*256+t[e];return r<32768?r:(65535-r+1)*-1},qn=function(t,e){return t[e+3]*(1<<24)+(t[e+2]<<16)+(t[e+1]<<8)+t[e]},Co=function(t,e){return t[e+3]<<24|t[e+2]<<16|t[e+1]<<8|t[e]},CF=function(t,e){return t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3]};function Lu(t,e){var r="",n,i,o=[],c,u,h,p;switch(e){case"dbcs":if(p=this.l,wt&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*t).toString("utf16le");else for(h=0;h<t;++h)r+=String.fromCharCode(Ni(this,p)),p+=2;t*=2;break;case"utf8":r=bf(this,this.l,this.l+t);break;case"utf16le":t*=2,r=q1(this,this.l,this.l+t);break;case"wstr":return Lu.call(this,t,"dbcs");case"lpstr-ansi":r=SS(this,this.l),t=4+qn(this,this.l);break;case"lpstr-cp":r=RS(this,this.l),t=4+qn(this,this.l);break;case"lpwstr":r=bS(this,this.l),t=4+2*qn(this,this.l);break;case"lpp4":t=4+qn(this,this.l),r=DS(this,this.l),t&2&&(t+=2);break;case"8lpp4":t=4+qn(this,this.l),r=NS(this,this.l),t&3&&(t+=4-(t&3));break;case"cstr":for(t=0,r="";(c=Wl(this,this.l+t++))!==0;)o.push(a0(c));r=o.join("");break;case"_wstr":for(t=0,r="";(c=Ni(this,this.l+t))!==0;)o.push(a0(c)),t+=2;t+=2,r=o.join("");break;case"dbcs-cont":for(r="",p=this.l,h=0;h<t;++h){if(this.lens&&this.lens.indexOf(p)!==-1)return c=Wl(this,p),this.l=p+1,u=Lu.call(this,t-h,c?"dbcs-cont":"sbcs-cont"),o.join("")+u;o.push(a0(Ni(this,p))),p+=2}r=o.join(""),t*=2;break;case"cpstr":case"sbcs-cont":for(r="",p=this.l,h=0;h!=t;++h){if(this.lens&&this.lens.indexOf(p)!==-1)return c=Wl(this,p),this.l=p+1,u=Lu.call(this,t-h,c?"dbcs-cont":"sbcs-cont"),o.join("")+u;o.push(a0(Wl(this,p))),p+=1}r=o.join("");break;default:switch(t){case 1:return n=Wl(this,this.l),this.l++,n;case 2:return n=(e==="i"?SF:Ni)(this,this.l),this.l+=2,n;case 4:case-4:return e==="i"||(this[this.l+3]&128)===0?(n=(t>0?Co:CF)(this,this.l),this.l+=4,n):(i=qn(this,this.l),this.l+=4,i);case 8:case-8:if(e==="f")return t==8?i=Y0(this,this.l):i=Y0([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,i;t=8;case 16:r=AS(this,this.l,t);break}}return this.l+=t,r}var RF=function(t,e,r){t[r]=e&255,t[r+1]=e>>>8&255,t[r+2]=e>>>16&255,t[r+3]=e>>>24&255},kF=function(t,e,r){t[r]=e&255,t[r+1]=e>>8&255,t[r+2]=e>>16&255,t[r+3]=e>>24&255},bF=function(t,e,r){t[r]=e&255,t[r+1]=e>>>8&255};function IF(t,e,r){var n=0,i=0;if(r==="dbcs"){for(i=0;i!=e.length;++i)bF(this,e.charCodeAt(i),this.l+2*i);n=2*e.length}else if(r==="sbcs"){for(e=e.replace(/[^\x00-\x7F]/g,"_"),i=0;i!=e.length;++i)this[this.l+i]=e.charCodeAt(i)&255;n=e.length}else if(r==="hex"){for(;i<t;++i)this[this.l++]=parseInt(e.slice(2*i,2*i+2),16)||0;return this}else if(r==="utf16le"){var o=Math.min(this.l+t,this.length);for(i=0;i<Math.min(e.length,t);++i){var c=e.charCodeAt(i);this[this.l++]=c&255,this[this.l++]=c>>8}for(;this.l<o;)this[this.l++]=0;return this}else switch(t){case 1:n=1,this[this.l]=e&255;break;case 2:n=2,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255;break;case 3:n=3,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255,e>>>=8,this[this.l+2]=e&255;break;case 4:n=4,RF(this,e,this.l);break;case 8:if(n=8,r==="f"){wF(this,e,this.l);break}case 16:break;case-4:n=4,kF(this,e,this.l);break}return this.l+=n,this}function MS(t,e){var r=AS(this,this.l,t.length>>1);if(r!==t)throw new Error(e+"Expected "+t+" saw "+r);this.l+=t.length>>1}function Qr(t,e){t.l=e,t.read_shift=Lu,t.chk=MS,t.write_shift=IF}function mn(t,e){t.l+=e}function Nr(t){var e=Hs(t);return Qr(e,0),e}function Hi(t,e,r){if(t){var n,i,o;Qr(t,t.l||0);for(var c=t.length,u=0,h=0;t.l<c;){u=t.read_shift(1),u&128&&(u=(u&127)+((t.read_shift(1)&127)<<7));var p=td[u]||td[65535];for(n=t.read_shift(1),o=n&127,i=1;i<4&&n&128;++i)o+=((n=t.read_shift(1))&127)<<7*i;h=t.l+o;var g=p.f&&p.f(t,o,r);if(t.l=h,e(g,p,u))return}}}function bg(){var t=[],e=wt?256:2048,r=function(p){var g=Nr(p);return Qr(g,0),g},n=r(e),i=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&t.push(n),n=null)},o=function(p){return n&&p<n.length-n.l?n:(i(),n=r(Math.max(p+1,e)))},c=function(){return i(),ws(t)},u=function(p){i(),n=p,n.l==null&&(n.l=n.length),o(e)};return{next:o,push:u,end:c,_bufs:t}}function Vu(t,e,r){var n=en(t);if(e.s?(n.cRel&&(n.c+=e.s.c),n.rRel&&(n.r+=e.s.r)):(n.cRel&&(n.c+=e.c),n.rRel&&(n.r+=e.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function OT(t,e,r){var n=en(t);return n.s=Vu(n.s,e.s,r),n.e=Vu(n.e,e.s,r),n}function Uu(t,e){if(t.cRel&&t.c<0)for(t=en(t);t.c<0;)t.c+=e>8?16384:256;if(t.rRel&&t.r<0)for(t=en(t);t.r<0;)t.r+=e>8?1048576:e>5?65536:16384;var r=vt(t);return!t.cRel&&t.cRel!=null&&(r=NF(r)),!t.rRel&&t.rRel!=null&&(r=DF(r)),r}function Xm(t,e){return t.s.r==0&&!t.s.rRel&&t.e.r==(e.biff>=12?1048575:e.biff>=8?65536:16384)&&!t.e.rRel?(t.s.cRel?"":"$")+wn(t.s.c)+":"+(t.e.cRel?"":"$")+wn(t.e.c):t.s.c==0&&!t.s.cRel&&t.e.c==(e.biff>=12?16383:255)&&!t.e.cRel?(t.s.rRel?"":"$")+Xn(t.s.r)+":"+(t.e.rRel?"":"$")+Xn(t.e.r):Uu(t.s,e.biff)+":"+Uu(t.e,e.biff)}function LS(t){return parseInt(OF(t),10)-1}function Xn(t){return""+(t+1)}function DF(t){return t.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function OF(t){return t.replace(/\$(\d+)$/,"$1")}function VS(t){for(var e=FF(t),r=0,n=0;n!==e.length;++n)r=26*r+e.charCodeAt(n)-64;return r-1}function wn(t){if(t<0)throw new Error("invalid column "+t);var e="";for(++t;t;t=Math.floor((t-1)/26))e=String.fromCharCode((t-1)%26+65)+e;return e}function NF(t){return t.replace(/^([A-Z])/,"$$$1")}function FF(t){return t.replace(/^\$([A-Z])/,"$1")}function Ia(t){for(var e=0,r=0,n=0;n<t.length;++n){var i=t.charCodeAt(n);i>=48&&i<=57?e=10*e+(i-48):i>=65&&i<=90&&(r=26*r+(i-64))}return{c:r-1,r:e-1}}function vt(t){for(var e=t.c+1,r="";e;e=(e-1)/26|0)r=String.fromCharCode((e-1)%26+65)+r;return r+(t.r+1)}function K1(t){var e=t.indexOf(":");return e==-1?{s:Ia(t),e:Ia(t)}:{s:Ia(t.slice(0,e)),e:Ia(t.slice(e+1))}}function qt(t,e){return typeof e>"u"||typeof e=="number"?qt(t.s,t.e):(typeof t!="string"&&(t=vt(t)),typeof e!="string"&&(e=vt(e)),t==e?t:t+":"+e)}function qr(t){var e={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,i=0,o=t.length;for(r=0;n<o&&!((i=t.charCodeAt(n)-64)<1||i>26);++n)r=26*r+i;for(e.s.c=--r,r=0;n<o&&!((i=t.charCodeAt(n)-48)<0||i>9);++n)r=10*r+i;if(e.s.r=--r,n===o||i!=10)return e.e.c=e.s.c,e.e.r=e.s.r,e;for(++n,r=0;n!=o&&!((i=t.charCodeAt(n)-64)<1||i>26);++n)r=26*r+i;for(e.e.c=--r,r=0;n!=o&&!((i=t.charCodeAt(n)-48)<0||i>9);++n)r=10*r+i;return e.e.r=--r,e}function NT(t,e){var r=t.t=="d"&&e instanceof Date;if(t.z!=null)try{return t.w=ga(t.z,r?$n(e):e)}catch{}try{return t.w=ga((t.XF||{}).numFmtId||(r?14:0),r?$n(e):e)}catch{return""+e}}function uc(t,e,r){return t==null||t.t==null||t.t=="z"?"":t.w!==void 0?t.w:(t.t=="d"&&!t.z&&r&&r.dateNF&&(t.z=r.dateNF),t.t=="e"?el[t.v]||t.v:e==null?NT(t,t.v):NT(t,e))}function Qo(t,e){var r=e&&e.sheet?e.sheet:"Sheet1",n={};return n[r]=t,{SheetNames:[r],Sheets:n}}function PF(t,e,r){var n=r||{},i=t?Array.isArray(t):n.dense,o=t||(i?[]:{}),c=0,u=0;if(o&&n.origin!=null){if(typeof n.origin=="number")c=n.origin;else{var h=typeof n.origin=="string"?Ia(n.origin):n.origin;c=h.r,u=h.c}o["!ref"]||(o["!ref"]="A1:A1")}var p={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(o["!ref"]){var g=qr(o["!ref"]);p.s.c=g.s.c,p.s.r=g.s.r,p.e.c=Math.max(p.e.c,g.e.c),p.e.r=Math.max(p.e.r,g.e.r),c==-1&&(p.e.r=c=g.e.r+1)}for(var _=0;_!=e.length;++_)if(e[_]){if(!Array.isArray(e[_]))throw new Error("aoa_to_sheet expects an array of arrays");for(var x=0;x!=e[_].length;++x)if(!(typeof e[_][x]>"u")){var T={v:e[_][x]},w=c+_,S=u+x;if(p.s.r>w&&(p.s.r=w),p.s.c>S&&(p.s.c=S),p.e.r<w&&(p.e.r=w),p.e.c<S&&(p.e.c=S),e[_][x]&&typeof e[_][x]=="object"&&!Array.isArray(e[_][x])&&!(e[_][x]instanceof Date))T=e[_][x];else if(Array.isArray(T.v)&&(T.f=e[_][x][1],T.v=T.v[0]),T.v===null)if(T.f)T.t="n";else if(n.nullError)T.t="e",T.v=0;else if(n.sheetStubs)T.t="z";else continue;else typeof T.v=="number"?T.t="n":typeof T.v=="boolean"?T.t="b":T.v instanceof Date?(T.z=n.dateNF||ht[14],n.cellDates?(T.t="d",T.w=ga(T.z,$n(T.v))):(T.t="n",T.v=$n(T.v),T.w=ga(T.z,T.v))):T.t="s";if(i)o[w]||(o[w]=[]),o[w][S]&&o[w][S].z&&(T.z=o[w][S].z),o[w][S]=T;else{var C=vt({c:S,r:w});o[C]&&o[C].z&&(T.z=o[C].z),o[C]=T}}}return p.s.c<1e7&&(o["!ref"]=qt(p)),o}function If(t,e){return PF(null,t,e)}function MF(t){return t.read_shift(4,"i")}function dn(t){var e=t.read_shift(4);return e===0?"":t.read_shift(e,"dbcs")}function LF(t){return{ich:t.read_shift(2),ifnt:t.read_shift(2)}}function W1(t,e){var r=t.l,n=t.read_shift(1),i=dn(t),o=[],c={t:i,h:i};if((n&1)!==0){for(var u=t.read_shift(4),h=0;h!=u;++h)o.push(LF(t));c.r=o}else c.r=[{ich:0,ifnt:0}];return t.l=r+e,c}var VF=W1;function va(t){var e=t.read_shift(4),r=t.read_shift(2);return r+=t.read_shift(1)<<16,t.l++,{c:e,iStyleRef:r}}function Zo(t){var e=t.read_shift(2);return e+=t.read_shift(1)<<16,t.l++,{c:-1,iStyleRef:e}}var UF=dn;function X1(t){var e=t.read_shift(4);return e===0||e===4294967295?"":t.read_shift(e,"dbcs")}var BF=dn,Ig=X1;function Y1(t){var e=t.slice(t.l,t.l+4),r=e[0]&1,n=e[0]&2;t.l+=4;var i=n===0?Y0([0,0,0,0,e[0]&252,e[1],e[2],e[3]],0):Co(e,0)>>2;return r?i/100:i}function US(t){var e={s:{},e:{}};return e.s.r=t.read_shift(4),e.e.r=t.read_shift(4),e.s.c=t.read_shift(4),e.e.c=t.read_shift(4),e}var Jo=US;function fn(t){if(t.length-t.l<8)throw"XLS Xnum Buffer underflow";return t.read_shift(8,"f")}function jF(t){var e={},r=t.read_shift(1),n=r>>>1,i=t.read_shift(1),o=t.read_shift(2,"i"),c=t.read_shift(1),u=t.read_shift(1),h=t.read_shift(1);switch(t.l++,n){case 0:e.auto=1;break;case 1:e.index=i;var p=No[i];p&&(e.rgb=uf(p));break;case 2:e.rgb=uf([c,u,h]);break;case 3:e.theme=i;break}return o!=0&&(e.tint=o>0?o/32767:o/32768),e}function zF(t){var e=t.read_shift(1);t.l++;var r={fBold:e&1,fItalic:e&2,fUnderline:e&4,fStrikeout:e&8,fOutline:e&16,fShadow:e&32,fCondense:e&64,fExtend:e&128};return r}function BS(t,e){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=t.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return r[t.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return t.l-=4,t.read_shift(0,e==1?"lpstr":"lpwstr")}function HF(t){return BS(t,1)}function GF(t){return BS(t,2)}var $1=2,On=3,s0=11,FT=12,$0=19,o0=64,qF=65,KF=71,WF=4108,XF=4126,Gr=80,jS=81,YF=[Gr,jS],$F={1:{n:"CodePage",t:$1},2:{n:"Category",t:Gr},3:{n:"PresentationFormat",t:Gr},4:{n:"ByteCount",t:On},5:{n:"LineCount",t:On},6:{n:"ParagraphCount",t:On},7:{n:"SlideCount",t:On},8:{n:"NoteCount",t:On},9:{n:"HiddenCount",t:On},10:{n:"MultimediaClipCount",t:On},11:{n:"ScaleCrop",t:s0},12:{n:"HeadingPairs",t:WF},13:{n:"TitlesOfParts",t:XF},14:{n:"Manager",t:Gr},15:{n:"Company",t:Gr},16:{n:"LinksUpToDate",t:s0},17:{n:"CharacterCount",t:On},19:{n:"SharedDoc",t:s0},22:{n:"HyperlinksChanged",t:s0},23:{n:"AppVersion",t:On,p:"version"},24:{n:"DigSig",t:qF},26:{n:"ContentType",t:Gr},27:{n:"ContentStatus",t:Gr},28:{n:"Language",t:Gr},29:{n:"Version",t:Gr},255:{},2147483648:{n:"Locale",t:$0},2147483651:{n:"Behavior",t:$0},1919054434:{}},QF={1:{n:"CodePage",t:$1},2:{n:"Title",t:Gr},3:{n:"Subject",t:Gr},4:{n:"Author",t:Gr},5:{n:"Keywords",t:Gr},6:{n:"Comments",t:Gr},7:{n:"Template",t:Gr},8:{n:"LastAuthor",t:Gr},9:{n:"RevNumber",t:Gr},10:{n:"EditTime",t:o0},11:{n:"LastPrinted",t:o0},12:{n:"CreatedDate",t:o0},13:{n:"ModifiedDate",t:o0},14:{n:"PageCount",t:On},15:{n:"WordCount",t:On},16:{n:"CharCount",t:On},17:{n:"Thumbnail",t:KF},18:{n:"Application",t:Gr},19:{n:"DocSecurity",t:On},255:{},2147483648:{n:"Locale",t:$0},2147483651:{n:"Behavior",t:$0},1919054434:{}},PT={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},ZF=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function JF(t){return t.map(function(e){return[e>>16&255,e>>8&255,e&255]})}var e8=JF([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),No=en(e8),el={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},zS={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},MT={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"};function t8(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function r8(t){var e=t8();if(!t||!t.match)return e;var r={};if((t.match(gn)||[]).forEach(function(n){var i=st(n);switch(i[0].replace(hF,"<")){case"<?xml":break;case"<Types":e.xmlns=i["xmlns"+(i[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[i.Extension]=i.ContentType;break;case"<Override":e[MT[i.ContentType]]!==void 0&&e[MT[i.ContentType]].push(i.PartName);break}}),e.xmlns!==EF.CT)throw new Error("Unknown Namespace: "+e.xmlns);return e.calcchain=e.calcchains.length>0?e.calcchains[0]:"",e.sst=e.strs.length>0?e.strs[0]:"",e.style=e.styles.length>0?e.styles[0]:"",e.defaults=r,delete e.calcchains,e}var Xl={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function Dg(t){var e=t.lastIndexOf("/");return t.slice(0,e+1)+"_rels/"+t.slice(e+1)+".rels"}function Bu(t,e){var r={"!id":{}};if(!t)return r;e.charAt(0)!=="/"&&(e="/"+e);var n={};return(t.match(gn)||[]).forEach(function(i){var o=st(i);if(o[0]==="<Relationship"){var c={};c.Type=o.Type,c.Target=o.Target,c.Id=o.Id,o.TargetMode&&(c.TargetMode=o.TargetMode);var u=o.TargetMode==="External"?o.Target:bu(o.Target,e);r[u]=c,n[o.Id]=c}}),r["!id"]=n,r}var n8="application/vnd.oasis.opendocument.spreadsheet";function a8(t,e){for(var r=G1(t),n,i;n=lf.exec(r);)switch(n[3]){case"manifest":break;case"file-entry":if(i=st(n[0],!1),i.path=="/"&&i.type!==n8)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(e&&e.WTF)throw n}}var ju=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],i8=function(){for(var t=new Array(ju.length),e=0;e<ju.length;++e){var r=ju[e],n="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);t[e]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return t}();function HS(t){var e={};t=Jt(t);for(var r=0;r<ju.length;++r){var n=ju[r],i=t.match(i8[r]);i!=null&&i.length>0&&(e[n[1]]=Nt(i[1])),n[2]==="date"&&e[n[1]]&&(e[n[1]]=Jr(e[n[1]]))}return e}var s8=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]];function GS(t,e,r,n){var i=[];if(typeof t=="string")i=CT(t,n);else for(var o=0;o<t.length;++o)i=i.concat(t[o].map(function(g){return{v:g}}));var c=typeof e=="string"?CT(e,n).map(function(g){return g.v}):e,u=0,h=0;if(c.length>0)for(var p=0;p!==i.length;p+=2){switch(h=+i[p+1].v,i[p].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":r.Worksheets=h,r.SheetNames=c.slice(u,u+h);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":r.NamedRanges=h,r.DefinedNames=c.slice(u,u+h);break;case"Charts":case"Diagramme":r.Chartsheets=h,r.ChartNames=c.slice(u,u+h);break}u+=h}}function o8(t,e,r){var n={};return e||(e={}),t=Jt(t),s8.forEach(function(i){var o=(t.match(of(i[0]))||[])[1];switch(i[2]){case"string":o&&(e[i[1]]=Nt(o));break;case"bool":e[i[1]]=o==="true";break;case"raw":var c=t.match(new RegExp("<"+i[0]+"[^>]*>([\\s\\S]*?)</"+i[0]+">"));c&&c.length>0&&(n[i[1]]=c[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&GS(n.HeadingPairs,n.TitlesOfParts,e,r),e}var l8=/<[^>]+>[^<]*/g;function c8(t,e){var r={},n="",i=t.match(l8);if(i)for(var o=0;o!=i.length;++o){var c=i[o],u=st(c);switch(u[0]){case"<?xml":break;case"<Properties":break;case"<property":n=Nt(u.name);break;case"</property>":n=null;break;default:if(c.indexOf("<vt:")===0){var h=c.split(">"),p=h[0].slice(4),g=h[1];switch(p){case"lpstr":case"bstr":case"lpwstr":r[n]=Nt(g);break;case"bool":r[n]=ir(g);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[n]=parseInt(g,10);break;case"r4":case"r8":case"decimal":r[n]=parseFloat(g);break;case"filetime":case"date":r[n]=Jr(g);break;case"cy":case"error":r[n]=Nt(g);break;default:if(p.slice(-1)=="/")break;e.WTF&&typeof console<"u"&&console.warn("Unexpected",c,p,h)}}else if(c.slice(0,2)!=="</"){if(e.WTF)throw new Error(c)}}}return r}var u8={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},Ym;function f8(t,e,r){Ym||(Ym=z1(u8)),e=Ym[e]||e,t[e]=r}function Q1(t){var e=t.read_shift(4),r=t.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+e/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function qS(t,e,r){var n=t.l,i=t.read_shift(0,"lpstr-cp");if(r)for(;t.l-n&3;)++t.l;return i}function KS(t,e,r){var n=t.read_shift(0,"lpwstr");return n}function WS(t,e,r){return e===31?KS(t):qS(t,e,r)}function Og(t,e,r){return WS(t,e,r===!1?0:4)}function h8(t,e){if(!e)throw new Error("VtUnalignedString must have positive length");return WS(t,e,0)}function d8(t){for(var e=t.read_shift(4),r=[],n=0;n!=e;++n){var i=t.l;r[n]=t.read_shift(0,"lpwstr").replace(Sn,""),t.l-i&2&&(t.l+=2)}return r}function p8(t){for(var e=t.read_shift(4),r=[],n=0;n!=e;++n)r[n]=t.read_shift(0,"lpstr-cp").replace(Sn,"");return r}function m8(t){var e=t.l,r=Q0(t,jS);t[t.l]==0&&t[t.l+1]==0&&t.l-e&2&&(t.l+=2);var n=Q0(t,On);return[r,n]}function g8(t){for(var e=t.read_shift(4),r=[],n=0;n<e/2;++n)r.push(m8(t));return r}function LT(t,e){for(var r=t.read_shift(4),n={},i=0;i!=r;++i){var o=t.read_shift(4),c=t.read_shift(4);n[o]=t.read_shift(c,e===1200?"utf16le":"utf8").replace(Sn,"").replace(ku,"!"),e===1200&&c%2&&(t.l+=2)}return t.l&3&&(t.l=t.l>>3<<2),n}function XS(t){var e=t.read_shift(4),r=t.slice(t.l,t.l+e);return t.l+=e,(e&3)>0&&(t.l+=4-(e&3)&3),r}function v8(t){var e={};return e.Size=t.read_shift(4),t.l+=e.Size+3-(e.Size-1)%4,e}function Q0(t,e,r){var n=t.read_shift(2),i,o=r||{};if(t.l+=2,e!==FT&&n!==e&&YF.indexOf(e)===-1&&!((e&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+e+" saw "+n);switch(e===FT?n:e){case 2:return i=t.read_shift(2,"i"),o.raw||(t.l+=2),i;case 3:return i=t.read_shift(4,"i"),i;case 11:return t.read_shift(4)!==0;case 19:return i=t.read_shift(4),i;case 30:return qS(t,n,4).replace(Sn,"");case 31:return KS(t);case 64:return Q1(t);case 65:return XS(t);case 71:return v8(t);case 80:return Og(t,n,!o.raw).replace(Sn,"");case 81:return h8(t,n).replace(Sn,"");case 4108:return g8(t);case 4126:case 4127:return n==4127?d8(t):p8(t);default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+n)}}function VT(t,e){var r=t.l,n=t.read_shift(4),i=t.read_shift(4),o=[],c=0,u=0,h=-1,p={};for(c=0;c!=i;++c){var g=t.read_shift(4),_=t.read_shift(4);o[c]=[g,_+r]}o.sort(function(Y,L){return Y[1]-L[1]});var x={};for(c=0;c!=i;++c){if(t.l!==o[c][1]){var T=!0;if(c>0&&e)switch(e[o[c-1][0]].t){case 2:t.l+2===o[c][1]&&(t.l+=2,T=!1);break;case 80:t.l<=o[c][1]&&(t.l=o[c][1],T=!1);break;case 4108:t.l<=o[c][1]&&(t.l=o[c][1],T=!1);break}if((!e||c==0)&&t.l<=o[c][1]&&(T=!1,t.l=o[c][1]),T)throw new Error("Read Error: Expected address "+o[c][1]+" at "+t.l+" :"+c)}if(e){var w=e[o[c][0]];if(x[w.n]=Q0(t,w.t,{raw:!0}),w.p==="version"&&(x[w.n]=String(x[w.n]>>16)+"."+("0000"+String(x[w.n]&65535)).slice(-4)),w.n=="CodePage")switch(x[w.n]){case 0:x[w.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:ka(u=x[w.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+x[w.n])}}else if(o[c][0]===1){if(u=x.CodePage=Q0(t,$1),ka(u),h!==-1){var S=t.l;t.l=o[h][1],p=LT(t,u),t.l=S}}else if(o[c][0]===0){if(u===0){h=c,t.l=o[c+1][1];continue}p=LT(t,u)}else{var C=p[o[c][0]],z;switch(t[t.l]){case 65:t.l+=4,z=XS(t);break;case 30:t.l+=4,z=Og(t,t[t.l-4]).replace(/\u0000+$/,"");break;case 31:t.l+=4,z=Og(t,t[t.l-4]).replace(/\u0000+$/,"");break;case 3:t.l+=4,z=t.read_shift(4,"i");break;case 19:t.l+=4,z=t.read_shift(4);break;case 5:t.l+=4,z=t.read_shift(8,"f");break;case 11:t.l+=4,z=gr(t,4);break;case 64:t.l+=4,z=Jr(Q1(t));break;default:throw new Error("unparsed value: "+t[t.l])}x[C]=z}}return t.l=r+n,x}function UT(t,e,r){var n=t.content;if(!n)return{};Qr(n,0);var i,o,c,u,h=0;n.chk("feff","Byte Order: "),n.read_shift(2);var p=n.read_shift(4),g=n.read_shift(16);if(g!==Dt.utils.consts.HEADER_CLSID&&g!==r)throw new Error("Bad PropertySet CLSID "+g);if(i=n.read_shift(4),i!==1&&i!==2)throw new Error("Unrecognized #Sets: "+i);if(o=n.read_shift(16),u=n.read_shift(4),i===1&&u!==n.l)throw new Error("Length mismatch: "+u+" !== "+n.l);i===2&&(c=n.read_shift(16),h=n.read_shift(4));var _=VT(n,e),x={SystemIdentifier:p};for(var T in _)x[T]=_[T];if(x.FMTID=o,i===1)return x;if(h-n.l==2&&(n.l+=2),n.l!==h)throw new Error("Length mismatch 2: "+n.l+" !== "+h);var w;try{w=VT(n,null)}catch{}for(T in w)x[T]=w[T];return x.FMTID=[o,c],x}function xs(t,e){return t.read_shift(e),null}function _8(t,e,r){for(var n=[],i=t.l+e;t.l<i;)n.push(r(t,i-t.l));if(i!==t.l)throw new Error("Slurp error");return n}function gr(t,e){return t.read_shift(e)===1}function Sr(t){return t.read_shift(2,"u")}function YS(t,e){return _8(t,e,Sr)}function x8(t){var e=t.read_shift(1),r=t.read_shift(1);return r===1?e:e===1}function Df(t,e,r){var n=t.read_shift(r&&r.biff>=12?2:1),i="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var o=t.read_shift(1);o&&(i="dbcs-cont")}else r.biff==12&&(i="wstr");r.biff>=2&&r.biff<=5&&(i="cpstr");var c=n?t.read_shift(n,i):"";return c}function y8(t){var e=t.read_shift(2),r=t.read_shift(1),n=r&4,i=r&8,o=1+(r&1),c=0,u,h={};i&&(c=t.read_shift(2)),n&&(u=t.read_shift(4));var p=o==2?"dbcs-cont":"sbcs-cont",g=e===0?"":t.read_shift(e,p);return i&&(t.l+=4*c),n&&(t.l+=u),h.t=g,i||(h.raw="<t>"+h.t+"</t>",h.r=h.t),h}function jo(t,e,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return t.read_shift(e,"cpstr");if(r.biff>=12)return t.read_shift(e,"dbcs-cont")}var i=t.read_shift(1);return i===0?n=t.read_shift(e,"sbcs-cont"):n=t.read_shift(e,"dbcs-cont"),n}function Of(t,e,r){var n=t.read_shift(r&&r.biff==2?1:2);return n===0?(t.l++,""):jo(t,n,r)}function tl(t,e,r){if(r.biff>5)return Of(t,e,r);var n=t.read_shift(1);return n===0?(t.l++,""):t.read_shift(n,r.biff<=4||!t.lens?"cpstr":"sbcs-cont")}function E8(t){var e=t.read_shift(1);t.l++;var r=t.read_shift(2);return t.l+=2,[e,r]}function T8(t){var e=t.read_shift(4),r=t.l,n=!1;e>24&&(t.l+=e-24,t.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),t.l=r);var i=t.read_shift((n?e-24:e)>>1,"utf16le").replace(Sn,"");return n&&(t.l+=24),i}function A8(t){for(var e=t.read_shift(2),r="";e-- >0;)r+="../";var n=t.read_shift(0,"lpstr-ansi");if(t.l+=2,t.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var i=t.read_shift(4);if(i===0)return r+n.replace(/\\/g,"/");var o=t.read_shift(4);if(t.read_shift(2)!=3)throw new Error("Bad FileMoniker");var c=t.read_shift(o>>1,"utf16le").replace(Sn,"");return r+c}function w8(t,e){var r=t.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return T8(t);case"0303000000000000c000000000000046":return A8(t);default:throw new Error("Unsupported Moniker "+r)}}function l0(t){var e=t.read_shift(4),r=e>0?t.read_shift(e,"utf16le").replace(Sn,""):"";return r}function S8(t,e){var r=t.l+e,n=t.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var i=t.read_shift(2);t.l+=2;var o,c,u,h,p="",g,_;i&16&&(o=l0(t,r-t.l)),i&128&&(c=l0(t,r-t.l)),(i&257)===257&&(u=l0(t,r-t.l)),(i&257)===1&&(h=w8(t,r-t.l)),i&8&&(p=l0(t,r-t.l)),i&32&&(g=t.read_shift(16)),i&64&&(_=Q1(t)),t.l=r;var x=c||u||h||"";x&&p&&(x+="#"+p),x||(x="#"+p),i&2&&x.charAt(0)=="/"&&x.charAt(1)!="/"&&(x="file://"+x);var T={Target:x};return g&&(T.guid=g),_&&(T.time=_),o&&(T.Tooltip=o),T}function $S(t){var e=t.read_shift(1),r=t.read_shift(1),n=t.read_shift(1),i=t.read_shift(1);return[e,r,n,i]}function QS(t,e){var r=$S(t);return r[3]=0,r}function li(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2);return{r:e,c:r,ixfe:n}}function C8(t){var e=t.read_shift(2),r=t.read_shift(2);return t.l+=8,{type:e,flags:r}}function R8(t,e,r){return e===0?"":tl(t,e,r)}function k8(t,e,r){var n=r.biff>8?4:2,i=t.read_shift(n),o=t.read_shift(n,"i"),c=t.read_shift(n,"i");return[i,o,c]}function ZS(t){var e=t.read_shift(2),r=Y1(t);return[e,r]}function b8(t,e,r){t.l+=4,e-=4;var n=t.l+e,i=Df(t,e,r),o=t.read_shift(2);if(n-=t.l,o!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+o);return t.l+=o,i}function kd(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2),i=t.read_shift(2);return{s:{c:n,r:e},e:{c:i,r}}}function JS(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(1),i=t.read_shift(1);return{s:{c:n,r:e},e:{c:i,r}}}var I8=JS;function e4(t){t.l+=4;var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2);return t.l+=12,[r,e,n]}function D8(t){var e={};return t.l+=4,t.l+=16,e.fSharedNote=t.read_shift(2),t.l+=4,e}function O8(t){var e={};return t.l+=4,t.cf=t.read_shift(2),e}function on(t){t.l+=2,t.l+=t.read_shift(2)}var N8={0:on,4:on,5:on,6:on,7:O8,8:on,9:on,10:on,11:on,12:on,13:D8,14:on,15:on,16:on,17:on,18:on,19:on,20:on,21:e4};function F8(t,e){for(var r=t.l+e,n=[];t.l<r;){var i=t.read_shift(2);t.l-=2;try{n.push(N8[i](t,r-t.l))}catch{return t.l=r,n}}return t.l!=r&&(t.l=r),n}function c0(t,e){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=t.read_shift(2),e-=2,e>=2&&(r.dt=t.read_shift(2),t.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(e>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return t.read_shift(e),r}function P8(t,e){return e===0||t.read_shift(2),1200}function M8(t,e,r){if(r.enc)return t.l+=e,"";var n=t.l,i=tl(t,0,r);return t.read_shift(e+n-t.l),i}function L8(t,e,r){var n=r&&r.biff==8||e==2?t.read_shift(2):(t.l+=e,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function V8(t,e,r){var n=t.read_shift(4),i=t.read_shift(1)&3,o=t.read_shift(1);switch(o){case 0:o="Worksheet";break;case 1:o="Macrosheet";break;case 2:o="Chartsheet";break;case 6:o="VBAModule";break}var c=Df(t,0,r);return c.length===0&&(c="Sheet1"),{pos:n,hs:i,dt:o,name:c}}function U8(t,e){for(var r=t.l+e,n=t.read_shift(4),i=t.read_shift(4),o=[],c=0;c!=i&&t.l<r;++c)o.push(y8(t));return o.Count=n,o.Unique=i,o}function B8(t,e){var r={};return r.dsst=t.read_shift(2),t.l+=e-2,r}function j8(t){var e={};e.r=t.read_shift(2),e.c=t.read_shift(2),e.cnt=t.read_shift(2)-e.c;var r=t.read_shift(2);t.l+=4;var n=t.read_shift(1);return t.l+=3,n&7&&(e.level=n&7),n&32&&(e.hidden=!0),n&64&&(e.hpt=r/20),e}function z8(t){var e=C8(t);if(e.type!=2211)throw new Error("Invalid Future Record "+e.type);var r=t.read_shift(4);return r!==0}function H8(t){return t.read_shift(2),t.read_shift(4)}function BT(t,e,r){var n=0;r&&r.biff==2||(n=t.read_shift(2));var i=t.read_shift(2);r&&r.biff==2&&(n=1-(i>>15),i&=32767);var o={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[o,i]}function G8(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2),i=t.read_shift(2),o=t.read_shift(2),c=t.read_shift(2),u=t.read_shift(2),h=t.read_shift(2),p=t.read_shift(2);return{Pos:[e,r],Dim:[n,i],Flags:o,CurTab:c,FirstTab:u,Selected:h,TabRatio:p}}function q8(t,e,r){if(r&&r.biff>=2&&r.biff<5)return{};var n=t.read_shift(2);return{RTL:n&64}}function K8(){}function W8(t,e,r){var n={dyHeight:t.read_shift(2),fl:t.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:t.l+=2;break;default:t.l+=10;break}return n.name=Df(t,0,r),n}function X8(t){var e=li(t);return e.isst=t.read_shift(4),e}function Y8(t,e,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=t.l+e,i=li(t);r.biff==2&&t.l++;var o=Of(t,n-t.l,r);return i.val=o,i}function $8(t,e,r){var n=t.read_shift(2),i=tl(t,0,r);return[n,i]}var Q8=tl;function jT(t,e,r){var n=t.l+e,i=r.biff==8||!r.biff?4:2,o=t.read_shift(i),c=t.read_shift(i),u=t.read_shift(2),h=t.read_shift(2);return t.l=n,{s:{r:o,c:u},e:{r:c,c:h}}}function Z8(t){var e=t.read_shift(2),r=t.read_shift(2),n=ZS(t);return{r:e,c:r,ixfe:n[0],rknum:n[1]}}function J8(t,e){for(var r=t.l+e-2,n=t.read_shift(2),i=t.read_shift(2),o=[];t.l<r;)o.push(ZS(t));if(t.l!==r)throw new Error("MulRK read error");var c=t.read_shift(2);if(o.length!=c-i+1)throw new Error("MulRK length mismatch");return{r:n,c:i,C:c,rkrec:o}}function eP(t,e){for(var r=t.l+e-2,n=t.read_shift(2),i=t.read_shift(2),o=[];t.l<r;)o.push(t.read_shift(2));if(t.l!==r)throw new Error("MulBlank read error");var c=t.read_shift(2);if(o.length!=c-i+1)throw new Error("MulBlank length mismatch");return{r:n,c:i,C:c,ixfe:o}}function tP(t,e,r,n){var i={},o=t.read_shift(4),c=t.read_shift(4),u=t.read_shift(4),h=t.read_shift(2);return i.patternType=ZF[u>>26],n.cellStyles&&(i.alc=o&7,i.fWrap=o>>3&1,i.alcV=o>>4&7,i.fJustLast=o>>7&1,i.trot=o>>8&255,i.cIndent=o>>16&15,i.fShrinkToFit=o>>20&1,i.iReadOrder=o>>22&2,i.fAtrNum=o>>26&1,i.fAtrFnt=o>>27&1,i.fAtrAlc=o>>28&1,i.fAtrBdr=o>>29&1,i.fAtrPat=o>>30&1,i.fAtrProt=o>>31&1,i.dgLeft=c&15,i.dgRight=c>>4&15,i.dgTop=c>>8&15,i.dgBottom=c>>12&15,i.icvLeft=c>>16&127,i.icvRight=c>>23&127,i.grbitDiag=c>>30&3,i.icvTop=u&127,i.icvBottom=u>>7&127,i.icvDiag=u>>14&127,i.dgDiag=u>>21&15,i.icvFore=h&127,i.icvBack=h>>7&127,i.fsxButton=h>>14&1),i}function rP(t,e,r){var n={};return n.ifnt=t.read_shift(2),n.numFmtId=t.read_shift(2),n.flags=t.read_shift(2),n.fStyle=n.flags>>2&1,e-=6,n.data=tP(t,e,n.fStyle,r),n}function nP(t){t.l+=4;var e=[t.read_shift(2),t.read_shift(2)];if(e[0]!==0&&e[0]--,e[1]!==0&&e[1]--,e[0]>7||e[1]>7)throw new Error("Bad Gutters: "+e.join("|"));return e}function zT(t,e,r){var n=li(t);(r.biff==2||e==9)&&++t.l;var i=x8(t);return n.val=i,n.t=i===!0||i===!1?"b":"e",n}function aP(t,e,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=li(t),i=fn(t);return n.val=i,n}var HT=R8;function iP(t,e,r){var n=t.l+e,i=t.read_shift(2),o=t.read_shift(2);if(r.sbcch=o,o==1025||o==14849)return[o,i];if(o<1||o>255)throw new Error("Unexpected SupBook type: "+o);for(var c=jo(t,o),u=[];n>t.l;)u.push(Of(t));return[o,i,c,u]}function GT(t,e,r){var n=t.read_shift(2),i,o={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return r.sbcch===14849&&(i=b8(t,e-2,r)),o.body=i||t.read_shift(e-2),typeof i=="string"&&(o.Name=i),o}var sP=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function qT(t,e,r){var n=t.l+e,i=t.read_shift(2),o=t.read_shift(1),c=t.read_shift(1),u=t.read_shift(r&&r.biff==2?1:2),h=0;(!r||r.biff>=5)&&(r.biff!=5&&(t.l+=2),h=t.read_shift(2),r.biff==5&&(t.l+=2),t.l+=4);var p=jo(t,c,r);i&32&&(p=sP[p.charCodeAt(0)]);var g=n-t.l;r&&r.biff==2&&--g;var _=n==t.l||u===0||!(g>0)?[]:j9(t,g,r,u);return{chKey:o,Name:p,itab:h,rgce:_}}function t4(t,e,r){if(r.biff<8)return oP(t,e,r);for(var n=[],i=t.l+e,o=t.read_shift(r.biff>8?4:2);o--!==0;)n.push(k8(t,r.biff>8?12:6,r));if(t.l!=i)throw new Error("Bad ExternSheet: "+t.l+" != "+i);return n}function oP(t,e,r){t[t.l+1]==3&&t[t.l]++;var n=Df(t,e,r);return n.charCodeAt(0)==3?n.slice(1):n}function lP(t,e,r){if(r.biff<8){t.l+=e;return}var n=t.read_shift(2),i=t.read_shift(2),o=jo(t,n,r),c=jo(t,i,r);return[o,c]}function cP(t,e,r){var n=JS(t);t.l++;var i=t.read_shift(1);return e-=8,[z9(t,e,r),i,n]}function KT(t,e,r){var n=I8(t);switch(r.biff){case 2:t.l++,e-=7;break;case 3:case 4:t.l+=2,e-=8;break;default:t.l+=6,e-=12}return[n,U9(t,e,r)]}function uP(t){var e=t.read_shift(4)!==0,r=t.read_shift(4)!==0,n=t.read_shift(4);return[e,r,n]}function fP(t,e,r){if(!(r.biff<8)){var n=t.read_shift(2),i=t.read_shift(2),o=t.read_shift(2),c=t.read_shift(2),u=tl(t,0,r);return r.biff<8&&t.read_shift(1),[{r:n,c:i},u,c,o]}}function hP(t,e,r){return fP(t,e,r)}function dP(t,e){for(var r=[],n=t.read_shift(2);n--;)r.push(kd(t));return r}function pP(t,e,r){if(r&&r.biff<8)return gP(t,e,r);var n=e4(t),i=F8(t,e-22,n[1]);return{cmo:n,ft:i}}var mP={8:function(t,e){var r=t.l+e;t.l+=10;var n=t.read_shift(2);t.l+=4,t.l+=2,t.l+=2,t.l+=2,t.l+=4;var i=t.read_shift(1);return t.l+=i,t.l=r,{fmt:n}}};function gP(t,e,r){t.l+=4;var n=t.read_shift(2),i=t.read_shift(2),o=t.read_shift(2);t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=6,e-=36;var c=[];return c.push((mP[n]||mn)(t,e,r)),{cmo:[i,n,o],ft:c}}function vP(t,e,r){var n=t.l,i="";try{t.l+=4;var o=(r.lastobj||{cmo:[0,0]}).cmo[1],c;[0,5,7,11,12,14].indexOf(o)==-1?t.l+=6:c=E8(t,6,r);var u=t.read_shift(2);t.read_shift(2),Sr(t,2);var h=t.read_shift(2);t.l+=h;for(var p=1;p<t.lens.length-1;++p){if(t.l-n!=t.lens[p])throw new Error("TxO: bad continue record");var g=t[t.l],_=jo(t,t.lens[p+1]-t.lens[p]-1);if(i+=_,i.length>=(g?u:2*u))break}if(i.length!==u&&i.length!==u*2)throw new Error("cchText: "+u+" != "+i.length);return t.l=n+e,{t:i}}catch{return t.l=n+e,{t:i}}}function _P(t,e){var r=kd(t);t.l+=16;var n=S8(t,e-24);return[r,n]}function xP(t,e){t.read_shift(2);var r=kd(t),n=t.read_shift((e-10)/2,"dbcs-cont");return n=n.replace(Sn,""),[r,n]}function yP(t){var e=[0,0],r;return r=t.read_shift(2),e[0]=PT[r]||r,r=t.read_shift(2),e[1]=PT[r]||r,e}function EP(t){for(var e=t.read_shift(2),r=[];e-- >0;)r.push(QS(t));return r}function TP(t){for(var e=t.read_shift(2),r=[];e-- >0;)r.push(QS(t));return r}function AP(t){t.l+=2;var e={cxfs:0,crc:0};return e.cxfs=t.read_shift(2),e.crc=t.read_shift(4),e}function r4(t,e,r){if(!r.cellStyles)return mn(t,e);var n=r&&r.biff>=12?4:2,i=t.read_shift(n),o=t.read_shift(n),c=t.read_shift(n),u=t.read_shift(n),h=t.read_shift(2);n==2&&(t.l+=2);var p={s:i,e:o,w:c,ixfe:u,flags:h};return(r.biff>=5||!r.biff)&&(p.level=h>>8&7),p}function wP(t,e){var r={};return e<32||(t.l+=16,r.header=fn(t),r.footer=fn(t),t.l+=2),r}function SP(t,e,r){var n={area:!1};if(r.biff!=5)return t.l+=e,n;var i=t.read_shift(1);return t.l+=3,i&16&&(n.area=!0),n}var CP=li,RP=YS,kP=Of;function bP(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(4),i={fmt:e,env:r,len:n,data:t.slice(t.l,t.l+n)};return t.l+=n,i}function IP(t,e,r){r.biffguess&&r.biff==5&&(r.biff=2);var n=li(t);++t.l;var i=tl(t,e-7,r);return n.t="str",n.val=i,n}function DP(t){var e=li(t);++t.l;var r=fn(t);return e.t="n",e.val=r,e}function OP(t){var e=li(t);++t.l;var r=t.read_shift(2);return e.t="n",e.val=r,e}function NP(t){var e=t.read_shift(1);return e===0?(t.l++,""):t.read_shift(e,"sbcs-cont")}function FP(t,e){t.l+=6,t.l+=2,t.l+=1,t.l+=3,t.l+=1,t.l+=e-13}function PP(t,e,r){var n=t.l+e,i=li(t),o=t.read_shift(2),c=jo(t,o,r);return t.l=n,i.t="str",i.val=c,i}var MP=[2,3,48,49,131,139,140,245],WT=function(){var t={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},e=z1({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(u,h){var p=[],g=Hs(1);switch(h.type){case"base64":g=Ca(Yn(u));break;case"binary":g=Ca(u);break;case"buffer":case"array":g=u;break}Qr(g,0);var _=g.read_shift(1),x=!!(_&136),T=!1,w=!1;switch(_){case 2:break;case 3:break;case 48:T=!0,x=!0;break;case 49:T=!0,x=!0;break;case 131:break;case 139:break;case 140:w=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+_.toString(16))}var S=0,C=521;_==2&&(S=g.read_shift(2)),g.l+=3,_!=2&&(S=g.read_shift(4)),S>1048576&&(S=1e6),_!=2&&(C=g.read_shift(2));var z=g.read_shift(2),Y=h.codepage||1252;_!=2&&(g.l+=16,g.read_shift(1),g[g.l]!==0&&(Y=t[g[g.l]]),g.l+=1,g.l+=2),w&&(g.l+=36);for(var L=[],K={},Z=Math.min(g.length,_==2?521:C-10-(T?264:0)),re=w?32:11;g.l<Z&&g[g.l]!=13;)switch(K={},K.name=nf.utils.decode(Y,g.slice(g.l,g.l+re)).replace(/[\u0000\r\n].*$/g,""),g.l+=re,K.type=String.fromCharCode(g.read_shift(1)),_!=2&&!w&&(K.offset=g.read_shift(4)),K.len=g.read_shift(1),_==2&&(K.offset=g.read_shift(2)),K.dec=g.read_shift(1),K.name.length&&L.push(K),_!=2&&(g.l+=w?13:14),K.type){case"B":(!T||K.len!=8)&&h.WTF&&console.log("Skipping "+K.name+":"+K.type);break;case"G":case"P":h.WTF&&console.log("Skipping "+K.name+":"+K.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+K.type)}if(g[g.l]!==13&&(g.l=C-1),g.read_shift(1)!==13)throw new Error("DBF Terminator not found "+g.l+" "+g[g.l]);g.l=C;var k=0,A=0;for(p[0]=[],A=0;A!=L.length;++A)p[0][A]=L[A].name;for(;S-- >0;){if(g[g.l]===42){g.l+=z;continue}for(++g.l,p[++k]=[],A=0,A=0;A!=L.length;++A){var E=g.slice(g.l,g.l+L[A].len);g.l+=L[A].len,Qr(E,0);var I=nf.utils.decode(Y,E);switch(L[A].type){case"C":I.trim().length&&(p[k][A]=I.replace(/\s+$/,""));break;case"D":I.length===8?p[k][A]=new Date(+I.slice(0,4),+I.slice(4,6)-1,+I.slice(6,8)):p[k][A]=I;break;case"F":p[k][A]=parseFloat(I.trim());break;case"+":case"I":p[k][A]=w?E.read_shift(-4,"i")^2147483648:E.read_shift(4,"i");break;case"L":switch(I.trim().toUpperCase()){case"Y":case"T":p[k][A]=!0;break;case"N":case"F":p[k][A]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+I+"|")}break;case"M":if(!x)throw new Error("DBF Unexpected MEMO for type "+_.toString(16));p[k][A]="##MEMO##"+(w?parseInt(I.trim(),10):E.read_shift(4));break;case"N":I=I.replace(/\u0000/g,"").trim(),I&&I!="."&&(p[k][A]=+I||0);break;case"@":p[k][A]=new Date(E.read_shift(-8,"f")-621356832e5);break;case"T":p[k][A]=new Date((E.read_shift(4)-2440588)*864e5+E.read_shift(4));break;case"Y":p[k][A]=E.read_shift(4,"i")/1e4+E.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":p[k][A]=-E.read_shift(-8,"f");break;case"B":if(T&&L[A].len==8){p[k][A]=E.read_shift(8,"f");break}case"G":case"P":E.l+=L[A].len;break;case"0":if(L[A].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+L[A].type)}}}if(_!=2&&g.l<g.length&&g[g.l++]!=26)throw new Error("DBF EOF Marker missing "+(g.l-1)+" of "+g.length+" "+g[g.l-1].toString(16));return h&&h.sheetRows&&(p=p.slice(0,h.sheetRows)),h.DBF=L,p}function n(u,h){var p=h||{};p.dateNF||(p.dateNF="yyyymmdd");var g=If(r(u,p),p);return g["!cols"]=p.DBF.map(function(_){return{wch:_.len,DBF:_}}),delete p.DBF,g}function i(u,h){try{return Qo(n(u,h),h)}catch(p){if(h&&h.WTF)throw p}return{SheetNames:[],Sheets:{}}}var o={B:8,C:250,L:1,D:8,"?":0,"":0};function c(u,h){var p=h||{};if(+p.codepage>=0&&ka(+p.codepage),p.type=="string")throw new Error("Cannot write DBF to JS string");var g=bg(),_=I4(u,{header:1,raw:!0,cellDates:!0}),x=_[0],T=_.slice(1),w=u["!cols"]||[],S=0,C=0,z=0,Y=1;for(S=0;S<x.length;++S){if(((w[S]||{}).DBF||{}).name){x[S]=w[S].DBF.name,++z;continue}if(x[S]!=null){if(++z,typeof x[S]=="number"&&(x[S]=x[S].toString(10)),typeof x[S]!="string")throw new Error("DBF Invalid column name "+x[S]+" |"+typeof x[S]+"|");if(x.indexOf(x[S])!==S){for(C=0;C<1024;++C)if(x.indexOf(x[S]+"_"+C)==-1){x[S]+="_"+C;break}}}}var L=qr(u["!ref"]),K=[],Z=[],re=[];for(S=0;S<=L.e.c-L.s.c;++S){var k="",A="",E=0,I=[];for(C=0;C<T.length;++C)T[C][S]!=null&&I.push(T[C][S]);if(I.length==0||x[S]==null){K[S]="?";continue}for(C=0;C<I.length;++C){switch(typeof I[C]){case"number":A="B";break;case"string":A="C";break;case"boolean":A="L";break;case"object":A=I[C]instanceof Date?"D":"C";break;default:A="C"}E=Math.max(E,String(I[C]).length),k=k&&k!=A?"C":A}E>250&&(E=250),A=((w[S]||{}).DBF||{}).type,A=="C"&&w[S].DBF.len>E&&(E=w[S].DBF.len),k=="B"&&A=="N"&&(k="N",re[S]=w[S].DBF.dec,E=w[S].DBF.len),Z[S]=k=="C"||A=="N"?E:o[k]||0,Y+=Z[S],K[S]=k}var O=g.next(32);for(O.write_shift(4,318902576),O.write_shift(4,T.length),O.write_shift(2,296+32*z),O.write_shift(2,Y),S=0;S<4;++S)O.write_shift(4,0);for(O.write_shift(4,0|(+e[eS]||3)<<8),S=0,C=0;S<x.length;++S)if(x[S]!=null){var D=g.next(32),F=(x[S].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);D.write_shift(1,F,"sbcs"),D.write_shift(1,K[S]=="?"?"C":K[S],"sbcs"),D.write_shift(4,C),D.write_shift(1,Z[S]||o[K[S]]||0),D.write_shift(1,re[S]||0),D.write_shift(1,2),D.write_shift(4,0),D.write_shift(1,0),D.write_shift(4,0),D.write_shift(4,0),C+=Z[S]||o[K[S]]||0}var Fe=g.next(264);for(Fe.write_shift(4,13),S=0;S<65;++S)Fe.write_shift(4,0);for(S=0;S<T.length;++S){var Ce=g.next(Y);for(Ce.write_shift(1,0),C=0;C<x.length;++C)if(x[C]!=null)switch(K[C]){case"L":Ce.write_shift(1,T[S][C]==null?63:T[S][C]?84:70);break;case"B":Ce.write_shift(8,T[S][C]||0,"f");break;case"N":var ae="0";for(typeof T[S][C]=="number"&&(ae=T[S][C].toFixed(re[C]||0)),z=0;z<Z[C]-ae.length;++z)Ce.write_shift(1,32);Ce.write_shift(1,ae,"sbcs");break;case"D":T[S][C]?(Ce.write_shift(4,("0000"+T[S][C].getFullYear()).slice(-4),"sbcs"),Ce.write_shift(2,("00"+(T[S][C].getMonth()+1)).slice(-2),"sbcs"),Ce.write_shift(2,("00"+T[S][C].getDate()).slice(-2),"sbcs")):Ce.write_shift(8,"00000000","sbcs");break;case"C":var oe=String(T[S][C]!=null?T[S][C]:"").slice(0,Z[C]);for(Ce.write_shift(1,oe,"sbcs"),z=0;z<Z[C]-oe.length;++z)Ce.write_shift(1,32);break}}return g.next(1).write_shift(1,26),g.end()}return{to_workbook:i,to_sheet:n,from_sheet:c}}(),LP=function(){var t={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},e=new RegExp("\x1BN("+Gs(t).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(x,T){var w=t[T];return typeof w=="number"?cT(w):w},n=function(x,T,w){var S=T.charCodeAt(0)-32<<4|w.charCodeAt(0)-48;return S==59?x:cT(S)};t["|"]=254;function i(x,T){switch(T.type){case"base64":return o(Yn(x),T);case"binary":return o(x,T);case"buffer":return o(wt&&Buffer.isBuffer(x)?x.toString("binary"):$o(x),T);case"array":return o(Bo(x),T)}throw new Error("Unrecognized type "+T.type)}function o(x,T){var w=x.split(/[\n\r]+/),S=-1,C=-1,z=0,Y=0,L=[],K=[],Z=null,re={},k=[],A=[],E=[],I=0,O;for(+T.codepage>=0&&ka(+T.codepage);z!==w.length;++z){I=0;var D=w[z].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(e,r),F=D.replace(/;;/g,"\0").split(";").map(function(ee){return ee.replace(/\u0000/g,";")}),Fe=F[0],Ce;if(D.length>0)switch(Fe){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":F[1].charAt(0)=="P"&&K.push(D.slice(3).replace(/;;/g,";"));break;case"C":var ae=!1,oe=!1,be=!1,ne=!1,G=-1,se=-1;for(Y=1;Y<F.length;++Y)switch(F[Y].charAt(0)){case"A":break;case"X":C=parseInt(F[Y].slice(1))-1,oe=!0;break;case"Y":for(S=parseInt(F[Y].slice(1))-1,oe||(C=0),O=L.length;O<=S;++O)L[O]=[];break;case"K":Ce=F[Y].slice(1),Ce.charAt(0)==='"'?Ce=Ce.slice(1,Ce.length-1):Ce==="TRUE"?Ce=!0:Ce==="FALSE"?Ce=!1:isNaN(Mi(Ce))?isNaN(sf(Ce).getDate())||(Ce=Jr(Ce)):(Ce=Mi(Ce),Z!==null&&xc(Z)&&(Ce=Rd(Ce))),ae=!0;break;case"E":ne=!0;var P=tc(F[Y].slice(1),{r:S,c:C});L[S][C]=[L[S][C],P];break;case"S":be=!0,L[S][C]=[L[S][C],"S5S"];break;case"G":break;case"R":G=parseInt(F[Y].slice(1))-1;break;case"C":se=parseInt(F[Y].slice(1))-1;break;default:if(T&&T.WTF)throw new Error("SYLK bad record "+D)}if(ae&&(L[S][C]&&L[S][C].length==2?L[S][C][0]=Ce:L[S][C]=Ce,Z=null),be){if(ne)throw new Error("SYLK shared formula cannot have own formula");var j=G>-1&&L[G][se];if(!j||!j[1])throw new Error("SYLK shared formula cannot find base");L[S][C][1]=h4(j[1],{r:S-G,c:C-se})}break;case"F":var J=0;for(Y=1;Y<F.length;++Y)switch(F[Y].charAt(0)){case"X":C=parseInt(F[Y].slice(1))-1,++J;break;case"Y":for(S=parseInt(F[Y].slice(1))-1,O=L.length;O<=S;++O)L[O]=[];break;case"M":I=parseInt(F[Y].slice(1))/20;break;case"F":break;case"G":break;case"P":Z=K[parseInt(F[Y].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(E=F[Y].slice(1).split(" "),O=parseInt(E[0],10);O<=parseInt(E[1],10);++O)I=parseInt(E[2],10),A[O-1]=I===0?{hidden:!0}:{wch:I},fc(A[O-1]);break;case"C":C=parseInt(F[Y].slice(1))-1,A[C]||(A[C]={});break;case"R":S=parseInt(F[Y].slice(1))-1,k[S]||(k[S]={}),I>0?(k[S].hpt=I,k[S].hpx=ff(I)):I===0&&(k[S].hidden=!0);break;default:if(T&&T.WTF)throw new Error("SYLK bad record "+D)}J<1&&(Z=null);break;default:if(T&&T.WTF)throw new Error("SYLK bad record "+D)}}return k.length>0&&(re["!rows"]=k),A.length>0&&(re["!cols"]=A),T&&T.sheetRows&&(L=L.slice(0,T.sheetRows)),[L,re]}function c(x,T){var w=i(x,T),S=w[0],C=w[1],z=If(S,T);return Gs(C).forEach(function(Y){z[Y]=C[Y]}),z}function u(x,T){return Qo(c(x,T),T)}function h(x,T,w,S){var C="C;Y"+(w+1)+";X"+(S+1)+";K";switch(x.t){case"n":C+=x.v||0,x.f&&!x.F&&(C+=";E"+A5(x.f,{r:w,c:S}));break;case"b":C+=x.v?"TRUE":"FALSE";break;case"e":C+=x.w||x.v;break;case"d":C+='"'+(x.w||x.v)+'"';break;case"s":C+='"'+x.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return C}function p(x,T){T.forEach(function(w,S){var C="F;W"+(S+1)+" "+(S+1)+" ";w.hidden?C+="0":(typeof w.width=="number"&&!w.wpx&&(w.wpx=J0(w.width)),typeof w.wpx=="number"&&!w.wch&&(w.wch=ed(w.wpx)),typeof w.wch=="number"&&(C+=Math.round(w.wch))),C.charAt(C.length-1)!=" "&&x.push(C)})}function g(x,T){T.forEach(function(w,S){var C="F;";w.hidden?C+="M0;":w.hpt?C+="M"+20*w.hpt+";":w.hpx&&(C+="M"+20*c4(w.hpx)+";"),C.length>2&&x.push(C+"R"+(S+1))})}function _(x,T){var w=["ID;PWXL;N;E"],S=[],C=qr(x["!ref"]),z,Y=Array.isArray(x),L=`\r
`;w.push("P;PGeneral"),w.push("F;P0;DG0G8;M255"),x["!cols"]&&p(w,x["!cols"]),x["!rows"]&&g(w,x["!rows"]),w.push("B;Y"+(C.e.r-C.s.r+1)+";X"+(C.e.c-C.s.c+1)+";D"+[C.s.c,C.s.r,C.e.c,C.e.r].join(" "));for(var K=C.s.r;K<=C.e.r;++K)for(var Z=C.s.c;Z<=C.e.c;++Z){var re=vt({r:K,c:Z});z=Y?(x[K]||[])[Z]:x[re],!(!z||z.v==null&&(!z.f||z.F))&&S.push(h(z,x,K,Z))}return w.join(L)+L+S.join(L)+L+"E"+L}return{to_workbook:u,to_sheet:c,from_sheet:_}}(),VP=function(){function t(o,c){switch(c.type){case"base64":return e(Yn(o),c);case"binary":return e(o,c);case"buffer":return e(wt&&Buffer.isBuffer(o)?o.toString("binary"):$o(o),c);case"array":return e(Bo(o),c)}throw new Error("Unrecognized type "+c.type)}function e(o,c){for(var u=o.split(`
`),h=-1,p=-1,g=0,_=[];g!==u.length;++g){if(u[g].trim()==="BOT"){_[++h]=[],p=0;continue}if(!(h<0)){var x=u[g].trim().split(","),T=x[0],w=x[1];++g;for(var S=u[g]||"";(S.match(/["]/g)||[]).length&1&&g<u.length-1;)S+=`
`+u[++g];switch(S=S.trim(),+T){case-1:if(S==="BOT"){_[++h]=[],p=0;continue}else if(S!=="EOD")throw new Error("Unrecognized DIF special command "+S);break;case 0:S==="TRUE"?_[h][p]=!0:S==="FALSE"?_[h][p]=!1:isNaN(Mi(w))?isNaN(sf(w).getDate())?_[h][p]=w:_[h][p]=Jr(w):_[h][p]=Mi(w),++p;break;case 1:S=S.slice(1,S.length-1),S=S.replace(/""/g,'"'),S&&S.match(/^=".*"$/)&&(S=S.slice(2,-1)),_[h][p++]=S!==""?S:null;break}if(S==="EOD")break}}return c&&c.sheetRows&&(_=_.slice(0,c.sheetRows)),_}function r(o,c){return If(t(o,c),c)}function n(o,c){return Qo(r(o,c),c)}var i=function(){var o=function(h,p,g,_,x){h.push(p),h.push(g+","+_),h.push('"'+x.replace(/"/g,'""')+'"')},c=function(h,p,g,_){h.push(p+","+g),h.push(p==1?'"'+_.replace(/"/g,'""')+'"':_)};return function(h){var p=[],g=qr(h["!ref"]),_,x=Array.isArray(h);o(p,"TABLE",0,1,"sheetjs"),o(p,"VECTORS",0,g.e.r-g.s.r+1,""),o(p,"TUPLES",0,g.e.c-g.s.c+1,""),o(p,"DATA",0,0,"");for(var T=g.s.r;T<=g.e.r;++T){c(p,-1,0,"BOT");for(var w=g.s.c;w<=g.e.c;++w){var S=vt({r:T,c:w});if(_=x?(h[T]||[])[w]:h[S],!_){c(p,1,0,"");continue}switch(_.t){case"n":var C=_.w;!C&&_.v!=null&&(C=_.v),C==null?_.f&&!_.F?c(p,1,0,"="+_.f):c(p,1,0,""):c(p,0,C,"V");break;case"b":c(p,0,_.v?1:0,_.v?"TRUE":"FALSE");break;case"s":c(p,1,0,isNaN(_.v)?_.v:'="'+_.v+'"');break;case"d":_.w||(_.w=ga(_.z||ht[14],$n(Jr(_.v)))),c(p,0,_.w,"V");break;default:c(p,1,0,"")}}}c(p,-1,0,"EOD");var z=`\r
`,Y=p.join(z);return Y}}();return{to_workbook:n,to_sheet:r,from_sheet:i}}(),UP=function(){function t(_){return _.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function e(_){return _.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(_,x){for(var T=_.split(`
`),w=-1,S=-1,C=0,z=[];C!==T.length;++C){var Y=T[C].trim().split(":");if(Y[0]==="cell"){var L=Ia(Y[1]);if(z.length<=L.r)for(w=z.length;w<=L.r;++w)z[w]||(z[w]=[]);switch(w=L.r,S=L.c,Y[2]){case"t":z[w][S]=t(Y[3]);break;case"v":z[w][S]=+Y[3];break;case"vtf":var K=Y[Y.length-1];case"vtc":switch(Y[3]){case"nl":z[w][S]=!!+Y[4];break;default:z[w][S]=+Y[4];break}Y[2]=="vtf"&&(z[w][S]=[z[w][S],K])}}}return x&&x.sheetRows&&(z=z.slice(0,x.sheetRows)),z}function n(_,x){return If(r(_,x),x)}function i(_,x){return Qo(n(_,x),x)}var o=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),c=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,u=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),h="--SocialCalcSpreadsheetControlSave--";function p(_){if(!_||!_["!ref"])return"";for(var x=[],T=[],w,S="",C=K1(_["!ref"]),z=Array.isArray(_),Y=C.s.r;Y<=C.e.r;++Y)for(var L=C.s.c;L<=C.e.c;++L)if(S=vt({r:Y,c:L}),w=z?(_[Y]||[])[L]:_[S],!(!w||w.v==null||w.t==="z")){switch(T=["cell",S,"t"],w.t){case"s":case"str":T.push(e(w.v));break;case"n":w.f?(T[2]="vtf",T[3]="n",T[4]=w.v,T[5]=e(w.f)):(T[2]="v",T[3]=w.v);break;case"b":T[2]="vt"+(w.f?"f":"c"),T[3]="nl",T[4]=w.v?"1":"0",T[5]=e(w.f||(w.v?"TRUE":"FALSE"));break;case"d":var K=$n(Jr(w.v));T[2]="vtc",T[3]="nd",T[4]=""+K,T[5]=w.w||ga(w.z||ht[14],K);break;case"e":continue}x.push(T.join(":"))}return x.push("sheet:c:"+(C.e.c-C.s.c+1)+":r:"+(C.e.r-C.s.r+1)+":tvf:1"),x.push("valueformat:1:text-wiki"),x.join(`
`)}function g(_){return[o,c,u,c,p(_),h].join(`
`)}return{to_workbook:i,to_sheet:n,from_sheet:g}}(),cf=function(){function t(g,_,x,T,w){w.raw?_[x][T]=g:g===""||(g==="TRUE"?_[x][T]=!0:g==="FALSE"?_[x][T]=!1:isNaN(Mi(g))?isNaN(sf(g).getDate())?_[x][T]=g:_[x][T]=Jr(g):_[x][T]=Mi(g))}function e(g,_){var x=_||{},T=[];if(!g||g.length===0)return T;for(var w=g.split(/[\r\n]/),S=w.length-1;S>=0&&w[S].length===0;)--S;for(var C=10,z=0,Y=0;Y<=S;++Y)z=w[Y].indexOf(" "),z==-1?z=w[Y].length:z++,C=Math.max(C,z);for(Y=0;Y<=S;++Y){T[Y]=[];var L=0;for(t(w[Y].slice(0,C).trim(),T,Y,L,x),L=1;L<=(w[Y].length-C)/10+1;++L)t(w[Y].slice(C+(L-1)*10,C+L*10).trim(),T,Y,L,x)}return x.sheetRows&&(T=T.slice(0,x.sheetRows)),T}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function i(g){for(var _={},x=!1,T=0,w=0;T<g.length;++T)(w=g.charCodeAt(T))==34?x=!x:!x&&w in r&&(_[w]=(_[w]||0)+1);w=[];for(T in _)Object.prototype.hasOwnProperty.call(_,T)&&w.push([_[T],T]);if(!w.length){_=n;for(T in _)Object.prototype.hasOwnProperty.call(_,T)&&w.push([_[T],T])}return w.sort(function(S,C){return S[0]-C[0]||n[S[1]]-n[C[1]]}),r[w.pop()[1]]||44}function o(g,_){var x=_||{},T="",w=x.dense?[]:{},S={s:{c:0,r:0},e:{c:0,r:0}};g.slice(0,4)=="sep="?g.charCodeAt(5)==13&&g.charCodeAt(6)==10?(T=g.charAt(4),g=g.slice(7)):g.charCodeAt(5)==13||g.charCodeAt(5)==10?(T=g.charAt(4),g=g.slice(6)):T=i(g.slice(0,1024)):x&&x.FS?T=x.FS:T=i(g.slice(0,1024));var C=0,z=0,Y=0,L=0,K=0,Z=T.charCodeAt(0),re=!1,k=0,A=g.charCodeAt(0);g=g.replace(/\r\n/mg,`
`);var E=x.dateNF!=null?Z6(x.dateNF):null;function I(){var O=g.slice(L,K),D={};if(O.charAt(0)=='"'&&O.charAt(O.length-1)=='"'&&(O=O.slice(1,-1).replace(/""/g,'"')),O.length===0)D.t="z";else if(x.raw)D.t="s",D.v=O;else if(O.trim().length===0)D.t="s",D.v=O;else if(O.charCodeAt(0)==61)O.charCodeAt(1)==34&&O.charCodeAt(O.length-1)==34?(D.t="s",D.v=O.slice(2,-1).replace(/""/g,'"')):S5(O)?(D.t="n",D.f=O.slice(1)):(D.t="s",D.v=O);else if(O=="TRUE")D.t="b",D.v=!0;else if(O=="FALSE")D.t="b",D.v=!1;else if(!isNaN(Y=Mi(O)))D.t="n",x.cellText!==!1&&(D.w=O),D.v=Y;else if(!isNaN(sf(O).getDate())||E&&O.match(E)){D.z=x.dateNF||ht[14];var F=0;E&&O.match(E)&&(O=J6(O,x.dateNF,O.match(E)||[]),F=1),x.cellDates?(D.t="d",D.v=Jr(O,F)):(D.t="n",D.v=$n(Jr(O,F))),x.cellText!==!1&&(D.w=ga(D.z,D.v instanceof Date?$n(D.v):D.v)),x.cellNF||delete D.z}else D.t="s",D.v=O;if(D.t=="z"||(x.dense?(w[C]||(w[C]=[]),w[C][z]=D):w[vt({c:z,r:C})]=D),L=K+1,A=g.charCodeAt(L),S.e.c<z&&(S.e.c=z),S.e.r<C&&(S.e.r=C),k==Z)++z;else if(z=0,++C,x.sheetRows&&x.sheetRows<=C)return!0}e:for(;K<g.length;++K)switch(k=g.charCodeAt(K)){case 34:A===34&&(re=!re);break;case Z:case 10:case 13:if(!re&&I())break e;break}return K-L>0&&I(),w["!ref"]=qt(S),w}function c(g,_){return!(_&&_.PRN)||_.FS||g.slice(0,4)=="sep="||g.indexOf("	")>=0||g.indexOf(",")>=0||g.indexOf(";")>=0?o(g,_):If(e(g,_),_)}function u(g,_){var x="",T=_.type=="string"?[0,0,0,0]:iv(g,_);switch(_.type){case"base64":x=Yn(g);break;case"binary":x=g;break;case"buffer":_.codepage==65001?x=g.toString("utf8"):_.codepage&&typeof nf<"u"||(x=wt&&Buffer.isBuffer(g)?g.toString("binary"):$o(g));break;case"array":x=Bo(g);break;case"string":x=g;break;default:throw new Error("Unrecognized type "+_.type)}return T[0]==239&&T[1]==187&&T[2]==191?x=Jt(x.slice(3)):_.type!="string"&&_.type!="buffer"&&_.codepage==65001?x=Jt(x):_.type=="binary"&&typeof nf<"u",x.slice(0,19)=="socialcalc:version:"?UP.to_sheet(_.type=="string"?x:Jt(x),_):c(x,_)}function h(g,_){return Qo(u(g,_),_)}function p(g){for(var _=[],x=qr(g["!ref"]),T,w=Array.isArray(g),S=x.s.r;S<=x.e.r;++S){for(var C=[],z=x.s.c;z<=x.e.c;++z){var Y=vt({r:S,c:z});if(T=w?(g[S]||[])[z]:g[Y],!T||T.v==null){C.push("          ");continue}for(var L=(T.w||(uc(T),T.w)||"").slice(0,10);L.length<10;)L+=" ";C.push(L+(z===0?" ":""))}_.push(C.join(""))}return _.join(`
`)}return{to_workbook:h,to_sheet:u,from_sheet:p}}();function BP(t,e){var r=e||{},n=!!r.WTF;r.WTF=!0;try{var i=LP.to_workbook(t,r);return r.WTF=n,i}catch(o){if(r.WTF=n,!o.message.match(/SYLK bad record ID/)&&n)throw o;return cf.to_workbook(t,e)}}var zu=function(){function t(P,j,J){if(P){Qr(P,P.l||0);for(var ee=J.Enum||G;P.l<P.length;){var ue=P.read_shift(2),Ie=ee[ue]||ee[65535],Ee=P.read_shift(2),we=P.l+Ee,Te=Ie.f&&Ie.f(P,Ee,J);if(P.l=we,j(Te,Ie,ue))return}}}function e(P,j){switch(j.type){case"base64":return r(Ca(Yn(P)),j);case"binary":return r(Ca(P),j);case"buffer":case"array":return r(P,j)}throw"Unsupported type "+j.type}function r(P,j){if(!P)return P;var J=j||{},ee=J.dense?[]:{},ue="Sheet1",Ie="",Ee=0,we={},Te=[],Ue=[],W={s:{r:0,c:0},e:{r:0,c:0}},nt=J.sheetRows||0;if(P[2]==0&&(P[3]==8||P[3]==9)&&P.length>=16&&P[14]==5&&P[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(P[2]==2)J.Enum=G,t(P,function(Ne,Ye,ut){switch(ut){case 0:J.vers=Ne,Ne>=4096&&(J.qpro=!0);break;case 6:W=Ne;break;case 204:Ne&&(Ie=Ne);break;case 222:Ie=Ne;break;case 15:case 51:J.qpro||(Ne[1].v=Ne[1].v.slice(1));case 13:case 14:case 16:ut==14&&(Ne[2]&112)==112&&(Ne[2]&15)>1&&(Ne[2]&15)<15&&(Ne[1].z=J.dateNF||ht[14],J.cellDates&&(Ne[1].t="d",Ne[1].v=Rd(Ne[1].v))),J.qpro&&Ne[3]>Ee&&(ee["!ref"]=qt(W),we[ue]=ee,Te.push(ue),ee=J.dense?[]:{},W={s:{r:0,c:0},e:{r:0,c:0}},Ee=Ne[3],ue=Ie||"Sheet"+(Ee+1),Ie="");var _t=J.dense?(ee[Ne[0].r]||[])[Ne[0].c]:ee[vt(Ne[0])];if(_t){_t.t=Ne[1].t,_t.v=Ne[1].v,Ne[1].z!=null&&(_t.z=Ne[1].z),Ne[1].f!=null&&(_t.f=Ne[1].f);break}J.dense?(ee[Ne[0].r]||(ee[Ne[0].r]=[]),ee[Ne[0].r][Ne[0].c]=Ne[1]):ee[vt(Ne[0])]=Ne[1];break}},J);else if(P[2]==26||P[2]==14)J.Enum=se,P[2]==14&&(J.qpro=!0,P.l=0),t(P,function(Ne,Ye,ut){switch(ut){case 204:ue=Ne;break;case 22:Ne[1].v=Ne[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(Ne[3]>Ee&&(ee["!ref"]=qt(W),we[ue]=ee,Te.push(ue),ee=J.dense?[]:{},W={s:{r:0,c:0},e:{r:0,c:0}},Ee=Ne[3],ue="Sheet"+(Ee+1)),nt>0&&Ne[0].r>=nt)break;J.dense?(ee[Ne[0].r]||(ee[Ne[0].r]=[]),ee[Ne[0].r][Ne[0].c]=Ne[1]):ee[vt(Ne[0])]=Ne[1],W.e.c<Ne[0].c&&(W.e.c=Ne[0].c),W.e.r<Ne[0].r&&(W.e.r=Ne[0].r);break;case 27:Ne[14e3]&&(Ue[Ne[14e3][0]]=Ne[14e3][1]);break;case 1537:Ue[Ne[0]]=Ne[1],Ne[0]==Ee&&(ue=Ne[1]);break}},J);else throw new Error("Unrecognized LOTUS BOF "+P[2]);if(ee["!ref"]=qt(W),we[Ie||ue]=ee,Te.push(Ie||ue),!Ue.length)return{SheetNames:Te,Sheets:we};for(var Ge={},Ke=[],Be=0;Be<Ue.length;++Be)we[Te[Be]]?(Ke.push(Ue[Be]||Te[Be]),Ge[Ue[Be]]=we[Ue[Be]]||we[Te[Be]]):(Ke.push(Ue[Be]),Ge[Ue[Be]]={"!ref":"A1"});return{SheetNames:Ke,Sheets:Ge}}function n(P,j){var J=j||{};if(+J.codepage>=0&&ka(+J.codepage),J.type=="string")throw new Error("Cannot write WK1 to JS string");var ee=bg(),ue=qr(P["!ref"]),Ie=Array.isArray(P),Ee=[];Sa(ee,0,o(1030)),Sa(ee,6,h(ue));for(var we=Math.min(ue.e.r,8191),Te=ue.s.r;Te<=we;++Te)for(var Ue=Xn(Te),W=ue.s.c;W<=ue.e.c;++W){Te===ue.s.r&&(Ee[W]=wn(W));var nt=Ee[W]+Ue,Ge=Ie?(P[Te]||[])[W]:P[nt];if(!(!Ge||Ge.t=="z"))if(Ge.t=="n")(Ge.v|0)==Ge.v&&Ge.v>=-32768&&Ge.v<=32767?Sa(ee,13,T(Te,W,Ge.v)):Sa(ee,14,S(Te,W,Ge.v));else{var Ke=uc(Ge);Sa(ee,15,_(Te,W,Ke.slice(0,239)))}}return Sa(ee,1),ee.end()}function i(P,j){var J=j||{};if(+J.codepage>=0&&ka(+J.codepage),J.type=="string")throw new Error("Cannot write WK3 to JS string");var ee=bg();Sa(ee,0,c(P));for(var ue=0,Ie=0;ue<P.SheetNames.length;++ue)(P.Sheets[P.SheetNames[ue]]||{})["!ref"]&&Sa(ee,27,ne(P.SheetNames[ue],Ie++));var Ee=0;for(ue=0;ue<P.SheetNames.length;++ue){var we=P.Sheets[P.SheetNames[ue]];if(!(!we||!we["!ref"])){for(var Te=qr(we["!ref"]),Ue=Array.isArray(we),W=[],nt=Math.min(Te.e.r,8191),Ge=Te.s.r;Ge<=nt;++Ge)for(var Ke=Xn(Ge),Be=Te.s.c;Be<=Te.e.c;++Be){Ge===Te.s.r&&(W[Be]=wn(Be));var Ne=W[Be]+Ke,Ye=Ue?(we[Ge]||[])[Be]:we[Ne];if(!(!Ye||Ye.t=="z"))if(Ye.t=="n")Sa(ee,23,I(Ge,Be,Ee,Ye.v));else{var ut=uc(Ye);Sa(ee,22,k(Ge,Be,Ee,ut.slice(0,239)))}}++Ee}}return Sa(ee,1),ee.end()}function o(P){var j=Nr(2);return j.write_shift(2,P),j}function c(P){var j=Nr(26);j.write_shift(2,4096),j.write_shift(2,4),j.write_shift(4,0);for(var J=0,ee=0,ue=0,Ie=0;Ie<P.SheetNames.length;++Ie){var Ee=P.SheetNames[Ie],we=P.Sheets[Ee];if(!(!we||!we["!ref"])){++ue;var Te=K1(we["!ref"]);J<Te.e.r&&(J=Te.e.r),ee<Te.e.c&&(ee=Te.e.c)}}return J>8191&&(J=8191),j.write_shift(2,J),j.write_shift(1,ue),j.write_shift(1,ee),j.write_shift(2,0),j.write_shift(2,0),j.write_shift(1,1),j.write_shift(1,2),j.write_shift(4,0),j.write_shift(4,0),j}function u(P,j,J){var ee={s:{c:0,r:0},e:{c:0,r:0}};return j==8&&J.qpro?(ee.s.c=P.read_shift(1),P.l++,ee.s.r=P.read_shift(2),ee.e.c=P.read_shift(1),P.l++,ee.e.r=P.read_shift(2),ee):(ee.s.c=P.read_shift(2),ee.s.r=P.read_shift(2),j==12&&J.qpro&&(P.l+=2),ee.e.c=P.read_shift(2),ee.e.r=P.read_shift(2),j==12&&J.qpro&&(P.l+=2),ee.s.c==65535&&(ee.s.c=ee.e.c=ee.s.r=ee.e.r=0),ee)}function h(P){var j=Nr(8);return j.write_shift(2,P.s.c),j.write_shift(2,P.s.r),j.write_shift(2,P.e.c),j.write_shift(2,P.e.r),j}function p(P,j,J){var ee=[{c:0,r:0},{t:"n",v:0},0,0];return J.qpro&&J.vers!=20768?(ee[0].c=P.read_shift(1),ee[3]=P.read_shift(1),ee[0].r=P.read_shift(2),P.l+=2):(ee[2]=P.read_shift(1),ee[0].c=P.read_shift(2),ee[0].r=P.read_shift(2)),ee}function g(P,j,J){var ee=P.l+j,ue=p(P,j,J);if(ue[1].t="s",J.vers==20768){P.l++;var Ie=P.read_shift(1);return ue[1].v=P.read_shift(Ie,"utf8"),ue}return J.qpro&&P.l++,ue[1].v=P.read_shift(ee-P.l,"cstr"),ue}function _(P,j,J){var ee=Nr(7+J.length);ee.write_shift(1,255),ee.write_shift(2,j),ee.write_shift(2,P),ee.write_shift(1,39);for(var ue=0;ue<ee.length;++ue){var Ie=J.charCodeAt(ue);ee.write_shift(1,Ie>=128?95:Ie)}return ee.write_shift(1,0),ee}function x(P,j,J){var ee=p(P,j,J);return ee[1].v=P.read_shift(2,"i"),ee}function T(P,j,J){var ee=Nr(7);return ee.write_shift(1,255),ee.write_shift(2,j),ee.write_shift(2,P),ee.write_shift(2,J,"i"),ee}function w(P,j,J){var ee=p(P,j,J);return ee[1].v=P.read_shift(8,"f"),ee}function S(P,j,J){var ee=Nr(13);return ee.write_shift(1,255),ee.write_shift(2,j),ee.write_shift(2,P),ee.write_shift(8,J,"f"),ee}function C(P,j,J){var ee=P.l+j,ue=p(P,j,J);if(ue[1].v=P.read_shift(8,"f"),J.qpro)P.l=ee;else{var Ie=P.read_shift(2);K(P.slice(P.l,P.l+Ie),ue),P.l+=Ie}return ue}function z(P,j,J){var ee=j&32768;return j&=-32769,j=(ee?P:0)+(j>=8192?j-16384:j),(ee?"":"$")+(J?wn(j):Xn(j))}var Y={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},L=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function K(P,j){Qr(P,0);for(var J=[],ee=0,ue="",Ie="",Ee="",we="";P.l<P.length;){var Te=P[P.l++];switch(Te){case 0:J.push(P.read_shift(8,"f"));break;case 1:Ie=z(j[0].c,P.read_shift(2),!0),ue=z(j[0].r,P.read_shift(2),!1),J.push(Ie+ue);break;case 2:{var Ue=z(j[0].c,P.read_shift(2),!0),W=z(j[0].r,P.read_shift(2),!1);Ie=z(j[0].c,P.read_shift(2),!0),ue=z(j[0].r,P.read_shift(2),!1),J.push(Ue+W+":"+Ie+ue)}break;case 3:if(P.l<P.length){console.error("WK1 premature formula end");return}break;case 4:J.push("("+J.pop()+")");break;case 5:J.push(P.read_shift(2));break;case 6:{for(var nt="";Te=P[P.l++];)nt+=String.fromCharCode(Te);J.push('"'+nt.replace(/"/g,'""')+'"')}break;case 8:J.push("-"+J.pop());break;case 23:J.push("+"+J.pop());break;case 22:J.push("NOT("+J.pop()+")");break;case 20:case 21:we=J.pop(),Ee=J.pop(),J.push(["AND","OR"][Te-20]+"("+Ee+","+we+")");break;default:if(Te<32&&L[Te])we=J.pop(),Ee=J.pop(),J.push(Ee+L[Te]+we);else if(Y[Te]){if(ee=Y[Te][1],ee==69&&(ee=P[P.l++]),ee>J.length){console.error("WK1 bad formula parse 0x"+Te.toString(16)+":|"+J.join("|")+"|");return}var Ge=J.slice(-ee);J.length-=ee,J.push(Y[Te][0]+"("+Ge.join(",")+")")}else return Te<=7?console.error("WK1 invalid opcode "+Te.toString(16)):Te<=24?console.error("WK1 unsupported op "+Te.toString(16)):Te<=30?console.error("WK1 invalid opcode "+Te.toString(16)):Te<=115?console.error("WK1 unsupported function opcode "+Te.toString(16)):console.error("WK1 unrecognized opcode "+Te.toString(16))}}J.length==1?j[1].f=""+J[0]:console.error("WK1 bad formula parse |"+J.join("|")+"|")}function Z(P){var j=[{c:0,r:0},{t:"n",v:0},0];return j[0].r=P.read_shift(2),j[3]=P[P.l++],j[0].c=P[P.l++],j}function re(P,j){var J=Z(P);return J[1].t="s",J[1].v=P.read_shift(j-4,"cstr"),J}function k(P,j,J,ee){var ue=Nr(6+ee.length);ue.write_shift(2,P),ue.write_shift(1,J),ue.write_shift(1,j),ue.write_shift(1,39);for(var Ie=0;Ie<ee.length;++Ie){var Ee=ee.charCodeAt(Ie);ue.write_shift(1,Ee>=128?95:Ee)}return ue.write_shift(1,0),ue}function A(P,j){var J=Z(P);J[1].v=P.read_shift(2);var ee=J[1].v>>1;if(J[1].v&1)switch(ee&7){case 0:ee=(ee>>3)*5e3;break;case 1:ee=(ee>>3)*500;break;case 2:ee=(ee>>3)/20;break;case 3:ee=(ee>>3)/200;break;case 4:ee=(ee>>3)/2e3;break;case 5:ee=(ee>>3)/2e4;break;case 6:ee=(ee>>3)/16;break;case 7:ee=(ee>>3)/64;break}return J[1].v=ee,J}function E(P,j){var J=Z(P),ee=P.read_shift(4),ue=P.read_shift(4),Ie=P.read_shift(2);if(Ie==65535)return ee===0&&ue===3221225472?(J[1].t="e",J[1].v=15):ee===0&&ue===3489660928?(J[1].t="e",J[1].v=42):J[1].v=0,J;var Ee=Ie&32768;return Ie=(Ie&32767)-16446,J[1].v=(1-Ee*2)*(ue*Math.pow(2,Ie+32)+ee*Math.pow(2,Ie)),J}function I(P,j,J,ee){var ue=Nr(14);if(ue.write_shift(2,P),ue.write_shift(1,J),ue.write_shift(1,j),ee==0)return ue.write_shift(4,0),ue.write_shift(4,0),ue.write_shift(2,65535),ue;var Ie=0,Ee=0,we=0,Te=0;return ee<0&&(Ie=1,ee=-ee),Ee=Math.log2(ee)|0,ee/=Math.pow(2,Ee-31),Te=ee>>>0,(Te&2147483648)==0&&(ee/=2,++Ee,Te=ee>>>0),ee-=Te,Te|=2147483648,Te>>>=0,ee*=Math.pow(2,32),we=ee>>>0,ue.write_shift(4,we),ue.write_shift(4,Te),Ee+=16383+(Ie?32768:0),ue.write_shift(2,Ee),ue}function O(P,j){var J=E(P);return P.l+=j-14,J}function D(P,j){var J=Z(P),ee=P.read_shift(4);return J[1].v=ee>>6,J}function F(P,j){var J=Z(P),ee=P.read_shift(8,"f");return J[1].v=ee,J}function Fe(P,j){var J=F(P);return P.l+=j-10,J}function Ce(P,j){return P[P.l+j-1]==0?P.read_shift(j,"cstr"):""}function ae(P,j){var J=P[P.l++];J>j-1&&(J=j-1);for(var ee="";ee.length<J;)ee+=String.fromCharCode(P[P.l++]);return ee}function oe(P,j,J){if(!(!J.qpro||j<21)){var ee=P.read_shift(1);P.l+=17,P.l+=1,P.l+=2;var ue=P.read_shift(j-21,"cstr");return[ee,ue]}}function be(P,j){for(var J={},ee=P.l+j;P.l<ee;){var ue=P.read_shift(2);if(ue==14e3){for(J[ue]=[0,""],J[ue][0]=P.read_shift(2);P[P.l];)J[ue][1]+=String.fromCharCode(P[P.l]),P.l++;P.l++}}return J}function ne(P,j){var J=Nr(5+P.length);J.write_shift(2,14e3),J.write_shift(2,j);for(var ee=0;ee<P.length;++ee){var ue=P.charCodeAt(ee);J[J.l++]=ue>127?95:ue}return J[J.l++]=0,J}var G={0:{n:"BOF",f:Sr},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:u},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:x},14:{n:"NUMBER",f:w},15:{n:"LABEL",f:g},16:{n:"FORMULA",f:C},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:g},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:Ce},222:{n:"SHEETNAMELP",f:ae},65535:{n:""}},se={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:re},23:{n:"NUMBER17",f:E},24:{n:"NUMBER18",f:A},25:{n:"FORMULA19",f:O},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:be},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:D},38:{n:"??"},39:{n:"NUMBER27",f:F},40:{n:"FORMULA28",f:Fe},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:Ce},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:oe},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:i,to_workbook:e}}();function jP(t){var e={},r=t.match(gn),n=0,i=!1;if(r)for(;n!=r.length;++n){var o=st(r[n]);switch(o[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!o.val)break;case"<shadow>":case"<shadow/>":e.shadow=1;break;case"</shadow>":break;case"<charset":if(o.val=="1")break;e.cp=L1[parseInt(o.val,10)];break;case"<outline":if(!o.val)break;case"<outline>":case"<outline/>":e.outline=1;break;case"</outline>":break;case"<rFont":e.name=o.val;break;case"<sz":e.sz=o.val;break;case"<strike":if(!o.val)break;case"<strike>":case"<strike/>":e.strike=1;break;case"</strike>":break;case"<u":if(!o.val)break;switch(o.val){case"double":e.uval="double";break;case"singleAccounting":e.uval="single-accounting";break;case"doubleAccounting":e.uval="double-accounting";break}case"<u>":case"<u/>":e.u=1;break;case"</u>":break;case"<b":if(o.val=="0")break;case"<b>":case"<b/>":e.b=1;break;case"</b>":break;case"<i":if(o.val=="0")break;case"<i>":case"<i/>":e.i=1;break;case"</i>":break;case"<color":o.rgb&&(e.color=o.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":e.family=o.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":e.valign=o.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(o[0].charCodeAt(1)!==47&&!i)throw new Error("Unrecognized rich format "+o[0])}}return e}var zP=function(){var t=of("t"),e=of("rPr");function r(o){var c=o.match(t);if(!c)return{t:"s",v:""};var u={t:"s",v:Nt(c[1])},h=o.match(e);return h&&(u.s=jP(h[1])),u}var n=/<(?:\w+:)?r>/g,i=/<\/(?:\w+:)?r>/;return function(c){return c.replace(n,"").split(i).map(r).filter(function(u){return u.v})}}(),HP=function(){var e=/(\r\n|\n)/g;function r(i,o,c){var u=[];i.u&&u.push("text-decoration: underline;"),i.uval&&u.push("text-underline-style:"+i.uval+";"),i.sz&&u.push("font-size:"+i.sz+"pt;"),i.outline&&u.push("text-effect: outline;"),i.shadow&&u.push("text-shadow: auto;"),o.push('<span style="'+u.join("")+'">'),i.b&&(o.push("<b>"),c.push("</b>")),i.i&&(o.push("<i>"),c.push("</i>")),i.strike&&(o.push("<s>"),c.push("</s>"));var h=i.valign||"";return h=="superscript"||h=="super"?h="sup":h=="subscript"&&(h="sub"),h!=""&&(o.push("<"+h+">"),c.push("</"+h+">")),c.push("</span>"),i}function n(i){var o=[[],i.v,[]];return i.v?(i.s&&r(i.s,o[0],o[2]),o[0].join("")+o[1].replace(e,"<br/>")+o[2].join("")):""}return function(o){return o.map(n).join("")}}(),GP=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,qP=/<(?:\w+:)?r>/,KP=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function Z1(t,e){var r=e?e.cellHTML:!0,n={};return t?(t.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=Nt(Jt(t.slice(t.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=Jt(t),r&&(n.h=TS(n.t))):t.match(qP)&&(n.r=Jt(t),n.t=Nt(Jt((t.replace(KP,"").match(GP)||[]).join("").replace(gn,""))),r&&(n.h=HP(zP(n.r)))),n):{t:""}}var WP=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,XP=/<(?:\w+:)?(?:si|sstItem)>/g,YP=/<\/(?:\w+:)?(?:si|sstItem)>/;function $P(t,e){var r=[],n="";if(!t)return r;var i=t.match(WP);if(i){n=i[2].replace(XP,"").split(YP);for(var o=0;o!=n.length;++o){var c=Z1(n[o].trim(),e);c!=null&&(r[r.length]=c)}i=st(i[1]),r.Count=i.count,r.Unique=i.uniqueCount}return r}function QP(t){return[t.read_shift(4),t.read_shift(4)]}function ZP(t,e){var r=[],n=!1;return Hi(t,function(o,c,u){switch(u){case 159:r.Count=o[0],r.Unique=o[1];break;case 19:r.push(o);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(c.T,!n||e.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}),r}function n4(t){for(var e=[],r=t.split(""),n=0;n<r.length;++n)e[n]=r[n].charCodeAt(0);return e}function Li(t,e){var r={};return r.Major=t.read_shift(2),r.Minor=t.read_shift(2),e>=4&&(t.l+=e-4),r}function JP(t){var e={};return e.id=t.read_shift(0,"lpp4"),e.R=Li(t,4),e.U=Li(t,4),e.W=Li(t,4),e}function eM(t){for(var e=t.read_shift(4),r=t.l+e-4,n={},i=t.read_shift(4),o=[];i-- >0;)o.push({t:t.read_shift(4),v:t.read_shift(0,"lpp4")});if(n.name=t.read_shift(0,"lpp4"),n.comps=o,t.l!=r)throw new Error("Bad DataSpaceMapEntry: "+t.l+" != "+r);return n}function tM(t){var e=[];t.l+=4;for(var r=t.read_shift(4);r-- >0;)e.push(eM(t));return e}function rM(t){var e=[];t.l+=4;for(var r=t.read_shift(4);r-- >0;)e.push(t.read_shift(0,"lpp4"));return e}function nM(t){var e={};return t.read_shift(4),t.l+=4,e.id=t.read_shift(0,"lpp4"),e.name=t.read_shift(0,"lpp4"),e.R=Li(t,4),e.U=Li(t,4),e.W=Li(t,4),e}function aM(t){var e=nM(t);if(e.ename=t.read_shift(0,"8lpp4"),e.blksz=t.read_shift(4),e.cmode=t.read_shift(4),t.read_shift(4)!=4)throw new Error("Bad !Primary record");return e}function a4(t,e){var r=t.l+e,n={};n.Flags=t.read_shift(4)&63,t.l+=4,n.AlgID=t.read_shift(4);var i=!1;switch(n.AlgID){case 26126:case 26127:case 26128:i=n.Flags==36;break;case 26625:i=n.Flags==4;break;case 0:i=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!i)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=t.read_shift(4),n.KeySize=t.read_shift(4),n.ProviderType=t.read_shift(4),t.l+=8,n.CSPName=t.read_shift(r-t.l>>1,"utf16le"),t.l=r,n}function i4(t,e){var r={},n=t.l+e;return t.l+=4,r.Salt=t.slice(t.l,t.l+16),t.l+=16,r.Verifier=t.slice(t.l,t.l+16),t.l+=16,t.read_shift(4),r.VerifierHash=t.slice(t.l,n),t.l=n,r}function iM(t){var e=Li(t);switch(e.Minor){case 2:return[e.Minor,sM(t)];case 3:return[e.Minor,oM()];case 4:return[e.Minor,lM(t)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+e.Minor)}function sM(t){var e=t.read_shift(4);if((e&63)!=36)throw new Error("EncryptionInfo mismatch");var r=t.read_shift(4),n=a4(t,r),i=i4(t,t.length-t.l);return{t:"Std",h:n,v:i}}function oM(){throw new Error("File is password-protected: ECMA-376 Extensible")}function lM(t){var e=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];t.l+=4;var r=t.read_shift(t.length-t.l,"utf8"),n={};return r.replace(gn,function(o){var c=st(o);switch(oi(c[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":e.forEach(function(u){n[u]=c[u]});break;case"<dataIntegrity":n.encryptedHmacKey=c.encryptedHmacKey,n.encryptedHmacValue=c.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=c.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(c);break;default:throw c[0]}}),n}function cM(t,e){var r={},n=r.EncryptionVersionInfo=Li(t,4);if(e-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);r.Flags=t.read_shift(4),e-=4;var i=t.read_shift(4);return e-=4,r.EncryptionHeader=a4(t,i),e-=i,r.EncryptionVerifier=i4(t,e),r}function uM(t){var e={},r=e.EncryptionVersionInfo=Li(t,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return e.Salt=t.read_shift(16),e.EncryptedVerifier=t.read_shift(16),e.EncryptedVerifierHash=t.read_shift(16),e}function fM(t){var e=0,r,n=n4(t),i=n.length+1,o,c,u,h,p;for(r=Hs(i),r[0]=n.length,o=1;o!=i;++o)r[o]=n[o-1];for(o=i-1;o>=0;--o)c=r[o],u=(e&16384)===0?0:1,h=e<<1&32767,p=u|h,e=p^c;return e^52811}var s4=function(){var t=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],e=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(c){return(c/2|c*128)&255},i=function(c,u){return n(c^u)},o=function(c){for(var u=e[c.length-1],h=104,p=c.length-1;p>=0;--p)for(var g=c[p],_=0;_!=7;++_)g&64&&(u^=r[h]),g*=2,--h;return u};return function(c){for(var u=n4(c),h=o(u),p=u.length,g=Hs(16),_=0;_!=16;++_)g[_]=0;var x,T,w;for((p&1)===1&&(x=h>>8,g[p]=i(t[0],x),--p,x=h&255,T=u[u.length-1],g[p]=i(T,x));p>0;)--p,x=h>>8,g[p]=i(u[p],x),--p,x=h&255,g[p]=i(u[p],x);for(p=15,w=15-u.length;w>0;)x=h>>8,g[p]=i(t[w],x),--p,--w,x=h&255,g[p]=i(u[p],x),--p,--w;return g}}(),hM=function(t,e,r,n,i){i||(i=e),n||(n=s4(t));var o,c;for(o=0;o!=e.length;++o)c=e[o],c^=n[r],c=(c>>5|c<<3)&255,i[o]=c,++r;return[i,r,n]},dM=function(t){var e=0,r=s4(t);return function(n){var i=hM("",n,e,r);return e=i[1],i[0]}};function pM(t,e,r,n){var i={key:Sr(t),verificationBytes:Sr(t)};return r.password&&(i.verifier=fM(r.password)),n.valid=i.verificationBytes===i.verifier,n.valid&&(n.insitu=dM(r.password)),i}function mM(t,e,r){var n=r||{};return n.Info=t.read_shift(2),t.l-=2,n.Info===1?n.Data=uM(t):n.Data=cM(t,e),n}function gM(t,e,r){var n={Type:r.biff>=8?t.read_shift(2):0};return n.Type?mM(t,e-2,n):pM(t,r.biff>=8?e:e-2,r,n),n}var vM=function(){function t(i,o){switch(o.type){case"base64":return e(Yn(i),o);case"binary":return e(i,o);case"buffer":return e(wt&&Buffer.isBuffer(i)?i.toString("binary"):$o(i),o);case"array":return e(Bo(i),o)}throw new Error("Unrecognized type "+o.type)}function e(i,o){var c=o||{},u=c.dense?[]:{},h=i.match(/\\trowd.*?\\row\b/g);if(!h.length)throw new Error("RTF missing table");var p={s:{c:0,r:0},e:{c:0,r:h.length-1}};return h.forEach(function(g,_){Array.isArray(u)&&(u[_]=[]);for(var x=/\\\w+\b/g,T=0,w,S=-1;w=x.exec(g);){switch(w[0]){case"\\cell":var C=g.slice(T,x.lastIndex-w[0].length);if(C[0]==" "&&(C=C.slice(1)),++S,C.length){var z={v:C,t:"s"};Array.isArray(u)?u[_][S]=z:u[vt({r:_,c:S})]=z}break}T=x.lastIndex}S>p.e.c&&(p.e.c=S)}),u["!ref"]=qt(p),u}function r(i,o){return Qo(t(i,o),o)}function n(i){for(var o=["{\\rtf1\\ansi"],c=qr(i["!ref"]),u,h=Array.isArray(i),p=c.s.r;p<=c.e.r;++p){o.push("\\trowd\\trautofit1");for(var g=c.s.c;g<=c.e.c;++g)o.push("\\cellx"+(g+1));for(o.push("\\pard\\intbl"),g=c.s.c;g<=c.e.c;++g){var _=vt({r:p,c:g});u=h?(i[p]||[])[g]:i[_],!(!u||u.v==null&&(!u.f||u.F))&&(o.push(" "+(u.w||(uc(u),u.w))),o.push("\\cell"))}o.push("\\pard\\intbl\\row")}return o.join("")+"}"}return{to_workbook:r,to_sheet:t,from_sheet:n}}();function _M(t){var e=t.slice(t[0]==="#"?1:0).slice(0,6);return[parseInt(e.slice(0,2),16),parseInt(e.slice(2,4),16),parseInt(e.slice(4,6),16)]}function uf(t){for(var e=0,r=1;e!=3;++e)r=r*256+(t[e]>255?255:t[e]<0?0:t[e]);return r.toString(16).toUpperCase().slice(1)}function xM(t){var e=t[0]/255,r=t[1]/255,n=t[2]/255,i=Math.max(e,r,n),o=Math.min(e,r,n),c=i-o;if(c===0)return[0,0,e];var u=0,h=0,p=i+o;switch(h=c/(p>1?2-p:p),i){case e:u=((r-n)/c+6)%6;break;case r:u=(n-e)/c+2;break;case n:u=(e-r)/c+4;break}return[u/6,h,p/2]}function yM(t){var e=t[0],r=t[1],n=t[2],i=r*2*(n<.5?n:1-n),o=n-i/2,c=[o,o,o],u=6*e,h;if(r!==0)switch(u|0){case 0:case 6:h=i*u,c[0]+=i,c[1]+=h;break;case 1:h=i*(2-u),c[0]+=h,c[1]+=i;break;case 2:h=i*(u-2),c[1]+=i,c[2]+=h;break;case 3:h=i*(4-u),c[1]+=h,c[2]+=i;break;case 4:h=i*(u-4),c[2]+=i,c[0]+=h;break;case 5:h=i*(6-u),c[2]+=h,c[0]+=i;break}for(var p=0;p!=3;++p)c[p]=Math.round(c[p]*255);return c}function Z0(t,e){if(e===0)return t;var r=xM(_M(t));return e<0?r[2]=r[2]*(1+e):r[2]=1-(1-r[2])*(1-e),uf(yM(r))}var o4=6,EM=15,TM=1,An=o4;function J0(t){return Math.floor((t+Math.round(128/An)/256)*An)}function ed(t){return Math.floor((t-5)/An*100+.5)/100}function Ng(t){return Math.round((t*An+5)/An*256)/256}function $m(t){return Ng(ed(J0(t)))}function J1(t){var e=Math.abs(t-$m(t)),r=An;if(e>.005)for(An=TM;An<EM;++An)Math.abs(t-$m(t))<=e&&(e=Math.abs(t-$m(t)),r=An);An=r}function fc(t){t.width?(t.wpx=J0(t.width),t.wch=ed(t.wpx),t.MDW=An):t.wpx?(t.wch=ed(t.wpx),t.width=Ng(t.wch),t.MDW=An):typeof t.wch=="number"&&(t.width=Ng(t.wch),t.wpx=J0(t.width),t.MDW=An),t.customWidth&&delete t.customWidth}var AM=96,l4=AM;function c4(t){return t*96/l4}function ff(t){return t*l4/96}var wM={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function SM(t,e,r,n){e.Borders=[];var i={},o=!1;(t[0].match(gn)||[]).forEach(function(c){var u=st(c);switch(oi(u[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":i={},u.diagonalUp&&(i.diagonalUp=ir(u.diagonalUp)),u.diagonalDown&&(i.diagonalDown=ir(u.diagonalDown)),e.Borders.push(i);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":o=!0;break;case"</ext>":o=!1;break;default:if(n&&n.WTF&&!o)throw new Error("unrecognized "+u[0]+" in borders")}})}function CM(t,e,r,n){e.Fills=[];var i={},o=!1;(t[0].match(gn)||[]).forEach(function(c){var u=st(c);switch(oi(u[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":i={},e.Fills.push(i);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":e.Fills.push(i),i={};break;case"<patternFill":case"<patternFill>":u.patternType&&(i.patternType=u.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":i.bgColor||(i.bgColor={}),u.indexed&&(i.bgColor.indexed=parseInt(u.indexed,10)),u.theme&&(i.bgColor.theme=parseInt(u.theme,10)),u.tint&&(i.bgColor.tint=parseFloat(u.tint)),u.rgb&&(i.bgColor.rgb=u.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":i.fgColor||(i.fgColor={}),u.theme&&(i.fgColor.theme=parseInt(u.theme,10)),u.tint&&(i.fgColor.tint=parseFloat(u.tint)),u.rgb!=null&&(i.fgColor.rgb=u.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":o=!0;break;case"</ext>":o=!1;break;default:if(n&&n.WTF&&!o)throw new Error("unrecognized "+u[0]+" in fills")}})}function RM(t,e,r,n){e.Fonts=[];var i={},o=!1;(t[0].match(gn)||[]).forEach(function(c){var u=st(c);switch(oi(u[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":e.Fonts.push(i),i={};break;case"<name":u.val&&(i.name=Jt(u.val));break;case"<name/>":case"</name>":break;case"<b":i.bold=u.val?ir(u.val):1;break;case"<b/>":i.bold=1;break;case"<i":i.italic=u.val?ir(u.val):1;break;case"<i/>":i.italic=1;break;case"<u":switch(u.val){case"none":i.underline=0;break;case"single":i.underline=1;break;case"double":i.underline=2;break;case"singleAccounting":i.underline=33;break;case"doubleAccounting":i.underline=34;break}break;case"<u/>":i.underline=1;break;case"<strike":i.strike=u.val?ir(u.val):1;break;case"<strike/>":i.strike=1;break;case"<outline":i.outline=u.val?ir(u.val):1;break;case"<outline/>":i.outline=1;break;case"<shadow":i.shadow=u.val?ir(u.val):1;break;case"<shadow/>":i.shadow=1;break;case"<condense":i.condense=u.val?ir(u.val):1;break;case"<condense/>":i.condense=1;break;case"<extend":i.extend=u.val?ir(u.val):1;break;case"<extend/>":i.extend=1;break;case"<sz":u.val&&(i.sz=+u.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":u.val&&(i.vertAlign=u.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":u.val&&(i.family=parseInt(u.val,10));break;case"<family/>":case"</family>":break;case"<scheme":u.val&&(i.scheme=u.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(u.val=="1")break;u.codepage=L1[parseInt(u.val,10)];break;case"<color":if(i.color||(i.color={}),u.auto&&(i.color.auto=ir(u.auto)),u.rgb)i.color.rgb=u.rgb.slice(-6);else if(u.indexed){i.color.index=parseInt(u.indexed,10);var h=No[i.color.index];i.color.index==81&&(h=No[1]),h||(h=No[1]),i.color.rgb=h[0].toString(16)+h[1].toString(16)+h[2].toString(16)}else u.theme&&(i.color.theme=parseInt(u.theme,10),u.tint&&(i.color.tint=parseFloat(u.tint)),u.theme&&r.themeElements&&r.themeElements.clrScheme&&(i.color.rgb=Z0(r.themeElements.clrScheme[i.color.theme].rgb,i.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":o=!0;break;case"</AlternateContent>":o=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":o=!0;break;case"</ext>":o=!1;break;default:if(n&&n.WTF&&!o)throw new Error("unrecognized "+u[0]+" in fonts")}})}function kM(t,e,r){e.NumberFmt=[];for(var n=Gs(ht),i=0;i<n.length;++i)e.NumberFmt[n[i]]=ht[n[i]];var o=t[0].match(gn);if(o)for(i=0;i<o.length;++i){var c=st(o[i]);switch(oi(c[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var u=Nt(Jt(c.formatCode)),h=parseInt(c.numFmtId,10);if(e.NumberFmt[h]=u,h>0){if(h>392){for(h=392;h>60&&e.NumberFmt[h]!=null;--h);e.NumberFmt[h]=u}Oo(u,h)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+c[0]+" in numFmts")}}}var u0=["numFmtId","fillId","fontId","borderId","xfId"],f0=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function bM(t,e,r){e.CellXf=[];var n,i=!1;(t[0].match(gn)||[]).forEach(function(o){var c=st(o),u=0;switch(oi(c[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=c,delete n[0],u=0;u<u0.length;++u)n[u0[u]]&&(n[u0[u]]=parseInt(n[u0[u]],10));for(u=0;u<f0.length;++u)n[f0[u]]&&(n[f0[u]]=ir(n[f0[u]]));if(e.NumberFmt&&n.numFmtId>392){for(u=392;u>60;--u)if(e.NumberFmt[n.numFmtId]==e.NumberFmt[u]){n.numFmtId=u;break}}e.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var h={};c.vertical&&(h.vertical=c.vertical),c.horizontal&&(h.horizontal=c.horizontal),c.textRotation!=null&&(h.textRotation=c.textRotation),c.indent&&(h.indent=c.indent),c.wrapText&&(h.wrapText=ir(c.wrapText)),n.alignment=h;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":i=!0;break;case"</AlternateContent>":i=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(r&&r.WTF&&!i)throw new Error("unrecognized "+c[0]+" in cellXfs")}})}var IM=function(){var e=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,i=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,o=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(u,h,p){var g={};if(!u)return g;u=u.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var _;return(_=u.match(e))&&kM(_,g,p),(_=u.match(i))&&RM(_,g,h,p),(_=u.match(n))&&CM(_,g,h,p),(_=u.match(o))&&SM(_,g,h,p),(_=u.match(r))&&bM(_,g,p),g}}();function DM(t,e){var r=t.read_shift(2),n=dn(t);return[r,n]}function OM(t,e,r){var n={};n.sz=t.read_shift(2)/20;var i=zF(t);i.fItalic&&(n.italic=1),i.fCondense&&(n.condense=1),i.fExtend&&(n.extend=1),i.fShadow&&(n.shadow=1),i.fOutline&&(n.outline=1),i.fStrikeout&&(n.strike=1);var o=t.read_shift(2);switch(o===700&&(n.bold=1),t.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var c=t.read_shift(1);c!=0&&(n.underline=c);var u=t.read_shift(1);u>0&&(n.family=u);var h=t.read_shift(1);switch(h>0&&(n.charset=h),t.l++,n.color=jF(t),t.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=dn(t),n}var NM=mn;function FM(t,e){var r=t.l+e,n=t.read_shift(2),i=t.read_shift(2);return t.l=r,{ixfe:n,numFmtId:i}}var PM=mn;function MM(t,e,r){var n={};n.NumberFmt=[];for(var i in ht)n.NumberFmt[i]=ht[i];n.CellXf=[],n.Fonts=[];var o=[],c=!1;return Hi(t,function(h,p,g){switch(g){case 44:n.NumberFmt[h[0]]=h[1],Oo(h[1],h[0]);break;case 43:n.Fonts.push(h),h.color.theme!=null&&e&&e.themeElements&&e.themeElements.clrScheme&&(h.color.rgb=Z0(e.themeElements.clrScheme[h.color.theme].rgb,h.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:o[o.length-1]==617&&n.CellXf.push(h);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:c=!0;break;case 36:c=!1;break;case 37:o.push(g),c=!0;break;case 38:o.pop(),c=!1;break;default:if(p.T>0)o.push(g);else if(p.T<0)o.pop();else if(!c||r.WTF&&o[o.length-1]!=37)throw new Error("Unexpected record 0x"+g.toString(16))}}),n}var LM=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function VM(t,e,r){e.themeElements.clrScheme=[];var n={};(t[0].match(gn)||[]).forEach(function(i){var o=st(i);switch(o[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=o.val;break;case"<a:sysClr":n.rgb=o.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":o[0].charAt(1)==="/"?(e.themeElements.clrScheme[LM.indexOf(o[0])]=n,n={}):n.name=o[0].slice(3,o[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+o[0]+" in clrScheme")}})}function UM(){}function BM(){}var jM=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,zM=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,HM=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function GM(t,e,r){e.themeElements={};var n;[["clrScheme",jM,VM],["fontScheme",zM,UM],["fmtScheme",HM,BM]].forEach(function(i){if(!(n=t.match(i[1])))throw new Error(i[0]+" not found in themeElements");i[2](n,e,r)})}var qM=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function u4(t,e){(!t||t.length===0)&&(t=KM());var r,n={};if(!(r=t.match(qM)))throw new Error("themeElements not found in theme");return GM(r[0],n,e),n.raw=t,n}function KM(t,e){var r=[yS];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function WM(t,e,r){var n=t.l+e,i=t.read_shift(4);if(i!==124226){if(!r.cellStyles){t.l=n;return}var o=t.slice(t.l);t.l=n;var c;try{c=xS(o,{type:"array"})}catch{return}var u=Kn(c,"theme/theme/theme1.xml",!0);if(u)return u4(u,r)}}function XM(t){return t.read_shift(4)}function YM(t){var e={};switch(e.xclrType=t.read_shift(2),e.nTintShade=t.read_shift(2),e.xclrType){case 0:t.l+=4;break;case 1:e.xclrValue=$M(t,4);break;case 2:e.xclrValue=$S(t);break;case 3:e.xclrValue=XM(t);break;case 4:t.l+=4;break}return t.l+=8,e}function $M(t,e){return mn(t,e)}function QM(t,e){return mn(t,e)}function ZM(t){var e=t.read_shift(2),r=t.read_shift(2)-4,n=[e];switch(e){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=YM(t);break;case 6:n[1]=QM(t,r);break;case 14:case 15:n[1]=t.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+e+" "+r)}return n}function JM(t,e){var r=t.l+e;t.l+=2;var n=t.read_shift(2);t.l+=2;for(var i=t.read_shift(2),o=[];i-- >0;)o.push(ZM(t,r-t.l));return{ixfe:n,ext:o}}function e5(t,e){e.forEach(function(r){r[0]})}function t5(t,e){return{flags:t.read_shift(4),version:t.read_shift(4),name:dn(t)}}function r5(t){for(var e=[],r=t.read_shift(4);r-- >0;)e.push([t.read_shift(4),t.read_shift(4)]);return e}function n5(t){return t.l+=4,t.read_shift(4)!=0}function a5(t,e,r){var n={Types:[],Cell:[],Value:[]},i=r||{},o=[],c=!1,u=2;return Hi(t,function(h,p,g){switch(g){case 335:n.Types.push({name:h.name});break;case 51:h.forEach(function(_){u==1?n.Cell.push({type:n.Types[_[0]-1].name,index:_[1]}):u==0&&n.Value.push({type:n.Types[_[0]-1].name,index:_[1]})});break;case 337:u=h?1:0;break;case 338:u=2;break;case 35:o.push(g),c=!0;break;case 36:o.pop(),c=!1;break;default:if(!p.T){if(!c||i.WTF&&o[o.length-1]!=35)throw new Error("Unexpected record 0x"+g.toString(16))}}}),n}function i5(t,e,r){var n={Types:[],Cell:[],Value:[]};if(!t)return n;var i=!1,o=2,c;return t.replace(gn,function(u){var h=st(u);switch(oi(h[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:h.name});break;case"</metadataType>":break;case"<futureMetadata":for(var p=0;p<n.Types.length;++p)n.Types[p].name==h.name&&(c=n.Types[p]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":o==1?n.Cell.push({type:n.Types[h.t-1].name,index:+h.v}):o==0&&n.Value.push({type:n.Types[h.t-1].name,index:+h.v});break;case"</rc>":break;case"<cellMetadata":o=1;break;case"</cellMetadata>":o=2;break;case"<valueMetadata":o=0;break;case"</valueMetadata>":o=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;case"<rvb":if(!c)break;c.offsets||(c.offsets=[]),c.offsets.push(+h.i);break;default:if(!i&&r.WTF)throw new Error("unrecognized "+h[0]+" in metadata")}return u}),n}function s5(t){var e=[];if(!t)return e;var r=1;return(t.match(gn)||[]).forEach(function(n){var i=st(n);switch(i[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete i[0],i.i?r=i.i:i.i=r,e.push(i);break}}),e}function o5(t){var e={};e.i=t.read_shift(4);var r={};r.r=t.read_shift(4),r.c=t.read_shift(4),e.r=vt(r);var n=t.read_shift(1);return n&2&&(e.l="1"),n&8&&(e.a="1"),e}function l5(t,e,r){var n=[];return Hi(t,function(o,c,u){switch(u){case 63:n.push(o);break;default:if(!c.T)throw new Error("Unexpected record 0x"+u.toString(16))}}),n}function c5(t,e,r,n){if(!t)return t;var i=n||{},o=!1;Hi(t,function(u,h,p){switch(p){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:o=!0;break;case 36:o=!1;break;default:if(!h.T){if(!o||i.WTF)throw new Error("Unexpected record 0x"+p.toString(16))}}},i)}function u5(t,e){if(!t)return"??";var r=(t.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return e["!id"][r].Target}function XT(t,e,r,n){var i=Array.isArray(t),o;e.forEach(function(c){var u=Ia(c.ref);if(i?(t[u.r]||(t[u.r]=[]),o=t[u.r][u.c]):o=t[c.ref],!o){o={t:"z"},i?t[u.r][u.c]=o:t[c.ref]=o;var h=qr(t["!ref"]||"BDWGO1000001:A1");h.s.r>u.r&&(h.s.r=u.r),h.e.r<u.r&&(h.e.r=u.r),h.s.c>u.c&&(h.s.c=u.c),h.e.c<u.c&&(h.e.c=u.c);var p=qt(h);p!==t["!ref"]&&(t["!ref"]=p)}o.c||(o.c=[]);var g={a:c.author,t:c.t,r:c.r,T:r};c.h&&(g.h=c.h);for(var _=o.c.length-1;_>=0;--_){if(!r&&o.c[_].T)return;r&&!o.c[_].T&&o.c.splice(_,1)}if(r&&n){for(_=0;_<n.length;++_)if(g.a==n[_].id){g.a=n[_].name||g.a;break}}o.c.push(g)})}function f5(t,e){if(t.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],n=[],i=t.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);i&&i[1]&&i[1].split(/<\/\w*:?author>/).forEach(function(c){if(!(c===""||c.trim()==="")){var u=c.match(/<(?:\w+:)?author[^>]*>(.*)/);u&&r.push(u[1])}});var o=t.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return o&&o[1]&&o[1].split(/<\/\w*:?comment>/).forEach(function(c){if(!(c===""||c.trim()==="")){var u=c.match(/<(?:\w+:)?comment[^>]*>/);if(u){var h=st(u[0]),p={author:h.authorId&&r[h.authorId]||"sheetjsghost",ref:h.ref,guid:h.guid},g=Ia(h.ref);if(!(e.sheetRows&&e.sheetRows<=g.r)){var _=c.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),x=!!_&&!!_[1]&&Z1(_[1])||{r:"",t:"",h:""};p.r=x.r,x.r=="<t></t>"&&(x.t=x.h=""),p.t=(x.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.cellHTML&&(p.h=x.h),n.push(p)}}}}),n}function h5(t,e){var r=[],n=!1,i={},o=0;return t.replace(gn,function(u,h){var p=st(u);switch(oi(p[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":i={author:p.personId,guid:p.id,ref:p.ref,T:1};break;case"</threadedComment>":i.t!=null&&r.push(i);break;case"<text>":case"<text":o=h+u.length;break;case"</text>":i.t=t.slice(o,h).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&e.WTF)throw new Error("unrecognized "+p[0]+" in threaded comments")}return u}),r}function d5(t,e){var r=[],n=!1;return t.replace(gn,function(o){var c=st(o);switch(oi(c[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:c.displayname,id:c.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&e.WTF)throw new Error("unrecognized "+c[0]+" in threaded comments")}return o}),r}function p5(t){var e={};e.iauthor=t.read_shift(4);var r=Jo(t);return e.rfx=r.s,e.ref=vt(r.s),t.l+=16,e}var m5=dn;function g5(t,e){var r=[],n=[],i={},o=!1;return Hi(t,function(u,h,p){switch(p){case 632:n.push(u);break;case 635:i=u;break;case 637:i.t=u.t,i.h=u.h,i.r=u.r;break;case 636:if(i.author=n[i.iauthor],delete i.iauthor,e.sheetRows&&i.rfx&&e.sheetRows<=i.rfx.r)break;i.t||(i.t=""),delete i.rfx,r.push(i);break;case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:break;case 38:break;default:if(!h.T){if(!o||e.WTF)throw new Error("Unexpected record 0x"+p.toString(16))}}}),r}var v5="application/vnd.ms-office.vbaProject";function _5(t){var e=Dt.utils.cfb_new({root:"R"});return t.FullPaths.forEach(function(r,n){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var i=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");Dt.utils.cfb_add(e,i,t.FileIndex[n].content)}}),Dt.write(e)}function x5(){return{"!type":"dialog"}}function y5(){return{"!type":"dialog"}}function E5(){return{"!type":"macro"}}function T5(){return{"!type":"macro"}}var tc=function(){var t=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,e={r:0,c:0};function r(n,i,o,c){var u=!1,h=!1;o.length==0?h=!0:o.charAt(0)=="["&&(h=!0,o=o.slice(1,-1)),c.length==0?u=!0:c.charAt(0)=="["&&(u=!0,c=c.slice(1,-1));var p=o.length>0?parseInt(o,10)|0:0,g=c.length>0?parseInt(c,10)|0:0;return u?g+=e.c:--g,h?p+=e.r:--p,i+(u?"":"$")+wn(g)+(h?"":"$")+Xn(p)}return function(i,o){return e=o,i.replace(t,r)}}(),f4=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,A5=function(){return function(e,r){return e.replace(f4,function(n,i,o,c,u,h){var p=VS(c)-(o?0:r.c),g=LS(h)-(u?0:r.r),_=g==0?"":u?g+1:"["+g+"]",x=p==0?"":o?p+1:"["+p+"]";return i+"R"+_+"C"+x})}}();function h4(t,e){return t.replace(f4,function(r,n,i,o,c,u){return n+(i=="$"?i+o:wn(VS(o)+e.c))+(c=="$"?c+u:Xn(LS(u)+e.r))})}function w5(t,e,r){var n=K1(e),i=n.s,o=Ia(r),c={r:o.r-i.r,c:o.c-i.c};return h4(t,c)}function S5(t){return t.length!=1}function YT(t){return t.replace(/_xlfn\./g,"")}function Tr(t){t.l+=1}function qs(t,e){var r=t.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function d4(t,e,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return p4(t);r.biff==12&&(n=4)}var i=t.read_shift(n),o=t.read_shift(n),c=qs(t),u=qs(t);return{s:{r:i,c:c[0],cRel:c[1],rRel:c[2]},e:{r:o,c:u[0],cRel:u[1],rRel:u[2]}}}function p4(t){var e=qs(t),r=qs(t),n=t.read_shift(1),i=t.read_shift(1);return{s:{r:e[0],c:n,cRel:e[1],rRel:e[2]},e:{r:r[0],c:i,cRel:r[1],rRel:r[2]}}}function C5(t,e,r){if(r.biff<8)return p4(t);var n=t.read_shift(r.biff==12?4:2),i=t.read_shift(r.biff==12?4:2),o=qs(t),c=qs(t);return{s:{r:n,c:o[0],cRel:o[1],rRel:o[2]},e:{r:i,c:c[0],cRel:c[1],rRel:c[2]}}}function m4(t,e,r){if(r&&r.biff>=2&&r.biff<=5)return R5(t);var n=t.read_shift(r&&r.biff==12?4:2),i=qs(t);return{r:n,c:i[0],cRel:i[1],rRel:i[2]}}function R5(t){var e=qs(t),r=t.read_shift(1);return{r:e[0],c:r,cRel:e[1],rRel:e[2]}}function k5(t){var e=t.read_shift(2),r=t.read_shift(2);return{r:e,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function b5(t,e,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return I5(t);var i=t.read_shift(n>=12?4:2),o=t.read_shift(2),c=(o&16384)>>14,u=(o&32768)>>15;if(o&=16383,u==1)for(;i>524287;)i-=1048576;if(c==1)for(;o>8191;)o=o-16384;return{r:i,c:o,cRel:c,rRel:u}}function I5(t){var e=t.read_shift(2),r=t.read_shift(1),n=(e&32768)>>15,i=(e&16384)>>14;return e&=16383,n==1&&e>=8192&&(e=e-16384),i==1&&r>=128&&(r=r-256),{r:e,c:r,cRel:i,rRel:n}}function D5(t,e,r){var n=(t[t.l++]&96)>>5,i=d4(t,r.biff>=2&&r.biff<=5?6:8,r);return[n,i]}function O5(t,e,r){var n=(t[t.l++]&96)>>5,i=t.read_shift(2,"i"),o=8;if(r)switch(r.biff){case 5:t.l+=12,o=6;break;case 12:o=12;break}var c=d4(t,o,r);return[n,i,c]}function N5(t,e,r){var n=(t[t.l++]&96)>>5;return t.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function F5(t,e,r){var n=(t[t.l++]&96)>>5,i=t.read_shift(2),o=8;if(r)switch(r.biff){case 5:t.l+=12,o=6;break;case 12:o=12;break}return t.l+=o,[n,i]}function P5(t,e,r){var n=(t[t.l++]&96)>>5,i=C5(t,e-1,r);return[n,i]}function M5(t,e,r){var n=(t[t.l++]&96)>>5;return t.l+=r.biff==2?6:r.biff==12?14:7,[n]}function $T(t){var e=t[t.l+1]&1,r=1;return t.l+=4,[e,r]}function L5(t,e,r){t.l+=2;for(var n=t.read_shift(r&&r.biff==2?1:2),i=[],o=0;o<=n;++o)i.push(t.read_shift(r&&r.biff==2?1:2));return i}function V5(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=2,[n,t.read_shift(r&&r.biff==2?1:2)]}function U5(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=2,[n,t.read_shift(r&&r.biff==2?1:2)]}function B5(t){var e=t[t.l+1]&255?1:0;return t.l+=2,[e,t.read_shift(2)]}function j5(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=r&&r.biff==2?3:4,[n]}function g4(t){var e=t.read_shift(1),r=t.read_shift(1);return[e,r]}function z5(t){return t.read_shift(2),g4(t)}function H5(t){return t.read_shift(2),g4(t)}function G5(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var i=m4(t,0,r);return[n,i]}function q5(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var i=b5(t,0,r);return[n,i]}function K5(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var i=t.read_shift(2);r&&r.biff==5&&(t.l+=12);var o=m4(t,0,r);return[n,i,o]}function W5(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var i=t.read_shift(r&&r.biff<=3?1:2);return[X9[i],x4[i],n]}function X5(t,e,r){var n=t[t.l++],i=t.read_shift(1),o=r&&r.biff<=3?[n==88?-1:0,t.read_shift(1)]:Y5(t);return[i,(o[0]===0?x4:W9)[o[1]]]}function Y5(t){return[t[t.l+1]>>7,t.read_shift(2)&32767]}function $5(t,e,r){t.l+=r&&r.biff==2?3:4}function Q5(t,e,r){if(t.l++,r&&r.biff==12)return[t.read_shift(4,"i"),0];var n=t.read_shift(2),i=t.read_shift(r&&r.biff==2?1:2);return[n,i]}function Z5(t){return t.l++,el[t.read_shift(1)]}function J5(t){return t.l++,t.read_shift(2)}function e9(t){return t.l++,t.read_shift(1)!==0}function t9(t){return t.l++,fn(t)}function r9(t,e,r){return t.l++,Df(t,e-1,r)}function n9(t,e){var r=[t.read_shift(1)];if(e==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=gr(t,1)?"TRUE":"FALSE",e!=12&&(t.l+=7);break;case 37:case 16:r[1]=el[t[t.l]],t.l+=e==12?4:8;break;case 0:t.l+=8;break;case 1:r[1]=fn(t);break;case 2:r[1]=tl(t,0,{biff:e>0&&e<8?2:e});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function a9(t,e,r){for(var n=t.read_shift(r.biff==12?4:2),i=[],o=0;o!=n;++o)i.push((r.biff==12?Jo:kd)(t));return i}function i9(t,e,r){var n=0,i=0;r.biff==12?(n=t.read_shift(4),i=t.read_shift(4)):(i=1+t.read_shift(1),n=1+t.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--i==0&&(i=256));for(var o=0,c=[];o!=n&&(c[o]=[]);++o)for(var u=0;u!=i;++u)c[o][u]=n9(t,r.biff);return c}function s9(t,e,r){var n=t.read_shift(1)>>>5&3,i=!r||r.biff>=8?4:2,o=t.read_shift(i);switch(r.biff){case 2:t.l+=5;break;case 3:case 4:t.l+=8;break;case 5:t.l+=12;break}return[n,0,o]}function o9(t,e,r){if(r.biff==5)return l9(t);var n=t.read_shift(1)>>>5&3,i=t.read_shift(2),o=t.read_shift(4);return[n,i,o]}function l9(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2,"i");t.l+=8;var n=t.read_shift(2);return t.l+=12,[e,r,n]}function c9(t,e,r){var n=t.read_shift(1)>>>5&3;t.l+=r&&r.biff==2?3:4;var i=t.read_shift(r&&r.biff==2?1:2);return[n,i]}function u9(t,e,r){var n=t.read_shift(1)>>>5&3,i=t.read_shift(r&&r.biff==2?1:2);return[n,i]}function f9(t,e,r){var n=t.read_shift(1)>>>5&3;return t.l+=4,r.biff<8&&t.l--,r.biff==12&&(t.l+=2),[n]}function h9(t,e,r){var n=(t[t.l++]&96)>>5,i=t.read_shift(2),o=4;if(r)switch(r.biff){case 5:o=15;break;case 12:o=6;break}return t.l+=o,[n,i]}var d9=mn,p9=mn,m9=mn;function Nf(t,e,r){return t.l+=2,[k5(t)]}function ev(t){return t.l+=6,[]}var g9=Nf,v9=ev,_9=ev,x9=Nf;function v4(t){return t.l+=2,[Sr(t),t.read_shift(2)&1]}var y9=Nf,E9=v4,T9=ev,A9=Nf,w9=Nf,S9=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function C9(t){t.l+=2;var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(4),i=t.read_shift(2),o=t.read_shift(2),c=S9[r>>2&31];return{ixti:e,coltype:r&3,rt:c,idx:n,c:i,C:o}}function R9(t){return t.l+=2,[t.read_shift(4)]}function k9(t,e,r){return t.l+=5,t.l+=2,t.l+=r.biff==2?1:4,["PTGSHEET"]}function b9(t,e,r){return t.l+=r.biff==2?4:5,["PTGENDSHEET"]}function I9(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2);return[e,r]}function D9(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2);return[e,r]}function O9(t){return t.l+=4,[0,0]}var QT={1:{n:"PtgExp",f:Q5},2:{n:"PtgTbl",f:m9},3:{n:"PtgAdd",f:Tr},4:{n:"PtgSub",f:Tr},5:{n:"PtgMul",f:Tr},6:{n:"PtgDiv",f:Tr},7:{n:"PtgPower",f:Tr},8:{n:"PtgConcat",f:Tr},9:{n:"PtgLt",f:Tr},10:{n:"PtgLe",f:Tr},11:{n:"PtgEq",f:Tr},12:{n:"PtgGe",f:Tr},13:{n:"PtgGt",f:Tr},14:{n:"PtgNe",f:Tr},15:{n:"PtgIsect",f:Tr},16:{n:"PtgUnion",f:Tr},17:{n:"PtgRange",f:Tr},18:{n:"PtgUplus",f:Tr},19:{n:"PtgUminus",f:Tr},20:{n:"PtgPercent",f:Tr},21:{n:"PtgParen",f:Tr},22:{n:"PtgMissArg",f:Tr},23:{n:"PtgStr",f:r9},26:{n:"PtgSheet",f:k9},27:{n:"PtgEndSheet",f:b9},28:{n:"PtgErr",f:Z5},29:{n:"PtgBool",f:e9},30:{n:"PtgInt",f:J5},31:{n:"PtgNum",f:t9},32:{n:"PtgArray",f:M5},33:{n:"PtgFunc",f:W5},34:{n:"PtgFuncVar",f:X5},35:{n:"PtgName",f:s9},36:{n:"PtgRef",f:G5},37:{n:"PtgArea",f:D5},38:{n:"PtgMemArea",f:c9},39:{n:"PtgMemErr",f:d9},40:{n:"PtgMemNoMem",f:p9},41:{n:"PtgMemFunc",f:u9},42:{n:"PtgRefErr",f:f9},43:{n:"PtgAreaErr",f:N5},44:{n:"PtgRefN",f:q5},45:{n:"PtgAreaN",f:P5},46:{n:"PtgMemAreaN",f:I9},47:{n:"PtgMemNoMemN",f:D9},57:{n:"PtgNameX",f:o9},58:{n:"PtgRef3d",f:K5},59:{n:"PtgArea3d",f:O5},60:{n:"PtgRefErr3d",f:h9},61:{n:"PtgAreaErr3d",f:F5},255:{}},N9={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},F9={1:{n:"PtgElfLel",f:v4},2:{n:"PtgElfRw",f:A9},3:{n:"PtgElfCol",f:g9},6:{n:"PtgElfRwV",f:w9},7:{n:"PtgElfColV",f:x9},10:{n:"PtgElfRadical",f:y9},11:{n:"PtgElfRadicalS",f:T9},13:{n:"PtgElfColS",f:v9},15:{n:"PtgElfColSV",f:_9},16:{n:"PtgElfRadicalLel",f:E9},25:{n:"PtgList",f:C9},29:{n:"PtgSxName",f:R9},255:{}},P9={0:{n:"PtgAttrNoop",f:O9},1:{n:"PtgAttrSemi",f:j5},2:{n:"PtgAttrIf",f:U5},4:{n:"PtgAttrChoose",f:L5},8:{n:"PtgAttrGoto",f:V5},16:{n:"PtgAttrSum",f:$5},32:{n:"PtgAttrBaxcel",f:$T},33:{n:"PtgAttrBaxcel",f:$T},64:{n:"PtgAttrSpace",f:z5},65:{n:"PtgAttrSpaceSemi",f:H5},128:{n:"PtgAttrIfError",f:B5},255:{}};function Ff(t,e,r,n){if(n.biff<8)return mn(t,e);for(var i=t.l+e,o=[],c=0;c!==r.length;++c)switch(r[c][0]){case"PtgArray":r[c][1]=i9(t,0,n),o.push(r[c][1]);break;case"PtgMemArea":r[c][2]=a9(t,r[c][1],n),o.push(r[c][2]);break;case"PtgExp":n&&n.biff==12&&(r[c][1][1]=t.read_shift(4),o.push(r[c][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[c][0]}return e=i-t.l,e!==0&&o.push(mn(t,e)),o}function Pf(t,e,r){for(var n=t.l+e,i,o,c=[];n!=t.l;)e=n-t.l,o=t[t.l],i=QT[o]||QT[N9[o]],(o===24||o===25)&&(i=(o===24?F9:P9)[t[t.l+1]]),!i||!i.f?mn(t,e):c.push([i.n,i.f(t,e,r)]);return c}function M9(t){for(var e=[],r=0;r<t.length;++r){for(var n=t[r],i=[],o=0;o<n.length;++o){var c=n[o];if(c)switch(c[0]){case 2:i.push('"'+c[1].replace(/"/g,'""')+'"');break;default:i.push(c[1])}else i.push("")}e.push(i.join(","))}return e.join(";")}var L9={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function V9(t,e){if(!t&&!(e&&e.biff<=5&&e.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(t)?"'"+t+"'":t}function _4(t,e,r){if(!t)return"SH33TJSERR0";if(r.biff>8&&(!t.XTI||!t.XTI[e]))return t.SheetNames[e];if(!t.XTI)return"SH33TJSERR6";var n=t.XTI[e];if(r.biff<8)return e>1e4&&(e-=65536),e<0&&(e=-e),e==0?"":t.XTI[e-1];if(!n)return"SH33TJSERR1";var i="";if(r.biff>8)switch(t[n[0]][0]){case 357:return i=n[1]==-1?"#REF":t.SheetNames[n[1]],n[1]==n[2]?i:i+":"+t.SheetNames[n[2]];case 358:return r.SID!=null?t.SheetNames[r.SID]:"SH33TJSSAME"+t[n[0]][0];case 355:default:return"SH33TJSSRC"+t[n[0]][0]}switch(t[n[0]][0][0]){case 1025:return i=n[1]==-1?"#REF":t.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?i:i+":"+t.SheetNames[n[2]];case 14849:return t[n[0]].slice(1).map(function(o){return o.Name}).join(";;");default:return t[n[0]][0][3]?(i=n[1]==-1?"#REF":t[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?i:i+":"+t[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function ZT(t,e,r){var n=_4(t,e,r);return n=="#REF"?n:V9(n,r)}function cn(t,e,r,n,i){var o=i&&i.biff||8,c={s:{c:0,r:0}},u=[],h,p,g,_=0,x=0,T,w="";if(!t[0]||!t[0][0])return"";for(var S=-1,C="",z=0,Y=t[0].length;z<Y;++z){var L=t[0][z];switch(L[0]){case"PtgUminus":u.push("-"+u.pop());break;case"PtgUplus":u.push("+"+u.pop());break;case"PtgPercent":u.push(u.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(h=u.pop(),p=u.pop(),S>=0){switch(t[0][S][1][0]){case 0:C=fr(" ",t[0][S][1][1]);break;case 1:C=fr("\r",t[0][S][1][1]);break;default:if(C="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][S][1][0])}p=p+C,S=-1}u.push(p+L9[L[0]]+h);break;case"PtgIsect":h=u.pop(),p=u.pop(),u.push(p+" "+h);break;case"PtgUnion":h=u.pop(),p=u.pop(),u.push(p+","+h);break;case"PtgRange":h=u.pop(),p=u.pop(),u.push(p+":"+h);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":g=Vu(L[1][1],c,i),u.push(Uu(g,o));break;case"PtgRefN":g=r?Vu(L[1][1],r,i):L[1][1],u.push(Uu(g,o));break;case"PtgRef3d":_=L[1][1],g=Vu(L[1][2],c,i),w=ZT(n,_,i),u.push(w+"!"+Uu(g,o));break;case"PtgFunc":case"PtgFuncVar":var K=L[1][0],Z=L[1][1];K||(K=0),K&=127;var re=K==0?[]:u.slice(-K);u.length-=K,Z==="User"&&(Z=re.shift()),u.push(Z+"("+re.join(",")+")");break;case"PtgBool":u.push(L[1]?"TRUE":"FALSE");break;case"PtgInt":u.push(L[1]);break;case"PtgNum":u.push(String(L[1]));break;case"PtgStr":u.push('"'+L[1].replace(/"/g,'""')+'"');break;case"PtgErr":u.push(L[1]);break;case"PtgAreaN":T=OT(L[1][1],r?{s:r}:c,i),u.push(Xm(T,i));break;case"PtgArea":T=OT(L[1][1],c,i),u.push(Xm(T,i));break;case"PtgArea3d":_=L[1][1],T=L[1][2],w=ZT(n,_,i),u.push(w+"!"+Xm(T,i));break;case"PtgAttrSum":u.push("SUM("+u.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":x=L[1][2];var k=(n.names||[])[x-1]||(n[0]||[])[x],A=k?k.Name:"SH33TJSNAME"+String(x);A&&A.slice(0,6)=="_xlfn."&&!i.xlfn&&(A=A.slice(6)),u.push(A);break;case"PtgNameX":var E=L[1][1];x=L[1][2];var I;if(i.biff<=5)E<0&&(E=-E),n[E]&&(I=n[E][x]);else{var O="";if(((n[E]||[])[0]||[])[0]==14849||(((n[E]||[])[0]||[])[0]==1025?n[E][x]&&n[E][x].itab>0&&(O=n.SheetNames[n[E][x].itab-1]+"!"):O=n.SheetNames[x-1]+"!"),n[E]&&n[E][x])O+=n[E][x].Name;else if(n[0]&&n[0][x])O+=n[0][x].Name;else{var D=(_4(n,E,i)||"").split(";;");D[x-1]?O=D[x-1]:O+="SH33TJSERRX"}u.push(O);break}I||(I={Name:"SH33TJSERRY"}),u.push(I.Name);break;case"PtgParen":var F="(",Fe=")";if(S>=0){switch(C="",t[0][S][1][0]){case 2:F=fr(" ",t[0][S][1][1])+F;break;case 3:F=fr("\r",t[0][S][1][1])+F;break;case 4:Fe=fr(" ",t[0][S][1][1])+Fe;break;case 5:Fe=fr("\r",t[0][S][1][1])+Fe;break;default:if(i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][S][1][0])}S=-1}u.push(F+u.pop()+Fe);break;case"PtgRefErr":u.push("#REF!");break;case"PtgRefErr3d":u.push("#REF!");break;case"PtgExp":g={c:L[1][1],r:L[1][0]};var Ce={c:r.c,r:r.r};if(n.sharedf[vt(g)]){var ae=n.sharedf[vt(g)];u.push(cn(ae,c,Ce,n,i))}else{var oe=!1;for(h=0;h!=n.arrayf.length;++h)if(p=n.arrayf[h],!(g.c<p[0].s.c||g.c>p[0].e.c)&&!(g.r<p[0].s.r||g.r>p[0].e.r)){u.push(cn(p[1],c,Ce,n,i)),oe=!0;break}oe||u.push(L[1])}break;case"PtgArray":u.push("{"+M9(L[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":S=z;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":u.push("");break;case"PtgAreaErr":u.push("#REF!");break;case"PtgAreaErr3d":u.push("#REF!");break;case"PtgList":u.push("Table"+L[1].idx+"[#"+L[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(L));default:throw new Error("Unrecognized Formula Token: "+String(L))}var be=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(i.biff!=3&&S>=0&&be.indexOf(t[0][z][0])==-1){L=t[0][S];var ne=!0;switch(L[1][0]){case 4:ne=!1;case 0:C=fr(" ",L[1][1]);break;case 5:ne=!1;case 1:C=fr("\r",L[1][1]);break;default:if(C="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+L[1][0])}u.push((ne?C:"")+u.pop()+(ne?"":C)),S=-1}}if(u.length>1&&i.WTF)throw new Error("bad formula stack");return u[0]}function U9(t,e,r){var n=t.l+e,i=r.biff==2?1:2,o,c=t.read_shift(i);if(c==65535)return[[],mn(t,e-2)];var u=Pf(t,c,r);return e!==c+i&&(o=Ff(t,e-c-i,u,r)),t.l=n,[u,o]}function B9(t,e,r){var n=t.l+e,i=r.biff==2?1:2,o,c=t.read_shift(i);if(c==65535)return[[],mn(t,e-2)];var u=Pf(t,c,r);return e!==c+i&&(o=Ff(t,e-c-i,u,r)),t.l=n,[u,o]}function j9(t,e,r,n){var i=t.l+e,o=Pf(t,n,r),c;return i!==t.l&&(c=Ff(t,i-t.l,o,r)),[o,c]}function z9(t,e,r){var n=t.l+e,i,o=t.read_shift(2),c=Pf(t,o,r);return o==65535?[[],mn(t,e-2)]:(e!==o+2&&(i=Ff(t,n-o-2,c,r)),[c,i])}function H9(t){var e;if(Ni(t,t.l+6)!==65535)return[fn(t),"n"];switch(t[t.l]){case 0:return t.l+=8,["String","s"];case 1:return e=t[t.l+2]===1,t.l+=8,[e,"b"];case 2:return e=t[t.l+2],t.l+=8,[e,"e"];case 3:return t.l+=8,["","s"]}return[]}function Qm(t,e,r){var n=t.l+e,i=li(t);r.biff==2&&++t.l;var o=H9(t),c=t.read_shift(1);r.biff!=2&&(t.read_shift(1),r.biff>=5&&t.read_shift(4));var u=B9(t,n-t.l,r);return{cell:i,val:o[0],formula:u,shared:c>>3&1,tt:o[1]}}function bd(t,e,r){var n=t.read_shift(4),i=Pf(t,n,r),o=t.read_shift(4),c=o>0?Ff(t,o,i,r):null;return[i,c]}var G9=bd,Id=bd,q9=bd,K9=bd,W9={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},x4={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},X9={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function JT(t){return t.slice(0,3)=="of:"&&(t=t.slice(3)),t.charCodeAt(0)==61&&(t=t.slice(1),t.charCodeAt(0)==61&&(t=t.slice(1))),t=t.replace(/COM\.MICROSOFT\./g,""),t=t.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(e,r){return r.replace(/\./g,"")}),t=t.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),t.replace(/[;~]/g,",").replace(/\|/g,";")}function Zm(t){var e=t.split(":"),r=e[0].split(".")[0];return[r,e[0].split(".")[1]+(e.length>1?":"+(e[1].split(".")[1]||e[1].split(".")[0]):"")]}var Hu={},rc={};function Gu(t,e){if(t){var r=[.7,.7,.75,.75,.3,.3];e=="xlml"&&(r=[1,1,1,1,.5,.5]),t.left==null&&(t.left=r[0]),t.right==null&&(t.right=r[1]),t.top==null&&(t.top=r[2]),t.bottom==null&&(t.bottom=r[3]),t.header==null&&(t.header=r[4]),t.footer==null&&(t.footer=r[5])}}function y4(t,e,r,n,i,o){try{n.cellNF&&(t.z=ht[e])}catch(u){if(n.WTF)throw u}if(!(t.t==="z"&&!n.cellStyles)){if(t.t==="d"&&typeof t.v=="string"&&(t.v=Jr(t.v)),(!n||n.cellText!==!1)&&t.t!=="z")try{if(ht[e]==null&&Oo(Q6[e]||"General",e),t.t==="e")t.w=t.w||el[t.v];else if(e===0)if(t.t==="n")(t.v|0)===t.v?t.w=t.v.toString(10):t.w=af(t.v);else if(t.t==="d"){var c=$n(t.v);(c|0)===c?t.w=c.toString(10):t.w=af(c)}else{if(t.v===void 0)return"";t.w=Uo(t.v,rc)}else t.t==="d"?t.w=ga(e,$n(t.v),rc):t.w=ga(e,t.v,rc)}catch(u){if(n.WTF)throw u}if(n.cellStyles&&r!=null)try{t.s=o.Fills[r],t.s.fgColor&&t.s.fgColor.theme&&!t.s.fgColor.rgb&&(t.s.fgColor.rgb=Z0(i.themeElements.clrScheme[t.s.fgColor.theme].rgb,t.s.fgColor.tint||0),n.WTF&&(t.s.fgColor.raw_rgb=i.themeElements.clrScheme[t.s.fgColor.theme].rgb)),t.s.bgColor&&t.s.bgColor.theme&&(t.s.bgColor.rgb=Z0(i.themeElements.clrScheme[t.s.bgColor.theme].rgb,t.s.bgColor.tint||0),n.WTF&&(t.s.bgColor.raw_rgb=i.themeElements.clrScheme[t.s.bgColor.theme].rgb))}catch(u){if(n.WTF&&o.Fills)throw u}}}function Y9(t,e){var r=qr(e);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(t["!ref"]=qt(r))}var $9=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,Q9=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,Z9=/<(?:\w:)?hyperlink [^>]*>/mg,J9=/"(\w*:\w*)"/,eL=/<(?:\w:)?col\b[^>]*[\/]?>/g,tL=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,rL=/<(?:\w:)?pageMargins[^>]*\/>/g,E4=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,nL=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,aL=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function iL(t,e,r,n,i,o,c){if(!t)return t;n||(n={"!id":{}});var u=e.dense?[]:{},h={s:{r:2e6,c:2e6},e:{r:0,c:0}},p="",g="",_=t.match(Q9);_?(p=t.slice(0,_.index),g=t.slice(_.index+_[0].length)):p=g=t;var x=p.match(E4);x?tv(x[0],u,i,r):(x=p.match(nL))&&sL(x[0],x[1]||"",u,i,r);var T=(p.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(T>0){var w=p.slice(T,T+50).match(J9);w&&Y9(u,w[1])}var S=p.match(aL);S&&S[1]&&hL(S[1],i);var C=[];if(e.cellStyles){var z=p.match(eL);z&&cL(C,z)}_&&dL(_[1],u,e,h,o,c);var Y=g.match(tL);Y&&(u["!autofilter"]=uL(Y[0]));var L=[],K=g.match($9);if(K)for(T=0;T!=K.length;++T)L[T]=qr(K[T].slice(K[T].indexOf('"')+1));var Z=g.match(Z9);Z&&oL(u,Z,n);var re=g.match(rL);if(re&&(u["!margins"]=lL(st(re[0]))),!u["!ref"]&&h.e.c>=h.s.c&&h.e.r>=h.s.r&&(u["!ref"]=qt(h)),e.sheetRows>0&&u["!ref"]){var k=qr(u["!ref"]);e.sheetRows<=+k.e.r&&(k.e.r=e.sheetRows-1,k.e.r>h.e.r&&(k.e.r=h.e.r),k.e.r<k.s.r&&(k.s.r=k.e.r),k.e.c>h.e.c&&(k.e.c=h.e.c),k.e.c<k.s.c&&(k.s.c=k.e.c),u["!fullref"]=u["!ref"],u["!ref"]=qt(k))}return C.length>0&&(u["!cols"]=C),L.length>0&&(u["!merges"]=L),u}function tv(t,e,r,n){var i=st(t);r.Sheets[n]||(r.Sheets[n]={}),i.codeName&&(r.Sheets[n].CodeName=Nt(Jt(i.codeName)))}function sL(t,e,r,n,i){tv(t.slice(0,t.indexOf(">")),r,n,i)}function oL(t,e,r){for(var n=Array.isArray(t),i=0;i!=e.length;++i){var o=st(Jt(e[i]),!0);if(!o.ref)return;var c=((r||{})["!id"]||[])[o.id];c?(o.Target=c.Target,o.location&&(o.Target+="#"+Nt(o.location))):(o.Target="#"+Nt(o.location),c={Target:o.Target,TargetMode:"Internal"}),o.Rel=c,o.tooltip&&(o.Tooltip=o.tooltip,delete o.tooltip);for(var u=qr(o.ref),h=u.s.r;h<=u.e.r;++h)for(var p=u.s.c;p<=u.e.c;++p){var g=vt({c:p,r:h});n?(t[h]||(t[h]=[]),t[h][p]||(t[h][p]={t:"z",v:void 0}),t[h][p].l=o):(t[g]||(t[g]={t:"z",v:void 0}),t[g].l=o)}}}function lL(t){var e={};return["left","right","top","bottom","header","footer"].forEach(function(r){t[r]&&(e[r]=parseFloat(t[r]))}),e}function cL(t,e){for(var r=!1,n=0;n!=e.length;++n){var i=st(e[n],!0);i.hidden&&(i.hidden=ir(i.hidden));var o=parseInt(i.min,10)-1,c=parseInt(i.max,10)-1;for(i.outlineLevel&&(i.level=+i.outlineLevel||0),delete i.min,delete i.max,i.width=+i.width,!r&&i.width&&(r=!0,J1(i.width)),fc(i);o<=c;)t[o++]=en(i)}}function uL(t){var e={ref:(t.match(/ref="([^"]*)"/)||[])[1]};return e}var fL=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function hL(t,e){e.Views||(e.Views=[{}]),(t.match(fL)||[]).forEach(function(r,n){var i=st(r);e.Views[n]||(e.Views[n]={}),+i.zoomScale&&(e.Views[n].zoom=+i.zoomScale),ir(i.rightToLeft)&&(e.Views[n].RTL=!0)})}var dL=function(){var t=/<(?:\w+:)?c[ \/>]/,e=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,i=/ref=["']([^"']*)["']/,o=of("v"),c=of("f");return function(h,p,g,_,x,T){for(var w=0,S="",C=[],z=[],Y=0,L=0,K=0,Z="",re,k,A=0,E=0,I,O,D=0,F=0,Fe=Array.isArray(T.CellXf),Ce,ae=[],oe=[],be=Array.isArray(p),ne=[],G={},se=!1,P=!!g.sheetStubs,j=h.split(e),J=0,ee=j.length;J!=ee;++J){S=j[J].trim();var ue=S.length;if(ue!==0){var Ie=0;e:for(w=0;w<ue;++w)switch(S[w]){case">":if(S[w-1]!="/"){++w;break e}if(g&&g.cellStyles){if(k=st(S.slice(Ie,w),!0),A=k.r!=null?parseInt(k.r,10):A+1,E=-1,g.sheetRows&&g.sheetRows<A)continue;G={},se=!1,k.ht&&(se=!0,G.hpt=parseFloat(k.ht),G.hpx=ff(G.hpt)),k.hidden=="1"&&(se=!0,G.hidden=!0),k.outlineLevel!=null&&(se=!0,G.level=+k.outlineLevel),se&&(ne[A-1]=G)}break;case"<":Ie=w;break}if(Ie>=w)break;if(k=st(S.slice(Ie,w),!0),A=k.r!=null?parseInt(k.r,10):A+1,E=-1,!(g.sheetRows&&g.sheetRows<A)){_.s.r>A-1&&(_.s.r=A-1),_.e.r<A-1&&(_.e.r=A-1),g&&g.cellStyles&&(G={},se=!1,k.ht&&(se=!0,G.hpt=parseFloat(k.ht),G.hpx=ff(G.hpt)),k.hidden=="1"&&(se=!0,G.hidden=!0),k.outlineLevel!=null&&(se=!0,G.level=+k.outlineLevel),se&&(ne[A-1]=G)),C=S.slice(w).split(t);for(var Ee=0;Ee!=C.length&&C[Ee].trim().charAt(0)=="<";++Ee);for(C=C.slice(Ee),w=0;w!=C.length;++w)if(S=C[w].trim(),S.length!==0){if(z=S.match(r),Y=w,L=0,K=0,S="<c "+(S.slice(0,1)=="<"?">":"")+S,z!=null&&z.length===2){for(Y=0,Z=z[1],L=0;L!=Z.length&&!((K=Z.charCodeAt(L)-64)<1||K>26);++L)Y=26*Y+K;--Y,E=Y}else++E;for(L=0;L!=S.length&&S.charCodeAt(L)!==62;++L);if(++L,k=st(S.slice(0,L),!0),k.r||(k.r=vt({r:A-1,c:E})),Z=S.slice(L),re={t:""},(z=Z.match(o))!=null&&z[1]!==""&&(re.v=Nt(z[1])),g.cellFormula){if((z=Z.match(c))!=null&&z[1]!==""){if(re.f=Nt(Jt(z[1])).replace(/\r\n/g,`
`),g.xlfn||(re.f=YT(re.f)),z[0].indexOf('t="array"')>-1)re.F=(Z.match(i)||[])[1],re.F.indexOf(":")>-1&&ae.push([qr(re.F),re.F]);else if(z[0].indexOf('t="shared"')>-1){O=st(z[0]);var we=Nt(Jt(z[1]));g.xlfn||(we=YT(we)),oe[parseInt(O.si,10)]=[O,we,k.r]}}else(z=Z.match(/<f[^>]*\/>/))&&(O=st(z[0]),oe[O.si]&&(re.f=w5(oe[O.si][1],oe[O.si][2],k.r)));var Te=Ia(k.r);for(L=0;L<ae.length;++L)Te.r>=ae[L][0].s.r&&Te.r<=ae[L][0].e.r&&Te.c>=ae[L][0].s.c&&Te.c<=ae[L][0].e.c&&(re.F=ae[L][1])}if(k.t==null&&re.v===void 0)if(re.f||re.F)re.v=0,re.t="n";else if(P)re.t="z";else continue;else re.t=k.t||"n";switch(_.s.c>E&&(_.s.c=E),_.e.c<E&&(_.e.c=E),re.t){case"n":if(re.v==""||re.v==null){if(!P)continue;re.t="z"}else re.v=parseFloat(re.v);break;case"s":if(typeof re.v>"u"){if(!P)continue;re.t="z"}else I=Hu[parseInt(re.v,10)],re.v=I.t,re.r=I.r,g.cellHTML&&(re.h=I.h);break;case"str":re.t="s",re.v=re.v!=null?Jt(re.v):"",g.cellHTML&&(re.h=TS(re.v));break;case"inlineStr":z=Z.match(n),re.t="s",z!=null&&(I=Z1(z[1]))?(re.v=I.t,g.cellHTML&&(re.h=I.h)):re.v="";break;case"b":re.v=ir(re.v);break;case"d":g.cellDates?re.v=Jr(re.v,1):(re.v=$n(Jr(re.v,1)),re.t="n");break;case"e":(!g||g.cellText!==!1)&&(re.w=re.v),re.v=zS[re.v];break}if(D=F=0,Ce=null,Fe&&k.s!==void 0&&(Ce=T.CellXf[k.s],Ce!=null&&(Ce.numFmtId!=null&&(D=Ce.numFmtId),g.cellStyles&&Ce.fillId!=null&&(F=Ce.fillId))),y4(re,D,F,g,x,T),g.cellDates&&Fe&&re.t=="n"&&xc(ht[D])&&(re.t="d",re.v=Rd(re.v)),k.cm&&g.xlmeta){var Ue=(g.xlmeta.Cell||[])[+k.cm-1];Ue&&Ue.type=="XLDAPR"&&(re.D=!0)}if(be){var W=Ia(k.r);p[W.r]||(p[W.r]=[]),p[W.r][W.c]=re}else p[k.r]=re}}}}ne.length>0&&(p["!rows"]=ne)}}();function pL(t,e){var r={},n=t.l+e;r.r=t.read_shift(4),t.l+=4;var i=t.read_shift(2);t.l+=1;var o=t.read_shift(1);return t.l=n,o&7&&(r.level=o&7),o&16&&(r.hidden=!0),o&32&&(r.hpt=i/20),r}var mL=Jo;function gL(){}function vL(t,e){var r={},n=t[t.l];return++t.l,r.above=!(n&64),r.left=!(n&128),t.l+=18,r.name=UF(t),r}function _L(t){var e=va(t);return[e]}function xL(t){var e=Zo(t);return[e]}function yL(t){var e=va(t),r=t.read_shift(1);return[e,r,"b"]}function EL(t){var e=Zo(t),r=t.read_shift(1);return[e,r,"b"]}function TL(t){var e=va(t),r=t.read_shift(1);return[e,r,"e"]}function AL(t){var e=Zo(t),r=t.read_shift(1);return[e,r,"e"]}function wL(t){var e=va(t),r=t.read_shift(4);return[e,r,"s"]}function SL(t){var e=Zo(t),r=t.read_shift(4);return[e,r,"s"]}function CL(t){var e=va(t),r=fn(t);return[e,r,"n"]}function T4(t){var e=Zo(t),r=fn(t);return[e,r,"n"]}function RL(t){var e=va(t),r=Y1(t);return[e,r,"n"]}function kL(t){var e=Zo(t),r=Y1(t);return[e,r,"n"]}function bL(t){var e=va(t),r=W1(t);return[e,r,"is"]}function IL(t){var e=va(t),r=dn(t);return[e,r,"str"]}function DL(t){var e=Zo(t),r=dn(t);return[e,r,"str"]}function OL(t,e,r){var n=t.l+e,i=va(t);i.r=r["!row"];var o=t.read_shift(1),c=[i,o,"b"];if(r.cellFormula){t.l+=2;var u=Id(t,n-t.l,r);c[3]=cn(u,null,i,r.supbooks,r)}else t.l=n;return c}function NL(t,e,r){var n=t.l+e,i=va(t);i.r=r["!row"];var o=t.read_shift(1),c=[i,o,"e"];if(r.cellFormula){t.l+=2;var u=Id(t,n-t.l,r);c[3]=cn(u,null,i,r.supbooks,r)}else t.l=n;return c}function FL(t,e,r){var n=t.l+e,i=va(t);i.r=r["!row"];var o=fn(t),c=[i,o,"n"];if(r.cellFormula){t.l+=2;var u=Id(t,n-t.l,r);c[3]=cn(u,null,i,r.supbooks,r)}else t.l=n;return c}function PL(t,e,r){var n=t.l+e,i=va(t);i.r=r["!row"];var o=dn(t),c=[i,o,"str"];if(r.cellFormula){t.l+=2;var u=Id(t,n-t.l,r);c[3]=cn(u,null,i,r.supbooks,r)}else t.l=n;return c}var ML=Jo;function LL(t,e){var r=t.l+e,n=Jo(t),i=X1(t),o=dn(t),c=dn(t),u=dn(t);t.l=r;var h={rfx:n,relId:i,loc:o,display:u};return c&&(h.Tooltip=c),h}function VL(){}function UL(t,e,r){var n=t.l+e,i=US(t),o=t.read_shift(1),c=[i];if(c[2]=o,r.cellFormula){var u=G9(t,n-t.l,r);c[1]=u}else t.l=n;return c}function BL(t,e,r){var n=t.l+e,i=Jo(t),o=[i];if(r.cellFormula){var c=K9(t,n-t.l,r);o[1]=c,t.l=n}else t.l=n;return o}var jL=["left","right","top","bottom","header","footer"];function zL(t){var e={};return jL.forEach(function(r){e[r]=fn(t)}),e}function HL(t){var e=t.read_shift(2);return t.l+=28,{RTL:e&32}}function GL(){}function qL(){}function KL(t,e,r,n,i,o,c){if(!t)return t;var u=e||{};n||(n={"!id":{}});var h=u.dense?[]:{},p,g={s:{r:2e6,c:2e6},e:{r:0,c:0}},_=!1,x=!1,T,w,S,C,z,Y,L,K,Z,re=[];u.biff=12,u["!row"]=0;var k=0,A=!1,E=[],I={},O=u.supbooks||i.supbooks||[[]];if(O.sharedf=I,O.arrayf=E,O.SheetNames=i.SheetNames||i.Sheets.map(function(be){return be.name}),!u.supbooks&&(u.supbooks=O,i.Names))for(var D=0;D<i.Names.length;++D)O[0][D+1]=i.Names[D];var F=[],Fe=[],Ce=!1;td[16]={n:"BrtShortReal",f:T4};var ae;if(Hi(t,function(ne,G,se){if(!x)switch(se){case 148:p=ne;break;case 0:T=ne,u.sheetRows&&u.sheetRows<=T.r&&(x=!0),K=Xn(C=T.r),u["!row"]=T.r,(ne.hidden||ne.hpt||ne.level!=null)&&(ne.hpt&&(ne.hpx=ff(ne.hpt)),Fe[ne.r]=ne);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(w={t:ne[2]},ne[2]){case"n":w.v=ne[1];break;case"s":L=Hu[ne[1]],w.v=L.t,w.r=L.r;break;case"b":w.v=!!ne[1];break;case"e":w.v=ne[1],u.cellText!==!1&&(w.w=el[w.v]);break;case"str":w.t="s",w.v=ne[1];break;case"is":w.t="s",w.v=ne[1].t;break}if((S=c.CellXf[ne[0].iStyleRef])&&y4(w,S.numFmtId,null,u,o,c),z=ne[0].c==-1?z+1:ne[0].c,u.dense?(h[C]||(h[C]=[]),h[C][z]=w):h[wn(z)+K]=w,u.cellFormula){for(A=!1,k=0;k<E.length;++k){var P=E[k];T.r>=P[0].s.r&&T.r<=P[0].e.r&&z>=P[0].s.c&&z<=P[0].e.c&&(w.F=qt(P[0]),A=!0)}!A&&ne.length>3&&(w.f=ne[3])}if(g.s.r>T.r&&(g.s.r=T.r),g.s.c>z&&(g.s.c=z),g.e.r<T.r&&(g.e.r=T.r),g.e.c<z&&(g.e.c=z),u.cellDates&&S&&w.t=="n"&&xc(ht[S.numFmtId])){var j=bo(w.v);j&&(w.t="d",w.v=new Date(j.y,j.m-1,j.d,j.H,j.M,j.S,j.u))}ae&&(ae.type=="XLDAPR"&&(w.D=!0),ae=void 0);break;case 1:case 12:if(!u.sheetStubs||_)break;w={t:"z",v:void 0},z=ne[0].c==-1?z+1:ne[0].c,u.dense?(h[C]||(h[C]=[]),h[C][z]=w):h[wn(z)+K]=w,g.s.r>T.r&&(g.s.r=T.r),g.s.c>z&&(g.s.c=z),g.e.r<T.r&&(g.e.r=T.r),g.e.c<z&&(g.e.c=z),ae&&(ae.type=="XLDAPR"&&(w.D=!0),ae=void 0);break;case 176:re.push(ne);break;case 49:ae=((u.xlmeta||{}).Cell||[])[ne-1];break;case 494:var J=n["!id"][ne.relId];for(J?(ne.Target=J.Target,ne.loc&&(ne.Target+="#"+ne.loc),ne.Rel=J):ne.relId==""&&(ne.Target="#"+ne.loc),C=ne.rfx.s.r;C<=ne.rfx.e.r;++C)for(z=ne.rfx.s.c;z<=ne.rfx.e.c;++z)u.dense?(h[C]||(h[C]=[]),h[C][z]||(h[C][z]={t:"z",v:void 0}),h[C][z].l=ne):(Y=vt({c:z,r:C}),h[Y]||(h[Y]={t:"z",v:void 0}),h[Y].l=ne);break;case 426:if(!u.cellFormula)break;E.push(ne),Z=u.dense?h[C][z]:h[wn(z)+K],Z.f=cn(ne[1],g,{r:T.r,c:z},O,u),Z.F=qt(ne[0]);break;case 427:if(!u.cellFormula)break;I[vt(ne[0].s)]=ne[1],Z=u.dense?h[C][z]:h[wn(z)+K],Z.f=cn(ne[1],g,{r:T.r,c:z},O,u);break;case 60:if(!u.cellStyles)break;for(;ne.e>=ne.s;)F[ne.e--]={width:ne.w/256,hidden:!!(ne.flags&1),level:ne.level},Ce||(Ce=!0,J1(ne.w/256)),fc(F[ne.e+1]);break;case 161:h["!autofilter"]={ref:qt(ne)};break;case 476:h["!margins"]=ne;break;case 147:i.Sheets[r]||(i.Sheets[r]={}),ne.name&&(i.Sheets[r].CodeName=ne.name),(ne.above||ne.left)&&(h["!outline"]={above:ne.above,left:ne.left});break;case 137:i.Views||(i.Views=[{}]),i.Views[0]||(i.Views[0]={}),ne.RTL&&(i.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:_=!0;break;case 36:_=!1;break;case 37:_=!0;break;case 38:_=!1;break;default:if(!G.T){if(!_||u.WTF)throw new Error("Unexpected record 0x"+se.toString(16))}}},u),delete u.supbooks,delete u["!row"],!h["!ref"]&&(g.s.r<2e6||p&&(p.e.r>0||p.e.c>0||p.s.r>0||p.s.c>0))&&(h["!ref"]=qt(p||g)),u.sheetRows&&h["!ref"]){var oe=qr(h["!ref"]);u.sheetRows<=+oe.e.r&&(oe.e.r=u.sheetRows-1,oe.e.r>g.e.r&&(oe.e.r=g.e.r),oe.e.r<oe.s.r&&(oe.s.r=oe.e.r),oe.e.c>g.e.c&&(oe.e.c=g.e.c),oe.e.c<oe.s.c&&(oe.s.c=oe.e.c),h["!fullref"]=h["!ref"],h["!ref"]=qt(oe))}return re.length>0&&(h["!merges"]=re),F.length>0&&(h["!cols"]=F),Fe.length>0&&(h["!rows"]=Fe),h}function WL(t){var e=[],r=t.match(/^<c:numCache>/),n;(t.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(o){var c=o.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);c&&(e[+c[1]]=r?+c[2]:c[2])});var i=Nt((t.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(t.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(o){n=o.replace(/<.*?>/g,"")}),[e,i,n]}function XL(t,e,r,n,i,o){var c=o||{"!type":"chart"};if(!t)return o;var u=0,h=0,p="A",g={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(t.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(_){var x=WL(_);g.s.r=g.s.c=0,g.e.c=u,p=wn(u),x[0].forEach(function(T,w){c[p+Xn(w)]={t:"n",v:T,z:x[1]},h=w}),g.e.r<h&&(g.e.r=h),++u}),u>0&&(c["!ref"]=qt(g)),c}function YL(t,e,r,n,i){if(!t)return t;n||(n={"!id":{}});var o={"!type":"chart","!drawel":null,"!rel":""},c,u=t.match(E4);return u&&tv(u[0],o,i,r),(c=t.match(/drawing r:id="(.*?)"/))&&(o["!rel"]=c[1]),n["!id"][o["!rel"]]&&(o["!drawel"]=n["!id"][o["!rel"]]),o}function $L(t,e){t.l+=10;var r=dn(t);return{name:r}}function QL(t,e,r,n,i){if(!t)return t;n||(n={"!id":{}});var o={"!type":"chart","!drawel":null,"!rel":""},c=!1;return Hi(t,function(h,p,g){switch(g){case 550:o["!rel"]=h;break;case 651:i.Sheets[r]||(i.Sheets[r]={}),h.name&&(i.Sheets[r].CodeName=h.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:c=!0;break;case 36:c=!1;break;case 37:break;case 38:break;default:if(!(p.T>0)){if(!(p.T<0)){if(!c||e.WTF)throw new Error("Unexpected record 0x"+g.toString(16))}}}},e),n["!id"][o["!rel"]]&&(o["!drawel"]=n["!id"][o["!rel"]]),o}var A4=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],ZL=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],JL=[],e7=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function e2(t,e){for(var r=0;r!=t.length;++r)for(var n=t[r],i=0;i!=e.length;++i){var o=e[i];if(n[o[0]]==null)n[o[0]]=o[1];else switch(o[2]){case"bool":typeof n[o[0]]=="string"&&(n[o[0]]=ir(n[o[0]]));break;case"int":typeof n[o[0]]=="string"&&(n[o[0]]=parseInt(n[o[0]],10));break}}}function t2(t,e){for(var r=0;r!=e.length;++r){var n=e[r];if(t[n[0]]==null)t[n[0]]=n[1];else switch(n[2]){case"bool":typeof t[n[0]]=="string"&&(t[n[0]]=ir(t[n[0]]));break;case"int":typeof t[n[0]]=="string"&&(t[n[0]]=parseInt(t[n[0]],10));break}}}function w4(t){t2(t.WBProps,A4),t2(t.CalcPr,e7),e2(t.WBView,ZL),e2(t.Sheets,JL),rc.date1904=ir(t.WBProps.date1904)}var t7="][*?/\\".split("");function r7(t,e){if(t.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return t7.forEach(function(n){if(t.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}var n7=/<\w+:workbook/;function a7(t,e){if(!t)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,i="xmlns",o={},c=0;if(t.replace(gn,function(h,p){var g=st(h);switch(oi(g[0])){case"<?xml":break;case"<workbook":h.match(n7)&&(i="xmlns"+h.match(/<(\w+):/)[1]),r.xmlns=g[i];break;case"</workbook>":break;case"<fileVersion":delete g[0],r.AppVersion=g;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":A4.forEach(function(_){if(g[_[0]]!=null)switch(_[2]){case"bool":r.WBProps[_[0]]=ir(g[_[0]]);break;case"int":r.WBProps[_[0]]=parseInt(g[_[0]],10);break;default:r.WBProps[_[0]]=g[_[0]]}}),g.codeName&&(r.WBProps.CodeName=Jt(g.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete g[0],r.WBView.push(g);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(g.state){case"hidden":g.Hidden=1;break;case"veryHidden":g.Hidden=2;break;default:g.Hidden=0}delete g.state,g.name=Nt(Jt(g.name)),delete g[0],r.Sheets.push(g);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":o={},o.Name=Jt(g.name),g.comment&&(o.Comment=g.comment),g.localSheetId&&(o.Sheet=+g.localSheetId),ir(g.hidden||"0")&&(o.Hidden=!0),c=p+h.length;break;case"</definedName>":o.Ref=Nt(Jt(t.slice(c,p))),r.Names.push(o);break;case"<definedName/>":break;case"<calcPr":delete g[0],r.CalcPr=g;break;case"<calcPr/>":delete g[0],r.CalcPr=g;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&e.WTF)throw new Error("unrecognized "+g[0]+" in workbook")}return h}),TF.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return w4(r),r}function i7(t,e){var r={};return r.Hidden=t.read_shift(4),r.iTabID=t.read_shift(4),r.strRelID=Ig(t),r.name=dn(t),r}function s7(t,e){var r={},n=t.read_shift(4);r.defaultThemeVersion=t.read_shift(4);var i=e>8?dn(t):"";return i.length>0&&(r.CodeName=i),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function o7(t,e){var r={};return t.read_shift(4),r.ArchID=t.read_shift(4),t.l+=e-8,r}function l7(t,e,r){var n=t.l+e;t.l+=4,t.l+=1;var i=t.read_shift(4),o=BF(t),c=q9(t,0,r),u=X1(t);t.l=n;var h={Name:o,Ptg:c};return i<268435455&&(h.Sheet=i),u&&(h.Comment=u),h}function c7(t,e){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],i=!1;e||(e={}),e.biff=12;var o=[],c=[[]];return c.SheetNames=[],c.XTI=[],td[16]={n:"BrtFRTArchID$",f:o7},Hi(t,function(h,p,g){switch(g){case 156:c.SheetNames.push(h.name),r.Sheets.push(h);break;case 153:r.WBProps=h;break;case 39:h.Sheet!=null&&(e.SID=h.Sheet),h.Ref=cn(h.Ptg,null,null,c,e),delete e.SID,delete h.Ptg,o.push(h);break;case 1036:break;case 357:case 358:case 355:case 667:c[0].length?c.push([g,h]):c[0]=[g,h],c[c.length-1].XTI=[];break;case 362:c.length===0&&(c[0]=[],c[0].XTI=[]),c[c.length-1].XTI=c[c.length-1].XTI.concat(h),c.XTI=c.XTI.concat(h);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(g),i=!0;break;case 36:n.pop(),i=!1;break;case 37:n.push(g),i=!0;break;case 38:n.pop(),i=!1;break;case 16:break;default:if(!p.T){if(!i||e.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+g.toString(16))}}},e),w4(r),r.Names=o,r.supbooks=c,r}function u7(t,e,r){return e.slice(-4)===".bin"?c7(t,r):a7(t,r)}function f7(t,e,r,n,i,o,c,u){return e.slice(-4)===".bin"?KL(t,n,r,i,o,c,u):iL(t,n,r,i,o,c,u)}function h7(t,e,r,n,i,o,c,u){return e.slice(-4)===".bin"?QL(t,n,r,i,o):YL(t,n,r,i,o)}function d7(t,e,r,n,i,o,c,u){return e.slice(-4)===".bin"?E5():T5()}function p7(t,e,r,n,i,o,c,u){return e.slice(-4)===".bin"?x5():y5()}function m7(t,e,r,n){return e.slice(-4)===".bin"?MM(t,r,n):IM(t,r,n)}function g7(t,e,r){return u4(t,r)}function v7(t,e,r){return e.slice(-4)===".bin"?ZP(t,r):$P(t,r)}function _7(t,e,r){return e.slice(-4)===".bin"?g5(t,r):f5(t,r)}function x7(t,e,r){return e.slice(-4)===".bin"?l5(t):s5(t)}function y7(t,e,r,n){return r.slice(-4)===".bin"?c5(t,e,r,n):void 0}function E7(t,e,r){return e.slice(-4)===".bin"?a5(t,e,r):i5(t,e,r)}var S4=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,C4=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function wa(t,e){var r=t.split(/\s+/),n=[];if(n[0]=r[0],r.length===1)return n;var i=t.match(S4),o,c,u,h;if(i)for(h=0;h!=i.length;++h)o=i[h].match(C4),(c=o[1].indexOf(":"))===-1?n[o[1]]=o[2].slice(1,o[2].length-1):(o[1].slice(0,6)==="xmlns:"?u="xmlns"+o[1].slice(6):u=o[1].slice(c+1),n[u]=o[2].slice(1,o[2].length-1));return n}function T7(t){var e=t.split(/\s+/),r={};if(e.length===1)return r;var n=t.match(S4),i,o,c,u;if(n)for(u=0;u!=n.length;++u)i=n[u].match(C4),(o=i[1].indexOf(":"))===-1?r[i[1]]=i[2].slice(1,i[2].length-1):(i[1].slice(0,6)==="xmlns:"?c="xmlns"+i[1].slice(6):c=i[1].slice(o+1),r[c]=i[2].slice(1,i[2].length-1));return r}var qu;function A7(t,e){var r=qu[t]||Nt(t);return r==="General"?Uo(e):ga(r,e)}function w7(t,e,r,n){var i=n;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":i=ir(n);break;case"i2":case"int":i=parseInt(n,10);break;case"r4":case"float":i=parseFloat(n);break;case"date":case"dateTime.tz":i=Jr(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}t[Nt(e)]=i}function S7(t,e,r){if(t.t!=="z"){if(!r||r.cellText!==!1)try{t.t==="e"?t.w=t.w||el[t.v]:e==="General"?t.t==="n"?(t.v|0)===t.v?t.w=t.v.toString(10):t.w=af(t.v):t.w=Uo(t.v):t.w=A7(e||"General",t.v)}catch(o){if(r.WTF)throw o}try{var n=qu[e]||e||"General";if(r.cellNF&&(t.z=n),r.cellDates&&t.t=="n"&&xc(n)){var i=bo(t.v);i&&(t.t="d",t.v=new Date(i.y,i.m-1,i.d,i.H,i.M,i.S,i.u))}}catch(o){if(r.WTF)throw o}}}function C7(t,e,r){if(r.cellStyles&&e.Interior){var n=e.Interior;n.Pattern&&(n.patternType=wM[n.Pattern]||n.Pattern)}t[e.ID]=e}function R7(t,e,r,n,i,o,c,u,h,p){var g="General",_=n.StyleID,x={};p=p||{};var T=[],w=0;for(_===void 0&&u&&(_=u.StyleID),_===void 0&&c&&(_=c.StyleID);o[_]!==void 0&&(o[_].nf&&(g=o[_].nf),o[_].Interior&&T.push(o[_].Interior),!!o[_].Parent);)_=o[_].Parent;switch(r.Type){case"Boolean":n.t="b",n.v=ir(t);break;case"String":n.t="s",n.r=AT(Nt(t)),n.v=t.indexOf("<")>-1?Nt(e||t).replace(/<.*?>/g,""):n.r;break;case"DateTime":t.slice(-1)!="Z"&&(t+="Z"),n.v=(Jr(t)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),n.v!==n.v?n.v=Nt(t):n.v<60&&(n.v=n.v-1),(!g||g=="General")&&(g="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+t),n.t||(n.t="n");break;case"Error":n.t="e",n.v=zS[t],p.cellText!==!1&&(n.w=t);break;default:t==""&&e==""?n.t="z":(n.t="s",n.v=AT(e||t));break}if(S7(n,g,p),p.cellFormula!==!1)if(n.Formula){var S=Nt(n.Formula);S.charCodeAt(0)==61&&(S=S.slice(1)),n.f=tc(S,i),delete n.Formula,n.ArrayRange=="RC"?n.F=tc("RC:RC",i):n.ArrayRange&&(n.F=tc(n.ArrayRange,i),h.push([qr(n.F),n.F]))}else for(w=0;w<h.length;++w)i.r>=h[w][0].s.r&&i.r<=h[w][0].e.r&&i.c>=h[w][0].s.c&&i.c<=h[w][0].e.c&&(n.F=h[w][1]);p.cellStyles&&(T.forEach(function(C){!x.patternType&&C.patternType&&(x.patternType=C.patternType)}),n.s=x),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function k7(t){t.t=t.v||"",t.t=t.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.v=t.w=t.ixfe=void 0}function Jm(t,e){var r=e||{};dS();var n=Ru(G1(t));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(n=Jt(n));var i=n.slice(0,1024).toLowerCase(),o=!1;if(i=i.replace(/".*?"/g,""),(i.indexOf(">")&1023)>Math.min(i.indexOf(",")&1023,i.indexOf(";")&1023)){var c=en(r);return c.type="string",cf.to_workbook(n,c)}if(i.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(Ye){i.indexOf("<"+Ye)>=0&&(o=!0)}),o)return F7(n,r);qu={"General Number":"General","General Date":ht[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":ht[15],"Short Date":ht[14],"Long Time":ht[19],"Medium Time":ht[18],"Short Time":ht[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:ht[2],Standard:ht[4],Percent:ht[10],Scientific:ht[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var u,h=[],p,g={},_=[],x=r.dense?[]:{},T="",w={},S={},C=wa('<Data ss:Type="String">'),z=0,Y=0,L=0,K={s:{r:2e6,c:2e6},e:{r:0,c:0}},Z={},re={},k="",A=0,E=[],I={},O={},D=0,F=[],Fe=[],Ce={},ae=[],oe,be=!1,ne=[],G=[],se={},P=0,j=0,J={Sheets:[],WBProps:{date1904:!1}},ee={};lf.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var ue="";u=lf.exec(n);)switch(u[3]=(ue=u[3]).toLowerCase()){case"data":if(ue=="data"){if(u[1]==="/"){if((p=h.pop())[0]!==u[3])throw new Error("Bad state: "+p.join("|"))}else u[0].charAt(u[0].length-2)!=="/"&&h.push([u[3],!0]);break}if(h[h.length-1][1])break;u[1]==="/"?R7(n.slice(z,u.index),k,C,h[h.length-1][0]=="comment"?Ce:w,{c:Y,r:L},Z,ae[Y],S,ne,r):(k="",C=wa(u[0]),z=u.index+u[0].length);break;case"cell":if(u[1]==="/")if(Fe.length>0&&(w.c=Fe),(!r.sheetRows||r.sheetRows>L)&&w.v!==void 0&&(r.dense?(x[L]||(x[L]=[]),x[L][Y]=w):x[wn(Y)+Xn(L)]=w),w.HRef&&(w.l={Target:Nt(w.HRef)},w.HRefScreenTip&&(w.l.Tooltip=w.HRefScreenTip),delete w.HRef,delete w.HRefScreenTip),(w.MergeAcross||w.MergeDown)&&(P=Y+(parseInt(w.MergeAcross,10)|0),j=L+(parseInt(w.MergeDown,10)|0),E.push({s:{c:Y,r:L},e:{c:P,r:j}})),!r.sheetStubs)w.MergeAcross?Y=P+1:++Y;else if(w.MergeAcross||w.MergeDown){for(var Ie=Y;Ie<=P;++Ie)for(var Ee=L;Ee<=j;++Ee)(Ie>Y||Ee>L)&&(r.dense?(x[Ee]||(x[Ee]=[]),x[Ee][Ie]={t:"z"}):x[wn(Ie)+Xn(Ee)]={t:"z"});Y=P+1}else++Y;else w=T7(u[0]),w.Index&&(Y=+w.Index-1),Y<K.s.c&&(K.s.c=Y),Y>K.e.c&&(K.e.c=Y),u[0].slice(-2)==="/>"&&++Y,Fe=[];break;case"row":u[1]==="/"||u[0].slice(-2)==="/>"?(L<K.s.r&&(K.s.r=L),L>K.e.r&&(K.e.r=L),u[0].slice(-2)==="/>"&&(S=wa(u[0]),S.Index&&(L=+S.Index-1)),Y=0,++L):(S=wa(u[0]),S.Index&&(L=+S.Index-1),se={},(S.AutoFitHeight=="0"||S.Height)&&(se.hpx=parseInt(S.Height,10),se.hpt=c4(se.hpx),G[L]=se),S.Hidden=="1"&&(se.hidden=!0,G[L]=se));break;case"worksheet":if(u[1]==="/"){if((p=h.pop())[0]!==u[3])throw new Error("Bad state: "+p.join("|"));_.push(T),K.s.r<=K.e.r&&K.s.c<=K.e.c&&(x["!ref"]=qt(K),r.sheetRows&&r.sheetRows<=K.e.r&&(x["!fullref"]=x["!ref"],K.e.r=r.sheetRows-1,x["!ref"]=qt(K))),E.length&&(x["!merges"]=E),ae.length>0&&(x["!cols"]=ae),G.length>0&&(x["!rows"]=G),g[T]=x}else K={s:{r:2e6,c:2e6},e:{r:0,c:0}},L=Y=0,h.push([u[3],!1]),p=wa(u[0]),T=Nt(p.Name),x=r.dense?[]:{},E=[],ne=[],G=[],ee={name:T,Hidden:0},J.Sheets.push(ee);break;case"table":if(u[1]==="/"){if((p=h.pop())[0]!==u[3])throw new Error("Bad state: "+p.join("|"))}else{if(u[0].slice(-2)=="/>")break;h.push([u[3],!1]),ae=[],be=!1}break;case"style":u[1]==="/"?C7(Z,re,r):re=wa(u[0]);break;case"numberformat":re.nf=Nt(wa(u[0]).Format||"General"),qu[re.nf]&&(re.nf=qu[re.nf]);for(var we=0;we!=392&&ht[we]!=re.nf;++we);if(we==392){for(we=57;we!=392;++we)if(ht[we]==null){Oo(re.nf,we);break}}break;case"column":if(h[h.length-1][0]!=="table")break;if(oe=wa(u[0]),oe.Hidden&&(oe.hidden=!0,delete oe.Hidden),oe.Width&&(oe.wpx=parseInt(oe.Width,10)),!be&&oe.wpx>10){be=!0,An=o4;for(var Te=0;Te<ae.length;++Te)ae[Te]&&fc(ae[Te])}be&&fc(oe),ae[oe.Index-1||ae.length]=oe;for(var Ue=0;Ue<+oe.Span;++Ue)ae[ae.length]=en(oe);break;case"namedrange":if(u[1]==="/")break;J.Names||(J.Names=[]);var W=st(u[0]),nt={Name:W.Name,Ref:tc(W.RefersTo.slice(1),{r:0,c:0})};J.Sheets.length>0&&(nt.Sheet=J.Sheets.length-1),J.Names.push(nt);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(u[0].slice(-2)==="/>")break;u[1]==="/"?k+=n.slice(A,u.index):A=u.index+u[0].length;break;case"interior":if(!r.cellStyles)break;re.Interior=wa(u[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(u[0].slice(-2)==="/>")break;u[1]==="/"?f8(I,ue,n.slice(D,u.index)):D=u.index+u[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(u[1]==="/"){if((p=h.pop())[0]!==u[3])throw new Error("Bad state: "+p.join("|"))}else h.push([u[3],!1]);break;case"comment":if(u[1]==="/"){if((p=h.pop())[0]!==u[3])throw new Error("Bad state: "+p.join("|"));k7(Ce),Fe.push(Ce)}else h.push([u[3],!1]),p=wa(u[0]),Ce={a:p.Author};break;case"autofilter":if(u[1]==="/"){if((p=h.pop())[0]!==u[3])throw new Error("Bad state: "+p.join("|"))}else if(u[0].charAt(u[0].length-2)!=="/"){var Ge=wa(u[0]);x["!autofilter"]={ref:tc(Ge.Range).replace(/\$/g,"")},h.push([u[3],!0])}break;case"name":break;case"datavalidation":if(u[1]==="/"){if((p=h.pop())[0]!==u[3])throw new Error("Bad state: "+p.join("|"))}else u[0].charAt(u[0].length-2)!=="/"&&h.push([u[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(u[1]==="/"){if((p=h.pop())[0]!==u[3])throw new Error("Bad state: "+p.join("|"))}else u[0].charAt(u[0].length-2)!=="/"&&h.push([u[3],!0]);break;case"null":break;default:if(h.length==0&&u[3]=="document"||h.length==0&&u[3]=="uof")return s2(n,r);var Ke=!0;switch(h[h.length-1][0]){case"officedocumentsettings":switch(u[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:Ke=!1}break;case"componentoptions":switch(u[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:Ke=!1}break;case"excelworkbook":switch(u[3]){case"date1904":J.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:Ke=!1}break;case"workbookoptions":switch(u[3]){case"owcversion":break;case"height":break;case"width":break;default:Ke=!1}break;case"worksheetoptions":switch(u[3]){case"visible":if(u[0].slice(-2)!=="/>")if(u[1]==="/")switch(n.slice(D,u.index)){case"SheetHidden":ee.Hidden=1;break;case"SheetVeryHidden":ee.Hidden=2;break}else D=u.index+u[0].length;break;case"header":x["!margins"]||Gu(x["!margins"]={},"xlml"),isNaN(+st(u[0]).Margin)||(x["!margins"].header=+st(u[0]).Margin);break;case"footer":x["!margins"]||Gu(x["!margins"]={},"xlml"),isNaN(+st(u[0]).Margin)||(x["!margins"].footer=+st(u[0]).Margin);break;case"pagemargins":var Be=st(u[0]);x["!margins"]||Gu(x["!margins"]={},"xlml"),isNaN(+Be.Top)||(x["!margins"].top=+Be.Top),isNaN(+Be.Left)||(x["!margins"].left=+Be.Left),isNaN(+Be.Right)||(x["!margins"].right=+Be.Right),isNaN(+Be.Bottom)||(x["!margins"].bottom=+Be.Bottom);break;case"displayrighttoleft":J.Views||(J.Views=[]),J.Views[0]||(J.Views[0]={}),J.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":x["!outline"]||(x["!outline"]={}),x["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":x["!outline"]||(x["!outline"]={}),x["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:Ke=!1}break;case"pivottable":case"pivotcache":switch(u[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:Ke=!1}break;case"pagebreaks":switch(u[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:Ke=!1}break;case"autofilter":switch(u[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:Ke=!1}break;case"querytable":switch(u[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:Ke=!1}break;case"datavalidation":switch(u[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:Ke=!1}break;case"sorting":case"conditionalformatting":switch(u[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:Ke=!1}break;case"mapinfo":case"schema":case"data":switch(u[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:Ke=!1}break;case"smarttags":break;default:Ke=!1;break}if(Ke||u[3].match(/!\[CDATA/))break;if(!h[h.length-1][1])throw"Unrecognized tag: "+u[3]+"|"+h.join("|");if(h[h.length-1][0]==="customdocumentproperties"){if(u[0].slice(-2)==="/>")break;u[1]==="/"?w7(O,ue,F,n.slice(D,u.index)):(F=u,D=u.index+u[0].length);break}if(r.WTF)throw"Unrecognized tag: "+u[3]+"|"+h.join("|")}var Ne={};return!r.bookSheets&&!r.bookProps&&(Ne.Sheets=g),Ne.SheetNames=_,Ne.Workbook=J,Ne.SSF=en(ht),Ne.Props=I,Ne.Custprops=O,Ne}function Fg(t,e){switch(av(e=e||{}),e.type||"base64"){case"base64":return Jm(Yn(t),e);case"binary":case"buffer":case"file":return Jm(t,e);case"array":return Jm($o(t),e)}}function b7(t){var e={},r=t.content;if(r.l=28,e.AnsiUserType=r.read_shift(0,"lpstr-ansi"),e.AnsiClipboardFormat=HF(r),r.length-r.l<=4)return e;var n=r.read_shift(4);if(n==0||n>40||(r.l-=4,e.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(n=r.read_shift(4),n!==1907505652)||(e.UnicodeClipboardFormat=GF(r),n=r.read_shift(4),n==0||n>40))return e;r.l-=4,e.Reserved2=r.read_shift(0,"lpwstr")}var I7=[60,1084,2066,2165,2175];function D7(t,e,r,n,i){var o=n,c=[],u=r.slice(r.l,r.l+o);if(i&&i.enc&&i.enc.insitu&&u.length>0)switch(t){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:i.enc.insitu(u)}c.push(u),r.l+=o;for(var h=Ni(r,r.l),p=Pg[h],g=0;p!=null&&I7.indexOf(h)>-1;)o=Ni(r,r.l+2),g=r.l+4,h==2066?g+=4:(h==2165||h==2175)&&(g+=12),u=r.slice(g,r.l+4+o),c.push(u),r.l+=4+o,p=Pg[h=Ni(r,r.l)];var _=ws(c);Qr(_,0);var x=0;_.lens=[];for(var T=0;T<c.length;++T)_.lens.push(x),x+=c[T].length;if(_.length<n)throw"XLS Record 0x"+t.toString(16)+" Truncated: "+_.length+" < "+n;return e.f(_,_.length,i)}function $a(t,e,r){if(t.t!=="z"&&t.XF){var n=0;try{n=t.z||t.XF.numFmtId||0,e.cellNF&&(t.z=ht[n])}catch(o){if(e.WTF)throw o}if(!e||e.cellText!==!1)try{t.t==="e"?t.w=t.w||el[t.v]:n===0||n=="General"?t.t==="n"?(t.v|0)===t.v?t.w=t.v.toString(10):t.w=af(t.v):t.w=Uo(t.v):t.w=ga(n,t.v,{date1904:!!r,dateNF:e&&e.dateNF})}catch(o){if(e.WTF)throw o}if(e.cellDates&&n&&t.t=="n"&&xc(ht[n]||String(n))){var i=bo(t.v);i&&(t.t="d",t.v=new Date(i.y,i.m-1,i.d,i.H,i.M,i.S,i.u))}}}function h0(t,e,r){return{v:t,ixfe:e,t:r}}function O7(t,e){var r={opts:{}},n={},i=e.dense?[]:{},o={},c={},u=null,h=[],p="",g={},_,x="",T,w,S,C,z={},Y=[],L,K,Z=[],re=[],k={Sheets:[],WBProps:{date1904:!1},Views:[{}]},A={},E=function(ot){return ot<8?No[ot]:ot<64&&re[ot-8]||No[ot]},I=function(ot,Ft,Vt){var Ot=Ft.XF.data;if(!(!Ot||!Ot.patternType||!Vt||!Vt.cellStyles)){Ft.s={},Ft.s.patternType=Ot.patternType;var Lr;(Lr=uf(E(Ot.icvFore)))&&(Ft.s.fgColor={rgb:Lr}),(Lr=uf(E(Ot.icvBack)))&&(Ft.s.bgColor={rgb:Lr})}},O=function(ot,Ft,Vt){if(!(se>1)&&!(Vt.sheetRows&&ot.r>=Vt.sheetRows)){if(Vt.cellStyles&&Ft.XF&&Ft.XF.data&&I(ot,Ft,Vt),delete Ft.ixfe,delete Ft.XF,_=ot,x=vt(ot),(!c||!c.s||!c.e)&&(c={s:{r:0,c:0},e:{r:0,c:0}}),ot.r<c.s.r&&(c.s.r=ot.r),ot.c<c.s.c&&(c.s.c=ot.c),ot.r+1>c.e.r&&(c.e.r=ot.r+1),ot.c+1>c.e.c&&(c.e.c=ot.c+1),Vt.cellFormula&&Ft.f){for(var Ot=0;Ot<Y.length;++Ot)if(!(Y[Ot][0].s.c>ot.c||Y[Ot][0].s.r>ot.r)&&!(Y[Ot][0].e.c<ot.c||Y[Ot][0].e.r<ot.r)){Ft.F=qt(Y[Ot][0]),(Y[Ot][0].s.c!=ot.c||Y[Ot][0].s.r!=ot.r)&&delete Ft.f,Ft.f&&(Ft.f=""+cn(Y[Ot][1],c,ot,ne,D));break}}Vt.dense?(i[ot.r]||(i[ot.r]=[]),i[ot.r][ot.c]=Ft):i[x]=Ft}},D={enc:!1,sbcch:0,snames:[],sharedf:z,arrayf:Y,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!e&&!!e.cellStyles,WTF:!!e&&!!e.wtf};e.password&&(D.password=e.password);var F,Fe=[],Ce=[],ae=[],oe=[],be=!1,ne=[];ne.SheetNames=D.snames,ne.sharedf=D.sharedf,ne.arrayf=D.arrayf,ne.names=[],ne.XTI=[];var G=0,se=0,P=0,j=[],J=[],ee;D.codepage=1200,ka(1200);for(var ue=!1;t.l<t.length-1;){var Ie=t.l,Ee=t.read_shift(2);if(Ee===0&&G===10)break;var we=t.l===t.length?0:t.read_shift(2),Te=Pg[Ee];if(Te&&Te.f){if(e.bookSheets&&G===133&&Ee!==133)break;if(G=Ee,Te.r===2||Te.r==12){var Ue=t.read_shift(2);if(we-=2,!D.enc&&Ue!==Ee&&((Ue&255)<<8|Ue>>8)!==Ee)throw new Error("rt mismatch: "+Ue+"!="+Ee);Te.r==12&&(t.l+=10,we-=10)}var W={};if(Ee===10?W=Te.f(t,we,D):W=D7(Ee,Te,t,we,D),se==0&&[9,521,1033,2057].indexOf(G)===-1)continue;switch(Ee){case 34:r.opts.Date1904=k.WBProps.date1904=W;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(D.enc||(t.l=0),D.enc=W,!e.password)throw new Error("File is password-protected");if(W.valid==null)throw new Error("Encryption scheme unsupported");if(!W.valid)throw new Error("Password is incorrect");break;case 92:D.lastuser=W;break;case 66:var nt=Number(W);switch(nt){case 21010:nt=1200;break;case 32768:nt=1e4;break;case 32769:nt=1252;break}ka(D.codepage=nt),ue=!0;break;case 317:D.rrtabid=W;break;case 25:D.winlocked=W;break;case 439:r.opts.RefreshAll=W;break;case 12:r.opts.CalcCount=W;break;case 16:r.opts.CalcDelta=W;break;case 17:r.opts.CalcIter=W;break;case 13:r.opts.CalcMode=W;break;case 14:r.opts.CalcPrecision=W;break;case 95:r.opts.CalcSaveRecalc=W;break;case 15:D.CalcRefMode=W;break;case 2211:r.opts.FullCalc=W;break;case 129:W.fDialog&&(i["!type"]="dialog"),W.fBelow||((i["!outline"]||(i["!outline"]={})).above=!0),W.fRight||((i["!outline"]||(i["!outline"]={})).left=!0);break;case 224:Z.push(W);break;case 430:ne.push([W]),ne[ne.length-1].XTI=[];break;case 35:case 547:ne[ne.length-1].push(W);break;case 24:case 536:ee={Name:W.Name,Ref:cn(W.rgce,c,null,ne,D)},W.itab>0&&(ee.Sheet=W.itab-1),ne.names.push(ee),ne[0]||(ne[0]=[],ne[0].XTI=[]),ne[ne.length-1].push(W),W.Name=="_xlnm._FilterDatabase"&&W.itab>0&&W.rgce&&W.rgce[0]&&W.rgce[0][0]&&W.rgce[0][0][0]=="PtgArea3d"&&(J[W.itab-1]={ref:qt(W.rgce[0][0][1][2])});break;case 22:D.ExternCount=W;break;case 23:ne.length==0&&(ne[0]=[],ne[0].XTI=[]),ne[ne.length-1].XTI=ne[ne.length-1].XTI.concat(W),ne.XTI=ne.XTI.concat(W);break;case 2196:if(D.biff<8)break;ee!=null&&(ee.Comment=W[1]);break;case 18:i["!protect"]=W;break;case 19:W!==0&&D.WTF&&console.error("Password verifier: "+W);break;case 133:o[W.pos]=W,D.snames.push(W.name);break;case 10:{if(--se)break;if(c.e){if(c.e.r>0&&c.e.c>0){if(c.e.r--,c.e.c--,i["!ref"]=qt(c),e.sheetRows&&e.sheetRows<=c.e.r){var Ge=c.e.r;c.e.r=e.sheetRows-1,i["!fullref"]=i["!ref"],i["!ref"]=qt(c),c.e.r=Ge}c.e.r++,c.e.c++}Fe.length>0&&(i["!merges"]=Fe),Ce.length>0&&(i["!objects"]=Ce),ae.length>0&&(i["!cols"]=ae),oe.length>0&&(i["!rows"]=oe),k.Sheets.push(A)}p===""?g=i:n[p]=i,i=e.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(D.biff===8&&(D.biff={9:2,521:3,1033:4}[Ee]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[W.BIFFVer]||8),D.biffguess=W.BIFFVer==0,W.BIFFVer==0&&W.dt==4096&&(D.biff=5,ue=!0,ka(D.codepage=28591)),D.biff==8&&W.BIFFVer==0&&W.dt==16&&(D.biff=2),se++)break;if(i=e.dense?[]:{},D.biff<8&&!ue&&(ue=!0,ka(D.codepage=e.codepage||1252)),D.biff<5||W.BIFFVer==0&&W.dt==4096){p===""&&(p="Sheet1"),c={s:{r:0,c:0},e:{r:0,c:0}};var Ke={pos:t.l-we,name:p};o[Ke.pos]=Ke,D.snames.push(p)}else p=(o[Ie]||{name:""}).name;W.dt==32&&(i["!type"]="chart"),W.dt==64&&(i["!type"]="macro"),Fe=[],Ce=[],D.arrayf=Y=[],ae=[],oe=[],be=!1,A={Hidden:(o[Ie]||{hs:0}).hs,name:p}}break;case 515:case 3:case 2:i["!type"]=="chart"&&(e.dense?(i[W.r]||[])[W.c]:i[vt({c:W.c,r:W.r})])&&++W.c,L={ixfe:W.ixfe,XF:Z[W.ixfe]||{},v:W.val,t:"n"},P>0&&(L.z=j[L.ixfe>>8&63]),$a(L,e,r.opts.Date1904),O({c:W.c,r:W.r},L,e);break;case 5:case 517:L={ixfe:W.ixfe,XF:Z[W.ixfe],v:W.val,t:W.t},P>0&&(L.z=j[L.ixfe>>8&63]),$a(L,e,r.opts.Date1904),O({c:W.c,r:W.r},L,e);break;case 638:L={ixfe:W.ixfe,XF:Z[W.ixfe],v:W.rknum,t:"n"},P>0&&(L.z=j[L.ixfe>>8&63]),$a(L,e,r.opts.Date1904),O({c:W.c,r:W.r},L,e);break;case 189:for(var Be=W.c;Be<=W.C;++Be){var Ne=W.rkrec[Be-W.c][0];L={ixfe:Ne,XF:Z[Ne],v:W.rkrec[Be-W.c][1],t:"n"},P>0&&(L.z=j[L.ixfe>>8&63]),$a(L,e,r.opts.Date1904),O({c:Be,r:W.r},L,e)}break;case 6:case 518:case 1030:{if(W.val=="String"){u=W;break}if(L=h0(W.val,W.cell.ixfe,W.tt),L.XF=Z[L.ixfe],e.cellFormula){var Ye=W.formula;if(Ye&&Ye[0]&&Ye[0][0]&&Ye[0][0][0]=="PtgExp"){var ut=Ye[0][0][1][0],_t=Ye[0][0][1][1],rr=vt({r:ut,c:_t});z[rr]?L.f=""+cn(W.formula,c,W.cell,ne,D):L.F=((e.dense?(i[ut]||[])[_t]:i[rr])||{}).F}else L.f=""+cn(W.formula,c,W.cell,ne,D)}P>0&&(L.z=j[L.ixfe>>8&63]),$a(L,e,r.opts.Date1904),O(W.cell,L,e),u=W}break;case 7:case 519:if(u)u.val=W,L=h0(W,u.cell.ixfe,"s"),L.XF=Z[L.ixfe],e.cellFormula&&(L.f=""+cn(u.formula,c,u.cell,ne,D)),P>0&&(L.z=j[L.ixfe>>8&63]),$a(L,e,r.opts.Date1904),O(u.cell,L,e),u=null;else throw new Error("String record expects Formula");break;case 33:case 545:{Y.push(W);var _r=vt(W[0].s);if(T=e.dense?(i[W[0].s.r]||[])[W[0].s.c]:i[_r],e.cellFormula&&T){if(!u||!_r||!T)break;T.f=""+cn(W[1],c,W[0],ne,D),T.F=qt(W[0])}}break;case 1212:{if(!e.cellFormula)break;if(x){if(!u)break;z[vt(u.cell)]=W[0],T=e.dense?(i[u.cell.r]||[])[u.cell.c]:i[vt(u.cell)],(T||{}).f=""+cn(W[0],c,_,ne,D)}}break;case 253:L=h0(h[W.isst].t,W.ixfe,"s"),h[W.isst].h&&(L.h=h[W.isst].h),L.XF=Z[L.ixfe],P>0&&(L.z=j[L.ixfe>>8&63]),$a(L,e,r.opts.Date1904),O({c:W.c,r:W.r},L,e);break;case 513:e.sheetStubs&&(L={ixfe:W.ixfe,XF:Z[W.ixfe],t:"z"},P>0&&(L.z=j[L.ixfe>>8&63]),$a(L,e,r.opts.Date1904),O({c:W.c,r:W.r},L,e));break;case 190:if(e.sheetStubs)for(var hr=W.c;hr<=W.C;++hr){var Et=W.ixfe[hr-W.c];L={ixfe:Et,XF:Z[Et],t:"z"},P>0&&(L.z=j[L.ixfe>>8&63]),$a(L,e,r.opts.Date1904),O({c:hr,r:W.r},L,e)}break;case 214:case 516:case 4:L=h0(W.val,W.ixfe,"s"),L.XF=Z[L.ixfe],P>0&&(L.z=j[L.ixfe>>8&63]),$a(L,e,r.opts.Date1904),O({c:W.c,r:W.r},L,e);break;case 0:case 512:se===1&&(c=W);break;case 252:h=W;break;case 1054:if(D.biff==4){j[P++]=W[1];for(var er=0;er<P+163&&ht[er]!=W[1];++er);er>=163&&Oo(W[1],P+163)}else Oo(W[1],W[0]);break;case 30:{j[P++]=W;for(var Ze=0;Ze<P+163&&ht[Ze]!=W;++Ze);Ze>=163&&Oo(W,P+163)}break;case 229:Fe=Fe.concat(W);break;case 93:Ce[W.cmo[0]]=D.lastobj=W;break;case 438:D.lastobj.TxO=W;break;case 127:D.lastobj.ImData=W;break;case 440:for(C=W[0].s.r;C<=W[0].e.r;++C)for(S=W[0].s.c;S<=W[0].e.c;++S)T=e.dense?(i[C]||[])[S]:i[vt({c:S,r:C})],T&&(T.l=W[1]);break;case 2048:for(C=W[0].s.r;C<=W[0].e.r;++C)for(S=W[0].s.c;S<=W[0].e.c;++S)T=e.dense?(i[C]||[])[S]:i[vt({c:S,r:C})],T&&T.l&&(T.l.Tooltip=W[1]);break;case 28:{if(D.biff<=5&&D.biff>=2)break;T=e.dense?(i[W[0].r]||[])[W[0].c]:i[vt(W[0])];var Je=Ce[W[2]];T||(e.dense?(i[W[0].r]||(i[W[0].r]=[]),T=i[W[0].r][W[0].c]={t:"z"}):T=i[vt(W[0])]={t:"z"},c.e.r=Math.max(c.e.r,W[0].r),c.s.r=Math.min(c.s.r,W[0].r),c.e.c=Math.max(c.e.c,W[0].c),c.s.c=Math.min(c.s.c,W[0].c)),T.c||(T.c=[]),w={a:W[1],t:Je.TxO.t},T.c.push(w)}break;case 2173:e5(Z[W.ixfe],W.ext);break;case 125:{if(!D.cellStyles)break;for(;W.e>=W.s;)ae[W.e--]={width:W.w/256,level:W.level||0,hidden:!!(W.flags&1)},be||(be=!0,J1(W.w/256)),fc(ae[W.e+1])}break;case 520:{var dt={};W.level!=null&&(oe[W.r]=dt,dt.level=W.level),W.hidden&&(oe[W.r]=dt,dt.hidden=!0),W.hpt&&(oe[W.r]=dt,dt.hpt=W.hpt,dt.hpx=ff(W.hpt))}break;case 38:case 39:case 40:case 41:i["!margins"]||Gu(i["!margins"]={}),i["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[Ee]]=W;break;case 161:i["!margins"]||Gu(i["!margins"]={}),i["!margins"].header=W.header,i["!margins"].footer=W.footer;break;case 574:W.RTL&&(k.Views[0].RTL=!0);break;case 146:re=W;break;case 2198:F=W;break;case 140:K=W;break;case 442:p?A.CodeName=W||A.name:k.WBProps.CodeName=W||"ThisWorkbook";break}}else Te||console.error("Missing Info for XLS Record 0x"+Ee.toString(16)),t.l+=we}return r.SheetNames=Gs(o).sort(function(Lt,ot){return Number(Lt)-Number(ot)}).map(function(Lt){return o[Lt].name}),e.bookSheets||(r.Sheets=n),!r.SheetNames.length&&g["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=g)):r.Preamble=g,r.Sheets&&J.forEach(function(Lt,ot){r.Sheets[r.SheetNames[ot]]["!autofilter"]=Lt}),r.Strings=h,r.SSF=en(ht),D.enc&&(r.Encryption=D.enc),F&&(r.Themes=F),r.Metadata={},K!==void 0&&(r.Metadata.Country=K),ne.names.length>0&&(k.Names=ne.names),r.Workbook=k,r}var r2={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function N7(t,e,r){var n=Dt.find(t,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var i=UT(n,$F,r2.DSI);for(var o in i)e[o]=i[o]}catch(p){if(r.WTF)throw p}var c=Dt.find(t,"/!SummaryInformation");if(c&&c.size>0)try{var u=UT(c,QF,r2.SI);for(var h in u)e[h]==null&&(e[h]=u[h])}catch(p){if(r.WTF)throw p}e.HeadingPairs&&e.TitlesOfParts&&(GS(e.HeadingPairs,e.TitlesOfParts,e,r),delete e.HeadingPairs,delete e.TitlesOfParts)}function R4(t,e){e||(e={}),av(e),tS(),e.codepage&&V1(e.codepage);var r,n;if(t.FullPaths){if(Dt.find(t,"/encryption"))throw new Error("File is password-protected");r=Dt.find(t,"!CompObj"),n=Dt.find(t,"/Workbook")||Dt.find(t,"/Book")}else{switch(e.type){case"base64":t=Ca(Yn(t));break;case"binary":t=Ca(t);break;case"buffer":break;case"array":Array.isArray(t)||(t=Array.prototype.slice.call(t));break}Qr(t,0),n={content:t}}var i,o;if(r&&b7(r),e.bookProps&&!e.bookSheets)i={};else{var c=wt?"buffer":"array";if(n&&n.content)i=O7(n.content,e);else if((o=Dt.find(t,"PerfectOffice_MAIN"))&&o.content)i=zu.to_workbook(o.content,(e.type=c,e));else if((o=Dt.find(t,"NativeContent_MAIN"))&&o.content)i=zu.to_workbook(o.content,(e.type=c,e));else throw(o=Dt.find(t,"MN0"))&&o.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");e.bookVBA&&t.FullPaths&&Dt.find(t,"/_VBA_PROJECT_CUR/VBA/dir")&&(i.vbaraw=_5(t))}var u={};return t.FullPaths&&N7(t,u,e),i.Props=i.Custprops=u,e.bookFiles&&(i.cfb=t),i}var td={0:{f:pL},1:{f:_L},2:{f:RL},3:{f:TL},4:{f:yL},5:{f:CL},6:{f:IL},7:{f:wL},8:{f:PL},9:{f:FL},10:{f:OL},11:{f:NL},12:{f:xL},13:{f:kL},14:{f:AL},15:{f:EL},16:{f:T4},17:{f:DL},18:{f:SL},19:{f:W1},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:l7},40:{},42:{},43:{f:OM},44:{f:DM},45:{f:NM},46:{f:PM},47:{f:FM},48:{},49:{f:MF},50:{},51:{f:r5},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:r4},62:{f:bL},63:{f:o5},64:{f:GL},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:mn,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:HL},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:vL},148:{f:mL,p:16},151:{f:VL},152:{},153:{f:s7},154:{},155:{},156:{f:i7},157:{},158:{},159:{T:1,f:QP},160:{T:-1},161:{T:1,f:Jo},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:ML},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:t5},336:{T:-1},337:{f:n5,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:Ig},357:{},358:{},359:{},360:{T:1},361:{},362:{f:t4},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:UL},427:{f:BL},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:zL},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:gL},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:LL},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:Ig},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:m5},633:{T:1},634:{T:-1},635:{T:1,f:p5},636:{T:-1},637:{f:VF},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:$L},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:qL},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},Pg={6:{f:Qm},10:{f:xs},12:{f:Sr},13:{f:Sr},14:{f:gr},15:{f:gr},16:{f:fn},17:{f:gr},18:{f:gr},19:{f:Sr},20:{f:HT},21:{f:HT},23:{f:t4},24:{f:qT},25:{f:gr},26:{},27:{},28:{f:hP},29:{},34:{f:gr},35:{f:GT},38:{f:fn},39:{f:fn},40:{f:fn},41:{f:fn},42:{f:gr},43:{f:gr},47:{f:gM},49:{f:W8},51:{f:Sr},60:{},61:{f:G8},64:{f:gr},65:{f:K8},66:{f:Sr},77:{},80:{},81:{},82:{},85:{f:Sr},89:{},90:{},91:{},92:{f:M8},93:{f:pP},94:{},95:{f:gr},96:{},97:{},99:{f:gr},125:{f:r4},128:{f:nP},129:{f:L8},130:{f:Sr},131:{f:gr},132:{f:gr},133:{f:V8},134:{},140:{f:yP},141:{f:Sr},144:{},146:{f:TP},151:{},152:{},153:{},154:{},155:{},156:{f:Sr},157:{},158:{},160:{f:RP},161:{f:wP},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:J8},190:{f:eP},193:{f:xs},197:{},198:{},199:{},200:{},201:{},202:{f:gr},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:Sr},220:{},221:{f:gr},222:{},224:{f:rP},225:{f:P8},226:{f:xs},227:{},229:{f:dP},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:U8},253:{f:X8},255:{f:B8},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:YS},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:gr},353:{f:xs},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:iP},431:{f:gr},432:{},433:{},434:{},437:{},438:{f:vP},439:{f:gr},440:{f:_P},441:{},442:{f:Of},443:{},444:{f:Sr},445:{},446:{},448:{f:xs},449:{f:H8,r:2},450:{f:xs},512:{f:jT},513:{f:CP},515:{f:aP},516:{f:Y8},517:{f:zT},519:{f:kP},520:{f:j8},523:{},545:{f:KT},549:{f:BT},566:{},574:{f:q8},638:{f:Z8},659:{},1048:{},1054:{f:$8},1084:{},1212:{f:cP},2048:{f:xP},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:c0},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:xs},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:AP,r:12},2173:{f:JM,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:gr,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:lP,r:12},2197:{},2198:{f:WM,r:12},2199:{},2200:{},2201:{},2202:{f:uP,r:12},2203:{f:xs},2204:{},2205:{},2206:{},2207:{},2211:{f:z8},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:Sr},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:SP},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:EP},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:jT},1:{},2:{f:OP},3:{f:DP},4:{f:IP},5:{f:zT},7:{f:NP},8:{},9:{f:c0},11:{},22:{f:Sr},30:{f:Q8},31:{},32:{},33:{f:KT},36:{},37:{f:BT},50:{f:FP},62:{},52:{},67:{},68:{f:Sr},69:{},86:{},126:{},127:{f:bP},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:PP},223:{},234:{},354:{},421:{},518:{f:Qm},521:{f:c0},536:{f:qT},547:{f:GT},561:{},579:{},1030:{f:Qm},1033:{f:c0},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function Sa(t,e,r,n){var i=e;if(!isNaN(i)){var o=(r||[]).length||0,c=t.next(4);c.write_shift(2,i),c.write_shift(2,o),o>0&&PS(r)&&t.push(r)}}function n2(t,e){var r=e||{},n=r.dense?[]:{};t=t.replace(/<!--.*?-->/g,"");var i=t.match(/<table/i);if(!i)throw new Error("Invalid HTML: could not find <table>");var o=t.match(/<\/table/i),c=i.index,u=o&&o.index||t.length,h=sF(t.slice(c,u),/(:?<tr[^>]*>)/i,"<tr>"),p=-1,g=0,_=0,x=0,T={s:{r:1e7,c:1e7},e:{r:0,c:0}},w=[];for(c=0;c<h.length;++c){var S=h[c].trim(),C=S.slice(0,3).toLowerCase();if(C=="<tr"){if(++p,r.sheetRows&&r.sheetRows<=p){--p;break}g=0;continue}if(!(C!="<td"&&C!="<th")){var z=S.split(/<\/t[dh]>/i);for(u=0;u<z.length;++u){var Y=z[u].trim();if(Y.match(/<t[dh]/i)){for(var L=Y,K=0;L.charAt(0)=="<"&&(K=L.indexOf(">"))>-1;)L=L.slice(K+1);for(var Z=0;Z<w.length;++Z){var re=w[Z];re.s.c==g&&re.s.r<p&&p<=re.e.r&&(g=re.e.c+1,Z=-1)}var k=st(Y.slice(0,Y.indexOf(">")));x=k.colspan?+k.colspan:1,((_=+k.rowspan)>1||x>1)&&w.push({s:{r:p,c:g},e:{r:p+(_||1)-1,c:g+x-1}});var A=k.t||k["data-t"]||"";if(!L.length){g+=x;continue}if(L=vF(L),T.s.r>p&&(T.s.r=p),T.e.r<p&&(T.e.r=p),T.s.c>g&&(T.s.c=g),T.e.c<g&&(T.e.c=g),!L.length){g+=x;continue}var E={t:"s",v:L};r.raw||!L.trim().length||A=="s"||(L==="TRUE"?E={t:"b",v:!0}:L==="FALSE"?E={t:"b",v:!1}:isNaN(Mi(L))?isNaN(sf(L).getDate())||(E={t:"d",v:Jr(L)},r.cellDates||(E={t:"n",v:$n(E.v)}),E.z=r.dateNF||ht[14]):E={t:"n",v:Mi(L)}),r.dense?(n[p]||(n[p]=[]),n[p][g]=E):n[vt({r:p,c:g})]=E,g+=x}}}}return n["!ref"]=qt(T),w.length&&(n["!merges"]=w),n}function F7(t,e){var r=t.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return Qo(n2(r[0],e),e);var n=D4();return r.forEach(function(i,o){O4(n,n2(i,e),"Sheet"+(o+1))}),n}function P7(t){var e=t.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,i){return Array(parseInt(i,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=Nt(e.replace(/<[^>]*>/g,""));return[r]}var a2={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function k4(t,e){var r=e||{},n=G1(t),i=[],o,c,u={name:""},h="",p=0,g,_,x={},T=[],w=r.dense?[]:{},S,C,z={value:""},Y="",L=0,K=[],Z=-1,re=-1,k={s:{r:1e6,c:1e7},e:{r:0,c:0}},A=0,E={},I=[],O={},D=0,F=0,Fe=[],Ce=1,ae=1,oe=[],be={Names:[]},ne={},G=["",""],se=[],P={},j="",J=0,ee=!1,ue=!1,Ie=0;for(lf.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");S=lf.exec(n);)switch(S[3]=S[3].replace(/_.*$/,"")){case"table":case"":S[1]==="/"?(k.e.c>=k.s.c&&k.e.r>=k.s.r?w["!ref"]=qt(k):w["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=k.e.r&&(w["!fullref"]=w["!ref"],k.e.r=r.sheetRows-1,w["!ref"]=qt(k)),I.length&&(w["!merges"]=I),Fe.length&&(w["!rows"]=Fe),g.name=g.||g.name,typeof JSON<"u"&&JSON.stringify(g),T.push(g.name),x[g.name]=w,ue=!1):S[0].charAt(S[0].length-2)!=="/"&&(g=st(S[0],!1),Z=re=-1,k.s.r=k.s.c=1e7,k.e.r=k.e.c=0,w=r.dense?[]:{},I=[],Fe=[],ue=!0);break;case"table-row-group":S[1]==="/"?--A:++A;break;case"table-row":case"":if(S[1]==="/"){Z+=Ce,Ce=1;break}if(_=st(S[0],!1),_.?Z=_.-1:Z==-1&&(Z=0),Ce=+_["number-rows-repeated"]||1,Ce<10)for(Ie=0;Ie<Ce;++Ie)A>0&&(Fe[Z+Ie]={level:A});re=-1;break;case"covered-table-cell":S[1]!=="/"&&++re,r.sheetStubs&&(r.dense?(w[Z]||(w[Z]=[]),w[Z][re]={t:"z"}):w[vt({r:Z,c:re})]={t:"z"}),Y="",K=[];break;case"table-cell":case"":if(S[0].charAt(S[0].length-2)==="/")++re,z=st(S[0],!1),ae=parseInt(z["number-columns-repeated"]||"1",10),C={t:"z",v:null},z.formula&&r.cellFormula!=!1&&(C.f=JT(Nt(z.formula))),(z.||z["value-type"])=="string"&&(C.t="s",C.v=Nt(z["string-value"]||""),r.dense?(w[Z]||(w[Z]=[]),w[Z][re]=C):w[vt({r:Z,c:re})]=C),re+=ae-1;else if(S[1]!=="/"){++re,Y="",L=0,K=[],ae=1;var Ee=Ce?Z+Ce-1:Z;if(re>k.e.c&&(k.e.c=re),re<k.s.c&&(k.s.c=re),Z<k.s.r&&(k.s.r=Z),Ee>k.e.r&&(k.e.r=Ee),z=st(S[0],!1),se=[],P={},C={t:z.||z["value-type"],v:null},r.cellFormula)if(z.formula&&(z.formula=Nt(z.formula)),z["number-matrix-columns-spanned"]&&z["number-matrix-rows-spanned"]&&(D=parseInt(z["number-matrix-rows-spanned"],10)||0,F=parseInt(z["number-matrix-columns-spanned"],10)||0,O={s:{r:Z,c:re},e:{r:Z+D-1,c:re+F-1}},C.F=qt(O),oe.push([O,C.F])),z.formula)C.f=JT(z.formula);else for(Ie=0;Ie<oe.length;++Ie)Z>=oe[Ie][0].s.r&&Z<=oe[Ie][0].e.r&&re>=oe[Ie][0].s.c&&re<=oe[Ie][0].e.c&&(C.F=oe[Ie][1]);switch((z["number-columns-spanned"]||z["number-rows-spanned"])&&(D=parseInt(z["number-rows-spanned"],10)||0,F=parseInt(z["number-columns-spanned"],10)||0,O={s:{r:Z,c:re},e:{r:Z+D-1,c:re+F-1}},I.push(O)),z["number-columns-repeated"]&&(ae=parseInt(z["number-columns-repeated"],10)),C.t){case"boolean":C.t="b",C.v=ir(z["boolean-value"]);break;case"float":C.t="n",C.v=parseFloat(z.value);break;case"percentage":C.t="n",C.v=parseFloat(z.value);break;case"currency":C.t="n",C.v=parseFloat(z.value);break;case"date":C.t="d",C.v=Jr(z["date-value"]),r.cellDates||(C.t="n",C.v=$n(C.v)),C.z="m/d/yy";break;case"time":C.t="n",C.v=nF(z["time-value"])/86400,r.cellDates&&(C.t="d",C.v=Rd(C.v)),C.z="HH:MM:SS";break;case"number":C.t="n",C.v=parseFloat(z.);break;default:if(C.t==="string"||C.t==="text"||!C.t)C.t="s",z["string-value"]!=null&&(Y=Nt(z["string-value"]),K=[]);else throw new Error("Unsupported value type "+C.t)}}else{if(ee=!1,C.t==="s"&&(C.v=Y||"",K.length&&(C.R=K),ee=L==0),ne.Target&&(C.l=ne),se.length>0&&(C.c=se,se=[]),Y&&r.cellText!==!1&&(C.w=Y),ee&&(C.t="z",delete C.v),(!ee||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=Z))for(var we=0;we<Ce;++we){if(ae=parseInt(z["number-columns-repeated"]||"1",10),r.dense)for(w[Z+we]||(w[Z+we]=[]),w[Z+we][re]=we==0?C:en(C);--ae>0;)w[Z+we][re+ae]=en(C);else for(w[vt({r:Z+we,c:re})]=C;--ae>0;)w[vt({r:Z+we,c:re+ae})]=en(C);k.e.c<=re&&(k.e.c=re)}ae=parseInt(z["number-columns-repeated"]||"1",10),re+=ae-1,ae=0,C={},Y="",K=[]}ne={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(S[1]==="/"){if((o=i.pop())[0]!==S[3])throw"Bad state: "+o}else S[0].charAt(S[0].length-2)!=="/"&&i.push([S[3],!0]);break;case"annotation":if(S[1]==="/"){if((o=i.pop())[0]!==S[3])throw"Bad state: "+o;P.t=Y,K.length&&(P.R=K),P.a=j,se.push(P)}else S[0].charAt(S[0].length-2)!=="/"&&i.push([S[3],!1]);j="",J=0,Y="",L=0,K=[];break;case"creator":S[1]==="/"?j=n.slice(J,S.index):J=S.index+S[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(S[1]==="/"){if((o=i.pop())[0]!==S[3])throw"Bad state: "+o}else S[0].charAt(S[0].length-2)!=="/"&&i.push([S[3],!1]);Y="",L=0,K=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(S[1]==="/"){if(E[u.name]=h,(o=i.pop())[0]!==S[3])throw"Bad state: "+o}else S[0].charAt(S[0].length-2)!=="/"&&(h="",u=st(S[0],!1),i.push([S[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(i[i.length-1][0]){case"time-style":case"date-style":c=st(S[0],!1),h+=a2[S[3]][c.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(i[i.length-1][0]){case"time-style":case"date-style":c=st(S[0],!1),h+=a2[S[3]][c.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(S[0].slice(-2)==="/>")break;if(S[1]==="/")switch(i[i.length-1][0]){case"number-style":case"date-style":case"time-style":h+=n.slice(p,S.index);break}else p=S.index+S[0].length;break;case"named-range":c=st(S[0],!1),G=Zm(c["cell-range-address"]);var Te={Name:c.name,Ref:G[0]+"!"+G[1]};ue&&(Te.Sheet=T.length),be.Names.push(Te);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(i[i.length-1][0])>-1)break;if(S[1]==="/"&&(!z||!z["string-value"])){var Ue=P7(n.slice(L,S.index));Y=(Y.length>0?Y+`
`:"")+Ue[0]}else st(S[0],!1),L=S.index+S[0].length;break;case"s":break;case"database-range":if(S[1]==="/")break;try{G=Zm(st(S[0])["target-range-address"]),x[G[0]]["!autofilter"]={ref:G[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(S[1]!=="/"){if(ne=st(S[0],!1),!ne.href)break;ne.Target=Nt(ne.href),delete ne.href,ne.Target.charAt(0)=="#"&&ne.Target.indexOf(".")>-1?(G=Zm(ne.Target.slice(1)),ne.Target="#"+G[0]+"!"+G[1]):ne.Target.match(/^\.\.[\\\/]/)&&(ne.Target=ne.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(S[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(r.WTF)throw new Error(S)}}var W={Sheets:x,SheetNames:T,Workbook:be};return r.bookSheets&&delete W.Sheets,W}function i2(t,e){e=e||{},fa(t,"META-INF/manifest.xml")&&a8(wr(t,"META-INF/manifest.xml"),e);var r=Kn(t,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var n=k4(Jt(r),e);return fa(t,"meta.xml")&&(n.Props=HS(wr(t,"meta.xml"))),n}function s2(t,e){return k4(t,e)}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function rv(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}function Mg(t){return typeof TextDecoder<"u"?new TextDecoder().decode(t):Jt($o(t))}function Lg(t){var e=t.reduce(function(i,o){return i+o.length},0),r=new Uint8Array(e),n=0;return t.forEach(function(i){r.set(i,n),n+=i.length}),r}function o2(t){return t-=t>>1&1431655765,t=(t&858993459)+(t>>2&858993459),(t+(t>>4)&252645135)*16843009>>>24}function M7(t,e){for(var r=(t[e+15]&127)<<7|t[e+14]>>1,n=t[e+14]&1,i=e+13;i>=e;--i)n=n*256+t[i];return(t[e+15]&128?-n:n)*Math.pow(10,r-6176)}function hf(t,e){var r=e?e[0]:0,n=t[r]&127;e:if(t[r++]>=128&&(n|=(t[r]&127)<<7,t[r++]<128||(n|=(t[r]&127)<<14,t[r++]<128)||(n|=(t[r]&127)<<21,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,28),++r,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,35),++r,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,42),++r,t[r++]<128)))break e;return e&&(e[0]=r),n}function Mr(t){var e=0,r=t[e]&127;e:if(t[e++]>=128){if(r|=(t[e]&127)<<7,t[e++]<128||(r|=(t[e]&127)<<14,t[e++]<128)||(r|=(t[e]&127)<<21,t[e++]<128))break e;r|=(t[e]&127)<<28}return r}function hn(t){for(var e=[],r=[0];r[0]<t.length;){var n=r[0],i=hf(t,r),o=i&7;i=Math.floor(i/8);var c=0,u;if(i==0)break;switch(o){case 0:{for(var h=r[0];t[r[0]++]>=128;);u=t.slice(h,r[0])}break;case 5:c=4,u=t.slice(r[0],r[0]+c),r[0]+=c;break;case 1:c=8,u=t.slice(r[0],r[0]+c),r[0]+=c;break;case 2:c=hf(t,r),u=t.slice(r[0],r[0]+c),r[0]+=c;break;case 3:case 4:default:throw new Error("PB Type ".concat(o," for Field ").concat(i," at offset ").concat(n))}var p={data:u,type:o};e[i]==null?e[i]=[p]:e[i].push(p)}return e}function nv(t,e){return t?.map(function(r){return e(r.data)})||[]}function L7(t){for(var e,r=[],n=[0];n[0]<t.length;){var i=hf(t,n),o=hn(t.slice(n[0],n[0]+i));n[0]+=i;var c={id:Mr(o[1][0].data),messages:[]};o[2].forEach(function(u){var h=hn(u.data),p=Mr(h[3][0].data);c.messages.push({meta:h,data:t.slice(n[0],n[0]+p)}),n[0]+=p}),(e=o[3])!=null&&e[0]&&(c.merge=Mr(o[3][0].data)>>>0>0),r.push(c)}return r}function V7(t,e){if(t!=0)throw new Error("Unexpected Snappy chunk type ".concat(t));for(var r=[0],n=hf(e,r),i=[];r[0]<e.length;){var o=e[r[0]]&3;if(o==0){var c=e[r[0]++]>>2;if(c<60)++c;else{var u=c-59;c=e[r[0]],u>1&&(c|=e[r[0]+1]<<8),u>2&&(c|=e[r[0]+2]<<16),u>3&&(c|=e[r[0]+3]<<24),c>>>=0,c++,r[0]+=u}i.push(e.slice(r[0],r[0]+c)),r[0]+=c;continue}else{var h=0,p=0;if(o==1?(p=(e[r[0]]>>2&7)+4,h=(e[r[0]++]&224)<<3,h|=e[r[0]++]):(p=(e[r[0]++]>>2)+1,o==2?(h=e[r[0]]|e[r[0]+1]<<8,r[0]+=2):(h=(e[r[0]]|e[r[0]+1]<<8|e[r[0]+2]<<16|e[r[0]+3]<<24)>>>0,r[0]+=4)),i=[Lg(i)],h==0)throw new Error("Invalid offset 0");if(h>i[0].length)throw new Error("Invalid offset beyond length");if(p>=h)for(i.push(i[0].slice(-h)),p-=h;p>=i[i.length-1].length;)i.push(i[i.length-1]),p-=i[i.length-1].length;i.push(i[0].slice(-h,-h+p))}}var g=Lg(i);if(g.length!=n)throw new Error("Unexpected length: ".concat(g.length," != ").concat(n));return g}function U7(t){for(var e=[],r=0;r<t.length;){var n=t[r++],i=t[r]|t[r+1]<<8|t[r+2]<<16;r+=3,e.push(V7(n,t.slice(r,r+i))),r+=i}if(r!==t.length)throw new Error("data is not a valid framed stream!");return Lg(e)}function B7(t,e,r,n){var i=rv(t),o=i.getUint32(4,!0),c=(n>1?12:8)+o2(o&(n>1?3470:398))*4,u=-1,h=-1,p=NaN,g=new Date(2001,0,1);o&512&&(u=i.getUint32(c,!0),c+=4),c+=o2(o&(n>1?12288:4096))*4,o&16&&(h=i.getUint32(c,!0),c+=4),o&32&&(p=i.getFloat64(c,!0),c+=8),o&64&&(g.setTime(g.getTime()+i.getFloat64(c,!0)*1e3),c+=8);var _;switch(t[2]){case 0:break;case 2:_={t:"n",v:p};break;case 3:_={t:"s",v:e[h]};break;case 5:_={t:"d",v:g};break;case 6:_={t:"b",v:p>0};break;case 7:_={t:"n",v:p/86400};break;case 8:_={t:"e",v:0};break;case 9:if(u>-1)_={t:"s",v:r[u]};else if(h>-1)_={t:"s",v:e[h]};else if(!isNaN(p))_={t:"n",v:p};else throw new Error("Unsupported cell type ".concat(t.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(t.slice(0,4)))}return _}function j7(t,e,r){var n=rv(t),i=n.getUint32(8,!0),o=12,c=-1,u=-1,h=NaN,p=NaN,g=new Date(2001,0,1);i&1&&(h=M7(t,o),o+=16),i&2&&(p=n.getFloat64(o,!0),o+=8),i&4&&(g.setTime(g.getTime()+n.getFloat64(o,!0)*1e3),o+=8),i&8&&(u=n.getUint32(o,!0),o+=4),i&16&&(c=n.getUint32(o,!0),o+=4);var _;switch(t[1]){case 0:break;case 2:_={t:"n",v:h};break;case 3:_={t:"s",v:e[u]};break;case 5:_={t:"d",v:g};break;case 6:_={t:"b",v:p>0};break;case 7:_={t:"n",v:p/86400};break;case 8:_={t:"e",v:0};break;case 9:if(c>-1)_={t:"s",v:r[c]};else throw new Error("Unsupported cell type ".concat(t[1]," : ").concat(i&31," : ").concat(t.slice(0,4)));break;case 10:_={t:"n",v:h};break;default:throw new Error("Unsupported cell type ".concat(t[1]," : ").concat(i&31," : ").concat(t.slice(0,4)))}return _}function z7(t,e,r){switch(t[0]){case 0:case 1:case 2:case 3:return B7(t,e,r,t[0]);case 5:return j7(t,e,r);default:throw new Error("Unsupported payload version ".concat(t[0]))}}function Ps(t){var e=hn(t);return hf(e[1][0].data)}function l2(t,e){var r=hn(e.data),n=Mr(r[1][0].data),i=r[3],o=[];return(i||[]).forEach(function(c){var u=hn(c.data),h=Mr(u[1][0].data)>>>0;switch(n){case 1:o[h]=Mg(u[3][0].data);break;case 8:{var p=t[Ps(u[9][0].data)][0],g=hn(p.data),_=t[Ps(g[1][0].data)][0],x=Mr(_.meta[1][0].data);if(x!=2001)throw new Error("2000 unexpected reference to ".concat(x));var T=hn(_.data);o[h]=T[3].map(function(w){return Mg(w.data)}).join("")}break}}),o}function H7(t,e){var r,n,i,o,c,u,h,p,g,_,x,T,w,S,C=hn(t),z=Mr(C[1][0].data)>>>0,Y=Mr(C[2][0].data)>>>0,L=((n=(r=C[8])==null?void 0:r[0])==null?void 0:n.data)&&Mr(C[8][0].data)>0||!1,K,Z;if((o=(i=C[7])==null?void 0:i[0])!=null&&o.data&&e!=0)K=(u=(c=C[7])==null?void 0:c[0])==null?void 0:u.data,Z=(p=(h=C[6])==null?void 0:h[0])==null?void 0:p.data;else if((_=(g=C[4])==null?void 0:g[0])!=null&&_.data&&e!=1)K=(T=(x=C[4])==null?void 0:x[0])==null?void 0:T.data,Z=(S=(w=C[3])==null?void 0:w[0])==null?void 0:S.data;else throw"NUMBERS Tile missing ".concat(e," cell storage");for(var re=L?4:1,k=rv(K),A=[],E=0;E<K.length/2;++E){var I=k.getUint16(E*2,!0);I<65535&&A.push([E,I])}if(A.length!=Y)throw"Expected ".concat(Y," cells, found ").concat(A.length);var O=[];for(E=0;E<A.length-1;++E)O[A[E][0]]=Z.subarray(A[E][1]*re,A[E+1][1]*re);return A.length>=1&&(O[A[A.length-1][0]]=Z.subarray(A[A.length-1][1]*re)),{R:z,cells:O}}function G7(t,e){var r,n=hn(e.data),i=(r=n?.[7])!=null&&r[0]?Mr(n[7][0].data)>>>0>0?1:0:-1,o=nv(n[5],function(c){return H7(c,i)});return{nrows:Mr(n[4][0].data)>>>0,data:o.reduce(function(c,u){return c[u.R]||(c[u.R]=[]),u.cells.forEach(function(h,p){if(c[u.R][p])throw new Error("Duplicate cell r=".concat(u.R," c=").concat(p));c[u.R][p]=h}),c},[])}}function q7(t,e,r){var n,i=hn(e.data),o={s:{r:0,c:0},e:{r:0,c:0}};if(o.e.r=(Mr(i[6][0].data)>>>0)-1,o.e.r<0)throw new Error("Invalid row varint ".concat(i[6][0].data));if(o.e.c=(Mr(i[7][0].data)>>>0)-1,o.e.c<0)throw new Error("Invalid col varint ".concat(i[7][0].data));r["!ref"]=qt(o);var c=hn(i[4][0].data),u=l2(t,t[Ps(c[4][0].data)][0]),h=(n=c[17])!=null&&n[0]?l2(t,t[Ps(c[17][0].data)][0]):[],p=hn(c[3][0].data),g=0;p[1].forEach(function(_){var x=hn(_.data),T=t[Ps(x[2][0].data)][0],w=Mr(T.meta[1][0].data);if(w!=6002)throw new Error("6001 unexpected reference to ".concat(w));var S=G7(t,T);S.data.forEach(function(C,z){C.forEach(function(Y,L){var K=vt({r:g+z,c:L}),Z=z7(Y,u,h);Z&&(r[K]=Z)})}),g+=S.nrows})}function K7(t,e){var r=hn(e.data),n={"!ref":"A1"},i=t[Ps(r[2][0].data)],o=Mr(i[0].meta[1][0].data);if(o!=6001)throw new Error("6000 unexpected reference to ".concat(o));return q7(t,i[0],n),n}function W7(t,e){var r,n=hn(e.data),i={name:(r=n[1])!=null&&r[0]?Mg(n[1][0].data):"",sheets:[]},o=nv(n[2],Ps);return o.forEach(function(c){t[c].forEach(function(u){var h=Mr(u.meta[1][0].data);h==6e3&&i.sheets.push(K7(t,u))})}),i}function X7(t,e){var r=D4(),n=hn(e.data),i=nv(n[1],Ps);if(i.forEach(function(o){t[o].forEach(function(c){var u=Mr(c.meta[1][0].data);if(u==2){var h=W7(t,c);h.sheets.forEach(function(p,g){O4(r,p,g==0?h.name:h.name+"_"+g,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function eg(t){var e,r,n,i,o={},c=[];if(t.FullPaths.forEach(function(h){if(h.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),t.FileIndex.forEach(function(h){if(h.name.match(/\.iwa$/)){var p;try{p=U7(h.content)}catch(_){return console.log("?? "+h.content.length+" "+(_.message||_))}var g;try{g=L7(p)}catch(_){return console.log("## "+(_.message||_))}g.forEach(function(_){o[_.id]=_.messages,c.push(_.id)})}}),!c.length)throw new Error("File has no messages");var u=((i=(n=(r=(e=o?.[1])==null?void 0:e[0])==null?void 0:r.meta)==null?void 0:n[1])==null?void 0:i[0].data)&&Mr(o[1][0].meta[1][0].data)==1&&o[1][0];if(u||c.forEach(function(h){o[h].forEach(function(p){var g=Mr(p.meta[1][0].data)>>>0;if(g==1)if(!u)u=p;else throw new Error("Document has multiple roots")})}),!u)throw new Error("Cannot find Document root");return X7(o,u)}function Y7(t){return function(r){for(var n=0;n!=t.length;++n){var i=t[n];r[i[0]]===void 0&&(r[i[0]]=i[1]),i[2]==="n"&&(r[i[0]]=Number(r[i[0]]))}}}function av(t){Y7([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(t)}function $7(t){return Xl.WS.indexOf(t)>-1?"sheet":t==Xl.CS?"chart":t==Xl.DS?"dialog":t==Xl.MS?"macro":t&&t.length?t:"sheet"}function Q7(t,e){if(!t)return 0;try{t=e.map(function(n){return n.id||(n.id=n.strRelID),[n.name,t["!id"][n.id].Target,$7(t["!id"][n.id].Type)]})}catch{return null}return!t||t.length===0?null:t}function Z7(t,e,r,n,i,o,c,u,h,p,g,_){try{o[n]=Bu(Kn(t,r,!0),e);var x=wr(t,e),T;switch(u){case"sheet":T=f7(x,e,i,h,o[n],p,g,_);break;case"chart":if(T=h7(x,e,i,h,o[n],p,g,_),!T||!T["!drawel"])break;var w=bu(T["!drawel"].Target,e),S=Dg(w),C=u5(Kn(t,w,!0),Bu(Kn(t,S,!0),w)),z=bu(C,w),Y=Dg(z);T=XL(Kn(t,z,!0),z,h,Bu(Kn(t,Y,!0),z),p,T);break;case"macro":T=d7(x,e,i,h,o[n],p,g,_);break;case"dialog":T=p7(x,e,i,h,o[n],p,g,_);break;default:throw new Error("Unrecognized sheet type "+u)}c[n]=T;var L=[];o&&o[n]&&Gs(o[n]).forEach(function(K){var Z="";if(o[n][K].Type==Xl.CMNT){Z=bu(o[n][K].Target,e);var re=_7(wr(t,Z,!0),Z,h);if(!re||!re.length)return;XT(T,re,!1)}o[n][K].Type==Xl.TCMNT&&(Z=bu(o[n][K].Target,e),L=L.concat(h5(wr(t,Z,!0),h)))}),L&&L.length&&XT(T,L,!0,h.people||[])}catch(K){if(h.WTF)throw K}}function ca(t){return t.charAt(0)=="/"?t.slice(1):t}function J7(t,e){if(dS(),e=e||{},av(e),fa(t,"META-INF/manifest.xml")||fa(t,"objectdata.xml"))return i2(t,e);if(fa(t,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof eg<"u"){if(t.FileIndex)return eg(t);var r=Dt.utils.cfb_new();return ET(t).forEach(function(Fe){cF(r,Fe,lF(t,Fe))}),eg(r)}throw new Error("Unsupported NUMBERS file")}if(!fa(t,"[Content_Types].xml"))throw fa(t,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):fa(t,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=ET(t),i=r8(Kn(t,"[Content_Types].xml")),o=!1,c,u;if(i.workbooks.length===0&&(u="xl/workbook.xml",wr(t,u,!0)&&i.workbooks.push(u)),i.workbooks.length===0){if(u="xl/workbook.bin",!wr(t,u,!0))throw new Error("Could not find workbook");i.workbooks.push(u),o=!0}i.workbooks[0].slice(-3)=="bin"&&(o=!0);var h={},p={};if(!e.bookSheets&&!e.bookProps){if(Hu=[],i.sst)try{Hu=v7(wr(t,ca(i.sst)),i.sst,e)}catch(Fe){if(e.WTF)throw Fe}e.cellStyles&&i.themes.length&&(h=g7(Kn(t,i.themes[0].replace(/^\//,""),!0)||"",i.themes[0],e)),i.style&&(p=m7(wr(t,ca(i.style)),i.style,h,e))}i.links.map(function(Fe){try{var Ce=Bu(Kn(t,Dg(ca(Fe))),Fe);return y7(wr(t,ca(Fe)),Ce,Fe,e)}catch{}});var g=u7(wr(t,ca(i.workbooks[0])),i.workbooks[0],e),_={},x="";i.coreprops.length&&(x=wr(t,ca(i.coreprops[0]),!0),x&&(_=HS(x)),i.extprops.length!==0&&(x=wr(t,ca(i.extprops[0]),!0),x&&o8(x,_,e)));var T={};(!e.bookSheets||e.bookProps)&&i.custprops.length!==0&&(x=Kn(t,ca(i.custprops[0]),!0),x&&(T=c8(x,e)));var w={};if((e.bookSheets||e.bookProps)&&(g.Sheets?c=g.Sheets.map(function(Ce){return Ce.name}):_.Worksheets&&_.SheetNames.length>0&&(c=_.SheetNames),e.bookProps&&(w.Props=_,w.Custprops=T),e.bookSheets&&typeof c<"u"&&(w.SheetNames=c),e.bookSheets?w.SheetNames:e.bookProps))return w;c={};var S={};e.bookDeps&&i.calcchain&&(S=x7(wr(t,ca(i.calcchain)),i.calcchain));var C=0,z={},Y,L;{var K=g.Sheets;_.Worksheets=K.length,_.SheetNames=[];for(var Z=0;Z!=K.length;++Z)_.SheetNames[Z]=K[Z].name}var re=o?"bin":"xml",k=i.workbooks[0].lastIndexOf("/"),A=(i.workbooks[0].slice(0,k+1)+"_rels/"+i.workbooks[0].slice(k+1)+".rels").replace(/^\//,"");fa(t,A)||(A="xl/_rels/workbook."+re+".rels");var E=Bu(Kn(t,A,!0),A.replace(/_rels.*/,"s5s"));(i.metadata||[]).length>=1&&(e.xlmeta=E7(wr(t,ca(i.metadata[0])),i.metadata[0],e)),(i.people||[]).length>=1&&(e.people=d5(wr(t,ca(i.people[0])),e)),E&&(E=Q7(E,g.Sheets));var I=wr(t,"xl/worksheets/sheet.xml",!0)?1:0;e:for(C=0;C!=_.Worksheets;++C){var O="sheet";if(E&&E[C]?(Y="xl/"+E[C][1].replace(/[\/]?xl\//,""),fa(t,Y)||(Y=E[C][1]),fa(t,Y)||(Y=A.replace(/_rels\/.*$/,"")+E[C][1]),O=E[C][2]):(Y="xl/worksheets/sheet"+(C+1-I)+"."+re,Y=Y.replace(/sheet0\./,"sheet.")),L=Y.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),e&&e.sheets!=null)switch(typeof e.sheets){case"number":if(C!=e.sheets)continue e;break;case"string":if(_.SheetNames[C].toLowerCase()!=e.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(e.sheets)){for(var D=!1,F=0;F!=e.sheets.length;++F)typeof e.sheets[F]=="number"&&e.sheets[F]==C&&(D=1),typeof e.sheets[F]=="string"&&e.sheets[F].toLowerCase()==_.SheetNames[C].toLowerCase()&&(D=1);if(!D)continue e}}Z7(t,Y,L,_.SheetNames[C],C,z,c,O,e,g,h,p)}return w={Directory:i,Workbook:g,Props:_,Custprops:T,Deps:S,Sheets:c,SheetNames:_.SheetNames,Strings:Hu,Styles:p,Themes:h,SSF:en(ht)},e&&e.bookFiles&&(t.files?(w.keys=n,w.files=t.files):(w.keys=[],w.files={},t.FullPaths.forEach(function(Fe,Ce){Fe=Fe.replace(/^Root Entry[\/]/,""),w.keys.push(Fe),w.files[Fe]=t.FileIndex[Ce]}))),e&&e.bookVBA&&(i.vba.length>0?w.vbaraw=wr(t,ca(i.vba[0]),!0):i.defaults&&i.defaults.bin===v5&&(w.vbaraw=wr(t,"xl/vbaProject.bin",!0))),w}function eV(t,e){var r=e||{},n="Workbook",i=Dt.find(t,n);try{if(n="/!DataSpaces/Version",i=Dt.find(t,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(JP(i.content),n="/!DataSpaces/DataSpaceMap",i=Dt.find(t,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var o=tM(i.content);if(o.length!==1||o[0].comps.length!==1||o[0].comps[0].t!==0||o[0].name!=="StrongEncryptionDataSpace"||o[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",i=Dt.find(t,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var c=rM(i.content);if(c.length!=1||c[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",i=Dt.find(t,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);aM(i.content)}catch{}if(n="/EncryptionInfo",i=Dt.find(t,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var u=iM(i.content);if(n="/EncryptedPackage",i=Dt.find(t,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(u[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(u[1],i.content,r.password||"",r);if(u[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(u[1],i.content,r.password||"",r);throw new Error("File is password-protected")}function iv(t,e){var r="";switch((e||{}).type||"base64"){case"buffer":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];case"base64":r=Yn(t.slice(0,12));break;case"binary":r=t;break;case"array":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];default:throw new Error("Unrecognized type "+(e&&e.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function tV(t,e){return Dt.find(t,"EncryptedPackage")?eV(t,e):R4(t,e)}function rV(t,e){var r,n=t,i=e||{};return i.type||(i.type=wt&&Buffer.isBuffer(t)?"buffer":"base64"),r=xS(n,i),J7(r,i)}function b4(t,e){var r=0;e:for(;r<t.length;)switch(t.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return Fg(t.slice(r),e);default:break e}return cf.to_workbook(t,e)}function nV(t,e){var r="",n=iv(t,e);switch(e.type){case"base64":r=Yn(t);break;case"binary":r=t;break;case"buffer":r=t.toString("binary");break;case"array":r=Bo(t);break;default:throw new Error("Unrecognized type "+e.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(r=Jt(r)),e.type="binary",b4(r,e)}function aV(t,e){var r=t;return e.type=="base64"&&(r=Yn(r)),r=nf.utils.decode(1200,r.slice(2),"str"),e.type="binary",b4(r,e)}function iV(t){return t.match(/[^\x00-\x7F]/)?Iu(t):t}function tg(t,e,r,n){return n?(r.type="string",cf.to_workbook(t,r)):cf.to_workbook(e,r)}function Vg(t,e){tS();var r=e||{};if(typeof ArrayBuffer<"u"&&t instanceof ArrayBuffer)return Vg(new Uint8Array(t),(r=en(r),r.type="array",r));typeof Uint8Array<"u"&&t instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var n=t,i=[0,0,0,0],o=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),rc={},r.dateNF&&(rc.dateNF=r.dateNF),r.type||(r.type=wt&&Buffer.isBuffer(t)?"buffer":"base64"),r.type=="file"&&(r.type=wt?"buffer":"binary",n=tF(t),typeof Uint8Array<"u"&&!wt&&(r.type="array")),r.type=="string"&&(o=!0,r.type="binary",r.codepage=65001,n=iV(t)),r.type=="array"&&typeof Uint8Array<"u"&&t instanceof Uint8Array&&typeof ArrayBuffer<"u"){var c=new ArrayBuffer(3),u=new Uint8Array(c);if(u.foo="bar",!u.foo)return r=en(r),r.type="array",Vg(U1(n),r)}switch((i=iv(n,r))[0]){case 208:if(i[1]===207&&i[2]===17&&i[3]===224&&i[4]===161&&i[5]===177&&i[6]===26&&i[7]===225)return tV(Dt.read(n,r),r);break;case 9:if(i[1]<=8)return R4(n,r);break;case 60:return Fg(n,r);case 73:if(i[1]===73&&i[2]===42&&i[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(i[1]===68)return BP(n,r);break;case 84:if(i[1]===65&&i[2]===66&&i[3]===76)return VP.to_workbook(n,r);break;case 80:return i[1]===75&&i[2]<9&&i[3]<9?rV(n,r):tg(t,n,r,o);case 239:return i[3]===60?Fg(n,r):tg(t,n,r,o);case 255:if(i[1]===254)return aV(n,r);if(i[1]===0&&i[2]===2&&i[3]===0)return zu.to_workbook(n,r);break;case 0:if(i[1]===0&&(i[2]>=2&&i[3]===0||i[2]===0&&(i[3]===8||i[3]===9)))return zu.to_workbook(n,r);break;case 3:case 131:case 139:case 140:return WT.to_workbook(n,r);case 123:if(i[1]===92&&i[2]===114&&i[3]===116)return vM.to_workbook(n,r);break;case 10:case 13:case 32:return nV(n,r);case 137:if(i[1]===80&&i[2]===78&&i[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return MP.indexOf(i[0])>-1&&i[2]<=12&&i[3]<=31?WT.to_workbook(n,r):tg(t,n,r,o)}function sV(t,e,r,n,i,o,c,u){var h=Xn(r),p=u.defval,g=u.raw||!Object.prototype.hasOwnProperty.call(u,"raw"),_=!0,x=i===1?[]:{};if(i!==1)if(Object.defineProperty)try{Object.defineProperty(x,"__rowNum__",{value:r,enumerable:!1})}catch{x.__rowNum__=r}else x.__rowNum__=r;if(!c||t[r])for(var T=e.s.c;T<=e.e.c;++T){var w=c?t[r][T]:t[n[T]+h];if(w===void 0||w.t===void 0){if(p===void 0)continue;o[T]!=null&&(x[o[T]]=p);continue}var S=w.v;switch(w.t){case"z":if(S==null)break;continue;case"e":S=S==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+w.t)}if(o[T]!=null){if(S==null)if(w.t=="e"&&S===null)x[o[T]]=null;else if(p!==void 0)x[o[T]]=p;else if(g&&S===null)x[o[T]]=null;else continue;else x[o[T]]=g&&(w.t!=="n"||w.t==="n"&&u.rawNumbers!==!1)?S:uc(w,S,u);S!=null&&(_=!1)}}return{row:x,isempty:_}}function I4(t,e){if(t==null||t["!ref"]==null)return[];var r={t:"n",v:0},n=0,i=1,o=[],c=0,u="",h={s:{r:0,c:0},e:{r:0,c:0}},p=e||{},g=p.range!=null?p.range:t["!ref"];switch(p.header===1?n=1:p.header==="A"?n=2:Array.isArray(p.header)?n=3:p.header==null&&(n=0),typeof g){case"string":h=qr(g);break;case"number":h=qr(t["!ref"]),h.s.r=g;break;default:h=g}n>0&&(i=0);var _=Xn(h.s.r),x=[],T=[],w=0,S=0,C=Array.isArray(t),z=h.s.r,Y=0,L={};C&&!t[z]&&(t[z]=[]);var K=p.skipHidden&&t["!cols"]||[],Z=p.skipHidden&&t["!rows"]||[];for(Y=h.s.c;Y<=h.e.c;++Y)if(!(K[Y]||{}).hidden)switch(x[Y]=wn(Y),r=C?t[z][Y]:t[x[Y]+_],n){case 1:o[Y]=Y-h.s.c;break;case 2:o[Y]=x[Y];break;case 3:o[Y]=p.header[Y-h.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),u=c=uc(r,null,p),S=L[c]||0,!S)L[c]=1;else{do u=c+"_"+S++;while(L[u]);L[c]=S,L[u]=1}o[Y]=u}for(z=h.s.r+i;z<=h.e.r;++z)if(!(Z[z]||{}).hidden){var re=sV(t,h,z,x,n,o,C,p);(re.isempty===!1||(n===1?p.blankrows!==!1:p.blankrows))&&(T[w++]=re.row)}return T.length=w,T}function D4(){return{SheetNames:[],Sheets:{}}}function O4(t,e,r,n){var i=1;if(!r)for(;i<=65535&&t.SheetNames.indexOf(r="Sheet"+i)!=-1;++i,r=void 0);if(!r||t.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&t.SheetNames.indexOf(r)>=0){var o=r.match(/(^.*?)(\d+)$/);i=o&&+o[2]||0;var c=o&&o[1]||r;for(++i;i<=65535&&t.SheetNames.indexOf(r=c+i)!=-1;++i);}if(r7(r),t.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return t.SheetNames.push(r),t.Sheets[r]=e,r}var oV={sheet_to_json:I4},w0={exports:{}};/* @license
Papa Parse
v5.5.3
https://github.com/mholt/PapaParse
License: MIT
*/var lV=w0.exports,c2;function cV(){return c2||(c2=1,function(t,e){((r,n)=>{t.exports=n()})(lV,function r(){var n=typeof self<"u"?self:typeof window<"u"?window:n!==void 0?n:{},i,o=!n.document&&!!n.postMessage,c=n.IS_PAPA_WORKER||!1,u={},h=0,p={};function g(A){this._handle=null,this._finished=!1,this._completed=!1,this._halted=!1,this._input=null,this._baseIndex=0,this._partialLine="",this._rowCount=0,this._start=0,this._nextChunk=null,this.isFirstChunk=!0,this._completeResults={data:[],errors:[],meta:{}},(function(E){var I=Z(E);I.chunkSize=parseInt(I.chunkSize),E.step||E.chunk||(I.chunkSize=null),this._handle=new S(I),(this._handle.streamer=this)._config=I}).call(this,A),this.parseChunk=function(E,I){var O=parseInt(this._config.skipFirstNLines)||0;if(this.isFirstChunk&&0<O){let F=this._config.newline;F||(D=this._config.quoteChar||'"',F=this._handle.guessLineEndings(E,D)),E=[...E.split(F).slice(O)].join(F)}this.isFirstChunk&&k(this._config.beforeFirstChunk)&&(D=this._config.beforeFirstChunk(E))!==void 0&&(E=D),this.isFirstChunk=!1,this._halted=!1;var O=this._partialLine+E,D=(this._partialLine="",this._handle.parse(O,this._baseIndex,!this._finished));if(!this._handle.paused()&&!this._handle.aborted()){if(E=D.meta.cursor,O=(this._finished||(this._partialLine=O.substring(E-this._baseIndex),this._baseIndex=E),D&&D.data&&(this._rowCount+=D.data.length),this._finished||this._config.preview&&this._rowCount>=this._config.preview),c)n.postMessage({results:D,workerId:p.WORKER_ID,finished:O});else if(k(this._config.chunk)&&!I){if(this._config.chunk(D,this._handle),this._handle.paused()||this._handle.aborted())return void(this._halted=!0);this._completeResults=D=void 0}return this._config.step||this._config.chunk||(this._completeResults.data=this._completeResults.data.concat(D.data),this._completeResults.errors=this._completeResults.errors.concat(D.errors),this._completeResults.meta=D.meta),this._completed||!O||!k(this._config.complete)||D&&D.meta.aborted||(this._config.complete(this._completeResults,this._input),this._completed=!0),O||D&&D.meta.paused||this._nextChunk(),D}this._halted=!0},this._sendError=function(E){k(this._config.error)?this._config.error(E):c&&this._config.error&&n.postMessage({workerId:p.WORKER_ID,error:E,finished:!1})}}function _(A){var E;(A=A||{}).chunkSize||(A.chunkSize=p.RemoteChunkSize),g.call(this,A),this._nextChunk=o?function(){this._readChunk(),this._chunkLoaded()}:function(){this._readChunk()},this.stream=function(I){this._input=I,this._nextChunk()},this._readChunk=function(){if(this._finished)this._chunkLoaded();else{if(E=new XMLHttpRequest,this._config.withCredentials&&(E.withCredentials=this._config.withCredentials),o||(E.onload=re(this._chunkLoaded,this),E.onerror=re(this._chunkError,this)),E.open(this._config.downloadRequestBody?"POST":"GET",this._input,!o),this._config.downloadRequestHeaders){var I,O=this._config.downloadRequestHeaders;for(I in O)E.setRequestHeader(I,O[I])}var D;this._config.chunkSize&&(D=this._start+this._config.chunkSize-1,E.setRequestHeader("Range","bytes="+this._start+"-"+D));try{E.send(this._config.downloadRequestBody)}catch(F){this._chunkError(F.message)}o&&E.status===0&&this._chunkError()}},this._chunkLoaded=function(){E.readyState===4&&(E.status<200||400<=E.status?this._chunkError():(this._start+=this._config.chunkSize||E.responseText.length,this._finished=!this._config.chunkSize||this._start>=(I=>(I=I.getResponseHeader("Content-Range"))!==null?parseInt(I.substring(I.lastIndexOf("/")+1)):-1)(E),this.parseChunk(E.responseText)))},this._chunkError=function(I){I=E.statusText||I,this._sendError(new Error(I))}}function x(A){(A=A||{}).chunkSize||(A.chunkSize=p.LocalChunkSize),g.call(this,A);var E,I,O=typeof FileReader<"u";this.stream=function(D){this._input=D,I=D.slice||D.webkitSlice||D.mozSlice,O?((E=new FileReader).onload=re(this._chunkLoaded,this),E.onerror=re(this._chunkError,this)):E=new FileReaderSync,this._nextChunk()},this._nextChunk=function(){this._finished||this._config.preview&&!(this._rowCount<this._config.preview)||this._readChunk()},this._readChunk=function(){var D=this._input,F=(this._config.chunkSize&&(F=Math.min(this._start+this._config.chunkSize,this._input.size),D=I.call(D,this._start,F)),E.readAsText(D,this._config.encoding));O||this._chunkLoaded({target:{result:F}})},this._chunkLoaded=function(D){this._start+=this._config.chunkSize,this._finished=!this._config.chunkSize||this._start>=this._input.size,this.parseChunk(D.target.result)},this._chunkError=function(){this._sendError(E.error)}}function T(A){var E;g.call(this,A=A||{}),this.stream=function(I){return E=I,this._nextChunk()},this._nextChunk=function(){var I,O;if(!this._finished)return I=this._config.chunkSize,E=I?(O=E.substring(0,I),E.substring(I)):(O=E,""),this._finished=!E,this.parseChunk(O)}}function w(A){g.call(this,A=A||{});var E=[],I=!0,O=!1;this.pause=function(){g.prototype.pause.apply(this,arguments),this._input.pause()},this.resume=function(){g.prototype.resume.apply(this,arguments),this._input.resume()},this.stream=function(D){this._input=D,this._input.on("data",this._streamData),this._input.on("end",this._streamEnd),this._input.on("error",this._streamError)},this._checkIsFinished=function(){O&&E.length===1&&(this._finished=!0)},this._nextChunk=function(){this._checkIsFinished(),E.length?this.parseChunk(E.shift()):I=!0},this._streamData=re(function(D){try{E.push(typeof D=="string"?D:D.toString(this._config.encoding)),I&&(I=!1,this._checkIsFinished(),this.parseChunk(E.shift()))}catch(F){this._streamError(F)}},this),this._streamError=re(function(D){this._streamCleanUp(),this._sendError(D)},this),this._streamEnd=re(function(){this._streamCleanUp(),O=!0,this._streamData("")},this),this._streamCleanUp=re(function(){this._input.removeListener("data",this._streamData),this._input.removeListener("end",this._streamEnd),this._input.removeListener("error",this._streamError)},this)}function S(A){var E,I,O,D,F=Math.pow(2,53),Fe=-F,Ce=/^\s*-?(\d+\.?|\.\d+|\d+\.\d+)([eE][-+]?\d+)?\s*$/,ae=/^((\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z)))$/,oe=this,be=0,ne=0,G=!1,se=!1,P=[],j={data:[],errors:[],meta:{}};function J(Ee){return A.skipEmptyLines==="greedy"?Ee.join("").trim()==="":Ee.length===1&&Ee[0].length===0}function ee(){if(j&&O&&(Ie("Delimiter","UndetectableDelimiter","Unable to auto-detect delimiting character; defaulted to '"+p.DefaultDelimiter+"'"),O=!1),A.skipEmptyLines&&(j.data=j.data.filter(function(W){return!J(W)})),ue()){let W=function(nt,Ge){k(A.transformHeader)&&(nt=A.transformHeader(nt,Ge)),P.push(nt)};var Ue=W;if(j)if(Array.isArray(j.data[0])){for(var Ee=0;ue()&&Ee<j.data.length;Ee++)j.data[Ee].forEach(W);j.data.splice(0,1)}else j.data.forEach(W)}function we(W,nt){for(var Ge=A.header?{}:[],Ke=0;Ke<W.length;Ke++){var Be=Ke,Ne=W[Ke],Ne=((Ye,ut)=>(_t=>(A.dynamicTypingFunction&&A.dynamicTyping[_t]===void 0&&(A.dynamicTyping[_t]=A.dynamicTypingFunction(_t)),(A.dynamicTyping[_t]||A.dynamicTyping)===!0))(Ye)?ut==="true"||ut==="TRUE"||ut!=="false"&&ut!=="FALSE"&&((_t=>{if(Ce.test(_t)&&(_t=parseFloat(_t),Fe<_t&&_t<F))return 1})(ut)?parseFloat(ut):ae.test(ut)?new Date(ut):ut===""?null:ut):ut)(Be=A.header?Ke>=P.length?"__parsed_extra":P[Ke]:Be,Ne=A.transform?A.transform(Ne,Be):Ne);Be==="__parsed_extra"?(Ge[Be]=Ge[Be]||[],Ge[Be].push(Ne)):Ge[Be]=Ne}return A.header&&(Ke>P.length?Ie("FieldMismatch","TooManyFields","Too many fields: expected "+P.length+" fields but parsed "+Ke,ne+nt):Ke<P.length&&Ie("FieldMismatch","TooFewFields","Too few fields: expected "+P.length+" fields but parsed "+Ke,ne+nt)),Ge}var Te;j&&(A.header||A.dynamicTyping||A.transform)&&(Te=1,!j.data.length||Array.isArray(j.data[0])?(j.data=j.data.map(we),Te=j.data.length):j.data=we(j.data,0),A.header&&j.meta&&(j.meta.fields=P),ne+=Te)}function ue(){return A.header&&P.length===0}function Ie(Ee,we,Te,Ue){Ee={type:Ee,code:we,message:Te},Ue!==void 0&&(Ee.row=Ue),j.errors.push(Ee)}k(A.step)&&(D=A.step,A.step=function(Ee){j=Ee,ue()?ee():(ee(),j.data.length!==0&&(be+=Ee.data.length,A.preview&&be>A.preview?I.abort():(j.data=j.data[0],D(j,oe))))}),this.parse=function(Ee,we,Te){var Ue=A.quoteChar||'"',Ue=(A.newline||(A.newline=this.guessLineEndings(Ee,Ue)),O=!1,A.delimiter?k(A.delimiter)&&(A.delimiter=A.delimiter(Ee),j.meta.delimiter=A.delimiter):((Ue=((W,nt,Ge,Ke,Be)=>{var Ne,Ye,ut,_t;Be=Be||[",","	","|",";",p.RECORD_SEP,p.UNIT_SEP];for(var rr=0;rr<Be.length;rr++){for(var _r,hr=Be[rr],Et=0,er=0,Ze=0,Je=(ut=void 0,new z({comments:Ke,delimiter:hr,newline:nt,preview:10}).parse(W)),dt=0;dt<Je.data.length;dt++)Ge&&J(Je.data[dt])?Ze++:(_r=Je.data[dt].length,er+=_r,ut===void 0?ut=_r:0<_r&&(Et+=Math.abs(_r-ut),ut=_r));0<Je.data.length&&(er/=Je.data.length-Ze),(Ye===void 0||Et<=Ye)&&(_t===void 0||_t<er)&&1.99<er&&(Ye=Et,Ne=hr,_t=er)}return{successful:!!(A.delimiter=Ne),bestDelimiter:Ne}})(Ee,A.newline,A.skipEmptyLines,A.comments,A.delimitersToGuess)).successful?A.delimiter=Ue.bestDelimiter:(O=!0,A.delimiter=p.DefaultDelimiter),j.meta.delimiter=A.delimiter),Z(A));return A.preview&&A.header&&Ue.preview++,E=Ee,I=new z(Ue),j=I.parse(E,we,Te),ee(),G?{meta:{paused:!0}}:j||{meta:{paused:!1}}},this.paused=function(){return G},this.pause=function(){G=!0,I.abort(),E=k(A.chunk)?"":E.substring(I.getCharIndex())},this.resume=function(){oe.streamer._halted?(G=!1,oe.streamer.parseChunk(E,!0)):setTimeout(oe.resume,3)},this.aborted=function(){return se},this.abort=function(){se=!0,I.abort(),j.meta.aborted=!0,k(A.complete)&&A.complete(j),E=""},this.guessLineEndings=function(W,Ue){W=W.substring(0,1048576);var Ue=new RegExp(C(Ue)+"([^]*?)"+C(Ue),"gm"),Te=(W=W.replace(Ue,"")).split("\r"),Ue=W.split(`
`),W=1<Ue.length&&Ue[0].length<Te[0].length;if(Te.length===1||W)return`
`;for(var nt=0,Ge=0;Ge<Te.length;Ge++)Te[Ge][0]===`
`&&nt++;return nt>=Te.length/2?`\r
`:"\r"}}function C(A){return A.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function z(A){var E=(A=A||{}).delimiter,I=A.newline,O=A.comments,D=A.step,F=A.preview,Fe=A.fastMode,Ce=null,ae=!1,oe=A.quoteChar==null?'"':A.quoteChar,be=oe;if(A.escapeChar!==void 0&&(be=A.escapeChar),(typeof E!="string"||-1<p.BAD_DELIMITERS.indexOf(E))&&(E=","),O===E)throw new Error("Comment character same as delimiter");O===!0?O="#":(typeof O!="string"||-1<p.BAD_DELIMITERS.indexOf(O))&&(O=!1),I!==`
`&&I!=="\r"&&I!==`\r
`&&(I=`
`);var ne=0,G=!1;this.parse=function(se,P,j){if(typeof se!="string")throw new Error("Input must be a string");var J=se.length,ee=E.length,ue=I.length,Ie=O.length,Ee=k(D),we=[],Te=[],Ue=[],W=ne=0;if(!se)return Et();if(Fe||Fe!==!1&&se.indexOf(oe)===-1){for(var nt=se.split(I),Ge=0;Ge<nt.length;Ge++){if(Ue=nt[Ge],ne+=Ue.length,Ge!==nt.length-1)ne+=I.length;else if(j)return Et();if(!O||Ue.substring(0,Ie)!==O){if(Ee){if(we=[],_t(Ue.split(E)),er(),G)return Et()}else _t(Ue.split(E));if(F&&F<=Ge)return we=we.slice(0,F),Et(!0)}}return Et()}for(var Ke=se.indexOf(E,ne),Be=se.indexOf(I,ne),Ne=new RegExp(C(be)+C(oe),"g"),Ye=se.indexOf(oe,ne);;)if(se[ne]===oe)for(Ye=ne,ne++;;){if((Ye=se.indexOf(oe,Ye+1))===-1)return j||Te.push({type:"Quotes",code:"MissingQuotes",message:"Quoted field unterminated",row:we.length,index:ne}),_r();if(Ye===J-1)return _r(se.substring(ne,Ye).replace(Ne,oe));if(oe===be&&se[Ye+1]===be)Ye++;else if(oe===be||Ye===0||se[Ye-1]!==be){Ke!==-1&&Ke<Ye+1&&(Ke=se.indexOf(E,Ye+1));var ut=rr((Be=Be!==-1&&Be<Ye+1?se.indexOf(I,Ye+1):Be)===-1?Ke:Math.min(Ke,Be));if(se.substr(Ye+1+ut,ee)===E){Ue.push(se.substring(ne,Ye).replace(Ne,oe)),se[ne=Ye+1+ut+ee]!==oe&&(Ye=se.indexOf(oe,ne)),Ke=se.indexOf(E,ne),Be=se.indexOf(I,ne);break}if(ut=rr(Be),se.substring(Ye+1+ut,Ye+1+ut+ue)===I){if(Ue.push(se.substring(ne,Ye).replace(Ne,oe)),hr(Ye+1+ut+ue),Ke=se.indexOf(E,ne),Ye=se.indexOf(oe,ne),Ee&&(er(),G))return Et();if(F&&we.length>=F)return Et(!0);break}Te.push({type:"Quotes",code:"InvalidQuotes",message:"Trailing quote on quoted field is malformed",row:we.length,index:ne}),Ye++}}else if(O&&Ue.length===0&&se.substring(ne,ne+Ie)===O){if(Be===-1)return Et();ne=Be+ue,Be=se.indexOf(I,ne),Ke=se.indexOf(E,ne)}else if(Ke!==-1&&(Ke<Be||Be===-1))Ue.push(se.substring(ne,Ke)),ne=Ke+ee,Ke=se.indexOf(E,ne);else{if(Be===-1)break;if(Ue.push(se.substring(ne,Be)),hr(Be+ue),Ee&&(er(),G))return Et();if(F&&we.length>=F)return Et(!0)}return _r();function _t(Ze){we.push(Ze),W=ne}function rr(Ze){var Je=0;return Je=Ze!==-1&&(Ze=se.substring(Ye+1,Ze))&&Ze.trim()===""?Ze.length:Je}function _r(Ze){return j||(Ze===void 0&&(Ze=se.substring(ne)),Ue.push(Ze),ne=J,_t(Ue),Ee&&er()),Et()}function hr(Ze){ne=Ze,_t(Ue),Ue=[],Be=se.indexOf(I,ne)}function Et(Ze){if(A.header&&!P&&we.length&&!ae){var Je=we[0],dt=Object.create(null),Lt=new Set(Je);let ot=!1;for(let Ft=0;Ft<Je.length;Ft++){let Vt=Je[Ft];if(dt[Vt=k(A.transformHeader)?A.transformHeader(Vt,Ft):Vt]){let Ot,Lr=dt[Vt];for(;Ot=Vt+"_"+Lr,Lr++,Lt.has(Ot););Lt.add(Ot),Je[Ft]=Ot,dt[Vt]++,ot=!0,(Ce=Ce===null?{}:Ce)[Ot]=Vt}else dt[Vt]=1,Je[Ft]=Vt;Lt.add(Vt)}ot&&console.warn("Duplicate headers found and renamed."),ae=!0}return{data:we,errors:Te,meta:{delimiter:E,linebreak:I,aborted:G,truncated:!!Ze,cursor:W+(P||0),renamedHeaders:Ce}}}function er(){D(Et()),we=[],Te=[]}},this.abort=function(){G=!0},this.getCharIndex=function(){return ne}}function Y(A){var E=A.data,I=u[E.workerId],O=!1;if(E.error)I.userError(E.error,E.file);else if(E.results&&E.results.data){var D={abort:function(){O=!0,L(E.workerId,{data:[],errors:[],meta:{aborted:!0}})},pause:K,resume:K};if(k(I.userStep)){for(var F=0;F<E.results.data.length&&(I.userStep({data:E.results.data[F],errors:E.results.errors,meta:E.results.meta},D),!O);F++);delete E.results}else k(I.userChunk)&&(I.userChunk(E.results,D,E.file),delete E.results)}E.finished&&!O&&L(E.workerId,E.results)}function L(A,E){var I=u[A];k(I.userComplete)&&I.userComplete(E),I.terminate(),delete u[A]}function K(){throw new Error("Not implemented.")}function Z(A){if(typeof A!="object"||A===null)return A;var E,I=Array.isArray(A)?[]:{};for(E in A)I[E]=Z(A[E]);return I}function re(A,E){return function(){A.apply(E,arguments)}}function k(A){return typeof A=="function"}return p.parse=function(A,E){var I=(E=E||{}).dynamicTyping||!1;if(k(I)&&(E.dynamicTypingFunction=I,I={}),E.dynamicTyping=I,E.transform=!!k(E.transform)&&E.transform,!E.worker||!p.WORKERS_SUPPORTED)return I=null,p.NODE_STREAM_INPUT,typeof A=="string"?(A=(O=>O.charCodeAt(0)!==65279?O:O.slice(1))(A),I=new(E.download?_:T)(E)):A.readable===!0&&k(A.read)&&k(A.on)?I=new w(E):(n.File&&A instanceof File||A instanceof Object)&&(I=new x(E)),I.stream(A);(I=(()=>{var O;return!!p.WORKERS_SUPPORTED&&(O=(()=>{var D=n.URL||n.webkitURL||null,F=r.toString();return p.BLOB_URL||(p.BLOB_URL=D.createObjectURL(new Blob(["var global = (function() { if (typeof self !== 'undefined') { return self; } if (typeof window !== 'undefined') { return window; } if (typeof global !== 'undefined') { return global; } return {}; })(); global.IS_PAPA_WORKER=true; ","(",F,")();"],{type:"text/javascript"})))})(),(O=new n.Worker(O)).onmessage=Y,O.id=h++,u[O.id]=O)})()).userStep=E.step,I.userChunk=E.chunk,I.userComplete=E.complete,I.userError=E.error,E.step=k(E.step),E.chunk=k(E.chunk),E.complete=k(E.complete),E.error=k(E.error),delete E.worker,I.postMessage({input:A,config:E,workerId:I.id})},p.unparse=function(A,E){var I=!1,O=!0,D=",",F=`\r
`,Fe='"',Ce=Fe+Fe,ae=!1,oe=null,be=!1,ne=((()=>{if(typeof E=="object"){if(typeof E.delimiter!="string"||p.BAD_DELIMITERS.filter(function(P){return E.delimiter.indexOf(P)!==-1}).length||(D=E.delimiter),typeof E.quotes!="boolean"&&typeof E.quotes!="function"&&!Array.isArray(E.quotes)||(I=E.quotes),typeof E.skipEmptyLines!="boolean"&&typeof E.skipEmptyLines!="string"||(ae=E.skipEmptyLines),typeof E.newline=="string"&&(F=E.newline),typeof E.quoteChar=="string"&&(Fe=E.quoteChar),typeof E.header=="boolean"&&(O=E.header),Array.isArray(E.columns)){if(E.columns.length===0)throw new Error("Option columns is empty");oe=E.columns}E.escapeChar!==void 0&&(Ce=E.escapeChar+Fe),E.escapeFormulae instanceof RegExp?be=E.escapeFormulae:typeof E.escapeFormulae=="boolean"&&E.escapeFormulae&&(be=/^[=+\-@\t\r].*$/)}})(),new RegExp(C(Fe),"g"));if(typeof A=="string"&&(A=JSON.parse(A)),Array.isArray(A)){if(!A.length||Array.isArray(A[0]))return G(null,A,ae);if(typeof A[0]=="object")return G(oe||Object.keys(A[0]),A,ae)}else if(typeof A=="object")return typeof A.data=="string"&&(A.data=JSON.parse(A.data)),Array.isArray(A.data)&&(A.fields||(A.fields=A.meta&&A.meta.fields||oe),A.fields||(A.fields=Array.isArray(A.data[0])?A.fields:typeof A.data[0]=="object"?Object.keys(A.data[0]):[]),Array.isArray(A.data[0])||typeof A.data[0]=="object"||(A.data=[A.data])),G(A.fields||[],A.data||[],ae);throw new Error("Unable to serialize unrecognized input");function G(P,j,J){var ee="",ue=(typeof P=="string"&&(P=JSON.parse(P)),typeof j=="string"&&(j=JSON.parse(j)),Array.isArray(P)&&0<P.length),Ie=!Array.isArray(j[0]);if(ue&&O){for(var Ee=0;Ee<P.length;Ee++)0<Ee&&(ee+=D),ee+=se(P[Ee],Ee);0<j.length&&(ee+=F)}for(var we=0;we<j.length;we++){var Te=(ue?P:j[we]).length,Ue=!1,W=ue?Object.keys(j[we]).length===0:j[we].length===0;if(J&&!ue&&(Ue=J==="greedy"?j[we].join("").trim()==="":j[we].length===1&&j[we][0].length===0),J==="greedy"&&ue){for(var nt=[],Ge=0;Ge<Te;Ge++){var Ke=Ie?P[Ge]:Ge;nt.push(j[we][Ke])}Ue=nt.join("").trim()===""}if(!Ue){for(var Be=0;Be<Te;Be++){0<Be&&!W&&(ee+=D);var Ne=ue&&Ie?P[Be]:Be;ee+=se(j[we][Ne],Be)}we<j.length-1&&(!J||0<Te&&!W)&&(ee+=F)}}return ee}function se(P,j){var J,ee;return P==null?"":P.constructor===Date?JSON.stringify(P).slice(1,25):(ee=!1,be&&typeof P=="string"&&be.test(P)&&(P="'"+P,ee=!0),J=P.toString().replace(ne,Ce),(ee=ee||I===!0||typeof I=="function"&&I(P,j)||Array.isArray(I)&&I[j]||((ue,Ie)=>{for(var Ee=0;Ee<Ie.length;Ee++)if(-1<ue.indexOf(Ie[Ee]))return!0;return!1})(J,p.BAD_DELIMITERS)||-1<J.indexOf(D)||J.charAt(0)===" "||J.charAt(J.length-1)===" ")?Fe+J+Fe:J)}},p.RECORD_SEP="",p.UNIT_SEP="",p.BYTE_ORDER_MARK="\uFEFF",p.BAD_DELIMITERS=["\r",`
`,'"',p.BYTE_ORDER_MARK],p.WORKERS_SUPPORTED=!o&&!!n.Worker,p.NODE_STREAM_INPUT=1,p.LocalChunkSize=10485760,p.RemoteChunkSize=5242880,p.DefaultDelimiter=",",p.Parser=z,p.ParserHandle=S,p.NetworkStreamer=_,p.FileStreamer=x,p.StringStreamer=T,p.ReadableStreamStreamer=w,n.jQuery&&((i=n.jQuery).fn.parse=function(A){var E=A.config||{},I=[];return this.each(function(F){if(!(i(this).prop("tagName").toUpperCase()==="INPUT"&&i(this).attr("type").toLowerCase()==="file"&&n.FileReader)||!this.files||this.files.length===0)return!0;for(var Fe=0;Fe<this.files.length;Fe++)I.push({file:this.files[Fe],inputElem:this,instanceConfig:i.extend({},E)})}),O(),this;function O(){if(I.length===0)k(A.complete)&&A.complete();else{var F,Fe,Ce,ae,oe=I[0];if(k(A.before)){var be=A.before(oe.file,oe.inputElem);if(typeof be=="object"){if(be.action==="abort")return F="AbortError",Fe=oe.file,Ce=oe.inputElem,ae=be.reason,void(k(A.error)&&A.error({name:F},Fe,Ce,ae));if(be.action==="skip")return void D();typeof be.config=="object"&&(oe.instanceConfig=i.extend(oe.instanceConfig,be.config))}else if(be==="skip")return void D()}var ne=oe.instanceConfig.complete;oe.instanceConfig.complete=function(G){k(ne)&&ne(G,oe.file,oe.inputElem),D()},p.parse(oe.file,oe.instanceConfig)}}function D(){I.splice(0,1),O()}}),c&&(n.onmessage=function(A){A=A.data,p.WORKER_ID===void 0&&A&&(p.WORKER_ID=A.workerId),typeof A.input=="string"?n.postMessage({workerId:p.WORKER_ID,results:p.parse(A.input,A.config),finished:!0}):(n.File&&A.input instanceof File||A.input instanceof Object)&&(A=p.parse(A.input,A.config))&&n.postMessage({workerId:p.WORKER_ID,results:A,finished:!0})}),(_.prototype=Object.create(g.prototype)).constructor=_,(x.prototype=Object.create(g.prototype)).constructor=x,(T.prototype=Object.create(T.prototype)).constructor=T,(w.prototype=Object.create(g.prototype)).constructor=w,p})}(w0)),w0.exports}var uV=cV();const fV=Ug(uV),hV=()=>{const[t,e]=Pe.useState([]),[r,n]=Pe.useState([]),[i,o]=Pe.useState(!0),[c,u]=Pe.useState(!1),[h,p]=Pe.useState(null),[g,_]=Pe.useState({nom:"",prenom:"",classeId:"",email:"",dateNaissance:""}),[x,T]=Pe.useState(null);Pe.useEffect(()=>{w(),S()},[]);const w=async()=>{try{o(!0);const Z=await So.getAllEleves();e(Z)}catch(Z){T("Erreur lors du chargement des lves"),console.error(Z)}finally{o(!1)}},S=async()=>{try{const Z=await w6.getAllClasses();n(Z)}catch(Z){T("Erreur lors du chargement des classes"),console.error(Z)}},C=async Z=>{if(Z.preventDefault(),!g.nom.trim()||!g.prenom.trim()||!g.classeId){T("Tous les champs obligatoires doivent tre remplis");return}try{h?await So.updateEleve(h.id,g):await So.createEleve(g),_({nom:"",prenom:"",classeId:"",email:"",dateNaissance:""}),p(null),u(!1),T(null),await w()}catch(re){T("Erreur lors de l'enregistrement"),console.error(re)}},z=Z=>{p(Z),_({nom:Z.nom,prenom:Z.prenom,classeId:Z.classeId,email:Z.email||"",dateNaissance:Z.dateNaissance||""}),u(!0)},Y=async Z=>{if(window.confirm("tes-vous sr de vouloir supprimer cet lve ?"))try{await So.deleteEleve(Z),await w()}catch(re){T("Erreur lors de la suppression"),console.error(re)}},L=()=>{_({nom:"",prenom:"",classeId:"",email:"",dateNaissance:""}),p(null),u(!1),T(null)},K=async Z=>{const re=Z.target.files?.[0];if(re){T(null);try{let k=[];if(re.name.endsWith(".csv")){const F=await re.text(),Fe=F.includes(";");k=fV.parse(F,{header:!0,delimiter:Fe?";":","}).data.filter(ae=>Object.values(ae).some(oe=>oe&&String(oe).trim()!=="")),k.length>0&&(k=k.map(ae=>{const oe={};return Object.keys(ae).forEach(be=>{oe[be.trim()]=typeof ae[be]=="string"?ae[be].trim():ae[be]}),oe}))}else if(re.name.endsWith(".xlsx")){const F=await re.arrayBuffer(),Fe=Vg(F,{type:"array"}),Ce=Fe.Sheets[Fe.SheetNames[0]];k=oV.sheet_to_json(Ce)}else{T("Format de fichier non support. Utilisez .csv ou .xlsx");return}const A=["nom","prenom","classe"],E=k[0]||{},I=Object.keys(E).join(", ");for(const F of A)if(!Object.keys(E).includes(F)){T(`Colonne manquante ou vide : ${F}. Colonnes dtectes : ${I}`);return}for(const F of k)for(const Fe of A)if(!F[Fe]){T(`Colonne manquante ou vide : ${Fe}. Colonnes dtectes : ${I}`);return}const O=new Map(r.map(F=>[F.nom,F.id])),D=Array.from(new Set(k.map(F=>F.classe).filter(F=>!O.has(F))));if(D.length>0){T("Classe(s) inconnue(s) : "+D.join(", "));return}for(const F of k)await So.createEleve({nom:F.nom,prenom:F.prenom,classeId:String(O.get(F.classe)),email:F.email||"",dateNaissance:F.dateNaissance||""});await w(),T(null),alert("Import termin !")}catch(k){T("Erreur lors de l'import : "+k.message),console.error(k)}}};return i?Q.jsx("div",{className:"loading",children:"Chargement des lves..."}):Q.jsxs("div",{className:"gestion-eleves",children:[Q.jsxs("div",{className:"header",children:[Q.jsx("h2",{children:"Gestion des lves"}),Q.jsxs("div",{style:{display:"flex",gap:"1rem"},children:[Q.jsx("button",{className:"btn-primary",onClick:()=>u(!0),children:"Ajouter un lve"}),Q.jsxs("label",{className:"btn-primary",style:{cursor:"pointer",margin:0},children:["Importer des lves",Q.jsx("input",{type:"file",accept:".csv,.xlsx",style:{display:"none"},onChange:K})]})]})]}),x&&Q.jsx("div",{className:"error-message",children:x}),c&&Q.jsx("div",{className:"form-overlay",children:Q.jsxs("div",{className:"form-container",children:[Q.jsx("h3",{children:h?"Modifier l'lve":"Nouvel lve"}),Q.jsxs("form",{onSubmit:C,children:[Q.jsxs("div",{className:"form-group",children:[Q.jsx("label",{htmlFor:"nom",children:"Nom"}),Q.jsx("input",{type:"text",id:"nom",value:g.nom,onChange:Z=>_({...g,nom:Z.target.value}),required:!0})]}),Q.jsxs("div",{className:"form-group",children:[Q.jsx("label",{htmlFor:"prenom",children:"Prnom"}),Q.jsx("input",{type:"text",id:"prenom",value:g.prenom,onChange:Z=>_({...g,prenom:Z.target.value}),required:!0})]}),Q.jsxs("div",{className:"form-group",children:[Q.jsx("label",{htmlFor:"classeId",children:"Classe"}),Q.jsxs("select",{id:"classeId",value:g.classeId,onChange:Z=>_({...g,classeId:Z.target.value}),required:!0,children:[Q.jsx("option",{value:"",children:"Slectionner une classe"}),r.map(Z=>Q.jsx("option",{value:Z.id,children:Z.nom},Z.id))]})]}),Q.jsxs("div",{className:"form-group",children:[Q.jsx("label",{htmlFor:"email",children:"Email"}),Q.jsx("input",{type:"email",id:"email",value:g.email,onChange:Z=>_({...g,email:Z.target.value})})]}),Q.jsxs("div",{className:"form-group",children:[Q.jsx("label",{htmlFor:"dateNaissance",children:"Date de naissance"}),Q.jsx("input",{type:"date",id:"dateNaissance",value:g.dateNaissance,onChange:Z=>_({...g,dateNaissance:Z.target.value})})]}),Q.jsxs("div",{className:"form-actions",children:[Q.jsx("button",{type:"submit",className:"btn-primary",children:h?"Modifier":"Crer"}),Q.jsx("button",{type:"button",className:"btn-secondary",onClick:L,children:"Annuler"}),!h&&Q.jsx("button",{type:"button",className:"btn-primary",onClick:async()=>{if(!g.nom.trim()||!g.prenom.trim()||!g.classeId){T("Tous les champs obligatoires doivent tre remplis");return}try{await So.createEleve(g),_({nom:"",prenom:"",classeId:"",email:"",dateNaissance:""}),T(null),await w()}catch(Z){T("Erreur lors de la cration"),console.error(Z)}},children:"Crer et ajouter un autre"})]})]})]})}),Q.jsx("div",{className:"eleves-grid",children:t.length===0?Q.jsxs("div",{className:"empty-state",children:[Q.jsx("p",{children:"Aucun lve trouv"}),Q.jsx("button",{className:"btn-primary",onClick:()=>u(!0),children:"Crer le premier lve"})]}):t.map(Z=>Q.jsxs("div",{className:"eleve-card",children:[Q.jsxs("div",{className:"eleve-info",children:[Q.jsxs("h3",{children:[Z.prenom," ",Z.nom]}),Q.jsxs("p",{children:["Classe : ",r.find(re=>re.id===Z.classeId)?.nom||"Inconnue"]}),Q.jsxs("p",{children:["Email : ",Z.email||"Non renseign"]}),Q.jsxs("p",{children:["Date de naissance : ",Z.dateNaissance||"Non renseigne"]}),Q.jsxs("p",{children:["Cr le ",(()=>{let re=Z.createdAt;return re instanceof Date||(re=new Date(re)),isNaN(re.getTime())?"Date inconnue":re.toLocaleDateString("fr-FR")})()]})]}),Q.jsxs("div",{className:"eleve-actions",children:[Q.jsx("button",{className:"btn-edit",onClick:()=>z(Z),children:"Modifier"}),Q.jsx("button",{className:"btn-delete",onClick:()=>Y(Z.id),children:"Supprimer"})]})]},Z.id))})]})},d0={async getAllStages(){return(await Sf(si(or,"stages"))).docs.map(e=>{const r=e.data();return{id:e.id,eleveId:r.eleveId,entreprise:r.entreprise,tuteurNom:r.tuteurNom,tuteurEmail:r.tuteurEmail||"",dateDebut:r.dateDebut,dateFin:r.dateFin,sujet:r.sujet||"",appreciation:r.appreciation||"",createdAt:r.createdAt?.toDate?r.createdAt.toDate():new Date(r.createdAt)}})},async createStage(t){await kf(si(or,"stages"),{...t,createdAt:new Date})},async updateStage(t,e){await Cf(Pn(or,"stages",t),e)},async deleteStage(t){await Rf(Pn(or,"stages",t))}},dV=()=>{const[t,e]=Pe.useState([]),[r,n]=Pe.useState([]),[i,o]=Pe.useState(!0),[c,u]=Pe.useState(!1),[h,p]=Pe.useState(null),[g,_]=Pe.useState({eleveId:"",entreprise:"",tuteurNom:"",tuteurEmail:"",dateDebut:"",dateFin:"",sujet:"",appreciation:""}),[x,T]=Pe.useState(null);Pe.useEffect(()=>{w(),S()},[]);const w=async()=>{try{o(!0);const K=await d0.getAllStages();e(K)}catch(K){T("Erreur lors du chargement des stages"),console.error(K)}finally{o(!1)}},S=async()=>{try{const K=await So.getAllEleves();n(K)}catch(K){T("Erreur lors du chargement des lves"),console.error(K)}},C=async K=>{if(K.preventDefault(),!g.eleveId||!g.entreprise.trim()||!g.tuteurNom.trim()||!g.dateDebut||!g.dateFin){T("Tous les champs obligatoires doivent tre remplis");return}try{h?await d0.updateStage(h.id,g):await d0.createStage(g),_({eleveId:"",entreprise:"",tuteurNom:"",tuteurEmail:"",dateDebut:"",dateFin:"",sujet:"",appreciation:""}),p(null),u(!1),T(null),await w()}catch(Z){T("Erreur lors de l'enregistrement"),console.error(Z)}},z=K=>{p(K),_({eleveId:K.eleveId,entreprise:K.entreprise,tuteurNom:K.tuteurNom,tuteurEmail:K.tuteurEmail||"",dateDebut:K.dateDebut,dateFin:K.dateFin,sujet:K.sujet||"",appreciation:K.appreciation||""}),u(!0)},Y=async K=>{if(window.confirm("tes-vous sr de vouloir supprimer ce stage ?"))try{await d0.deleteStage(K),await w()}catch(Z){T("Erreur lors de la suppression"),console.error(Z)}},L=()=>{_({eleveId:"",entreprise:"",tuteurNom:"",tuteurEmail:"",dateDebut:"",dateFin:"",sujet:"",appreciation:""}),p(null),u(!1),T(null)};return i?Q.jsx("div",{className:"loading",children:"Chargement des stages..."}):Q.jsxs("div",{className:"gestion-eleves",children:[Q.jsxs("div",{className:"header",children:[Q.jsx("h2",{children:"Gestion des Stages"}),Q.jsx("button",{className:"btn-primary",onClick:()=>u(!0),children:"Ajouter un stage"})]}),x&&Q.jsx("div",{className:"error-message",children:x}),c&&Q.jsx("div",{className:"form-overlay",children:Q.jsxs("div",{className:"form-container",children:[Q.jsx("h3",{children:h?"Modifier le stage":"Nouveau stage"}),Q.jsxs("form",{onSubmit:C,children:[Q.jsxs("div",{className:"form-group",children:[Q.jsx("label",{htmlFor:"eleveId",children:"lve"}),Q.jsxs("select",{id:"eleveId",value:g.eleveId,onChange:K=>_({...g,eleveId:K.target.value}),required:!0,children:[Q.jsx("option",{value:"",children:"Slectionner un lve"}),r.map(K=>Q.jsxs("option",{value:K.id,children:[K.prenom," ",K.nom]},K.id))]})]}),Q.jsxs("div",{className:"form-group",children:[Q.jsx("label",{htmlFor:"entreprise",children:"Entreprise"}),Q.jsx("input",{type:"text",id:"entreprise",value:g.entreprise,onChange:K=>_({...g,entreprise:K.target.value}),required:!0})]}),Q.jsxs("div",{className:"form-group",children:[Q.jsx("label",{htmlFor:"tuteurNom",children:"Tuteur"}),Q.jsx("input",{type:"text",id:"tuteurNom",value:g.tuteurNom,onChange:K=>_({...g,tuteurNom:K.target.value}),required:!0})]}),Q.jsxs("div",{className:"form-group",children:[Q.jsx("label",{htmlFor:"tuteurEmail",children:"Email du tuteur"}),Q.jsx("input",{type:"email",id:"tuteurEmail",value:g.tuteurEmail,onChange:K=>_({...g,tuteurEmail:K.target.value})})]}),Q.jsxs("div",{className:"form-group",children:[Q.jsx("label",{htmlFor:"dateDebut",children:"Date de dbut"}),Q.jsx("input",{type:"date",id:"dateDebut",value:g.dateDebut,onChange:K=>_({...g,dateDebut:K.target.value}),required:!0})]}),Q.jsxs("div",{className:"form-group",children:[Q.jsx("label",{htmlFor:"dateFin",children:"Date de fin"}),Q.jsx("input",{type:"date",id:"dateFin",value:g.dateFin,onChange:K=>_({...g,dateFin:K.target.value}),required:!0})]}),Q.jsxs("div",{className:"form-group",children:[Q.jsx("label",{htmlFor:"sujet",children:"Sujet/Mission"}),Q.jsx("input",{type:"text",id:"sujet",value:g.sujet,onChange:K=>_({...g,sujet:K.target.value})})]}),Q.jsxs("div",{className:"form-group",children:[Q.jsx("label",{htmlFor:"appreciation",children:"Apprciation"}),Q.jsx("input",{type:"text",id:"appreciation",value:g.appreciation,onChange:K=>_({...g,appreciation:K.target.value})})]}),Q.jsxs("div",{className:"form-actions",children:[Q.jsx("button",{type:"submit",className:"btn-primary",children:h?"Modifier":"Crer"}),Q.jsx("button",{type:"button",className:"btn-secondary",onClick:L,children:"Annuler"})]})]})]})}),Q.jsx("div",{className:"eleves-grid",children:t.length===0?Q.jsxs("div",{className:"empty-state",children:[Q.jsx("p",{children:"Aucun stage trouv"}),Q.jsx("button",{className:"btn-primary",onClick:()=>u(!0),children:"Crer le premier stage"})]}):t.map(K=>Q.jsxs("div",{className:"eleve-card",children:[Q.jsxs("div",{className:"eleve-info",children:[Q.jsx("h3",{children:(()=>{const Z=r.find(re=>re.id===K.eleveId);return Z?`${Z.prenom} ${Z.nom}`:"lve inconnu"})()}),Q.jsxs("p",{children:["Entreprise : ",K.entreprise]}),Q.jsxs("p",{children:["Tuteur : ",K.tuteurNom," ",K.tuteurEmail&&`(${K.tuteurEmail})`]}),Q.jsxs("p",{children:["Du ",K.dateDebut," au ",K.dateFin]}),K.sujet&&Q.jsxs("p",{children:["Sujet : ",K.sujet]}),K.appreciation&&Q.jsxs("p",{children:["Apprciation : ",K.appreciation]}),Q.jsxs("p",{children:["Cr le ",(()=>{let Z=K.createdAt;return Z instanceof Date||(Z=new Date(Z)),isNaN(Z.getTime())?"Date inconnue":Z.toLocaleDateString("fr-FR")})()]})]}),Q.jsxs("div",{className:"eleve-actions",children:[Q.jsx("button",{className:"btn-edit",onClick:()=>z(K),children:"Modifier"}),Q.jsx("button",{className:"btn-delete",onClick:()=>Y(K.id),children:"Supprimer"})]})]},K.id))})]})},Dd="periodesStage",pV=async()=>(await Sf(si(or,Dd))).docs.map(e=>({id:e.id,...e.data()})),mV=async t=>(await kf(si(or,Dd),t)).id,gV=async(t,e)=>{await Cf(Pn(or,Dd,t),e)},vV=async t=>{await Rf(Pn(or,Dd,t))},_V=()=>{const[t,e]=Pe.useState([]),[r,n]=Pe.useState({nom:"",dateDebut:"",dateFin:""}),[i,o]=Pe.useState(null),[c,u]=Pe.useState(!1),h=async()=>{u(!0),e(await pV()),u(!1)};Pe.useEffect(()=>{h()},[]);const p=T=>{n({...r,[T.target.name]:T.target.value})},g=async T=>{T.preventDefault(),i?(await gV(i,r),o(null)):await mV(r),n({nom:"",dateDebut:"",dateFin:""}),h()},_=T=>{o(T.id),n({nom:T.nom,dateDebut:T.dateDebut,dateFin:T.dateFin})},x=async T=>{window.confirm("Supprimer cette priode ?")&&(await vV(T),h())};return Q.jsxs("div",{className:"gestion-periodes-stage",children:[Q.jsx("h2",{children:"Gestion des priodes de stage"}),Q.jsxs("form",{onSubmit:g,style:{marginBottom:24},children:[Q.jsx("input",{name:"nom",placeholder:"Nom (ex: PFMP1)",value:r.nom,onChange:p,required:!0}),Q.jsx("input",{name:"dateDebut",type:"date",value:r.dateDebut,onChange:p,required:!0}),Q.jsx("input",{name:"dateFin",type:"date",value:r.dateFin,onChange:p,required:!0}),Q.jsx("button",{type:"submit",children:i?"Modifier":"Ajouter"}),i&&Q.jsx("button",{type:"button",onClick:()=>{o(null),n({nom:"",dateDebut:"",dateFin:""})},children:"Annuler"})]}),c?Q.jsx("p",{children:"Chargement..."}):Q.jsxs("table",{children:[Q.jsx("thead",{children:Q.jsxs("tr",{children:[Q.jsx("th",{children:"Nom"}),Q.jsx("th",{children:"Dbut"}),Q.jsx("th",{children:"Fin"}),Q.jsx("th",{children:"Actions"})]})}),Q.jsx("tbody",{children:t.map(T=>Q.jsxs("tr",{children:[Q.jsx("td",{children:T.nom}),Q.jsx("td",{children:T.dateDebut}),Q.jsx("td",{children:T.dateFin}),Q.jsxs("td",{children:[Q.jsx("button",{onClick:()=>_(T),children:"Modifier"}),Q.jsx("button",{onClick:()=>x(T.id),children:"Supprimer"})]})]},T.id))})]})]})},xV=({isDarkMode:t})=>{const{currentUser:e}=Cd(),r=[{label:"Grer les classes",description:"Crez, modifiez et supprimez les classes",link:"/classes",show:e?.role==="admin",icon:""},{label:"Grer les lves",description:"Ajoutez et grez les lves",link:"/eleves",show:!0,icon:""},{label:"Grer les stages",description:"Attribuez et suivez les stages",link:"/stages",show:!0,icon:""},{label:"valuer un lve",description:"Remplissez une fiche d'valuation",link:"/evaluations",show:!0,icon:""},{label:"Exporter rapports",description:"Tlchargez les rapports de suivi",link:"/rapports",show:!0,icon:""},{label:"Gestion des comptes",description:"Grez les comptes utilisateurs",link:"/comptes",show:e?.role==="admin",icon:""}];return Q.jsx("div",{className:`app home-landing ${t?"dark":"light"}`,children:Q.jsxs("main",{className:"main",style:{marginTop:"80px",minHeight:"80vh"},children:[Q.jsx("h1",{style:{textAlign:"center",fontSize:"3rem",fontWeight:800,marginBottom:"1rem"},children:"Grez vos stages et valuations avec IA"}),Q.jsx("p",{style:{textAlign:"center",fontSize:"1.3rem",marginBottom:"2.5rem",color:"#555"},children:"Plateforme moderne pour la gestion des stages, des lves et des valuations"}),Q.jsx("div",{className:"tiles-grid",children:r.filter(n=>n.show).map(n=>Q.jsxs("a",{href:n.link,className:"tile-card",children:[Q.jsx("div",{className:"tile-icon",children:n.icon}),Q.jsx("div",{className:"tile-title",children:n.label}),Q.jsx("div",{className:"tile-desc",children:n.description})]},n.label))}),e&&Q.jsxs("p",{style:{textAlign:"center",marginTop:"2rem",color:"#888"},children:["Connect en tant que : ",e.prenom," ",e.nom," (",e.role,")"]})]})})},yu=({children:t})=>{const{currentUser:e,loading:r}=Cd();return r?Q.jsx("div",{className:"loading",children:"Chargement..."}):e?Q.jsx(Q.Fragment,{children:t}):Q.jsx(S2,{to:"/login"})},yV=()=>{const[t,e]=Pe.useState(!1),r=()=>{e(!t)};return Q.jsx(ok,{children:Q.jsxs("div",{className:`app ${t?"dark":"light"}`,children:[Q.jsx(y6,{onToggleTheme:r,isDarkMode:t}),Q.jsxs(ak,{children:[Q.jsx(ys,{path:"/login",element:Q.jsx(E6,{})}),Q.jsx(ys,{path:"/",element:Q.jsx(yu,{children:Q.jsx(xV,{isDarkMode:t})})}),Q.jsx(ys,{path:"/classes",element:Q.jsx(yu,{children:Q.jsx(T6,{})})}),Q.jsx(ys,{path:"/eleves",element:Q.jsx(yu,{children:Q.jsx(hV,{})})}),Q.jsx(ys,{path:"/stages",element:Q.jsx(yu,{children:Q.jsx(dV,{})})}),Q.jsx(ys,{path:"/periodes-stage",element:Q.jsx(yu,{children:Q.jsx(_V,{})})}),Q.jsx(ys,{path:"*",element:Q.jsx(S2,{to:"/"})})]})]})})};function EV(){return Q.jsx(_6,{children:Q.jsx(yV,{})})}pR.createRoot(document.getElementById("root")).render(Q.jsx(u2.StrictMode,{children:Q.jsx(EV,{})}));
