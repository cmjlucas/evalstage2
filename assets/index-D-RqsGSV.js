function eN(t,e){for(var r=0;r<e.length;r++){const n=e[r];if(typeof n!="string"&&!Array.isArray(n)){for(const i in n)if(i!=="default"&&!(i in t)){const a=Object.getOwnPropertyDescriptor(n,i);a&&Object.defineProperty(t,i,a.get?a:{enumerable:!0,get:()=>n[i]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const a of i)if(a.type==="childList")for(const o of a.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function r(i){const a={};return i.integrity&&(a.integrity=i.integrity),i.referrerPolicy&&(a.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?a.credentials="include":i.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function n(i){if(i.ep)return;i.ep=!0;const a=r(i);fetch(i.href,a)}})();var qX=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function xx(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var Iv={exports:{}},Qd={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var s4;function tN(){if(s4)return Qd;s4=1;var t=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function r(n,i,a){var o=null;if(a!==void 0&&(o=""+a),i.key!==void 0&&(o=""+i.key),"key"in i){a={};for(var c in i)c!=="key"&&(a[c]=i[c])}else a=i;return i=a.ref,{$$typeof:t,type:n,key:o,ref:i!==void 0?i:null,props:a}}return Qd.Fragment=e,Qd.jsx=r,Qd.jsxs=r,Qd}var o4;function rN(){return o4||(o4=1,Iv.exports=tN()),Iv.exports}var H=rN(),Rv={exports:{}},br={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var l4;function nN(){if(l4)return br;l4=1;var t=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),i=Symbol.for("react.profiler"),a=Symbol.for("react.consumer"),o=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),h=Symbol.for("react.memo"),d=Symbol.for("react.lazy"),g=Symbol.iterator;function x(X){return X===null||typeof X!="object"?null:(X=g&&X[g]||X["@@iterator"],typeof X=="function"?X:null)}var _={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},b=Object.assign,E={};function A(X,xe,L){this.props=X,this.context=xe,this.refs=E,this.updater=L||_}A.prototype.isReactComponent={},A.prototype.setState=function(X,xe){if(typeof X!="object"&&typeof X!="function"&&X!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,X,xe,"setState")},A.prototype.forceUpdate=function(X){this.updater.enqueueForceUpdate(this,X,"forceUpdate")};function O(){}O.prototype=A.prototype;function M(X,xe,L){this.props=X,this.context=xe,this.refs=E,this.updater=L||_}var B=M.prototype=new O;B.constructor=M,b(B,A.prototype),B.isPureReactComponent=!0;var Q=Array.isArray,ee={H:null,A:null,T:null,S:null,V:null},he=Object.prototype.hasOwnProperty;function F(X,xe,L,j,z,G){return L=G.ref,{$$typeof:t,type:X,key:xe,ref:L!==void 0?L:null,props:G}}function k(X,xe){return F(X.type,xe,void 0,void 0,void 0,X.props)}function S(X){return typeof X=="object"&&X!==null&&X.$$typeof===t}function U(X){var xe={"=":"=0",":":"=2"};return"$"+X.replace(/[=:]/g,function(L){return xe[L]})}var I=/\/+/g;function C(X,xe){return typeof X=="object"&&X!==null&&X.key!=null?U(""+X.key):xe.toString(36)}function R(){}function se(X){switch(X.status){case"fulfilled":return X.value;case"rejected":throw X.reason;default:switch(typeof X.status=="string"?X.then(R,R):(X.status="pending",X.then(function(xe){X.status==="pending"&&(X.status="fulfilled",X.value=xe)},function(xe){X.status==="pending"&&(X.status="rejected",X.reason=xe)})),X.status){case"fulfilled":return X.value;case"rejected":throw X.reason}}throw X}function ne(X,xe,L,j,z){var G=typeof X;(G==="undefined"||G==="boolean")&&(X=null);var ae=!1;if(X===null)ae=!0;else switch(G){case"bigint":case"string":case"number":ae=!0;break;case"object":switch(X.$$typeof){case t:case e:ae=!0;break;case d:return ae=X._init,ne(ae(X._payload),xe,L,j,z)}}if(ae)return z=z(X),ae=j===""?"."+C(X,0):j,Q(z)?(L="",ae!=null&&(L=ae.replace(I,"$&/")+"/"),ne(z,xe,L,"",function(Ee){return Ee})):z!=null&&(S(z)&&(z=k(z,L+(z.key==null||X&&X.key===z.key?"":(""+z.key).replace(I,"$&/")+"/")+ae)),xe.push(z)),1;ae=0;var Ae=j===""?".":j+":";if(Q(X))for(var _e=0;_e<X.length;_e++)j=X[_e],G=Ae+C(j,_e),ae+=ne(j,xe,L,G,z);else if(_e=x(X),typeof _e=="function")for(X=_e.call(X),_e=0;!(j=X.next()).done;)j=j.value,G=Ae+C(j,_e++),ae+=ne(j,xe,L,G,z);else if(G==="object"){if(typeof X.then=="function")return ne(se(X),xe,L,j,z);throw xe=String(X),Error("Objects are not valid as a React child (found: "+(xe==="[object Object]"?"object with keys {"+Object.keys(X).join(", ")+"}":xe)+"). If you meant to render a collection of children, use an array instead.")}return ae}function J(X,xe,L){if(X==null)return X;var j=[],z=0;return ne(X,j,"","",function(G){return xe.call(L,G,z++)}),j}function de(X){if(X._status===-1){var xe=X._result;xe=xe(),xe.then(function(L){(X._status===0||X._status===-1)&&(X._status=1,X._result=L)},function(L){(X._status===0||X._status===-1)&&(X._status=2,X._result=L)}),X._status===-1&&(X._status=0,X._result=xe)}if(X._status===1)return X._result.default;throw X._result}var oe=typeof reportError=="function"?reportError:function(X){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var xe=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof X=="object"&&X!==null&&typeof X.message=="string"?String(X.message):String(X),error:X});if(!window.dispatchEvent(xe))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",X);return}console.error(X)};function Z(){}return br.Children={map:J,forEach:function(X,xe,L){J(X,function(){xe.apply(this,arguments)},L)},count:function(X){var xe=0;return J(X,function(){xe++}),xe},toArray:function(X){return J(X,function(xe){return xe})||[]},only:function(X){if(!S(X))throw Error("React.Children.only expected to receive a single React element child.");return X}},br.Component=A,br.Fragment=r,br.Profiler=i,br.PureComponent=M,br.StrictMode=n,br.Suspense=u,br.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=ee,br.__COMPILER_RUNTIME={__proto__:null,c:function(X){return ee.H.useMemoCache(X)}},br.cache=function(X){return function(){return X.apply(null,arguments)}},br.cloneElement=function(X,xe,L){if(X==null)throw Error("The argument must be a React element, but you passed "+X+".");var j=b({},X.props),z=X.key,G=void 0;if(xe!=null)for(ae in xe.ref!==void 0&&(G=void 0),xe.key!==void 0&&(z=""+xe.key),xe)!he.call(xe,ae)||ae==="key"||ae==="__self"||ae==="__source"||ae==="ref"&&xe.ref===void 0||(j[ae]=xe[ae]);var ae=arguments.length-2;if(ae===1)j.children=L;else if(1<ae){for(var Ae=Array(ae),_e=0;_e<ae;_e++)Ae[_e]=arguments[_e+2];j.children=Ae}return F(X.type,z,void 0,void 0,G,j)},br.createContext=function(X){return X={$$typeof:o,_currentValue:X,_currentValue2:X,_threadCount:0,Provider:null,Consumer:null},X.Provider=X,X.Consumer={$$typeof:a,_context:X},X},br.createElement=function(X,xe,L){var j,z={},G=null;if(xe!=null)for(j in xe.key!==void 0&&(G=""+xe.key),xe)he.call(xe,j)&&j!=="key"&&j!=="__self"&&j!=="__source"&&(z[j]=xe[j]);var ae=arguments.length-2;if(ae===1)z.children=L;else if(1<ae){for(var Ae=Array(ae),_e=0;_e<ae;_e++)Ae[_e]=arguments[_e+2];z.children=Ae}if(X&&X.defaultProps)for(j in ae=X.defaultProps,ae)z[j]===void 0&&(z[j]=ae[j]);return F(X,G,void 0,void 0,null,z)},br.createRef=function(){return{current:null}},br.forwardRef=function(X){return{$$typeof:c,render:X}},br.isValidElement=S,br.lazy=function(X){return{$$typeof:d,_payload:{_status:-1,_result:X},_init:de}},br.memo=function(X,xe){return{$$typeof:h,type:X,compare:xe===void 0?null:xe}},br.startTransition=function(X){var xe=ee.T,L={};ee.T=L;try{var j=X(),z=ee.S;z!==null&&z(L,j),typeof j=="object"&&j!==null&&typeof j.then=="function"&&j.then(Z,oe)}catch(G){oe(G)}finally{ee.T=xe}},br.unstable_useCacheRefresh=function(){return ee.H.useCacheRefresh()},br.use=function(X){return ee.H.use(X)},br.useActionState=function(X,xe,L){return ee.H.useActionState(X,xe,L)},br.useCallback=function(X,xe){return ee.H.useCallback(X,xe)},br.useContext=function(X){return ee.H.useContext(X)},br.useDebugValue=function(){},br.useDeferredValue=function(X,xe){return ee.H.useDeferredValue(X,xe)},br.useEffect=function(X,xe,L){var j=ee.H;if(typeof L=="function")throw Error("useEffect CRUD overload is not enabled in this build of React.");return j.useEffect(X,xe)},br.useId=function(){return ee.H.useId()},br.useImperativeHandle=function(X,xe,L){return ee.H.useImperativeHandle(X,xe,L)},br.useInsertionEffect=function(X,xe){return ee.H.useInsertionEffect(X,xe)},br.useLayoutEffect=function(X,xe){return ee.H.useLayoutEffect(X,xe)},br.useMemo=function(X,xe){return ee.H.useMemo(X,xe)},br.useOptimistic=function(X,xe){return ee.H.useOptimistic(X,xe)},br.useReducer=function(X,xe,L){return ee.H.useReducer(X,xe,L)},br.useRef=function(X){return ee.H.useRef(X)},br.useState=function(X){return ee.H.useState(X)},br.useSyncExternalStore=function(X,xe,L){return ee.H.useSyncExternalStore(X,xe,L)},br.useTransition=function(){return ee.H.useTransition()},br.version="19.1.0",br}var c4;function yx(){return c4||(c4=1,Rv.exports=nN()),Rv.exports}var lt=yx();const Lb=xx(lt),iN=eN({__proto__:null,default:Lb},[lt]);var Lv={exports:{}},Jd={},Dv={exports:{}},Fv={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var u4;function aN(){return u4||(u4=1,function(t){function e(J,de){var oe=J.length;J.push(de);e:for(;0<oe;){var Z=oe-1>>>1,X=J[Z];if(0<i(X,de))J[Z]=de,J[oe]=X,oe=Z;else break e}}function r(J){return J.length===0?null:J[0]}function n(J){if(J.length===0)return null;var de=J[0],oe=J.pop();if(oe!==de){J[0]=oe;e:for(var Z=0,X=J.length,xe=X>>>1;Z<xe;){var L=2*(Z+1)-1,j=J[L],z=L+1,G=J[z];if(0>i(j,oe))z<X&&0>i(G,j)?(J[Z]=G,J[z]=oe,Z=z):(J[Z]=j,J[L]=oe,Z=L);else if(z<X&&0>i(G,oe))J[Z]=G,J[z]=oe,Z=z;else break e}}return de}function i(J,de){var oe=J.sortIndex-de.sortIndex;return oe!==0?oe:J.id-de.id}if(t.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var a=performance;t.unstable_now=function(){return a.now()}}else{var o=Date,c=o.now();t.unstable_now=function(){return o.now()-c}}var u=[],h=[],d=1,g=null,x=3,_=!1,b=!1,E=!1,A=!1,O=typeof setTimeout=="function"?setTimeout:null,M=typeof clearTimeout=="function"?clearTimeout:null,B=typeof setImmediate<"u"?setImmediate:null;function Q(J){for(var de=r(h);de!==null;){if(de.callback===null)n(h);else if(de.startTime<=J)n(h),de.sortIndex=de.expirationTime,e(u,de);else break;de=r(h)}}function ee(J){if(E=!1,Q(J),!b)if(r(u)!==null)b=!0,he||(he=!0,C());else{var de=r(h);de!==null&&ne(ee,de.startTime-J)}}var he=!1,F=-1,k=5,S=-1;function U(){return A?!0:!(t.unstable_now()-S<k)}function I(){if(A=!1,he){var J=t.unstable_now();S=J;var de=!0;try{e:{b=!1,E&&(E=!1,M(F),F=-1),_=!0;var oe=x;try{t:{for(Q(J),g=r(u);g!==null&&!(g.expirationTime>J&&U());){var Z=g.callback;if(typeof Z=="function"){g.callback=null,x=g.priorityLevel;var X=Z(g.expirationTime<=J);if(J=t.unstable_now(),typeof X=="function"){g.callback=X,Q(J),de=!0;break t}g===r(u)&&n(u),Q(J)}else n(u);g=r(u)}if(g!==null)de=!0;else{var xe=r(h);xe!==null&&ne(ee,xe.startTime-J),de=!1}}break e}finally{g=null,x=oe,_=!1}de=void 0}}finally{de?C():he=!1}}}var C;if(typeof B=="function")C=function(){B(I)};else if(typeof MessageChannel<"u"){var R=new MessageChannel,se=R.port2;R.port1.onmessage=I,C=function(){se.postMessage(null)}}else C=function(){O(I,0)};function ne(J,de){F=O(function(){J(t.unstable_now())},de)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(J){J.callback=null},t.unstable_forceFrameRate=function(J){0>J||125<J?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):k=0<J?Math.floor(1e3/J):5},t.unstable_getCurrentPriorityLevel=function(){return x},t.unstable_next=function(J){switch(x){case 1:case 2:case 3:var de=3;break;default:de=x}var oe=x;x=de;try{return J()}finally{x=oe}},t.unstable_requestPaint=function(){A=!0},t.unstable_runWithPriority=function(J,de){switch(J){case 1:case 2:case 3:case 4:case 5:break;default:J=3}var oe=x;x=J;try{return de()}finally{x=oe}},t.unstable_scheduleCallback=function(J,de,oe){var Z=t.unstable_now();switch(typeof oe=="object"&&oe!==null?(oe=oe.delay,oe=typeof oe=="number"&&0<oe?Z+oe:Z):oe=Z,J){case 1:var X=-1;break;case 2:X=250;break;case 5:X=1073741823;break;case 4:X=1e4;break;default:X=5e3}return X=oe+X,J={id:d++,callback:de,priorityLevel:J,startTime:oe,expirationTime:X,sortIndex:-1},oe>Z?(J.sortIndex=oe,e(h,J),r(u)===null&&J===r(h)&&(E?(M(F),F=-1):E=!0,ne(ee,oe-Z))):(J.sortIndex=X,e(u,J),b||_||(b=!0,he||(he=!0,C()))),J},t.unstable_shouldYield=U,t.unstable_wrapCallback=function(J){var de=x;return function(){var oe=x;x=de;try{return J.apply(this,arguments)}finally{x=oe}}}}(Fv)),Fv}var f4;function sN(){return f4||(f4=1,Dv.exports=aN()),Dv.exports}var Ov={exports:{}},qa={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var h4;function oN(){if(h4)return qa;h4=1;var t=yx();function e(u){var h="https://react.dev/errors/"+u;if(1<arguments.length){h+="?args[]="+encodeURIComponent(arguments[1]);for(var d=2;d<arguments.length;d++)h+="&args[]="+encodeURIComponent(arguments[d])}return"Minified React error #"+u+"; visit "+h+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function r(){}var n={d:{f:r,r:function(){throw Error(e(522))},D:r,C:r,L:r,m:r,X:r,S:r,M:r},p:0,findDOMNode:null},i=Symbol.for("react.portal");function a(u,h,d){var g=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:i,key:g==null?null:""+g,children:u,containerInfo:h,implementation:d}}var o=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function c(u,h){if(u==="font")return"";if(typeof h=="string")return h==="use-credentials"?h:""}return qa.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=n,qa.createPortal=function(u,h){var d=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!h||h.nodeType!==1&&h.nodeType!==9&&h.nodeType!==11)throw Error(e(299));return a(u,h,null,d)},qa.flushSync=function(u){var h=o.T,d=n.p;try{if(o.T=null,n.p=2,u)return u()}finally{o.T=h,n.p=d,n.d.f()}},qa.preconnect=function(u,h){typeof u=="string"&&(h?(h=h.crossOrigin,h=typeof h=="string"?h==="use-credentials"?h:"":void 0):h=null,n.d.C(u,h))},qa.prefetchDNS=function(u){typeof u=="string"&&n.d.D(u)},qa.preinit=function(u,h){if(typeof u=="string"&&h&&typeof h.as=="string"){var d=h.as,g=c(d,h.crossOrigin),x=typeof h.integrity=="string"?h.integrity:void 0,_=typeof h.fetchPriority=="string"?h.fetchPriority:void 0;d==="style"?n.d.S(u,typeof h.precedence=="string"?h.precedence:void 0,{crossOrigin:g,integrity:x,fetchPriority:_}):d==="script"&&n.d.X(u,{crossOrigin:g,integrity:x,fetchPriority:_,nonce:typeof h.nonce=="string"?h.nonce:void 0})}},qa.preinitModule=function(u,h){if(typeof u=="string")if(typeof h=="object"&&h!==null){if(h.as==null||h.as==="script"){var d=c(h.as,h.crossOrigin);n.d.M(u,{crossOrigin:d,integrity:typeof h.integrity=="string"?h.integrity:void 0,nonce:typeof h.nonce=="string"?h.nonce:void 0})}}else h==null&&n.d.M(u)},qa.preload=function(u,h){if(typeof u=="string"&&typeof h=="object"&&h!==null&&typeof h.as=="string"){var d=h.as,g=c(d,h.crossOrigin);n.d.L(u,d,{crossOrigin:g,integrity:typeof h.integrity=="string"?h.integrity:void 0,nonce:typeof h.nonce=="string"?h.nonce:void 0,type:typeof h.type=="string"?h.type:void 0,fetchPriority:typeof h.fetchPriority=="string"?h.fetchPriority:void 0,referrerPolicy:typeof h.referrerPolicy=="string"?h.referrerPolicy:void 0,imageSrcSet:typeof h.imageSrcSet=="string"?h.imageSrcSet:void 0,imageSizes:typeof h.imageSizes=="string"?h.imageSizes:void 0,media:typeof h.media=="string"?h.media:void 0})}},qa.preloadModule=function(u,h){if(typeof u=="string")if(h){var d=c(h.as,h.crossOrigin);n.d.m(u,{as:typeof h.as=="string"&&h.as!=="script"?h.as:void 0,crossOrigin:d,integrity:typeof h.integrity=="string"?h.integrity:void 0})}else n.d.m(u)},qa.requestFormReset=function(u){n.d.r(u)},qa.unstable_batchedUpdates=function(u,h){return u(h)},qa.useFormState=function(u,h,d){return o.H.useFormState(u,h,d)},qa.useFormStatus=function(){return o.H.useHostTransitionStatus()},qa.version="19.1.0",qa}var d4;function Db(){if(d4)return Ov.exports;d4=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}return t(),Ov.exports=oN(),Ov.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var p4;function lN(){if(p4)return Jd;p4=1;var t=sN(),e=yx(),r=Db();function n(s){var l="https://react.dev/errors/"+s;if(1<arguments.length){l+="?args[]="+encodeURIComponent(arguments[1]);for(var f=2;f<arguments.length;f++)l+="&args[]="+encodeURIComponent(arguments[f])}return"Minified React error #"+s+"; visit "+l+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function i(s){return!(!s||s.nodeType!==1&&s.nodeType!==9&&s.nodeType!==11)}function a(s){var l=s,f=s;if(s.alternate)for(;l.return;)l=l.return;else{s=l;do l=s,(l.flags&4098)!==0&&(f=l.return),s=l.return;while(s)}return l.tag===3?f:null}function o(s){if(s.tag===13){var l=s.memoizedState;if(l===null&&(s=s.alternate,s!==null&&(l=s.memoizedState)),l!==null)return l.dehydrated}return null}function c(s){if(a(s)!==s)throw Error(n(188))}function u(s){var l=s.alternate;if(!l){if(l=a(s),l===null)throw Error(n(188));return l!==s?null:s}for(var f=s,p=l;;){var y=f.return;if(y===null)break;var T=y.alternate;if(T===null){if(p=y.return,p!==null){f=p;continue}break}if(y.child===T.child){for(T=y.child;T;){if(T===f)return c(y),s;if(T===p)return c(y),l;T=T.sibling}throw Error(n(188))}if(f.return!==p.return)f=y,p=T;else{for(var W=!1,ue=y.child;ue;){if(ue===f){W=!0,f=y,p=T;break}if(ue===p){W=!0,p=y,f=T;break}ue=ue.sibling}if(!W){for(ue=T.child;ue;){if(ue===f){W=!0,f=T,p=y;break}if(ue===p){W=!0,p=T,f=y;break}ue=ue.sibling}if(!W)throw Error(n(189))}}if(f.alternate!==p)throw Error(n(190))}if(f.tag!==3)throw Error(n(188));return f.stateNode.current===f?s:l}function h(s){var l=s.tag;if(l===5||l===26||l===27||l===6)return s;for(s=s.child;s!==null;){if(l=h(s),l!==null)return l;s=s.sibling}return null}var d=Object.assign,g=Symbol.for("react.element"),x=Symbol.for("react.transitional.element"),_=Symbol.for("react.portal"),b=Symbol.for("react.fragment"),E=Symbol.for("react.strict_mode"),A=Symbol.for("react.profiler"),O=Symbol.for("react.provider"),M=Symbol.for("react.consumer"),B=Symbol.for("react.context"),Q=Symbol.for("react.forward_ref"),ee=Symbol.for("react.suspense"),he=Symbol.for("react.suspense_list"),F=Symbol.for("react.memo"),k=Symbol.for("react.lazy"),S=Symbol.for("react.activity"),U=Symbol.for("react.memo_cache_sentinel"),I=Symbol.iterator;function C(s){return s===null||typeof s!="object"?null:(s=I&&s[I]||s["@@iterator"],typeof s=="function"?s:null)}var R=Symbol.for("react.client.reference");function se(s){if(s==null)return null;if(typeof s=="function")return s.$$typeof===R?null:s.displayName||s.name||null;if(typeof s=="string")return s;switch(s){case b:return"Fragment";case A:return"Profiler";case E:return"StrictMode";case ee:return"Suspense";case he:return"SuspenseList";case S:return"Activity"}if(typeof s=="object")switch(s.$$typeof){case _:return"Portal";case B:return(s.displayName||"Context")+".Provider";case M:return(s._context.displayName||"Context")+".Consumer";case Q:var l=s.render;return s=s.displayName,s||(s=l.displayName||l.name||"",s=s!==""?"ForwardRef("+s+")":"ForwardRef"),s;case F:return l=s.displayName||null,l!==null?l:se(s.type)||"Memo";case k:l=s._payload,s=s._init;try{return se(s(l))}catch{}}return null}var ne=Array.isArray,J=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,de=r.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,oe={pending:!1,data:null,method:null,action:null},Z=[],X=-1;function xe(s){return{current:s}}function L(s){0>X||(s.current=Z[X],Z[X]=null,X--)}function j(s,l){X++,Z[X]=s.current,s.current=l}var z=xe(null),G=xe(null),ae=xe(null),Ae=xe(null);function _e(s,l){switch(j(ae,l),j(G,s),j(z,null),l.nodeType){case 9:case 11:s=(s=l.documentElement)&&(s=s.namespaceURI)?Fw(s):0;break;default:if(s=l.tagName,l=l.namespaceURI)l=Fw(l),s=Ow(l,s);else switch(s){case"svg":s=1;break;case"math":s=2;break;default:s=0}}L(z),j(z,s)}function Ee(){L(z),L(G),L(ae)}function Ce(s){s.memoizedState!==null&&j(Ae,s);var l=z.current,f=Ow(l,s.type);l!==f&&(j(G,s),j(z,f))}function Oe(s){G.current===s&&(L(z),L(G)),Ae.current===s&&(L(Ae),Wd._currentValue=oe)}var fe=Object.prototype.hasOwnProperty,rt=t.unstable_scheduleCallback,ot=t.unstable_cancelCallback,Pe=t.unstable_shouldYield,ge=t.unstable_requestPaint,Je=t.unstable_now,nt=t.unstable_getCurrentPriorityLevel,et=t.unstable_ImmediatePriority,vt=t.unstable_UserBlockingPriority,Et=t.unstable_NormalPriority,bt=t.unstable_LowPriority,Mt=t.unstable_IdlePriority,Dt=t.log,qt=t.unstable_setDisableYieldValue,Tt=null,kt=null;function zt(s){if(typeof Dt=="function"&&qt(s),kt&&typeof kt.setStrictMode=="function")try{kt.setStrictMode(Tt,s)}catch{}}var Pt=Math.clz32?Math.clz32:or,Nt=Math.log,_t=Math.LN2;function or(s){return s>>>=0,s===0?32:31-(Nt(s)/_t|0)|0}var Gt=256,zr=4194304;function yr(s){var l=s&42;if(l!==0)return l;switch(s&-s){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return s&4194048;case 4194304:case 8388608:case 16777216:case 33554432:return s&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return s}}function Qr(s,l,f){var p=s.pendingLanes;if(p===0)return 0;var y=0,T=s.suspendedLanes,W=s.pingedLanes;s=s.warmLanes;var ue=p&134217727;return ue!==0?(p=ue&~T,p!==0?y=yr(p):(W&=ue,W!==0?y=yr(W):f||(f=ue&~s,f!==0&&(y=yr(f))))):(ue=p&~T,ue!==0?y=yr(ue):W!==0?y=yr(W):f||(f=p&~s,f!==0&&(y=yr(f)))),y===0?0:l!==0&&l!==y&&(l&T)===0&&(T=y&-y,f=l&-l,T>=f||T===32&&(f&4194048)!==0)?l:y}function Ii(s,l){return(s.pendingLanes&~(s.suspendedLanes&~s.pingedLanes)&l)===0}function Tr(s,l){switch(s){case 1:case 2:case 4:case 8:case 64:return l+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return l+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Ra(){var s=Gt;return Gt<<=1,(Gt&4194048)===0&&(Gt=256),s}function hn(){var s=zr;return zr<<=1,(zr&62914560)===0&&(zr=4194304),s}function Yn(s){for(var l=[],f=0;31>f;f++)l.push(s);return l}function di(s,l){s.pendingLanes|=l,l!==268435456&&(s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0)}function Jr(s,l,f,p,y,T){var W=s.pendingLanes;s.pendingLanes=f,s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0,s.expiredLanes&=f,s.entangledLanes&=f,s.errorRecoveryDisabledLanes&=f,s.shellSuspendCounter=0;var ue=s.entanglements,ke=s.expirationTimes,Xe=s.hiddenUpdates;for(f=W&~f;0<f;){var st=31-Pt(f),mt=1<<st;ue[st]=0,ke[st]=-1;var Ke=Xe[st];if(Ke!==null)for(Xe[st]=null,st=0;st<Ke.length;st++){var Qe=Ke[st];Qe!==null&&(Qe.lane&=-536870913)}f&=~mt}p!==0&&Kt(s,p,0),T!==0&&y===0&&s.tag!==0&&(s.suspendedLanes|=T&~(W&~l))}function Kt(s,l,f){s.pendingLanes|=l,s.suspendedLanes&=~l;var p=31-Pt(l);s.entangledLanes|=l,s.entanglements[p]=s.entanglements[p]|1073741824|f&4194090}function Dr(s,l){var f=s.entangledLanes|=l;for(s=s.entanglements;f;){var p=31-Pt(f),y=1<<p;y&l|s[p]&l&&(s[p]|=l),f&=~y}}function ea(s){switch(s){case 2:s=1;break;case 8:s=4;break;case 32:s=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:s=128;break;case 268435456:s=134217728;break;default:s=0}return s}function Dn(s){return s&=-s,2<s?8<s?(s&134217727)!==0?32:268435456:8:2}function pi(){var s=de.p;return s!==0?s:(s=window.event,s===void 0?32:e4(s.type))}function ga(s,l){var f=de.p;try{return de.p=s,l()}finally{de.p=f}}var jt=Math.random().toString(36).slice(2),Zr="__reactFiber$"+jt,Hr="__reactProps$"+jt,gn="__reactContainer$"+jt,In="__reactEvents$"+jt,Fn="__reactListeners$"+jt,te="__reactHandles$"+jt,be="__reactResources$"+jt,me="__reactMarker$"+jt;function ve(s){delete s[Zr],delete s[Hr],delete s[In],delete s[Fn],delete s[te]}function we(s){var l=s[Zr];if(l)return l;for(var f=s.parentNode;f;){if(l=f[gn]||f[Zr]){if(f=l.alternate,l.child!==null||f!==null&&f.child!==null)for(s=jw(s);s!==null;){if(f=s[Zr])return f;s=jw(s)}return l}s=f,f=s.parentNode}return null}function Se(s){if(s=s[Zr]||s[gn]){var l=s.tag;if(l===5||l===6||l===13||l===26||l===27||l===3)return s}return null}function Ve(s){var l=s.tag;if(l===5||l===26||l===27||l===6)return s.stateNode;throw Error(n(33))}function $e(s){var l=s[be];return l||(l=s[be]={hoistableStyles:new Map,hoistableScripts:new Map}),l}function Me(s){s[me]=!0}var He=new Set,Ye={};function pt(s,l){At(s,l),At(s+"Capture",l)}function At(s,l){for(Ye[s]=l,s=0;s<l.length;s++)He.add(l[s])}var Bt=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),St={},Rt={};function er(s){return fe.call(Rt,s)?!0:fe.call(St,s)?!1:Bt.test(s)?Rt[s]=!0:(St[s]=!0,!1)}function kr(s,l,f){if(er(l))if(f===null)s.removeAttribute(l);else{switch(typeof f){case"undefined":case"function":case"symbol":s.removeAttribute(l);return;case"boolean":var p=l.toLowerCase().slice(0,5);if(p!=="data-"&&p!=="aria-"){s.removeAttribute(l);return}}s.setAttribute(l,""+f)}}function Nr(s,l,f){if(f===null)s.removeAttribute(l);else{switch(typeof f){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(l);return}s.setAttribute(l,""+f)}}function Fr(s,l,f,p){if(p===null)s.removeAttribute(f);else{switch(typeof p){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(f);return}s.setAttributeNS(l,f,""+p)}}var Hi,ds;function Ri(s){if(Hi===void 0)try{throw Error()}catch(f){var l=f.stack.trim().match(/\n( *(at )?)/);Hi=l&&l[1]||"",ds=-1<f.stack.indexOf(`
    at`)?" (<anonymous>)":-1<f.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Hi+s+ds}var ta=!1;function va(s,l){if(!s||ta)return"";ta=!0;var f=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var p={DetermineComponentFrameRoot:function(){try{if(l){var mt=function(){throw Error()};if(Object.defineProperty(mt.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(mt,[])}catch(Qe){var Ke=Qe}Reflect.construct(s,[],mt)}else{try{mt.call()}catch(Qe){Ke=Qe}s.call(mt.prototype)}}else{try{throw Error()}catch(Qe){Ke=Qe}(mt=s())&&typeof mt.catch=="function"&&mt.catch(function(){})}}catch(Qe){if(Qe&&Ke&&typeof Qe.stack=="string")return[Qe.stack,Ke.stack]}return[null,null]}};p.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var y=Object.getOwnPropertyDescriptor(p.DetermineComponentFrameRoot,"name");y&&y.configurable&&Object.defineProperty(p.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var T=p.DetermineComponentFrameRoot(),W=T[0],ue=T[1];if(W&&ue){var ke=W.split(`
`),Xe=ue.split(`
`);for(y=p=0;p<ke.length&&!ke[p].includes("DetermineComponentFrameRoot");)p++;for(;y<Xe.length&&!Xe[y].includes("DetermineComponentFrameRoot");)y++;if(p===ke.length||y===Xe.length)for(p=ke.length-1,y=Xe.length-1;1<=p&&0<=y&&ke[p]!==Xe[y];)y--;for(;1<=p&&0<=y;p--,y--)if(ke[p]!==Xe[y]){if(p!==1||y!==1)do if(p--,y--,0>y||ke[p]!==Xe[y]){var st=`
`+ke[p].replace(" at new "," at ");return s.displayName&&st.includes("<anonymous>")&&(st=st.replace("<anonymous>",s.displayName)),st}while(1<=p&&0<=y);break}}}finally{ta=!1,Error.prepareStackTrace=f}return(f=s?s.displayName||s.name:"")?Ri(f):""}function Gi(s){switch(s.tag){case 26:case 27:case 5:return Ri(s.type);case 16:return Ri("Lazy");case 13:return Ri("Suspense");case 19:return Ri("SuspenseList");case 0:case 15:return va(s.type,!1);case 11:return va(s.type.render,!1);case 1:return va(s.type,!0);case 31:return Ri("Activity");default:return""}}function An(s){try{var l="";do l+=Gi(s),s=s.return;while(s);return l}catch(f){return`
Error generating stack: `+f.message+`
`+f.stack}}function Li(s){switch(typeof s){case"bigint":case"boolean":case"number":case"string":case"undefined":return s;case"object":return s;default:return""}}function Tl(s){var l=s.type;return(s=s.nodeName)&&s.toLowerCase()==="input"&&(l==="checkbox"||l==="radio")}function pu(s){var l=Tl(s)?"checked":"value",f=Object.getOwnPropertyDescriptor(s.constructor.prototype,l),p=""+s[l];if(!s.hasOwnProperty(l)&&typeof f<"u"&&typeof f.get=="function"&&typeof f.set=="function"){var y=f.get,T=f.set;return Object.defineProperty(s,l,{configurable:!0,get:function(){return y.call(this)},set:function(W){p=""+W,T.call(this,W)}}),Object.defineProperty(s,l,{enumerable:f.enumerable}),{getValue:function(){return p},setValue:function(W){p=""+W},stopTracking:function(){s._valueTracker=null,delete s[l]}}}}function oo(s){s._valueTracker||(s._valueTracker=pu(s))}function yc(s){if(!s)return!1;var l=s._valueTracker;if(!l)return!0;var f=l.getValue(),p="";return s&&(p=Tl(s)?s.checked?"true":"false":s.value),s=p,s!==f?(l.setValue(s),!0):!1}function Wi(s){if(s=s||(typeof document<"u"?document:void 0),typeof s>"u")return null;try{return s.activeElement||s.body}catch{return s.body}}var kl=/[\n"\\]/g;function Gr(s){return s.replace(kl,function(l){return"\\"+l.charCodeAt(0).toString(16)+" "})}function Xi(s,l,f,p,y,T,W,ue){s.name="",W!=null&&typeof W!="function"&&typeof W!="symbol"&&typeof W!="boolean"?s.type=W:s.removeAttribute("type"),l!=null?W==="number"?(l===0&&s.value===""||s.value!=l)&&(s.value=""+Li(l)):s.value!==""+Li(l)&&(s.value=""+Li(l)):W!=="submit"&&W!=="reset"||s.removeAttribute("value"),l!=null?co(s,W,Li(l)):f!=null?co(s,W,Li(f)):p!=null&&s.removeAttribute("value"),y==null&&T!=null&&(s.defaultChecked=!!T),y!=null&&(s.checked=y&&typeof y!="function"&&typeof y!="symbol"),ue!=null&&typeof ue!="function"&&typeof ue!="symbol"&&typeof ue!="boolean"?s.name=""+Li(ue):s.removeAttribute("name")}function lo(s,l,f,p,y,T,W,ue){if(T!=null&&typeof T!="function"&&typeof T!="symbol"&&typeof T!="boolean"&&(s.type=T),l!=null||f!=null){if(!(T!=="submit"&&T!=="reset"||l!=null))return;f=f!=null?""+Li(f):"",l=l!=null?""+Li(l):f,ue||l===s.value||(s.value=l),s.defaultValue=l}p=p??y,p=typeof p!="function"&&typeof p!="symbol"&&!!p,s.checked=ue?s.checked:!!p,s.defaultChecked=!!p,W!=null&&typeof W!="function"&&typeof W!="symbol"&&typeof W!="boolean"&&(s.name=W)}function co(s,l,f){l==="number"&&Wi(s.ownerDocument)===s||s.defaultValue===""+f||(s.defaultValue=""+f)}function ps(s,l,f,p){if(s=s.options,l){l={};for(var y=0;y<f.length;y++)l["$"+f[y]]=!0;for(f=0;f<s.length;f++)y=l.hasOwnProperty("$"+s[f].value),s[f].selected!==y&&(s[f].selected=y),y&&p&&(s[f].defaultSelected=!0)}else{for(f=""+Li(f),l=null,y=0;y<s.length;y++){if(s[y].value===f){s[y].selected=!0,p&&(s[y].defaultSelected=!0);return}l!==null||s[y].disabled||(l=s[y])}l!==null&&(l.selected=!0)}}function nn(s,l,f){if(l!=null&&(l=""+Li(l),l!==s.value&&(s.value=l),f==null)){s.defaultValue!==l&&(s.defaultValue=l);return}s.defaultValue=f!=null?""+Li(f):""}function uo(s,l,f,p){if(l==null){if(p!=null){if(f!=null)throw Error(n(92));if(ne(p)){if(1<p.length)throw Error(n(93));p=p[0]}f=p}f==null&&(f=""),l=f}f=Li(l),s.defaultValue=f,p=s.textContent,p===f&&p!==""&&p!==null&&(s.value=p)}function La(s,l){if(l){var f=s.firstChild;if(f&&f===s.lastChild&&f.nodeType===3){f.nodeValue=l;return}}s.textContent=l}var Os=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function mu(s,l,f){var p=l.indexOf("--")===0;f==null||typeof f=="boolean"||f===""?p?s.setProperty(l,""):l==="float"?s.cssFloat="":s[l]="":p?s.setProperty(l,f):typeof f!="number"||f===0||Os.has(l)?l==="float"?s.cssFloat=f:s[l]=(""+f).trim():s[l]=f+"px"}function wc(s,l,f){if(l!=null&&typeof l!="object")throw Error(n(62));if(s=s.style,f!=null){for(var p in f)!f.hasOwnProperty(p)||l!=null&&l.hasOwnProperty(p)||(p.indexOf("--")===0?s.setProperty(p,""):p==="float"?s.cssFloat="":s[p]="");for(var y in l)p=l[y],l.hasOwnProperty(y)&&f[y]!==p&&mu(s,y,p)}else for(var T in l)l.hasOwnProperty(T)&&mu(s,T,l[T])}function Ec(s){if(s.indexOf("-")===-1)return!1;switch(s){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Ps=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Nl=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Ms(s){return Nl.test(""+s)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":s}var ms=null;function vn(s){return s=s.target||s.srcElement||window,s.correspondingUseElement&&(s=s.correspondingUseElement),s.nodeType===3?s.parentNode:s}var Bs=null,gs=null;function tr(s){var l=Se(s);if(l&&(s=l.stateNode)){var f=s[Hr]||null;e:switch(s=l.stateNode,l.type){case"input":if(Xi(s,f.value,f.defaultValue,f.defaultValue,f.checked,f.defaultChecked,f.type,f.name),l=f.name,f.type==="radio"&&l!=null){for(f=s;f.parentNode;)f=f.parentNode;for(f=f.querySelectorAll('input[name="'+Gr(""+l)+'"][type="radio"]'),l=0;l<f.length;l++){var p=f[l];if(p!==s&&p.form===s.form){var y=p[Hr]||null;if(!y)throw Error(n(90));Xi(p,y.value,y.defaultValue,y.defaultValue,y.checked,y.defaultChecked,y.type,y.name)}}for(l=0;l<f.length;l++)p=f[l],p.form===s.form&&yc(p)}break e;case"textarea":nn(s,f.value,f.defaultValue);break e;case"select":l=f.value,l!=null&&ps(s,!!f.multiple,l,!1)}}}var vs=!1;function gu(s,l,f){if(vs)return s(l,f);vs=!0;try{var p=s(l);return p}finally{if(vs=!1,(Bs!==null||gs!==null)&&(Qp(),Bs&&(l=Bs,s=gs,gs=Bs=null,tr(l),s)))for(l=0;l<s.length;l++)tr(s[l])}}function ra(s,l){var f=s.stateNode;if(f===null)return null;var p=f[Hr]||null;if(p===null)return null;f=p[l];e:switch(l){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(p=!p.disabled)||(s=s.type,p=!(s==="button"||s==="input"||s==="select"||s==="textarea")),s=!p;break e;default:s=!1}if(s)return null;if(f&&typeof f!="function")throw Error(n(231,l,typeof f));return f}var Da=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),_a=!1;if(Da)try{var _s={};Object.defineProperty(_s,"passive",{get:function(){_a=!0}}),window.addEventListener("test",_s,_s),window.removeEventListener("test",_s,_s)}catch{_a=!1}var Fa=null,fo=null,js=null;function bc(){if(js)return js;var s,l=fo,f=l.length,p,y="value"in Fa?Fa.value:Fa.textContent,T=y.length;for(s=0;s<f&&l[s]===y[s];s++);var W=f-s;for(p=1;p<=W&&l[f-p]===y[T-p];p++);return js=y.slice(s,1<p?1-p:void 0)}function Oa(s){var l=s.keyCode;return"charCode"in s?(s=s.charCode,s===0&&l===13&&(s=13)):s=l,s===10&&(s=13),32<=s||s===13?s:0}function na(){return!0}function xs(){return!1}function ni(s){function l(f,p,y,T,W){this._reactName=f,this._targetInst=y,this.type=p,this.nativeEvent=T,this.target=W,this.currentTarget=null;for(var ue in s)s.hasOwnProperty(ue)&&(f=s[ue],this[ue]=f?f(T):T[ue]);return this.isDefaultPrevented=(T.defaultPrevented!=null?T.defaultPrevented:T.returnValue===!1)?na:xs,this.isPropagationStopped=xs,this}return d(l.prototype,{preventDefault:function(){this.defaultPrevented=!0;var f=this.nativeEvent;f&&(f.preventDefault?f.preventDefault():typeof f.returnValue!="unknown"&&(f.returnValue=!1),this.isDefaultPrevented=na)},stopPropagation:function(){var f=this.nativeEvent;f&&(f.stopPropagation?f.stopPropagation():typeof f.cancelBubble!="unknown"&&(f.cancelBubble=!0),this.isPropagationStopped=na)},persist:function(){},isPersistent:na}),l}var Or={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(s){return s.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},ho=ni(Or),ys=d({},Or,{view:0,detail:0}),Sc=ni(ys),zo,Ho,ss,ia=d({},ys,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:vo,button:0,buttons:0,relatedTarget:function(s){return s.relatedTarget===void 0?s.fromElement===s.srcElement?s.toElement:s.fromElement:s.relatedTarget},movementX:function(s){return"movementX"in s?s.movementX:(s!==ss&&(ss&&s.type==="mousemove"?(zo=s.screenX-ss.screenX,Ho=s.screenY-ss.screenY):Ho=zo=0,ss=s),zo)},movementY:function(s){return"movementY"in s?s.movementY:Ho}}),ii=ni(ia),vu=d({},ia,{dataTransfer:0}),po=ni(vu),Yi=d({},ys,{relatedTarget:0}),mo=ni(Yi),Us=d({},Or,{animationName:0,elapsedTime:0,pseudoElement:0}),Cl=ni(Us),Go=d({},Or,{clipboardData:function(s){return"clipboardData"in s?s.clipboardData:window.clipboardData}}),Il=ni(Go),Ac=d({},Or,{data:0}),Wo=ni(Ac),go={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Xo={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Rl={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Yo(s){var l=this.nativeEvent;return l.getModifierState?l.getModifierState(s):(s=Rl[s])?!!l[s]:!1}function vo(){return Yo}var _u=d({},ys,{key:function(s){if(s.key){var l=go[s.key]||s.key;if(l!=="Unidentified")return l}return s.type==="keypress"?(s=Oa(s),s===13?"Enter":String.fromCharCode(s)):s.type==="keydown"||s.type==="keyup"?Xo[s.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:vo,charCode:function(s){return s.type==="keypress"?Oa(s):0},keyCode:function(s){return s.type==="keydown"||s.type==="keyup"?s.keyCode:0},which:function(s){return s.type==="keypress"?Oa(s):s.type==="keydown"||s.type==="keyup"?s.keyCode:0}}),Vs=ni(_u),_o=d({},ia,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Ko=ni(_o),aa=d({},ys,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:vo}),Ll=ni(aa),N=d({},Or,{propertyName:0,elapsedTime:0,pseudoElement:0}),K=ni(N),Te=d({},ia,{deltaX:function(s){return"deltaX"in s?s.deltaX:"wheelDeltaX"in s?-s.wheelDeltaX:0},deltaY:function(s){return"deltaY"in s?s.deltaY:"wheelDeltaY"in s?-s.wheelDeltaY:"wheelDelta"in s?-s.wheelDelta:0},deltaZ:0,deltaMode:0}),Ne=ni(Te),Be=d({},Or,{newState:0,oldState:0}),tt=ni(Be),yt=[9,13,27,32],Ft=Da&&"CompositionEvent"in window,v=null;Da&&"documentMode"in document&&(v=document.documentMode);var P=Da&&"TextEvent"in window&&!v,q=Da&&(!Ft||v&&8<v&&11>=v),ce=" ",Fe=!1;function We(s,l){switch(s){case"keyup":return yt.indexOf(l.keyCode)!==-1;case"keydown":return l.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function wt(s){return s=s.detail,typeof s=="object"&&"data"in s?s.data:null}var rr=!1;function Pr(s,l){switch(s){case"compositionend":return wt(l);case"keypress":return l.which!==32?null:(Fe=!0,ce);case"textInput":return s=l.data,s===ce&&Fe?null:s;default:return null}}function mr(s,l){if(rr)return s==="compositionend"||!Ft&&We(s,l)?(s=bc(),js=fo=Fa=null,rr=!1,s):null;switch(s){case"paste":return null;case"keypress":if(!(l.ctrlKey||l.altKey||l.metaKey)||l.ctrlKey&&l.altKey){if(l.char&&1<l.char.length)return l.char;if(l.which)return String.fromCharCode(l.which)}return null;case"compositionend":return q&&l.locale!=="ko"?null:l.data;default:return null}}var an={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function dn(s){var l=s&&s.nodeName&&s.nodeName.toLowerCase();return l==="input"?!!an[s.type]:l==="textarea"}function ws(s,l,f,p){Bs?gs?gs.push(p):gs=[p]:Bs=p,l=nm(l,"onChange"),0<l.length&&(f=new ho("onChange","change",null,f,p),s.push({event:f,listeners:l}))}var Kn=null,Pa=null;function xo(s){Cw(s,0)}function Dl(s){var l=Ve(s);if(yc(l))return s}function xu(s,l){if(s==="change")return l}var Tc=!1;if(Da){var mi;if(Da){var Fl="oninput"in document;if(!Fl){var kc=document.createElement("div");kc.setAttribute("oninput","return;"),Fl=typeof kc.oninput=="function"}mi=Fl}else mi=!1;Tc=mi&&(!document.documentMode||9<document.documentMode)}function Nc(){Kn&&(Kn.detachEvent("onpropertychange",yu),Pa=Kn=null)}function yu(s){if(s.propertyName==="value"&&Dl(Pa)){var l=[];ws(l,Pa,s,vn(s)),gu(xo,l)}}function Ma(s,l,f){s==="focusin"?(Nc(),Kn=l,Pa=f,Kn.attachEvent("onpropertychange",yu)):s==="focusout"&&Nc()}function dd(s){if(s==="selectionchange"||s==="keyup"||s==="keydown")return Dl(Pa)}function Pf(s,l){if(s==="click")return Dl(l)}function qh(s,l){if(s==="input"||s==="change")return Dl(l)}function Es(s,l){return s===l&&(s!==0||1/s===1/l)||s!==s&&l!==l}var Di=typeof Object.is=="function"?Object.is:Es;function Ol(s,l){if(Di(s,l))return!0;if(typeof s!="object"||s===null||typeof l!="object"||l===null)return!1;var f=Object.keys(s),p=Object.keys(l);if(f.length!==p.length)return!1;for(p=0;p<f.length;p++){var y=f[p];if(!fe.call(l,y)||!Di(s[y],l[y]))return!1}return!0}function Mf(s){for(;s&&s.firstChild;)s=s.firstChild;return s}function $o(s,l){var f=Mf(s);s=0;for(var p;f;){if(f.nodeType===3){if(p=s+f.textContent.length,s<=l&&p>=l)return{node:f,offset:l-s};s=p}e:{for(;f;){if(f.nextSibling){f=f.nextSibling;break e}f=f.parentNode}f=void 0}f=Mf(f)}}function Pl(s,l){return s&&l?s===l?!0:s&&s.nodeType===3?!1:l&&l.nodeType===3?Pl(s,l.parentNode):"contains"in s?s.contains(l):s.compareDocumentPosition?!!(s.compareDocumentPosition(l)&16):!1:!1}function xa(s){s=s!=null&&s.ownerDocument!=null&&s.ownerDocument.defaultView!=null?s.ownerDocument.defaultView:window;for(var l=Wi(s.document);l instanceof s.HTMLIFrameElement;){try{var f=typeof l.contentWindow.location.href=="string"}catch{f=!1}if(f)s=l.contentWindow;else break;l=Wi(s.document)}return l}function Ki(s){var l=s&&s.nodeName&&s.nodeName.toLowerCase();return l&&(l==="input"&&(s.type==="text"||s.type==="search"||s.type==="tel"||s.type==="url"||s.type==="password")||l==="textarea"||s.contentEditable==="true")}var Ml=Da&&"documentMode"in document&&11>=document.documentMode,Ba=null,qs=null,yo=null,zs=!1;function Hn(s,l,f){var p=f.window===f?f.document:f.nodeType===9?f:f.ownerDocument;zs||Ba==null||Ba!==Wi(p)||(p=Ba,"selectionStart"in p&&Ki(p)?p={start:p.selectionStart,end:p.selectionEnd}:(p=(p.ownerDocument&&p.ownerDocument.defaultView||window).getSelection(),p={anchorNode:p.anchorNode,anchorOffset:p.anchorOffset,focusNode:p.focusNode,focusOffset:p.focusOffset}),yo&&Ol(yo,p)||(yo=p,p=nm(qs,"onSelect"),0<p.length&&(l=new ho("onSelect","select",null,l,f),s.push({event:l,listeners:p}),l.target=Ba)))}function Hs(s,l){var f={};return f[s.toLowerCase()]=l.toLowerCase(),f["Webkit"+s]="webkit"+l,f["Moz"+s]="moz"+l,f}var ai={animationend:Hs("Animation","AnimationEnd"),animationiteration:Hs("Animation","AnimationIteration"),animationstart:Hs("Animation","AnimationStart"),transitionrun:Hs("Transition","TransitionRun"),transitionstart:Hs("Transition","TransitionStart"),transitioncancel:Hs("Transition","TransitionCancel"),transitionend:Hs("Transition","TransitionEnd")},ja={},Cc={};Da&&(Cc=document.createElement("div").style,"AnimationEvent"in window||(delete ai.animationend.animation,delete ai.animationiteration.animation,delete ai.animationstart.animation),"TransitionEvent"in window||delete ai.transitionend.transition);function wo(s){if(ja[s])return ja[s];if(!ai[s])return s;var l=ai[s],f;for(f in l)if(l.hasOwnProperty(f)&&f in Cc)return ja[s]=l[f];return s}var wu=wo("animationend"),Bl=wo("animationiteration"),jl=wo("animationstart"),Ul=wo("transitionrun"),Ic=wo("transitionstart"),Eu=wo("transitioncancel"),Vl=wo("transitionend"),Qo=new Map,Rc="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Rc.push("scrollEnd");function Gn(s,l){Qo.set(s,l),pt(l,[s])}var os=new WeakMap;function Cr(s,l){if(typeof s=="object"&&s!==null){var f=os.get(s);return f!==void 0?f:(l={value:s,source:l,stack:An(l)},os.set(s,l),l)}return{value:s,source:l,stack:An(l)}}var Ir=[],Tn=0,$n=0;function bs(){for(var s=Tn,l=$n=Tn=0;l<s;){var f=Ir[l];Ir[l++]=null;var p=Ir[l];Ir[l++]=null;var y=Ir[l];Ir[l++]=null;var T=Ir[l];if(Ir[l++]=null,p!==null&&y!==null){var W=p.pending;W===null?y.next=y:(y.next=W.next,W.next=y),p.pending=y}T!==0&&zh(f,y,T)}}function ql(s,l,f,p){Ir[Tn++]=s,Ir[Tn++]=l,Ir[Tn++]=f,Ir[Tn++]=p,$n|=p,s.lanes|=p,s=s.alternate,s!==null&&(s.lanes|=p)}function zl(s,l,f,p){return ql(s,l,f,p),Lc(s)}function Jo(s,l){return ql(s,null,null,l),Lc(s)}function zh(s,l,f){s.lanes|=f;var p=s.alternate;p!==null&&(p.lanes|=f);for(var y=!1,T=s.return;T!==null;)T.childLanes|=f,p=T.alternate,p!==null&&(p.childLanes|=f),T.tag===22&&(s=T.stateNode,s===null||s._visibility&1||(y=!0)),s=T,T=T.return;return s.tag===3?(T=s.stateNode,y&&l!==null&&(y=31-Pt(f),s=T.hiddenUpdates,p=s[y],p===null?s[y]=[l]:p.push(l),l.lane=f|536870912),T):null}function Lc(s){if(50<Bd)throw Bd=0,ev=null,Error(n(185));for(var l=s.return;l!==null;)s=l,l=s.return;return s.tag===3?s.stateNode:null}var Fi={};function Ss(s,l,f,p){this.tag=s,this.key=f,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=l,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=p,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function sa(s,l,f,p){return new Ss(s,l,f,p)}function bu(s){return s=s.prototype,!(!s||!s.isReactComponent)}function Eo(s,l){var f=s.alternate;return f===null?(f=sa(s.tag,l,s.key,s.mode),f.elementType=s.elementType,f.type=s.type,f.stateNode=s.stateNode,f.alternate=s,s.alternate=f):(f.pendingProps=l,f.type=s.type,f.flags=0,f.subtreeFlags=0,f.deletions=null),f.flags=s.flags&65011712,f.childLanes=s.childLanes,f.lanes=s.lanes,f.child=s.child,f.memoizedProps=s.memoizedProps,f.memoizedState=s.memoizedState,f.updateQueue=s.updateQueue,l=s.dependencies,f.dependencies=l===null?null:{lanes:l.lanes,firstContext:l.firstContext},f.sibling=s.sibling,f.index=s.index,f.ref=s.ref,f.refCleanup=s.refCleanup,f}function Bf(s,l){s.flags&=65011714;var f=s.alternate;return f===null?(s.childLanes=0,s.lanes=l,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=f.childLanes,s.lanes=f.lanes,s.child=f.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=f.memoizedProps,s.memoizedState=f.memoizedState,s.updateQueue=f.updateQueue,s.type=f.type,l=f.dependencies,s.dependencies=l===null?null:{lanes:l.lanes,firstContext:l.firstContext}),s}function Dc(s,l,f,p,y,T){var W=0;if(p=s,typeof s=="function")bu(s)&&(W=1);else if(typeof s=="string")W=V8(s,f,z.current)?26:s==="html"||s==="head"||s==="body"?27:5;else e:switch(s){case S:return s=sa(31,f,l,y),s.elementType=S,s.lanes=T,s;case b:return Zo(f.children,y,T,l);case E:W=8,y|=24;break;case A:return s=sa(12,f,l,y|2),s.elementType=A,s.lanes=T,s;case ee:return s=sa(13,f,l,y),s.elementType=ee,s.lanes=T,s;case he:return s=sa(19,f,l,y),s.elementType=he,s.lanes=T,s;default:if(typeof s=="object"&&s!==null)switch(s.$$typeof){case O:case B:W=10;break e;case M:W=9;break e;case Q:W=11;break e;case F:W=14;break e;case k:W=16,p=null;break e}W=29,f=Error(n(130,s===null?"null":typeof s,"")),p=null}return l=sa(W,f,l,y),l.elementType=s,l.type=p,l.lanes=T,l}function Zo(s,l,f,p){return s=sa(7,s,p,l),s.lanes=f,s}function Hh(s,l,f){return s=sa(6,s,null,l),s.lanes=f,s}function jf(s,l,f){return l=sa(4,s.children!==null?s.children:[],s.key,l),l.lanes=f,l.stateNode={containerInfo:s.containerInfo,pendingChildren:null,implementation:s.implementation},l}var Hl=[],el=0,Su=null,Gh=0,As=[],ls=0,Fc=null,tl=1,rl="";function Oc(s,l){Hl[el++]=Gh,Hl[el++]=Su,Su=s,Gh=l}function wp(s,l,f){As[ls++]=tl,As[ls++]=rl,As[ls++]=Fc,Fc=s;var p=tl;s=rl;var y=32-Pt(p)-1;p&=~(1<<y),f+=1;var T=32-Pt(l)+y;if(30<T){var W=y-y%5;T=(p&(1<<W)-1).toString(32),p>>=W,y-=W,tl=1<<32-Pt(l)+y|f<<y|p,rl=T+s}else tl=1<<T|f<<y|p,rl=s}function Uf(s){s.return!==null&&(Oc(s,1),wp(s,1,0))}function Vf(s){for(;s===Su;)Su=Hl[--el],Hl[el]=null,Gh=Hl[--el],Hl[el]=null;for(;s===Fc;)Fc=As[--ls],As[ls]=null,rl=As[--ls],As[ls]=null,tl=As[--ls],As[ls]=null}var gi=null,Wn=null,en=!1,Gl=null,bo=!1,pd=Error(n(519));function Pc(s){var l=Error(n(418,""));throw Au(Cr(l,s)),pd}function Ep(s){var l=s.stateNode,f=s.type,p=s.memoizedProps;switch(l[Zr]=s,l[Hr]=p,f){case"dialog":Ur("cancel",l),Ur("close",l);break;case"iframe":case"object":case"embed":Ur("load",l);break;case"video":case"audio":for(f=0;f<Ud.length;f++)Ur(Ud[f],l);break;case"source":Ur("error",l);break;case"img":case"image":case"link":Ur("error",l),Ur("load",l);break;case"details":Ur("toggle",l);break;case"input":Ur("invalid",l),lo(l,p.value,p.defaultValue,p.checked,p.defaultChecked,p.type,p.name,!0),oo(l);break;case"select":Ur("invalid",l);break;case"textarea":Ur("invalid",l),uo(l,p.value,p.defaultValue,p.children),oo(l)}f=p.children,typeof f!="string"&&typeof f!="number"&&typeof f!="bigint"||l.textContent===""+f||p.suppressHydrationWarning===!0||Dw(l.textContent,f)?(p.popover!=null&&(Ur("beforetoggle",l),Ur("toggle",l)),p.onScroll!=null&&Ur("scroll",l),p.onScrollEnd!=null&&Ur("scrollend",l),p.onClick!=null&&(l.onclick=im),l=!0):l=!1,l||Pc(s)}function nl(s){for(gi=s.return;gi;)switch(gi.tag){case 5:case 13:bo=!1;return;case 27:case 3:bo=!0;return;default:gi=gi.return}}function ya(s){if(s!==gi)return!1;if(!en)return nl(s),en=!0,!1;var l=s.tag,f;if((f=l!==3&&l!==27)&&((f=l===5)&&(f=s.type,f=!(f!=="form"&&f!=="button")||gv(s.type,s.memoizedProps)),f=!f),f&&Wn&&Pc(s),nl(s),l===13){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(n(317));e:{for(s=s.nextSibling,l=0;s;){if(s.nodeType===8)if(f=s.data,f==="/$"){if(l===0){Wn=fl(s.nextSibling);break e}l--}else f!=="$"&&f!=="$!"&&f!=="$?"||l++;s=s.nextSibling}Wn=null}}else l===27?(l=Wn,qu(s.type)?(s=yv,yv=null,Wn=s):Wn=l):Wn=gi?fl(s.stateNode.nextSibling):null;return!0}function cs(){Wn=gi=null,en=!1}function bp(){var s=Gl;return s!==null&&(Ns===null?Ns=s:Ns.push.apply(Ns,s),Gl=null),s}function Au(s){Gl===null?Gl=[s]:Gl.push(s)}var So=xe(null),Oi=null,il=null;function Wl(s,l,f){j(So,l._currentValue),l._currentValue=f}function Ao(s){s._currentValue=So.current,L(So)}function Wh(s,l,f){for(;s!==null;){var p=s.alternate;if((s.childLanes&l)!==l?(s.childLanes|=l,p!==null&&(p.childLanes|=l)):p!==null&&(p.childLanes&l)!==l&&(p.childLanes|=l),s===f)break;s=s.return}}function Xh(s,l,f,p){var y=s.child;for(y!==null&&(y.return=s);y!==null;){var T=y.dependencies;if(T!==null){var W=y.child;T=T.firstContext;e:for(;T!==null;){var ue=T;T=y;for(var ke=0;ke<l.length;ke++)if(ue.context===l[ke]){T.lanes|=f,ue=T.alternate,ue!==null&&(ue.lanes|=f),Wh(T.return,f,s),p||(W=null);break e}T=ue.next}}else if(y.tag===18){if(W=y.return,W===null)throw Error(n(341));W.lanes|=f,T=W.alternate,T!==null&&(T.lanes|=f),Wh(W,f,s),W=null}else W=y.child;if(W!==null)W.return=y;else for(W=y;W!==null;){if(W===s){W=null;break}if(y=W.sibling,y!==null){y.return=W.return,W=y;break}W=W.return}y=W}}function Tu(s,l,f,p){s=null;for(var y=l,T=!1;y!==null;){if(!T){if((y.flags&524288)!==0)T=!0;else if((y.flags&262144)!==0)break}if(y.tag===10){var W=y.alternate;if(W===null)throw Error(n(387));if(W=W.memoizedProps,W!==null){var ue=y.type;Di(y.pendingProps.value,W.value)||(s!==null?s.push(ue):s=[ue])}}else if(y===Ae.current){if(W=y.alternate,W===null)throw Error(n(387));W.memoizedState.memoizedState!==y.memoizedState.memoizedState&&(s!==null?s.push(Wd):s=[Wd])}y=y.return}s!==null&&Xh(l,s,f,p),l.flags|=262144}function Yh(s){for(s=s.firstContext;s!==null;){if(!Di(s.context._currentValue,s.memoizedValue))return!0;s=s.next}return!1}function To(s){Oi=s,il=null,s=s.dependencies,s!==null&&(s.firstContext=null)}function vi(s){return Kh(Oi,s)}function Xl(s,l){return Oi===null&&To(s),Kh(s,l)}function Kh(s,l){var f=l._currentValue;if(l={context:l,memoizedValue:f,next:null},il===null){if(s===null)throw Error(n(308));il=l,s.dependencies={lanes:0,firstContext:l},s.flags|=524288}else il=il.next=l;return f}var A2=typeof AbortController<"u"?AbortController:function(){var s=[],l=this.signal={aborted:!1,addEventListener:function(f,p){s.push(p)}};this.abort=function(){l.aborted=!0,s.forEach(function(f){return f()})}},Sp=t.unstable_scheduleCallback,T2=t.unstable_NormalPriority,_i={$$typeof:B,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function md(){return{controller:new A2,data:new Map,refCount:0}}function qf(s){s.refCount--,s.refCount===0&&Sp(T2,function(){s.controller.abort()})}var zf=null,gd=0,Mc=0,al=null;function k2(s,l){if(zf===null){var f=zf=[];gd=0,Mc=ov(),al={status:"pending",value:void 0,then:function(p){f.push(p)}}}return gd++,l.then(Ap,Ap),l}function Ap(){if(--gd===0&&zf!==null){al!==null&&(al.status="fulfilled");var s=zf;zf=null,Mc=0,al=null;for(var l=0;l<s.length;l++)(0,s[l])()}}function Tp(s,l){var f=[],p={status:"pending",value:null,reason:null,then:function(y){f.push(y)}};return s.then(function(){p.status="fulfilled",p.value=l;for(var y=0;y<f.length;y++)(0,f[y])(l)},function(y){for(p.status="rejected",p.reason=y,y=0;y<f.length;y++)(0,f[y])(void 0)}),p}var m=J.S;J.S=function(s,l){typeof l=="object"&&l!==null&&typeof l.then=="function"&&k2(s,l),m!==null&&m(s,l)};var w=xe(null);function D(){var s=w.current;return s!==null?s:Pn.pooledCache}function V(s,l){l===null?j(w,w.current):j(w,l.pool)}function Y(){var s=D();return s===null?null:{parent:_i._currentValue,pool:s}}var re=Error(n(460)),ie=Error(n(474)),le=Error(n(542)),pe={then:function(){}};function ye(s){return s=s.status,s==="fulfilled"||s==="rejected"}function Ie(){}function Ge(s,l,f){switch(f=s[f],f===void 0?s.push(l):f!==l&&(l.then(Ie,Ie),l=f),l.status){case"fulfilled":return l.value;case"rejected":throw s=l.reason,ft(s),s;default:if(typeof l.status=="string")l.then(Ie,Ie);else{if(s=Pn,s!==null&&100<s.shellSuspendCounter)throw Error(n(482));s=l,s.status="pending",s.then(function(p){if(l.status==="pending"){var y=l;y.status="fulfilled",y.value=p}},function(p){if(l.status==="pending"){var y=l;y.status="rejected",y.reason=p}})}switch(l.status){case"fulfilled":return l.value;case"rejected":throw s=l.reason,ft(s),s}throw qe=l,re}}var qe=null;function je(){if(qe===null)throw Error(n(459));var s=qe;return qe=null,s}function ft(s){if(s===re||s===le)throw Error(n(483))}var Ze=!1;function Re(s){s.updateQueue={baseState:s.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function De(s,l){s=s.updateQueue,l.updateQueue===s&&(l.updateQueue={baseState:s.baseState,firstBaseUpdate:s.firstBaseUpdate,lastBaseUpdate:s.lastBaseUpdate,shared:s.shared,callbacks:null})}function at(s){return{lane:s,tag:0,payload:null,callback:null,next:null}}function ht(s,l,f){var p=s.updateQueue;if(p===null)return null;if(p=p.shared,(xn&2)!==0){var y=p.pending;return y===null?l.next=l:(l.next=y.next,y.next=l),p.pending=l,l=Lc(s),zh(s,null,f),l}return ql(s,p,l,f),Lc(s)}function ct(s,l,f){if(l=l.updateQueue,l!==null&&(l=l.shared,(f&4194048)!==0)){var p=l.lanes;p&=s.pendingLanes,f|=p,l.lanes=f,Dr(s,f)}}function Ut(s,l){var f=s.updateQueue,p=s.alternate;if(p!==null&&(p=p.updateQueue,f===p)){var y=null,T=null;if(f=f.firstBaseUpdate,f!==null){do{var W={lane:f.lane,tag:f.tag,payload:f.payload,callback:null,next:null};T===null?y=T=W:T=T.next=W,f=f.next}while(f!==null);T===null?y=T=l:T=T.next=l}else y=T=l;f={baseState:p.baseState,firstBaseUpdate:y,lastBaseUpdate:T,shared:p.shared,callbacks:p.callbacks},s.updateQueue=f;return}s=f.lastBaseUpdate,s===null?f.firstBaseUpdate=l:s.next=l,f.lastBaseUpdate=l}var Lt=!1;function Yt(){if(Lt){var s=al;if(s!==null)throw s}}function Ot(s,l,f,p){Lt=!1;var y=s.updateQueue;Ze=!1;var T=y.firstBaseUpdate,W=y.lastBaseUpdate,ue=y.shared.pending;if(ue!==null){y.shared.pending=null;var ke=ue,Xe=ke.next;ke.next=null,W===null?T=Xe:W.next=Xe,W=ke;var st=s.alternate;st!==null&&(st=st.updateQueue,ue=st.lastBaseUpdate,ue!==W&&(ue===null?st.firstBaseUpdate=Xe:ue.next=Xe,st.lastBaseUpdate=ke))}if(T!==null){var mt=y.baseState;W=0,st=Xe=ke=null,ue=T;do{var Ke=ue.lane&-536870913,Qe=Ke!==ue.lane;if(Qe?(Kr&Ke)===Ke:(p&Ke)===Ke){Ke!==0&&Ke===Mc&&(Lt=!0),st!==null&&(st=st.next={lane:0,tag:ue.tag,payload:ue.payload,callback:null,next:null});e:{var dr=s,nr=ue;Ke=l;var Nn=f;switch(nr.tag){case 1:if(dr=nr.payload,typeof dr=="function"){mt=dr.call(Nn,mt,Ke);break e}mt=dr;break e;case 3:dr.flags=dr.flags&-65537|128;case 0:if(dr=nr.payload,Ke=typeof dr=="function"?dr.call(Nn,mt,Ke):dr,Ke==null)break e;mt=d({},mt,Ke);break e;case 2:Ze=!0}}Ke=ue.callback,Ke!==null&&(s.flags|=64,Qe&&(s.flags|=8192),Qe=y.callbacks,Qe===null?y.callbacks=[Ke]:Qe.push(Ke))}else Qe={lane:Ke,tag:ue.tag,payload:ue.payload,callback:ue.callback,next:null},st===null?(Xe=st=Qe,ke=mt):st=st.next=Qe,W|=Ke;if(ue=ue.next,ue===null){if(ue=y.shared.pending,ue===null)break;Qe=ue,ue=Qe.next,Qe.next=null,y.lastBaseUpdate=Qe,y.shared.pending=null}}while(!0);st===null&&(ke=mt),y.baseState=ke,y.firstBaseUpdate=Xe,y.lastBaseUpdate=st,T===null&&(y.shared.lanes=0),Bu|=W,s.lanes=W,s.memoizedState=mt}}function Xr(s,l){if(typeof s!="function")throw Error(n(191,s));s.call(l)}function sn(s,l){var f=s.callbacks;if(f!==null)for(s.callbacks=null,s=0;s<f.length;s++)Xr(f[s],l)}var Ar=xe(null),Er=xe(0);function pn(s,l){s=Xc,j(Er,s),j(Ar,l),Xc=s|l.baseLanes}function on(){j(Er,Xc),j(Ar,Ar.current)}function gr(){Xc=Er.current,L(Ar),L(Er)}var _n=0,Zt=null,lr=null,Wr=null,Yr=!1,Pi=!1,xi=!1,Qn=0,Jn=0,si=null,Ts=0;function ln(){throw Error(n(321))}function oi(s,l){if(l===null)return!1;for(var f=0;f<l.length&&f<s.length;f++)if(!Di(s[f],l[f]))return!1;return!0}function Gs(s,l,f,p,y,T){return _n=T,Zt=l,l.memoizedState=null,l.updateQueue=null,l.lanes=0,J.H=s===null||s.memoizedState===null?d5:p5,xi=!1,T=f(p,y),xi=!1,Pi&&(T=Bc(l,f,p,y)),Yl(s),T}function Yl(s){J.H=Bp;var l=lr!==null&&lr.next!==null;if(_n=0,Wr=lr=Zt=null,Yr=!1,Jn=0,si=null,l)throw Error(n(300));s===null||oa||(s=s.dependencies,s!==null&&Yh(s)&&(oa=!0))}function Bc(s,l,f,p){Zt=s;var y=0;do{if(Pi&&(si=null),Jn=0,Pi=!1,25<=y)throw Error(n(301));if(y+=1,Wr=lr=null,s.updateQueue!=null){var T=s.updateQueue;T.lastEffect=null,T.events=null,T.stores=null,T.memoCache!=null&&(T.memoCache.index=0)}J.H=Jk,T=l(f,p)}while(Pi);return T}function Kl(){var s=J.H,l=s.useState()[0];return l=typeof l.then=="function"?$l(l):l,s=s.useState()[0],(lr!==null?lr.memoizedState:null)!==s&&(Zt.flags|=1024),l}function On(){var s=Qn!==0;return Qn=0,s}function Hf(s,l,f){l.updateQueue=s.updateQueue,l.flags&=-2053,s.lanes&=~f}function $h(s){if(Yr){for(s=s.memoizedState;s!==null;){var l=s.queue;l!==null&&(l.pending=null),s=s.next}Yr=!1}_n=0,Wr=lr=Zt=null,Pi=!1,Jn=Qn=0,si=null}function wa(){var s={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Wr===null?Zt.memoizedState=Wr=s:Wr=Wr.next=s,Wr}function Bn(){if(lr===null){var s=Zt.alternate;s=s!==null?s.memoizedState:null}else s=lr.next;var l=Wr===null?Zt.memoizedState:Wr.next;if(l!==null)Wr=l,lr=s;else{if(s===null)throw Zt.alternate===null?Error(n(467)):Error(n(310));lr=s,s={memoizedState:lr.memoizedState,baseState:lr.baseState,baseQueue:lr.baseQueue,queue:lr.queue,next:null},Wr===null?Zt.memoizedState=Wr=s:Wr=Wr.next=s}return Wr}function jc(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function $l(s){var l=Jn;return Jn+=1,si===null&&(si=[]),s=Ge(si,s,l),l=Zt,(Wr===null?l.memoizedState:Wr.next)===null&&(l=l.alternate,J.H=l===null||l.memoizedState===null?d5:p5),s}function Ua(s){if(s!==null&&typeof s=="object"){if(typeof s.then=="function")return $l(s);if(s.$$typeof===B)return vi(s)}throw Error(n(438,String(s)))}function Ql(s){var l=null,f=Zt.updateQueue;if(f!==null&&(l=f.memoCache),l==null){var p=Zt.alternate;p!==null&&(p=p.updateQueue,p!==null&&(p=p.memoCache,p!=null&&(l={data:p.data.map(function(y){return y.slice()}),index:0})))}if(l==null&&(l={data:[],index:0}),f===null&&(f=jc(),Zt.updateQueue=f),f.memoCache=l,f=l.data[l.index],f===void 0)for(f=l.data[l.index]=Array(s),p=0;p<s;p++)f[p]=U;return l.index++,f}function Va(s,l){return typeof l=="function"?l(s):l}function Gf(s){var l=Bn();return ku(l,lr,s)}function ku(s,l,f){var p=s.queue;if(p===null)throw Error(n(311));p.lastRenderedReducer=f;var y=s.baseQueue,T=p.pending;if(T!==null){if(y!==null){var W=y.next;y.next=T.next,T.next=W}l.baseQueue=y=T,p.pending=null}if(T=s.baseState,y===null)s.memoizedState=T;else{l=y.next;var ue=W=null,ke=null,Xe=l,st=!1;do{var mt=Xe.lane&-536870913;if(mt!==Xe.lane?(Kr&mt)===mt:(_n&mt)===mt){var Ke=Xe.revertLane;if(Ke===0)ke!==null&&(ke=ke.next={lane:0,revertLane:0,action:Xe.action,hasEagerState:Xe.hasEagerState,eagerState:Xe.eagerState,next:null}),mt===Mc&&(st=!0);else if((_n&Ke)===Ke){Xe=Xe.next,Ke===Mc&&(st=!0);continue}else mt={lane:0,revertLane:Xe.revertLane,action:Xe.action,hasEagerState:Xe.hasEagerState,eagerState:Xe.eagerState,next:null},ke===null?(ue=ke=mt,W=T):ke=ke.next=mt,Zt.lanes|=Ke,Bu|=Ke;mt=Xe.action,xi&&f(T,mt),T=Xe.hasEagerState?Xe.eagerState:f(T,mt)}else Ke={lane:mt,revertLane:Xe.revertLane,action:Xe.action,hasEagerState:Xe.hasEagerState,eagerState:Xe.eagerState,next:null},ke===null?(ue=ke=Ke,W=T):ke=ke.next=Ke,Zt.lanes|=mt,Bu|=mt;Xe=Xe.next}while(Xe!==null&&Xe!==l);if(ke===null?W=T:ke.next=ue,!Di(T,s.memoizedState)&&(oa=!0,st&&(f=al,f!==null)))throw f;s.memoizedState=T,s.baseState=W,s.baseQueue=ke,p.lastRenderedState=T}return y===null&&(p.lanes=0),[s.memoizedState,p.dispatch]}function Qh(s){var l=Bn(),f=l.queue;if(f===null)throw Error(n(311));f.lastRenderedReducer=s;var p=f.dispatch,y=f.pending,T=l.memoizedState;if(y!==null){f.pending=null;var W=y=y.next;do T=s(T,W.action),W=W.next;while(W!==y);Di(T,l.memoizedState)||(oa=!0),l.memoizedState=T,l.baseQueue===null&&(l.baseState=T),f.lastRenderedState=T}return[T,p]}function Wf(s,l,f){var p=Zt,y=Bn(),T=en;if(T){if(f===void 0)throw Error(n(407));f=f()}else f=l();var W=!Di((lr||y).memoizedState,f);W&&(y.memoizedState=f,oa=!0),y=y.queue;var ue=Nu.bind(null,p,y,s);if(Ru(2048,8,ue,[s]),y.getSnapshot!==l||W||Wr!==null&&Wr.memoizedState.tag&1){if(p.flags|=2048,ol(9,$f(),Xf.bind(null,p,y,f,l),null),Pn===null)throw Error(n(349));T||(_n&124)!==0||Jh(p,l,f)}return f}function Jh(s,l,f){s.flags|=16384,s={getSnapshot:l,value:f},l=Zt.updateQueue,l===null?(l=jc(),Zt.updateQueue=l,l.stores=[s]):(f=l.stores,f===null?l.stores=[s]:f.push(s))}function Xf(s,l,f,p){l.value=f,l.getSnapshot=p,kp(l)&&Np(s)}function Nu(s,l,f){return f(function(){kp(l)&&Np(s)})}function kp(s){var l=s.getSnapshot;s=s.value;try{var f=l();return!Di(s,f)}catch{return!0}}function Np(s){var l=Jo(s,2);l!==null&&Qs(l,s,2)}function Yf(s){var l=wa();if(typeof s=="function"){var f=s;if(s=f(),xi){zt(!0);try{f()}finally{zt(!1)}}}return l.memoizedState=l.baseState=s,l.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Va,lastRenderedState:s},l}function sl(s,l,f,p){return s.baseState=f,ku(s,lr,typeof p=="function"?p:Va)}function N2(s,l,f,p,y){if(Mp(s))throw Error(n(485));if(s=l.action,s!==null){var T={payload:y,action:s,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(W){T.listeners.push(W)}};J.T!==null?f(!0):T.isTransition=!1,p(T),f=l.pending,f===null?(T.next=l.pending=T,Cp(l,T)):(T.next=f.next,l.pending=f.next=T)}}function Cp(s,l){var f=l.action,p=l.payload,y=s.state;if(l.isTransition){var T=J.T,W={};J.T=W;try{var ue=f(y,p),ke=J.S;ke!==null&&ke(W,ue),Ip(s,l,ue)}catch(Xe){Cu(s,l,Xe)}finally{J.T=T}}else try{T=f(y,p),Ip(s,l,T)}catch(Xe){Cu(s,l,Xe)}}function Ip(s,l,f){f!==null&&typeof f=="object"&&typeof f.then=="function"?f.then(function(p){vd(s,l,p)},function(p){return Cu(s,l,p)}):vd(s,l,f)}function vd(s,l,f){l.status="fulfilled",l.value=f,_d(l),s.state=f,l=s.pending,l!==null&&(f=l.next,f===l?s.pending=null:(f=f.next,l.next=f,Cp(s,f)))}function Cu(s,l,f){var p=s.pending;if(s.pending=null,p!==null){p=p.next;do l.status="rejected",l.reason=f,_d(l),l=l.next;while(l!==p)}s.action=null}function _d(s){s=s.listeners;for(var l=0;l<s.length;l++)(0,s[l])()}function xd(s,l){return l}function Kf(s,l){if(en){var f=Pn.formState;if(f!==null){e:{var p=Zt;if(en){if(Wn){t:{for(var y=Wn,T=bo;y.nodeType!==8;){if(!T){y=null;break t}if(y=fl(y.nextSibling),y===null){y=null;break t}}T=y.data,y=T==="F!"||T==="F"?y:null}if(y){Wn=fl(y.nextSibling),p=y.data==="F!";break e}}Pc(p)}p=!1}p&&(l=f[0])}}return f=wa(),f.memoizedState=f.baseState=l,p={pending:null,lanes:0,dispatch:null,lastRenderedReducer:xd,lastRenderedState:l},f.queue=p,f=u5.bind(null,Zt,p),p.dispatch=f,p=Yf(!1),T=C2.bind(null,Zt,!1,p.queue),p=wa(),y={state:l,dispatch:null,action:s,pending:null},p.queue=y,f=N2.bind(null,Zt,y,T,f),y.dispatch=f,p.memoizedState=s,[l,f,!1]}function Zh(s){var l=Bn();return Iu(l,lr,s)}function Iu(s,l,f){if(l=ku(s,l,xd)[0],s=Gf(Va)[0],typeof l=="object"&&l!==null&&typeof l.then=="function")try{var p=$l(l)}catch(W){throw W===re?le:W}else p=l;l=Bn();var y=l.queue,T=y.dispatch;return f!==l.memoizedState&&(Zt.flags|=2048,ol(9,$f(),Rp.bind(null,y,f),null)),[p,T,s]}function Rp(s,l){s.action=l}function Lp(s){var l=Bn(),f=lr;if(f!==null)return Iu(l,f,s);Bn(),l=l.memoizedState,f=Bn();var p=f.queue.dispatch;return f.memoizedState=s,[l,p,!1]}function ol(s,l,f,p){return s={tag:s,create:f,deps:p,inst:l,next:null},l=Zt.updateQueue,l===null&&(l=jc(),Zt.updateQueue=l),f=l.lastEffect,f===null?l.lastEffect=s.next=s:(p=f.next,f.next=s,s.next=p,l.lastEffect=s),s}function $f(){return{destroy:void 0,resource:void 0}}function e0(){return Bn().memoizedState}function Ws(s,l,f,p){var y=wa();p=p===void 0?null:p,Zt.flags|=s,y.memoizedState=ol(1|l,$f(),f,p)}function Ru(s,l,f,p){var y=Bn();p=p===void 0?null:p;var T=y.memoizedState.inst;lr!==null&&p!==null&&oi(p,lr.memoizedState.deps)?y.memoizedState=ol(l,T,f,p):(Zt.flags|=s,y.memoizedState=ol(1|l,T,f,p))}function yd(s,l){Ws(8390656,8,s,l)}function Dp(s,l){Ru(2048,8,s,l)}function wd(s,l){return Ru(4,2,s,l)}function Uc(s,l){return Ru(4,4,s,l)}function Fp(s,l){if(typeof l=="function"){s=s();var f=l(s);return function(){typeof f=="function"?f():l(null)}}if(l!=null)return s=s(),l.current=s,function(){l.current=null}}function Ed(s,l,f){f=f!=null?f.concat([s]):null,Ru(4,4,Fp.bind(null,l,s),f)}function bd(){}function Sd(s,l){var f=Bn();l=l===void 0?null:l;var p=f.memoizedState;return l!==null&&oi(l,p[1])?p[0]:(f.memoizedState=[s,l],s)}function Op(s,l){var f=Bn();l=l===void 0?null:l;var p=f.memoizedState;if(l!==null&&oi(l,p[1]))return p[0];if(p=s(),xi){zt(!0);try{s()}finally{zt(!1)}}return f.memoizedState=[p,l],p}function Vc(s,l,f){return f===void 0||(_n&1073741824)!==0?s.memoizedState=l:(s.memoizedState=f,s=sw(),Zt.lanes|=s,Bu|=s,f)}function t0(s,l,f,p){return Di(f,l)?f:Ar.current!==null?(s=Vc(s,f,p),Di(s,l)||(oa=!0),s):(_n&42)===0?(oa=!0,s.memoizedState=f):(s=sw(),Zt.lanes|=s,Bu|=s,l)}function Qf(s,l,f,p,y){var T=de.p;de.p=T!==0&&8>T?T:8;var W=J.T,ue={};J.T=ue,C2(s,!1,l,f);try{var ke=y(),Xe=J.S;if(Xe!==null&&Xe(ue,ke),ke!==null&&typeof ke=="object"&&typeof ke.then=="function"){var st=Tp(ke,p);Nd(s,l,st,$s(s))}else Nd(s,l,p,$s(s))}catch(mt){Nd(s,l,{then:function(){},status:"rejected",reason:mt},$s())}finally{de.p=T,J.T=W}}function ll(){}function ko(s,l,f,p){if(s.tag!==5)throw Error(n(476));var y=cl(s).queue;Qf(s,y,l,oe,f===null?ll:function(){return Jf(s),f(p)})}function cl(s){var l=s.memoizedState;if(l!==null)return l;l={memoizedState:oe,baseState:oe,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Va,lastRenderedState:oe},next:null};var f={};return l.next={memoizedState:f,baseState:f,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Va,lastRenderedState:f},next:null},s.memoizedState=l,s=s.alternate,s!==null&&(s.memoizedState=l),l}function Jf(s){var l=cl(s).next.queue;Nd(s,l,{},$s())}function Zf(){return vi(Wd)}function Ad(){return Bn().memoizedState}function Pp(){return Bn().memoizedState}function Td(s){for(var l=s.return;l!==null;){switch(l.tag){case 24:case 3:var f=$s();s=at(f);var p=ht(l,s,f);p!==null&&(Qs(p,l,f),ct(p,l,f)),l={cache:md()},s.payload=l;return}l=l.return}}function kd(s,l,f){var p=$s();f={lane:p,revertLane:0,action:f,hasEagerState:!1,eagerState:null,next:null},Mp(s)?f5(l,f):(f=zl(s,l,f,p),f!==null&&(Qs(f,s,p),h5(f,l,p)))}function u5(s,l,f){var p=$s();Nd(s,l,f,p)}function Nd(s,l,f,p){var y={lane:p,revertLane:0,action:f,hasEagerState:!1,eagerState:null,next:null};if(Mp(s))f5(l,y);else{var T=s.alternate;if(s.lanes===0&&(T===null||T.lanes===0)&&(T=l.lastRenderedReducer,T!==null))try{var W=l.lastRenderedState,ue=T(W,f);if(y.hasEagerState=!0,y.eagerState=ue,Di(ue,W))return ql(s,l,y,0),Pn===null&&bs(),!1}catch{}finally{}if(f=zl(s,l,y,p),f!==null)return Qs(f,s,p),h5(f,l,p),!0}return!1}function C2(s,l,f,p){if(p={lane:2,revertLane:ov(),action:p,hasEagerState:!1,eagerState:null,next:null},Mp(s)){if(l)throw Error(n(479))}else l=zl(s,f,p,2),l!==null&&Qs(l,s,2)}function Mp(s){var l=s.alternate;return s===Zt||l!==null&&l===Zt}function f5(s,l){Pi=Yr=!0;var f=s.pending;f===null?l.next=l:(l.next=f.next,f.next=l),s.pending=l}function h5(s,l,f){if((f&4194048)!==0){var p=l.lanes;p&=s.pendingLanes,f|=p,l.lanes=f,Dr(s,f)}}var Bp={readContext:vi,use:Ua,useCallback:ln,useContext:ln,useEffect:ln,useImperativeHandle:ln,useLayoutEffect:ln,useInsertionEffect:ln,useMemo:ln,useReducer:ln,useRef:ln,useState:ln,useDebugValue:ln,useDeferredValue:ln,useTransition:ln,useSyncExternalStore:ln,useId:ln,useHostTransitionStatus:ln,useFormState:ln,useActionState:ln,useOptimistic:ln,useMemoCache:ln,useCacheRefresh:ln},d5={readContext:vi,use:Ua,useCallback:function(s,l){return wa().memoizedState=[s,l===void 0?null:l],s},useContext:vi,useEffect:yd,useImperativeHandle:function(s,l,f){f=f!=null?f.concat([s]):null,Ws(4194308,4,Fp.bind(null,l,s),f)},useLayoutEffect:function(s,l){return Ws(4194308,4,s,l)},useInsertionEffect:function(s,l){Ws(4,2,s,l)},useMemo:function(s,l){var f=wa();l=l===void 0?null:l;var p=s();if(xi){zt(!0);try{s()}finally{zt(!1)}}return f.memoizedState=[p,l],p},useReducer:function(s,l,f){var p=wa();if(f!==void 0){var y=f(l);if(xi){zt(!0);try{f(l)}finally{zt(!1)}}}else y=l;return p.memoizedState=p.baseState=y,s={pending:null,lanes:0,dispatch:null,lastRenderedReducer:s,lastRenderedState:y},p.queue=s,s=s.dispatch=kd.bind(null,Zt,s),[p.memoizedState,s]},useRef:function(s){var l=wa();return s={current:s},l.memoizedState=s},useState:function(s){s=Yf(s);var l=s.queue,f=u5.bind(null,Zt,l);return l.dispatch=f,[s.memoizedState,f]},useDebugValue:bd,useDeferredValue:function(s,l){var f=wa();return Vc(f,s,l)},useTransition:function(){var s=Yf(!1);return s=Qf.bind(null,Zt,s.queue,!0,!1),wa().memoizedState=s,[!1,s]},useSyncExternalStore:function(s,l,f){var p=Zt,y=wa();if(en){if(f===void 0)throw Error(n(407));f=f()}else{if(f=l(),Pn===null)throw Error(n(349));(Kr&124)!==0||Jh(p,l,f)}y.memoizedState=f;var T={value:f,getSnapshot:l};return y.queue=T,yd(Nu.bind(null,p,T,s),[s]),p.flags|=2048,ol(9,$f(),Xf.bind(null,p,T,f,l),null),f},useId:function(){var s=wa(),l=Pn.identifierPrefix;if(en){var f=rl,p=tl;f=(p&~(1<<32-Pt(p)-1)).toString(32)+f,l=""+l+"R"+f,f=Qn++,0<f&&(l+="H"+f.toString(32)),l+=""}else f=Ts++,l=""+l+"r"+f.toString(32)+"";return s.memoizedState=l},useHostTransitionStatus:Zf,useFormState:Kf,useActionState:Kf,useOptimistic:function(s){var l=wa();l.memoizedState=l.baseState=s;var f={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return l.queue=f,l=C2.bind(null,Zt,!0,f),f.dispatch=l,[s,l]},useMemoCache:Ql,useCacheRefresh:function(){return wa().memoizedState=Td.bind(null,Zt)}},p5={readContext:vi,use:Ua,useCallback:Sd,useContext:vi,useEffect:Dp,useImperativeHandle:Ed,useInsertionEffect:wd,useLayoutEffect:Uc,useMemo:Op,useReducer:Gf,useRef:e0,useState:function(){return Gf(Va)},useDebugValue:bd,useDeferredValue:function(s,l){var f=Bn();return t0(f,lr.memoizedState,s,l)},useTransition:function(){var s=Gf(Va)[0],l=Bn().memoizedState;return[typeof s=="boolean"?s:$l(s),l]},useSyncExternalStore:Wf,useId:Ad,useHostTransitionStatus:Zf,useFormState:Zh,useActionState:Zh,useOptimistic:function(s,l){var f=Bn();return sl(f,lr,s,l)},useMemoCache:Ql,useCacheRefresh:Pp},Jk={readContext:vi,use:Ua,useCallback:Sd,useContext:vi,useEffect:Dp,useImperativeHandle:Ed,useInsertionEffect:wd,useLayoutEffect:Uc,useMemo:Op,useReducer:Qh,useRef:e0,useState:function(){return Qh(Va)},useDebugValue:bd,useDeferredValue:function(s,l){var f=Bn();return lr===null?Vc(f,s,l):t0(f,lr.memoizedState,s,l)},useTransition:function(){var s=Qh(Va)[0],l=Bn().memoizedState;return[typeof s=="boolean"?s:$l(s),l]},useSyncExternalStore:Wf,useId:Ad,useHostTransitionStatus:Zf,useFormState:Lp,useActionState:Lp,useOptimistic:function(s,l){var f=Bn();return lr!==null?sl(f,lr,s,l):(f.baseState=s,[s,f.queue.dispatch])},useMemoCache:Ql,useCacheRefresh:Pp},r0=null,Cd=0;function jp(s){var l=Cd;return Cd+=1,r0===null&&(r0=[]),Ge(r0,s,l)}function Id(s,l){l=l.props.ref,s.ref=l!==void 0?l:null}function Up(s,l){throw l.$$typeof===g?Error(n(525)):(s=Object.prototype.toString.call(l),Error(n(31,s==="[object Object]"?"object with keys {"+Object.keys(l).join(", ")+"}":s)))}function m5(s){var l=s._init;return l(s._payload)}function g5(s){function l(Ue,Le){if(s){var ze=Ue.deletions;ze===null?(Ue.deletions=[Le],Ue.flags|=16):ze.push(Le)}}function f(Ue,Le){if(!s)return null;for(;Le!==null;)l(Ue,Le),Le=Le.sibling;return null}function p(Ue){for(var Le=new Map;Ue!==null;)Ue.key!==null?Le.set(Ue.key,Ue):Le.set(Ue.index,Ue),Ue=Ue.sibling;return Le}function y(Ue,Le){return Ue=Eo(Ue,Le),Ue.index=0,Ue.sibling=null,Ue}function T(Ue,Le,ze){return Ue.index=ze,s?(ze=Ue.alternate,ze!==null?(ze=ze.index,ze<Le?(Ue.flags|=67108866,Le):ze):(Ue.flags|=67108866,Le)):(Ue.flags|=1048576,Le)}function W(Ue){return s&&Ue.alternate===null&&(Ue.flags|=67108866),Ue}function ue(Ue,Le,ze,ut){return Le===null||Le.tag!==6?(Le=Hh(ze,Ue.mode,ut),Le.return=Ue,Le):(Le=y(Le,ze),Le.return=Ue,Le)}function ke(Ue,Le,ze,ut){var Wt=ze.type;return Wt===b?st(Ue,Le,ze.props.children,ut,ze.key):Le!==null&&(Le.elementType===Wt||typeof Wt=="object"&&Wt!==null&&Wt.$$typeof===k&&m5(Wt)===Le.type)?(Le=y(Le,ze.props),Id(Le,ze),Le.return=Ue,Le):(Le=Dc(ze.type,ze.key,ze.props,null,Ue.mode,ut),Id(Le,ze),Le.return=Ue,Le)}function Xe(Ue,Le,ze,ut){return Le===null||Le.tag!==4||Le.stateNode.containerInfo!==ze.containerInfo||Le.stateNode.implementation!==ze.implementation?(Le=jf(ze,Ue.mode,ut),Le.return=Ue,Le):(Le=y(Le,ze.children||[]),Le.return=Ue,Le)}function st(Ue,Le,ze,ut,Wt){return Le===null||Le.tag!==7?(Le=Zo(ze,Ue.mode,ut,Wt),Le.return=Ue,Le):(Le=y(Le,ze),Le.return=Ue,Le)}function mt(Ue,Le,ze){if(typeof Le=="string"&&Le!==""||typeof Le=="number"||typeof Le=="bigint")return Le=Hh(""+Le,Ue.mode,ze),Le.return=Ue,Le;if(typeof Le=="object"&&Le!==null){switch(Le.$$typeof){case x:return ze=Dc(Le.type,Le.key,Le.props,null,Ue.mode,ze),Id(ze,Le),ze.return=Ue,ze;case _:return Le=jf(Le,Ue.mode,ze),Le.return=Ue,Le;case k:var ut=Le._init;return Le=ut(Le._payload),mt(Ue,Le,ze)}if(ne(Le)||C(Le))return Le=Zo(Le,Ue.mode,ze,null),Le.return=Ue,Le;if(typeof Le.then=="function")return mt(Ue,jp(Le),ze);if(Le.$$typeof===B)return mt(Ue,Xl(Ue,Le),ze);Up(Ue,Le)}return null}function Ke(Ue,Le,ze,ut){var Wt=Le!==null?Le.key:null;if(typeof ze=="string"&&ze!==""||typeof ze=="number"||typeof ze=="bigint")return Wt!==null?null:ue(Ue,Le,""+ze,ut);if(typeof ze=="object"&&ze!==null){switch(ze.$$typeof){case x:return ze.key===Wt?ke(Ue,Le,ze,ut):null;case _:return ze.key===Wt?Xe(Ue,Le,ze,ut):null;case k:return Wt=ze._init,ze=Wt(ze._payload),Ke(Ue,Le,ze,ut)}if(ne(ze)||C(ze))return Wt!==null?null:st(Ue,Le,ze,ut,null);if(typeof ze.then=="function")return Ke(Ue,Le,jp(ze),ut);if(ze.$$typeof===B)return Ke(Ue,Le,Xl(Ue,ze),ut);Up(Ue,ze)}return null}function Qe(Ue,Le,ze,ut,Wt){if(typeof ut=="string"&&ut!==""||typeof ut=="number"||typeof ut=="bigint")return Ue=Ue.get(ze)||null,ue(Le,Ue,""+ut,Wt);if(typeof ut=="object"&&ut!==null){switch(ut.$$typeof){case x:return Ue=Ue.get(ut.key===null?ze:ut.key)||null,ke(Le,Ue,ut,Wt);case _:return Ue=Ue.get(ut.key===null?ze:ut.key)||null,Xe(Le,Ue,ut,Wt);case k:var Mr=ut._init;return ut=Mr(ut._payload),Qe(Ue,Le,ze,ut,Wt)}if(ne(ut)||C(ut))return Ue=Ue.get(ze)||null,st(Le,Ue,ut,Wt,null);if(typeof ut.then=="function")return Qe(Ue,Le,ze,jp(ut),Wt);if(ut.$$typeof===B)return Qe(Ue,Le,ze,Xl(Le,ut),Wt);Up(Le,ut)}return null}function dr(Ue,Le,ze,ut){for(var Wt=null,Mr=null,$t=Le,ir=Le=0,ca=null;$t!==null&&ir<ze.length;ir++){$t.index>ir?(ca=$t,$t=null):ca=$t.sibling;var cn=Ke(Ue,$t,ze[ir],ut);if(cn===null){$t===null&&($t=ca);break}s&&$t&&cn.alternate===null&&l(Ue,$t),Le=T(cn,Le,ir),Mr===null?Wt=cn:Mr.sibling=cn,Mr=cn,$t=ca}if(ir===ze.length)return f(Ue,$t),en&&Oc(Ue,ir),Wt;if($t===null){for(;ir<ze.length;ir++)$t=mt(Ue,ze[ir],ut),$t!==null&&(Le=T($t,Le,ir),Mr===null?Wt=$t:Mr.sibling=$t,Mr=$t);return en&&Oc(Ue,ir),Wt}for($t=p($t);ir<ze.length;ir++)ca=Qe($t,Ue,ir,ze[ir],ut),ca!==null&&(s&&ca.alternate!==null&&$t.delete(ca.key===null?ir:ca.key),Le=T(ca,Le,ir),Mr===null?Wt=ca:Mr.sibling=ca,Mr=ca);return s&&$t.forEach(function(Xu){return l(Ue,Xu)}),en&&Oc(Ue,ir),Wt}function nr(Ue,Le,ze,ut){if(ze==null)throw Error(n(151));for(var Wt=null,Mr=null,$t=Le,ir=Le=0,ca=null,cn=ze.next();$t!==null&&!cn.done;ir++,cn=ze.next()){$t.index>ir?(ca=$t,$t=null):ca=$t.sibling;var Xu=Ke(Ue,$t,cn.value,ut);if(Xu===null){$t===null&&($t=ca);break}s&&$t&&Xu.alternate===null&&l(Ue,$t),Le=T(Xu,Le,ir),Mr===null?Wt=Xu:Mr.sibling=Xu,Mr=Xu,$t=ca}if(cn.done)return f(Ue,$t),en&&Oc(Ue,ir),Wt;if($t===null){for(;!cn.done;ir++,cn=ze.next())cn=mt(Ue,cn.value,ut),cn!==null&&(Le=T(cn,Le,ir),Mr===null?Wt=cn:Mr.sibling=cn,Mr=cn);return en&&Oc(Ue,ir),Wt}for($t=p($t);!cn.done;ir++,cn=ze.next())cn=Qe($t,Ue,ir,cn.value,ut),cn!==null&&(s&&cn.alternate!==null&&$t.delete(cn.key===null?ir:cn.key),Le=T(cn,Le,ir),Mr===null?Wt=cn:Mr.sibling=cn,Mr=cn);return s&&$t.forEach(function(Z8){return l(Ue,Z8)}),en&&Oc(Ue,ir),Wt}function Nn(Ue,Le,ze,ut){if(typeof ze=="object"&&ze!==null&&ze.type===b&&ze.key===null&&(ze=ze.props.children),typeof ze=="object"&&ze!==null){switch(ze.$$typeof){case x:e:{for(var Wt=ze.key;Le!==null;){if(Le.key===Wt){if(Wt=ze.type,Wt===b){if(Le.tag===7){f(Ue,Le.sibling),ut=y(Le,ze.props.children),ut.return=Ue,Ue=ut;break e}}else if(Le.elementType===Wt||typeof Wt=="object"&&Wt!==null&&Wt.$$typeof===k&&m5(Wt)===Le.type){f(Ue,Le.sibling),ut=y(Le,ze.props),Id(ut,ze),ut.return=Ue,Ue=ut;break e}f(Ue,Le);break}else l(Ue,Le);Le=Le.sibling}ze.type===b?(ut=Zo(ze.props.children,Ue.mode,ut,ze.key),ut.return=Ue,Ue=ut):(ut=Dc(ze.type,ze.key,ze.props,null,Ue.mode,ut),Id(ut,ze),ut.return=Ue,Ue=ut)}return W(Ue);case _:e:{for(Wt=ze.key;Le!==null;){if(Le.key===Wt)if(Le.tag===4&&Le.stateNode.containerInfo===ze.containerInfo&&Le.stateNode.implementation===ze.implementation){f(Ue,Le.sibling),ut=y(Le,ze.children||[]),ut.return=Ue,Ue=ut;break e}else{f(Ue,Le);break}else l(Ue,Le);Le=Le.sibling}ut=jf(ze,Ue.mode,ut),ut.return=Ue,Ue=ut}return W(Ue);case k:return Wt=ze._init,ze=Wt(ze._payload),Nn(Ue,Le,ze,ut)}if(ne(ze))return dr(Ue,Le,ze,ut);if(C(ze)){if(Wt=C(ze),typeof Wt!="function")throw Error(n(150));return ze=Wt.call(ze),nr(Ue,Le,ze,ut)}if(typeof ze.then=="function")return Nn(Ue,Le,jp(ze),ut);if(ze.$$typeof===B)return Nn(Ue,Le,Xl(Ue,ze),ut);Up(Ue,ze)}return typeof ze=="string"&&ze!==""||typeof ze=="number"||typeof ze=="bigint"?(ze=""+ze,Le!==null&&Le.tag===6?(f(Ue,Le.sibling),ut=y(Le,ze),ut.return=Ue,Ue=ut):(f(Ue,Le),ut=Hh(ze,Ue.mode,ut),ut.return=Ue,Ue=ut),W(Ue)):f(Ue,Le)}return function(Ue,Le,ze,ut){try{Cd=0;var Wt=Nn(Ue,Le,ze,ut);return r0=null,Wt}catch($t){if($t===re||$t===le)throw $t;var Mr=sa(29,$t,null,Ue.mode);return Mr.lanes=ut,Mr.return=Ue,Mr}finally{}}}var n0=g5(!0),v5=g5(!1),No=xe(null),Jl=null;function Lu(s){var l=s.alternate;j($i,$i.current&1),j(No,s),Jl===null&&(l===null||Ar.current!==null||l.memoizedState!==null)&&(Jl=s)}function _5(s){if(s.tag===22){if(j($i,$i.current),j(No,s),Jl===null){var l=s.alternate;l!==null&&l.memoizedState!==null&&(Jl=s)}}else Du()}function Du(){j($i,$i.current),j(No,No.current)}function qc(s){L(No),Jl===s&&(Jl=null),L($i)}var $i=xe(0);function Vp(s){for(var l=s;l!==null;){if(l.tag===13){var f=l.memoizedState;if(f!==null&&(f=f.dehydrated,f===null||f.data==="$?"||xv(f)))return l}else if(l.tag===19&&l.memoizedProps.revealOrder!==void 0){if((l.flags&128)!==0)return l}else if(l.child!==null){l.child.return=l,l=l.child;continue}if(l===s)break;for(;l.sibling===null;){if(l.return===null||l.return===s)return null;l=l.return}l.sibling.return=l.return,l=l.sibling}return null}function I2(s,l,f,p){l=s.memoizedState,f=f(p,l),f=f==null?l:d({},l,f),s.memoizedState=f,s.lanes===0&&(s.updateQueue.baseState=f)}var R2={enqueueSetState:function(s,l,f){s=s._reactInternals;var p=$s(),y=at(p);y.payload=l,f!=null&&(y.callback=f),l=ht(s,y,p),l!==null&&(Qs(l,s,p),ct(l,s,p))},enqueueReplaceState:function(s,l,f){s=s._reactInternals;var p=$s(),y=at(p);y.tag=1,y.payload=l,f!=null&&(y.callback=f),l=ht(s,y,p),l!==null&&(Qs(l,s,p),ct(l,s,p))},enqueueForceUpdate:function(s,l){s=s._reactInternals;var f=$s(),p=at(f);p.tag=2,l!=null&&(p.callback=l),l=ht(s,p,f),l!==null&&(Qs(l,s,f),ct(l,s,f))}};function x5(s,l,f,p,y,T,W){return s=s.stateNode,typeof s.shouldComponentUpdate=="function"?s.shouldComponentUpdate(p,T,W):l.prototype&&l.prototype.isPureReactComponent?!Ol(f,p)||!Ol(y,T):!0}function y5(s,l,f,p){s=l.state,typeof l.componentWillReceiveProps=="function"&&l.componentWillReceiveProps(f,p),typeof l.UNSAFE_componentWillReceiveProps=="function"&&l.UNSAFE_componentWillReceiveProps(f,p),l.state!==s&&R2.enqueueReplaceState(l,l.state,null)}function eh(s,l){var f=l;if("ref"in l){f={};for(var p in l)p!=="ref"&&(f[p]=l[p])}if(s=s.defaultProps){f===l&&(f=d({},f));for(var y in s)f[y]===void 0&&(f[y]=s[y])}return f}var qp=typeof reportError=="function"?reportError:function(s){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var l=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof s=="object"&&s!==null&&typeof s.message=="string"?String(s.message):String(s),error:s});if(!window.dispatchEvent(l))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",s);return}console.error(s)};function w5(s){qp(s)}function E5(s){console.error(s)}function b5(s){qp(s)}function zp(s,l){try{var f=s.onUncaughtError;f(l.value,{componentStack:l.stack})}catch(p){setTimeout(function(){throw p})}}function S5(s,l,f){try{var p=s.onCaughtError;p(f.value,{componentStack:f.stack,errorBoundary:l.tag===1?l.stateNode:null})}catch(y){setTimeout(function(){throw y})}}function L2(s,l,f){return f=at(f),f.tag=3,f.payload={element:null},f.callback=function(){zp(s,l)},f}function A5(s){return s=at(s),s.tag=3,s}function T5(s,l,f,p){var y=f.type.getDerivedStateFromError;if(typeof y=="function"){var T=p.value;s.payload=function(){return y(T)},s.callback=function(){S5(l,f,p)}}var W=f.stateNode;W!==null&&typeof W.componentDidCatch=="function"&&(s.callback=function(){S5(l,f,p),typeof y!="function"&&(ju===null?ju=new Set([this]):ju.add(this));var ue=p.stack;this.componentDidCatch(p.value,{componentStack:ue!==null?ue:""})})}function Zk(s,l,f,p,y){if(f.flags|=32768,p!==null&&typeof p=="object"&&typeof p.then=="function"){if(l=f.alternate,l!==null&&Tu(l,f,y,!0),f=No.current,f!==null){switch(f.tag){case 13:return Jl===null?rv():f.alternate===null&&li===0&&(li=3),f.flags&=-257,f.flags|=65536,f.lanes=y,p===pe?f.flags|=16384:(l=f.updateQueue,l===null?f.updateQueue=new Set([p]):l.add(p),iv(s,p,y)),!1;case 22:return f.flags|=65536,p===pe?f.flags|=16384:(l=f.updateQueue,l===null?(l={transitions:null,markerInstances:null,retryQueue:new Set([p])},f.updateQueue=l):(f=l.retryQueue,f===null?l.retryQueue=new Set([p]):f.add(p)),iv(s,p,y)),!1}throw Error(n(435,f.tag))}return iv(s,p,y),rv(),!1}if(en)return l=No.current,l!==null?((l.flags&65536)===0&&(l.flags|=256),l.flags|=65536,l.lanes=y,p!==pd&&(s=Error(n(422),{cause:p}),Au(Cr(s,f)))):(p!==pd&&(l=Error(n(423),{cause:p}),Au(Cr(l,f))),s=s.current.alternate,s.flags|=65536,y&=-y,s.lanes|=y,p=Cr(p,f),y=L2(s.stateNode,p,y),Ut(s,y),li!==4&&(li=2)),!1;var T=Error(n(520),{cause:p});if(T=Cr(T,f),Md===null?Md=[T]:Md.push(T),li!==4&&(li=2),l===null)return!0;p=Cr(p,f),f=l;do{switch(f.tag){case 3:return f.flags|=65536,s=y&-y,f.lanes|=s,s=L2(f.stateNode,p,s),Ut(f,s),!1;case 1:if(l=f.type,T=f.stateNode,(f.flags&128)===0&&(typeof l.getDerivedStateFromError=="function"||T!==null&&typeof T.componentDidCatch=="function"&&(ju===null||!ju.has(T))))return f.flags|=65536,y&=-y,f.lanes|=y,y=A5(y),T5(y,s,f,p),Ut(f,y),!1}f=f.return}while(f!==null);return!1}var k5=Error(n(461)),oa=!1;function Ea(s,l,f,p){l.child=s===null?v5(l,null,f,p):n0(l,s.child,f,p)}function N5(s,l,f,p,y){f=f.render;var T=l.ref;if("ref"in p){var W={};for(var ue in p)ue!=="ref"&&(W[ue]=p[ue])}else W=p;return To(l),p=Gs(s,l,f,W,T,y),ue=On(),s!==null&&!oa?(Hf(s,l,y),zc(s,l,y)):(en&&ue&&Uf(l),l.flags|=1,Ea(s,l,p,y),l.child)}function C5(s,l,f,p,y){if(s===null){var T=f.type;return typeof T=="function"&&!bu(T)&&T.defaultProps===void 0&&f.compare===null?(l.tag=15,l.type=T,I5(s,l,T,p,y)):(s=Dc(f.type,null,p,l,l.mode,y),s.ref=l.ref,s.return=l,l.child=s)}if(T=s.child,!U2(s,y)){var W=T.memoizedProps;if(f=f.compare,f=f!==null?f:Ol,f(W,p)&&s.ref===l.ref)return zc(s,l,y)}return l.flags|=1,s=Eo(T,p),s.ref=l.ref,s.return=l,l.child=s}function I5(s,l,f,p,y){if(s!==null){var T=s.memoizedProps;if(Ol(T,p)&&s.ref===l.ref)if(oa=!1,l.pendingProps=p=T,U2(s,y))(s.flags&131072)!==0&&(oa=!0);else return l.lanes=s.lanes,zc(s,l,y)}return D2(s,l,f,p,y)}function R5(s,l,f){var p=l.pendingProps,y=p.children,T=s!==null?s.memoizedState:null;if(p.mode==="hidden"){if((l.flags&128)!==0){if(p=T!==null?T.baseLanes|f:f,s!==null){for(y=l.child=s.child,T=0;y!==null;)T=T|y.lanes|y.childLanes,y=y.sibling;l.childLanes=T&~p}else l.childLanes=0,l.child=null;return L5(s,l,p,f)}if((f&536870912)!==0)l.memoizedState={baseLanes:0,cachePool:null},s!==null&&V(l,T!==null?T.cachePool:null),T!==null?pn(l,T):on(),_5(l);else return l.lanes=l.childLanes=536870912,L5(s,l,T!==null?T.baseLanes|f:f,f)}else T!==null?(V(l,T.cachePool),pn(l,T),Du(),l.memoizedState=null):(s!==null&&V(l,null),on(),Du());return Ea(s,l,y,f),l.child}function L5(s,l,f,p){var y=D();return y=y===null?null:{parent:_i._currentValue,pool:y},l.memoizedState={baseLanes:f,cachePool:y},s!==null&&V(l,null),on(),_5(l),s!==null&&Tu(s,l,p,!0),null}function Hp(s,l){var f=l.ref;if(f===null)s!==null&&s.ref!==null&&(l.flags|=4194816);else{if(typeof f!="function"&&typeof f!="object")throw Error(n(284));(s===null||s.ref!==f)&&(l.flags|=4194816)}}function D2(s,l,f,p,y){return To(l),f=Gs(s,l,f,p,void 0,y),p=On(),s!==null&&!oa?(Hf(s,l,y),zc(s,l,y)):(en&&p&&Uf(l),l.flags|=1,Ea(s,l,f,y),l.child)}function D5(s,l,f,p,y,T){return To(l),l.updateQueue=null,f=Bc(l,p,f,y),Yl(s),p=On(),s!==null&&!oa?(Hf(s,l,T),zc(s,l,T)):(en&&p&&Uf(l),l.flags|=1,Ea(s,l,f,T),l.child)}function F5(s,l,f,p,y){if(To(l),l.stateNode===null){var T=Fi,W=f.contextType;typeof W=="object"&&W!==null&&(T=vi(W)),T=new f(p,T),l.memoizedState=T.state!==null&&T.state!==void 0?T.state:null,T.updater=R2,l.stateNode=T,T._reactInternals=l,T=l.stateNode,T.props=p,T.state=l.memoizedState,T.refs={},Re(l),W=f.contextType,T.context=typeof W=="object"&&W!==null?vi(W):Fi,T.state=l.memoizedState,W=f.getDerivedStateFromProps,typeof W=="function"&&(I2(l,f,W,p),T.state=l.memoizedState),typeof f.getDerivedStateFromProps=="function"||typeof T.getSnapshotBeforeUpdate=="function"||typeof T.UNSAFE_componentWillMount!="function"&&typeof T.componentWillMount!="function"||(W=T.state,typeof T.componentWillMount=="function"&&T.componentWillMount(),typeof T.UNSAFE_componentWillMount=="function"&&T.UNSAFE_componentWillMount(),W!==T.state&&R2.enqueueReplaceState(T,T.state,null),Ot(l,p,T,y),Yt(),T.state=l.memoizedState),typeof T.componentDidMount=="function"&&(l.flags|=4194308),p=!0}else if(s===null){T=l.stateNode;var ue=l.memoizedProps,ke=eh(f,ue);T.props=ke;var Xe=T.context,st=f.contextType;W=Fi,typeof st=="object"&&st!==null&&(W=vi(st));var mt=f.getDerivedStateFromProps;st=typeof mt=="function"||typeof T.getSnapshotBeforeUpdate=="function",ue=l.pendingProps!==ue,st||typeof T.UNSAFE_componentWillReceiveProps!="function"&&typeof T.componentWillReceiveProps!="function"||(ue||Xe!==W)&&y5(l,T,p,W),Ze=!1;var Ke=l.memoizedState;T.state=Ke,Ot(l,p,T,y),Yt(),Xe=l.memoizedState,ue||Ke!==Xe||Ze?(typeof mt=="function"&&(I2(l,f,mt,p),Xe=l.memoizedState),(ke=Ze||x5(l,f,ke,p,Ke,Xe,W))?(st||typeof T.UNSAFE_componentWillMount!="function"&&typeof T.componentWillMount!="function"||(typeof T.componentWillMount=="function"&&T.componentWillMount(),typeof T.UNSAFE_componentWillMount=="function"&&T.UNSAFE_componentWillMount()),typeof T.componentDidMount=="function"&&(l.flags|=4194308)):(typeof T.componentDidMount=="function"&&(l.flags|=4194308),l.memoizedProps=p,l.memoizedState=Xe),T.props=p,T.state=Xe,T.context=W,p=ke):(typeof T.componentDidMount=="function"&&(l.flags|=4194308),p=!1)}else{T=l.stateNode,De(s,l),W=l.memoizedProps,st=eh(f,W),T.props=st,mt=l.pendingProps,Ke=T.context,Xe=f.contextType,ke=Fi,typeof Xe=="object"&&Xe!==null&&(ke=vi(Xe)),ue=f.getDerivedStateFromProps,(Xe=typeof ue=="function"||typeof T.getSnapshotBeforeUpdate=="function")||typeof T.UNSAFE_componentWillReceiveProps!="function"&&typeof T.componentWillReceiveProps!="function"||(W!==mt||Ke!==ke)&&y5(l,T,p,ke),Ze=!1,Ke=l.memoizedState,T.state=Ke,Ot(l,p,T,y),Yt();var Qe=l.memoizedState;W!==mt||Ke!==Qe||Ze||s!==null&&s.dependencies!==null&&Yh(s.dependencies)?(typeof ue=="function"&&(I2(l,f,ue,p),Qe=l.memoizedState),(st=Ze||x5(l,f,st,p,Ke,Qe,ke)||s!==null&&s.dependencies!==null&&Yh(s.dependencies))?(Xe||typeof T.UNSAFE_componentWillUpdate!="function"&&typeof T.componentWillUpdate!="function"||(typeof T.componentWillUpdate=="function"&&T.componentWillUpdate(p,Qe,ke),typeof T.UNSAFE_componentWillUpdate=="function"&&T.UNSAFE_componentWillUpdate(p,Qe,ke)),typeof T.componentDidUpdate=="function"&&(l.flags|=4),typeof T.getSnapshotBeforeUpdate=="function"&&(l.flags|=1024)):(typeof T.componentDidUpdate!="function"||W===s.memoizedProps&&Ke===s.memoizedState||(l.flags|=4),typeof T.getSnapshotBeforeUpdate!="function"||W===s.memoizedProps&&Ke===s.memoizedState||(l.flags|=1024),l.memoizedProps=p,l.memoizedState=Qe),T.props=p,T.state=Qe,T.context=ke,p=st):(typeof T.componentDidUpdate!="function"||W===s.memoizedProps&&Ke===s.memoizedState||(l.flags|=4),typeof T.getSnapshotBeforeUpdate!="function"||W===s.memoizedProps&&Ke===s.memoizedState||(l.flags|=1024),p=!1)}return T=p,Hp(s,l),p=(l.flags&128)!==0,T||p?(T=l.stateNode,f=p&&typeof f.getDerivedStateFromError!="function"?null:T.render(),l.flags|=1,s!==null&&p?(l.child=n0(l,s.child,null,y),l.child=n0(l,null,f,y)):Ea(s,l,f,y),l.memoizedState=T.state,s=l.child):s=zc(s,l,y),s}function O5(s,l,f,p){return cs(),l.flags|=256,Ea(s,l,f,p),l.child}var F2={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function O2(s){return{baseLanes:s,cachePool:Y()}}function P2(s,l,f){return s=s!==null?s.childLanes&~f:0,l&&(s|=Co),s}function P5(s,l,f){var p=l.pendingProps,y=!1,T=(l.flags&128)!==0,W;if((W=T)||(W=s!==null&&s.memoizedState===null?!1:($i.current&2)!==0),W&&(y=!0,l.flags&=-129),W=(l.flags&32)!==0,l.flags&=-33,s===null){if(en){if(y?Lu(l):Du(),en){var ue=Wn,ke;if(ke=ue){e:{for(ke=ue,ue=bo;ke.nodeType!==8;){if(!ue){ue=null;break e}if(ke=fl(ke.nextSibling),ke===null){ue=null;break e}}ue=ke}ue!==null?(l.memoizedState={dehydrated:ue,treeContext:Fc!==null?{id:tl,overflow:rl}:null,retryLane:536870912,hydrationErrors:null},ke=sa(18,null,null,0),ke.stateNode=ue,ke.return=l,l.child=ke,gi=l,Wn=null,ke=!0):ke=!1}ke||Pc(l)}if(ue=l.memoizedState,ue!==null&&(ue=ue.dehydrated,ue!==null))return xv(ue)?l.lanes=32:l.lanes=536870912,null;qc(l)}return ue=p.children,p=p.fallback,y?(Du(),y=l.mode,ue=Gp({mode:"hidden",children:ue},y),p=Zo(p,y,f,null),ue.return=l,p.return=l,ue.sibling=p,l.child=ue,y=l.child,y.memoizedState=O2(f),y.childLanes=P2(s,W,f),l.memoizedState=F2,p):(Lu(l),M2(l,ue))}if(ke=s.memoizedState,ke!==null&&(ue=ke.dehydrated,ue!==null)){if(T)l.flags&256?(Lu(l),l.flags&=-257,l=B2(s,l,f)):l.memoizedState!==null?(Du(),l.child=s.child,l.flags|=128,l=null):(Du(),y=p.fallback,ue=l.mode,p=Gp({mode:"visible",children:p.children},ue),y=Zo(y,ue,f,null),y.flags|=2,p.return=l,y.return=l,p.sibling=y,l.child=p,n0(l,s.child,null,f),p=l.child,p.memoizedState=O2(f),p.childLanes=P2(s,W,f),l.memoizedState=F2,l=y);else if(Lu(l),xv(ue)){if(W=ue.nextSibling&&ue.nextSibling.dataset,W)var Xe=W.dgst;W=Xe,p=Error(n(419)),p.stack="",p.digest=W,Au({value:p,source:null,stack:null}),l=B2(s,l,f)}else if(oa||Tu(s,l,f,!1),W=(f&s.childLanes)!==0,oa||W){if(W=Pn,W!==null&&(p=f&-f,p=(p&42)!==0?1:ea(p),p=(p&(W.suspendedLanes|f))!==0?0:p,p!==0&&p!==ke.retryLane))throw ke.retryLane=p,Jo(s,p),Qs(W,s,p),k5;ue.data==="$?"||rv(),l=B2(s,l,f)}else ue.data==="$?"?(l.flags|=192,l.child=s.child,l=null):(s=ke.treeContext,Wn=fl(ue.nextSibling),gi=l,en=!0,Gl=null,bo=!1,s!==null&&(As[ls++]=tl,As[ls++]=rl,As[ls++]=Fc,tl=s.id,rl=s.overflow,Fc=l),l=M2(l,p.children),l.flags|=4096);return l}return y?(Du(),y=p.fallback,ue=l.mode,ke=s.child,Xe=ke.sibling,p=Eo(ke,{mode:"hidden",children:p.children}),p.subtreeFlags=ke.subtreeFlags&65011712,Xe!==null?y=Eo(Xe,y):(y=Zo(y,ue,f,null),y.flags|=2),y.return=l,p.return=l,p.sibling=y,l.child=p,p=y,y=l.child,ue=s.child.memoizedState,ue===null?ue=O2(f):(ke=ue.cachePool,ke!==null?(Xe=_i._currentValue,ke=ke.parent!==Xe?{parent:Xe,pool:Xe}:ke):ke=Y(),ue={baseLanes:ue.baseLanes|f,cachePool:ke}),y.memoizedState=ue,y.childLanes=P2(s,W,f),l.memoizedState=F2,p):(Lu(l),f=s.child,s=f.sibling,f=Eo(f,{mode:"visible",children:p.children}),f.return=l,f.sibling=null,s!==null&&(W=l.deletions,W===null?(l.deletions=[s],l.flags|=16):W.push(s)),l.child=f,l.memoizedState=null,f)}function M2(s,l){return l=Gp({mode:"visible",children:l},s.mode),l.return=s,s.child=l}function Gp(s,l){return s=sa(22,s,null,l),s.lanes=0,s.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},s}function B2(s,l,f){return n0(l,s.child,null,f),s=M2(l,l.pendingProps.children),s.flags|=2,l.memoizedState=null,s}function M5(s,l,f){s.lanes|=l;var p=s.alternate;p!==null&&(p.lanes|=l),Wh(s.return,l,f)}function j2(s,l,f,p,y){var T=s.memoizedState;T===null?s.memoizedState={isBackwards:l,rendering:null,renderingStartTime:0,last:p,tail:f,tailMode:y}:(T.isBackwards=l,T.rendering=null,T.renderingStartTime=0,T.last=p,T.tail=f,T.tailMode=y)}function B5(s,l,f){var p=l.pendingProps,y=p.revealOrder,T=p.tail;if(Ea(s,l,p.children,f),p=$i.current,(p&2)!==0)p=p&1|2,l.flags|=128;else{if(s!==null&&(s.flags&128)!==0)e:for(s=l.child;s!==null;){if(s.tag===13)s.memoizedState!==null&&M5(s,f,l);else if(s.tag===19)M5(s,f,l);else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===l)break e;for(;s.sibling===null;){if(s.return===null||s.return===l)break e;s=s.return}s.sibling.return=s.return,s=s.sibling}p&=1}switch(j($i,p),y){case"forwards":for(f=l.child,y=null;f!==null;)s=f.alternate,s!==null&&Vp(s)===null&&(y=f),f=f.sibling;f=y,f===null?(y=l.child,l.child=null):(y=f.sibling,f.sibling=null),j2(l,!1,y,f,T);break;case"backwards":for(f=null,y=l.child,l.child=null;y!==null;){if(s=y.alternate,s!==null&&Vp(s)===null){l.child=y;break}s=y.sibling,y.sibling=f,f=y,y=s}j2(l,!0,f,null,T);break;case"together":j2(l,!1,null,null,void 0);break;default:l.memoizedState=null}return l.child}function zc(s,l,f){if(s!==null&&(l.dependencies=s.dependencies),Bu|=l.lanes,(f&l.childLanes)===0)if(s!==null){if(Tu(s,l,f,!1),(f&l.childLanes)===0)return null}else return null;if(s!==null&&l.child!==s.child)throw Error(n(153));if(l.child!==null){for(s=l.child,f=Eo(s,s.pendingProps),l.child=f,f.return=l;s.sibling!==null;)s=s.sibling,f=f.sibling=Eo(s,s.pendingProps),f.return=l;f.sibling=null}return l.child}function U2(s,l){return(s.lanes&l)!==0?!0:(s=s.dependencies,!!(s!==null&&Yh(s)))}function e8(s,l,f){switch(l.tag){case 3:_e(l,l.stateNode.containerInfo),Wl(l,_i,s.memoizedState.cache),cs();break;case 27:case 5:Ce(l);break;case 4:_e(l,l.stateNode.containerInfo);break;case 10:Wl(l,l.type,l.memoizedProps.value);break;case 13:var p=l.memoizedState;if(p!==null)return p.dehydrated!==null?(Lu(l),l.flags|=128,null):(f&l.child.childLanes)!==0?P5(s,l,f):(Lu(l),s=zc(s,l,f),s!==null?s.sibling:null);Lu(l);break;case 19:var y=(s.flags&128)!==0;if(p=(f&l.childLanes)!==0,p||(Tu(s,l,f,!1),p=(f&l.childLanes)!==0),y){if(p)return B5(s,l,f);l.flags|=128}if(y=l.memoizedState,y!==null&&(y.rendering=null,y.tail=null,y.lastEffect=null),j($i,$i.current),p)break;return null;case 22:case 23:return l.lanes=0,R5(s,l,f);case 24:Wl(l,_i,s.memoizedState.cache)}return zc(s,l,f)}function j5(s,l,f){if(s!==null)if(s.memoizedProps!==l.pendingProps)oa=!0;else{if(!U2(s,f)&&(l.flags&128)===0)return oa=!1,e8(s,l,f);oa=(s.flags&131072)!==0}else oa=!1,en&&(l.flags&1048576)!==0&&wp(l,Gh,l.index);switch(l.lanes=0,l.tag){case 16:e:{s=l.pendingProps;var p=l.elementType,y=p._init;if(p=y(p._payload),l.type=p,typeof p=="function")bu(p)?(s=eh(p,s),l.tag=1,l=F5(null,l,p,s,f)):(l.tag=0,l=D2(null,l,p,s,f));else{if(p!=null){if(y=p.$$typeof,y===Q){l.tag=11,l=N5(null,l,p,s,f);break e}else if(y===F){l.tag=14,l=C5(null,l,p,s,f);break e}}throw l=se(p)||p,Error(n(306,l,""))}}return l;case 0:return D2(s,l,l.type,l.pendingProps,f);case 1:return p=l.type,y=eh(p,l.pendingProps),F5(s,l,p,y,f);case 3:e:{if(_e(l,l.stateNode.containerInfo),s===null)throw Error(n(387));p=l.pendingProps;var T=l.memoizedState;y=T.element,De(s,l),Ot(l,p,null,f);var W=l.memoizedState;if(p=W.cache,Wl(l,_i,p),p!==T.cache&&Xh(l,[_i],f,!0),Yt(),p=W.element,T.isDehydrated)if(T={element:p,isDehydrated:!1,cache:W.cache},l.updateQueue.baseState=T,l.memoizedState=T,l.flags&256){l=O5(s,l,p,f);break e}else if(p!==y){y=Cr(Error(n(424)),l),Au(y),l=O5(s,l,p,f);break e}else{switch(s=l.stateNode.containerInfo,s.nodeType){case 9:s=s.body;break;default:s=s.nodeName==="HTML"?s.ownerDocument.body:s}for(Wn=fl(s.firstChild),gi=l,en=!0,Gl=null,bo=!0,f=v5(l,null,p,f),l.child=f;f;)f.flags=f.flags&-3|4096,f=f.sibling}else{if(cs(),p===y){l=zc(s,l,f);break e}Ea(s,l,p,f)}l=l.child}return l;case 26:return Hp(s,l),s===null?(f=zw(l.type,null,l.pendingProps,null))?l.memoizedState=f:en||(f=l.type,s=l.pendingProps,p=am(ae.current).createElement(f),p[Zr]=l,p[Hr]=s,Sa(p,f,s),Me(p),l.stateNode=p):l.memoizedState=zw(l.type,s.memoizedProps,l.pendingProps,s.memoizedState),null;case 27:return Ce(l),s===null&&en&&(p=l.stateNode=Uw(l.type,l.pendingProps,ae.current),gi=l,bo=!0,y=Wn,qu(l.type)?(yv=y,Wn=fl(p.firstChild)):Wn=y),Ea(s,l,l.pendingProps.children,f),Hp(s,l),s===null&&(l.flags|=4194304),l.child;case 5:return s===null&&en&&((y=p=Wn)&&(p=N8(p,l.type,l.pendingProps,bo),p!==null?(l.stateNode=p,gi=l,Wn=fl(p.firstChild),bo=!1,y=!0):y=!1),y||Pc(l)),Ce(l),y=l.type,T=l.pendingProps,W=s!==null?s.memoizedProps:null,p=T.children,gv(y,T)?p=null:W!==null&&gv(y,W)&&(l.flags|=32),l.memoizedState!==null&&(y=Gs(s,l,Kl,null,null,f),Wd._currentValue=y),Hp(s,l),Ea(s,l,p,f),l.child;case 6:return s===null&&en&&((s=f=Wn)&&(f=C8(f,l.pendingProps,bo),f!==null?(l.stateNode=f,gi=l,Wn=null,s=!0):s=!1),s||Pc(l)),null;case 13:return P5(s,l,f);case 4:return _e(l,l.stateNode.containerInfo),p=l.pendingProps,s===null?l.child=n0(l,null,p,f):Ea(s,l,p,f),l.child;case 11:return N5(s,l,l.type,l.pendingProps,f);case 7:return Ea(s,l,l.pendingProps,f),l.child;case 8:return Ea(s,l,l.pendingProps.children,f),l.child;case 12:return Ea(s,l,l.pendingProps.children,f),l.child;case 10:return p=l.pendingProps,Wl(l,l.type,p.value),Ea(s,l,p.children,f),l.child;case 9:return y=l.type._context,p=l.pendingProps.children,To(l),y=vi(y),p=p(y),l.flags|=1,Ea(s,l,p,f),l.child;case 14:return C5(s,l,l.type,l.pendingProps,f);case 15:return I5(s,l,l.type,l.pendingProps,f);case 19:return B5(s,l,f);case 31:return p=l.pendingProps,f=l.mode,p={mode:p.mode,children:p.children},s===null?(f=Gp(p,f),f.ref=l.ref,l.child=f,f.return=l,l=f):(f=Eo(s.child,p),f.ref=l.ref,l.child=f,f.return=l,l=f),l;case 22:return R5(s,l,f);case 24:return To(l),p=vi(_i),s===null?(y=D(),y===null&&(y=Pn,T=md(),y.pooledCache=T,T.refCount++,T!==null&&(y.pooledCacheLanes|=f),y=T),l.memoizedState={parent:p,cache:y},Re(l),Wl(l,_i,y)):((s.lanes&f)!==0&&(De(s,l),Ot(l,null,null,f),Yt()),y=s.memoizedState,T=l.memoizedState,y.parent!==p?(y={parent:p,cache:p},l.memoizedState=y,l.lanes===0&&(l.memoizedState=l.updateQueue.baseState=y),Wl(l,_i,p)):(p=T.cache,Wl(l,_i,p),p!==y.cache&&Xh(l,[_i],f,!0))),Ea(s,l,l.pendingProps.children,f),l.child;case 29:throw l.pendingProps}throw Error(n(156,l.tag))}function Hc(s){s.flags|=4}function U5(s,l){if(l.type!=="stylesheet"||(l.state.loading&4)!==0)s.flags&=-16777217;else if(s.flags|=16777216,!Yw(l)){if(l=No.current,l!==null&&((Kr&4194048)===Kr?Jl!==null:(Kr&62914560)!==Kr&&(Kr&536870912)===0||l!==Jl))throw qe=pe,ie;s.flags|=8192}}function Wp(s,l){l!==null&&(s.flags|=4),s.flags&16384&&(l=s.tag!==22?hn():536870912,s.lanes|=l,o0|=l)}function Rd(s,l){if(!en)switch(s.tailMode){case"hidden":l=s.tail;for(var f=null;l!==null;)l.alternate!==null&&(f=l),l=l.sibling;f===null?s.tail=null:f.sibling=null;break;case"collapsed":f=s.tail;for(var p=null;f!==null;)f.alternate!==null&&(p=f),f=f.sibling;p===null?l||s.tail===null?s.tail=null:s.tail.sibling=null:p.sibling=null}}function Zn(s){var l=s.alternate!==null&&s.alternate.child===s.child,f=0,p=0;if(l)for(var y=s.child;y!==null;)f|=y.lanes|y.childLanes,p|=y.subtreeFlags&65011712,p|=y.flags&65011712,y.return=s,y=y.sibling;else for(y=s.child;y!==null;)f|=y.lanes|y.childLanes,p|=y.subtreeFlags,p|=y.flags,y.return=s,y=y.sibling;return s.subtreeFlags|=p,s.childLanes=f,l}function t8(s,l,f){var p=l.pendingProps;switch(Vf(l),l.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Zn(l),null;case 1:return Zn(l),null;case 3:return f=l.stateNode,p=null,s!==null&&(p=s.memoizedState.cache),l.memoizedState.cache!==p&&(l.flags|=2048),Ao(_i),Ee(),f.pendingContext&&(f.context=f.pendingContext,f.pendingContext=null),(s===null||s.child===null)&&(ya(l)?Hc(l):s===null||s.memoizedState.isDehydrated&&(l.flags&256)===0||(l.flags|=1024,bp())),Zn(l),null;case 26:return f=l.memoizedState,s===null?(Hc(l),f!==null?(Zn(l),U5(l,f)):(Zn(l),l.flags&=-16777217)):f?f!==s.memoizedState?(Hc(l),Zn(l),U5(l,f)):(Zn(l),l.flags&=-16777217):(s.memoizedProps!==p&&Hc(l),Zn(l),l.flags&=-16777217),null;case 27:Oe(l),f=ae.current;var y=l.type;if(s!==null&&l.stateNode!=null)s.memoizedProps!==p&&Hc(l);else{if(!p){if(l.stateNode===null)throw Error(n(166));return Zn(l),null}s=z.current,ya(l)?Ep(l):(s=Uw(y,p,f),l.stateNode=s,Hc(l))}return Zn(l),null;case 5:if(Oe(l),f=l.type,s!==null&&l.stateNode!=null)s.memoizedProps!==p&&Hc(l);else{if(!p){if(l.stateNode===null)throw Error(n(166));return Zn(l),null}if(s=z.current,ya(l))Ep(l);else{switch(y=am(ae.current),s){case 1:s=y.createElementNS("http://www.w3.org/2000/svg",f);break;case 2:s=y.createElementNS("http://www.w3.org/1998/Math/MathML",f);break;default:switch(f){case"svg":s=y.createElementNS("http://www.w3.org/2000/svg",f);break;case"math":s=y.createElementNS("http://www.w3.org/1998/Math/MathML",f);break;case"script":s=y.createElement("div"),s.innerHTML="<script><\/script>",s=s.removeChild(s.firstChild);break;case"select":s=typeof p.is=="string"?y.createElement("select",{is:p.is}):y.createElement("select"),p.multiple?s.multiple=!0:p.size&&(s.size=p.size);break;default:s=typeof p.is=="string"?y.createElement(f,{is:p.is}):y.createElement(f)}}s[Zr]=l,s[Hr]=p;e:for(y=l.child;y!==null;){if(y.tag===5||y.tag===6)s.appendChild(y.stateNode);else if(y.tag!==4&&y.tag!==27&&y.child!==null){y.child.return=y,y=y.child;continue}if(y===l)break e;for(;y.sibling===null;){if(y.return===null||y.return===l)break e;y=y.return}y.sibling.return=y.return,y=y.sibling}l.stateNode=s;e:switch(Sa(s,f,p),f){case"button":case"input":case"select":case"textarea":s=!!p.autoFocus;break e;case"img":s=!0;break e;default:s=!1}s&&Hc(l)}}return Zn(l),l.flags&=-16777217,null;case 6:if(s&&l.stateNode!=null)s.memoizedProps!==p&&Hc(l);else{if(typeof p!="string"&&l.stateNode===null)throw Error(n(166));if(s=ae.current,ya(l)){if(s=l.stateNode,f=l.memoizedProps,p=null,y=gi,y!==null)switch(y.tag){case 27:case 5:p=y.memoizedProps}s[Zr]=l,s=!!(s.nodeValue===f||p!==null&&p.suppressHydrationWarning===!0||Dw(s.nodeValue,f)),s||Pc(l)}else s=am(s).createTextNode(p),s[Zr]=l,l.stateNode=s}return Zn(l),null;case 13:if(p=l.memoizedState,s===null||s.memoizedState!==null&&s.memoizedState.dehydrated!==null){if(y=ya(l),p!==null&&p.dehydrated!==null){if(s===null){if(!y)throw Error(n(318));if(y=l.memoizedState,y=y!==null?y.dehydrated:null,!y)throw Error(n(317));y[Zr]=l}else cs(),(l.flags&128)===0&&(l.memoizedState=null),l.flags|=4;Zn(l),y=!1}else y=bp(),s!==null&&s.memoizedState!==null&&(s.memoizedState.hydrationErrors=y),y=!0;if(!y)return l.flags&256?(qc(l),l):(qc(l),null)}if(qc(l),(l.flags&128)!==0)return l.lanes=f,l;if(f=p!==null,s=s!==null&&s.memoizedState!==null,f){p=l.child,y=null,p.alternate!==null&&p.alternate.memoizedState!==null&&p.alternate.memoizedState.cachePool!==null&&(y=p.alternate.memoizedState.cachePool.pool);var T=null;p.memoizedState!==null&&p.memoizedState.cachePool!==null&&(T=p.memoizedState.cachePool.pool),T!==y&&(p.flags|=2048)}return f!==s&&f&&(l.child.flags|=8192),Wp(l,l.updateQueue),Zn(l),null;case 4:return Ee(),s===null&&fv(l.stateNode.containerInfo),Zn(l),null;case 10:return Ao(l.type),Zn(l),null;case 19:if(L($i),y=l.memoizedState,y===null)return Zn(l),null;if(p=(l.flags&128)!==0,T=y.rendering,T===null)if(p)Rd(y,!1);else{if(li!==0||s!==null&&(s.flags&128)!==0)for(s=l.child;s!==null;){if(T=Vp(s),T!==null){for(l.flags|=128,Rd(y,!1),s=T.updateQueue,l.updateQueue=s,Wp(l,s),l.subtreeFlags=0,s=f,f=l.child;f!==null;)Bf(f,s),f=f.sibling;return j($i,$i.current&1|2),l.child}s=s.sibling}y.tail!==null&&Je()>Kp&&(l.flags|=128,p=!0,Rd(y,!1),l.lanes=4194304)}else{if(!p)if(s=Vp(T),s!==null){if(l.flags|=128,p=!0,s=s.updateQueue,l.updateQueue=s,Wp(l,s),Rd(y,!0),y.tail===null&&y.tailMode==="hidden"&&!T.alternate&&!en)return Zn(l),null}else 2*Je()-y.renderingStartTime>Kp&&f!==536870912&&(l.flags|=128,p=!0,Rd(y,!1),l.lanes=4194304);y.isBackwards?(T.sibling=l.child,l.child=T):(s=y.last,s!==null?s.sibling=T:l.child=T,y.last=T)}return y.tail!==null?(l=y.tail,y.rendering=l,y.tail=l.sibling,y.renderingStartTime=Je(),l.sibling=null,s=$i.current,j($i,p?s&1|2:s&1),l):(Zn(l),null);case 22:case 23:return qc(l),gr(),p=l.memoizedState!==null,s!==null?s.memoizedState!==null!==p&&(l.flags|=8192):p&&(l.flags|=8192),p?(f&536870912)!==0&&(l.flags&128)===0&&(Zn(l),l.subtreeFlags&6&&(l.flags|=8192)):Zn(l),f=l.updateQueue,f!==null&&Wp(l,f.retryQueue),f=null,s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(f=s.memoizedState.cachePool.pool),p=null,l.memoizedState!==null&&l.memoizedState.cachePool!==null&&(p=l.memoizedState.cachePool.pool),p!==f&&(l.flags|=2048),s!==null&&L(w),null;case 24:return f=null,s!==null&&(f=s.memoizedState.cache),l.memoizedState.cache!==f&&(l.flags|=2048),Ao(_i),Zn(l),null;case 25:return null;case 30:return null}throw Error(n(156,l.tag))}function r8(s,l){switch(Vf(l),l.tag){case 1:return s=l.flags,s&65536?(l.flags=s&-65537|128,l):null;case 3:return Ao(_i),Ee(),s=l.flags,(s&65536)!==0&&(s&128)===0?(l.flags=s&-65537|128,l):null;case 26:case 27:case 5:return Oe(l),null;case 13:if(qc(l),s=l.memoizedState,s!==null&&s.dehydrated!==null){if(l.alternate===null)throw Error(n(340));cs()}return s=l.flags,s&65536?(l.flags=s&-65537|128,l):null;case 19:return L($i),null;case 4:return Ee(),null;case 10:return Ao(l.type),null;case 22:case 23:return qc(l),gr(),s!==null&&L(w),s=l.flags,s&65536?(l.flags=s&-65537|128,l):null;case 24:return Ao(_i),null;case 25:return null;default:return null}}function V5(s,l){switch(Vf(l),l.tag){case 3:Ao(_i),Ee();break;case 26:case 27:case 5:Oe(l);break;case 4:Ee();break;case 13:qc(l);break;case 19:L($i);break;case 10:Ao(l.type);break;case 22:case 23:qc(l),gr(),s!==null&&L(w);break;case 24:Ao(_i)}}function Ld(s,l){try{var f=l.updateQueue,p=f!==null?f.lastEffect:null;if(p!==null){var y=p.next;f=y;do{if((f.tag&s)===s){p=void 0;var T=f.create,W=f.inst;p=T(),W.destroy=p}f=f.next}while(f!==y)}}catch(ue){Rn(l,l.return,ue)}}function Fu(s,l,f){try{var p=l.updateQueue,y=p!==null?p.lastEffect:null;if(y!==null){var T=y.next;p=T;do{if((p.tag&s)===s){var W=p.inst,ue=W.destroy;if(ue!==void 0){W.destroy=void 0,y=l;var ke=f,Xe=ue;try{Xe()}catch(st){Rn(y,ke,st)}}}p=p.next}while(p!==T)}}catch(st){Rn(l,l.return,st)}}function q5(s){var l=s.updateQueue;if(l!==null){var f=s.stateNode;try{sn(l,f)}catch(p){Rn(s,s.return,p)}}}function z5(s,l,f){f.props=eh(s.type,s.memoizedProps),f.state=s.memoizedState;try{f.componentWillUnmount()}catch(p){Rn(s,l,p)}}function Dd(s,l){try{var f=s.ref;if(f!==null){switch(s.tag){case 26:case 27:case 5:var p=s.stateNode;break;case 30:p=s.stateNode;break;default:p=s.stateNode}typeof f=="function"?s.refCleanup=f(p):f.current=p}}catch(y){Rn(s,l,y)}}function Zl(s,l){var f=s.ref,p=s.refCleanup;if(f!==null)if(typeof p=="function")try{p()}catch(y){Rn(s,l,y)}finally{s.refCleanup=null,s=s.alternate,s!=null&&(s.refCleanup=null)}else if(typeof f=="function")try{f(null)}catch(y){Rn(s,l,y)}else f.current=null}function H5(s){var l=s.type,f=s.memoizedProps,p=s.stateNode;try{e:switch(l){case"button":case"input":case"select":case"textarea":f.autoFocus&&p.focus();break e;case"img":f.src?p.src=f.src:f.srcSet&&(p.srcset=f.srcSet)}}catch(y){Rn(s,s.return,y)}}function V2(s,l,f){try{var p=s.stateNode;b8(p,s.type,f,l),p[Hr]=l}catch(y){Rn(s,s.return,y)}}function G5(s){return s.tag===5||s.tag===3||s.tag===26||s.tag===27&&qu(s.type)||s.tag===4}function q2(s){e:for(;;){for(;s.sibling===null;){if(s.return===null||G5(s.return))return null;s=s.return}for(s.sibling.return=s.return,s=s.sibling;s.tag!==5&&s.tag!==6&&s.tag!==18;){if(s.tag===27&&qu(s.type)||s.flags&2||s.child===null||s.tag===4)continue e;s.child.return=s,s=s.child}if(!(s.flags&2))return s.stateNode}}function z2(s,l,f){var p=s.tag;if(p===5||p===6)s=s.stateNode,l?(f.nodeType===9?f.body:f.nodeName==="HTML"?f.ownerDocument.body:f).insertBefore(s,l):(l=f.nodeType===9?f.body:f.nodeName==="HTML"?f.ownerDocument.body:f,l.appendChild(s),f=f._reactRootContainer,f!=null||l.onclick!==null||(l.onclick=im));else if(p!==4&&(p===27&&qu(s.type)&&(f=s.stateNode,l=null),s=s.child,s!==null))for(z2(s,l,f),s=s.sibling;s!==null;)z2(s,l,f),s=s.sibling}function Xp(s,l,f){var p=s.tag;if(p===5||p===6)s=s.stateNode,l?f.insertBefore(s,l):f.appendChild(s);else if(p!==4&&(p===27&&qu(s.type)&&(f=s.stateNode),s=s.child,s!==null))for(Xp(s,l,f),s=s.sibling;s!==null;)Xp(s,l,f),s=s.sibling}function W5(s){var l=s.stateNode,f=s.memoizedProps;try{for(var p=s.type,y=l.attributes;y.length;)l.removeAttributeNode(y[0]);Sa(l,p,f),l[Zr]=s,l[Hr]=f}catch(T){Rn(s,s.return,T)}}var Gc=!1,yi=!1,H2=!1,X5=typeof WeakSet=="function"?WeakSet:Set,la=null;function n8(s,l){if(s=s.containerInfo,pv=fm,s=xa(s),Ki(s)){if("selectionStart"in s)var f={start:s.selectionStart,end:s.selectionEnd};else e:{f=(f=s.ownerDocument)&&f.defaultView||window;var p=f.getSelection&&f.getSelection();if(p&&p.rangeCount!==0){f=p.anchorNode;var y=p.anchorOffset,T=p.focusNode;p=p.focusOffset;try{f.nodeType,T.nodeType}catch{f=null;break e}var W=0,ue=-1,ke=-1,Xe=0,st=0,mt=s,Ke=null;t:for(;;){for(var Qe;mt!==f||y!==0&&mt.nodeType!==3||(ue=W+y),mt!==T||p!==0&&mt.nodeType!==3||(ke=W+p),mt.nodeType===3&&(W+=mt.nodeValue.length),(Qe=mt.firstChild)!==null;)Ke=mt,mt=Qe;for(;;){if(mt===s)break t;if(Ke===f&&++Xe===y&&(ue=W),Ke===T&&++st===p&&(ke=W),(Qe=mt.nextSibling)!==null)break;mt=Ke,Ke=mt.parentNode}mt=Qe}f=ue===-1||ke===-1?null:{start:ue,end:ke}}else f=null}f=f||{start:0,end:0}}else f=null;for(mv={focusedElem:s,selectionRange:f},fm=!1,la=l;la!==null;)if(l=la,s=l.child,(l.subtreeFlags&1024)!==0&&s!==null)s.return=l,la=s;else for(;la!==null;){switch(l=la,T=l.alternate,s=l.flags,l.tag){case 0:break;case 11:case 15:break;case 1:if((s&1024)!==0&&T!==null){s=void 0,f=l,y=T.memoizedProps,T=T.memoizedState,p=f.stateNode;try{var dr=eh(f.type,y,f.elementType===f.type);s=p.getSnapshotBeforeUpdate(dr,T),p.__reactInternalSnapshotBeforeUpdate=s}catch(nr){Rn(f,f.return,nr)}}break;case 3:if((s&1024)!==0){if(s=l.stateNode.containerInfo,f=s.nodeType,f===9)_v(s);else if(f===1)switch(s.nodeName){case"HEAD":case"HTML":case"BODY":_v(s);break;default:s.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((s&1024)!==0)throw Error(n(163))}if(s=l.sibling,s!==null){s.return=l.return,la=s;break}la=l.return}}function Y5(s,l,f){var p=f.flags;switch(f.tag){case 0:case 11:case 15:Ou(s,f),p&4&&Ld(5,f);break;case 1:if(Ou(s,f),p&4)if(s=f.stateNode,l===null)try{s.componentDidMount()}catch(W){Rn(f,f.return,W)}else{var y=eh(f.type,l.memoizedProps);l=l.memoizedState;try{s.componentDidUpdate(y,l,s.__reactInternalSnapshotBeforeUpdate)}catch(W){Rn(f,f.return,W)}}p&64&&q5(f),p&512&&Dd(f,f.return);break;case 3:if(Ou(s,f),p&64&&(s=f.updateQueue,s!==null)){if(l=null,f.child!==null)switch(f.child.tag){case 27:case 5:l=f.child.stateNode;break;case 1:l=f.child.stateNode}try{sn(s,l)}catch(W){Rn(f,f.return,W)}}break;case 27:l===null&&p&4&&W5(f);case 26:case 5:Ou(s,f),l===null&&p&4&&H5(f),p&512&&Dd(f,f.return);break;case 12:Ou(s,f);break;case 13:Ou(s,f),p&4&&Q5(s,f),p&64&&(s=f.memoizedState,s!==null&&(s=s.dehydrated,s!==null&&(f=h8.bind(null,f),I8(s,f))));break;case 22:if(p=f.memoizedState!==null||Gc,!p){l=l!==null&&l.memoizedState!==null||yi,y=Gc;var T=yi;Gc=p,(yi=l)&&!T?Pu(s,f,(f.subtreeFlags&8772)!==0):Ou(s,f),Gc=y,yi=T}break;case 30:break;default:Ou(s,f)}}function K5(s){var l=s.alternate;l!==null&&(s.alternate=null,K5(l)),s.child=null,s.deletions=null,s.sibling=null,s.tag===5&&(l=s.stateNode,l!==null&&ve(l)),s.stateNode=null,s.return=null,s.dependencies=null,s.memoizedProps=null,s.memoizedState=null,s.pendingProps=null,s.stateNode=null,s.updateQueue=null}var Xn=null,ks=!1;function Wc(s,l,f){for(f=f.child;f!==null;)$5(s,l,f),f=f.sibling}function $5(s,l,f){if(kt&&typeof kt.onCommitFiberUnmount=="function")try{kt.onCommitFiberUnmount(Tt,f)}catch{}switch(f.tag){case 26:yi||Zl(f,l),Wc(s,l,f),f.memoizedState?f.memoizedState.count--:f.stateNode&&(f=f.stateNode,f.parentNode.removeChild(f));break;case 27:yi||Zl(f,l);var p=Xn,y=ks;qu(f.type)&&(Xn=f.stateNode,ks=!1),Wc(s,l,f),qd(f.stateNode),Xn=p,ks=y;break;case 5:yi||Zl(f,l);case 6:if(p=Xn,y=ks,Xn=null,Wc(s,l,f),Xn=p,ks=y,Xn!==null)if(ks)try{(Xn.nodeType===9?Xn.body:Xn.nodeName==="HTML"?Xn.ownerDocument.body:Xn).removeChild(f.stateNode)}catch(T){Rn(f,l,T)}else try{Xn.removeChild(f.stateNode)}catch(T){Rn(f,l,T)}break;case 18:Xn!==null&&(ks?(s=Xn,Bw(s.nodeType===9?s.body:s.nodeName==="HTML"?s.ownerDocument.body:s,f.stateNode),$d(s)):Bw(Xn,f.stateNode));break;case 4:p=Xn,y=ks,Xn=f.stateNode.containerInfo,ks=!0,Wc(s,l,f),Xn=p,ks=y;break;case 0:case 11:case 14:case 15:yi||Fu(2,f,l),yi||Fu(4,f,l),Wc(s,l,f);break;case 1:yi||(Zl(f,l),p=f.stateNode,typeof p.componentWillUnmount=="function"&&z5(f,l,p)),Wc(s,l,f);break;case 21:Wc(s,l,f);break;case 22:yi=(p=yi)||f.memoizedState!==null,Wc(s,l,f),yi=p;break;default:Wc(s,l,f)}}function Q5(s,l){if(l.memoizedState===null&&(s=l.alternate,s!==null&&(s=s.memoizedState,s!==null&&(s=s.dehydrated,s!==null))))try{$d(s)}catch(f){Rn(l,l.return,f)}}function i8(s){switch(s.tag){case 13:case 19:var l=s.stateNode;return l===null&&(l=s.stateNode=new X5),l;case 22:return s=s.stateNode,l=s._retryCache,l===null&&(l=s._retryCache=new X5),l;default:throw Error(n(435,s.tag))}}function G2(s,l){var f=i8(s);l.forEach(function(p){var y=d8.bind(null,s,p);f.has(p)||(f.add(p),p.then(y,y))})}function Xs(s,l){var f=l.deletions;if(f!==null)for(var p=0;p<f.length;p++){var y=f[p],T=s,W=l,ue=W;e:for(;ue!==null;){switch(ue.tag){case 27:if(qu(ue.type)){Xn=ue.stateNode,ks=!1;break e}break;case 5:Xn=ue.stateNode,ks=!1;break e;case 3:case 4:Xn=ue.stateNode.containerInfo,ks=!0;break e}ue=ue.return}if(Xn===null)throw Error(n(160));$5(T,W,y),Xn=null,ks=!1,T=y.alternate,T!==null&&(T.return=null),y.return=null}if(l.subtreeFlags&13878)for(l=l.child;l!==null;)J5(l,s),l=l.sibling}var ul=null;function J5(s,l){var f=s.alternate,p=s.flags;switch(s.tag){case 0:case 11:case 14:case 15:Xs(l,s),Ys(s),p&4&&(Fu(3,s,s.return),Ld(3,s),Fu(5,s,s.return));break;case 1:Xs(l,s),Ys(s),p&512&&(yi||f===null||Zl(f,f.return)),p&64&&Gc&&(s=s.updateQueue,s!==null&&(p=s.callbacks,p!==null&&(f=s.shared.hiddenCallbacks,s.shared.hiddenCallbacks=f===null?p:f.concat(p))));break;case 26:var y=ul;if(Xs(l,s),Ys(s),p&512&&(yi||f===null||Zl(f,f.return)),p&4){var T=f!==null?f.memoizedState:null;if(p=s.memoizedState,f===null)if(p===null)if(s.stateNode===null){e:{p=s.type,f=s.memoizedProps,y=y.ownerDocument||y;t:switch(p){case"title":T=y.getElementsByTagName("title")[0],(!T||T[me]||T[Zr]||T.namespaceURI==="http://www.w3.org/2000/svg"||T.hasAttribute("itemprop"))&&(T=y.createElement(p),y.head.insertBefore(T,y.querySelector("head > title"))),Sa(T,p,f),T[Zr]=s,Me(T),p=T;break e;case"link":var W=Ww("link","href",y).get(p+(f.href||""));if(W){for(var ue=0;ue<W.length;ue++)if(T=W[ue],T.getAttribute("href")===(f.href==null||f.href===""?null:f.href)&&T.getAttribute("rel")===(f.rel==null?null:f.rel)&&T.getAttribute("title")===(f.title==null?null:f.title)&&T.getAttribute("crossorigin")===(f.crossOrigin==null?null:f.crossOrigin)){W.splice(ue,1);break t}}T=y.createElement(p),Sa(T,p,f),y.head.appendChild(T);break;case"meta":if(W=Ww("meta","content",y).get(p+(f.content||""))){for(ue=0;ue<W.length;ue++)if(T=W[ue],T.getAttribute("content")===(f.content==null?null:""+f.content)&&T.getAttribute("name")===(f.name==null?null:f.name)&&T.getAttribute("property")===(f.property==null?null:f.property)&&T.getAttribute("http-equiv")===(f.httpEquiv==null?null:f.httpEquiv)&&T.getAttribute("charset")===(f.charSet==null?null:f.charSet)){W.splice(ue,1);break t}}T=y.createElement(p),Sa(T,p,f),y.head.appendChild(T);break;default:throw Error(n(468,p))}T[Zr]=s,Me(T),p=T}s.stateNode=p}else Xw(y,s.type,s.stateNode);else s.stateNode=Gw(y,p,s.memoizedProps);else T!==p?(T===null?f.stateNode!==null&&(f=f.stateNode,f.parentNode.removeChild(f)):T.count--,p===null?Xw(y,s.type,s.stateNode):Gw(y,p,s.memoizedProps)):p===null&&s.stateNode!==null&&V2(s,s.memoizedProps,f.memoizedProps)}break;case 27:Xs(l,s),Ys(s),p&512&&(yi||f===null||Zl(f,f.return)),f!==null&&p&4&&V2(s,s.memoizedProps,f.memoizedProps);break;case 5:if(Xs(l,s),Ys(s),p&512&&(yi||f===null||Zl(f,f.return)),s.flags&32){y=s.stateNode;try{La(y,"")}catch(Qe){Rn(s,s.return,Qe)}}p&4&&s.stateNode!=null&&(y=s.memoizedProps,V2(s,y,f!==null?f.memoizedProps:y)),p&1024&&(H2=!0);break;case 6:if(Xs(l,s),Ys(s),p&4){if(s.stateNode===null)throw Error(n(162));p=s.memoizedProps,f=s.stateNode;try{f.nodeValue=p}catch(Qe){Rn(s,s.return,Qe)}}break;case 3:if(lm=null,y=ul,ul=sm(l.containerInfo),Xs(l,s),ul=y,Ys(s),p&4&&f!==null&&f.memoizedState.isDehydrated)try{$d(l.containerInfo)}catch(Qe){Rn(s,s.return,Qe)}H2&&(H2=!1,Z5(s));break;case 4:p=ul,ul=sm(s.stateNode.containerInfo),Xs(l,s),Ys(s),ul=p;break;case 12:Xs(l,s),Ys(s);break;case 13:Xs(l,s),Ys(s),s.child.flags&8192&&s.memoizedState!==null!=(f!==null&&f.memoizedState!==null)&&(Q2=Je()),p&4&&(p=s.updateQueue,p!==null&&(s.updateQueue=null,G2(s,p)));break;case 22:y=s.memoizedState!==null;var ke=f!==null&&f.memoizedState!==null,Xe=Gc,st=yi;if(Gc=Xe||y,yi=st||ke,Xs(l,s),yi=st,Gc=Xe,Ys(s),p&8192)e:for(l=s.stateNode,l._visibility=y?l._visibility&-2:l._visibility|1,y&&(f===null||ke||Gc||yi||th(s)),f=null,l=s;;){if(l.tag===5||l.tag===26){if(f===null){ke=f=l;try{if(T=ke.stateNode,y)W=T.style,typeof W.setProperty=="function"?W.setProperty("display","none","important"):W.display="none";else{ue=ke.stateNode;var mt=ke.memoizedProps.style,Ke=mt!=null&&mt.hasOwnProperty("display")?mt.display:null;ue.style.display=Ke==null||typeof Ke=="boolean"?"":(""+Ke).trim()}}catch(Qe){Rn(ke,ke.return,Qe)}}}else if(l.tag===6){if(f===null){ke=l;try{ke.stateNode.nodeValue=y?"":ke.memoizedProps}catch(Qe){Rn(ke,ke.return,Qe)}}}else if((l.tag!==22&&l.tag!==23||l.memoizedState===null||l===s)&&l.child!==null){l.child.return=l,l=l.child;continue}if(l===s)break e;for(;l.sibling===null;){if(l.return===null||l.return===s)break e;f===l&&(f=null),l=l.return}f===l&&(f=null),l.sibling.return=l.return,l=l.sibling}p&4&&(p=s.updateQueue,p!==null&&(f=p.retryQueue,f!==null&&(p.retryQueue=null,G2(s,f))));break;case 19:Xs(l,s),Ys(s),p&4&&(p=s.updateQueue,p!==null&&(s.updateQueue=null,G2(s,p)));break;case 30:break;case 21:break;default:Xs(l,s),Ys(s)}}function Ys(s){var l=s.flags;if(l&2){try{for(var f,p=s.return;p!==null;){if(G5(p)){f=p;break}p=p.return}if(f==null)throw Error(n(160));switch(f.tag){case 27:var y=f.stateNode,T=q2(s);Xp(s,T,y);break;case 5:var W=f.stateNode;f.flags&32&&(La(W,""),f.flags&=-33);var ue=q2(s);Xp(s,ue,W);break;case 3:case 4:var ke=f.stateNode.containerInfo,Xe=q2(s);z2(s,Xe,ke);break;default:throw Error(n(161))}}catch(st){Rn(s,s.return,st)}s.flags&=-3}l&4096&&(s.flags&=-4097)}function Z5(s){if(s.subtreeFlags&1024)for(s=s.child;s!==null;){var l=s;Z5(l),l.tag===5&&l.flags&1024&&l.stateNode.reset(),s=s.sibling}}function Ou(s,l){if(l.subtreeFlags&8772)for(l=l.child;l!==null;)Y5(s,l.alternate,l),l=l.sibling}function th(s){for(s=s.child;s!==null;){var l=s;switch(l.tag){case 0:case 11:case 14:case 15:Fu(4,l,l.return),th(l);break;case 1:Zl(l,l.return);var f=l.stateNode;typeof f.componentWillUnmount=="function"&&z5(l,l.return,f),th(l);break;case 27:qd(l.stateNode);case 26:case 5:Zl(l,l.return),th(l);break;case 22:l.memoizedState===null&&th(l);break;case 30:th(l);break;default:th(l)}s=s.sibling}}function Pu(s,l,f){for(f=f&&(l.subtreeFlags&8772)!==0,l=l.child;l!==null;){var p=l.alternate,y=s,T=l,W=T.flags;switch(T.tag){case 0:case 11:case 15:Pu(y,T,f),Ld(4,T);break;case 1:if(Pu(y,T,f),p=T,y=p.stateNode,typeof y.componentDidMount=="function")try{y.componentDidMount()}catch(Xe){Rn(p,p.return,Xe)}if(p=T,y=p.updateQueue,y!==null){var ue=p.stateNode;try{var ke=y.shared.hiddenCallbacks;if(ke!==null)for(y.shared.hiddenCallbacks=null,y=0;y<ke.length;y++)Xr(ke[y],ue)}catch(Xe){Rn(p,p.return,Xe)}}f&&W&64&&q5(T),Dd(T,T.return);break;case 27:W5(T);case 26:case 5:Pu(y,T,f),f&&p===null&&W&4&&H5(T),Dd(T,T.return);break;case 12:Pu(y,T,f);break;case 13:Pu(y,T,f),f&&W&4&&Q5(y,T);break;case 22:T.memoizedState===null&&Pu(y,T,f),Dd(T,T.return);break;case 30:break;default:Pu(y,T,f)}l=l.sibling}}function W2(s,l){var f=null;s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(f=s.memoizedState.cachePool.pool),s=null,l.memoizedState!==null&&l.memoizedState.cachePool!==null&&(s=l.memoizedState.cachePool.pool),s!==f&&(s!=null&&s.refCount++,f!=null&&qf(f))}function X2(s,l){s=null,l.alternate!==null&&(s=l.alternate.memoizedState.cache),l=l.memoizedState.cache,l!==s&&(l.refCount++,s!=null&&qf(s))}function ec(s,l,f,p){if(l.subtreeFlags&10256)for(l=l.child;l!==null;)ew(s,l,f,p),l=l.sibling}function ew(s,l,f,p){var y=l.flags;switch(l.tag){case 0:case 11:case 15:ec(s,l,f,p),y&2048&&Ld(9,l);break;case 1:ec(s,l,f,p);break;case 3:ec(s,l,f,p),y&2048&&(s=null,l.alternate!==null&&(s=l.alternate.memoizedState.cache),l=l.memoizedState.cache,l!==s&&(l.refCount++,s!=null&&qf(s)));break;case 12:if(y&2048){ec(s,l,f,p),s=l.stateNode;try{var T=l.memoizedProps,W=T.id,ue=T.onPostCommit;typeof ue=="function"&&ue(W,l.alternate===null?"mount":"update",s.passiveEffectDuration,-0)}catch(ke){Rn(l,l.return,ke)}}else ec(s,l,f,p);break;case 13:ec(s,l,f,p);break;case 23:break;case 22:T=l.stateNode,W=l.alternate,l.memoizedState!==null?T._visibility&2?ec(s,l,f,p):Fd(s,l):T._visibility&2?ec(s,l,f,p):(T._visibility|=2,i0(s,l,f,p,(l.subtreeFlags&10256)!==0)),y&2048&&W2(W,l);break;case 24:ec(s,l,f,p),y&2048&&X2(l.alternate,l);break;default:ec(s,l,f,p)}}function i0(s,l,f,p,y){for(y=y&&(l.subtreeFlags&10256)!==0,l=l.child;l!==null;){var T=s,W=l,ue=f,ke=p,Xe=W.flags;switch(W.tag){case 0:case 11:case 15:i0(T,W,ue,ke,y),Ld(8,W);break;case 23:break;case 22:var st=W.stateNode;W.memoizedState!==null?st._visibility&2?i0(T,W,ue,ke,y):Fd(T,W):(st._visibility|=2,i0(T,W,ue,ke,y)),y&&Xe&2048&&W2(W.alternate,W);break;case 24:i0(T,W,ue,ke,y),y&&Xe&2048&&X2(W.alternate,W);break;default:i0(T,W,ue,ke,y)}l=l.sibling}}function Fd(s,l){if(l.subtreeFlags&10256)for(l=l.child;l!==null;){var f=s,p=l,y=p.flags;switch(p.tag){case 22:Fd(f,p),y&2048&&W2(p.alternate,p);break;case 24:Fd(f,p),y&2048&&X2(p.alternate,p);break;default:Fd(f,p)}l=l.sibling}}var Od=8192;function a0(s){if(s.subtreeFlags&Od)for(s=s.child;s!==null;)tw(s),s=s.sibling}function tw(s){switch(s.tag){case 26:a0(s),s.flags&Od&&s.memoizedState!==null&&z8(ul,s.memoizedState,s.memoizedProps);break;case 5:a0(s);break;case 3:case 4:var l=ul;ul=sm(s.stateNode.containerInfo),a0(s),ul=l;break;case 22:s.memoizedState===null&&(l=s.alternate,l!==null&&l.memoizedState!==null?(l=Od,Od=16777216,a0(s),Od=l):a0(s));break;default:a0(s)}}function rw(s){var l=s.alternate;if(l!==null&&(s=l.child,s!==null)){l.child=null;do l=s.sibling,s.sibling=null,s=l;while(s!==null)}}function Pd(s){var l=s.deletions;if((s.flags&16)!==0){if(l!==null)for(var f=0;f<l.length;f++){var p=l[f];la=p,iw(p,s)}rw(s)}if(s.subtreeFlags&10256)for(s=s.child;s!==null;)nw(s),s=s.sibling}function nw(s){switch(s.tag){case 0:case 11:case 15:Pd(s),s.flags&2048&&Fu(9,s,s.return);break;case 3:Pd(s);break;case 12:Pd(s);break;case 22:var l=s.stateNode;s.memoizedState!==null&&l._visibility&2&&(s.return===null||s.return.tag!==13)?(l._visibility&=-3,Yp(s)):Pd(s);break;default:Pd(s)}}function Yp(s){var l=s.deletions;if((s.flags&16)!==0){if(l!==null)for(var f=0;f<l.length;f++){var p=l[f];la=p,iw(p,s)}rw(s)}for(s=s.child;s!==null;){switch(l=s,l.tag){case 0:case 11:case 15:Fu(8,l,l.return),Yp(l);break;case 22:f=l.stateNode,f._visibility&2&&(f._visibility&=-3,Yp(l));break;default:Yp(l)}s=s.sibling}}function iw(s,l){for(;la!==null;){var f=la;switch(f.tag){case 0:case 11:case 15:Fu(8,f,l);break;case 23:case 22:if(f.memoizedState!==null&&f.memoizedState.cachePool!==null){var p=f.memoizedState.cachePool.pool;p!=null&&p.refCount++}break;case 24:qf(f.memoizedState.cache)}if(p=f.child,p!==null)p.return=f,la=p;else e:for(f=s;la!==null;){p=la;var y=p.sibling,T=p.return;if(K5(p),p===f){la=null;break e}if(y!==null){y.return=T,la=y;break e}la=T}}}var a8={getCacheForType:function(s){var l=vi(_i),f=l.data.get(s);return f===void 0&&(f=s(),l.data.set(s,f)),f}},s8=typeof WeakMap=="function"?WeakMap:Map,xn=0,Pn=null,jr=null,Kr=0,yn=0,Ks=null,Mu=!1,s0=!1,Y2=!1,Xc=0,li=0,Bu=0,rh=0,K2=0,Co=0,o0=0,Md=null,Ns=null,$2=!1,Q2=0,Kp=1/0,$p=null,ju=null,ba=0,Uu=null,l0=null,c0=0,J2=0,Z2=null,aw=null,Bd=0,ev=null;function $s(){if((xn&2)!==0&&Kr!==0)return Kr&-Kr;if(J.T!==null){var s=Mc;return s!==0?s:ov()}return pi()}function sw(){Co===0&&(Co=(Kr&536870912)===0||en?Ra():536870912);var s=No.current;return s!==null&&(s.flags|=32),Co}function Qs(s,l,f){(s===Pn&&(yn===2||yn===9)||s.cancelPendingCommit!==null)&&(u0(s,0),Vu(s,Kr,Co,!1)),di(s,f),((xn&2)===0||s!==Pn)&&(s===Pn&&((xn&2)===0&&(rh|=f),li===4&&Vu(s,Kr,Co,!1)),tc(s))}function ow(s,l,f){if((xn&6)!==0)throw Error(n(327));var p=!f&&(l&124)===0&&(l&s.expiredLanes)===0||Ii(s,l),y=p?c8(s,l):nv(s,l,!0),T=p;do{if(y===0){s0&&!p&&Vu(s,l,0,!1);break}else{if(f=s.current.alternate,T&&!o8(f)){y=nv(s,l,!1),T=!1;continue}if(y===2){if(T=l,s.errorRecoveryDisabledLanes&T)var W=0;else W=s.pendingLanes&-536870913,W=W!==0?W:W&536870912?536870912:0;if(W!==0){l=W;e:{var ue=s;y=Md;var ke=ue.current.memoizedState.isDehydrated;if(ke&&(u0(ue,W).flags|=256),W=nv(ue,W,!1),W!==2){if(Y2&&!ke){ue.errorRecoveryDisabledLanes|=T,rh|=T,y=4;break e}T=Ns,Ns=y,T!==null&&(Ns===null?Ns=T:Ns.push.apply(Ns,T))}y=W}if(T=!1,y!==2)continue}}if(y===1){u0(s,0),Vu(s,l,0,!0);break}e:{switch(p=s,T=y,T){case 0:case 1:throw Error(n(345));case 4:if((l&4194048)!==l)break;case 6:Vu(p,l,Co,!Mu);break e;case 2:Ns=null;break;case 3:case 5:break;default:throw Error(n(329))}if((l&62914560)===l&&(y=Q2+300-Je(),10<y)){if(Vu(p,l,Co,!Mu),Qr(p,0,!0)!==0)break e;p.timeoutHandle=Pw(lw.bind(null,p,f,Ns,$p,$2,l,Co,rh,o0,Mu,T,2,-0,0),y);break e}lw(p,f,Ns,$p,$2,l,Co,rh,o0,Mu,T,0,-0,0)}}break}while(!0);tc(s)}function lw(s,l,f,p,y,T,W,ue,ke,Xe,st,mt,Ke,Qe){if(s.timeoutHandle=-1,mt=l.subtreeFlags,(mt&8192||(mt&16785408)===16785408)&&(Gd={stylesheets:null,count:0,unsuspend:q8},tw(l),mt=H8(),mt!==null)){s.cancelPendingCommit=mt(mw.bind(null,s,l,T,f,p,y,W,ue,ke,st,1,Ke,Qe)),Vu(s,T,W,!Xe);return}mw(s,l,T,f,p,y,W,ue,ke)}function o8(s){for(var l=s;;){var f=l.tag;if((f===0||f===11||f===15)&&l.flags&16384&&(f=l.updateQueue,f!==null&&(f=f.stores,f!==null)))for(var p=0;p<f.length;p++){var y=f[p],T=y.getSnapshot;y=y.value;try{if(!Di(T(),y))return!1}catch{return!1}}if(f=l.child,l.subtreeFlags&16384&&f!==null)f.return=l,l=f;else{if(l===s)break;for(;l.sibling===null;){if(l.return===null||l.return===s)return!0;l=l.return}l.sibling.return=l.return,l=l.sibling}}return!0}function Vu(s,l,f,p){l&=~K2,l&=~rh,s.suspendedLanes|=l,s.pingedLanes&=~l,p&&(s.warmLanes|=l),p=s.expirationTimes;for(var y=l;0<y;){var T=31-Pt(y),W=1<<T;p[T]=-1,y&=~W}f!==0&&Kt(s,f,l)}function Qp(){return(xn&6)===0?(jd(0),!1):!0}function tv(){if(jr!==null){if(yn===0)var s=jr.return;else s=jr,il=Oi=null,$h(s),r0=null,Cd=0,s=jr;for(;s!==null;)V5(s.alternate,s),s=s.return;jr=null}}function u0(s,l){var f=s.timeoutHandle;f!==-1&&(s.timeoutHandle=-1,A8(f)),f=s.cancelPendingCommit,f!==null&&(s.cancelPendingCommit=null,f()),tv(),Pn=s,jr=f=Eo(s.current,null),Kr=l,yn=0,Ks=null,Mu=!1,s0=Ii(s,l),Y2=!1,o0=Co=K2=rh=Bu=li=0,Ns=Md=null,$2=!1,(l&8)!==0&&(l|=l&32);var p=s.entangledLanes;if(p!==0)for(s=s.entanglements,p&=l;0<p;){var y=31-Pt(p),T=1<<y;l|=s[y],p&=~T}return Xc=l,bs(),f}function cw(s,l){Zt=null,J.H=Bp,l===re||l===le?(l=je(),yn=3):l===ie?(l=je(),yn=4):yn=l===k5?8:l!==null&&typeof l=="object"&&typeof l.then=="function"?6:1,Ks=l,jr===null&&(li=1,zp(s,Cr(l,s.current)))}function uw(){var s=J.H;return J.H=Bp,s===null?Bp:s}function fw(){var s=J.A;return J.A=a8,s}function rv(){li=4,Mu||(Kr&4194048)!==Kr&&No.current!==null||(s0=!0),(Bu&134217727)===0&&(rh&134217727)===0||Pn===null||Vu(Pn,Kr,Co,!1)}function nv(s,l,f){var p=xn;xn|=2;var y=uw(),T=fw();(Pn!==s||Kr!==l)&&($p=null,u0(s,l)),l=!1;var W=li;e:do try{if(yn!==0&&jr!==null){var ue=jr,ke=Ks;switch(yn){case 8:tv(),W=6;break e;case 3:case 2:case 9:case 6:No.current===null&&(l=!0);var Xe=yn;if(yn=0,Ks=null,f0(s,ue,ke,Xe),f&&s0){W=0;break e}break;default:Xe=yn,yn=0,Ks=null,f0(s,ue,ke,Xe)}}l8(),W=li;break}catch(st){cw(s,st)}while(!0);return l&&s.shellSuspendCounter++,il=Oi=null,xn=p,J.H=y,J.A=T,jr===null&&(Pn=null,Kr=0,bs()),W}function l8(){for(;jr!==null;)hw(jr)}function c8(s,l){var f=xn;xn|=2;var p=uw(),y=fw();Pn!==s||Kr!==l?($p=null,Kp=Je()+500,u0(s,l)):s0=Ii(s,l);e:do try{if(yn!==0&&jr!==null){l=jr;var T=Ks;t:switch(yn){case 1:yn=0,Ks=null,f0(s,l,T,1);break;case 2:case 9:if(ye(T)){yn=0,Ks=null,dw(l);break}l=function(){yn!==2&&yn!==9||Pn!==s||(yn=7),tc(s)},T.then(l,l);break e;case 3:yn=7;break e;case 4:yn=5;break e;case 7:ye(T)?(yn=0,Ks=null,dw(l)):(yn=0,Ks=null,f0(s,l,T,7));break;case 5:var W=null;switch(jr.tag){case 26:W=jr.memoizedState;case 5:case 27:var ue=jr;if(!W||Yw(W)){yn=0,Ks=null;var ke=ue.sibling;if(ke!==null)jr=ke;else{var Xe=ue.return;Xe!==null?(jr=Xe,Jp(Xe)):jr=null}break t}}yn=0,Ks=null,f0(s,l,T,5);break;case 6:yn=0,Ks=null,f0(s,l,T,6);break;case 8:tv(),li=6;break e;default:throw Error(n(462))}}u8();break}catch(st){cw(s,st)}while(!0);return il=Oi=null,J.H=p,J.A=y,xn=f,jr!==null?0:(Pn=null,Kr=0,bs(),li)}function u8(){for(;jr!==null&&!Pe();)hw(jr)}function hw(s){var l=j5(s.alternate,s,Xc);s.memoizedProps=s.pendingProps,l===null?Jp(s):jr=l}function dw(s){var l=s,f=l.alternate;switch(l.tag){case 15:case 0:l=D5(f,l,l.pendingProps,l.type,void 0,Kr);break;case 11:l=D5(f,l,l.pendingProps,l.type.render,l.ref,Kr);break;case 5:$h(l);default:V5(f,l),l=jr=Bf(l,Xc),l=j5(f,l,Xc)}s.memoizedProps=s.pendingProps,l===null?Jp(s):jr=l}function f0(s,l,f,p){il=Oi=null,$h(l),r0=null,Cd=0;var y=l.return;try{if(Zk(s,y,l,f,Kr)){li=1,zp(s,Cr(f,s.current)),jr=null;return}}catch(T){if(y!==null)throw jr=y,T;li=1,zp(s,Cr(f,s.current)),jr=null;return}l.flags&32768?(en||p===1?s=!0:s0||(Kr&536870912)!==0?s=!1:(Mu=s=!0,(p===2||p===9||p===3||p===6)&&(p=No.current,p!==null&&p.tag===13&&(p.flags|=16384))),pw(l,s)):Jp(l)}function Jp(s){var l=s;do{if((l.flags&32768)!==0){pw(l,Mu);return}s=l.return;var f=t8(l.alternate,l,Xc);if(f!==null){jr=f;return}if(l=l.sibling,l!==null){jr=l;return}jr=l=s}while(l!==null);li===0&&(li=5)}function pw(s,l){do{var f=r8(s.alternate,s);if(f!==null){f.flags&=32767,jr=f;return}if(f=s.return,f!==null&&(f.flags|=32768,f.subtreeFlags=0,f.deletions=null),!l&&(s=s.sibling,s!==null)){jr=s;return}jr=s=f}while(s!==null);li=6,jr=null}function mw(s,l,f,p,y,T,W,ue,ke){s.cancelPendingCommit=null;do Zp();while(ba!==0);if((xn&6)!==0)throw Error(n(327));if(l!==null){if(l===s.current)throw Error(n(177));if(T=l.lanes|l.childLanes,T|=$n,Jr(s,f,T,W,ue,ke),s===Pn&&(jr=Pn=null,Kr=0),l0=l,Uu=s,c0=f,J2=T,Z2=y,aw=p,(l.subtreeFlags&10256)!==0||(l.flags&10256)!==0?(s.callbackNode=null,s.callbackPriority=0,p8(Et,function(){return yw(),null})):(s.callbackNode=null,s.callbackPriority=0),p=(l.flags&13878)!==0,(l.subtreeFlags&13878)!==0||p){p=J.T,J.T=null,y=de.p,de.p=2,W=xn,xn|=4;try{n8(s,l,f)}finally{xn=W,de.p=y,J.T=p}}ba=1,gw(),vw(),_w()}}function gw(){if(ba===1){ba=0;var s=Uu,l=l0,f=(l.flags&13878)!==0;if((l.subtreeFlags&13878)!==0||f){f=J.T,J.T=null;var p=de.p;de.p=2;var y=xn;xn|=4;try{J5(l,s);var T=mv,W=xa(s.containerInfo),ue=T.focusedElem,ke=T.selectionRange;if(W!==ue&&ue&&ue.ownerDocument&&Pl(ue.ownerDocument.documentElement,ue)){if(ke!==null&&Ki(ue)){var Xe=ke.start,st=ke.end;if(st===void 0&&(st=Xe),"selectionStart"in ue)ue.selectionStart=Xe,ue.selectionEnd=Math.min(st,ue.value.length);else{var mt=ue.ownerDocument||document,Ke=mt&&mt.defaultView||window;if(Ke.getSelection){var Qe=Ke.getSelection(),dr=ue.textContent.length,nr=Math.min(ke.start,dr),Nn=ke.end===void 0?nr:Math.min(ke.end,dr);!Qe.extend&&nr>Nn&&(W=Nn,Nn=nr,nr=W);var Ue=$o(ue,nr),Le=$o(ue,Nn);if(Ue&&Le&&(Qe.rangeCount!==1||Qe.anchorNode!==Ue.node||Qe.anchorOffset!==Ue.offset||Qe.focusNode!==Le.node||Qe.focusOffset!==Le.offset)){var ze=mt.createRange();ze.setStart(Ue.node,Ue.offset),Qe.removeAllRanges(),nr>Nn?(Qe.addRange(ze),Qe.extend(Le.node,Le.offset)):(ze.setEnd(Le.node,Le.offset),Qe.addRange(ze))}}}}for(mt=[],Qe=ue;Qe=Qe.parentNode;)Qe.nodeType===1&&mt.push({element:Qe,left:Qe.scrollLeft,top:Qe.scrollTop});for(typeof ue.focus=="function"&&ue.focus(),ue=0;ue<mt.length;ue++){var ut=mt[ue];ut.element.scrollLeft=ut.left,ut.element.scrollTop=ut.top}}fm=!!pv,mv=pv=null}finally{xn=y,de.p=p,J.T=f}}s.current=l,ba=2}}function vw(){if(ba===2){ba=0;var s=Uu,l=l0,f=(l.flags&8772)!==0;if((l.subtreeFlags&8772)!==0||f){f=J.T,J.T=null;var p=de.p;de.p=2;var y=xn;xn|=4;try{Y5(s,l.alternate,l)}finally{xn=y,de.p=p,J.T=f}}ba=3}}function _w(){if(ba===4||ba===3){ba=0,ge();var s=Uu,l=l0,f=c0,p=aw;(l.subtreeFlags&10256)!==0||(l.flags&10256)!==0?ba=5:(ba=0,l0=Uu=null,xw(s,s.pendingLanes));var y=s.pendingLanes;if(y===0&&(ju=null),Dn(f),l=l.stateNode,kt&&typeof kt.onCommitFiberRoot=="function")try{kt.onCommitFiberRoot(Tt,l,void 0,(l.current.flags&128)===128)}catch{}if(p!==null){l=J.T,y=de.p,de.p=2,J.T=null;try{for(var T=s.onRecoverableError,W=0;W<p.length;W++){var ue=p[W];T(ue.value,{componentStack:ue.stack})}}finally{J.T=l,de.p=y}}(c0&3)!==0&&Zp(),tc(s),y=s.pendingLanes,(f&4194090)!==0&&(y&42)!==0?s===ev?Bd++:(Bd=0,ev=s):Bd=0,jd(0)}}function xw(s,l){(s.pooledCacheLanes&=l)===0&&(l=s.pooledCache,l!=null&&(s.pooledCache=null,qf(l)))}function Zp(s){return gw(),vw(),_w(),yw()}function yw(){if(ba!==5)return!1;var s=Uu,l=J2;J2=0;var f=Dn(c0),p=J.T,y=de.p;try{de.p=32>f?32:f,J.T=null,f=Z2,Z2=null;var T=Uu,W=c0;if(ba=0,l0=Uu=null,c0=0,(xn&6)!==0)throw Error(n(331));var ue=xn;if(xn|=4,nw(T.current),ew(T,T.current,W,f),xn=ue,jd(0,!1),kt&&typeof kt.onPostCommitFiberRoot=="function")try{kt.onPostCommitFiberRoot(Tt,T)}catch{}return!0}finally{de.p=y,J.T=p,xw(s,l)}}function ww(s,l,f){l=Cr(f,l),l=L2(s.stateNode,l,2),s=ht(s,l,2),s!==null&&(di(s,2),tc(s))}function Rn(s,l,f){if(s.tag===3)ww(s,s,f);else for(;l!==null;){if(l.tag===3){ww(l,s,f);break}else if(l.tag===1){var p=l.stateNode;if(typeof l.type.getDerivedStateFromError=="function"||typeof p.componentDidCatch=="function"&&(ju===null||!ju.has(p))){s=Cr(f,s),f=A5(2),p=ht(l,f,2),p!==null&&(T5(f,p,l,s),di(p,2),tc(p));break}}l=l.return}}function iv(s,l,f){var p=s.pingCache;if(p===null){p=s.pingCache=new s8;var y=new Set;p.set(l,y)}else y=p.get(l),y===void 0&&(y=new Set,p.set(l,y));y.has(f)||(Y2=!0,y.add(f),s=f8.bind(null,s,l,f),l.then(s,s))}function f8(s,l,f){var p=s.pingCache;p!==null&&p.delete(l),s.pingedLanes|=s.suspendedLanes&f,s.warmLanes&=~f,Pn===s&&(Kr&f)===f&&(li===4||li===3&&(Kr&62914560)===Kr&&300>Je()-Q2?(xn&2)===0&&u0(s,0):K2|=f,o0===Kr&&(o0=0)),tc(s)}function Ew(s,l){l===0&&(l=hn()),s=Jo(s,l),s!==null&&(di(s,l),tc(s))}function h8(s){var l=s.memoizedState,f=0;l!==null&&(f=l.retryLane),Ew(s,f)}function d8(s,l){var f=0;switch(s.tag){case 13:var p=s.stateNode,y=s.memoizedState;y!==null&&(f=y.retryLane);break;case 19:p=s.stateNode;break;case 22:p=s.stateNode._retryCache;break;default:throw Error(n(314))}p!==null&&p.delete(l),Ew(s,f)}function p8(s,l){return rt(s,l)}var em=null,h0=null,av=!1,tm=!1,sv=!1,nh=0;function tc(s){s!==h0&&s.next===null&&(h0===null?em=h0=s:h0=h0.next=s),tm=!0,av||(av=!0,g8())}function jd(s,l){if(!sv&&tm){sv=!0;do for(var f=!1,p=em;p!==null;){if(s!==0){var y=p.pendingLanes;if(y===0)var T=0;else{var W=p.suspendedLanes,ue=p.pingedLanes;T=(1<<31-Pt(42|s)+1)-1,T&=y&~(W&~ue),T=T&201326741?T&201326741|1:T?T|2:0}T!==0&&(f=!0,Tw(p,T))}else T=Kr,T=Qr(p,p===Pn?T:0,p.cancelPendingCommit!==null||p.timeoutHandle!==-1),(T&3)===0||Ii(p,T)||(f=!0,Tw(p,T));p=p.next}while(f);sv=!1}}function m8(){bw()}function bw(){tm=av=!1;var s=0;nh!==0&&(S8()&&(s=nh),nh=0);for(var l=Je(),f=null,p=em;p!==null;){var y=p.next,T=Sw(p,l);T===0?(p.next=null,f===null?em=y:f.next=y,y===null&&(h0=f)):(f=p,(s!==0||(T&3)!==0)&&(tm=!0)),p=y}jd(s)}function Sw(s,l){for(var f=s.suspendedLanes,p=s.pingedLanes,y=s.expirationTimes,T=s.pendingLanes&-62914561;0<T;){var W=31-Pt(T),ue=1<<W,ke=y[W];ke===-1?((ue&f)===0||(ue&p)!==0)&&(y[W]=Tr(ue,l)):ke<=l&&(s.expiredLanes|=ue),T&=~ue}if(l=Pn,f=Kr,f=Qr(s,s===l?f:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),p=s.callbackNode,f===0||s===l&&(yn===2||yn===9)||s.cancelPendingCommit!==null)return p!==null&&p!==null&&ot(p),s.callbackNode=null,s.callbackPriority=0;if((f&3)===0||Ii(s,f)){if(l=f&-f,l===s.callbackPriority)return l;switch(p!==null&&ot(p),Dn(f)){case 2:case 8:f=vt;break;case 32:f=Et;break;case 268435456:f=Mt;break;default:f=Et}return p=Aw.bind(null,s),f=rt(f,p),s.callbackPriority=l,s.callbackNode=f,l}return p!==null&&p!==null&&ot(p),s.callbackPriority=2,s.callbackNode=null,2}function Aw(s,l){if(ba!==0&&ba!==5)return s.callbackNode=null,s.callbackPriority=0,null;var f=s.callbackNode;if(Zp()&&s.callbackNode!==f)return null;var p=Kr;return p=Qr(s,s===Pn?p:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),p===0?null:(ow(s,p,l),Sw(s,Je()),s.callbackNode!=null&&s.callbackNode===f?Aw.bind(null,s):null)}function Tw(s,l){if(Zp())return null;ow(s,l,!0)}function g8(){T8(function(){(xn&6)!==0?rt(et,m8):bw()})}function ov(){return nh===0&&(nh=Ra()),nh}function kw(s){return s==null||typeof s=="symbol"||typeof s=="boolean"?null:typeof s=="function"?s:Ms(""+s)}function Nw(s,l){var f=l.ownerDocument.createElement("input");return f.name=l.name,f.value=l.value,s.id&&f.setAttribute("form",s.id),l.parentNode.insertBefore(f,l),s=new FormData(s),f.parentNode.removeChild(f),s}function v8(s,l,f,p,y){if(l==="submit"&&f&&f.stateNode===y){var T=kw((y[Hr]||null).action),W=p.submitter;W&&(l=(l=W[Hr]||null)?kw(l.formAction):W.getAttribute("formAction"),l!==null&&(T=l,W=null));var ue=new ho("action","action",null,p,y);s.push({event:ue,listeners:[{instance:null,listener:function(){if(p.defaultPrevented){if(nh!==0){var ke=W?Nw(y,W):new FormData(y);ko(f,{pending:!0,data:ke,method:y.method,action:T},null,ke)}}else typeof T=="function"&&(ue.preventDefault(),ke=W?Nw(y,W):new FormData(y),ko(f,{pending:!0,data:ke,method:y.method,action:T},T,ke))},currentTarget:y}]})}}for(var lv=0;lv<Rc.length;lv++){var cv=Rc[lv],_8=cv.toLowerCase(),x8=cv[0].toUpperCase()+cv.slice(1);Gn(_8,"on"+x8)}Gn(wu,"onAnimationEnd"),Gn(Bl,"onAnimationIteration"),Gn(jl,"onAnimationStart"),Gn("dblclick","onDoubleClick"),Gn("focusin","onFocus"),Gn("focusout","onBlur"),Gn(Ul,"onTransitionRun"),Gn(Ic,"onTransitionStart"),Gn(Eu,"onTransitionCancel"),Gn(Vl,"onTransitionEnd"),At("onMouseEnter",["mouseout","mouseover"]),At("onMouseLeave",["mouseout","mouseover"]),At("onPointerEnter",["pointerout","pointerover"]),At("onPointerLeave",["pointerout","pointerover"]),pt("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),pt("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),pt("onBeforeInput",["compositionend","keypress","textInput","paste"]),pt("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),pt("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),pt("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ud="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),y8=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Ud));function Cw(s,l){l=(l&4)!==0;for(var f=0;f<s.length;f++){var p=s[f],y=p.event;p=p.listeners;e:{var T=void 0;if(l)for(var W=p.length-1;0<=W;W--){var ue=p[W],ke=ue.instance,Xe=ue.currentTarget;if(ue=ue.listener,ke!==T&&y.isPropagationStopped())break e;T=ue,y.currentTarget=Xe;try{T(y)}catch(st){qp(st)}y.currentTarget=null,T=ke}else for(W=0;W<p.length;W++){if(ue=p[W],ke=ue.instance,Xe=ue.currentTarget,ue=ue.listener,ke!==T&&y.isPropagationStopped())break e;T=ue,y.currentTarget=Xe;try{T(y)}catch(st){qp(st)}y.currentTarget=null,T=ke}}}}function Ur(s,l){var f=l[In];f===void 0&&(f=l[In]=new Set);var p=s+"__bubble";f.has(p)||(Iw(l,s,2,!1),f.add(p))}function uv(s,l,f){var p=0;l&&(p|=4),Iw(f,s,p,l)}var rm="_reactListening"+Math.random().toString(36).slice(2);function fv(s){if(!s[rm]){s[rm]=!0,He.forEach(function(f){f!=="selectionchange"&&(y8.has(f)||uv(f,!1,s),uv(f,!0,s))});var l=s.nodeType===9?s:s.ownerDocument;l===null||l[rm]||(l[rm]=!0,uv("selectionchange",!1,l))}}function Iw(s,l,f,p){switch(e4(l)){case 2:var y=X8;break;case 8:y=Y8;break;default:y=Av}f=y.bind(null,l,f,s),y=void 0,!_a||l!=="touchstart"&&l!=="touchmove"&&l!=="wheel"||(y=!0),p?y!==void 0?s.addEventListener(l,f,{capture:!0,passive:y}):s.addEventListener(l,f,!0):y!==void 0?s.addEventListener(l,f,{passive:y}):s.addEventListener(l,f,!1)}function hv(s,l,f,p,y){var T=p;if((l&1)===0&&(l&2)===0&&p!==null)e:for(;;){if(p===null)return;var W=p.tag;if(W===3||W===4){var ue=p.stateNode.containerInfo;if(ue===y)break;if(W===4)for(W=p.return;W!==null;){var ke=W.tag;if((ke===3||ke===4)&&W.stateNode.containerInfo===y)return;W=W.return}for(;ue!==null;){if(W=we(ue),W===null)return;if(ke=W.tag,ke===5||ke===6||ke===26||ke===27){p=T=W;continue e}ue=ue.parentNode}}p=p.return}gu(function(){var Xe=T,st=vn(f),mt=[];e:{var Ke=Qo.get(s);if(Ke!==void 0){var Qe=ho,dr=s;switch(s){case"keypress":if(Oa(f)===0)break e;case"keydown":case"keyup":Qe=Vs;break;case"focusin":dr="focus",Qe=mo;break;case"focusout":dr="blur",Qe=mo;break;case"beforeblur":case"afterblur":Qe=mo;break;case"click":if(f.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Qe=ii;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Qe=po;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Qe=Ll;break;case wu:case Bl:case jl:Qe=Cl;break;case Vl:Qe=K;break;case"scroll":case"scrollend":Qe=Sc;break;case"wheel":Qe=Ne;break;case"copy":case"cut":case"paste":Qe=Il;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Qe=Ko;break;case"toggle":case"beforetoggle":Qe=tt}var nr=(l&4)!==0,Nn=!nr&&(s==="scroll"||s==="scrollend"),Ue=nr?Ke!==null?Ke+"Capture":null:Ke;nr=[];for(var Le=Xe,ze;Le!==null;){var ut=Le;if(ze=ut.stateNode,ut=ut.tag,ut!==5&&ut!==26&&ut!==27||ze===null||Ue===null||(ut=ra(Le,Ue),ut!=null&&nr.push(Vd(Le,ut,ze))),Nn)break;Le=Le.return}0<nr.length&&(Ke=new Qe(Ke,dr,null,f,st),mt.push({event:Ke,listeners:nr}))}}if((l&7)===0){e:{if(Ke=s==="mouseover"||s==="pointerover",Qe=s==="mouseout"||s==="pointerout",Ke&&f!==ms&&(dr=f.relatedTarget||f.fromElement)&&(we(dr)||dr[gn]))break e;if((Qe||Ke)&&(Ke=st.window===st?st:(Ke=st.ownerDocument)?Ke.defaultView||Ke.parentWindow:window,Qe?(dr=f.relatedTarget||f.toElement,Qe=Xe,dr=dr?we(dr):null,dr!==null&&(Nn=a(dr),nr=dr.tag,dr!==Nn||nr!==5&&nr!==27&&nr!==6)&&(dr=null)):(Qe=null,dr=Xe),Qe!==dr)){if(nr=ii,ut="onMouseLeave",Ue="onMouseEnter",Le="mouse",(s==="pointerout"||s==="pointerover")&&(nr=Ko,ut="onPointerLeave",Ue="onPointerEnter",Le="pointer"),Nn=Qe==null?Ke:Ve(Qe),ze=dr==null?Ke:Ve(dr),Ke=new nr(ut,Le+"leave",Qe,f,st),Ke.target=Nn,Ke.relatedTarget=ze,ut=null,we(st)===Xe&&(nr=new nr(Ue,Le+"enter",dr,f,st),nr.target=ze,nr.relatedTarget=Nn,ut=nr),Nn=ut,Qe&&dr)t:{for(nr=Qe,Ue=dr,Le=0,ze=nr;ze;ze=d0(ze))Le++;for(ze=0,ut=Ue;ut;ut=d0(ut))ze++;for(;0<Le-ze;)nr=d0(nr),Le--;for(;0<ze-Le;)Ue=d0(Ue),ze--;for(;Le--;){if(nr===Ue||Ue!==null&&nr===Ue.alternate)break t;nr=d0(nr),Ue=d0(Ue)}nr=null}else nr=null;Qe!==null&&Rw(mt,Ke,Qe,nr,!1),dr!==null&&Nn!==null&&Rw(mt,Nn,dr,nr,!0)}}e:{if(Ke=Xe?Ve(Xe):window,Qe=Ke.nodeName&&Ke.nodeName.toLowerCase(),Qe==="select"||Qe==="input"&&Ke.type==="file")var Wt=xu;else if(dn(Ke))if(Tc)Wt=qh;else{Wt=dd;var Mr=Ma}else Qe=Ke.nodeName,!Qe||Qe.toLowerCase()!=="input"||Ke.type!=="checkbox"&&Ke.type!=="radio"?Xe&&Ec(Xe.elementType)&&(Wt=xu):Wt=Pf;if(Wt&&(Wt=Wt(s,Xe))){ws(mt,Wt,f,st);break e}Mr&&Mr(s,Ke,Xe),s==="focusout"&&Xe&&Ke.type==="number"&&Xe.memoizedProps.value!=null&&co(Ke,"number",Ke.value)}switch(Mr=Xe?Ve(Xe):window,s){case"focusin":(dn(Mr)||Mr.contentEditable==="true")&&(Ba=Mr,qs=Xe,yo=null);break;case"focusout":yo=qs=Ba=null;break;case"mousedown":zs=!0;break;case"contextmenu":case"mouseup":case"dragend":zs=!1,Hn(mt,f,st);break;case"selectionchange":if(Ml)break;case"keydown":case"keyup":Hn(mt,f,st)}var $t;if(Ft)e:{switch(s){case"compositionstart":var ir="onCompositionStart";break e;case"compositionend":ir="onCompositionEnd";break e;case"compositionupdate":ir="onCompositionUpdate";break e}ir=void 0}else rr?We(s,f)&&(ir="onCompositionEnd"):s==="keydown"&&f.keyCode===229&&(ir="onCompositionStart");ir&&(q&&f.locale!=="ko"&&(rr||ir!=="onCompositionStart"?ir==="onCompositionEnd"&&rr&&($t=bc()):(Fa=st,fo="value"in Fa?Fa.value:Fa.textContent,rr=!0)),Mr=nm(Xe,ir),0<Mr.length&&(ir=new Wo(ir,s,null,f,st),mt.push({event:ir,listeners:Mr}),$t?ir.data=$t:($t=wt(f),$t!==null&&(ir.data=$t)))),($t=P?Pr(s,f):mr(s,f))&&(ir=nm(Xe,"onBeforeInput"),0<ir.length&&(Mr=new Wo("onBeforeInput","beforeinput",null,f,st),mt.push({event:Mr,listeners:ir}),Mr.data=$t)),v8(mt,s,Xe,f,st)}Cw(mt,l)})}function Vd(s,l,f){return{instance:s,listener:l,currentTarget:f}}function nm(s,l){for(var f=l+"Capture",p=[];s!==null;){var y=s,T=y.stateNode;if(y=y.tag,y!==5&&y!==26&&y!==27||T===null||(y=ra(s,f),y!=null&&p.unshift(Vd(s,y,T)),y=ra(s,l),y!=null&&p.push(Vd(s,y,T))),s.tag===3)return p;s=s.return}return[]}function d0(s){if(s===null)return null;do s=s.return;while(s&&s.tag!==5&&s.tag!==27);return s||null}function Rw(s,l,f,p,y){for(var T=l._reactName,W=[];f!==null&&f!==p;){var ue=f,ke=ue.alternate,Xe=ue.stateNode;if(ue=ue.tag,ke!==null&&ke===p)break;ue!==5&&ue!==26&&ue!==27||Xe===null||(ke=Xe,y?(Xe=ra(f,T),Xe!=null&&W.unshift(Vd(f,Xe,ke))):y||(Xe=ra(f,T),Xe!=null&&W.push(Vd(f,Xe,ke)))),f=f.return}W.length!==0&&s.push({event:l,listeners:W})}var w8=/\r\n?/g,E8=/\u0000|\uFFFD/g;function Lw(s){return(typeof s=="string"?s:""+s).replace(w8,`
`).replace(E8,"")}function Dw(s,l){return l=Lw(l),Lw(s)===l}function im(){}function kn(s,l,f,p,y,T){switch(f){case"children":typeof p=="string"?l==="body"||l==="textarea"&&p===""||La(s,p):(typeof p=="number"||typeof p=="bigint")&&l!=="body"&&La(s,""+p);break;case"className":Nr(s,"class",p);break;case"tabIndex":Nr(s,"tabindex",p);break;case"dir":case"role":case"viewBox":case"width":case"height":Nr(s,f,p);break;case"style":wc(s,p,T);break;case"data":if(l!=="object"){Nr(s,"data",p);break}case"src":case"href":if(p===""&&(l!=="a"||f!=="href")){s.removeAttribute(f);break}if(p==null||typeof p=="function"||typeof p=="symbol"||typeof p=="boolean"){s.removeAttribute(f);break}p=Ms(""+p),s.setAttribute(f,p);break;case"action":case"formAction":if(typeof p=="function"){s.setAttribute(f,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof T=="function"&&(f==="formAction"?(l!=="input"&&kn(s,l,"name",y.name,y,null),kn(s,l,"formEncType",y.formEncType,y,null),kn(s,l,"formMethod",y.formMethod,y,null),kn(s,l,"formTarget",y.formTarget,y,null)):(kn(s,l,"encType",y.encType,y,null),kn(s,l,"method",y.method,y,null),kn(s,l,"target",y.target,y,null)));if(p==null||typeof p=="symbol"||typeof p=="boolean"){s.removeAttribute(f);break}p=Ms(""+p),s.setAttribute(f,p);break;case"onClick":p!=null&&(s.onclick=im);break;case"onScroll":p!=null&&Ur("scroll",s);break;case"onScrollEnd":p!=null&&Ur("scrollend",s);break;case"dangerouslySetInnerHTML":if(p!=null){if(typeof p!="object"||!("__html"in p))throw Error(n(61));if(f=p.__html,f!=null){if(y.children!=null)throw Error(n(60));s.innerHTML=f}}break;case"multiple":s.multiple=p&&typeof p!="function"&&typeof p!="symbol";break;case"muted":s.muted=p&&typeof p!="function"&&typeof p!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(p==null||typeof p=="function"||typeof p=="boolean"||typeof p=="symbol"){s.removeAttribute("xlink:href");break}f=Ms(""+p),s.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",f);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":p!=null&&typeof p!="function"&&typeof p!="symbol"?s.setAttribute(f,""+p):s.removeAttribute(f);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":p&&typeof p!="function"&&typeof p!="symbol"?s.setAttribute(f,""):s.removeAttribute(f);break;case"capture":case"download":p===!0?s.setAttribute(f,""):p!==!1&&p!=null&&typeof p!="function"&&typeof p!="symbol"?s.setAttribute(f,p):s.removeAttribute(f);break;case"cols":case"rows":case"size":case"span":p!=null&&typeof p!="function"&&typeof p!="symbol"&&!isNaN(p)&&1<=p?s.setAttribute(f,p):s.removeAttribute(f);break;case"rowSpan":case"start":p==null||typeof p=="function"||typeof p=="symbol"||isNaN(p)?s.removeAttribute(f):s.setAttribute(f,p);break;case"popover":Ur("beforetoggle",s),Ur("toggle",s),kr(s,"popover",p);break;case"xlinkActuate":Fr(s,"http://www.w3.org/1999/xlink","xlink:actuate",p);break;case"xlinkArcrole":Fr(s,"http://www.w3.org/1999/xlink","xlink:arcrole",p);break;case"xlinkRole":Fr(s,"http://www.w3.org/1999/xlink","xlink:role",p);break;case"xlinkShow":Fr(s,"http://www.w3.org/1999/xlink","xlink:show",p);break;case"xlinkTitle":Fr(s,"http://www.w3.org/1999/xlink","xlink:title",p);break;case"xlinkType":Fr(s,"http://www.w3.org/1999/xlink","xlink:type",p);break;case"xmlBase":Fr(s,"http://www.w3.org/XML/1998/namespace","xml:base",p);break;case"xmlLang":Fr(s,"http://www.w3.org/XML/1998/namespace","xml:lang",p);break;case"xmlSpace":Fr(s,"http://www.w3.org/XML/1998/namespace","xml:space",p);break;case"is":kr(s,"is",p);break;case"innerText":case"textContent":break;default:(!(2<f.length)||f[0]!=="o"&&f[0]!=="O"||f[1]!=="n"&&f[1]!=="N")&&(f=Ps.get(f)||f,kr(s,f,p))}}function dv(s,l,f,p,y,T){switch(f){case"style":wc(s,p,T);break;case"dangerouslySetInnerHTML":if(p!=null){if(typeof p!="object"||!("__html"in p))throw Error(n(61));if(f=p.__html,f!=null){if(y.children!=null)throw Error(n(60));s.innerHTML=f}}break;case"children":typeof p=="string"?La(s,p):(typeof p=="number"||typeof p=="bigint")&&La(s,""+p);break;case"onScroll":p!=null&&Ur("scroll",s);break;case"onScrollEnd":p!=null&&Ur("scrollend",s);break;case"onClick":p!=null&&(s.onclick=im);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Ye.hasOwnProperty(f))e:{if(f[0]==="o"&&f[1]==="n"&&(y=f.endsWith("Capture"),l=f.slice(2,y?f.length-7:void 0),T=s[Hr]||null,T=T!=null?T[f]:null,typeof T=="function"&&s.removeEventListener(l,T,y),typeof p=="function")){typeof T!="function"&&T!==null&&(f in s?s[f]=null:s.hasAttribute(f)&&s.removeAttribute(f)),s.addEventListener(l,p,y);break e}f in s?s[f]=p:p===!0?s.setAttribute(f,""):kr(s,f,p)}}}function Sa(s,l,f){switch(l){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Ur("error",s),Ur("load",s);var p=!1,y=!1,T;for(T in f)if(f.hasOwnProperty(T)){var W=f[T];if(W!=null)switch(T){case"src":p=!0;break;case"srcSet":y=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(n(137,l));default:kn(s,l,T,W,f,null)}}y&&kn(s,l,"srcSet",f.srcSet,f,null),p&&kn(s,l,"src",f.src,f,null);return;case"input":Ur("invalid",s);var ue=T=W=y=null,ke=null,Xe=null;for(p in f)if(f.hasOwnProperty(p)){var st=f[p];if(st!=null)switch(p){case"name":y=st;break;case"type":W=st;break;case"checked":ke=st;break;case"defaultChecked":Xe=st;break;case"value":T=st;break;case"defaultValue":ue=st;break;case"children":case"dangerouslySetInnerHTML":if(st!=null)throw Error(n(137,l));break;default:kn(s,l,p,st,f,null)}}lo(s,T,ue,ke,Xe,W,y,!1),oo(s);return;case"select":Ur("invalid",s),p=W=T=null;for(y in f)if(f.hasOwnProperty(y)&&(ue=f[y],ue!=null))switch(y){case"value":T=ue;break;case"defaultValue":W=ue;break;case"multiple":p=ue;default:kn(s,l,y,ue,f,null)}l=T,f=W,s.multiple=!!p,l!=null?ps(s,!!p,l,!1):f!=null&&ps(s,!!p,f,!0);return;case"textarea":Ur("invalid",s),T=y=p=null;for(W in f)if(f.hasOwnProperty(W)&&(ue=f[W],ue!=null))switch(W){case"value":p=ue;break;case"defaultValue":y=ue;break;case"children":T=ue;break;case"dangerouslySetInnerHTML":if(ue!=null)throw Error(n(91));break;default:kn(s,l,W,ue,f,null)}uo(s,p,y,T),oo(s);return;case"option":for(ke in f)if(f.hasOwnProperty(ke)&&(p=f[ke],p!=null))switch(ke){case"selected":s.selected=p&&typeof p!="function"&&typeof p!="symbol";break;default:kn(s,l,ke,p,f,null)}return;case"dialog":Ur("beforetoggle",s),Ur("toggle",s),Ur("cancel",s),Ur("close",s);break;case"iframe":case"object":Ur("load",s);break;case"video":case"audio":for(p=0;p<Ud.length;p++)Ur(Ud[p],s);break;case"image":Ur("error",s),Ur("load",s);break;case"details":Ur("toggle",s);break;case"embed":case"source":case"link":Ur("error",s),Ur("load",s);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(Xe in f)if(f.hasOwnProperty(Xe)&&(p=f[Xe],p!=null))switch(Xe){case"children":case"dangerouslySetInnerHTML":throw Error(n(137,l));default:kn(s,l,Xe,p,f,null)}return;default:if(Ec(l)){for(st in f)f.hasOwnProperty(st)&&(p=f[st],p!==void 0&&dv(s,l,st,p,f,void 0));return}}for(ue in f)f.hasOwnProperty(ue)&&(p=f[ue],p!=null&&kn(s,l,ue,p,f,null))}function b8(s,l,f,p){switch(l){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var y=null,T=null,W=null,ue=null,ke=null,Xe=null,st=null;for(Qe in f){var mt=f[Qe];if(f.hasOwnProperty(Qe)&&mt!=null)switch(Qe){case"checked":break;case"value":break;case"defaultValue":ke=mt;default:p.hasOwnProperty(Qe)||kn(s,l,Qe,null,p,mt)}}for(var Ke in p){var Qe=p[Ke];if(mt=f[Ke],p.hasOwnProperty(Ke)&&(Qe!=null||mt!=null))switch(Ke){case"type":T=Qe;break;case"name":y=Qe;break;case"checked":Xe=Qe;break;case"defaultChecked":st=Qe;break;case"value":W=Qe;break;case"defaultValue":ue=Qe;break;case"children":case"dangerouslySetInnerHTML":if(Qe!=null)throw Error(n(137,l));break;default:Qe!==mt&&kn(s,l,Ke,Qe,p,mt)}}Xi(s,W,ue,ke,Xe,st,T,y);return;case"select":Qe=W=ue=Ke=null;for(T in f)if(ke=f[T],f.hasOwnProperty(T)&&ke!=null)switch(T){case"value":break;case"multiple":Qe=ke;default:p.hasOwnProperty(T)||kn(s,l,T,null,p,ke)}for(y in p)if(T=p[y],ke=f[y],p.hasOwnProperty(y)&&(T!=null||ke!=null))switch(y){case"value":Ke=T;break;case"defaultValue":ue=T;break;case"multiple":W=T;default:T!==ke&&kn(s,l,y,T,p,ke)}l=ue,f=W,p=Qe,Ke!=null?ps(s,!!f,Ke,!1):!!p!=!!f&&(l!=null?ps(s,!!f,l,!0):ps(s,!!f,f?[]:"",!1));return;case"textarea":Qe=Ke=null;for(ue in f)if(y=f[ue],f.hasOwnProperty(ue)&&y!=null&&!p.hasOwnProperty(ue))switch(ue){case"value":break;case"children":break;default:kn(s,l,ue,null,p,y)}for(W in p)if(y=p[W],T=f[W],p.hasOwnProperty(W)&&(y!=null||T!=null))switch(W){case"value":Ke=y;break;case"defaultValue":Qe=y;break;case"children":break;case"dangerouslySetInnerHTML":if(y!=null)throw Error(n(91));break;default:y!==T&&kn(s,l,W,y,p,T)}nn(s,Ke,Qe);return;case"option":for(var dr in f)if(Ke=f[dr],f.hasOwnProperty(dr)&&Ke!=null&&!p.hasOwnProperty(dr))switch(dr){case"selected":s.selected=!1;break;default:kn(s,l,dr,null,p,Ke)}for(ke in p)if(Ke=p[ke],Qe=f[ke],p.hasOwnProperty(ke)&&Ke!==Qe&&(Ke!=null||Qe!=null))switch(ke){case"selected":s.selected=Ke&&typeof Ke!="function"&&typeof Ke!="symbol";break;default:kn(s,l,ke,Ke,p,Qe)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var nr in f)Ke=f[nr],f.hasOwnProperty(nr)&&Ke!=null&&!p.hasOwnProperty(nr)&&kn(s,l,nr,null,p,Ke);for(Xe in p)if(Ke=p[Xe],Qe=f[Xe],p.hasOwnProperty(Xe)&&Ke!==Qe&&(Ke!=null||Qe!=null))switch(Xe){case"children":case"dangerouslySetInnerHTML":if(Ke!=null)throw Error(n(137,l));break;default:kn(s,l,Xe,Ke,p,Qe)}return;default:if(Ec(l)){for(var Nn in f)Ke=f[Nn],f.hasOwnProperty(Nn)&&Ke!==void 0&&!p.hasOwnProperty(Nn)&&dv(s,l,Nn,void 0,p,Ke);for(st in p)Ke=p[st],Qe=f[st],!p.hasOwnProperty(st)||Ke===Qe||Ke===void 0&&Qe===void 0||dv(s,l,st,Ke,p,Qe);return}}for(var Ue in f)Ke=f[Ue],f.hasOwnProperty(Ue)&&Ke!=null&&!p.hasOwnProperty(Ue)&&kn(s,l,Ue,null,p,Ke);for(mt in p)Ke=p[mt],Qe=f[mt],!p.hasOwnProperty(mt)||Ke===Qe||Ke==null&&Qe==null||kn(s,l,mt,Ke,p,Qe)}var pv=null,mv=null;function am(s){return s.nodeType===9?s:s.ownerDocument}function Fw(s){switch(s){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function Ow(s,l){if(s===0)switch(l){case"svg":return 1;case"math":return 2;default:return 0}return s===1&&l==="foreignObject"?0:s}function gv(s,l){return s==="textarea"||s==="noscript"||typeof l.children=="string"||typeof l.children=="number"||typeof l.children=="bigint"||typeof l.dangerouslySetInnerHTML=="object"&&l.dangerouslySetInnerHTML!==null&&l.dangerouslySetInnerHTML.__html!=null}var vv=null;function S8(){var s=window.event;return s&&s.type==="popstate"?s===vv?!1:(vv=s,!0):(vv=null,!1)}var Pw=typeof setTimeout=="function"?setTimeout:void 0,A8=typeof clearTimeout=="function"?clearTimeout:void 0,Mw=typeof Promise=="function"?Promise:void 0,T8=typeof queueMicrotask=="function"?queueMicrotask:typeof Mw<"u"?function(s){return Mw.resolve(null).then(s).catch(k8)}:Pw;function k8(s){setTimeout(function(){throw s})}function qu(s){return s==="head"}function Bw(s,l){var f=l,p=0,y=0;do{var T=f.nextSibling;if(s.removeChild(f),T&&T.nodeType===8)if(f=T.data,f==="/$"){if(0<p&&8>p){f=p;var W=s.ownerDocument;if(f&1&&qd(W.documentElement),f&2&&qd(W.body),f&4)for(f=W.head,qd(f),W=f.firstChild;W;){var ue=W.nextSibling,ke=W.nodeName;W[me]||ke==="SCRIPT"||ke==="STYLE"||ke==="LINK"&&W.rel.toLowerCase()==="stylesheet"||f.removeChild(W),W=ue}}if(y===0){s.removeChild(T),$d(l);return}y--}else f==="$"||f==="$?"||f==="$!"?y++:p=f.charCodeAt(0)-48;else p=0;f=T}while(f);$d(l)}function _v(s){var l=s.firstChild;for(l&&l.nodeType===10&&(l=l.nextSibling);l;){var f=l;switch(l=l.nextSibling,f.nodeName){case"HTML":case"HEAD":case"BODY":_v(f),ve(f);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(f.rel.toLowerCase()==="stylesheet")continue}s.removeChild(f)}}function N8(s,l,f,p){for(;s.nodeType===1;){var y=f;if(s.nodeName.toLowerCase()!==l.toLowerCase()){if(!p&&(s.nodeName!=="INPUT"||s.type!=="hidden"))break}else if(p){if(!s[me])switch(l){case"meta":if(!s.hasAttribute("itemprop"))break;return s;case"link":if(T=s.getAttribute("rel"),T==="stylesheet"&&s.hasAttribute("data-precedence"))break;if(T!==y.rel||s.getAttribute("href")!==(y.href==null||y.href===""?null:y.href)||s.getAttribute("crossorigin")!==(y.crossOrigin==null?null:y.crossOrigin)||s.getAttribute("title")!==(y.title==null?null:y.title))break;return s;case"style":if(s.hasAttribute("data-precedence"))break;return s;case"script":if(T=s.getAttribute("src"),(T!==(y.src==null?null:y.src)||s.getAttribute("type")!==(y.type==null?null:y.type)||s.getAttribute("crossorigin")!==(y.crossOrigin==null?null:y.crossOrigin))&&T&&s.hasAttribute("async")&&!s.hasAttribute("itemprop"))break;return s;default:return s}}else if(l==="input"&&s.type==="hidden"){var T=y.name==null?null:""+y.name;if(y.type==="hidden"&&s.getAttribute("name")===T)return s}else return s;if(s=fl(s.nextSibling),s===null)break}return null}function C8(s,l,f){if(l==="")return null;for(;s.nodeType!==3;)if((s.nodeType!==1||s.nodeName!=="INPUT"||s.type!=="hidden")&&!f||(s=fl(s.nextSibling),s===null))return null;return s}function xv(s){return s.data==="$!"||s.data==="$?"&&s.ownerDocument.readyState==="complete"}function I8(s,l){var f=s.ownerDocument;if(s.data!=="$?"||f.readyState==="complete")l();else{var p=function(){l(),f.removeEventListener("DOMContentLoaded",p)};f.addEventListener("DOMContentLoaded",p),s._reactRetry=p}}function fl(s){for(;s!=null;s=s.nextSibling){var l=s.nodeType;if(l===1||l===3)break;if(l===8){if(l=s.data,l==="$"||l==="$!"||l==="$?"||l==="F!"||l==="F")break;if(l==="/$")return null}}return s}var yv=null;function jw(s){s=s.previousSibling;for(var l=0;s;){if(s.nodeType===8){var f=s.data;if(f==="$"||f==="$!"||f==="$?"){if(l===0)return s;l--}else f==="/$"&&l++}s=s.previousSibling}return null}function Uw(s,l,f){switch(l=am(f),s){case"html":if(s=l.documentElement,!s)throw Error(n(452));return s;case"head":if(s=l.head,!s)throw Error(n(453));return s;case"body":if(s=l.body,!s)throw Error(n(454));return s;default:throw Error(n(451))}}function qd(s){for(var l=s.attributes;l.length;)s.removeAttributeNode(l[0]);ve(s)}var Io=new Map,Vw=new Set;function sm(s){return typeof s.getRootNode=="function"?s.getRootNode():s.nodeType===9?s:s.ownerDocument}var Yc=de.d;de.d={f:R8,r:L8,D:D8,C:F8,L:O8,m:P8,X:B8,S:M8,M:j8};function R8(){var s=Yc.f(),l=Qp();return s||l}function L8(s){var l=Se(s);l!==null&&l.tag===5&&l.type==="form"?Jf(l):Yc.r(s)}var p0=typeof document>"u"?null:document;function qw(s,l,f){var p=p0;if(p&&typeof l=="string"&&l){var y=Gr(l);y='link[rel="'+s+'"][href="'+y+'"]',typeof f=="string"&&(y+='[crossorigin="'+f+'"]'),Vw.has(y)||(Vw.add(y),s={rel:s,crossOrigin:f,href:l},p.querySelector(y)===null&&(l=p.createElement("link"),Sa(l,"link",s),Me(l),p.head.appendChild(l)))}}function D8(s){Yc.D(s),qw("dns-prefetch",s,null)}function F8(s,l){Yc.C(s,l),qw("preconnect",s,l)}function O8(s,l,f){Yc.L(s,l,f);var p=p0;if(p&&s&&l){var y='link[rel="preload"][as="'+Gr(l)+'"]';l==="image"&&f&&f.imageSrcSet?(y+='[imagesrcset="'+Gr(f.imageSrcSet)+'"]',typeof f.imageSizes=="string"&&(y+='[imagesizes="'+Gr(f.imageSizes)+'"]')):y+='[href="'+Gr(s)+'"]';var T=y;switch(l){case"style":T=m0(s);break;case"script":T=g0(s)}Io.has(T)||(s=d({rel:"preload",href:l==="image"&&f&&f.imageSrcSet?void 0:s,as:l},f),Io.set(T,s),p.querySelector(y)!==null||l==="style"&&p.querySelector(zd(T))||l==="script"&&p.querySelector(Hd(T))||(l=p.createElement("link"),Sa(l,"link",s),Me(l),p.head.appendChild(l)))}}function P8(s,l){Yc.m(s,l);var f=p0;if(f&&s){var p=l&&typeof l.as=="string"?l.as:"script",y='link[rel="modulepreload"][as="'+Gr(p)+'"][href="'+Gr(s)+'"]',T=y;switch(p){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":T=g0(s)}if(!Io.has(T)&&(s=d({rel:"modulepreload",href:s},l),Io.set(T,s),f.querySelector(y)===null)){switch(p){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(f.querySelector(Hd(T)))return}p=f.createElement("link"),Sa(p,"link",s),Me(p),f.head.appendChild(p)}}}function M8(s,l,f){Yc.S(s,l,f);var p=p0;if(p&&s){var y=$e(p).hoistableStyles,T=m0(s);l=l||"default";var W=y.get(T);if(!W){var ue={loading:0,preload:null};if(W=p.querySelector(zd(T)))ue.loading=5;else{s=d({rel:"stylesheet",href:s,"data-precedence":l},f),(f=Io.get(T))&&wv(s,f);var ke=W=p.createElement("link");Me(ke),Sa(ke,"link",s),ke._p=new Promise(function(Xe,st){ke.onload=Xe,ke.onerror=st}),ke.addEventListener("load",function(){ue.loading|=1}),ke.addEventListener("error",function(){ue.loading|=2}),ue.loading|=4,om(W,l,p)}W={type:"stylesheet",instance:W,count:1,state:ue},y.set(T,W)}}}function B8(s,l){Yc.X(s,l);var f=p0;if(f&&s){var p=$e(f).hoistableScripts,y=g0(s),T=p.get(y);T||(T=f.querySelector(Hd(y)),T||(s=d({src:s,async:!0},l),(l=Io.get(y))&&Ev(s,l),T=f.createElement("script"),Me(T),Sa(T,"link",s),f.head.appendChild(T)),T={type:"script",instance:T,count:1,state:null},p.set(y,T))}}function j8(s,l){Yc.M(s,l);var f=p0;if(f&&s){var p=$e(f).hoistableScripts,y=g0(s),T=p.get(y);T||(T=f.querySelector(Hd(y)),T||(s=d({src:s,async:!0,type:"module"},l),(l=Io.get(y))&&Ev(s,l),T=f.createElement("script"),Me(T),Sa(T,"link",s),f.head.appendChild(T)),T={type:"script",instance:T,count:1,state:null},p.set(y,T))}}function zw(s,l,f,p){var y=(y=ae.current)?sm(y):null;if(!y)throw Error(n(446));switch(s){case"meta":case"title":return null;case"style":return typeof f.precedence=="string"&&typeof f.href=="string"?(l=m0(f.href),f=$e(y).hoistableStyles,p=f.get(l),p||(p={type:"style",instance:null,count:0,state:null},f.set(l,p)),p):{type:"void",instance:null,count:0,state:null};case"link":if(f.rel==="stylesheet"&&typeof f.href=="string"&&typeof f.precedence=="string"){s=m0(f.href);var T=$e(y).hoistableStyles,W=T.get(s);if(W||(y=y.ownerDocument||y,W={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},T.set(s,W),(T=y.querySelector(zd(s)))&&!T._p&&(W.instance=T,W.state.loading=5),Io.has(s)||(f={rel:"preload",as:"style",href:f.href,crossOrigin:f.crossOrigin,integrity:f.integrity,media:f.media,hrefLang:f.hrefLang,referrerPolicy:f.referrerPolicy},Io.set(s,f),T||U8(y,s,f,W.state))),l&&p===null)throw Error(n(528,""));return W}if(l&&p!==null)throw Error(n(529,""));return null;case"script":return l=f.async,f=f.src,typeof f=="string"&&l&&typeof l!="function"&&typeof l!="symbol"?(l=g0(f),f=$e(y).hoistableScripts,p=f.get(l),p||(p={type:"script",instance:null,count:0,state:null},f.set(l,p)),p):{type:"void",instance:null,count:0,state:null};default:throw Error(n(444,s))}}function m0(s){return'href="'+Gr(s)+'"'}function zd(s){return'link[rel="stylesheet"]['+s+"]"}function Hw(s){return d({},s,{"data-precedence":s.precedence,precedence:null})}function U8(s,l,f,p){s.querySelector('link[rel="preload"][as="style"]['+l+"]")?p.loading=1:(l=s.createElement("link"),p.preload=l,l.addEventListener("load",function(){return p.loading|=1}),l.addEventListener("error",function(){return p.loading|=2}),Sa(l,"link",f),Me(l),s.head.appendChild(l))}function g0(s){return'[src="'+Gr(s)+'"]'}function Hd(s){return"script[async]"+s}function Gw(s,l,f){if(l.count++,l.instance===null)switch(l.type){case"style":var p=s.querySelector('style[data-href~="'+Gr(f.href)+'"]');if(p)return l.instance=p,Me(p),p;var y=d({},f,{"data-href":f.href,"data-precedence":f.precedence,href:null,precedence:null});return p=(s.ownerDocument||s).createElement("style"),Me(p),Sa(p,"style",y),om(p,f.precedence,s),l.instance=p;case"stylesheet":y=m0(f.href);var T=s.querySelector(zd(y));if(T)return l.state.loading|=4,l.instance=T,Me(T),T;p=Hw(f),(y=Io.get(y))&&wv(p,y),T=(s.ownerDocument||s).createElement("link"),Me(T);var W=T;return W._p=new Promise(function(ue,ke){W.onload=ue,W.onerror=ke}),Sa(T,"link",p),l.state.loading|=4,om(T,f.precedence,s),l.instance=T;case"script":return T=g0(f.src),(y=s.querySelector(Hd(T)))?(l.instance=y,Me(y),y):(p=f,(y=Io.get(T))&&(p=d({},f),Ev(p,y)),s=s.ownerDocument||s,y=s.createElement("script"),Me(y),Sa(y,"link",p),s.head.appendChild(y),l.instance=y);case"void":return null;default:throw Error(n(443,l.type))}else l.type==="stylesheet"&&(l.state.loading&4)===0&&(p=l.instance,l.state.loading|=4,om(p,f.precedence,s));return l.instance}function om(s,l,f){for(var p=f.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),y=p.length?p[p.length-1]:null,T=y,W=0;W<p.length;W++){var ue=p[W];if(ue.dataset.precedence===l)T=ue;else if(T!==y)break}T?T.parentNode.insertBefore(s,T.nextSibling):(l=f.nodeType===9?f.head:f,l.insertBefore(s,l.firstChild))}function wv(s,l){s.crossOrigin==null&&(s.crossOrigin=l.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=l.referrerPolicy),s.title==null&&(s.title=l.title)}function Ev(s,l){s.crossOrigin==null&&(s.crossOrigin=l.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=l.referrerPolicy),s.integrity==null&&(s.integrity=l.integrity)}var lm=null;function Ww(s,l,f){if(lm===null){var p=new Map,y=lm=new Map;y.set(f,p)}else y=lm,p=y.get(f),p||(p=new Map,y.set(f,p));if(p.has(s))return p;for(p.set(s,null),f=f.getElementsByTagName(s),y=0;y<f.length;y++){var T=f[y];if(!(T[me]||T[Zr]||s==="link"&&T.getAttribute("rel")==="stylesheet")&&T.namespaceURI!=="http://www.w3.org/2000/svg"){var W=T.getAttribute(l)||"";W=s+W;var ue=p.get(W);ue?ue.push(T):p.set(W,[T])}}return p}function Xw(s,l,f){s=s.ownerDocument||s,s.head.insertBefore(f,l==="title"?s.querySelector("head > title"):null)}function V8(s,l,f){if(f===1||l.itemProp!=null)return!1;switch(s){case"meta":case"title":return!0;case"style":if(typeof l.precedence!="string"||typeof l.href!="string"||l.href==="")break;return!0;case"link":if(typeof l.rel!="string"||typeof l.href!="string"||l.href===""||l.onLoad||l.onError)break;switch(l.rel){case"stylesheet":return s=l.disabled,typeof l.precedence=="string"&&s==null;default:return!0}case"script":if(l.async&&typeof l.async!="function"&&typeof l.async!="symbol"&&!l.onLoad&&!l.onError&&l.src&&typeof l.src=="string")return!0}return!1}function Yw(s){return!(s.type==="stylesheet"&&(s.state.loading&3)===0)}var Gd=null;function q8(){}function z8(s,l,f){if(Gd===null)throw Error(n(475));var p=Gd;if(l.type==="stylesheet"&&(typeof f.media!="string"||matchMedia(f.media).matches!==!1)&&(l.state.loading&4)===0){if(l.instance===null){var y=m0(f.href),T=s.querySelector(zd(y));if(T){s=T._p,s!==null&&typeof s=="object"&&typeof s.then=="function"&&(p.count++,p=cm.bind(p),s.then(p,p)),l.state.loading|=4,l.instance=T,Me(T);return}T=s.ownerDocument||s,f=Hw(f),(y=Io.get(y))&&wv(f,y),T=T.createElement("link"),Me(T);var W=T;W._p=new Promise(function(ue,ke){W.onload=ue,W.onerror=ke}),Sa(T,"link",f),l.instance=T}p.stylesheets===null&&(p.stylesheets=new Map),p.stylesheets.set(l,s),(s=l.state.preload)&&(l.state.loading&3)===0&&(p.count++,l=cm.bind(p),s.addEventListener("load",l),s.addEventListener("error",l))}}function H8(){if(Gd===null)throw Error(n(475));var s=Gd;return s.stylesheets&&s.count===0&&bv(s,s.stylesheets),0<s.count?function(l){var f=setTimeout(function(){if(s.stylesheets&&bv(s,s.stylesheets),s.unsuspend){var p=s.unsuspend;s.unsuspend=null,p()}},6e4);return s.unsuspend=l,function(){s.unsuspend=null,clearTimeout(f)}}:null}function cm(){if(this.count--,this.count===0){if(this.stylesheets)bv(this,this.stylesheets);else if(this.unsuspend){var s=this.unsuspend;this.unsuspend=null,s()}}}var um=null;function bv(s,l){s.stylesheets=null,s.unsuspend!==null&&(s.count++,um=new Map,l.forEach(G8,s),um=null,cm.call(s))}function G8(s,l){if(!(l.state.loading&4)){var f=um.get(s);if(f)var p=f.get(null);else{f=new Map,um.set(s,f);for(var y=s.querySelectorAll("link[data-precedence],style[data-precedence]"),T=0;T<y.length;T++){var W=y[T];(W.nodeName==="LINK"||W.getAttribute("media")!=="not all")&&(f.set(W.dataset.precedence,W),p=W)}p&&f.set(null,p)}y=l.instance,W=y.getAttribute("data-precedence"),T=f.get(W)||p,T===p&&f.set(null,y),f.set(W,y),this.count++,p=cm.bind(this),y.addEventListener("load",p),y.addEventListener("error",p),T?T.parentNode.insertBefore(y,T.nextSibling):(s=s.nodeType===9?s.head:s,s.insertBefore(y,s.firstChild)),l.state.loading|=4}}var Wd={$$typeof:B,Provider:null,Consumer:null,_currentValue:oe,_currentValue2:oe,_threadCount:0};function W8(s,l,f,p,y,T,W,ue){this.tag=1,this.containerInfo=s,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Yn(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Yn(0),this.hiddenUpdates=Yn(null),this.identifierPrefix=p,this.onUncaughtError=y,this.onCaughtError=T,this.onRecoverableError=W,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=ue,this.incompleteTransitions=new Map}function Kw(s,l,f,p,y,T,W,ue,ke,Xe,st,mt){return s=new W8(s,l,f,W,ue,ke,Xe,mt),l=1,T===!0&&(l|=24),T=sa(3,null,null,l),s.current=T,T.stateNode=s,l=md(),l.refCount++,s.pooledCache=l,l.refCount++,T.memoizedState={element:p,isDehydrated:f,cache:l},Re(T),s}function $w(s){return s?(s=Fi,s):Fi}function Qw(s,l,f,p,y,T){y=$w(y),p.context===null?p.context=y:p.pendingContext=y,p=at(l),p.payload={element:f},T=T===void 0?null:T,T!==null&&(p.callback=T),f=ht(s,p,l),f!==null&&(Qs(f,s,l),ct(f,s,l))}function Jw(s,l){if(s=s.memoizedState,s!==null&&s.dehydrated!==null){var f=s.retryLane;s.retryLane=f!==0&&f<l?f:l}}function Sv(s,l){Jw(s,l),(s=s.alternate)&&Jw(s,l)}function Zw(s){if(s.tag===13){var l=Jo(s,67108864);l!==null&&Qs(l,s,67108864),Sv(s,67108864)}}var fm=!0;function X8(s,l,f,p){var y=J.T;J.T=null;var T=de.p;try{de.p=2,Av(s,l,f,p)}finally{de.p=T,J.T=y}}function Y8(s,l,f,p){var y=J.T;J.T=null;var T=de.p;try{de.p=8,Av(s,l,f,p)}finally{de.p=T,J.T=y}}function Av(s,l,f,p){if(fm){var y=Tv(p);if(y===null)hv(s,l,p,hm,f),t4(s,p);else if($8(y,s,l,f,p))p.stopPropagation();else if(t4(s,p),l&4&&-1<K8.indexOf(s)){for(;y!==null;){var T=Se(y);if(T!==null)switch(T.tag){case 3:if(T=T.stateNode,T.current.memoizedState.isDehydrated){var W=yr(T.pendingLanes);if(W!==0){var ue=T;for(ue.pendingLanes|=2,ue.entangledLanes|=2;W;){var ke=1<<31-Pt(W);ue.entanglements[1]|=ke,W&=~ke}tc(T),(xn&6)===0&&(Kp=Je()+500,jd(0))}}break;case 13:ue=Jo(T,2),ue!==null&&Qs(ue,T,2),Qp(),Sv(T,2)}if(T=Tv(p),T===null&&hv(s,l,p,hm,f),T===y)break;y=T}y!==null&&p.stopPropagation()}else hv(s,l,p,null,f)}}function Tv(s){return s=vn(s),kv(s)}var hm=null;function kv(s){if(hm=null,s=we(s),s!==null){var l=a(s);if(l===null)s=null;else{var f=l.tag;if(f===13){if(s=o(l),s!==null)return s;s=null}else if(f===3){if(l.stateNode.current.memoizedState.isDehydrated)return l.tag===3?l.stateNode.containerInfo:null;s=null}else l!==s&&(s=null)}}return hm=s,null}function e4(s){switch(s){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(nt()){case et:return 2;case vt:return 8;case Et:case bt:return 32;case Mt:return 268435456;default:return 32}default:return 32}}var Nv=!1,zu=null,Hu=null,Gu=null,Xd=new Map,Yd=new Map,Wu=[],K8="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function t4(s,l){switch(s){case"focusin":case"focusout":zu=null;break;case"dragenter":case"dragleave":Hu=null;break;case"mouseover":case"mouseout":Gu=null;break;case"pointerover":case"pointerout":Xd.delete(l.pointerId);break;case"gotpointercapture":case"lostpointercapture":Yd.delete(l.pointerId)}}function Kd(s,l,f,p,y,T){return s===null||s.nativeEvent!==T?(s={blockedOn:l,domEventName:f,eventSystemFlags:p,nativeEvent:T,targetContainers:[y]},l!==null&&(l=Se(l),l!==null&&Zw(l)),s):(s.eventSystemFlags|=p,l=s.targetContainers,y!==null&&l.indexOf(y)===-1&&l.push(y),s)}function $8(s,l,f,p,y){switch(l){case"focusin":return zu=Kd(zu,s,l,f,p,y),!0;case"dragenter":return Hu=Kd(Hu,s,l,f,p,y),!0;case"mouseover":return Gu=Kd(Gu,s,l,f,p,y),!0;case"pointerover":var T=y.pointerId;return Xd.set(T,Kd(Xd.get(T)||null,s,l,f,p,y)),!0;case"gotpointercapture":return T=y.pointerId,Yd.set(T,Kd(Yd.get(T)||null,s,l,f,p,y)),!0}return!1}function r4(s){var l=we(s.target);if(l!==null){var f=a(l);if(f!==null){if(l=f.tag,l===13){if(l=o(f),l!==null){s.blockedOn=l,ga(s.priority,function(){if(f.tag===13){var p=$s();p=ea(p);var y=Jo(f,p);y!==null&&Qs(y,f,p),Sv(f,p)}});return}}else if(l===3&&f.stateNode.current.memoizedState.isDehydrated){s.blockedOn=f.tag===3?f.stateNode.containerInfo:null;return}}}s.blockedOn=null}function dm(s){if(s.blockedOn!==null)return!1;for(var l=s.targetContainers;0<l.length;){var f=Tv(s.nativeEvent);if(f===null){f=s.nativeEvent;var p=new f.constructor(f.type,f);ms=p,f.target.dispatchEvent(p),ms=null}else return l=Se(f),l!==null&&Zw(l),s.blockedOn=f,!1;l.shift()}return!0}function n4(s,l,f){dm(s)&&f.delete(l)}function Q8(){Nv=!1,zu!==null&&dm(zu)&&(zu=null),Hu!==null&&dm(Hu)&&(Hu=null),Gu!==null&&dm(Gu)&&(Gu=null),Xd.forEach(n4),Yd.forEach(n4)}function pm(s,l){s.blockedOn===l&&(s.blockedOn=null,Nv||(Nv=!0,t.unstable_scheduleCallback(t.unstable_NormalPriority,Q8)))}var mm=null;function i4(s){mm!==s&&(mm=s,t.unstable_scheduleCallback(t.unstable_NormalPriority,function(){mm===s&&(mm=null);for(var l=0;l<s.length;l+=3){var f=s[l],p=s[l+1],y=s[l+2];if(typeof p!="function"){if(kv(p||f)===null)continue;break}var T=Se(f);T!==null&&(s.splice(l,3),l-=3,ko(T,{pending:!0,data:y,method:f.method,action:p},p,y))}}))}function $d(s){function l(ke){return pm(ke,s)}zu!==null&&pm(zu,s),Hu!==null&&pm(Hu,s),Gu!==null&&pm(Gu,s),Xd.forEach(l),Yd.forEach(l);for(var f=0;f<Wu.length;f++){var p=Wu[f];p.blockedOn===s&&(p.blockedOn=null)}for(;0<Wu.length&&(f=Wu[0],f.blockedOn===null);)r4(f),f.blockedOn===null&&Wu.shift();if(f=(s.ownerDocument||s).$$reactFormReplay,f!=null)for(p=0;p<f.length;p+=3){var y=f[p],T=f[p+1],W=y[Hr]||null;if(typeof T=="function")W||i4(f);else if(W){var ue=null;if(T&&T.hasAttribute("formAction")){if(y=T,W=T[Hr]||null)ue=W.formAction;else if(kv(y)!==null)continue}else ue=W.action;typeof ue=="function"?f[p+1]=ue:(f.splice(p,3),p-=3),i4(f)}}}function Cv(s){this._internalRoot=s}gm.prototype.render=Cv.prototype.render=function(s){var l=this._internalRoot;if(l===null)throw Error(n(409));var f=l.current,p=$s();Qw(f,p,s,l,null,null)},gm.prototype.unmount=Cv.prototype.unmount=function(){var s=this._internalRoot;if(s!==null){this._internalRoot=null;var l=s.containerInfo;Qw(s.current,2,null,s,null,null),Qp(),l[gn]=null}};function gm(s){this._internalRoot=s}gm.prototype.unstable_scheduleHydration=function(s){if(s){var l=pi();s={blockedOn:null,target:s,priority:l};for(var f=0;f<Wu.length&&l!==0&&l<Wu[f].priority;f++);Wu.splice(f,0,s),f===0&&r4(s)}};var a4=e.version;if(a4!=="19.1.0")throw Error(n(527,a4,"19.1.0"));de.findDOMNode=function(s){var l=s._reactInternals;if(l===void 0)throw typeof s.render=="function"?Error(n(188)):(s=Object.keys(s).join(","),Error(n(268,s)));return s=u(l),s=s!==null?h(s):null,s=s===null?null:s.stateNode,s};var J8={bundleType:0,version:"19.1.0",rendererPackageName:"react-dom",currentDispatcherRef:J,reconcilerVersion:"19.1.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var vm=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!vm.isDisabled&&vm.supportsFiber)try{Tt=vm.inject(J8),kt=vm}catch{}}return Jd.createRoot=function(s,l){if(!i(s))throw Error(n(299));var f=!1,p="",y=w5,T=E5,W=b5,ue=null;return l!=null&&(l.unstable_strictMode===!0&&(f=!0),l.identifierPrefix!==void 0&&(p=l.identifierPrefix),l.onUncaughtError!==void 0&&(y=l.onUncaughtError),l.onCaughtError!==void 0&&(T=l.onCaughtError),l.onRecoverableError!==void 0&&(W=l.onRecoverableError),l.unstable_transitionCallbacks!==void 0&&(ue=l.unstable_transitionCallbacks)),l=Kw(s,1,!1,null,null,f,p,y,T,W,ue,null),s[gn]=l.current,fv(s),new Cv(l)},Jd.hydrateRoot=function(s,l,f){if(!i(s))throw Error(n(299));var p=!1,y="",T=w5,W=E5,ue=b5,ke=null,Xe=null;return f!=null&&(f.unstable_strictMode===!0&&(p=!0),f.identifierPrefix!==void 0&&(y=f.identifierPrefix),f.onUncaughtError!==void 0&&(T=f.onUncaughtError),f.onCaughtError!==void 0&&(W=f.onCaughtError),f.onRecoverableError!==void 0&&(ue=f.onRecoverableError),f.unstable_transitionCallbacks!==void 0&&(ke=f.unstable_transitionCallbacks),f.formState!==void 0&&(Xe=f.formState)),l=Kw(s,1,!0,l,f??null,p,y,T,W,ue,ke,Xe),l.context=$w(null),f=l.current,p=$s(),p=ea(p),y=at(p),y.callback=null,ht(f,y,p),f=p,l.current.lanes=f,di(l,f),tc(l),s[gn]=l.current,fv(s),new gm(l)},Jd.version="19.1.0",Jd}var m4;function cN(){if(m4)return Lv.exports;m4=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}return t(),Lv.exports=lN(),Lv.exports}var uN=cN();const fN=xx(uN);Db();/**
 * @remix-run/router v1.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function T1(){return T1=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},T1.apply(this,arguments)}var rf;(function(t){t.Pop="POP",t.Push="PUSH",t.Replace="REPLACE"})(rf||(rf={}));const g4="popstate";function hN(t){t===void 0&&(t={});function e(i,a){let{pathname:o="/",search:c="",hash:u=""}=Ih(i.location.hash.substr(1));return!o.startsWith("/")&&!o.startsWith(".")&&(o="/"+o),x_("",{pathname:o,search:c,hash:u},a.state&&a.state.usr||null,a.state&&a.state.key||"default")}function r(i,a){let o=i.document.querySelector("base"),c="";if(o&&o.getAttribute("href")){let u=i.location.href,h=u.indexOf("#");c=h===-1?u:u.slice(0,h)}return c+"#"+(typeof a=="string"?a:ng(a))}function n(i,a){wx(i.pathname.charAt(0)==="/","relative pathnames are not supported in hash history.push("+JSON.stringify(a)+")")}return pN(e,r,n,t)}function ki(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function wx(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function dN(){return Math.random().toString(36).substr(2,8)}function v4(t,e){return{usr:t.state,key:t.key,idx:e}}function x_(t,e,r,n){return r===void 0&&(r=null),T1({pathname:typeof t=="string"?t:t.pathname,search:"",hash:""},typeof e=="string"?Ih(e):e,{state:r,key:e&&e.key||n||dN()})}function ng(t){let{pathname:e="/",search:r="",hash:n=""}=t;return r&&r!=="?"&&(e+=r.charAt(0)==="?"?r:"?"+r),n&&n!=="#"&&(e+=n.charAt(0)==="#"?n:"#"+n),e}function Ih(t){let e={};if(t){let r=t.indexOf("#");r>=0&&(e.hash=t.substr(r),t=t.substr(0,r));let n=t.indexOf("?");n>=0&&(e.search=t.substr(n),t=t.substr(0,n)),t&&(e.pathname=t)}return e}function pN(t,e,r,n){n===void 0&&(n={});let{window:i=document.defaultView,v5Compat:a=!1}=n,o=i.history,c=rf.Pop,u=null,h=d();h==null&&(h=0,o.replaceState(T1({},o.state,{idx:h}),""));function d(){return(o.state||{idx:null}).idx}function g(){c=rf.Pop;let A=d(),O=A==null?null:A-h;h=A,u&&u({action:c,location:E.location,delta:O})}function x(A,O){c=rf.Push;let M=x_(E.location,A,O);r&&r(M,A),h=d()+1;let B=v4(M,h),Q=E.createHref(M);try{o.pushState(B,"",Q)}catch(ee){if(ee instanceof DOMException&&ee.name==="DataCloneError")throw ee;i.location.assign(Q)}a&&u&&u({action:c,location:E.location,delta:1})}function _(A,O){c=rf.Replace;let M=x_(E.location,A,O);r&&r(M,A),h=d();let B=v4(M,h),Q=E.createHref(M);o.replaceState(B,"",Q),a&&u&&u({action:c,location:E.location,delta:0})}function b(A){let O=i.location.origin!=="null"?i.location.origin:i.location.href,M=typeof A=="string"?A:ng(A);return M=M.replace(/ $/,"%20"),ki(O,"No window.location.(origin|href) available to create URL for href: "+M),new URL(M,O)}let E={get action(){return c},get location(){return t(i,o)},listen(A){if(u)throw new Error("A history only accepts one active listener");return i.addEventListener(g4,g),u=A,()=>{i.removeEventListener(g4,g),u=null}},createHref(A){return e(i,A)},createURL:b,encodeLocation(A){let O=b(A);return{pathname:O.pathname,search:O.search,hash:O.hash}},push:x,replace:_,go(A){return o.go(A)}};return E}var _4;(function(t){t.data="data",t.deferred="deferred",t.redirect="redirect",t.error="error"})(_4||(_4={}));function mN(t,e,r){return r===void 0&&(r="/"),gN(t,e,r)}function gN(t,e,r,n){let i=typeof e=="string"?Ih(e):e,a=Ex(i.pathname||"/",r);if(a==null)return null;let o=Fb(t);vN(o);let c=null;for(let u=0;c==null&&u<o.length;++u){let h=CN(a);c=TN(o[u],h)}return c}function Fb(t,e,r,n){e===void 0&&(e=[]),r===void 0&&(r=[]),n===void 0&&(n="");let i=(a,o,c)=>{let u={relativePath:c===void 0?a.path||"":c,caseSensitive:a.caseSensitive===!0,childrenIndex:o,route:a};u.relativePath.startsWith("/")&&(ki(u.relativePath.startsWith(n),'Absolute route path "'+u.relativePath+'" nested under path '+('"'+n+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),u.relativePath=u.relativePath.slice(n.length));let h=lf([n,u.relativePath]),d=r.concat(u);a.children&&a.children.length>0&&(ki(a.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+h+'".')),Fb(a.children,e,d,h)),!(a.path==null&&!a.index)&&e.push({path:h,score:SN(h,a.index),routesMeta:d})};return t.forEach((a,o)=>{var c;if(a.path===""||!((c=a.path)!=null&&c.includes("?")))i(a,o);else for(let u of Ob(a.path))i(a,o,u)}),e}function Ob(t){let e=t.split("/");if(e.length===0)return[];let[r,...n]=e,i=r.endsWith("?"),a=r.replace(/\?$/,"");if(n.length===0)return i?[a,""]:[a];let o=Ob(n.join("/")),c=[];return c.push(...o.map(u=>u===""?a:[a,u].join("/"))),i&&c.push(...o),c.map(u=>t.startsWith("/")&&u===""?"/":u)}function vN(t){t.sort((e,r)=>e.score!==r.score?r.score-e.score:AN(e.routesMeta.map(n=>n.childrenIndex),r.routesMeta.map(n=>n.childrenIndex)))}const _N=/^:[\w-]+$/,xN=3,yN=2,wN=1,EN=10,bN=-2,x4=t=>t==="*";function SN(t,e){let r=t.split("/"),n=r.length;return r.some(x4)&&(n+=bN),e&&(n+=yN),r.filter(i=>!x4(i)).reduce((i,a)=>i+(_N.test(a)?xN:a===""?wN:EN),n)}function AN(t,e){return t.length===e.length&&t.slice(0,-1).every((n,i)=>n===e[i])?t[t.length-1]-e[e.length-1]:0}function TN(t,e,r){let{routesMeta:n}=t,i={},a="/",o=[];for(let c=0;c<n.length;++c){let u=n[c],h=c===n.length-1,d=a==="/"?e:e.slice(a.length)||"/",g=kN({path:u.relativePath,caseSensitive:u.caseSensitive,end:h},d),x=u.route;if(!g)return null;Object.assign(i,g.params),o.push({params:i,pathname:lf([a,g.pathname]),pathnameBase:DN(lf([a,g.pathnameBase])),route:x}),g.pathnameBase!=="/"&&(a=lf([a,g.pathnameBase]))}return o}function kN(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[r,n]=NN(t.path,t.caseSensitive,t.end),i=e.match(r);if(!i)return null;let a=i[0],o=a.replace(/(.)\/+$/,"$1"),c=i.slice(1);return{params:n.reduce((h,d,g)=>{let{paramName:x,isOptional:_}=d;if(x==="*"){let E=c[g]||"";o=a.slice(0,a.length-E.length).replace(/(.)\/+$/,"$1")}const b=c[g];return _&&!b?h[x]=void 0:h[x]=(b||"").replace(/%2F/g,"/"),h},{}),pathname:a,pathnameBase:o,pattern:t}}function NN(t,e,r){e===void 0&&(e=!1),r===void 0&&(r=!0),wx(t==="*"||!t.endsWith("*")||t.endsWith("/*"),'Route path "'+t+'" will be treated as if it were '+('"'+t.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+t.replace(/\*$/,"/*")+'".'));let n=[],i="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,c,u)=>(n.push({paramName:c,isOptional:u!=null}),u?"/?([^\\/]+)?":"/([^\\/]+)"));return t.endsWith("*")?(n.push({paramName:"*"}),i+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?i+="\\/*$":t!==""&&t!=="/"&&(i+="(?:(?=\\/|$))"),[new RegExp(i,e?void 0:"i"),n]}function CN(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return wx(!1,'The URL path "'+t+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),t}}function Ex(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let r=e.endsWith("/")?e.length-1:e.length,n=t.charAt(r);return n&&n!=="/"?null:t.slice(r)||"/"}function IN(t,e){e===void 0&&(e="/");let{pathname:r,search:n="",hash:i=""}=typeof t=="string"?Ih(t):t;return{pathname:r?r.startsWith("/")?r:RN(r,e):e,search:FN(n),hash:ON(i)}}function RN(t,e){let r=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(i=>{i===".."?r.length>1&&r.pop():i!=="."&&r.push(i)}),r.length>1?r.join("/"):"/"}function Pv(t,e,r,n){return"Cannot include a '"+t+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(n)+"].  Please separate it out to the ")+("`to."+r+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function LN(t){return t.filter((e,r)=>r===0||e.route.path&&e.route.path.length>0)}function bx(t,e){let r=LN(t);return e?r.map((n,i)=>i===r.length-1?n.pathname:n.pathnameBase):r.map(n=>n.pathnameBase)}function Sx(t,e,r,n){n===void 0&&(n=!1);let i;typeof t=="string"?i=Ih(t):(i=T1({},t),ki(!i.pathname||!i.pathname.includes("?"),Pv("?","pathname","search",i)),ki(!i.pathname||!i.pathname.includes("#"),Pv("#","pathname","hash",i)),ki(!i.search||!i.search.includes("#"),Pv("#","search","hash",i)));let a=t===""||i.pathname==="",o=a?"/":i.pathname,c;if(o==null)c=r;else{let g=e.length-1;if(!n&&o.startsWith("..")){let x=o.split("/");for(;x[0]==="..";)x.shift(),g-=1;i.pathname=x.join("/")}c=g>=0?e[g]:"/"}let u=IN(i,c),h=o&&o!=="/"&&o.endsWith("/"),d=(a||o===".")&&r.endsWith("/");return!u.pathname.endsWith("/")&&(h||d)&&(u.pathname+="/"),u}const lf=t=>t.join("/").replace(/\/\/+/g,"/"),DN=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),FN=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,ON=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function PN(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}const Pb=["post","put","patch","delete"];new Set(Pb);const MN=["get",...Pb];new Set(MN);/**
 * React Router v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function k1(){return k1=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},k1.apply(this,arguments)}const Ax=lt.createContext(null),BN=lt.createContext(null),kf=lt.createContext(null),qg=lt.createContext(null),Nf=lt.createContext({outlet:null,matches:[],isDataRoute:!1}),Mb=lt.createContext(null);function jN(t,e){let{relative:r}=e===void 0?{}:e;ed()||ki(!1);let{basename:n,navigator:i}=lt.useContext(kf),{hash:a,pathname:o,search:c}=jb(t,{relative:r}),u=o;return n!=="/"&&(u=o==="/"?n:lf([n,o])),i.createHref({pathname:u,search:c,hash:a})}function ed(){return lt.useContext(qg)!=null}function J1(){return ed()||ki(!1),lt.useContext(qg).location}function Bb(t){lt.useContext(kf).static||lt.useLayoutEffect(t)}function Tx(){let{isDataRoute:t}=lt.useContext(Nf);return t?JN():UN()}function UN(){ed()||ki(!1);let t=lt.useContext(Ax),{basename:e,future:r,navigator:n}=lt.useContext(kf),{matches:i}=lt.useContext(Nf),{pathname:a}=J1(),o=JSON.stringify(bx(i,r.v7_relativeSplatPath)),c=lt.useRef(!1);return Bb(()=>{c.current=!0}),lt.useCallback(function(h,d){if(d===void 0&&(d={}),!c.current)return;if(typeof h=="number"){n.go(h);return}let g=Sx(h,JSON.parse(o),a,d.relative==="path");t==null&&e!=="/"&&(g.pathname=g.pathname==="/"?e:lf([e,g.pathname])),(d.replace?n.replace:n.push)(g,d.state,d)},[e,n,o,a,t])}function jb(t,e){let{relative:r}=e===void 0?{}:e,{future:n}=lt.useContext(kf),{matches:i}=lt.useContext(Nf),{pathname:a}=J1(),o=JSON.stringify(bx(i,n.v7_relativeSplatPath));return lt.useMemo(()=>Sx(t,JSON.parse(o),a,r==="path"),[t,o,a,r])}function VN(t,e){return qN(t,e)}function qN(t,e,r,n){ed()||ki(!1);let{navigator:i}=lt.useContext(kf),{matches:a}=lt.useContext(Nf),o=a[a.length-1],c=o?o.params:{};o&&o.pathname;let u=o?o.pathnameBase:"/";o&&o.route;let h=J1(),d;if(e){var g;let A=typeof e=="string"?Ih(e):e;u==="/"||(g=A.pathname)!=null&&g.startsWith(u)||ki(!1),d=A}else d=h;let x=d.pathname||"/",_=x;if(u!=="/"){let A=u.replace(/^\//,"").split("/");_="/"+x.replace(/^\//,"").split("/").slice(A.length).join("/")}let b=mN(t,{pathname:_}),E=XN(b&&b.map(A=>Object.assign({},A,{params:Object.assign({},c,A.params),pathname:lf([u,i.encodeLocation?i.encodeLocation(A.pathname).pathname:A.pathname]),pathnameBase:A.pathnameBase==="/"?u:lf([u,i.encodeLocation?i.encodeLocation(A.pathnameBase).pathname:A.pathnameBase])})),a,r,n);return e&&E?lt.createElement(qg.Provider,{value:{location:k1({pathname:"/",search:"",hash:"",state:null,key:"default"},d),navigationType:rf.Pop}},E):E}function zN(){let t=QN(),e=PN(t)?t.status+" "+t.statusText:t instanceof Error?t.message:JSON.stringify(t),r=t instanceof Error?t.stack:null,i={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return lt.createElement(lt.Fragment,null,lt.createElement("h2",null,"Unexpected Application Error!"),lt.createElement("h3",{style:{fontStyle:"italic"}},e),r?lt.createElement("pre",{style:i},r):null,null)}const HN=lt.createElement(zN,null);class GN extends lt.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,r){return r.location!==e.location||r.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:r.error,location:r.location,revalidation:e.revalidation||r.revalidation}}componentDidCatch(e,r){console.error("React Router caught the following error during render",e,r)}render(){return this.state.error!==void 0?lt.createElement(Nf.Provider,{value:this.props.routeContext},lt.createElement(Mb.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function WN(t){let{routeContext:e,match:r,children:n}=t,i=lt.useContext(Ax);return i&&i.static&&i.staticContext&&(r.route.errorElement||r.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=r.route.id),lt.createElement(Nf.Provider,{value:e},n)}function XN(t,e,r,n){var i;if(e===void 0&&(e=[]),r===void 0&&(r=null),n===void 0&&(n=null),t==null){var a;if(!r)return null;if(r.errors)t=r.matches;else if((a=n)!=null&&a.v7_partialHydration&&e.length===0&&!r.initialized&&r.matches.length>0)t=r.matches;else return null}let o=t,c=(i=r)==null?void 0:i.errors;if(c!=null){let d=o.findIndex(g=>g.route.id&&c?.[g.route.id]!==void 0);d>=0||ki(!1),o=o.slice(0,Math.min(o.length,d+1))}let u=!1,h=-1;if(r&&n&&n.v7_partialHydration)for(let d=0;d<o.length;d++){let g=o[d];if((g.route.HydrateFallback||g.route.hydrateFallbackElement)&&(h=d),g.route.id){let{loaderData:x,errors:_}=r,b=g.route.loader&&x[g.route.id]===void 0&&(!_||_[g.route.id]===void 0);if(g.route.lazy||b){u=!0,h>=0?o=o.slice(0,h+1):o=[o[0]];break}}}return o.reduceRight((d,g,x)=>{let _,b=!1,E=null,A=null;r&&(_=c&&g.route.id?c[g.route.id]:void 0,E=g.route.errorElement||HN,u&&(h<0&&x===0?(ZN("route-fallback"),b=!0,A=null):h===x&&(b=!0,A=g.route.hydrateFallbackElement||null)));let O=e.concat(o.slice(0,x+1)),M=()=>{let B;return _?B=E:b?B=A:g.route.Component?B=lt.createElement(g.route.Component,null):g.route.element?B=g.route.element:B=d,lt.createElement(WN,{match:g,routeContext:{outlet:d,matches:O,isDataRoute:r!=null},children:B})};return r&&(g.route.ErrorBoundary||g.route.errorElement||x===0)?lt.createElement(GN,{location:r.location,revalidation:r.revalidation,component:E,error:_,children:M(),routeContext:{outlet:null,matches:O,isDataRoute:!0}}):M()},null)}var Ub=function(t){return t.UseBlocker="useBlocker",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t}(Ub||{}),Vb=function(t){return t.UseBlocker="useBlocker",t.UseLoaderData="useLoaderData",t.UseActionData="useActionData",t.UseRouteError="useRouteError",t.UseNavigation="useNavigation",t.UseRouteLoaderData="useRouteLoaderData",t.UseMatches="useMatches",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t.UseRouteId="useRouteId",t}(Vb||{});function YN(t){let e=lt.useContext(Ax);return e||ki(!1),e}function KN(t){let e=lt.useContext(BN);return e||ki(!1),e}function $N(t){let e=lt.useContext(Nf);return e||ki(!1),e}function qb(t){let e=$N(),r=e.matches[e.matches.length-1];return r.route.id||ki(!1),r.route.id}function QN(){var t;let e=lt.useContext(Mb),r=KN(),n=qb();return e!==void 0?e:(t=r.errors)==null?void 0:t[n]}function JN(){let{router:t}=YN(Ub.UseNavigateStable),e=qb(Vb.UseNavigateStable),r=lt.useRef(!1);return Bb(()=>{r.current=!0}),lt.useCallback(function(i,a){a===void 0&&(a={}),r.current&&(typeof i=="number"?t.navigate(i):t.navigate(i,k1({fromRouteId:e},a)))},[t,e])}const y4={};function ZN(t,e,r){y4[t]||(y4[t]=!0)}function eC(t,e){t?.v7_startTransition,t?.v7_relativeSplatPath}function ig(t){let{to:e,replace:r,state:n,relative:i}=t;ed()||ki(!1);let{future:a,static:o}=lt.useContext(kf),{matches:c}=lt.useContext(Nf),{pathname:u}=J1(),h=Tx(),d=Sx(e,bx(c,a.v7_relativeSplatPath),u,i==="path"),g=JSON.stringify(d);return lt.useEffect(()=>h(JSON.parse(g),{replace:r,state:n,relative:i}),[h,g,i,r,n]),null}function $c(t){ki(!1)}function tC(t){let{basename:e="/",children:r=null,location:n,navigationType:i=rf.Pop,navigator:a,static:o=!1,future:c}=t;ed()&&ki(!1);let u=e.replace(/^\/*/,"/"),h=lt.useMemo(()=>({basename:u,navigator:a,static:o,future:k1({v7_relativeSplatPath:!1},c)}),[u,c,a,o]);typeof n=="string"&&(n=Ih(n));let{pathname:d="/",search:g="",hash:x="",state:_=null,key:b="default"}=n,E=lt.useMemo(()=>{let A=Ex(d,u);return A==null?null:{location:{pathname:A,search:g,hash:x,state:_,key:b},navigationType:i}},[u,d,g,x,_,b,i]);return E==null?null:lt.createElement(kf.Provider,{value:h},lt.createElement(qg.Provider,{children:r,value:E}))}function rC(t){let{children:e,location:r}=t;return VN(y_(e),r)}new Promise(()=>{});function y_(t,e){e===void 0&&(e=[]);let r=[];return lt.Children.forEach(t,(n,i)=>{if(!lt.isValidElement(n))return;let a=[...e,i];if(n.type===lt.Fragment){r.push.apply(r,y_(n.props.children,a));return}n.type!==$c&&ki(!1),!n.props.index||!n.props.children||ki(!1);let o={id:n.props.id||a.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,loader:n.props.loader,action:n.props.action,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(o.children=y_(n.props.children,a)),r.push(o)}),r}/**
 * React Router DOM v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function w_(){return w_=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},w_.apply(this,arguments)}function nC(t,e){if(t==null)return{};var r={},n=Object.keys(t),i,a;for(a=0;a<n.length;a++)i=n[a],!(e.indexOf(i)>=0)&&(r[i]=t[i]);return r}function iC(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function aC(t,e){return t.button===0&&(!e||e==="_self")&&!iC(t)}const sC=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],oC="6";try{window.__reactRouterVersion=oC}catch{}const lC="startTransition",w4=iN[lC];function cC(t){let{basename:e,children:r,future:n,window:i}=t,a=lt.useRef();a.current==null&&(a.current=hN({window:i,v5Compat:!0}));let o=a.current,[c,u]=lt.useState({action:o.action,location:o.location}),{v7_startTransition:h}=n||{},d=lt.useCallback(g=>{h&&w4?w4(()=>u(g)):u(g)},[u,h]);return lt.useLayoutEffect(()=>o.listen(d),[o,d]),lt.useEffect(()=>eC(n),[n]),lt.createElement(tC,{basename:e,children:r,location:c.location,navigationType:c.action,navigator:o,future:n})}const uC=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",fC=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,ih=lt.forwardRef(function(e,r){let{onClick:n,relative:i,reloadDocument:a,replace:o,state:c,target:u,to:h,preventScrollReset:d,viewTransition:g}=e,x=nC(e,sC),{basename:_}=lt.useContext(kf),b,E=!1;if(typeof h=="string"&&fC.test(h)&&(b=h,uC))try{let B=new URL(window.location.href),Q=h.startsWith("//")?new URL(B.protocol+h):new URL(h),ee=Ex(Q.pathname,_);Q.origin===B.origin&&ee!=null?h=ee+Q.search+Q.hash:E=!0}catch{}let A=jN(h,{relative:i}),O=hC(h,{replace:o,state:c,target:u,preventScrollReset:d,relative:i,viewTransition:g});function M(B){n&&n(B),B.defaultPrevented||O(B)}return lt.createElement("a",w_({},x,{href:b||A,onClick:E||a?n:M,ref:r,target:u}))});var E4;(function(t){t.UseScrollRestoration="useScrollRestoration",t.UseSubmit="useSubmit",t.UseSubmitFetcher="useSubmitFetcher",t.UseFetcher="useFetcher",t.useViewTransitionState="useViewTransitionState"})(E4||(E4={}));var b4;(function(t){t.UseFetcher="useFetcher",t.UseFetchers="useFetchers",t.UseScrollRestoration="useScrollRestoration"})(b4||(b4={}));function hC(t,e){let{target:r,replace:n,state:i,preventScrollReset:a,relative:o,viewTransition:c}=e===void 0?{}:e,u=Tx(),h=J1(),d=jb(t,{relative:o});return lt.useCallback(g=>{if(aC(g,r)){g.preventDefault();let x=n!==void 0?n:ng(h)===ng(d);u(t,{replace:x,state:i,preventScrollReset:a,relative:o,viewTransition:c})}},[h,u,d,n,i,r,t,a,o,c])}const dC=()=>{};var S4={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zb=function(t){const e=[];let r=0;for(let n=0;n<t.length;n++){let i=t.charCodeAt(n);i<128?e[r++]=i:i<2048?(e[r++]=i>>6|192,e[r++]=i&63|128):(i&64512)===55296&&n+1<t.length&&(t.charCodeAt(n+1)&64512)===56320?(i=65536+((i&1023)<<10)+(t.charCodeAt(++n)&1023),e[r++]=i>>18|240,e[r++]=i>>12&63|128,e[r++]=i>>6&63|128,e[r++]=i&63|128):(e[r++]=i>>12|224,e[r++]=i>>6&63|128,e[r++]=i&63|128)}return e},pC=function(t){const e=[];let r=0,n=0;for(;r<t.length;){const i=t[r++];if(i<128)e[n++]=String.fromCharCode(i);else if(i>191&&i<224){const a=t[r++];e[n++]=String.fromCharCode((i&31)<<6|a&63)}else if(i>239&&i<365){const a=t[r++],o=t[r++],c=t[r++],u=((i&7)<<18|(a&63)<<12|(o&63)<<6|c&63)-65536;e[n++]=String.fromCharCode(55296+(u>>10)),e[n++]=String.fromCharCode(56320+(u&1023))}else{const a=t[r++],o=t[r++];e[n++]=String.fromCharCode((i&15)<<12|(a&63)<<6|o&63)}}return e.join("")},Hb={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const r=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,n=[];for(let i=0;i<t.length;i+=3){const a=t[i],o=i+1<t.length,c=o?t[i+1]:0,u=i+2<t.length,h=u?t[i+2]:0,d=a>>2,g=(a&3)<<4|c>>4;let x=(c&15)<<2|h>>6,_=h&63;u||(_=64,o||(x=64)),n.push(r[d],r[g],r[x],r[_])}return n.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(zb(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):pC(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const r=e?this.charToByteMapWebSafe_:this.charToByteMap_,n=[];for(let i=0;i<t.length;){const a=r[t.charAt(i++)],c=i<t.length?r[t.charAt(i)]:0;++i;const h=i<t.length?r[t.charAt(i)]:64;++i;const g=i<t.length?r[t.charAt(i)]:64;if(++i,a==null||c==null||h==null||g==null)throw new mC;const x=a<<2|c>>4;if(n.push(x),h!==64){const _=c<<4&240|h>>2;if(n.push(_),g!==64){const b=h<<6&192|g;n.push(b)}}}return n},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class mC extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const gC=function(t){const e=zb(t);return Hb.encodeByteArray(e,!0)},ag=function(t){return gC(t).replace(/\./g,"")},Gb=function(t){try{return Hb.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vC(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _C=()=>vC().__FIREBASE_DEFAULTS__,xC=()=>{if(typeof process>"u"||typeof S4>"u")return;const t=S4.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},yC=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&Gb(t[1]);return e&&JSON.parse(e)},zg=()=>{try{return dC()||_C()||xC()||yC()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},Wb=t=>{var e,r;return(r=(e=zg())===null||e===void 0?void 0:e.emulatorHosts)===null||r===void 0?void 0:r[t]},wC=t=>{const e=Wb(t);if(!e)return;const r=e.lastIndexOf(":");if(r<=0||r+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const n=parseInt(e.substring(r+1),10);return e[0]==="["?[e.substring(1,r-1),n]:[e.substring(0,r),n]},Xb=()=>{var t;return(t=zg())===null||t===void 0?void 0:t.config},Yb=t=>{var e;return(e=zg())===null||e===void 0?void 0:e[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EC{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,r)=>{this.resolve=e,this.reject=r})}wrapCallback(e){return(r,n)=>{r?this.reject(r):this.resolve(n),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(r):e(r,n))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function td(t){try{return(t.startsWith("http://")||t.startsWith("https://")?new URL(t).hostname:t).endsWith(".cloudworkstations.dev")}catch{return!1}}async function Kb(t){return(await fetch(t,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bC(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const r={alg:"none",type:"JWT"},n=e||"demo-project",i=t.iat||0,a=t.sub||t.user_id;if(!a)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o=Object.assign({iss:`https://securetoken.google.com/${n}`,aud:n,iat:i,exp:i+3600,auth_time:i,sub:a,user_id:a,firebase:{sign_in_provider:"custom",identities:{}}},t);return[ag(JSON.stringify(r)),ag(JSON.stringify(o)),""].join(".")}const f1={};function SC(){const t={prod:[],emulator:[]};for(const e of Object.keys(f1))f1[e]?t.emulator.push(e):t.prod.push(e);return t}function AC(t){let e=document.getElementById(t),r=!1;return e||(e=document.createElement("div"),e.setAttribute("id",t),r=!0),{created:r,element:e}}let A4=!1;function $b(t,e){if(typeof window>"u"||typeof document>"u"||!td(window.location.host)||f1[t]===e||f1[t]||A4)return;f1[t]=e;function r(x){return`__firebase__banner__${x}`}const n="__firebase__banner",a=SC().prod.length>0;function o(){const x=document.getElementById(n);x&&x.remove()}function c(x){x.style.display="flex",x.style.background="#7faaf0",x.style.position="fixed",x.style.bottom="5px",x.style.left="5px",x.style.padding=".5em",x.style.borderRadius="5px",x.style.alignItems="center"}function u(x,_){x.setAttribute("width","24"),x.setAttribute("id",_),x.setAttribute("height","24"),x.setAttribute("viewBox","0 0 24 24"),x.setAttribute("fill","none"),x.style.marginLeft="-6px"}function h(){const x=document.createElement("span");return x.style.cursor="pointer",x.style.marginLeft="16px",x.style.fontSize="24px",x.innerHTML=" &times;",x.onclick=()=>{A4=!0,o()},x}function d(x,_){x.setAttribute("id",_),x.innerText="Learn more",x.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",x.setAttribute("target","__blank"),x.style.paddingLeft="5px",x.style.textDecoration="underline"}function g(){const x=AC(n),_=r("text"),b=document.getElementById(_)||document.createElement("span"),E=r("learnmore"),A=document.getElementById(E)||document.createElement("a"),O=r("preprendIcon"),M=document.getElementById(O)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(x.created){const B=x.element;c(B),d(A,E);const Q=h();u(M,O),B.append(M,b,A,Q),document.body.appendChild(B)}a?(b.innerText="Preview backend disconnected.",M.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(M.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,b.innerText="Preview backend running in this workspace."),b.setAttribute("id",_)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",g):g()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ns(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function TC(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(ns())}function kC(){var t;const e=(t=zg())===null||t===void 0?void 0:t.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function NC(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function CC(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function IC(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function RC(){const t=ns();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function LC(){return!kC()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function DC(){try{return typeof indexedDB=="object"}catch{return!1}}function FC(){return new Promise((t,e)=>{try{let r=!0;const n="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(n);i.onsuccess=()=>{i.result.close(),r||self.indexedDB.deleteDatabase(n),t(!0)},i.onupgradeneeded=()=>{r=!1},i.onerror=()=>{var a;e(((a=i.error)===null||a===void 0?void 0:a.message)||"")}}catch(r){e(r)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const OC="FirebaseError";class uu extends Error{constructor(e,r,n){super(r),this.code=e,this.customData=n,this.name=OC,Object.setPrototypeOf(this,uu.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Z1.prototype.create)}}class Z1{constructor(e,r,n){this.service=e,this.serviceName=r,this.errors=n}create(e,...r){const n=r[0]||{},i=`${this.service}/${e}`,a=this.errors[e],o=a?PC(a,n):"Error",c=`${this.serviceName}: ${o} (${i}).`;return new uu(i,c,n)}}function PC(t,e){return t.replace(MC,(r,n)=>{const i=e[n];return i!=null?String(i):`<${n}?>`})}const MC=/\{\$([^}]+)}/g;function BC(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function _h(t,e){if(t===e)return!0;const r=Object.keys(t),n=Object.keys(e);for(const i of r){if(!n.includes(i))return!1;const a=t[i],o=e[i];if(T4(a)&&T4(o)){if(!_h(a,o))return!1}else if(a!==o)return!1}for(const i of n)if(!r.includes(i))return!1;return!0}function T4(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ep(t){const e=[];for(const[r,n]of Object.entries(t))Array.isArray(n)?n.forEach(i=>{e.push(encodeURIComponent(r)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(r)+"="+encodeURIComponent(n));return e.length?"&"+e.join("&"):""}function r1(t){const e={};return t.replace(/^\?/,"").split("&").forEach(n=>{if(n){const[i,a]=n.split("=");e[decodeURIComponent(i)]=decodeURIComponent(a)}}),e}function n1(t){const e=t.indexOf("?");if(!e)return"";const r=t.indexOf("#",e);return t.substring(e,r>0?r:void 0)}function jC(t,e){const r=new UC(t,e);return r.subscribe.bind(r)}class UC{constructor(e,r){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=r,this.task.then(()=>{e(this)}).catch(n=>{this.error(n)})}next(e){this.forEachObserver(r=>{r.next(e)})}error(e){this.forEachObserver(r=>{r.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,r,n){let i;if(e===void 0&&r===void 0&&n===void 0)throw new Error("Missing Observer.");VC(e,["next","error","complete"])?i=e:i={next:e,error:r,complete:n},i.next===void 0&&(i.next=Mv),i.error===void 0&&(i.error=Mv),i.complete===void 0&&(i.complete=Mv);const a=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),a}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let r=0;r<this.observers.length;r++)this.sendOne(r,e)}sendOne(e,r){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{r(this.observers[e])}catch(n){typeof console<"u"&&console.error&&console.error(n)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function VC(t,e){if(typeof t!="object"||t===null)return!1;for(const r of e)if(r in t&&typeof t[r]=="function")return!0;return!1}function Mv(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ma(t){return t&&t._delegate?t._delegate:t}class xh{constructor(e,r,n){this.name=e,this.instanceFactory=r,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ah="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qC{constructor(e,r){this.name=e,this.container=r,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const r=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(r)){const n=new EC;if(this.instancesDeferred.set(r,n),this.isInitialized(r)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:r});i&&n.resolve(i)}catch{}}return this.instancesDeferred.get(r).promise}getImmediate(e){var r;const n=this.normalizeInstanceIdentifier(e?.identifier),i=(r=e?.optional)!==null&&r!==void 0?r:!1;if(this.isInitialized(n)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:n})}catch(a){if(i)return null;throw a}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(HC(e))try{this.getOrInitializeService({instanceIdentifier:ah})}catch{}for(const[r,n]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(r);try{const a=this.getOrInitializeService({instanceIdentifier:i});n.resolve(a)}catch{}}}}clearInstance(e=ah){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(r=>"INTERNAL"in r).map(r=>r.INTERNAL.delete()),...e.filter(r=>"_delete"in r).map(r=>r._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=ah){return this.instances.has(e)}getOptions(e=ah){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:r={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:n,options:r});for(const[a,o]of this.instancesDeferred.entries()){const c=this.normalizeInstanceIdentifier(a);n===c&&o.resolve(i)}return i}onInit(e,r){var n;const i=this.normalizeInstanceIdentifier(r),a=(n=this.onInitCallbacks.get(i))!==null&&n!==void 0?n:new Set;a.add(e),this.onInitCallbacks.set(i,a);const o=this.instances.get(i);return o&&e(o,i),()=>{a.delete(e)}}invokeOnInitCallbacks(e,r){const n=this.onInitCallbacks.get(r);if(n)for(const i of n)try{i(e,r)}catch{}}getOrInitializeService({instanceIdentifier:e,options:r={}}){let n=this.instances.get(e);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:zC(e),options:r}),this.instances.set(e,n),this.instancesOptions.set(e,r),this.invokeOnInitCallbacks(n,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,n)}catch{}return n||null}normalizeInstanceIdentifier(e=ah){return this.component?this.component.multipleInstances?e:ah:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function zC(t){return t===ah?void 0:t}function HC(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GC{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const r=this.getProvider(e.name);if(r.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);r.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const r=new qC(e,this);return this.providers.set(e,r),r}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Vr;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(Vr||(Vr={}));const WC={debug:Vr.DEBUG,verbose:Vr.VERBOSE,info:Vr.INFO,warn:Vr.WARN,error:Vr.ERROR,silent:Vr.SILENT},XC=Vr.INFO,YC={[Vr.DEBUG]:"log",[Vr.VERBOSE]:"log",[Vr.INFO]:"info",[Vr.WARN]:"warn",[Vr.ERROR]:"error"},KC=(t,e,...r)=>{if(e<t.logLevel)return;const n=new Date().toISOString(),i=YC[e];if(i)console[i](`[${n}]  ${t.name}:`,...r);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class kx{constructor(e){this.name=e,this._logLevel=XC,this._logHandler=KC,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Vr))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?WC[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Vr.DEBUG,...e),this._logHandler(this,Vr.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Vr.VERBOSE,...e),this._logHandler(this,Vr.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Vr.INFO,...e),this._logHandler(this,Vr.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Vr.WARN,...e),this._logHandler(this,Vr.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Vr.ERROR,...e),this._logHandler(this,Vr.ERROR,...e)}}const $C=(t,e)=>e.some(r=>t instanceof r);let k4,N4;function QC(){return k4||(k4=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function JC(){return N4||(N4=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const Qb=new WeakMap,E_=new WeakMap,Jb=new WeakMap,Bv=new WeakMap,Nx=new WeakMap;function ZC(t){const e=new Promise((r,n)=>{const i=()=>{t.removeEventListener("success",a),t.removeEventListener("error",o)},a=()=>{r(cf(t.result)),i()},o=()=>{n(t.error),i()};t.addEventListener("success",a),t.addEventListener("error",o)});return e.then(r=>{r instanceof IDBCursor&&Qb.set(r,t)}).catch(()=>{}),Nx.set(e,t),e}function eI(t){if(E_.has(t))return;const e=new Promise((r,n)=>{const i=()=>{t.removeEventListener("complete",a),t.removeEventListener("error",o),t.removeEventListener("abort",o)},a=()=>{r(),i()},o=()=>{n(t.error||new DOMException("AbortError","AbortError")),i()};t.addEventListener("complete",a),t.addEventListener("error",o),t.addEventListener("abort",o)});E_.set(t,e)}let b_={get(t,e,r){if(t instanceof IDBTransaction){if(e==="done")return E_.get(t);if(e==="objectStoreNames")return t.objectStoreNames||Jb.get(t);if(e==="store")return r.objectStoreNames[1]?void 0:r.objectStore(r.objectStoreNames[0])}return cf(t[e])},set(t,e,r){return t[e]=r,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function tI(t){b_=t(b_)}function rI(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...r){const n=t.call(jv(this),e,...r);return Jb.set(n,e.sort?e.sort():[e]),cf(n)}:JC().includes(t)?function(...e){return t.apply(jv(this),e),cf(Qb.get(this))}:function(...e){return cf(t.apply(jv(this),e))}}function nI(t){return typeof t=="function"?rI(t):(t instanceof IDBTransaction&&eI(t),$C(t,QC())?new Proxy(t,b_):t)}function cf(t){if(t instanceof IDBRequest)return ZC(t);if(Bv.has(t))return Bv.get(t);const e=nI(t);return e!==t&&(Bv.set(t,e),Nx.set(e,t)),e}const jv=t=>Nx.get(t);function iI(t,e,{blocked:r,upgrade:n,blocking:i,terminated:a}={}){const o=indexedDB.open(t,e),c=cf(o);return n&&o.addEventListener("upgradeneeded",u=>{n(cf(o.result),u.oldVersion,u.newVersion,cf(o.transaction),u)}),r&&o.addEventListener("blocked",u=>r(u.oldVersion,u.newVersion,u)),c.then(u=>{a&&u.addEventListener("close",()=>a()),i&&u.addEventListener("versionchange",h=>i(h.oldVersion,h.newVersion,h))}).catch(()=>{}),c}const aI=["get","getKey","getAll","getAllKeys","count"],sI=["put","add","delete","clear"],Uv=new Map;function C4(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(Uv.get(e))return Uv.get(e);const r=e.replace(/FromIndex$/,""),n=e!==r,i=sI.includes(r);if(!(r in(n?IDBIndex:IDBObjectStore).prototype)||!(i||aI.includes(r)))return;const a=async function(o,...c){const u=this.transaction(o,i?"readwrite":"readonly");let h=u.store;return n&&(h=h.index(c.shift())),(await Promise.all([h[r](...c),i&&u.done]))[0]};return Uv.set(e,a),a}tI(t=>({...t,get:(e,r,n)=>C4(e,r)||t.get(e,r,n),has:(e,r)=>!!C4(e,r)||t.has(e,r)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oI{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(r=>{if(lI(r)){const n=r.getImmediate();return`${n.library}/${n.version}`}else return null}).filter(r=>r).join(" ")}}function lI(t){const e=t.getComponent();return e?.type==="VERSION"}const S_="@firebase/app",I4="0.13.2";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const au=new kx("@firebase/app"),cI="@firebase/app-compat",uI="@firebase/analytics-compat",fI="@firebase/analytics",hI="@firebase/app-check-compat",dI="@firebase/app-check",pI="@firebase/auth",mI="@firebase/auth-compat",gI="@firebase/database",vI="@firebase/data-connect",_I="@firebase/database-compat",xI="@firebase/functions",yI="@firebase/functions-compat",wI="@firebase/installations",EI="@firebase/installations-compat",bI="@firebase/messaging",SI="@firebase/messaging-compat",AI="@firebase/performance",TI="@firebase/performance-compat",kI="@firebase/remote-config",NI="@firebase/remote-config-compat",CI="@firebase/storage",II="@firebase/storage-compat",RI="@firebase/firestore",LI="@firebase/ai",DI="@firebase/firestore-compat",FI="firebase",OI="11.10.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const A_="[DEFAULT]",PI={[S_]:"fire-core",[cI]:"fire-core-compat",[fI]:"fire-analytics",[uI]:"fire-analytics-compat",[dI]:"fire-app-check",[hI]:"fire-app-check-compat",[pI]:"fire-auth",[mI]:"fire-auth-compat",[gI]:"fire-rtdb",[vI]:"fire-data-connect",[_I]:"fire-rtdb-compat",[xI]:"fire-fn",[yI]:"fire-fn-compat",[wI]:"fire-iid",[EI]:"fire-iid-compat",[bI]:"fire-fcm",[SI]:"fire-fcm-compat",[AI]:"fire-perf",[TI]:"fire-perf-compat",[kI]:"fire-rc",[NI]:"fire-rc-compat",[CI]:"fire-gcs",[II]:"fire-gcs-compat",[RI]:"fire-fst",[DI]:"fire-fst-compat",[LI]:"fire-vertex","fire-js":"fire-js",[FI]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sg=new Map,MI=new Map,T_=new Map;function R4(t,e){try{t.container.addComponent(e)}catch(r){au.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,r)}}function G0(t){const e=t.name;if(T_.has(e))return au.debug(`There were multiple attempts to register component ${e}.`),!1;T_.set(e,t);for(const r of sg.values())R4(r,t);for(const r of MI.values())R4(r,t);return!0}function Cx(t,e){const r=t.container.getProvider("heartbeat").getImmediate({optional:!0});return r&&r.triggerHeartbeat(),t.container.getProvider(e)}function Mo(t){return t==null?!1:t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const BI={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},uf=new Z1("app","Firebase",BI);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jI{constructor(e,r,n){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},r),this._name=r.name,this._automaticDataCollectionEnabled=r.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new xh("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw uf.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rd=OI;function Zb(t,e={}){let r=t;typeof e!="object"&&(e={name:e});const n=Object.assign({name:A_,automaticDataCollectionEnabled:!0},e),i=n.name;if(typeof i!="string"||!i)throw uf.create("bad-app-name",{appName:String(i)});if(r||(r=Xb()),!r)throw uf.create("no-options");const a=sg.get(i);if(a){if(_h(r,a.options)&&_h(n,a.config))return a;throw uf.create("duplicate-app",{appName:i})}const o=new GC(i);for(const u of T_.values())o.addComponent(u);const c=new jI(r,n,o);return sg.set(i,c),c}function eS(t=A_){const e=sg.get(t);if(!e&&t===A_&&Xb())return Zb();if(!e)throw uf.create("no-app",{appName:t});return e}function ff(t,e,r){var n;let i=(n=PI[t])!==null&&n!==void 0?n:t;r&&(i+=`-${r}`);const a=i.match(/\s|\//),o=e.match(/\s|\//);if(a||o){const c=[`Unable to register library "${i}" with version "${e}":`];a&&c.push(`library name "${i}" contains illegal characters (whitespace or "/")`),a&&o&&c.push("and"),o&&c.push(`version name "${e}" contains illegal characters (whitespace or "/")`),au.warn(c.join(" "));return}G0(new xh(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const UI="firebase-heartbeat-database",VI=1,N1="firebase-heartbeat-store";let Vv=null;function tS(){return Vv||(Vv=iI(UI,VI,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(N1)}catch(r){console.warn(r)}}}}).catch(t=>{throw uf.create("idb-open",{originalErrorMessage:t.message})})),Vv}async function qI(t){try{const r=(await tS()).transaction(N1),n=await r.objectStore(N1).get(rS(t));return await r.done,n}catch(e){if(e instanceof uu)au.warn(e.message);else{const r=uf.create("idb-get",{originalErrorMessage:e?.message});au.warn(r.message)}}}async function L4(t,e){try{const n=(await tS()).transaction(N1,"readwrite");await n.objectStore(N1).put(e,rS(t)),await n.done}catch(r){if(r instanceof uu)au.warn(r.message);else{const n=uf.create("idb-set",{originalErrorMessage:r?.message});au.warn(n.message)}}}function rS(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zI=1024,HI=30;class GI{constructor(e){this.container=e,this._heartbeatsCache=null;const r=this.container.getProvider("app").getImmediate();this._storage=new XI(r),this._heartbeatsCachePromise=this._storage.read().then(n=>(this._heartbeatsCache=n,n))}async triggerHeartbeat(){var e,r;try{const i=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),a=D4();if(((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((r=this._heartbeatsCache)===null||r===void 0?void 0:r.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===a||this._heartbeatsCache.heartbeats.some(o=>o.date===a))return;if(this._heartbeatsCache.heartbeats.push({date:a,agent:i}),this._heartbeatsCache.heartbeats.length>HI){const o=YI(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(o,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(n){au.warn(n)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const r=D4(),{heartbeatsToSend:n,unsentEntries:i}=WI(this._heartbeatsCache.heartbeats),a=ag(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=r,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),a}catch(r){return au.warn(r),""}}}function D4(){return new Date().toISOString().substring(0,10)}function WI(t,e=zI){const r=[];let n=t.slice();for(const i of t){const a=r.find(o=>o.agent===i.agent);if(a){if(a.dates.push(i.date),F4(r)>e){a.dates.pop();break}}else if(r.push({agent:i.agent,dates:[i.date]}),F4(r)>e){r.pop();break}n=n.slice(1)}return{heartbeatsToSend:r,unsentEntries:n}}class XI{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return DC()?FC().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const r=await qI(this.app);return r?.heartbeats?r:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var r;if(await this._canUseIndexedDBPromise){const i=await this.read();return L4(this.app,{lastSentHeartbeatDate:(r=e.lastSentHeartbeatDate)!==null&&r!==void 0?r:i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var r;if(await this._canUseIndexedDBPromise){const i=await this.read();return L4(this.app,{lastSentHeartbeatDate:(r=e.lastSentHeartbeatDate)!==null&&r!==void 0?r:i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return}}function F4(t){return ag(JSON.stringify({version:2,heartbeats:t})).length}function YI(t){if(t.length===0)return-1;let e=0,r=t[0].date;for(let n=1;n<t.length;n++)t[n].date<r&&(r=t[n].date,e=n);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function KI(t){G0(new xh("platform-logger",e=>new oI(e),"PRIVATE")),G0(new xh("heartbeat",e=>new GI(e),"PRIVATE")),ff(S_,I4,t),ff(S_,I4,"esm2017"),ff("fire-js","")}KI("");function Ix(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(t);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(t,n[i])&&(r[n[i]]=t[n[i]]);return r}function nS(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const $I=nS,iS=new Z1("auth","Firebase",nS());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const og=new kx("@firebase/auth");function QI(t,...e){og.logLevel<=Vr.WARN&&og.warn(`Auth (${rd}): ${t}`,...e)}function Um(t,...e){og.logLevel<=Vr.ERROR&&og.error(`Auth (${rd}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wl(t,...e){throw Rx(t,...e)}function cc(t,...e){return Rx(t,...e)}function aS(t,e,r){const n=Object.assign(Object.assign({},$I()),{[e]:r});return new Z1("auth","Firebase",n).create(e,{appName:t.name})}function eu(t){return aS(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function Rx(t,...e){if(typeof t!="string"){const r=e[0],n=[...e.slice(1)];return n[0]&&(n[0].appName=t.name),t._errorFactory.create(r,...n)}return iS.create(t,...e)}function fr(t,e,...r){if(!t)throw Rx(e,...r)}function Qc(t){const e="INTERNAL ASSERTION FAILED: "+t;throw Um(e),new Error(e)}function su(t,e){t||Qc(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function k_(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.href)||""}function JI(){return O4()==="http:"||O4()==="https:"}function O4(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ZI(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(JI()||CC()||"connection"in navigator)?navigator.onLine:!0}function eR(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tp{constructor(e,r){this.shortDelay=e,this.longDelay=r,su(r>e,"Short delay should be less than long delay!"),this.isMobile=TC()||IC()}get(){return ZI()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Lx(t,e){su(t.emulator,"Emulator should always be set here");const{url:r}=t.emulator;return e?`${r}${e.startsWith("/")?e.slice(1):e}`:r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sS{static initialize(e,r,n){this.fetchImpl=e,r&&(this.headersImpl=r),n&&(this.responseImpl=n)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Qc("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Qc("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Qc("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tR={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rR=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],nR=new tp(3e4,6e4);function Cf(t,e){return t.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:t.tenantId}):e}async function If(t,e,r,n,i={}){return oS(t,i,async()=>{let a={},o={};n&&(e==="GET"?o=n:a={body:JSON.stringify(n)});const c=ep(Object.assign({key:t.config.apiKey},o)).slice(1),u=await t._getAdditionalHeaders();u["Content-Type"]="application/json",t.languageCode&&(u["X-Firebase-Locale"]=t.languageCode);const h=Object.assign({method:e,headers:u},a);return NC()||(h.referrerPolicy="no-referrer"),t.emulatorConfig&&td(t.emulatorConfig.host)&&(h.credentials="include"),sS.fetch()(await lS(t,t.config.apiHost,r,c),h)})}async function oS(t,e,r){t._canInitEmulator=!1;const n=Object.assign(Object.assign({},tR),e);try{const i=new aR(t),a=await Promise.race([r(),i.promise]);i.clearNetworkTimeout();const o=await a.json();if("needConfirmation"in o)throw _m(t,"account-exists-with-different-credential",o);if(a.ok&&!("errorMessage"in o))return o;{const c=a.ok?o.errorMessage:o.error.message,[u,h]=c.split(" : ");if(u==="FEDERATED_USER_ID_ALREADY_LINKED")throw _m(t,"credential-already-in-use",o);if(u==="EMAIL_EXISTS")throw _m(t,"email-already-in-use",o);if(u==="USER_DISABLED")throw _m(t,"user-disabled",o);const d=n[u]||u.toLowerCase().replace(/[_\s]+/g,"-");if(h)throw aS(t,d,h);wl(t,d)}}catch(i){if(i instanceof uu)throw i;wl(t,"network-request-failed",{message:String(i)})}}async function rp(t,e,r,n,i={}){const a=await If(t,e,r,n,i);return"mfaPendingCredential"in a&&wl(t,"multi-factor-auth-required",{_serverResponse:a}),a}async function lS(t,e,r,n){const i=`${e}${r}?${n}`,a=t,o=a.config.emulator?Lx(t.config,i):`${t.config.apiScheme}://${i}`;return rR.includes(r)&&(await a._persistenceManagerAvailable,a._getPersistenceType()==="COOKIE")?a._getPersistence()._getFinalTarget(o).toString():o}function iR(t){switch(t){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class aR{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((r,n)=>{this.timer=setTimeout(()=>n(cc(this.auth,"network-request-failed")),nR.get())})}}function _m(t,e,r){const n={appName:t.name};r.email&&(n.email=r.email),r.phoneNumber&&(n.phoneNumber=r.phoneNumber);const i=cc(t,e,n);return i.customData._tokenResponse=r,i}function P4(t){return t!==void 0&&t.enterprise!==void 0}class sR{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const r of this.recaptchaEnforcementState)if(r.provider&&r.provider===e)return iR(r.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function oR(t,e){return If(t,"GET","/v2/recaptchaConfig",Cf(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function lR(t,e){return If(t,"POST","/v1/accounts:delete",e)}async function lg(t,e){return If(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function h1(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function cR(t,e=!1){const r=ma(t),n=await r.getIdToken(e),i=Dx(n);fr(i&&i.exp&&i.auth_time&&i.iat,r.auth,"internal-error");const a=typeof i.firebase=="object"?i.firebase:void 0,o=a?.sign_in_provider;return{claims:i,token:n,authTime:h1(qv(i.auth_time)),issuedAtTime:h1(qv(i.iat)),expirationTime:h1(qv(i.exp)),signInProvider:o||null,signInSecondFactor:a?.sign_in_second_factor||null}}function qv(t){return Number(t)*1e3}function Dx(t){const[e,r,n]=t.split(".");if(e===void 0||r===void 0||n===void 0)return Um("JWT malformed, contained fewer than 3 sections"),null;try{const i=Gb(r);return i?JSON.parse(i):(Um("Failed to decode base64 JWT payload"),null)}catch(i){return Um("Caught error parsing JWT payload as JSON",i?.toString()),null}}function M4(t){const e=Dx(t);return fr(e,"internal-error"),fr(typeof e.exp<"u","internal-error"),fr(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function C1(t,e,r=!1){if(r)return e;try{return await e}catch(n){throw n instanceof uu&&uR(n)&&t.auth.currentUser===t&&await t.auth.signOut(),n}}function uR({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fR{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var r;if(e){const n=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),n}else{this.errorBackoff=3e4;const i=((r=this.user.stsTokenManager.expirationTime)!==null&&r!==void 0?r:0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;const r=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},r)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class N_{constructor(e,r){this.createdAt=e,this.lastLoginAt=r,this._initializeTime()}_initializeTime(){this.lastSignInTime=h1(this.lastLoginAt),this.creationTime=h1(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function cg(t){var e;const r=t.auth,n=await t.getIdToken(),i=await C1(t,lg(r,{idToken:n}));fr(i?.users.length,r,"internal-error");const a=i.users[0];t._notifyReloadListener(a);const o=!((e=a.providerUserInfo)===null||e===void 0)&&e.length?cS(a.providerUserInfo):[],c=dR(t.providerData,o),u=t.isAnonymous,h=!(t.email&&a.passwordHash)&&!c?.length,d=u?h:!1,g={uid:a.localId,displayName:a.displayName||null,photoURL:a.photoUrl||null,email:a.email||null,emailVerified:a.emailVerified||!1,phoneNumber:a.phoneNumber||null,tenantId:a.tenantId||null,providerData:c,metadata:new N_(a.createdAt,a.lastLoginAt),isAnonymous:d};Object.assign(t,g)}async function hR(t){const e=ma(t);await cg(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function dR(t,e){return[...t.filter(n=>!e.some(i=>i.providerId===n.providerId)),...e]}function cS(t){return t.map(e=>{var{providerId:r}=e,n=Ix(e,["providerId"]);return{providerId:r,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function pR(t,e){const r=await oS(t,{},async()=>{const n=ep({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:a}=t.config,o=await lS(t,i,"/v1/token",`key=${a}`),c=await t._getAdditionalHeaders();c["Content-Type"]="application/x-www-form-urlencoded";const u={method:"POST",headers:c,body:n};return t.emulatorConfig&&td(t.emulatorConfig.host)&&(u.credentials="include"),sS.fetch()(o,u)});return{accessToken:r.access_token,expiresIn:r.expires_in,refreshToken:r.refresh_token}}async function mR(t,e){return If(t,"POST","/v2/accounts:revokeToken",Cf(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class L0{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){fr(e.idToken,"internal-error"),fr(typeof e.idToken<"u","internal-error"),fr(typeof e.refreshToken<"u","internal-error");const r="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):M4(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,r)}updateFromIdToken(e){fr(e.length!==0,"internal-error");const r=M4(e);this.updateTokensAndExpiration(e,null,r)}async getToken(e,r=!1){return!r&&this.accessToken&&!this.isExpired?this.accessToken:(fr(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,r){const{accessToken:n,refreshToken:i,expiresIn:a}=await pR(e,r);this.updateTokensAndExpiration(n,i,Number(a))}updateTokensAndExpiration(e,r,n){this.refreshToken=r||null,this.accessToken=e||null,this.expirationTime=Date.now()+n*1e3}static fromJSON(e,r){const{refreshToken:n,accessToken:i,expirationTime:a}=r,o=new L0;return n&&(fr(typeof n=="string","internal-error",{appName:e}),o.refreshToken=n),i&&(fr(typeof i=="string","internal-error",{appName:e}),o.accessToken=i),a&&(fr(typeof a=="number","internal-error",{appName:e}),o.expirationTime=a),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new L0,this.toJSON())}_performRefresh(){return Qc("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Yu(t,e){fr(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class gl{constructor(e){var{uid:r,auth:n,stsTokenManager:i}=e,a=Ix(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new fR(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=r,this.auth=n,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=a.displayName||null,this.email=a.email||null,this.emailVerified=a.emailVerified||!1,this.phoneNumber=a.phoneNumber||null,this.photoURL=a.photoURL||null,this.isAnonymous=a.isAnonymous||!1,this.tenantId=a.tenantId||null,this.providerData=a.providerData?[...a.providerData]:[],this.metadata=new N_(a.createdAt||void 0,a.lastLoginAt||void 0)}async getIdToken(e){const r=await C1(this,this.stsTokenManager.getToken(this.auth,e));return fr(r,this.auth,"internal-error"),this.accessToken!==r&&(this.accessToken=r,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),r}getIdTokenResult(e){return cR(this,e)}reload(){return hR(this)}_assign(e){this!==e&&(fr(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(r=>Object.assign({},r)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const r=new gl(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return r.metadata._copy(this.metadata),r}_onReload(e){fr(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,r=!1){let n=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),n=!0),r&&await cg(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Mo(this.auth.app))return Promise.reject(eu(this.auth));const e=await this.getIdToken();return await C1(this,lR(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,r){var n,i,a,o,c,u,h,d;const g=(n=r.displayName)!==null&&n!==void 0?n:void 0,x=(i=r.email)!==null&&i!==void 0?i:void 0,_=(a=r.phoneNumber)!==null&&a!==void 0?a:void 0,b=(o=r.photoURL)!==null&&o!==void 0?o:void 0,E=(c=r.tenantId)!==null&&c!==void 0?c:void 0,A=(u=r._redirectEventId)!==null&&u!==void 0?u:void 0,O=(h=r.createdAt)!==null&&h!==void 0?h:void 0,M=(d=r.lastLoginAt)!==null&&d!==void 0?d:void 0,{uid:B,emailVerified:Q,isAnonymous:ee,providerData:he,stsTokenManager:F}=r;fr(B&&F,e,"internal-error");const k=L0.fromJSON(this.name,F);fr(typeof B=="string",e,"internal-error"),Yu(g,e.name),Yu(x,e.name),fr(typeof Q=="boolean",e,"internal-error"),fr(typeof ee=="boolean",e,"internal-error"),Yu(_,e.name),Yu(b,e.name),Yu(E,e.name),Yu(A,e.name),Yu(O,e.name),Yu(M,e.name);const S=new gl({uid:B,auth:e,email:x,emailVerified:Q,displayName:g,isAnonymous:ee,photoURL:b,phoneNumber:_,tenantId:E,stsTokenManager:k,createdAt:O,lastLoginAt:M});return he&&Array.isArray(he)&&(S.providerData=he.map(U=>Object.assign({},U))),A&&(S._redirectEventId=A),S}static async _fromIdTokenResponse(e,r,n=!1){const i=new L0;i.updateFromServerResponse(r);const a=new gl({uid:r.localId,auth:e,stsTokenManager:i,isAnonymous:n});return await cg(a),a}static async _fromGetAccountInfoResponse(e,r,n){const i=r.users[0];fr(i.localId!==void 0,"internal-error");const a=i.providerUserInfo!==void 0?cS(i.providerUserInfo):[],o=!(i.email&&i.passwordHash)&&!a?.length,c=new L0;c.updateFromIdToken(n);const u=new gl({uid:i.localId,auth:e,stsTokenManager:c,isAnonymous:o}),h={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:a,metadata:new N_(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!a?.length};return Object.assign(u,h),u}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const B4=new Map;function Jc(t){su(t instanceof Function,"Expected a class definition");let e=B4.get(t);return e?(su(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,B4.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uS{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,r){this.storage[e]=r}async _get(e){const r=this.storage[e];return r===void 0?null:r}async _remove(e){delete this.storage[e]}_addListener(e,r){}_removeListener(e,r){}}uS.type="NONE";const j4=uS;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Vm(t,e,r){return`firebase:${t}:${e}:${r}`}class D0{constructor(e,r,n){this.persistence=e,this.auth=r,this.userKey=n;const{config:i,name:a}=this.auth;this.fullUserKey=Vm(this.userKey,i.apiKey,a),this.fullPersistenceKey=Vm("persistence",i.apiKey,a),this.boundEventHandler=r._onStorageEvent.bind(r),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const r=await lg(this.auth,{idToken:e}).catch(()=>{});return r?gl._fromGetAccountInfoResponse(this.auth,r,e):null}return gl._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const r=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,r)return this.setCurrentUser(r)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,r,n="authUser"){if(!r.length)return new D0(Jc(j4),e,n);const i=(await Promise.all(r.map(async h=>{if(await h._isAvailable())return h}))).filter(h=>h);let a=i[0]||Jc(j4);const o=Vm(n,e.config.apiKey,e.name);let c=null;for(const h of r)try{const d=await h._get(o);if(d){let g;if(typeof d=="string"){const x=await lg(e,{idToken:d}).catch(()=>{});if(!x)break;g=await gl._fromGetAccountInfoResponse(e,x,d)}else g=gl._fromJSON(e,d);h!==a&&(c=g),a=h;break}}catch{}const u=i.filter(h=>h._shouldAllowMigration);return!a._shouldAllowMigration||!u.length?new D0(a,e,n):(a=u[0],c&&await a._set(o,c.toJSON()),await Promise.all(r.map(async h=>{if(h!==a)try{await h._remove(o)}catch{}})),new D0(a,e,n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function U4(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(pS(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(fS(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(gS(e))return"Blackberry";if(vS(e))return"Webos";if(hS(e))return"Safari";if((e.includes("chrome/")||dS(e))&&!e.includes("edge/"))return"Chrome";if(mS(e))return"Android";{const r=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=t.match(r);if(n?.length===2)return n[1]}return"Other"}function fS(t=ns()){return/firefox\//i.test(t)}function hS(t=ns()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function dS(t=ns()){return/crios\//i.test(t)}function pS(t=ns()){return/iemobile/i.test(t)}function mS(t=ns()){return/android/i.test(t)}function gS(t=ns()){return/blackberry/i.test(t)}function vS(t=ns()){return/webos/i.test(t)}function Fx(t=ns()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function gR(t=ns()){var e;return Fx(t)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function vR(){return RC()&&document.documentMode===10}function _S(t=ns()){return Fx(t)||mS(t)||vS(t)||gS(t)||/windows phone/i.test(t)||pS(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xS(t,e=[]){let r;switch(t){case"Browser":r=U4(ns());break;case"Worker":r=`${U4(ns())}-${t}`;break;default:r=t}const n=e.length?e.join(","):"FirebaseCore-web";return`${r}/JsCore/${rd}/${n}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _R{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,r){const n=a=>new Promise((o,c)=>{try{const u=e(a);o(u)}catch(u){c(u)}});n.onAbort=r,this.queue.push(n);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const r=[];try{for(const n of this.queue)await n(e),n.onAbort&&r.push(n.onAbort)}catch(n){r.reverse();for(const i of r)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:n?.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function xR(t,e={}){return If(t,"GET","/v2/passwordPolicy",Cf(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yR=6;class wR{constructor(e){var r,n,i,a;const o=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(r=o.minPasswordLength)!==null&&r!==void 0?r:yR,o.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=o.maxPasswordLength),o.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=o.containsLowercaseCharacter),o.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=o.containsUppercaseCharacter),o.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=o.containsNumericCharacter),o.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=o.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(i=(n=e.allowedNonAlphanumericCharacters)===null||n===void 0?void 0:n.join(""))!==null&&i!==void 0?i:"",this.forceUpgradeOnSignin=(a=e.forceUpgradeOnSignin)!==null&&a!==void 0?a:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var r,n,i,a,o,c;const u={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,u),this.validatePasswordCharacterOptions(e,u),u.isValid&&(u.isValid=(r=u.meetsMinPasswordLength)!==null&&r!==void 0?r:!0),u.isValid&&(u.isValid=(n=u.meetsMaxPasswordLength)!==null&&n!==void 0?n:!0),u.isValid&&(u.isValid=(i=u.containsLowercaseLetter)!==null&&i!==void 0?i:!0),u.isValid&&(u.isValid=(a=u.containsUppercaseLetter)!==null&&a!==void 0?a:!0),u.isValid&&(u.isValid=(o=u.containsNumericCharacter)!==null&&o!==void 0?o:!0),u.isValid&&(u.isValid=(c=u.containsNonAlphanumericCharacter)!==null&&c!==void 0?c:!0),u}validatePasswordLengthOptions(e,r){const n=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;n&&(r.meetsMinPasswordLength=e.length>=n),i&&(r.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,r){this.updatePasswordCharacterOptionsStatuses(r,!1,!1,!1,!1);let n;for(let i=0;i<e.length;i++)n=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(r,n>="a"&&n<="z",n>="A"&&n<="Z",n>="0"&&n<="9",this.allowedNonAlphanumericCharacters.includes(n))}updatePasswordCharacterOptionsStatuses(e,r,n,i,a){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=r)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=n)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=a))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ER{constructor(e,r,n,i){this.app=e,this.heartbeatServiceProvider=r,this.appCheckServiceProvider=n,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new V4(this),this.idTokenSubscription=new V4(this),this.beforeStateQueue=new _R(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=iS,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion,this._persistenceManagerAvailable=new Promise(a=>this._resolvePersistenceManagerAvailable=a)}_initializeWithPersistence(e,r){return r&&(this._popupRedirectResolver=Jc(r)),this._initializationPromise=this.queue(async()=>{var n,i,a;if(!this._deleted&&(this.persistenceManager=await D0.create(this,e),(n=this._resolvePersistenceManagerAvailable)===null||n===void 0||n.call(this),!this._deleted)){if(!((i=this._popupRedirectResolver)===null||i===void 0)&&i._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(r),this.lastNotifiedUid=((a=this.currentUser)===null||a===void 0?void 0:a.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const r=await lg(this,{idToken:e}),n=await gl._fromGetAccountInfoResponse(this,r,e);await this.directlySetCurrentUser(n)}catch(r){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",r),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var r;if(Mo(this.app)){const o=this.app.settings.authIdToken;return o?new Promise(c=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(c,c))}):this.directlySetCurrentUser(null)}const n=await this.assertedPersistence.getCurrentUser();let i=n,a=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const o=(r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId,c=i?._redirectEventId,u=await this.tryRedirectSignIn(e);(!o||o===c)&&u?.user&&(i=u.user,a=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(a)try{await this.beforeStateQueue.runMiddleware(i)}catch(o){i=n,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return fr(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(e){let r=null;try{r=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return r}async reloadAndSetCurrentUserOrClear(e){try{await cg(e)}catch(r){if(r?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=eR()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Mo(this.app))return Promise.reject(eu(this));const r=e?ma(e):null;return r&&fr(r.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(r&&r._clone(this))}async _updateCurrentUser(e,r=!1){if(!this._deleted)return e&&fr(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),r||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Mo(this.app)?Promise.reject(eu(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Mo(this.app)?Promise.reject(eu(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Jc(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const r=this._getPasswordPolicyInternal();return r.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):r.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await xR(this),r=new wR(e);this.tenantId===null?this._projectPasswordPolicy=r:this._tenantPasswordPolicies[this.tenantId]=r}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new Z1("auth","Firebase",e())}onAuthStateChanged(e,r,n){return this.registerStateListener(this.authStateSubscription,e,r,n)}beforeAuthStateChanged(e,r){return this.beforeStateQueue.pushCallback(e,r)}onIdTokenChanged(e,r,n){return this.registerStateListener(this.idTokenSubscription,e,r,n)}authStateReady(){return new Promise((e,r)=>{if(this.currentUser)e();else{const n=this.onAuthStateChanged(()=>{n(),e()},r)}})}async revokeAccessToken(e){if(this.currentUser){const r=await this.currentUser.getIdToken(),n={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:r};this.tenantId!=null&&(n.tenantId=this.tenantId),await mR(this,n)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,r){const n=await this.getOrInitRedirectPersistenceManager(r);return e===null?n.removeCurrentUser():n.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const r=e&&Jc(e)||this._popupRedirectResolver;fr(r,this,"argument-error"),this.redirectPersistenceManager=await D0.create(this,[Jc(r._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var r,n;return this._isInitialized&&await this.queue(async()=>{}),((r=this._currentUser)===null||r===void 0?void 0:r._redirectEventId)===e?this._currentUser:((n=this.redirectUser)===null||n===void 0?void 0:n._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,r;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const n=(r=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&r!==void 0?r:null;this.lastNotifiedUid!==n&&(this.lastNotifiedUid=n,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,r,n,i){if(this._deleted)return()=>{};const a=typeof r=="function"?r:r.next.bind(r);let o=!1;const c=this._isInitialized?Promise.resolve():this._initializationPromise;if(fr(c,this,"internal-error"),c.then(()=>{o||a(this.currentUser)}),typeof r=="function"){const u=e.addObserver(r,n,i);return()=>{o=!0,u()}}else{const u=e.addObserver(r);return()=>{o=!0,u()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return fr(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=xS(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const r={"X-Client-Version":this.clientVersion};this.app.options.appId&&(r["X-Firebase-gmpid"]=this.app.options.appId);const n=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());n&&(r["X-Firebase-Client"]=n);const i=await this._getAppCheckToken();return i&&(r["X-Firebase-AppCheck"]=i),r}async _getAppCheckToken(){var e;if(Mo(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const r=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return r?.error&&QI(`Error while retrieving App Check token: ${r.error}`),r?.token}}function Rh(t){return ma(t)}class V4{constructor(e){this.auth=e,this.observer=null,this.addObserver=jC(r=>this.observer=r)}get next(){return fr(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Hg={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function bR(t){Hg=t}function yS(t){return Hg.loadJS(t)}function SR(){return Hg.recaptchaEnterpriseScript}function AR(){return Hg.gapiScript}function TR(t){return`__${t}${Math.floor(Math.random()*1e6)}`}class kR{constructor(){this.enterprise=new NR}ready(e){e()}execute(e,r){return Promise.resolve("token")}render(e,r){return""}}class NR{ready(e){e()}execute(e,r){return Promise.resolve("token")}render(e,r){return""}}const CR="recaptcha-enterprise",wS="NO_RECAPTCHA";class IR{constructor(e){this.type=CR,this.auth=Rh(e)}async verify(e="verify",r=!1){async function n(a){if(!r){if(a.tenantId==null&&a._agentRecaptchaConfig!=null)return a._agentRecaptchaConfig.siteKey;if(a.tenantId!=null&&a._tenantRecaptchaConfigs[a.tenantId]!==void 0)return a._tenantRecaptchaConfigs[a.tenantId].siteKey}return new Promise(async(o,c)=>{oR(a,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(u=>{if(u.recaptchaKey===void 0)c(new Error("recaptcha Enterprise site key undefined"));else{const h=new sR(u);return a.tenantId==null?a._agentRecaptchaConfig=h:a._tenantRecaptchaConfigs[a.tenantId]=h,o(h.siteKey)}}).catch(u=>{c(u)})})}function i(a,o,c){const u=window.grecaptcha;P4(u)?u.enterprise.ready(()=>{u.enterprise.execute(a,{action:e}).then(h=>{o(h)}).catch(()=>{o(wS)})}):c(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new kR().execute("siteKey",{action:"verify"}):new Promise((a,o)=>{n(this.auth).then(c=>{if(!r&&P4(window.grecaptcha))i(c,a,o);else{if(typeof window>"u"){o(new Error("RecaptchaVerifier is only supported in browser"));return}let u=SR();u.length!==0&&(u+=c),yS(u).then(()=>{i(c,a,o)}).catch(h=>{o(h)})}}).catch(c=>{o(c)})})}}async function q4(t,e,r,n=!1,i=!1){const a=new IR(t);let o;if(i)o=wS;else try{o=await a.verify(r)}catch{o=await a.verify(r,!0)}const c=Object.assign({},e);if(r==="mfaSmsEnrollment"||r==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in c){const u=c.phoneEnrollmentInfo.phoneNumber,h=c.phoneEnrollmentInfo.recaptchaToken;Object.assign(c,{phoneEnrollmentInfo:{phoneNumber:u,recaptchaToken:h,captchaResponse:o,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in c){const u=c.phoneSignInInfo.recaptchaToken;Object.assign(c,{phoneSignInInfo:{recaptchaToken:u,captchaResponse:o,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return c}return n?Object.assign(c,{captchaResp:o}):Object.assign(c,{captchaResponse:o}),Object.assign(c,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(c,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),c}async function C_(t,e,r,n,i){var a;if(!((a=t._getRecaptchaConfig())===null||a===void 0)&&a.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const o=await q4(t,e,r,r==="getOobCode");return n(t,o)}else return n(t,e).catch(async o=>{if(o.code==="auth/missing-recaptcha-token"){console.log(`${r} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const c=await q4(t,e,r,r==="getOobCode");return n(t,c)}else return Promise.reject(o)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function RR(t,e){const r=Cx(t,"auth");if(r.isInitialized()){const i=r.getImmediate(),a=r.getOptions();if(_h(a,e??{}))return i;wl(i,"already-initialized")}return r.initialize({options:e})}function LR(t,e){const r=e?.persistence||[],n=(Array.isArray(r)?r:[r]).map(Jc);e?.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(n,e?.popupRedirectResolver)}function DR(t,e,r){const n=Rh(t);fr(/^https?:\/\//.test(e),n,"invalid-emulator-scheme");const i=!1,a=ES(e),{host:o,port:c}=FR(e),u=c===null?"":`:${c}`,h={url:`${a}//${o}${u}/`},d=Object.freeze({host:o,port:c,protocol:a.replace(":",""),options:Object.freeze({disableWarnings:i})});if(!n._canInitEmulator){fr(n.config.emulator&&n.emulatorConfig,n,"emulator-config-failed"),fr(_h(h,n.config.emulator)&&_h(d,n.emulatorConfig),n,"emulator-config-failed");return}n.config.emulator=h,n.emulatorConfig=d,n.settings.appVerificationDisabledForTesting=!0,td(o)?(Kb(`${a}//${o}${u}`),$b("Auth",!0)):OR()}function ES(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function FR(t){const e=ES(t),r=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!r)return{host:"",port:null};const n=r[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(n);if(i){const a=i[1];return{host:a,port:z4(n.substr(a.length+1))}}else{const[a,o]=n.split(":");return{host:a,port:z4(o)}}}function z4(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function OR(){function t(){const e=document.createElement("p"),r=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",r.position="fixed",r.width="100%",r.backgroundColor="#ffffff",r.border=".1em solid #000000",r.color="#b50000",r.bottom="0px",r.left="0px",r.margin="0px",r.zIndex="10000",r.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ox{constructor(e,r){this.providerId=e,this.signInMethod=r}toJSON(){return Qc("not implemented")}_getIdTokenResponse(e){return Qc("not implemented")}_linkToIdToken(e,r){return Qc("not implemented")}_getReauthenticationResolver(e){return Qc("not implemented")}}async function PR(t,e){return If(t,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function MR(t,e){return rp(t,"POST","/v1/accounts:signInWithPassword",Cf(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function BR(t,e){return rp(t,"POST","/v1/accounts:signInWithEmailLink",Cf(t,e))}async function jR(t,e){return rp(t,"POST","/v1/accounts:signInWithEmailLink",Cf(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class I1 extends Ox{constructor(e,r,n,i=null){super("password",n),this._email=e,this._password=r,this._tenantId=i}static _fromEmailAndPassword(e,r){return new I1(e,r,"password")}static _fromEmailAndCode(e,r,n=null){return new I1(e,r,"emailLink",n)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const r=typeof e=="string"?JSON.parse(e):e;if(r?.email&&r?.password){if(r.signInMethod==="password")return this._fromEmailAndPassword(r.email,r.password);if(r.signInMethod==="emailLink")return this._fromEmailAndCode(r.email,r.password,r.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const r={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return C_(e,r,"signInWithPassword",MR);case"emailLink":return BR(e,{email:this._email,oobCode:this._password});default:wl(e,"internal-error")}}async _linkToIdToken(e,r){switch(this.signInMethod){case"password":const n={idToken:r,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return C_(e,n,"signUpPassword",PR);case"emailLink":return jR(e,{idToken:r,email:this._email,oobCode:this._password});default:wl(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function F0(t,e){return rp(t,"POST","/v1/accounts:signInWithIdp",Cf(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const UR="http://localhost";class yh extends Ox{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const r=new yh(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(r.idToken=e.idToken),e.accessToken&&(r.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(r.nonce=e.nonce),e.pendingToken&&(r.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(r.accessToken=e.oauthToken,r.secret=e.oauthTokenSecret):wl("argument-error"),r}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const r=typeof e=="string"?JSON.parse(e):e,{providerId:n,signInMethod:i}=r,a=Ix(r,["providerId","signInMethod"]);if(!n||!i)return null;const o=new yh(n,i);return o.idToken=a.idToken||void 0,o.accessToken=a.accessToken||void 0,o.secret=a.secret,o.nonce=a.nonce,o.pendingToken=a.pendingToken||null,o}_getIdTokenResponse(e){const r=this.buildRequest();return F0(e,r)}_linkToIdToken(e,r){const n=this.buildRequest();return n.idToken=r,F0(e,n)}_getReauthenticationResolver(e){const r=this.buildRequest();return r.autoCreate=!1,F0(e,r)}buildRequest(){const e={requestUri:UR,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const r={};this.idToken&&(r.id_token=this.idToken),this.accessToken&&(r.access_token=this.accessToken),this.secret&&(r.oauth_token_secret=this.secret),r.providerId=this.providerId,this.nonce&&!this.pendingToken&&(r.nonce=this.nonce),e.postBody=ep(r)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function VR(t){switch(t){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function qR(t){const e=r1(n1(t)).link,r=e?r1(n1(e)).deep_link_id:null,n=r1(n1(t)).deep_link_id;return(n?r1(n1(n)).link:null)||n||r||e||t}class Px{constructor(e){var r,n,i,a,o,c;const u=r1(n1(e)),h=(r=u.apiKey)!==null&&r!==void 0?r:null,d=(n=u.oobCode)!==null&&n!==void 0?n:null,g=VR((i=u.mode)!==null&&i!==void 0?i:null);fr(h&&d&&g,"argument-error"),this.apiKey=h,this.operation=g,this.code=d,this.continueUrl=(a=u.continueUrl)!==null&&a!==void 0?a:null,this.languageCode=(o=u.lang)!==null&&o!==void 0?o:null,this.tenantId=(c=u.tenantId)!==null&&c!==void 0?c:null}static parseLink(e){const r=qR(e);try{return new Px(r)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nd{constructor(){this.providerId=nd.PROVIDER_ID}static credential(e,r){return I1._fromEmailAndPassword(e,r)}static credentialWithLink(e,r){const n=Px.parseLink(r);return fr(n,"argument-error"),I1._fromEmailAndCode(e,n.code,n.tenantId)}}nd.PROVIDER_ID="password";nd.EMAIL_PASSWORD_SIGN_IN_METHOD="password";nd.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bS{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class np extends bS{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ju extends np{constructor(){super("facebook.com")}static credential(e){return yh._fromParams({providerId:Ju.PROVIDER_ID,signInMethod:Ju.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Ju.credentialFromTaggedObject(e)}static credentialFromError(e){return Ju.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Ju.credential(e.oauthAccessToken)}catch{return null}}}Ju.FACEBOOK_SIGN_IN_METHOD="facebook.com";Ju.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zu extends np{constructor(){super("google.com"),this.addScope("profile")}static credential(e,r){return yh._fromParams({providerId:Zu.PROVIDER_ID,signInMethod:Zu.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:r})}static credentialFromResult(e){return Zu.credentialFromTaggedObject(e)}static credentialFromError(e){return Zu.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:r,oauthAccessToken:n}=e;if(!r&&!n)return null;try{return Zu.credential(r,n)}catch{return null}}}Zu.GOOGLE_SIGN_IN_METHOD="google.com";Zu.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ef extends np{constructor(){super("github.com")}static credential(e){return yh._fromParams({providerId:ef.PROVIDER_ID,signInMethod:ef.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return ef.credentialFromTaggedObject(e)}static credentialFromError(e){return ef.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return ef.credential(e.oauthAccessToken)}catch{return null}}}ef.GITHUB_SIGN_IN_METHOD="github.com";ef.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tf extends np{constructor(){super("twitter.com")}static credential(e,r){return yh._fromParams({providerId:tf.PROVIDER_ID,signInMethod:tf.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:r})}static credentialFromResult(e){return tf.credentialFromTaggedObject(e)}static credentialFromError(e){return tf.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:r,oauthTokenSecret:n}=e;if(!r||!n)return null;try{return tf.credential(r,n)}catch{return null}}}tf.TWITTER_SIGN_IN_METHOD="twitter.com";tf.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function zR(t,e){return rp(t,"POST","/v1/accounts:signUp",Cf(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wh{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,r,n,i=!1){const a=await gl._fromIdTokenResponse(e,n,i),o=H4(n);return new wh({user:a,providerId:o,_tokenResponse:n,operationType:r})}static async _forOperation(e,r,n){await e._updateTokensIfNecessary(n,!0);const i=H4(n);return new wh({user:e,providerId:i,_tokenResponse:n,operationType:r})}}function H4(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ug extends uu{constructor(e,r,n,i){var a;super(r.code,r.message),this.operationType=n,this.user=i,Object.setPrototypeOf(this,ug.prototype),this.customData={appName:e.name,tenantId:(a=e.tenantId)!==null&&a!==void 0?a:void 0,_serverResponse:r.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(e,r,n,i){return new ug(e,r,n,i)}}function SS(t,e,r,n){return(e==="reauthenticate"?r._getReauthenticationResolver(t):r._getIdTokenResponse(t)).catch(a=>{throw a.code==="auth/multi-factor-auth-required"?ug._fromErrorAndOperation(t,a,e,n):a})}async function HR(t,e,r=!1){const n=await C1(t,e._linkToIdToken(t.auth,await t.getIdToken()),r);return wh._forOperation(t,"link",n)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function GR(t,e,r=!1){const{auth:n}=t;if(Mo(n.app))return Promise.reject(eu(n));const i="reauthenticate";try{const a=await C1(t,SS(n,i,e,t),r);fr(a.idToken,n,"internal-error");const o=Dx(a.idToken);fr(o,n,"internal-error");const{sub:c}=o;return fr(t.uid===c,n,"user-mismatch"),wh._forOperation(t,i,a)}catch(a){throw a?.code==="auth/user-not-found"&&wl(n,"user-mismatch"),a}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function AS(t,e,r=!1){if(Mo(t.app))return Promise.reject(eu(t));const n="signIn",i=await SS(t,n,e),a=await wh._fromIdTokenResponse(t,n,i);return r||await t._updateCurrentUser(a.user),a}async function WR(t,e){return AS(Rh(t),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function TS(t){const e=Rh(t);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function XR(t,e,r){if(Mo(t.app))return Promise.reject(eu(t));const n=Rh(t),o=await C_(n,{returnSecureToken:!0,email:e,password:r,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",zR).catch(u=>{throw u.code==="auth/password-does-not-meet-requirements"&&TS(t),u}),c=await wh._fromIdTokenResponse(n,"signIn",o);return await n._updateCurrentUser(c.user),c}function YR(t,e,r){return Mo(t.app)?Promise.reject(eu(t)):WR(ma(t),nd.credential(e,r)).catch(async n=>{throw n.code==="auth/password-does-not-meet-requirements"&&TS(t),n})}function KR(t,e,r,n){return ma(t).onIdTokenChanged(e,r,n)}function $R(t,e,r){return ma(t).beforeAuthStateChanged(e,r)}function QR(t,e,r,n){return ma(t).onAuthStateChanged(e,r,n)}function JR(t){return ma(t).signOut()}const fg="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kS{constructor(e,r){this.storageRetriever=e,this.type=r}_isAvailable(){try{return this.storage?(this.storage.setItem(fg,"1"),this.storage.removeItem(fg),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,r){return this.storage.setItem(e,JSON.stringify(r)),Promise.resolve()}_get(e){const r=this.storage.getItem(e);return Promise.resolve(r?JSON.parse(r):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ZR=1e3,e7=10;class NS extends kS{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,r)=>this.onStorageEvent(e,r),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=_S(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const r of Object.keys(this.listeners)){const n=this.storage.getItem(r),i=this.localCache[r];n!==i&&e(r,i,n)}}onStorageEvent(e,r=!1){if(!e.key){this.forAllChangedKeys((o,c,u)=>{this.notifyListeners(o,u)});return}const n=e.key;r?this.detachListener():this.stopPolling();const i=()=>{const o=this.storage.getItem(n);!r&&this.localCache[n]===o||this.notifyListeners(n,o)},a=this.storage.getItem(n);vR()&&a!==e.newValue&&e.newValue!==e.oldValue?setTimeout(i,e7):i()}notifyListeners(e,r){this.localCache[e]=r;const n=this.listeners[e];if(n)for(const i of Array.from(n))i(r&&JSON.parse(r))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,r,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:r,newValue:n}),!0)})},ZR)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,r){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,r){await super._set(e,r),this.localCache[e]=JSON.stringify(r)}async _get(e){const r=await super._get(e);return this.localCache[e]=JSON.stringify(r),r}async _remove(e){await super._remove(e),delete this.localCache[e]}}NS.type="LOCAL";const t7=NS;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CS extends kS{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,r){}_removeListener(e,r){}}CS.type="SESSION";const IS=CS;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function r7(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(r){return{fulfilled:!1,reason:r}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gg{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const r=this.receivers.find(i=>i.isListeningto(e));if(r)return r;const n=new Gg(e);return this.receivers.push(n),n}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const r=e,{eventId:n,eventType:i,data:a}=r.data,o=this.handlersMap[i];if(!o?.size)return;r.ports[0].postMessage({status:"ack",eventId:n,eventType:i});const c=Array.from(o).map(async h=>h(r.origin,a)),u=await r7(c);r.ports[0].postMessage({status:"done",eventId:n,eventType:i,response:u})}_subscribe(e,r){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(r)}_unsubscribe(e,r){this.handlersMap[e]&&r&&this.handlersMap[e].delete(r),(!r||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Gg.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Mx(t="",e=10){let r="";for(let n=0;n<e;n++)r+=Math.floor(Math.random()*10);return t+r}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class n7{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,r,n=50){const i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let a,o;return new Promise((c,u)=>{const h=Mx("",20);i.port1.start();const d=setTimeout(()=>{u(new Error("unsupported_event"))},n);o={messageChannel:i,onMessage(g){const x=g;if(x.data.eventId===h)switch(x.data.status){case"ack":clearTimeout(d),a=setTimeout(()=>{u(new Error("timeout"))},3e3);break;case"done":clearTimeout(a),c(x.data.response);break;default:clearTimeout(d),clearTimeout(a),u(new Error("invalid_response"));break}}},this.handlers.add(o),i.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:h,data:r},[i.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uc(){return window}function i7(t){uc().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function RS(){return typeof uc().WorkerGlobalScope<"u"&&typeof uc().importScripts=="function"}async function a7(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function s7(){var t;return((t=navigator?.serviceWorker)===null||t===void 0?void 0:t.controller)||null}function o7(){return RS()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const LS="firebaseLocalStorageDb",l7=1,hg="firebaseLocalStorage",DS="fbase_key";class ip{constructor(e){this.request=e}toPromise(){return new Promise((e,r)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{r(this.request.error)})})}}function Wg(t,e){return t.transaction([hg],e?"readwrite":"readonly").objectStore(hg)}function c7(){const t=indexedDB.deleteDatabase(LS);return new ip(t).toPromise()}function I_(){const t=indexedDB.open(LS,l7);return new Promise((e,r)=>{t.addEventListener("error",()=>{r(t.error)}),t.addEventListener("upgradeneeded",()=>{const n=t.result;try{n.createObjectStore(hg,{keyPath:DS})}catch(i){r(i)}}),t.addEventListener("success",async()=>{const n=t.result;n.objectStoreNames.contains(hg)?e(n):(n.close(),await c7(),e(await I_()))})})}async function G4(t,e,r){const n=Wg(t,!0).put({[DS]:e,value:r});return new ip(n).toPromise()}async function u7(t,e){const r=Wg(t,!1).get(e),n=await new ip(r).toPromise();return n===void 0?null:n.value}function W4(t,e){const r=Wg(t,!0).delete(e);return new ip(r).toPromise()}const f7=800,h7=3;class FS{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await I_(),this.db)}async _withRetries(e){let r=0;for(;;)try{const n=await this._openDb();return await e(n)}catch(n){if(r++>h7)throw n;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return RS()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Gg._getInstance(o7()),this.receiver._subscribe("keyChanged",async(e,r)=>({keyProcessed:(await this._poll()).includes(r.key)})),this.receiver._subscribe("ping",async(e,r)=>["keyChanged"])}async initializeSender(){var e,r;if(this.activeServiceWorker=await a7(),!this.activeServiceWorker)return;this.sender=new n7(this.activeServiceWorker);const n=await this.sender._send("ping",{},800);n&&!((e=n[0])===null||e===void 0)&&e.fulfilled&&!((r=n[0])===null||r===void 0)&&r.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||s7()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await I_();return await G4(e,fg,"1"),await W4(e,fg),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,r){return this._withPendingWrite(async()=>(await this._withRetries(n=>G4(n,e,r)),this.localCache[e]=r,this.notifyServiceWorker(e)))}async _get(e){const r=await this._withRetries(n=>u7(n,e));return this.localCache[e]=r,r}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(r=>W4(r,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(i=>{const a=Wg(i,!1).getAll();return new ip(a).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const r=[],n=new Set;if(e.length!==0)for(const{fbase_key:i,value:a}of e)n.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(a)&&(this.notifyListeners(i,a),r.push(i));for(const i of Object.keys(this.localCache))this.localCache[i]&&!n.has(i)&&(this.notifyListeners(i,null),r.push(i));return r}notifyListeners(e,r){this.localCache[e]=r;const n=this.listeners[e];if(n)for(const i of Array.from(n))i(r)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),f7)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,r){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}FS.type="LOCAL";const d7=FS;new tp(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function p7(t,e){return e?Jc(e):(fr(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bx extends Ox{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return F0(e,this._buildIdpRequest())}_linkToIdToken(e,r){return F0(e,this._buildIdpRequest(r))}_getReauthenticationResolver(e){return F0(e,this._buildIdpRequest())}_buildIdpRequest(e){const r={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(r.idToken=e),r}}function m7(t){return AS(t.auth,new Bx(t),t.bypassAuthState)}function g7(t){const{auth:e,user:r}=t;return fr(r,e,"internal-error"),GR(r,new Bx(t),t.bypassAuthState)}async function v7(t){const{auth:e,user:r}=t;return fr(r,e,"internal-error"),HR(r,new Bx(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OS{constructor(e,r,n,i,a=!1){this.auth=e,this.resolver=n,this.user=i,this.bypassAuthState=a,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(r)?r:[r]}execute(){return new Promise(async(e,r)=>{this.pendingPromise={resolve:e,reject:r};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(n){this.reject(n)}})}async onAuthEvent(e){const{urlResponse:r,sessionId:n,postBody:i,tenantId:a,error:o,type:c}=e;if(o){this.reject(o);return}const u={auth:this.auth,requestUri:r,sessionId:n,tenantId:a||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(c)(u))}catch(h){this.reject(h)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return m7;case"linkViaPopup":case"linkViaRedirect":return v7;case"reauthViaPopup":case"reauthViaRedirect":return g7;default:wl(this.auth,"internal-error")}}resolve(e){su(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){su(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _7=new tp(2e3,1e4);class C0 extends OS{constructor(e,r,n,i,a){super(e,r,i,a),this.provider=n,this.authWindow=null,this.pollId=null,C0.currentPopupAction&&C0.currentPopupAction.cancel(),C0.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return fr(e,this.auth,"internal-error"),e}async onExecution(){su(this.filter.length===1,"Popup operations only handle one event");const e=Mx();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(r=>{this.reject(r)}),this.resolver._isIframeWebStorageSupported(this.auth,r=>{r||this.reject(cc(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(cc(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,C0.currentPopupAction=null}pollUserCancellation(){const e=()=>{var r,n;if(!((n=(r=this.authWindow)===null||r===void 0?void 0:r.window)===null||n===void 0)&&n.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(cc(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,_7.get())};e()}}C0.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const x7="pendingRedirect",qm=new Map;class y7 extends OS{constructor(e,r,n=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],r,void 0,n),this.eventId=null}async execute(){let e=qm.get(this.auth._key());if(!e){try{const n=await w7(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(n)}catch(r){e=()=>Promise.reject(r)}qm.set(this.auth._key(),e)}return this.bypassAuthState||qm.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const r=await this.auth._redirectUserForId(e.eventId);if(r)return this.user=r,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function w7(t,e){const r=S7(e),n=b7(t);if(!await n._isAvailable())return!1;const i=await n._get(r)==="true";return await n._remove(r),i}function E7(t,e){qm.set(t._key(),e)}function b7(t){return Jc(t._redirectPersistence)}function S7(t){return Vm(x7,t.config.apiKey,t.name)}async function A7(t,e,r=!1){if(Mo(t.app))return Promise.reject(eu(t));const n=Rh(t),i=p7(n,e),o=await new y7(n,i,r).execute();return o&&!r&&(delete o.user._redirectEventId,await n._persistUserIfCurrent(o.user),await n._setRedirectUser(null,e)),o}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const T7=10*60*1e3;class k7{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let r=!1;return this.consumers.forEach(n=>{this.isEventForConsumer(e,n)&&(r=!0,this.sendToConsumer(e,n),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!N7(e)||(this.hasHandledPotentialRedirect=!0,r||(this.queuedRedirectEvent=e,r=!0)),r}sendToConsumer(e,r){var n;if(e.error&&!PS(e)){const i=((n=e.error.code)===null||n===void 0?void 0:n.split("auth/")[1])||"internal-error";r.onError(cc(this.auth,i))}else r.onAuthEvent(e)}isEventForConsumer(e,r){const n=r.eventId===null||!!e.eventId&&e.eventId===r.eventId;return r.filter.includes(e.type)&&n}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=T7&&this.cachedEventUids.clear(),this.cachedEventUids.has(X4(e))}saveEventToCache(e){this.cachedEventUids.add(X4(e)),this.lastProcessedEventTime=Date.now()}}function X4(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function PS({type:t,error:e}){return t==="unknown"&&e?.code==="auth/no-auth-event"}function N7(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return PS(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function C7(t,e={}){return If(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const I7=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,R7=/^https?/;async function L7(t){if(t.config.emulator)return;const{authorizedDomains:e}=await C7(t);for(const r of e)try{if(D7(r))return}catch{}wl(t,"unauthorized-domain")}function D7(t){const e=k_(),{protocol:r,hostname:n}=new URL(e);if(t.startsWith("chrome-extension://")){const o=new URL(t);return o.hostname===""&&n===""?r==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):r==="chrome-extension:"&&o.hostname===n}if(!R7.test(r))return!1;if(I7.test(t))return n===t;const i=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(n)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const F7=new tp(3e4,6e4);function Y4(){const t=uc().___jsl;if(t?.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let r=0;r<t.CP.length;r++)t.CP[r]=null}}function O7(t){return new Promise((e,r)=>{var n,i,a;function o(){Y4(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{Y4(),r(cc(t,"network-request-failed"))},timeout:F7.get()})}if(!((i=(n=uc().gapi)===null||n===void 0?void 0:n.iframes)===null||i===void 0)&&i.Iframe)e(gapi.iframes.getContext());else if(!((a=uc().gapi)===null||a===void 0)&&a.load)o();else{const c=TR("iframefcb");return uc()[c]=()=>{gapi.load?o():r(cc(t,"network-request-failed"))},yS(`${AR()}?onload=${c}`).catch(u=>r(u))}}).catch(e=>{throw zm=null,e})}let zm=null;function P7(t){return zm=zm||O7(t),zm}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const M7=new tp(5e3,15e3),B7="__/auth/iframe",j7="emulator/auth/iframe",U7={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},V7=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function q7(t){const e=t.config;fr(e.authDomain,t,"auth-domain-config-required");const r=e.emulator?Lx(e,j7):`https://${t.config.authDomain}/${B7}`,n={apiKey:e.apiKey,appName:t.name,v:rd},i=V7.get(t.config.apiHost);i&&(n.eid=i);const a=t._getFrameworks();return a.length&&(n.fw=a.join(",")),`${r}?${ep(n).slice(1)}`}async function z7(t){const e=await P7(t),r=uc().gapi;return fr(r,t,"internal-error"),e.open({where:document.body,url:q7(t),messageHandlersFilter:r.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:U7,dontclear:!0},n=>new Promise(async(i,a)=>{await n.restyle({setHideOnLeave:!1});const o=cc(t,"network-request-failed"),c=uc().setTimeout(()=>{a(o)},M7.get());function u(){uc().clearTimeout(c),i(n)}n.ping(u).then(u,()=>{a(o)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const H7={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},G7=500,W7=600,X7="_blank",Y7="http://localhost";class K4{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function K7(t,e,r,n=G7,i=W7){const a=Math.max((window.screen.availHeight-i)/2,0).toString(),o=Math.max((window.screen.availWidth-n)/2,0).toString();let c="";const u=Object.assign(Object.assign({},H7),{width:n.toString(),height:i.toString(),top:a,left:o}),h=ns().toLowerCase();r&&(c=dS(h)?X7:r),fS(h)&&(e=e||Y7,u.scrollbars="yes");const d=Object.entries(u).reduce((x,[_,b])=>`${x}${_}=${b},`,"");if(gR(h)&&c!=="_self")return $7(e||"",c),new K4(null);const g=window.open(e||"",c,d);fr(g,t,"popup-blocked");try{g.focus()}catch{}return new K4(g)}function $7(t,e){const r=document.createElement("a");r.href=t,r.target=e;const n=document.createEvent("MouseEvent");n.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),r.dispatchEvent(n)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Q7="__/auth/handler",J7="emulator/auth/handler",Z7=encodeURIComponent("fac");async function $4(t,e,r,n,i,a){fr(t.config.authDomain,t,"auth-domain-config-required"),fr(t.config.apiKey,t,"invalid-api-key");const o={apiKey:t.config.apiKey,appName:t.name,authType:r,redirectUrl:n,v:rd,eventId:i};if(e instanceof bS){e.setDefaultLanguage(t.languageCode),o.providerId=e.providerId||"",BC(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[d,g]of Object.entries({}))o[d]=g}if(e instanceof np){const d=e.getScopes().filter(g=>g!=="");d.length>0&&(o.scopes=d.join(","))}t.tenantId&&(o.tid=t.tenantId);const c=o;for(const d of Object.keys(c))c[d]===void 0&&delete c[d];const u=await t._getAppCheckToken(),h=u?`#${Z7}=${encodeURIComponent(u)}`:"";return`${eL(t)}?${ep(c).slice(1)}${h}`}function eL({config:t}){return t.emulator?Lx(t,J7):`https://${t.authDomain}/${Q7}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zv="webStorageSupport";class tL{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=IS,this._completeRedirectFn=A7,this._overrideRedirectResult=E7}async _openPopup(e,r,n,i){var a;su((a=this.eventManagers[e._key()])===null||a===void 0?void 0:a.manager,"_initialize() not called before _openPopup()");const o=await $4(e,r,n,k_(),i);return K7(e,o,Mx())}async _openRedirect(e,r,n,i){await this._originValidation(e);const a=await $4(e,r,n,k_(),i);return i7(a),new Promise(()=>{})}_initialize(e){const r=e._key();if(this.eventManagers[r]){const{manager:i,promise:a}=this.eventManagers[r];return i?Promise.resolve(i):(su(a,"If manager is not set, promise should be"),a)}const n=this.initAndGetManager(e);return this.eventManagers[r]={promise:n},n.catch(()=>{delete this.eventManagers[r]}),n}async initAndGetManager(e){const r=await z7(e),n=new k7(e);return r.register("authEvent",i=>(fr(i?.authEvent,e,"invalid-auth-event"),{status:n.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:n},this.iframes[e._key()]=r,n}_isIframeWebStorageSupported(e,r){this.iframes[e._key()].send(zv,{type:zv},i=>{var a;const o=(a=i?.[0])===null||a===void 0?void 0:a[zv];o!==void 0&&r(!!o),wl(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const r=e._key();return this.originValidationPromises[r]||(this.originValidationPromises[r]=L7(e)),this.originValidationPromises[r]}get _shouldInitProactively(){return _S()||hS()||Fx()}}const rL=tL;var Q4="@firebase/auth",J4="1.10.8";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nL{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const r=this.auth.onIdTokenChanged(n=>{e(n?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,r),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const r=this.internalListeners.get(e);r&&(this.internalListeners.delete(e),r(),this.updateProactiveRefresh())}assertAuthConfigured(){fr(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function iL(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function aL(t){G0(new xh("auth",(e,{options:r})=>{const n=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),a=e.getProvider("app-check-internal"),{apiKey:o,authDomain:c}=n.options;fr(o&&!o.includes(":"),"invalid-api-key",{appName:n.name});const u={apiKey:o,authDomain:c,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:xS(t)},h=new ER(n,i,a,u);return LR(h,r),h},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,r,n)=>{e.getProvider("auth-internal").initialize()})),G0(new xh("auth-internal",e=>{const r=Rh(e.getProvider("auth").getImmediate());return(n=>new nL(n))(r)},"PRIVATE").setInstantiationMode("EXPLICIT")),ff(Q4,J4,iL(t)),ff(Q4,J4,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sL=5*60,oL=Yb("authIdTokenMaxAge")||sL;let Z4=null;const lL=t=>async e=>{const r=e&&await e.getIdTokenResult(),n=r&&(new Date().getTime()-Date.parse(r.issuedAtTime))/1e3;if(n&&n>oL)return;const i=r?.token;Z4!==i&&(Z4=i,await fetch(t,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))};function cL(t=eS()){const e=Cx(t,"auth");if(e.isInitialized())return e.getImmediate();const r=RR(t,{popupRedirectResolver:rL,persistence:[d7,t7,IS]}),n=Yb("authTokenSyncURL");if(n&&typeof isSecureContext=="boolean"&&isSecureContext){const a=new URL(n,location.origin);if(location.origin===a.origin){const o=lL(a.toString());$R(r,o,()=>o(r.currentUser)),KR(r,c=>o(c))}}const i=Wb("auth");return i&&DR(r,`http://${i}`),r}function uL(){var t,e;return(e=(t=document.getElementsByTagName("head"))===null||t===void 0?void 0:t[0])!==null&&e!==void 0?e:document}bR({loadJS(t){return new Promise((e,r)=>{const n=document.createElement("script");n.setAttribute("src",t),n.onload=e,n.onerror=i=>{const a=cc("internal-error");a.customData=i,r(a)},n.type="text/javascript",n.charset="UTF-8",uL().appendChild(n)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});aL("Browser");var eE=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var hf,MS;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(F,k){function S(){}S.prototype=k.prototype,F.D=k.prototype,F.prototype=new S,F.prototype.constructor=F,F.C=function(U,I,C){for(var R=Array(arguments.length-2),se=2;se<arguments.length;se++)R[se-2]=arguments[se];return k.prototype[I].apply(U,R)}}function r(){this.blockSize=-1}function n(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(n,r),n.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(F,k,S){S||(S=0);var U=Array(16);if(typeof k=="string")for(var I=0;16>I;++I)U[I]=k.charCodeAt(S++)|k.charCodeAt(S++)<<8|k.charCodeAt(S++)<<16|k.charCodeAt(S++)<<24;else for(I=0;16>I;++I)U[I]=k[S++]|k[S++]<<8|k[S++]<<16|k[S++]<<24;k=F.g[0],S=F.g[1],I=F.g[2];var C=F.g[3],R=k+(C^S&(I^C))+U[0]+3614090360&4294967295;k=S+(R<<7&4294967295|R>>>25),R=C+(I^k&(S^I))+U[1]+3905402710&4294967295,C=k+(R<<12&4294967295|R>>>20),R=I+(S^C&(k^S))+U[2]+606105819&4294967295,I=C+(R<<17&4294967295|R>>>15),R=S+(k^I&(C^k))+U[3]+3250441966&4294967295,S=I+(R<<22&4294967295|R>>>10),R=k+(C^S&(I^C))+U[4]+4118548399&4294967295,k=S+(R<<7&4294967295|R>>>25),R=C+(I^k&(S^I))+U[5]+1200080426&4294967295,C=k+(R<<12&4294967295|R>>>20),R=I+(S^C&(k^S))+U[6]+2821735955&4294967295,I=C+(R<<17&4294967295|R>>>15),R=S+(k^I&(C^k))+U[7]+4249261313&4294967295,S=I+(R<<22&4294967295|R>>>10),R=k+(C^S&(I^C))+U[8]+1770035416&4294967295,k=S+(R<<7&4294967295|R>>>25),R=C+(I^k&(S^I))+U[9]+2336552879&4294967295,C=k+(R<<12&4294967295|R>>>20),R=I+(S^C&(k^S))+U[10]+4294925233&4294967295,I=C+(R<<17&4294967295|R>>>15),R=S+(k^I&(C^k))+U[11]+2304563134&4294967295,S=I+(R<<22&4294967295|R>>>10),R=k+(C^S&(I^C))+U[12]+1804603682&4294967295,k=S+(R<<7&4294967295|R>>>25),R=C+(I^k&(S^I))+U[13]+4254626195&4294967295,C=k+(R<<12&4294967295|R>>>20),R=I+(S^C&(k^S))+U[14]+2792965006&4294967295,I=C+(R<<17&4294967295|R>>>15),R=S+(k^I&(C^k))+U[15]+1236535329&4294967295,S=I+(R<<22&4294967295|R>>>10),R=k+(I^C&(S^I))+U[1]+4129170786&4294967295,k=S+(R<<5&4294967295|R>>>27),R=C+(S^I&(k^S))+U[6]+3225465664&4294967295,C=k+(R<<9&4294967295|R>>>23),R=I+(k^S&(C^k))+U[11]+643717713&4294967295,I=C+(R<<14&4294967295|R>>>18),R=S+(C^k&(I^C))+U[0]+3921069994&4294967295,S=I+(R<<20&4294967295|R>>>12),R=k+(I^C&(S^I))+U[5]+3593408605&4294967295,k=S+(R<<5&4294967295|R>>>27),R=C+(S^I&(k^S))+U[10]+38016083&4294967295,C=k+(R<<9&4294967295|R>>>23),R=I+(k^S&(C^k))+U[15]+3634488961&4294967295,I=C+(R<<14&4294967295|R>>>18),R=S+(C^k&(I^C))+U[4]+3889429448&4294967295,S=I+(R<<20&4294967295|R>>>12),R=k+(I^C&(S^I))+U[9]+568446438&4294967295,k=S+(R<<5&4294967295|R>>>27),R=C+(S^I&(k^S))+U[14]+3275163606&4294967295,C=k+(R<<9&4294967295|R>>>23),R=I+(k^S&(C^k))+U[3]+4107603335&4294967295,I=C+(R<<14&4294967295|R>>>18),R=S+(C^k&(I^C))+U[8]+1163531501&4294967295,S=I+(R<<20&4294967295|R>>>12),R=k+(I^C&(S^I))+U[13]+2850285829&4294967295,k=S+(R<<5&4294967295|R>>>27),R=C+(S^I&(k^S))+U[2]+4243563512&4294967295,C=k+(R<<9&4294967295|R>>>23),R=I+(k^S&(C^k))+U[7]+1735328473&4294967295,I=C+(R<<14&4294967295|R>>>18),R=S+(C^k&(I^C))+U[12]+2368359562&4294967295,S=I+(R<<20&4294967295|R>>>12),R=k+(S^I^C)+U[5]+4294588738&4294967295,k=S+(R<<4&4294967295|R>>>28),R=C+(k^S^I)+U[8]+2272392833&4294967295,C=k+(R<<11&4294967295|R>>>21),R=I+(C^k^S)+U[11]+1839030562&4294967295,I=C+(R<<16&4294967295|R>>>16),R=S+(I^C^k)+U[14]+4259657740&4294967295,S=I+(R<<23&4294967295|R>>>9),R=k+(S^I^C)+U[1]+2763975236&4294967295,k=S+(R<<4&4294967295|R>>>28),R=C+(k^S^I)+U[4]+1272893353&4294967295,C=k+(R<<11&4294967295|R>>>21),R=I+(C^k^S)+U[7]+4139469664&4294967295,I=C+(R<<16&4294967295|R>>>16),R=S+(I^C^k)+U[10]+3200236656&4294967295,S=I+(R<<23&4294967295|R>>>9),R=k+(S^I^C)+U[13]+681279174&4294967295,k=S+(R<<4&4294967295|R>>>28),R=C+(k^S^I)+U[0]+3936430074&4294967295,C=k+(R<<11&4294967295|R>>>21),R=I+(C^k^S)+U[3]+3572445317&4294967295,I=C+(R<<16&4294967295|R>>>16),R=S+(I^C^k)+U[6]+76029189&4294967295,S=I+(R<<23&4294967295|R>>>9),R=k+(S^I^C)+U[9]+3654602809&4294967295,k=S+(R<<4&4294967295|R>>>28),R=C+(k^S^I)+U[12]+3873151461&4294967295,C=k+(R<<11&4294967295|R>>>21),R=I+(C^k^S)+U[15]+530742520&4294967295,I=C+(R<<16&4294967295|R>>>16),R=S+(I^C^k)+U[2]+3299628645&4294967295,S=I+(R<<23&4294967295|R>>>9),R=k+(I^(S|~C))+U[0]+4096336452&4294967295,k=S+(R<<6&4294967295|R>>>26),R=C+(S^(k|~I))+U[7]+1126891415&4294967295,C=k+(R<<10&4294967295|R>>>22),R=I+(k^(C|~S))+U[14]+2878612391&4294967295,I=C+(R<<15&4294967295|R>>>17),R=S+(C^(I|~k))+U[5]+4237533241&4294967295,S=I+(R<<21&4294967295|R>>>11),R=k+(I^(S|~C))+U[12]+1700485571&4294967295,k=S+(R<<6&4294967295|R>>>26),R=C+(S^(k|~I))+U[3]+2399980690&4294967295,C=k+(R<<10&4294967295|R>>>22),R=I+(k^(C|~S))+U[10]+4293915773&4294967295,I=C+(R<<15&4294967295|R>>>17),R=S+(C^(I|~k))+U[1]+2240044497&4294967295,S=I+(R<<21&4294967295|R>>>11),R=k+(I^(S|~C))+U[8]+1873313359&4294967295,k=S+(R<<6&4294967295|R>>>26),R=C+(S^(k|~I))+U[15]+4264355552&4294967295,C=k+(R<<10&4294967295|R>>>22),R=I+(k^(C|~S))+U[6]+2734768916&4294967295,I=C+(R<<15&4294967295|R>>>17),R=S+(C^(I|~k))+U[13]+1309151649&4294967295,S=I+(R<<21&4294967295|R>>>11),R=k+(I^(S|~C))+U[4]+4149444226&4294967295,k=S+(R<<6&4294967295|R>>>26),R=C+(S^(k|~I))+U[11]+3174756917&4294967295,C=k+(R<<10&4294967295|R>>>22),R=I+(k^(C|~S))+U[2]+718787259&4294967295,I=C+(R<<15&4294967295|R>>>17),R=S+(C^(I|~k))+U[9]+3951481745&4294967295,F.g[0]=F.g[0]+k&4294967295,F.g[1]=F.g[1]+(I+(R<<21&4294967295|R>>>11))&4294967295,F.g[2]=F.g[2]+I&4294967295,F.g[3]=F.g[3]+C&4294967295}n.prototype.u=function(F,k){k===void 0&&(k=F.length);for(var S=k-this.blockSize,U=this.B,I=this.h,C=0;C<k;){if(I==0)for(;C<=S;)i(this,F,C),C+=this.blockSize;if(typeof F=="string"){for(;C<k;)if(U[I++]=F.charCodeAt(C++),I==this.blockSize){i(this,U),I=0;break}}else for(;C<k;)if(U[I++]=F[C++],I==this.blockSize){i(this,U),I=0;break}}this.h=I,this.o+=k},n.prototype.v=function(){var F=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);F[0]=128;for(var k=1;k<F.length-8;++k)F[k]=0;var S=8*this.o;for(k=F.length-8;k<F.length;++k)F[k]=S&255,S/=256;for(this.u(F),F=Array(16),k=S=0;4>k;++k)for(var U=0;32>U;U+=8)F[S++]=this.g[k]>>>U&255;return F};function a(F,k){var S=c;return Object.prototype.hasOwnProperty.call(S,F)?S[F]:S[F]=k(F)}function o(F,k){this.h=k;for(var S=[],U=!0,I=F.length-1;0<=I;I--){var C=F[I]|0;U&&C==k||(S[I]=C,U=!1)}this.g=S}var c={};function u(F){return-128<=F&&128>F?a(F,function(k){return new o([k|0],0>k?-1:0)}):new o([F|0],0>F?-1:0)}function h(F){if(isNaN(F)||!isFinite(F))return g;if(0>F)return A(h(-F));for(var k=[],S=1,U=0;F>=S;U++)k[U]=F/S|0,S*=4294967296;return new o(k,0)}function d(F,k){if(F.length==0)throw Error("number format error: empty string");if(k=k||10,2>k||36<k)throw Error("radix out of range: "+k);if(F.charAt(0)=="-")return A(d(F.substring(1),k));if(0<=F.indexOf("-"))throw Error('number format error: interior "-" character');for(var S=h(Math.pow(k,8)),U=g,I=0;I<F.length;I+=8){var C=Math.min(8,F.length-I),R=parseInt(F.substring(I,I+C),k);8>C?(C=h(Math.pow(k,C)),U=U.j(C).add(h(R))):(U=U.j(S),U=U.add(h(R)))}return U}var g=u(0),x=u(1),_=u(16777216);t=o.prototype,t.m=function(){if(E(this))return-A(this).m();for(var F=0,k=1,S=0;S<this.g.length;S++){var U=this.i(S);F+=(0<=U?U:4294967296+U)*k,k*=4294967296}return F},t.toString=function(F){if(F=F||10,2>F||36<F)throw Error("radix out of range: "+F);if(b(this))return"0";if(E(this))return"-"+A(this).toString(F);for(var k=h(Math.pow(F,6)),S=this,U="";;){var I=Q(S,k).g;S=O(S,I.j(k));var C=((0<S.g.length?S.g[0]:S.h)>>>0).toString(F);if(S=I,b(S))return C+U;for(;6>C.length;)C="0"+C;U=C+U}},t.i=function(F){return 0>F?0:F<this.g.length?this.g[F]:this.h};function b(F){if(F.h!=0)return!1;for(var k=0;k<F.g.length;k++)if(F.g[k]!=0)return!1;return!0}function E(F){return F.h==-1}t.l=function(F){return F=O(this,F),E(F)?-1:b(F)?0:1};function A(F){for(var k=F.g.length,S=[],U=0;U<k;U++)S[U]=~F.g[U];return new o(S,~F.h).add(x)}t.abs=function(){return E(this)?A(this):this},t.add=function(F){for(var k=Math.max(this.g.length,F.g.length),S=[],U=0,I=0;I<=k;I++){var C=U+(this.i(I)&65535)+(F.i(I)&65535),R=(C>>>16)+(this.i(I)>>>16)+(F.i(I)>>>16);U=R>>>16,C&=65535,R&=65535,S[I]=R<<16|C}return new o(S,S[S.length-1]&-2147483648?-1:0)};function O(F,k){return F.add(A(k))}t.j=function(F){if(b(this)||b(F))return g;if(E(this))return E(F)?A(this).j(A(F)):A(A(this).j(F));if(E(F))return A(this.j(A(F)));if(0>this.l(_)&&0>F.l(_))return h(this.m()*F.m());for(var k=this.g.length+F.g.length,S=[],U=0;U<2*k;U++)S[U]=0;for(U=0;U<this.g.length;U++)for(var I=0;I<F.g.length;I++){var C=this.i(U)>>>16,R=this.i(U)&65535,se=F.i(I)>>>16,ne=F.i(I)&65535;S[2*U+2*I]+=R*ne,M(S,2*U+2*I),S[2*U+2*I+1]+=C*ne,M(S,2*U+2*I+1),S[2*U+2*I+1]+=R*se,M(S,2*U+2*I+1),S[2*U+2*I+2]+=C*se,M(S,2*U+2*I+2)}for(U=0;U<k;U++)S[U]=S[2*U+1]<<16|S[2*U];for(U=k;U<2*k;U++)S[U]=0;return new o(S,0)};function M(F,k){for(;(F[k]&65535)!=F[k];)F[k+1]+=F[k]>>>16,F[k]&=65535,k++}function B(F,k){this.g=F,this.h=k}function Q(F,k){if(b(k))throw Error("division by zero");if(b(F))return new B(g,g);if(E(F))return k=Q(A(F),k),new B(A(k.g),A(k.h));if(E(k))return k=Q(F,A(k)),new B(A(k.g),k.h);if(30<F.g.length){if(E(F)||E(k))throw Error("slowDivide_ only works with positive integers.");for(var S=x,U=k;0>=U.l(F);)S=ee(S),U=ee(U);var I=he(S,1),C=he(U,1);for(U=he(U,2),S=he(S,2);!b(U);){var R=C.add(U);0>=R.l(F)&&(I=I.add(S),C=R),U=he(U,1),S=he(S,1)}return k=O(F,I.j(k)),new B(I,k)}for(I=g;0<=F.l(k);){for(S=Math.max(1,Math.floor(F.m()/k.m())),U=Math.ceil(Math.log(S)/Math.LN2),U=48>=U?1:Math.pow(2,U-48),C=h(S),R=C.j(k);E(R)||0<R.l(F);)S-=U,C=h(S),R=C.j(k);b(C)&&(C=x),I=I.add(C),F=O(F,R)}return new B(I,F)}t.A=function(F){return Q(this,F).h},t.and=function(F){for(var k=Math.max(this.g.length,F.g.length),S=[],U=0;U<k;U++)S[U]=this.i(U)&F.i(U);return new o(S,this.h&F.h)},t.or=function(F){for(var k=Math.max(this.g.length,F.g.length),S=[],U=0;U<k;U++)S[U]=this.i(U)|F.i(U);return new o(S,this.h|F.h)},t.xor=function(F){for(var k=Math.max(this.g.length,F.g.length),S=[],U=0;U<k;U++)S[U]=this.i(U)^F.i(U);return new o(S,this.h^F.h)};function ee(F){for(var k=F.g.length+1,S=[],U=0;U<k;U++)S[U]=F.i(U)<<1|F.i(U-1)>>>31;return new o(S,F.h)}function he(F,k){var S=k>>5;k%=32;for(var U=F.g.length-S,I=[],C=0;C<U;C++)I[C]=0<k?F.i(C+S)>>>k|F.i(C+S+1)<<32-k:F.i(C+S);return new o(I,F.h)}n.prototype.digest=n.prototype.v,n.prototype.reset=n.prototype.s,n.prototype.update=n.prototype.u,MS=n,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.A,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=h,o.fromString=d,hf=o}).apply(typeof eE<"u"?eE:typeof self<"u"?self:typeof window<"u"?window:{});var xm=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var BS,i1,jS,Hm,R_,US,VS,qS;(function(){var t,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(v,P,q){return v==Array.prototype||v==Object.prototype||(v[P]=q.value),v};function r(v){v=[typeof globalThis=="object"&&globalThis,v,typeof window=="object"&&window,typeof self=="object"&&self,typeof xm=="object"&&xm];for(var P=0;P<v.length;++P){var q=v[P];if(q&&q.Math==Math)return q}throw Error("Cannot find global object")}var n=r(this);function i(v,P){if(P)e:{var q=n;v=v.split(".");for(var ce=0;ce<v.length-1;ce++){var Fe=v[ce];if(!(Fe in q))break e;q=q[Fe]}v=v[v.length-1],ce=q[v],P=P(ce),P!=ce&&P!=null&&e(q,v,{configurable:!0,writable:!0,value:P})}}function a(v,P){v instanceof String&&(v+="");var q=0,ce=!1,Fe={next:function(){if(!ce&&q<v.length){var We=q++;return{value:P(We,v[We]),done:!1}}return ce=!0,{done:!0,value:void 0}}};return Fe[Symbol.iterator]=function(){return Fe},Fe}i("Array.prototype.values",function(v){return v||function(){return a(this,function(P,q){return q})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var o=o||{},c=this||self;function u(v){var P=typeof v;return P=P!="object"?P:v?Array.isArray(v)?"array":P:"null",P=="array"||P=="object"&&typeof v.length=="number"}function h(v){var P=typeof v;return P=="object"&&v!=null||P=="function"}function d(v,P,q){return v.call.apply(v.bind,arguments)}function g(v,P,q){if(!v)throw Error();if(2<arguments.length){var ce=Array.prototype.slice.call(arguments,2);return function(){var Fe=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(Fe,ce),v.apply(P,Fe)}}return function(){return v.apply(P,arguments)}}function x(v,P,q){return x=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?d:g,x.apply(null,arguments)}function _(v,P){var q=Array.prototype.slice.call(arguments,1);return function(){var ce=q.slice();return ce.push.apply(ce,arguments),v.apply(this,ce)}}function b(v,P){function q(){}q.prototype=P.prototype,v.aa=P.prototype,v.prototype=new q,v.prototype.constructor=v,v.Qb=function(ce,Fe,We){for(var wt=Array(arguments.length-2),rr=2;rr<arguments.length;rr++)wt[rr-2]=arguments[rr];return P.prototype[Fe].apply(ce,wt)}}function E(v){const P=v.length;if(0<P){const q=Array(P);for(let ce=0;ce<P;ce++)q[ce]=v[ce];return q}return[]}function A(v,P){for(let q=1;q<arguments.length;q++){const ce=arguments[q];if(u(ce)){const Fe=v.length||0,We=ce.length||0;v.length=Fe+We;for(let wt=0;wt<We;wt++)v[Fe+wt]=ce[wt]}else v.push(ce)}}class O{constructor(P,q){this.i=P,this.j=q,this.h=0,this.g=null}get(){let P;return 0<this.h?(this.h--,P=this.g,this.g=P.next,P.next=null):P=this.i(),P}}function M(v){return/^[\s\xa0]*$/.test(v)}function B(){var v=c.navigator;return v&&(v=v.userAgent)?v:""}function Q(v){return Q[" "](v),v}Q[" "]=function(){};var ee=B().indexOf("Gecko")!=-1&&!(B().toLowerCase().indexOf("webkit")!=-1&&B().indexOf("Edge")==-1)&&!(B().indexOf("Trident")!=-1||B().indexOf("MSIE")!=-1)&&B().indexOf("Edge")==-1;function he(v,P,q){for(const ce in v)P.call(q,v[ce],ce,v)}function F(v,P){for(const q in v)P.call(void 0,v[q],q,v)}function k(v){const P={};for(const q in v)P[q]=v[q];return P}const S="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function U(v,P){let q,ce;for(let Fe=1;Fe<arguments.length;Fe++){ce=arguments[Fe];for(q in ce)v[q]=ce[q];for(let We=0;We<S.length;We++)q=S[We],Object.prototype.hasOwnProperty.call(ce,q)&&(v[q]=ce[q])}}function I(v){var P=1;v=v.split(":");const q=[];for(;0<P&&v.length;)q.push(v.shift()),P--;return v.length&&q.push(v.join(":")),q}function C(v){c.setTimeout(()=>{throw v},0)}function R(){var v=Z;let P=null;return v.g&&(P=v.g,v.g=v.g.next,v.g||(v.h=null),P.next=null),P}class se{constructor(){this.h=this.g=null}add(P,q){const ce=ne.get();ce.set(P,q),this.h?this.h.next=ce:this.g=ce,this.h=ce}}var ne=new O(()=>new J,v=>v.reset());class J{constructor(){this.next=this.g=this.h=null}set(P,q){this.h=P,this.g=q,this.next=null}reset(){this.next=this.g=this.h=null}}let de,oe=!1,Z=new se,X=()=>{const v=c.Promise.resolve(void 0);de=()=>{v.then(xe)}};var xe=()=>{for(var v;v=R();){try{v.h.call(v.g)}catch(q){C(q)}var P=ne;P.j(v),100>P.h&&(P.h++,v.next=P.g,P.g=v)}oe=!1};function L(){this.s=this.s,this.C=this.C}L.prototype.s=!1,L.prototype.ma=function(){this.s||(this.s=!0,this.N())},L.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function j(v,P){this.type=v,this.g=this.target=P,this.defaultPrevented=!1}j.prototype.h=function(){this.defaultPrevented=!0};var z=function(){if(!c.addEventListener||!Object.defineProperty)return!1;var v=!1,P=Object.defineProperty({},"passive",{get:function(){v=!0}});try{const q=()=>{};c.addEventListener("test",q,P),c.removeEventListener("test",q,P)}catch{}return v}();function G(v,P){if(j.call(this,v?v.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,v){var q=this.type=v.type,ce=v.changedTouches&&v.changedTouches.length?v.changedTouches[0]:null;if(this.target=v.target||v.srcElement,this.g=P,P=v.relatedTarget){if(ee){e:{try{Q(P.nodeName);var Fe=!0;break e}catch{}Fe=!1}Fe||(P=null)}}else q=="mouseover"?P=v.fromElement:q=="mouseout"&&(P=v.toElement);this.relatedTarget=P,ce?(this.clientX=ce.clientX!==void 0?ce.clientX:ce.pageX,this.clientY=ce.clientY!==void 0?ce.clientY:ce.pageY,this.screenX=ce.screenX||0,this.screenY=ce.screenY||0):(this.clientX=v.clientX!==void 0?v.clientX:v.pageX,this.clientY=v.clientY!==void 0?v.clientY:v.pageY,this.screenX=v.screenX||0,this.screenY=v.screenY||0),this.button=v.button,this.key=v.key||"",this.ctrlKey=v.ctrlKey,this.altKey=v.altKey,this.shiftKey=v.shiftKey,this.metaKey=v.metaKey,this.pointerId=v.pointerId||0,this.pointerType=typeof v.pointerType=="string"?v.pointerType:ae[v.pointerType]||"",this.state=v.state,this.i=v,v.defaultPrevented&&G.aa.h.call(this)}}b(G,j);var ae={2:"touch",3:"pen",4:"mouse"};G.prototype.h=function(){G.aa.h.call(this);var v=this.i;v.preventDefault?v.preventDefault():v.returnValue=!1};var Ae="closure_listenable_"+(1e6*Math.random()|0),_e=0;function Ee(v,P,q,ce,Fe){this.listener=v,this.proxy=null,this.src=P,this.type=q,this.capture=!!ce,this.ha=Fe,this.key=++_e,this.da=this.fa=!1}function Ce(v){v.da=!0,v.listener=null,v.proxy=null,v.src=null,v.ha=null}function Oe(v){this.src=v,this.g={},this.h=0}Oe.prototype.add=function(v,P,q,ce,Fe){var We=v.toString();v=this.g[We],v||(v=this.g[We]=[],this.h++);var wt=rt(v,P,ce,Fe);return-1<wt?(P=v[wt],q||(P.fa=!1)):(P=new Ee(P,this.src,We,!!ce,Fe),P.fa=q,v.push(P)),P};function fe(v,P){var q=P.type;if(q in v.g){var ce=v.g[q],Fe=Array.prototype.indexOf.call(ce,P,void 0),We;(We=0<=Fe)&&Array.prototype.splice.call(ce,Fe,1),We&&(Ce(P),v.g[q].length==0&&(delete v.g[q],v.h--))}}function rt(v,P,q,ce){for(var Fe=0;Fe<v.length;++Fe){var We=v[Fe];if(!We.da&&We.listener==P&&We.capture==!!q&&We.ha==ce)return Fe}return-1}var ot="closure_lm_"+(1e6*Math.random()|0),Pe={};function ge(v,P,q,ce,Fe){if(Array.isArray(P)){for(var We=0;We<P.length;We++)ge(v,P[We],q,ce,Fe);return null}return q=qt(q),v&&v[Ae]?v.K(P,q,h(ce)?!!ce.capture:!1,Fe):Je(v,P,q,!1,ce,Fe)}function Je(v,P,q,ce,Fe,We){if(!P)throw Error("Invalid event type");var wt=h(Fe)?!!Fe.capture:!!Fe,rr=Mt(v);if(rr||(v[ot]=rr=new Oe(v)),q=rr.add(P,q,ce,wt,We),q.proxy)return q;if(ce=nt(),q.proxy=ce,ce.src=v,ce.listener=q,v.addEventListener)z||(Fe=wt),Fe===void 0&&(Fe=!1),v.addEventListener(P.toString(),ce,Fe);else if(v.attachEvent)v.attachEvent(Et(P.toString()),ce);else if(v.addListener&&v.removeListener)v.addListener(ce);else throw Error("addEventListener and attachEvent are unavailable.");return q}function nt(){function v(q){return P.call(v.src,v.listener,q)}const P=bt;return v}function et(v,P,q,ce,Fe){if(Array.isArray(P))for(var We=0;We<P.length;We++)et(v,P[We],q,ce,Fe);else ce=h(ce)?!!ce.capture:!!ce,q=qt(q),v&&v[Ae]?(v=v.i,P=String(P).toString(),P in v.g&&(We=v.g[P],q=rt(We,q,ce,Fe),-1<q&&(Ce(We[q]),Array.prototype.splice.call(We,q,1),We.length==0&&(delete v.g[P],v.h--)))):v&&(v=Mt(v))&&(P=v.g[P.toString()],v=-1,P&&(v=rt(P,q,ce,Fe)),(q=-1<v?P[v]:null)&&vt(q))}function vt(v){if(typeof v!="number"&&v&&!v.da){var P=v.src;if(P&&P[Ae])fe(P.i,v);else{var q=v.type,ce=v.proxy;P.removeEventListener?P.removeEventListener(q,ce,v.capture):P.detachEvent?P.detachEvent(Et(q),ce):P.addListener&&P.removeListener&&P.removeListener(ce),(q=Mt(P))?(fe(q,v),q.h==0&&(q.src=null,P[ot]=null)):Ce(v)}}}function Et(v){return v in Pe?Pe[v]:Pe[v]="on"+v}function bt(v,P){if(v.da)v=!0;else{P=new G(P,this);var q=v.listener,ce=v.ha||v.src;v.fa&&vt(v),v=q.call(ce,P)}return v}function Mt(v){return v=v[ot],v instanceof Oe?v:null}var Dt="__closure_events_fn_"+(1e9*Math.random()>>>0);function qt(v){return typeof v=="function"?v:(v[Dt]||(v[Dt]=function(P){return v.handleEvent(P)}),v[Dt])}function Tt(){L.call(this),this.i=new Oe(this),this.M=this,this.F=null}b(Tt,L),Tt.prototype[Ae]=!0,Tt.prototype.removeEventListener=function(v,P,q,ce){et(this,v,P,q,ce)};function kt(v,P){var q,ce=v.F;if(ce)for(q=[];ce;ce=ce.F)q.push(ce);if(v=v.M,ce=P.type||P,typeof P=="string")P=new j(P,v);else if(P instanceof j)P.target=P.target||v;else{var Fe=P;P=new j(ce,v),U(P,Fe)}if(Fe=!0,q)for(var We=q.length-1;0<=We;We--){var wt=P.g=q[We];Fe=zt(wt,ce,!0,P)&&Fe}if(wt=P.g=v,Fe=zt(wt,ce,!0,P)&&Fe,Fe=zt(wt,ce,!1,P)&&Fe,q)for(We=0;We<q.length;We++)wt=P.g=q[We],Fe=zt(wt,ce,!1,P)&&Fe}Tt.prototype.N=function(){if(Tt.aa.N.call(this),this.i){var v=this.i,P;for(P in v.g){for(var q=v.g[P],ce=0;ce<q.length;ce++)Ce(q[ce]);delete v.g[P],v.h--}}this.F=null},Tt.prototype.K=function(v,P,q,ce){return this.i.add(String(v),P,!1,q,ce)},Tt.prototype.L=function(v,P,q,ce){return this.i.add(String(v),P,!0,q,ce)};function zt(v,P,q,ce){if(P=v.i.g[String(P)],!P)return!0;P=P.concat();for(var Fe=!0,We=0;We<P.length;++We){var wt=P[We];if(wt&&!wt.da&&wt.capture==q){var rr=wt.listener,Pr=wt.ha||wt.src;wt.fa&&fe(v.i,wt),Fe=rr.call(Pr,ce)!==!1&&Fe}}return Fe&&!ce.defaultPrevented}function Pt(v,P,q){if(typeof v=="function")q&&(v=x(v,q));else if(v&&typeof v.handleEvent=="function")v=x(v.handleEvent,v);else throw Error("Invalid listener argument");return 2147483647<Number(P)?-1:c.setTimeout(v,P||0)}function Nt(v){v.g=Pt(()=>{v.g=null,v.i&&(v.i=!1,Nt(v))},v.l);const P=v.h;v.h=null,v.m.apply(null,P)}class _t extends L{constructor(P,q){super(),this.m=P,this.l=q,this.h=null,this.i=!1,this.g=null}j(P){this.h=arguments,this.g?this.i=!0:Nt(this)}N(){super.N(),this.g&&(c.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function or(v){L.call(this),this.h=v,this.g={}}b(or,L);var Gt=[];function zr(v){he(v.g,function(P,q){this.g.hasOwnProperty(q)&&vt(P)},v),v.g={}}or.prototype.N=function(){or.aa.N.call(this),zr(this)},or.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var yr=c.JSON.stringify,Qr=c.JSON.parse,Ii=class{stringify(v){return c.JSON.stringify(v,void 0)}parse(v){return c.JSON.parse(v,void 0)}};function Tr(){}Tr.prototype.h=null;function Ra(v){return v.h||(v.h=v.i())}function hn(){}var Yn={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function di(){j.call(this,"d")}b(di,j);function Jr(){j.call(this,"c")}b(Jr,j);var Kt={},Dr=null;function ea(){return Dr=Dr||new Tt}Kt.La="serverreachability";function Dn(v){j.call(this,Kt.La,v)}b(Dn,j);function pi(v){const P=ea();kt(P,new Dn(P))}Kt.STAT_EVENT="statevent";function ga(v,P){j.call(this,Kt.STAT_EVENT,v),this.stat=P}b(ga,j);function jt(v){const P=ea();kt(P,new ga(P,v))}Kt.Ma="timingevent";function Zr(v,P){j.call(this,Kt.Ma,v),this.size=P}b(Zr,j);function Hr(v,P){if(typeof v!="function")throw Error("Fn must not be null and must be a function");return c.setTimeout(function(){v()},P)}function gn(){this.g=!0}gn.prototype.xa=function(){this.g=!1};function In(v,P,q,ce,Fe,We){v.info(function(){if(v.g)if(We)for(var wt="",rr=We.split("&"),Pr=0;Pr<rr.length;Pr++){var mr=rr[Pr].split("=");if(1<mr.length){var an=mr[0];mr=mr[1];var dn=an.split("_");wt=2<=dn.length&&dn[1]=="type"?wt+(an+"="+mr+"&"):wt+(an+"=redacted&")}}else wt=null;else wt=We;return"XMLHTTP REQ ("+ce+") [attempt "+Fe+"]: "+P+`
`+q+`
`+wt})}function Fn(v,P,q,ce,Fe,We,wt){v.info(function(){return"XMLHTTP RESP ("+ce+") [ attempt "+Fe+"]: "+P+`
`+q+`
`+We+" "+wt})}function te(v,P,q,ce){v.info(function(){return"XMLHTTP TEXT ("+P+"): "+me(v,q)+(ce?" "+ce:"")})}function be(v,P){v.info(function(){return"TIMEOUT: "+P})}gn.prototype.info=function(){};function me(v,P){if(!v.g)return P;if(!P)return null;try{var q=JSON.parse(P);if(q){for(v=0;v<q.length;v++)if(Array.isArray(q[v])){var ce=q[v];if(!(2>ce.length)){var Fe=ce[1];if(Array.isArray(Fe)&&!(1>Fe.length)){var We=Fe[0];if(We!="noop"&&We!="stop"&&We!="close")for(var wt=1;wt<Fe.length;wt++)Fe[wt]=""}}}}return yr(q)}catch{return P}}var ve={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},we={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},Se;function Ve(){}b(Ve,Tr),Ve.prototype.g=function(){return new XMLHttpRequest},Ve.prototype.i=function(){return{}},Se=new Ve;function $e(v,P,q,ce){this.j=v,this.i=P,this.l=q,this.R=ce||1,this.U=new or(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new Me}function Me(){this.i=null,this.g="",this.h=!1}var He={},Ye={};function pt(v,P,q){v.L=1,v.v=uo(Xi(P)),v.m=q,v.P=!0,At(v,null)}function At(v,P){v.F=Date.now(),Rt(v),v.A=Xi(v.v);var q=v.A,ce=v.R;Array.isArray(ce)||(ce=[String(ce)]),tr(q.i,"t",ce),v.C=0,q=v.j.J,v.h=new Me,v.g=K(v.j,q?P:null,!v.m),0<v.O&&(v.M=new _t(x(v.Y,v,v.g),v.O)),P=v.U,q=v.g,ce=v.ca;var Fe="readystatechange";Array.isArray(Fe)||(Fe&&(Gt[0]=Fe.toString()),Fe=Gt);for(var We=0;We<Fe.length;We++){var wt=ge(q,Fe[We],ce||P.handleEvent,!1,P.h||P);if(!wt)break;P.g[wt.key]=wt}P=v.H?k(v.H):{},v.m?(v.u||(v.u="POST"),P["Content-Type"]="application/x-www-form-urlencoded",v.g.ea(v.A,v.u,v.m,P)):(v.u="GET",v.g.ea(v.A,v.u,null,P)),pi(),In(v.i,v.u,v.A,v.l,v.R,v.m)}$e.prototype.ca=function(v){v=v.target;const P=this.M;P&&ii(v)==3?P.j():this.Y(v)},$e.prototype.Y=function(v){try{if(v==this.g)e:{const dn=ii(this.g);var P=this.g.Ba();const ws=this.g.Z();if(!(3>dn)&&(dn!=3||this.g&&(this.h.h||this.g.oa()||vu(this.g)))){this.J||dn!=4||P==7||(P==8||0>=ws?pi(3):pi(2)),kr(this);var q=this.g.Z();this.X=q;t:if(Bt(this)){var ce=vu(this.g);v="";var Fe=ce.length,We=ii(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){Fr(this),Nr(this);var wt="";break t}this.h.i=new c.TextDecoder}for(P=0;P<Fe;P++)this.h.h=!0,v+=this.h.i.decode(ce[P],{stream:!(We&&P==Fe-1)});ce.length=0,this.h.g+=v,this.C=0,wt=this.h.g}else wt=this.g.oa();if(this.o=q==200,Fn(this.i,this.u,this.A,this.l,this.R,dn,q),this.o){if(this.T&&!this.K){t:{if(this.g){var rr,Pr=this.g;if((rr=Pr.g?Pr.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!M(rr)){var mr=rr;break t}}mr=null}if(q=mr)te(this.i,this.l,q,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Hi(this,q);else{this.o=!1,this.s=3,jt(12),Fr(this),Nr(this);break e}}if(this.P){q=!0;let Kn;for(;!this.J&&this.C<wt.length;)if(Kn=St(this,wt),Kn==Ye){dn==4&&(this.s=4,jt(14),q=!1),te(this.i,this.l,null,"[Incomplete Response]");break}else if(Kn==He){this.s=4,jt(15),te(this.i,this.l,wt,"[Invalid Chunk]"),q=!1;break}else te(this.i,this.l,Kn,null),Hi(this,Kn);if(Bt(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),dn!=4||wt.length!=0||this.h.h||(this.s=1,jt(16),q=!1),this.o=this.o&&q,!q)te(this.i,this.l,wt,"[Invalid Chunked Response]"),Fr(this),Nr(this);else if(0<wt.length&&!this.W){this.W=!0;var an=this.j;an.g==this&&an.ba&&!an.M&&(an.j.info("Great, no buffering proxy detected. Bytes received: "+wt.length),vo(an),an.M=!0,jt(11))}}else te(this.i,this.l,wt,null),Hi(this,wt);dn==4&&Fr(this),this.o&&!this.J&&(dn==4?_o(this.j,this):(this.o=!1,Rt(this)))}else po(this.g),q==400&&0<wt.indexOf("Unknown SID")?(this.s=3,jt(12)):(this.s=0,jt(13)),Fr(this),Nr(this)}}}catch{}finally{}};function Bt(v){return v.g?v.u=="GET"&&v.L!=2&&v.j.Ca:!1}function St(v,P){var q=v.C,ce=P.indexOf(`
`,q);return ce==-1?Ye:(q=Number(P.substring(q,ce)),isNaN(q)?He:(ce+=1,ce+q>P.length?Ye:(P=P.slice(ce,ce+q),v.C=ce+q,P)))}$e.prototype.cancel=function(){this.J=!0,Fr(this)};function Rt(v){v.S=Date.now()+v.I,er(v,v.I)}function er(v,P){if(v.B!=null)throw Error("WatchDog timer not null");v.B=Hr(x(v.ba,v),P)}function kr(v){v.B&&(c.clearTimeout(v.B),v.B=null)}$e.prototype.ba=function(){this.B=null;const v=Date.now();0<=v-this.S?(be(this.i,this.A),this.L!=2&&(pi(),jt(17)),Fr(this),this.s=2,Nr(this)):er(this,this.S-v)};function Nr(v){v.j.G==0||v.J||_o(v.j,v)}function Fr(v){kr(v);var P=v.M;P&&typeof P.ma=="function"&&P.ma(),v.M=null,zr(v.U),v.g&&(P=v.g,v.g=null,P.abort(),P.ma())}function Hi(v,P){try{var q=v.j;if(q.G!=0&&(q.g==v||Gi(q.h,v))){if(!v.K&&Gi(q.h,v)&&q.G==3){try{var ce=q.Da.g.parse(P)}catch{ce=null}if(Array.isArray(ce)&&ce.length==3){var Fe=ce;if(Fe[0]==0){e:if(!q.u){if(q.g)if(q.g.F+3e3<v.F)Vs(q),Cl(q);else break e;Yo(q),jt(18)}}else q.za=Fe[1],0<q.za-q.T&&37500>Fe[2]&&q.F&&q.v==0&&!q.C&&(q.C=Hr(x(q.Za,q),6e3));if(1>=va(q.h)&&q.ca){try{q.ca()}catch{}q.ca=void 0}}else aa(q,11)}else if((v.K||q.g==v)&&Vs(q),!M(P))for(Fe=q.Da.g.parse(P),P=0;P<Fe.length;P++){let mr=Fe[P];if(q.T=mr[0],mr=mr[1],q.G==2)if(mr[0]=="c"){q.K=mr[1],q.ia=mr[2];const an=mr[3];an!=null&&(q.la=an,q.j.info("VER="+q.la));const dn=mr[4];dn!=null&&(q.Aa=dn,q.j.info("SVER="+q.Aa));const ws=mr[5];ws!=null&&typeof ws=="number"&&0<ws&&(ce=1.5*ws,q.L=ce,q.j.info("backChannelRequestTimeoutMs_="+ce)),ce=q;const Kn=v.g;if(Kn){const Pa=Kn.g?Kn.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Pa){var We=ce.h;We.g||Pa.indexOf("spdy")==-1&&Pa.indexOf("quic")==-1&&Pa.indexOf("h2")==-1||(We.j=We.l,We.g=new Set,We.h&&(An(We,We.h),We.h=null))}if(ce.D){const xo=Kn.g?Kn.g.getResponseHeader("X-HTTP-Session-Id"):null;xo&&(ce.ya=xo,nn(ce.I,ce.D,xo))}}q.G=3,q.l&&q.l.ua(),q.ba&&(q.R=Date.now()-v.F,q.j.info("Handshake RTT: "+q.R+"ms")),ce=q;var wt=v;if(ce.qa=N(ce,ce.J?ce.ia:null,ce.W),wt.K){Li(ce.h,wt);var rr=wt,Pr=ce.L;Pr&&(rr.I=Pr),rr.B&&(kr(rr),Rt(rr)),ce.g=wt}else Rl(ce);0<q.i.length&&Il(q)}else mr[0]!="stop"&&mr[0]!="close"||aa(q,7);else q.G==3&&(mr[0]=="stop"||mr[0]=="close"?mr[0]=="stop"?aa(q,7):Us(q):mr[0]!="noop"&&q.l&&q.l.ta(mr),q.v=0)}}pi(4)}catch{}}var ds=class{constructor(v,P){this.g=v,this.map=P}};function Ri(v){this.l=v||10,c.PerformanceNavigationTiming?(v=c.performance.getEntriesByType("navigation"),v=0<v.length&&(v[0].nextHopProtocol=="hq"||v[0].nextHopProtocol=="h2")):v=!!(c.chrome&&c.chrome.loadTimes&&c.chrome.loadTimes()&&c.chrome.loadTimes().wasFetchedViaSpdy),this.j=v?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function ta(v){return v.h?!0:v.g?v.g.size>=v.j:!1}function va(v){return v.h?1:v.g?v.g.size:0}function Gi(v,P){return v.h?v.h==P:v.g?v.g.has(P):!1}function An(v,P){v.g?v.g.add(P):v.h=P}function Li(v,P){v.h&&v.h==P?v.h=null:v.g&&v.g.has(P)&&v.g.delete(P)}Ri.prototype.cancel=function(){if(this.i=Tl(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const v of this.g.values())v.cancel();this.g.clear()}};function Tl(v){if(v.h!=null)return v.i.concat(v.h.D);if(v.g!=null&&v.g.size!==0){let P=v.i;for(const q of v.g.values())P=P.concat(q.D);return P}return E(v.i)}function pu(v){if(v.V&&typeof v.V=="function")return v.V();if(typeof Map<"u"&&v instanceof Map||typeof Set<"u"&&v instanceof Set)return Array.from(v.values());if(typeof v=="string")return v.split("");if(u(v)){for(var P=[],q=v.length,ce=0;ce<q;ce++)P.push(v[ce]);return P}P=[],q=0;for(ce in v)P[q++]=v[ce];return P}function oo(v){if(v.na&&typeof v.na=="function")return v.na();if(!v.V||typeof v.V!="function"){if(typeof Map<"u"&&v instanceof Map)return Array.from(v.keys());if(!(typeof Set<"u"&&v instanceof Set)){if(u(v)||typeof v=="string"){var P=[];v=v.length;for(var q=0;q<v;q++)P.push(q);return P}P=[],q=0;for(const ce in v)P[q++]=ce;return P}}}function yc(v,P){if(v.forEach&&typeof v.forEach=="function")v.forEach(P,void 0);else if(u(v)||typeof v=="string")Array.prototype.forEach.call(v,P,void 0);else for(var q=oo(v),ce=pu(v),Fe=ce.length,We=0;We<Fe;We++)P.call(void 0,ce[We],q&&q[We],v)}var Wi=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function kl(v,P){if(v){v=v.split("&");for(var q=0;q<v.length;q++){var ce=v[q].indexOf("="),Fe=null;if(0<=ce){var We=v[q].substring(0,ce);Fe=v[q].substring(ce+1)}else We=v[q];P(We,Fe?decodeURIComponent(Fe.replace(/\+/g," ")):"")}}}function Gr(v){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,v instanceof Gr){this.h=v.h,lo(this,v.j),this.o=v.o,this.g=v.g,co(this,v.s),this.l=v.l;var P=v.i,q=new ms;q.i=P.i,P.g&&(q.g=new Map(P.g),q.h=P.h),ps(this,q),this.m=v.m}else v&&(P=String(v).match(Wi))?(this.h=!1,lo(this,P[1]||"",!0),this.o=La(P[2]||""),this.g=La(P[3]||"",!0),co(this,P[4]),this.l=La(P[5]||"",!0),ps(this,P[6]||"",!0),this.m=La(P[7]||"")):(this.h=!1,this.i=new ms(null,this.h))}Gr.prototype.toString=function(){var v=[],P=this.j;P&&v.push(Os(P,wc,!0),":");var q=this.g;return(q||P=="file")&&(v.push("//"),(P=this.o)&&v.push(Os(P,wc,!0),"@"),v.push(encodeURIComponent(String(q)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),q=this.s,q!=null&&v.push(":",String(q))),(q=this.l)&&(this.g&&q.charAt(0)!="/"&&v.push("/"),v.push(Os(q,q.charAt(0)=="/"?Ps:Ec,!0))),(q=this.i.toString())&&v.push("?",q),(q=this.m)&&v.push("#",Os(q,Ms)),v.join("")};function Xi(v){return new Gr(v)}function lo(v,P,q){v.j=q?La(P,!0):P,v.j&&(v.j=v.j.replace(/:$/,""))}function co(v,P){if(P){if(P=Number(P),isNaN(P)||0>P)throw Error("Bad port number "+P);v.s=P}else v.s=null}function ps(v,P,q){P instanceof ms?(v.i=P,gu(v.i,v.h)):(q||(P=Os(P,Nl)),v.i=new ms(P,v.h))}function nn(v,P,q){v.i.set(P,q)}function uo(v){return nn(v,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),v}function La(v,P){return v?P?decodeURI(v.replace(/%25/g,"%2525")):decodeURIComponent(v):""}function Os(v,P,q){return typeof v=="string"?(v=encodeURI(v).replace(P,mu),q&&(v=v.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),v):null}function mu(v){return v=v.charCodeAt(0),"%"+(v>>4&15).toString(16)+(v&15).toString(16)}var wc=/[#\/\?@]/g,Ec=/[#\?:]/g,Ps=/[#\?]/g,Nl=/[#\?@]/g,Ms=/#/g;function ms(v,P){this.h=this.g=null,this.i=v||null,this.j=!!P}function vn(v){v.g||(v.g=new Map,v.h=0,v.i&&kl(v.i,function(P,q){v.add(decodeURIComponent(P.replace(/\+/g," ")),q)}))}t=ms.prototype,t.add=function(v,P){vn(this),this.i=null,v=vs(this,v);var q=this.g.get(v);return q||this.g.set(v,q=[]),q.push(P),this.h+=1,this};function Bs(v,P){vn(v),P=vs(v,P),v.g.has(P)&&(v.i=null,v.h-=v.g.get(P).length,v.g.delete(P))}function gs(v,P){return vn(v),P=vs(v,P),v.g.has(P)}t.forEach=function(v,P){vn(this),this.g.forEach(function(q,ce){q.forEach(function(Fe){v.call(P,Fe,ce,this)},this)},this)},t.na=function(){vn(this);const v=Array.from(this.g.values()),P=Array.from(this.g.keys()),q=[];for(let ce=0;ce<P.length;ce++){const Fe=v[ce];for(let We=0;We<Fe.length;We++)q.push(P[ce])}return q},t.V=function(v){vn(this);let P=[];if(typeof v=="string")gs(this,v)&&(P=P.concat(this.g.get(vs(this,v))));else{v=Array.from(this.g.values());for(let q=0;q<v.length;q++)P=P.concat(v[q])}return P},t.set=function(v,P){return vn(this),this.i=null,v=vs(this,v),gs(this,v)&&(this.h-=this.g.get(v).length),this.g.set(v,[P]),this.h+=1,this},t.get=function(v,P){return v?(v=this.V(v),0<v.length?String(v[0]):P):P};function tr(v,P,q){Bs(v,P),0<q.length&&(v.i=null,v.g.set(vs(v,P),E(q)),v.h+=q.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const v=[],P=Array.from(this.g.keys());for(var q=0;q<P.length;q++){var ce=P[q];const We=encodeURIComponent(String(ce)),wt=this.V(ce);for(ce=0;ce<wt.length;ce++){var Fe=We;wt[ce]!==""&&(Fe+="="+encodeURIComponent(String(wt[ce]))),v.push(Fe)}}return this.i=v.join("&")};function vs(v,P){return P=String(P),v.j&&(P=P.toLowerCase()),P}function gu(v,P){P&&!v.j&&(vn(v),v.i=null,v.g.forEach(function(q,ce){var Fe=ce.toLowerCase();ce!=Fe&&(Bs(this,ce),tr(this,Fe,q))},v)),v.j=P}function ra(v,P){const q=new gn;if(c.Image){const ce=new Image;ce.onload=_(_a,q,"TestLoadImage: loaded",!0,P,ce),ce.onerror=_(_a,q,"TestLoadImage: error",!1,P,ce),ce.onabort=_(_a,q,"TestLoadImage: abort",!1,P,ce),ce.ontimeout=_(_a,q,"TestLoadImage: timeout",!1,P,ce),c.setTimeout(function(){ce.ontimeout&&ce.ontimeout()},1e4),ce.src=v}else P(!1)}function Da(v,P){const q=new gn,ce=new AbortController,Fe=setTimeout(()=>{ce.abort(),_a(q,"TestPingServer: timeout",!1,P)},1e4);fetch(v,{signal:ce.signal}).then(We=>{clearTimeout(Fe),We.ok?_a(q,"TestPingServer: ok",!0,P):_a(q,"TestPingServer: server error",!1,P)}).catch(()=>{clearTimeout(Fe),_a(q,"TestPingServer: error",!1,P)})}function _a(v,P,q,ce,Fe){try{Fe&&(Fe.onload=null,Fe.onerror=null,Fe.onabort=null,Fe.ontimeout=null),ce(q)}catch{}}function _s(){this.g=new Ii}function Fa(v,P,q){const ce=q||"";try{yc(v,function(Fe,We){let wt=Fe;h(Fe)&&(wt=yr(Fe)),P.push(ce+We+"="+encodeURIComponent(wt))})}catch(Fe){throw P.push(ce+"type="+encodeURIComponent("_badmap")),Fe}}function fo(v){this.l=v.Ub||null,this.j=v.eb||!1}b(fo,Tr),fo.prototype.g=function(){return new js(this.l,this.j)},fo.prototype.i=function(v){return function(){return v}}({});function js(v,P){Tt.call(this),this.D=v,this.o=P,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}b(js,Tt),t=js.prototype,t.open=function(v,P){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=v,this.A=P,this.readyState=1,na(this)},t.send=function(v){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const P={headers:this.u,method:this.B,credentials:this.m,cache:void 0};v&&(P.body=v),(this.D||c).fetch(new Request(this.A,P)).then(this.Sa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Oa(this)),this.readyState=0},t.Sa=function(v){if(this.g&&(this.l=v,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=v.headers,this.readyState=2,na(this)),this.g&&(this.readyState=3,na(this),this.g)))if(this.responseType==="arraybuffer")v.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof c.ReadableStream<"u"&&"body"in v){if(this.j=v.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;bc(this)}else v.text().then(this.Ra.bind(this),this.ga.bind(this))};function bc(v){v.j.read().then(v.Pa.bind(v)).catch(v.ga.bind(v))}t.Pa=function(v){if(this.g){if(this.o&&v.value)this.response.push(v.value);else if(!this.o){var P=v.value?v.value:new Uint8Array(0);(P=this.v.decode(P,{stream:!v.done}))&&(this.response=this.responseText+=P)}v.done?Oa(this):na(this),this.readyState==3&&bc(this)}},t.Ra=function(v){this.g&&(this.response=this.responseText=v,Oa(this))},t.Qa=function(v){this.g&&(this.response=v,Oa(this))},t.ga=function(){this.g&&Oa(this)};function Oa(v){v.readyState=4,v.l=null,v.j=null,v.v=null,na(v)}t.setRequestHeader=function(v,P){this.u.append(v,P)},t.getResponseHeader=function(v){return this.h&&this.h.get(v.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const v=[],P=this.h.entries();for(var q=P.next();!q.done;)q=q.value,v.push(q[0]+": "+q[1]),q=P.next();return v.join(`\r
`)};function na(v){v.onreadystatechange&&v.onreadystatechange.call(v)}Object.defineProperty(js.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(v){this.m=v?"include":"same-origin"}});function xs(v){let P="";return he(v,function(q,ce){P+=ce,P+=":",P+=q,P+=`\r
`}),P}function ni(v,P,q){e:{for(ce in q){var ce=!1;break e}ce=!0}ce||(q=xs(q),typeof v=="string"?q!=null&&encodeURIComponent(String(q)):nn(v,P,q))}function Or(v){Tt.call(this),this.headers=new Map,this.o=v||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}b(Or,Tt);var ho=/^https?$/i,ys=["POST","PUT"];t=Or.prototype,t.Ha=function(v){this.J=v},t.ea=function(v,P,q,ce){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+v);P=P?P.toUpperCase():"GET",this.D=v,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():Se.g(),this.v=this.o?Ra(this.o):Ra(Se),this.g.onreadystatechange=x(this.Ea,this);try{this.B=!0,this.g.open(P,String(v),!0),this.B=!1}catch(We){Sc(this,We);return}if(v=q||"",q=new Map(this.headers),ce)if(Object.getPrototypeOf(ce)===Object.prototype)for(var Fe in ce)q.set(Fe,ce[Fe]);else if(typeof ce.keys=="function"&&typeof ce.get=="function")for(const We of ce.keys())q.set(We,ce.get(We));else throw Error("Unknown input type for opt_headers: "+String(ce));ce=Array.from(q.keys()).find(We=>We.toLowerCase()=="content-type"),Fe=c.FormData&&v instanceof c.FormData,!(0<=Array.prototype.indexOf.call(ys,P,void 0))||ce||Fe||q.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[We,wt]of q)this.g.setRequestHeader(We,wt);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{ia(this),this.u=!0,this.g.send(v),this.u=!1}catch(We){Sc(this,We)}};function Sc(v,P){v.h=!1,v.g&&(v.j=!0,v.g.abort(),v.j=!1),v.l=P,v.m=5,zo(v),ss(v)}function zo(v){v.A||(v.A=!0,kt(v,"complete"),kt(v,"error"))}t.abort=function(v){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=v||7,kt(this,"complete"),kt(this,"abort"),ss(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),ss(this,!0)),Or.aa.N.call(this)},t.Ea=function(){this.s||(this.B||this.u||this.j?Ho(this):this.bb())},t.bb=function(){Ho(this)};function Ho(v){if(v.h&&typeof o<"u"&&(!v.v[1]||ii(v)!=4||v.Z()!=2)){if(v.u&&ii(v)==4)Pt(v.Ea,0,v);else if(kt(v,"readystatechange"),ii(v)==4){v.h=!1;try{const wt=v.Z();e:switch(wt){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var P=!0;break e;default:P=!1}var q;if(!(q=P)){var ce;if(ce=wt===0){var Fe=String(v.D).match(Wi)[1]||null;!Fe&&c.self&&c.self.location&&(Fe=c.self.location.protocol.slice(0,-1)),ce=!ho.test(Fe?Fe.toLowerCase():"")}q=ce}if(q)kt(v,"complete"),kt(v,"success");else{v.m=6;try{var We=2<ii(v)?v.g.statusText:""}catch{We=""}v.l=We+" ["+v.Z()+"]",zo(v)}}finally{ss(v)}}}}function ss(v,P){if(v.g){ia(v);const q=v.g,ce=v.v[0]?()=>{}:null;v.g=null,v.v=null,P||kt(v,"ready");try{q.onreadystatechange=ce}catch{}}}function ia(v){v.I&&(c.clearTimeout(v.I),v.I=null)}t.isActive=function(){return!!this.g};function ii(v){return v.g?v.g.readyState:0}t.Z=function(){try{return 2<ii(this)?this.g.status:-1}catch{return-1}},t.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.Oa=function(v){if(this.g){var P=this.g.responseText;return v&&P.indexOf(v)==0&&(P=P.substring(v.length)),Qr(P)}};function vu(v){try{if(!v.g)return null;if("response"in v.g)return v.g.response;switch(v.H){case"":case"text":return v.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in v.g)return v.g.mozResponseArrayBuffer}return null}catch{return null}}function po(v){const P={};v=(v.g&&2<=ii(v)&&v.g.getAllResponseHeaders()||"").split(`\r
`);for(let ce=0;ce<v.length;ce++){if(M(v[ce]))continue;var q=I(v[ce]);const Fe=q[0];if(q=q[1],typeof q!="string")continue;q=q.trim();const We=P[Fe]||[];P[Fe]=We,We.push(q)}F(P,function(ce){return ce.join(", ")})}t.Ba=function(){return this.m},t.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function Yi(v,P,q){return q&&q.internalChannelParams&&q.internalChannelParams[v]||P}function mo(v){this.Aa=0,this.i=[],this.j=new gn,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=Yi("failFast",!1,v),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=Yi("baseRetryDelayMs",5e3,v),this.cb=Yi("retryDelaySeedMs",1e4,v),this.Wa=Yi("forwardChannelMaxRetries",2,v),this.wa=Yi("forwardChannelRequestTimeoutMs",2e4,v),this.pa=v&&v.xmlHttpFactory||void 0,this.Xa=v&&v.Tb||void 0,this.Ca=v&&v.useFetchStreams||!1,this.L=void 0,this.J=v&&v.supportsCrossDomainXhr||!1,this.K="",this.h=new Ri(v&&v.concurrentRequestLimit),this.Da=new _s,this.P=v&&v.fastHandshake||!1,this.O=v&&v.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=v&&v.Rb||!1,v&&v.xa&&this.j.xa(),v&&v.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&v&&v.detectBufferingProxy||!1,this.ja=void 0,v&&v.longPollingTimeout&&0<v.longPollingTimeout&&(this.ja=v.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}t=mo.prototype,t.la=8,t.G=1,t.connect=function(v,P,q,ce){jt(0),this.W=v,this.H=P||{},q&&ce!==void 0&&(this.H.OSID=q,this.H.OAID=ce),this.F=this.X,this.I=N(this,null,this.W),Il(this)};function Us(v){if(Go(v),v.G==3){var P=v.U++,q=Xi(v.I);if(nn(q,"SID",v.K),nn(q,"RID",P),nn(q,"TYPE","terminate"),go(v,q),P=new $e(v,v.j,P),P.L=2,P.v=uo(Xi(q)),q=!1,c.navigator&&c.navigator.sendBeacon)try{q=c.navigator.sendBeacon(P.v.toString(),"")}catch{}!q&&c.Image&&(new Image().src=P.v,q=!0),q||(P.g=K(P.j,null),P.g.ea(P.v)),P.F=Date.now(),Rt(P)}Ll(v)}function Cl(v){v.g&&(vo(v),v.g.cancel(),v.g=null)}function Go(v){Cl(v),v.u&&(c.clearTimeout(v.u),v.u=null),Vs(v),v.h.cancel(),v.s&&(typeof v.s=="number"&&c.clearTimeout(v.s),v.s=null)}function Il(v){if(!ta(v.h)&&!v.s){v.s=!0;var P=v.Ga;de||X(),oe||(de(),oe=!0),Z.add(P,v),v.B=0}}function Ac(v,P){return va(v.h)>=v.h.j-(v.s?1:0)?!1:v.s?(v.i=P.D.concat(v.i),!0):v.G==1||v.G==2||v.B>=(v.Va?0:v.Wa)?!1:(v.s=Hr(x(v.Ga,v,P),Ko(v,v.B)),v.B++,!0)}t.Ga=function(v){if(this.s)if(this.s=null,this.G==1){if(!v){this.U=Math.floor(1e5*Math.random()),v=this.U++;const Fe=new $e(this,this.j,v);let We=this.o;if(this.S&&(We?(We=k(We),U(We,this.S)):We=this.S),this.m!==null||this.O||(Fe.H=We,We=null),this.P)e:{for(var P=0,q=0;q<this.i.length;q++){t:{var ce=this.i[q];if("__data__"in ce.map&&(ce=ce.map.__data__,typeof ce=="string")){ce=ce.length;break t}ce=void 0}if(ce===void 0)break;if(P+=ce,4096<P){P=q;break e}if(P===4096||q===this.i.length-1){P=q+1;break e}}P=1e3}else P=1e3;P=Xo(this,Fe,P),q=Xi(this.I),nn(q,"RID",v),nn(q,"CVER",22),this.D&&nn(q,"X-HTTP-Session-Id",this.D),go(this,q),We&&(this.O?P="headers="+encodeURIComponent(String(xs(We)))+"&"+P:this.m&&ni(q,this.m,We)),An(this.h,Fe),this.Ua&&nn(q,"TYPE","init"),this.P?(nn(q,"$req",P),nn(q,"SID","null"),Fe.T=!0,pt(Fe,q,null)):pt(Fe,q,P),this.G=2}}else this.G==3&&(v?Wo(this,v):this.i.length==0||ta(this.h)||Wo(this))};function Wo(v,P){var q;P?q=P.l:q=v.U++;const ce=Xi(v.I);nn(ce,"SID",v.K),nn(ce,"RID",q),nn(ce,"AID",v.T),go(v,ce),v.m&&v.o&&ni(ce,v.m,v.o),q=new $e(v,v.j,q,v.B+1),v.m===null&&(q.H=v.o),P&&(v.i=P.D.concat(v.i)),P=Xo(v,q,1e3),q.I=Math.round(.5*v.wa)+Math.round(.5*v.wa*Math.random()),An(v.h,q),pt(q,ce,P)}function go(v,P){v.H&&he(v.H,function(q,ce){nn(P,ce,q)}),v.l&&yc({},function(q,ce){nn(P,ce,q)})}function Xo(v,P,q){q=Math.min(v.i.length,q);var ce=v.l?x(v.l.Na,v.l,v):null;e:{var Fe=v.i;let We=-1;for(;;){const wt=["count="+q];We==-1?0<q?(We=Fe[0].g,wt.push("ofs="+We)):We=0:wt.push("ofs="+We);let rr=!0;for(let Pr=0;Pr<q;Pr++){let mr=Fe[Pr].g;const an=Fe[Pr].map;if(mr-=We,0>mr)We=Math.max(0,Fe[Pr].g-100),rr=!1;else try{Fa(an,wt,"req"+mr+"_")}catch{ce&&ce(an)}}if(rr){ce=wt.join("&");break e}}}return v=v.i.splice(0,q),P.D=v,ce}function Rl(v){if(!v.g&&!v.u){v.Y=1;var P=v.Fa;de||X(),oe||(de(),oe=!0),Z.add(P,v),v.v=0}}function Yo(v){return v.g||v.u||3<=v.v?!1:(v.Y++,v.u=Hr(x(v.Fa,v),Ko(v,v.v)),v.v++,!0)}t.Fa=function(){if(this.u=null,_u(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var v=2*this.R;this.j.info("BP detection timer enabled: "+v),this.A=Hr(x(this.ab,this),v)}},t.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,jt(10),Cl(this),_u(this))};function vo(v){v.A!=null&&(c.clearTimeout(v.A),v.A=null)}function _u(v){v.g=new $e(v,v.j,"rpc",v.Y),v.m===null&&(v.g.H=v.o),v.g.O=0;var P=Xi(v.qa);nn(P,"RID","rpc"),nn(P,"SID",v.K),nn(P,"AID",v.T),nn(P,"CI",v.F?"0":"1"),!v.F&&v.ja&&nn(P,"TO",v.ja),nn(P,"TYPE","xmlhttp"),go(v,P),v.m&&v.o&&ni(P,v.m,v.o),v.L&&(v.g.I=v.L);var q=v.g;v=v.ia,q.L=1,q.v=uo(Xi(P)),q.m=null,q.P=!0,At(q,v)}t.Za=function(){this.C!=null&&(this.C=null,Cl(this),Yo(this),jt(19))};function Vs(v){v.C!=null&&(c.clearTimeout(v.C),v.C=null)}function _o(v,P){var q=null;if(v.g==P){Vs(v),vo(v),v.g=null;var ce=2}else if(Gi(v.h,P))q=P.D,Li(v.h,P),ce=1;else return;if(v.G!=0){if(P.o)if(ce==1){q=P.m?P.m.length:0,P=Date.now()-P.F;var Fe=v.B;ce=ea(),kt(ce,new Zr(ce,q)),Il(v)}else Rl(v);else if(Fe=P.s,Fe==3||Fe==0&&0<P.X||!(ce==1&&Ac(v,P)||ce==2&&Yo(v)))switch(q&&0<q.length&&(P=v.h,P.i=P.i.concat(q)),Fe){case 1:aa(v,5);break;case 4:aa(v,10);break;case 3:aa(v,6);break;default:aa(v,2)}}}function Ko(v,P){let q=v.Ta+Math.floor(Math.random()*v.cb);return v.isActive()||(q*=2),q*P}function aa(v,P){if(v.j.info("Error code "+P),P==2){var q=x(v.fb,v),ce=v.Xa;const Fe=!ce;ce=new Gr(ce||"//www.google.com/images/cleardot.gif"),c.location&&c.location.protocol=="http"||lo(ce,"https"),uo(ce),Fe?ra(ce.toString(),q):Da(ce.toString(),q)}else jt(2);v.G=0,v.l&&v.l.sa(P),Ll(v),Go(v)}t.fb=function(v){v?(this.j.info("Successfully pinged google.com"),jt(2)):(this.j.info("Failed to ping google.com"),jt(1))};function Ll(v){if(v.G=0,v.ka=[],v.l){const P=Tl(v.h);(P.length!=0||v.i.length!=0)&&(A(v.ka,P),A(v.ka,v.i),v.h.i.length=0,E(v.i),v.i.length=0),v.l.ra()}}function N(v,P,q){var ce=q instanceof Gr?Xi(q):new Gr(q);if(ce.g!="")P&&(ce.g=P+"."+ce.g),co(ce,ce.s);else{var Fe=c.location;ce=Fe.protocol,P=P?P+"."+Fe.hostname:Fe.hostname,Fe=+Fe.port;var We=new Gr(null);ce&&lo(We,ce),P&&(We.g=P),Fe&&co(We,Fe),q&&(We.l=q),ce=We}return q=v.D,P=v.ya,q&&P&&nn(ce,q,P),nn(ce,"VER",v.la),go(v,ce),ce}function K(v,P,q){if(P&&!v.J)throw Error("Can't create secondary domain capable XhrIo object.");return P=v.Ca&&!v.pa?new Or(new fo({eb:q})):new Or(v.pa),P.Ha(v.J),P}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function Te(){}t=Te.prototype,t.ua=function(){},t.ta=function(){},t.sa=function(){},t.ra=function(){},t.isActive=function(){return!0},t.Na=function(){};function Ne(){}Ne.prototype.g=function(v,P){return new Be(v,P)};function Be(v,P){Tt.call(this),this.g=new mo(P),this.l=v,this.h=P&&P.messageUrlParams||null,v=P&&P.messageHeaders||null,P&&P.clientProtocolHeaderRequired&&(v?v["X-Client-Protocol"]="webchannel":v={"X-Client-Protocol":"webchannel"}),this.g.o=v,v=P&&P.initMessageHeaders||null,P&&P.messageContentType&&(v?v["X-WebChannel-Content-Type"]=P.messageContentType:v={"X-WebChannel-Content-Type":P.messageContentType}),P&&P.va&&(v?v["X-WebChannel-Client-Profile"]=P.va:v={"X-WebChannel-Client-Profile":P.va}),this.g.S=v,(v=P&&P.Sb)&&!M(v)&&(this.g.m=v),this.v=P&&P.supportsCrossDomainXhr||!1,this.u=P&&P.sendRawJson||!1,(P=P&&P.httpSessionIdParam)&&!M(P)&&(this.g.D=P,v=this.h,v!==null&&P in v&&(v=this.h,P in v&&delete v[P])),this.j=new Ft(this)}b(Be,Tt),Be.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},Be.prototype.close=function(){Us(this.g)},Be.prototype.o=function(v){var P=this.g;if(typeof v=="string"){var q={};q.__data__=v,v=q}else this.u&&(q={},q.__data__=yr(v),v=q);P.i.push(new ds(P.Ya++,v)),P.G==3&&Il(P)},Be.prototype.N=function(){this.g.l=null,delete this.j,Us(this.g),delete this.g,Be.aa.N.call(this)};function tt(v){di.call(this),v.__headers__&&(this.headers=v.__headers__,this.statusCode=v.__status__,delete v.__headers__,delete v.__status__);var P=v.__sm__;if(P){e:{for(const q in P){v=q;break e}v=void 0}(this.i=v)&&(v=this.i,P=P!==null&&v in P?P[v]:void 0),this.data=P}else this.data=v}b(tt,di);function yt(){Jr.call(this),this.status=1}b(yt,Jr);function Ft(v){this.g=v}b(Ft,Te),Ft.prototype.ua=function(){kt(this.g,"a")},Ft.prototype.ta=function(v){kt(this.g,new tt(v))},Ft.prototype.sa=function(v){kt(this.g,new yt)},Ft.prototype.ra=function(){kt(this.g,"b")},Ne.prototype.createWebChannel=Ne.prototype.g,Be.prototype.send=Be.prototype.o,Be.prototype.open=Be.prototype.m,Be.prototype.close=Be.prototype.close,qS=function(){return new Ne},VS=function(){return ea()},US=Kt,R_={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},ve.NO_ERROR=0,ve.TIMEOUT=8,ve.HTTP_ERROR=6,Hm=ve,we.COMPLETE="complete",jS=we,hn.EventType=Yn,Yn.OPEN="a",Yn.CLOSE="b",Yn.ERROR="c",Yn.MESSAGE="d",Tt.prototype.listen=Tt.prototype.K,i1=hn,Or.prototype.listenOnce=Or.prototype.L,Or.prototype.getLastError=Or.prototype.Ka,Or.prototype.getLastErrorCode=Or.prototype.Ba,Or.prototype.getStatus=Or.prototype.Z,Or.prototype.getResponseJson=Or.prototype.Oa,Or.prototype.getResponseText=Or.prototype.oa,Or.prototype.send=Or.prototype.ea,Or.prototype.setWithCredentials=Or.prototype.Ha,BS=Or}).apply(typeof xm<"u"?xm:typeof self<"u"?self:typeof window<"u"?window:{});const tE="@firebase/firestore",rE="4.8.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ka{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Ka.UNAUTHENTICATED=new Ka(null),Ka.GOOGLE_CREDENTIALS=new Ka("google-credentials-uid"),Ka.FIRST_PARTY=new Ka("first-party-uid"),Ka.MOCK_USER=new Ka("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let id="11.10.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Eh=new kx("@firebase/firestore");function E0(){return Eh.logLevel}function Ht(t,...e){if(Eh.logLevel<=Vr.DEBUG){const r=e.map(jx);Eh.debug(`Firestore (${id}): ${t}`,...r)}}function ou(t,...e){if(Eh.logLevel<=Vr.ERROR){const r=e.map(jx);Eh.error(`Firestore (${id}): ${t}`,...r)}}function pf(t,...e){if(Eh.logLevel<=Vr.WARN){const r=e.map(jx);Eh.warn(`Firestore (${id}): ${t}`,...r)}}function jx(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(r){return JSON.stringify(r)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hr(t,e,r){let n="Unexpected state";typeof e=="string"?n=e:r=e,zS(t,n,r)}function zS(t,e,r){let n=`FIRESTORE (${id}) INTERNAL ASSERTION FAILED: ${e} (ID: ${t.toString(16)})`;if(r!==void 0)try{n+=" CONTEXT: "+JSON.stringify(r)}catch{n+=" CONTEXT: "+r}throw ou(n),new Error(n)}function mn(t,e,r,n){let i="Unexpected state";typeof r=="string"?i=r:n=r,t||zS(e,i,n)}function xr(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dt={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Vt extends uu{constructor(e,r){super(e,r),this.code=e,this.message=r,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tu{constructor(){this.promise=new Promise((e,r)=>{this.resolve=e,this.reject=r})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HS{constructor(e,r){this.user=r,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class fL{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,r){e.enqueueRetryable(()=>r(Ka.UNAUTHENTICATED))}shutdown(){}}class hL{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,r){this.changeListener=r,e.enqueueRetryable(()=>r(this.token.user))}shutdown(){this.changeListener=null}}class dL{constructor(e){this.t=e,this.currentUser=Ka.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,r){mn(this.o===void 0,42304);let n=this.i;const i=u=>this.i!==n?(n=this.i,r(u)):Promise.resolve();let a=new tu;this.o=()=>{this.i++,this.currentUser=this.u(),a.resolve(),a=new tu,e.enqueueRetryable(()=>i(this.currentUser))};const o=()=>{const u=a;e.enqueueRetryable(async()=>{await u.promise,await i(this.currentUser)})},c=u=>{Ht("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=u,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit(u=>c(u)),setTimeout(()=>{if(!this.auth){const u=this.t.getImmediate({optional:!0});u?c(u):(Ht("FirebaseAuthCredentialsProvider","Auth not yet detected"),a.resolve(),a=new tu)}},0),o()}getToken(){const e=this.i,r=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(r).then(n=>this.i!==e?(Ht("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):n?(mn(typeof n.accessToken=="string",31837,{l:n}),new HS(n.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return mn(e===null||typeof e=="string",2055,{h:e}),new Ka(e)}}class pL{constructor(e,r,n){this.P=e,this.T=r,this.I=n,this.type="FirstParty",this.user=Ka.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class mL{constructor(e,r,n){this.P=e,this.T=r,this.I=n}getToken(){return Promise.resolve(new pL(this.P,this.T,this.I))}start(e,r){e.enqueueRetryable(()=>r(Ka.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class nE{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class gL{constructor(e,r){this.V=r,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,Mo(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,r){mn(this.o===void 0,3512);const n=a=>{a.error!=null&&Ht("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${a.error.message}`);const o=a.token!==this.m;return this.m=a.token,Ht("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?r(a.token):Promise.resolve()};this.o=a=>{e.enqueueRetryable(()=>n(a))};const i=a=>{Ht("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=a,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(a=>i(a)),setTimeout(()=>{if(!this.appCheck){const a=this.V.getImmediate({optional:!0});a?i(a):Ht("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new nE(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(r=>r?(mn(typeof r.token=="string",44558,{tokenResult:r}),this.m=r.token,new nE(r.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vL(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),r=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(r);else for(let n=0;n<t;n++)r[n]=Math.floor(256*Math.random());return r}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function GS(){return new TextEncoder}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ux{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",r=62*Math.floor(4.129032258064516);let n="";for(;n.length<20;){const i=vL(40);for(let a=0;a<i.length;++a)n.length<20&&i[a]<r&&(n+=e.charAt(i[a]%62))}return n}}function Rr(t,e){return t<e?-1:t>e?1:0}function L_(t,e){let r=0;for(;r<t.length&&r<e.length;){const n=t.codePointAt(r),i=e.codePointAt(r);if(n!==i){if(n<128&&i<128)return Rr(n,i);{const a=GS(),o=_L(a.encode(iE(t,r)),a.encode(iE(e,r)));return o!==0?o:Rr(n,i)}}r+=n>65535?2:1}return Rr(t.length,e.length)}function iE(t,e){return t.codePointAt(e)>65535?t.substring(e,e+2):t.substring(e,e+1)}function _L(t,e){for(let r=0;r<t.length&&r<e.length;++r)if(t[r]!==e[r])return Rr(t[r],e[r]);return Rr(t.length,e.length)}function W0(t,e,r){return t.length===e.length&&t.every((n,i)=>r(n,e[i]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aE="__name__";class sc{constructor(e,r,n){r===void 0?r=0:r>e.length&&hr(637,{offset:r,range:e.length}),n===void 0?n=e.length-r:n>e.length-r&&hr(1746,{length:n,range:e.length-r}),this.segments=e,this.offset=r,this.len=n}get length(){return this.len}isEqual(e){return sc.comparator(this,e)===0}child(e){const r=this.segments.slice(this.offset,this.limit());return e instanceof sc?e.forEach(n=>{r.push(n)}):r.push(e),this.construct(r)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==e.get(r))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==e.get(r))return!1;return!0}forEach(e){for(let r=this.offset,n=this.limit();r<n;r++)e(this.segments[r])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,r){const n=Math.min(e.length,r.length);for(let i=0;i<n;i++){const a=sc.compareSegments(e.get(i),r.get(i));if(a!==0)return a}return Rr(e.length,r.length)}static compareSegments(e,r){const n=sc.isNumericId(e),i=sc.isNumericId(r);return n&&!i?-1:!n&&i?1:n&&i?sc.extractNumericId(e).compare(sc.extractNumericId(r)):L_(e,r)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return hf.fromString(e.substring(4,e.length-2))}}class Mn extends sc{construct(e,r,n){return new Mn(e,r,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const r=[];for(const n of e){if(n.indexOf("//")>=0)throw new Vt(dt.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);r.push(...n.split("/").filter(i=>i.length>0))}return new Mn(r)}static emptyPath(){return new Mn([])}}const xL=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Na extends sc{construct(e,r,n){return new Na(e,r,n)}static isValidIdentifier(e){return xL.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Na.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===aE}static keyField(){return new Na([aE])}static fromServerFormat(e){const r=[];let n="",i=0;const a=()=>{if(n.length===0)throw new Vt(dt.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);r.push(n),n=""};let o=!1;for(;i<e.length;){const c=e[i];if(c==="\\"){if(i+1===e.length)throw new Vt(dt.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const u=e[i+1];if(u!=="\\"&&u!=="."&&u!=="`")throw new Vt(dt.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=u,i+=2}else c==="`"?(o=!o,i++):c!=="."||o?(n+=c,i++):(a(),i++)}if(a(),o)throw new Vt(dt.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Na(r)}static emptyPath(){return new Na([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jt{constructor(e){this.path=e}static fromPath(e){return new Jt(Mn.fromString(e))}static fromName(e){return new Jt(Mn.fromString(e).popFirst(5))}static empty(){return new Jt(Mn.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Mn.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,r){return Mn.comparator(e.path,r.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Jt(new Mn(e.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function WS(t,e,r){if(!r)throw new Vt(dt.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function yL(t,e,r,n){if(e===!0&&n===!0)throw new Vt(dt.INVALID_ARGUMENT,`${t} and ${r} cannot be used together.`)}function sE(t){if(!Jt.isDocumentKey(t))throw new Vt(dt.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function oE(t){if(Jt.isDocumentKey(t))throw new Vt(dt.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function XS(t){return typeof t=="object"&&t!==null&&(Object.getPrototypeOf(t)===Object.prototype||Object.getPrototypeOf(t)===null)}function Xg(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(n){return n.constructor?n.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":hr(12329,{type:typeof t})}function El(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new Vt(dt.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const r=Xg(t);throw new Vt(dt.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${r}`)}}return t}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zi(t,e){const r={typeString:t};return e&&(r.value=e),r}function ap(t,e){if(!XS(t))throw new Vt(dt.INVALID_ARGUMENT,"JSON must be an object");let r;for(const n in e)if(e[n]){const i=e[n].typeString,a="value"in e[n]?{value:e[n].value}:void 0;if(!(n in t)){r=`JSON missing required field: '${n}'`;break}const o=t[n];if(i&&typeof o!==i){r=`JSON field '${n}' must be a ${i}.`;break}if(a!==void 0&&o!==a.value){r=`Expected '${n}' field to equal '${a.value}'`;break}}if(r)throw new Vt(dt.INVALID_ARGUMENT,r);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lE=-62135596800,cE=1e6;class Un{static now(){return Un.fromMillis(Date.now())}static fromDate(e){return Un.fromMillis(e.getTime())}static fromMillis(e){const r=Math.floor(e/1e3),n=Math.floor((e-1e3*r)*cE);return new Un(r,n)}constructor(e,r){if(this.seconds=e,this.nanoseconds=r,r<0)throw new Vt(dt.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(r>=1e9)throw new Vt(dt.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(e<lE)throw new Vt(dt.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Vt(dt.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/cE}_compareTo(e){return this.seconds===e.seconds?Rr(this.nanoseconds,e.nanoseconds):Rr(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:Un._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(ap(e,Un._jsonSchema))return new Un(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-lE;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}Un._jsonSchemaVersion="firestore/timestamp/1.0",Un._jsonSchema={type:zi("string",Un._jsonSchemaVersion),seconds:zi("number"),nanoseconds:zi("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vr{static fromTimestamp(e){return new vr(e)}static min(){return new vr(new Un(0,0))}static max(){return new vr(new Un(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const R1=-1;function wL(t,e){const r=t.toTimestamp().seconds,n=t.toTimestamp().nanoseconds+1,i=vr.fromTimestamp(n===1e9?new Un(r+1,0):new Un(r,n));return new mf(i,Jt.empty(),e)}function EL(t){return new mf(t.readTime,t.key,R1)}class mf{constructor(e,r,n){this.readTime=e,this.documentKey=r,this.largestBatchId=n}static min(){return new mf(vr.min(),Jt.empty(),R1)}static max(){return new mf(vr.max(),Jt.empty(),R1)}}function bL(t,e){let r=t.readTime.compareTo(e.readTime);return r!==0?r:(r=Jt.comparator(t.documentKey,e.documentKey),r!==0?r:Rr(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const SL="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class AL{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ad(t){if(t.code!==dt.FAILED_PRECONDITION||t.message!==SL)throw t;Ht("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gt{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(r=>{this.isDone=!0,this.result=r,this.nextCallback&&this.nextCallback(r)},r=>{this.isDone=!0,this.error=r,this.catchCallback&&this.catchCallback(r)})}catch(e){return this.next(void 0,e)}next(e,r){return this.callbackAttached&&hr(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(r,this.error):this.wrapSuccess(e,this.result):new gt((n,i)=>{this.nextCallback=a=>{this.wrapSuccess(e,a).next(n,i)},this.catchCallback=a=>{this.wrapFailure(r,a).next(n,i)}})}toPromise(){return new Promise((e,r)=>{this.next(e,r)})}wrapUserFunction(e){try{const r=e();return r instanceof gt?r:gt.resolve(r)}catch(r){return gt.reject(r)}}wrapSuccess(e,r){return e?this.wrapUserFunction(()=>e(r)):gt.resolve(r)}wrapFailure(e,r){return e?this.wrapUserFunction(()=>e(r)):gt.reject(r)}static resolve(e){return new gt((r,n)=>{r(e)})}static reject(e){return new gt((r,n)=>{n(e)})}static waitFor(e){return new gt((r,n)=>{let i=0,a=0,o=!1;e.forEach(c=>{++i,c.next(()=>{++a,o&&a===i&&r()},u=>n(u))}),o=!0,a===i&&r()})}static or(e){let r=gt.resolve(!1);for(const n of e)r=r.next(i=>i?gt.resolve(i):n());return r}static forEach(e,r){const n=[];return e.forEach((i,a)=>{n.push(r.call(this,i,a))}),this.waitFor(n)}static mapArray(e,r){return new gt((n,i)=>{const a=e.length,o=new Array(a);let c=0;for(let u=0;u<a;u++){const h=u;r(e[h]).next(d=>{o[h]=d,++c,c===a&&n(o)},d=>i(d))}})}static doWhile(e,r){return new gt((n,i)=>{const a=()=>{e()===!0?r().next(()=>{a()},i):n()};a()})}}function TL(t){const e=t.match(/Android ([\d.]+)/i),r=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(r)}function sd(t){return t.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yg{constructor(e,r){this.previousValue=e,r&&(r.sequenceNumberHandler=n=>this._e(n),this.ae=n=>r.writeSequenceNumber(n))}_e(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ae&&this.ae(e),e}}Yg.ue=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vx=-1;function Kg(t){return t==null}function dg(t){return t===0&&1/t==-1/0}function kL(t){return typeof t=="number"&&Number.isInteger(t)&&!dg(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const YS="";function NL(t){let e="";for(let r=0;r<t.length;r++)e.length>0&&(e=uE(e)),e=CL(t.get(r),e);return uE(e)}function CL(t,e){let r=e;const n=t.length;for(let i=0;i<n;i++){const a=t.charAt(i);switch(a){case"\0":r+="";break;case YS:r+="";break;default:r+=a}}return r}function uE(t){return t+YS+""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fE(t){let e=0;for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&e++;return e}function Rf(t,e){for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&e(r,t[r])}function KS(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ri{constructor(e,r){this.comparator=e,this.root=r||Ta.EMPTY}insert(e,r){return new ri(this.comparator,this.root.insert(e,r,this.comparator).copy(null,null,Ta.BLACK,null,null))}remove(e){return new ri(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Ta.BLACK,null,null))}get(e){let r=this.root;for(;!r.isEmpty();){const n=this.comparator(e,r.key);if(n===0)return r.value;n<0?r=r.left:n>0&&(r=r.right)}return null}indexOf(e){let r=0,n=this.root;for(;!n.isEmpty();){const i=this.comparator(e,n.key);if(i===0)return r+n.left.size;i<0?n=n.left:(r+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((r,n)=>(e(r,n),!1))}toString(){const e=[];return this.inorderTraversal((r,n)=>(e.push(`${r}:${n}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new ym(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new ym(this.root,e,this.comparator,!1)}getReverseIterator(){return new ym(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new ym(this.root,e,this.comparator,!0)}}class ym{constructor(e,r,n,i){this.isReverse=i,this.nodeStack=[];let a=1;for(;!e.isEmpty();)if(a=r?n(e.key,r):1,r&&i&&(a*=-1),a<0)e=this.isReverse?e.left:e.right;else{if(a===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const r={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return r}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Ta{constructor(e,r,n,i,a){this.key=e,this.value=r,this.color=n??Ta.RED,this.left=i??Ta.EMPTY,this.right=a??Ta.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,r,n,i,a){return new Ta(e??this.key,r??this.value,n??this.color,i??this.left,a??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,r,n){let i=this;const a=n(e,i.key);return i=a<0?i.copy(null,null,null,i.left.insert(e,r,n),null):a===0?i.copy(null,r,null,null,null):i.copy(null,null,null,null,i.right.insert(e,r,n)),i.fixUp()}removeMin(){if(this.left.isEmpty())return Ta.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,r){let n,i=this;if(r(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,r),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),r(e,i.key)===0){if(i.right.isEmpty())return Ta.EMPTY;n=i.right.min(),i=i.copy(n.key,n.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,r))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Ta.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Ta.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),r=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,r)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw hr(43730,{key:this.key,value:this.value});if(this.right.isRed())throw hr(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw hr(27949);return e+(this.isRed()?0:1)}}Ta.EMPTY=null,Ta.RED=!0,Ta.BLACK=!1;Ta.EMPTY=new class{constructor(){this.size=0}get key(){throw hr(57766)}get value(){throw hr(16141)}get color(){throw hr(16727)}get left(){throw hr(29726)}get right(){throw hr(36894)}copy(e,r,n,i,a){return this}insert(e,r,n){return new Ta(e,r)}remove(e,r){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ji{constructor(e){this.comparator=e,this.data=new ri(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((r,n)=>(e(r),!1))}forEachInRange(e,r){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const i=n.getNext();if(this.comparator(i.key,e[1])>=0)return;r(i.key)}}forEachWhile(e,r){let n;for(n=r!==void 0?this.data.getIteratorFrom(r):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const r=this.data.getIteratorFrom(e);return r.hasNext()?r.getNext().key:null}getIterator(){return new hE(this.data.getIterator())}getIteratorFrom(e){return new hE(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let r=this;return r.size<e.size&&(r=e,e=this),e.forEach(n=>{r=r.add(n)}),r}isEqual(e){if(!(e instanceof Ji)||this.size!==e.size)return!1;const r=this.data.getIterator(),n=e.data.getIterator();for(;r.hasNext();){const i=r.getNext().key,a=n.getNext().key;if(this.comparator(i,a)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(r=>{e.push(r)}),e}toString(){const e=[];return this.forEach(r=>e.push(r)),"SortedSet("+e.toString()+")"}copy(e){const r=new Ji(this.comparator);return r.data=e,r}}class hE{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ro{constructor(e){this.fields=e,e.sort(Na.comparator)}static empty(){return new ro([])}unionWith(e){let r=new Ji(Na.comparator);for(const n of this.fields)r=r.add(n);for(const n of e)r=r.add(n);return new ro(r.toArray())}covers(e){for(const r of this.fields)if(r.isPrefixOf(e))return!0;return!1}isEqual(e){return W0(this.fields,e.fields,(r,n)=>r.isEqual(n))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $S extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ia{constructor(e){this.binaryString=e}static fromBase64String(e){const r=function(i){try{return atob(i)}catch(a){throw typeof DOMException<"u"&&a instanceof DOMException?new $S("Invalid base64 string: "+a):a}}(e);return new Ia(r)}static fromUint8Array(e){const r=function(i){let a="";for(let o=0;o<i.length;++o)a+=String.fromCharCode(i[o]);return a}(e);return new Ia(r)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(r){return btoa(r)}(this.binaryString)}toUint8Array(){return function(r){const n=new Uint8Array(r.length);for(let i=0;i<r.length;i++)n[i]=r.charCodeAt(i);return n}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Rr(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Ia.EMPTY_BYTE_STRING=new Ia("");const IL=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function gf(t){if(mn(!!t,39018),typeof t=="string"){let e=0;const r=IL.exec(t);if(mn(!!r,46558,{timestamp:t}),r[1]){let i=r[1];i=(i+"000000000").substr(0,9),e=Number(i)}const n=new Date(t);return{seconds:Math.floor(n.getTime()/1e3),nanos:e}}return{seconds:Ei(t.seconds),nanos:Ei(t.nanos)}}function Ei(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function vf(t){return typeof t=="string"?Ia.fromBase64String(t):Ia.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const QS="server_timestamp",JS="__type__",ZS="__previous_value__",eA="__local_write_time__";function qx(t){var e,r;return((r=(((e=t?.mapValue)===null||e===void 0?void 0:e.fields)||{})[JS])===null||r===void 0?void 0:r.stringValue)===QS}function $g(t){const e=t.mapValue.fields[ZS];return qx(e)?$g(e):e}function L1(t){const e=gf(t.mapValue.fields[eA].timestampValue);return new Un(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RL{constructor(e,r,n,i,a,o,c,u,h,d){this.databaseId=e,this.appId=r,this.persistenceKey=n,this.host=i,this.ssl=a,this.forceLongPolling=o,this.autoDetectLongPolling=c,this.longPollingOptions=u,this.useFetchStreams=h,this.isUsingEmulator=d}}const pg="(default)";class D1{constructor(e,r){this.projectId=e,this.database=r||pg}static empty(){return new D1("","")}get isDefaultDatabase(){return this.database===pg}isEqual(e){return e instanceof D1&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tA="__type__",LL="__max__",wm={mapValue:{}},rA="__vector__",mg="value";function _f(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?qx(t)?4:FL(t)?9007199254740991:DL(t)?10:11:hr(28295,{value:t})}function gc(t,e){if(t===e)return!0;const r=_f(t);if(r!==_f(e))return!1;switch(r){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return L1(t).isEqual(L1(e));case 3:return function(i,a){if(typeof i.timestampValue=="string"&&typeof a.timestampValue=="string"&&i.timestampValue.length===a.timestampValue.length)return i.timestampValue===a.timestampValue;const o=gf(i.timestampValue),c=gf(a.timestampValue);return o.seconds===c.seconds&&o.nanos===c.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(i,a){return vf(i.bytesValue).isEqual(vf(a.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(i,a){return Ei(i.geoPointValue.latitude)===Ei(a.geoPointValue.latitude)&&Ei(i.geoPointValue.longitude)===Ei(a.geoPointValue.longitude)}(t,e);case 2:return function(i,a){if("integerValue"in i&&"integerValue"in a)return Ei(i.integerValue)===Ei(a.integerValue);if("doubleValue"in i&&"doubleValue"in a){const o=Ei(i.doubleValue),c=Ei(a.doubleValue);return o===c?dg(o)===dg(c):isNaN(o)&&isNaN(c)}return!1}(t,e);case 9:return W0(t.arrayValue.values||[],e.arrayValue.values||[],gc);case 10:case 11:return function(i,a){const o=i.mapValue.fields||{},c=a.mapValue.fields||{};if(fE(o)!==fE(c))return!1;for(const u in o)if(o.hasOwnProperty(u)&&(c[u]===void 0||!gc(o[u],c[u])))return!1;return!0}(t,e);default:return hr(52216,{left:t})}}function F1(t,e){return(t.values||[]).find(r=>gc(r,e))!==void 0}function X0(t,e){if(t===e)return 0;const r=_f(t),n=_f(e);if(r!==n)return Rr(r,n);switch(r){case 0:case 9007199254740991:return 0;case 1:return Rr(t.booleanValue,e.booleanValue);case 2:return function(a,o){const c=Ei(a.integerValue||a.doubleValue),u=Ei(o.integerValue||o.doubleValue);return c<u?-1:c>u?1:c===u?0:isNaN(c)?isNaN(u)?0:-1:1}(t,e);case 3:return dE(t.timestampValue,e.timestampValue);case 4:return dE(L1(t),L1(e));case 5:return L_(t.stringValue,e.stringValue);case 6:return function(a,o){const c=vf(a),u=vf(o);return c.compareTo(u)}(t.bytesValue,e.bytesValue);case 7:return function(a,o){const c=a.split("/"),u=o.split("/");for(let h=0;h<c.length&&h<u.length;h++){const d=Rr(c[h],u[h]);if(d!==0)return d}return Rr(c.length,u.length)}(t.referenceValue,e.referenceValue);case 8:return function(a,o){const c=Rr(Ei(a.latitude),Ei(o.latitude));return c!==0?c:Rr(Ei(a.longitude),Ei(o.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return pE(t.arrayValue,e.arrayValue);case 10:return function(a,o){var c,u,h,d;const g=a.fields||{},x=o.fields||{},_=(c=g[mg])===null||c===void 0?void 0:c.arrayValue,b=(u=x[mg])===null||u===void 0?void 0:u.arrayValue,E=Rr(((h=_?.values)===null||h===void 0?void 0:h.length)||0,((d=b?.values)===null||d===void 0?void 0:d.length)||0);return E!==0?E:pE(_,b)}(t.mapValue,e.mapValue);case 11:return function(a,o){if(a===wm.mapValue&&o===wm.mapValue)return 0;if(a===wm.mapValue)return 1;if(o===wm.mapValue)return-1;const c=a.fields||{},u=Object.keys(c),h=o.fields||{},d=Object.keys(h);u.sort(),d.sort();for(let g=0;g<u.length&&g<d.length;++g){const x=L_(u[g],d[g]);if(x!==0)return x;const _=X0(c[u[g]],h[d[g]]);if(_!==0)return _}return Rr(u.length,d.length)}(t.mapValue,e.mapValue);default:throw hr(23264,{le:r})}}function dE(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return Rr(t,e);const r=gf(t),n=gf(e),i=Rr(r.seconds,n.seconds);return i!==0?i:Rr(r.nanos,n.nanos)}function pE(t,e){const r=t.values||[],n=e.values||[];for(let i=0;i<r.length&&i<n.length;++i){const a=X0(r[i],n[i]);if(a)return a}return Rr(r.length,n.length)}function Y0(t){return D_(t)}function D_(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(r){const n=gf(r);return`time(${n.seconds},${n.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(r){return vf(r).toBase64()}(t.bytesValue):"referenceValue"in t?function(r){return Jt.fromName(r).toString()}(t.referenceValue):"geoPointValue"in t?function(r){return`geo(${r.latitude},${r.longitude})`}(t.geoPointValue):"arrayValue"in t?function(r){let n="[",i=!0;for(const a of r.values||[])i?i=!1:n+=",",n+=D_(a);return n+"]"}(t.arrayValue):"mapValue"in t?function(r){const n=Object.keys(r.fields||{}).sort();let i="{",a=!0;for(const o of n)a?a=!1:i+=",",i+=`${o}:${D_(r.fields[o])}`;return i+"}"}(t.mapValue):hr(61005,{value:t})}function Gm(t){switch(_f(t)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=$g(t);return e?16+Gm(e):16;case 5:return 2*t.stringValue.length;case 6:return vf(t.bytesValue).approximateByteSize();case 7:return t.referenceValue.length;case 9:return function(n){return(n.values||[]).reduce((i,a)=>i+Gm(a),0)}(t.arrayValue);case 10:case 11:return function(n){let i=0;return Rf(n.fields,(a,o)=>{i+=a.length+Gm(o)}),i}(t.mapValue);default:throw hr(13486,{value:t})}}function mE(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function F_(t){return!!t&&"integerValue"in t}function zx(t){return!!t&&"arrayValue"in t}function gE(t){return!!t&&"nullValue"in t}function vE(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Wm(t){return!!t&&"mapValue"in t}function DL(t){var e,r;return((r=(((e=t?.mapValue)===null||e===void 0?void 0:e.fields)||{})[tA])===null||r===void 0?void 0:r.stringValue)===rA}function d1(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return Rf(t.mapValue.fields,(r,n)=>e.mapValue.fields[r]=d1(n)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let r=0;r<(t.arrayValue.values||[]).length;++r)e.arrayValue.values[r]=d1(t.arrayValue.values[r]);return e}return Object.assign({},t)}function FL(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue===LL}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rs{constructor(e){this.value=e}static empty(){return new Rs({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let r=this.value;for(let n=0;n<e.length-1;++n)if(r=(r.mapValue.fields||{})[e.get(n)],!Wm(r))return null;return r=(r.mapValue.fields||{})[e.lastSegment()],r||null}}set(e,r){this.getFieldsMap(e.popLast())[e.lastSegment()]=d1(r)}setAll(e){let r=Na.emptyPath(),n={},i=[];e.forEach((o,c)=>{if(!r.isImmediateParentOf(c)){const u=this.getFieldsMap(r);this.applyChanges(u,n,i),n={},i=[],r=c.popLast()}o?n[c.lastSegment()]=d1(o):i.push(c.lastSegment())});const a=this.getFieldsMap(r);this.applyChanges(a,n,i)}delete(e){const r=this.field(e.popLast());Wm(r)&&r.mapValue.fields&&delete r.mapValue.fields[e.lastSegment()]}isEqual(e){return gc(this.value,e.value)}getFieldsMap(e){let r=this.value;r.mapValue.fields||(r.mapValue={fields:{}});for(let n=0;n<e.length;++n){let i=r.mapValue.fields[e.get(n)];Wm(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},r.mapValue.fields[e.get(n)]=i),r=i}return r.mapValue.fields}applyChanges(e,r,n){Rf(r,(i,a)=>e[i]=a);for(const i of n)delete e[i]}clone(){return new Rs(d1(this.value))}}function nA(t){const e=[];return Rf(t.fields,(r,n)=>{const i=new Na([r]);if(Wm(n)){const a=nA(n.mapValue).fields;if(a.length===0)e.push(i);else for(const o of a)e.push(i.child(o))}else e.push(i)}),new ro(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ja{constructor(e,r,n,i,a,o,c){this.key=e,this.documentType=r,this.version=n,this.readTime=i,this.createTime=a,this.data=o,this.documentState=c}static newInvalidDocument(e){return new Ja(e,0,vr.min(),vr.min(),vr.min(),Rs.empty(),0)}static newFoundDocument(e,r,n,i){return new Ja(e,1,r,vr.min(),n,i,0)}static newNoDocument(e,r){return new Ja(e,2,r,vr.min(),vr.min(),Rs.empty(),0)}static newUnknownDocument(e,r){return new Ja(e,3,r,vr.min(),vr.min(),Rs.empty(),2)}convertToFoundDocument(e,r){return!this.createTime.isEqual(vr.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=r,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Rs.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Rs.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=vr.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Ja&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Ja(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gg{constructor(e,r){this.position=e,this.inclusive=r}}function _E(t,e,r){let n=0;for(let i=0;i<t.position.length;i++){const a=e[i],o=t.position[i];if(a.field.isKeyField()?n=Jt.comparator(Jt.fromName(o.referenceValue),r.key):n=X0(o,r.data.field(a.field)),a.dir==="desc"&&(n*=-1),n!==0)break}return n}function xE(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let r=0;r<t.position.length;r++)if(!gc(t.position[r],e.position[r]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vg{constructor(e,r="asc"){this.field=e,this.dir=r}}function OL(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iA{}class qi extends iA{constructor(e,r,n){super(),this.field=e,this.op=r,this.value=n}static create(e,r,n){return e.isKeyField()?r==="in"||r==="not-in"?this.createKeyFieldInFilter(e,r,n):new ML(e,r,n):r==="array-contains"?new UL(e,n):r==="in"?new VL(e,n):r==="not-in"?new qL(e,n):r==="array-contains-any"?new zL(e,n):new qi(e,r,n)}static createKeyFieldInFilter(e,r,n){return r==="in"?new BL(e,n):new jL(e,n)}matches(e){const r=e.data.field(this.field);return this.op==="!="?r!==null&&r.nullValue===void 0&&this.matchesComparison(X0(r,this.value)):r!==null&&_f(this.value)===_f(r)&&this.matchesComparison(X0(r,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return hr(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class bl extends iA{constructor(e,r){super(),this.filters=e,this.op=r,this.he=null}static create(e,r){return new bl(e,r)}matches(e){return aA(this)?this.filters.find(r=>!r.matches(e))===void 0:this.filters.find(r=>r.matches(e))!==void 0}getFlattenedFilters(){return this.he!==null||(this.he=this.filters.reduce((e,r)=>e.concat(r.getFlattenedFilters()),[])),this.he}getFilters(){return Object.assign([],this.filters)}}function aA(t){return t.op==="and"}function sA(t){return PL(t)&&aA(t)}function PL(t){for(const e of t.filters)if(e instanceof bl)return!1;return!0}function O_(t){if(t instanceof qi)return t.field.canonicalString()+t.op.toString()+Y0(t.value);if(sA(t))return t.filters.map(e=>O_(e)).join(",");{const e=t.filters.map(r=>O_(r)).join(",");return`${t.op}(${e})`}}function oA(t,e){return t instanceof qi?function(n,i){return i instanceof qi&&n.op===i.op&&n.field.isEqual(i.field)&&gc(n.value,i.value)}(t,e):t instanceof bl?function(n,i){return i instanceof bl&&n.op===i.op&&n.filters.length===i.filters.length?n.filters.reduce((a,o,c)=>a&&oA(o,i.filters[c]),!0):!1}(t,e):void hr(19439)}function lA(t){return t instanceof qi?function(r){return`${r.field.canonicalString()} ${r.op} ${Y0(r.value)}`}(t):t instanceof bl?function(r){return r.op.toString()+" {"+r.getFilters().map(lA).join(" ,")+"}"}(t):"Filter"}class ML extends qi{constructor(e,r,n){super(e,r,n),this.key=Jt.fromName(n.referenceValue)}matches(e){const r=Jt.comparator(e.key,this.key);return this.matchesComparison(r)}}class BL extends qi{constructor(e,r){super(e,"in",r),this.keys=cA("in",r)}matches(e){return this.keys.some(r=>r.isEqual(e.key))}}class jL extends qi{constructor(e,r){super(e,"not-in",r),this.keys=cA("not-in",r)}matches(e){return!this.keys.some(r=>r.isEqual(e.key))}}function cA(t,e){var r;return(((r=e.arrayValue)===null||r===void 0?void 0:r.values)||[]).map(n=>Jt.fromName(n.referenceValue))}class UL extends qi{constructor(e,r){super(e,"array-contains",r)}matches(e){const r=e.data.field(this.field);return zx(r)&&F1(r.arrayValue,this.value)}}class VL extends qi{constructor(e,r){super(e,"in",r)}matches(e){const r=e.data.field(this.field);return r!==null&&F1(this.value.arrayValue,r)}}class qL extends qi{constructor(e,r){super(e,"not-in",r)}matches(e){if(F1(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const r=e.data.field(this.field);return r!==null&&r.nullValue===void 0&&!F1(this.value.arrayValue,r)}}class zL extends qi{constructor(e,r){super(e,"array-contains-any",r)}matches(e){const r=e.data.field(this.field);return!(!zx(r)||!r.arrayValue.values)&&r.arrayValue.values.some(n=>F1(this.value.arrayValue,n))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HL{constructor(e,r=null,n=[],i=[],a=null,o=null,c=null){this.path=e,this.collectionGroup=r,this.orderBy=n,this.filters=i,this.limit=a,this.startAt=o,this.endAt=c,this.Pe=null}}function yE(t,e=null,r=[],n=[],i=null,a=null,o=null){return new HL(t,e,r,n,i,a,o)}function Hx(t){const e=xr(t);if(e.Pe===null){let r=e.path.canonicalString();e.collectionGroup!==null&&(r+="|cg:"+e.collectionGroup),r+="|f:",r+=e.filters.map(n=>O_(n)).join(","),r+="|ob:",r+=e.orderBy.map(n=>function(a){return a.field.canonicalString()+a.dir}(n)).join(","),Kg(e.limit)||(r+="|l:",r+=e.limit),e.startAt&&(r+="|lb:",r+=e.startAt.inclusive?"b:":"a:",r+=e.startAt.position.map(n=>Y0(n)).join(",")),e.endAt&&(r+="|ub:",r+=e.endAt.inclusive?"a:":"b:",r+=e.endAt.position.map(n=>Y0(n)).join(",")),e.Pe=r}return e.Pe}function Gx(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let r=0;r<t.orderBy.length;r++)if(!OL(t.orderBy[r],e.orderBy[r]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let r=0;r<t.filters.length;r++)if(!oA(t.filters[r],e.filters[r]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!xE(t.startAt,e.startAt)&&xE(t.endAt,e.endAt)}function P_(t){return Jt.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sp{constructor(e,r=null,n=[],i=[],a=null,o="F",c=null,u=null){this.path=e,this.collectionGroup=r,this.explicitOrderBy=n,this.filters=i,this.limit=a,this.limitType=o,this.startAt=c,this.endAt=u,this.Te=null,this.Ie=null,this.de=null,this.startAt,this.endAt}}function GL(t,e,r,n,i,a,o,c){return new sp(t,e,r,n,i,a,o,c)}function Wx(t){return new sp(t)}function wE(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function uA(t){return t.collectionGroup!==null}function p1(t){const e=xr(t);if(e.Te===null){e.Te=[];const r=new Set;for(const a of e.explicitOrderBy)e.Te.push(a),r.add(a.field.canonicalString());const n=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let c=new Ji(Na.comparator);return o.filters.forEach(u=>{u.getFlattenedFilters().forEach(h=>{h.isInequality()&&(c=c.add(h.field))})}),c})(e).forEach(a=>{r.has(a.canonicalString())||a.isKeyField()||e.Te.push(new vg(a,n))}),r.has(Na.keyField().canonicalString())||e.Te.push(new vg(Na.keyField(),n))}return e.Te}function fc(t){const e=xr(t);return e.Ie||(e.Ie=WL(e,p1(t))),e.Ie}function WL(t,e){if(t.limitType==="F")return yE(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(i=>{const a=i.dir==="desc"?"asc":"desc";return new vg(i.field,a)});const r=t.endAt?new gg(t.endAt.position,t.endAt.inclusive):null,n=t.startAt?new gg(t.startAt.position,t.startAt.inclusive):null;return yE(t.path,t.collectionGroup,e,t.filters,t.limit,r,n)}}function M_(t,e){const r=t.filters.concat([e]);return new sp(t.path,t.collectionGroup,t.explicitOrderBy.slice(),r,t.limit,t.limitType,t.startAt,t.endAt)}function B_(t,e,r){return new sp(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,r,t.startAt,t.endAt)}function Qg(t,e){return Gx(fc(t),fc(e))&&t.limitType===e.limitType}function fA(t){return`${Hx(fc(t))}|lt:${t.limitType}`}function b0(t){return`Query(target=${function(r){let n=r.path.canonicalString();return r.collectionGroup!==null&&(n+=" collectionGroup="+r.collectionGroup),r.filters.length>0&&(n+=`, filters: [${r.filters.map(i=>lA(i)).join(", ")}]`),Kg(r.limit)||(n+=", limit: "+r.limit),r.orderBy.length>0&&(n+=`, orderBy: [${r.orderBy.map(i=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(i)).join(", ")}]`),r.startAt&&(n+=", startAt: ",n+=r.startAt.inclusive?"b:":"a:",n+=r.startAt.position.map(i=>Y0(i)).join(",")),r.endAt&&(n+=", endAt: ",n+=r.endAt.inclusive?"a:":"b:",n+=r.endAt.position.map(i=>Y0(i)).join(",")),`Target(${n})`}(fc(t))}; limitType=${t.limitType})`}function Jg(t,e){return e.isFoundDocument()&&function(n,i){const a=i.key.path;return n.collectionGroup!==null?i.key.hasCollectionId(n.collectionGroup)&&n.path.isPrefixOf(a):Jt.isDocumentKey(n.path)?n.path.isEqual(a):n.path.isImmediateParentOf(a)}(t,e)&&function(n,i){for(const a of p1(n))if(!a.field.isKeyField()&&i.data.field(a.field)===null)return!1;return!0}(t,e)&&function(n,i){for(const a of n.filters)if(!a.matches(i))return!1;return!0}(t,e)&&function(n,i){return!(n.startAt&&!function(o,c,u){const h=_E(o,c,u);return o.inclusive?h<=0:h<0}(n.startAt,p1(n),i)||n.endAt&&!function(o,c,u){const h=_E(o,c,u);return o.inclusive?h>=0:h>0}(n.endAt,p1(n),i))}(t,e)}function XL(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function hA(t){return(e,r)=>{let n=!1;for(const i of p1(t)){const a=YL(i,e,r);if(a!==0)return a;n=n||i.field.isKeyField()}return 0}}function YL(t,e,r){const n=t.field.isKeyField()?Jt.comparator(e.key,r.key):function(a,o,c){const u=o.data.field(a),h=c.data.field(a);return u!==null&&h!==null?X0(u,h):hr(42886)}(t.field,e,r);switch(t.dir){case"asc":return n;case"desc":return-1*n;default:return hr(19790,{direction:t.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lh{constructor(e,r){this.mapKeyFn=e,this.equalsFn=r,this.inner={},this.innerSize=0}get(e){const r=this.mapKeyFn(e),n=this.inner[r];if(n!==void 0){for(const[i,a]of n)if(this.equalsFn(i,e))return a}}has(e){return this.get(e)!==void 0}set(e,r){const n=this.mapKeyFn(e),i=this.inner[n];if(i===void 0)return this.inner[n]=[[e,r]],void this.innerSize++;for(let a=0;a<i.length;a++)if(this.equalsFn(i[a][0],e))return void(i[a]=[e,r]);i.push([e,r]),this.innerSize++}delete(e){const r=this.mapKeyFn(e),n=this.inner[r];if(n===void 0)return!1;for(let i=0;i<n.length;i++)if(this.equalsFn(n[i][0],e))return n.length===1?delete this.inner[r]:n.splice(i,1),this.innerSize--,!0;return!1}forEach(e){Rf(this.inner,(r,n)=>{for(const[i,a]of n)e(i,a)})}isEmpty(){return KS(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const KL=new ri(Jt.comparator);function lu(){return KL}const dA=new ri(Jt.comparator);function a1(...t){let e=dA;for(const r of t)e=e.insert(r.key,r);return e}function pA(t){let e=dA;return t.forEach((r,n)=>e=e.insert(r,n.overlayedDocument)),e}function ch(){return m1()}function mA(){return m1()}function m1(){return new Lh(t=>t.toString(),(t,e)=>t.isEqual(e))}const $L=new ri(Jt.comparator),QL=new Ji(Jt.comparator);function qr(...t){let e=QL;for(const r of t)e=e.add(r);return e}const JL=new Ji(Rr);function ZL(){return JL}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xx(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:dg(e)?"-0":e}}function gA(t){return{integerValue:""+t}}function eD(t,e){return kL(e)?gA(e):Xx(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zg{constructor(){this._=void 0}}function tD(t,e,r){return t instanceof _g?function(i,a){const o={fields:{[JS]:{stringValue:QS},[eA]:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return a&&qx(a)&&(a=$g(a)),a&&(o.fields[ZS]=a),{mapValue:o}}(r,e):t instanceof O1?_A(t,e):t instanceof P1?xA(t,e):function(i,a){const o=vA(i,a),c=EE(o)+EE(i.Ee);return F_(o)&&F_(i.Ee)?gA(c):Xx(i.serializer,c)}(t,e)}function rD(t,e,r){return t instanceof O1?_A(t,e):t instanceof P1?xA(t,e):r}function vA(t,e){return t instanceof xg?function(n){return F_(n)||function(a){return!!a&&"doubleValue"in a}(n)}(e)?e:{integerValue:0}:null}class _g extends Zg{}class O1 extends Zg{constructor(e){super(),this.elements=e}}function _A(t,e){const r=yA(e);for(const n of t.elements)r.some(i=>gc(i,n))||r.push(n);return{arrayValue:{values:r}}}class P1 extends Zg{constructor(e){super(),this.elements=e}}function xA(t,e){let r=yA(e);for(const n of t.elements)r=r.filter(i=>!gc(i,n));return{arrayValue:{values:r}}}class xg extends Zg{constructor(e,r){super(),this.serializer=e,this.Ee=r}}function EE(t){return Ei(t.integerValue||t.doubleValue)}function yA(t){return zx(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}function nD(t,e){return t.field.isEqual(e.field)&&function(n,i){return n instanceof O1&&i instanceof O1||n instanceof P1&&i instanceof P1?W0(n.elements,i.elements,gc):n instanceof xg&&i instanceof xg?gc(n.Ee,i.Ee):n instanceof _g&&i instanceof _g}(t.transform,e.transform)}class iD{constructor(e,r){this.version=e,this.transformResults=r}}class jo{constructor(e,r){this.updateTime=e,this.exists=r}static none(){return new jo}static exists(e){return new jo(void 0,e)}static updateTime(e){return new jo(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Xm(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class e2{}function wA(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new Yx(t.key,jo.none()):new op(t.key,t.data,jo.none());{const r=t.data,n=Rs.empty();let i=new Ji(Na.comparator);for(let a of e.fields)if(!i.has(a)){let o=r.field(a);o===null&&a.length>1&&(a=a.popLast(),o=r.field(a)),o===null?n.delete(a):n.set(a,o),i=i.add(a)}return new Lf(t.key,n,new ro(i.toArray()),jo.none())}}function aD(t,e,r){t instanceof op?function(i,a,o){const c=i.value.clone(),u=SE(i.fieldTransforms,a,o.transformResults);c.setAll(u),a.convertToFoundDocument(o.version,c).setHasCommittedMutations()}(t,e,r):t instanceof Lf?function(i,a,o){if(!Xm(i.precondition,a))return void a.convertToUnknownDocument(o.version);const c=SE(i.fieldTransforms,a,o.transformResults),u=a.data;u.setAll(EA(i)),u.setAll(c),a.convertToFoundDocument(o.version,u).setHasCommittedMutations()}(t,e,r):function(i,a,o){a.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,r)}function g1(t,e,r,n){return t instanceof op?function(a,o,c,u){if(!Xm(a.precondition,o))return c;const h=a.value.clone(),d=AE(a.fieldTransforms,u,o);return h.setAll(d),o.convertToFoundDocument(o.version,h).setHasLocalMutations(),null}(t,e,r,n):t instanceof Lf?function(a,o,c,u){if(!Xm(a.precondition,o))return c;const h=AE(a.fieldTransforms,u,o),d=o.data;return d.setAll(EA(a)),d.setAll(h),o.convertToFoundDocument(o.version,d).setHasLocalMutations(),c===null?null:c.unionWith(a.fieldMask.fields).unionWith(a.fieldTransforms.map(g=>g.field))}(t,e,r,n):function(a,o,c){return Xm(a.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):c}(t,e,r)}function sD(t,e){let r=null;for(const n of t.fieldTransforms){const i=e.data.field(n.field),a=vA(n.transform,i||null);a!=null&&(r===null&&(r=Rs.empty()),r.set(n.field,a))}return r||null}function bE(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(n,i){return n===void 0&&i===void 0||!(!n||!i)&&W0(n,i,(a,o)=>nD(a,o))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class op extends e2{constructor(e,r,n,i=[]){super(),this.key=e,this.value=r,this.precondition=n,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class Lf extends e2{constructor(e,r,n,i,a=[]){super(),this.key=e,this.data=r,this.fieldMask=n,this.precondition=i,this.fieldTransforms=a,this.type=1}getFieldMask(){return this.fieldMask}}function EA(t){const e=new Map;return t.fieldMask.fields.forEach(r=>{if(!r.isEmpty()){const n=t.data.field(r);e.set(r,n)}}),e}function SE(t,e,r){const n=new Map;mn(t.length===r.length,32656,{Ae:r.length,Re:t.length});for(let i=0;i<r.length;i++){const a=t[i],o=a.transform,c=e.data.field(a.field);n.set(a.field,rD(o,c,r[i]))}return n}function AE(t,e,r){const n=new Map;for(const i of t){const a=i.transform,o=r.data.field(i.field);n.set(i.field,tD(a,o,e))}return n}class Yx extends e2{constructor(e,r){super(),this.key=e,this.precondition=r,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class oD extends e2{constructor(e,r){super(),this.key=e,this.precondition=r,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lD{constructor(e,r,n,i){this.batchId=e,this.localWriteTime=r,this.baseMutations=n,this.mutations=i}applyToRemoteDocument(e,r){const n=r.mutationResults;for(let i=0;i<this.mutations.length;i++){const a=this.mutations[i];a.key.isEqual(e.key)&&aD(a,e,n[i])}}applyToLocalView(e,r){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(r=g1(n,e,r,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(r=g1(n,e,r,this.localWriteTime));return r}applyToLocalDocumentSet(e,r){const n=mA();return this.mutations.forEach(i=>{const a=e.get(i.key),o=a.overlayedDocument;let c=this.applyToLocalView(o,a.mutatedFields);c=r.has(i.key)?null:c;const u=wA(o,c);u!==null&&n.set(i.key,u),o.isValidDocument()||o.convertToNoDocument(vr.min())}),n}keys(){return this.mutations.reduce((e,r)=>e.add(r.key),qr())}isEqual(e){return this.batchId===e.batchId&&W0(this.mutations,e.mutations,(r,n)=>bE(r,n))&&W0(this.baseMutations,e.baseMutations,(r,n)=>bE(r,n))}}class Kx{constructor(e,r,n,i){this.batch=e,this.commitVersion=r,this.mutationResults=n,this.docVersions=i}static from(e,r,n){mn(e.mutations.length===n.length,58842,{Ve:e.mutations.length,me:n.length});let i=function(){return $L}();const a=e.mutations;for(let o=0;o<a.length;o++)i=i.insert(a[o].key,n[o].version);return new Kx(e,r,n,i)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cD{constructor(e,r){this.largestBatchId=e,this.mutation=r}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uD{constructor(e,r){this.count=e,this.unchangedNames=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Bi,$r;function fD(t){switch(t){case dt.OK:return hr(64938);case dt.CANCELLED:case dt.UNKNOWN:case dt.DEADLINE_EXCEEDED:case dt.RESOURCE_EXHAUSTED:case dt.INTERNAL:case dt.UNAVAILABLE:case dt.UNAUTHENTICATED:return!1;case dt.INVALID_ARGUMENT:case dt.NOT_FOUND:case dt.ALREADY_EXISTS:case dt.PERMISSION_DENIED:case dt.FAILED_PRECONDITION:case dt.ABORTED:case dt.OUT_OF_RANGE:case dt.UNIMPLEMENTED:case dt.DATA_LOSS:return!0;default:return hr(15467,{code:t})}}function bA(t){if(t===void 0)return ou("GRPC error has no .code"),dt.UNKNOWN;switch(t){case Bi.OK:return dt.OK;case Bi.CANCELLED:return dt.CANCELLED;case Bi.UNKNOWN:return dt.UNKNOWN;case Bi.DEADLINE_EXCEEDED:return dt.DEADLINE_EXCEEDED;case Bi.RESOURCE_EXHAUSTED:return dt.RESOURCE_EXHAUSTED;case Bi.INTERNAL:return dt.INTERNAL;case Bi.UNAVAILABLE:return dt.UNAVAILABLE;case Bi.UNAUTHENTICATED:return dt.UNAUTHENTICATED;case Bi.INVALID_ARGUMENT:return dt.INVALID_ARGUMENT;case Bi.NOT_FOUND:return dt.NOT_FOUND;case Bi.ALREADY_EXISTS:return dt.ALREADY_EXISTS;case Bi.PERMISSION_DENIED:return dt.PERMISSION_DENIED;case Bi.FAILED_PRECONDITION:return dt.FAILED_PRECONDITION;case Bi.ABORTED:return dt.ABORTED;case Bi.OUT_OF_RANGE:return dt.OUT_OF_RANGE;case Bi.UNIMPLEMENTED:return dt.UNIMPLEMENTED;case Bi.DATA_LOSS:return dt.DATA_LOSS;default:return hr(39323,{code:t})}}($r=Bi||(Bi={}))[$r.OK=0]="OK",$r[$r.CANCELLED=1]="CANCELLED",$r[$r.UNKNOWN=2]="UNKNOWN",$r[$r.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",$r[$r.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",$r[$r.NOT_FOUND=5]="NOT_FOUND",$r[$r.ALREADY_EXISTS=6]="ALREADY_EXISTS",$r[$r.PERMISSION_DENIED=7]="PERMISSION_DENIED",$r[$r.UNAUTHENTICATED=16]="UNAUTHENTICATED",$r[$r.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",$r[$r.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",$r[$r.ABORTED=10]="ABORTED",$r[$r.OUT_OF_RANGE=11]="OUT_OF_RANGE",$r[$r.UNIMPLEMENTED=12]="UNIMPLEMENTED",$r[$r.INTERNAL=13]="INTERNAL",$r[$r.UNAVAILABLE=14]="UNAVAILABLE",$r[$r.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hD=new hf([4294967295,4294967295],0);function TE(t){const e=GS().encode(t),r=new MS;return r.update(e),new Uint8Array(r.digest())}function kE(t){const e=new DataView(t.buffer),r=e.getUint32(0,!0),n=e.getUint32(4,!0),i=e.getUint32(8,!0),a=e.getUint32(12,!0);return[new hf([r,n],0),new hf([i,a],0)]}class $x{constructor(e,r,n){if(this.bitmap=e,this.padding=r,this.hashCount=n,r<0||r>=8)throw new s1(`Invalid padding: ${r}`);if(n<0)throw new s1(`Invalid hash count: ${n}`);if(e.length>0&&this.hashCount===0)throw new s1(`Invalid hash count: ${n}`);if(e.length===0&&r!==0)throw new s1(`Invalid padding when bitmap length is 0: ${r}`);this.fe=8*e.length-r,this.ge=hf.fromNumber(this.fe)}pe(e,r,n){let i=e.add(r.multiply(hf.fromNumber(n)));return i.compare(hD)===1&&(i=new hf([i.getBits(0),i.getBits(1)],0)),i.modulo(this.ge).toNumber()}ye(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.fe===0)return!1;const r=TE(e),[n,i]=kE(r);for(let a=0;a<this.hashCount;a++){const o=this.pe(n,i,a);if(!this.ye(o))return!1}return!0}static create(e,r,n){const i=e%8==0?0:8-e%8,a=new Uint8Array(Math.ceil(e/8)),o=new $x(a,i,r);return n.forEach(c=>o.insert(c)),o}insert(e){if(this.fe===0)return;const r=TE(e),[n,i]=kE(r);for(let a=0;a<this.hashCount;a++){const o=this.pe(n,i,a);this.we(o)}}we(e){const r=Math.floor(e/8),n=e%8;this.bitmap[r]|=1<<n}}class s1 extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class t2{constructor(e,r,n,i,a){this.snapshotVersion=e,this.targetChanges=r,this.targetMismatches=n,this.documentUpdates=i,this.resolvedLimboDocuments=a}static createSynthesizedRemoteEventForCurrentChange(e,r,n){const i=new Map;return i.set(e,lp.createSynthesizedTargetChangeForCurrentChange(e,r,n)),new t2(vr.min(),i,new ri(Rr),lu(),qr())}}class lp{constructor(e,r,n,i,a){this.resumeToken=e,this.current=r,this.addedDocuments=n,this.modifiedDocuments=i,this.removedDocuments=a}static createSynthesizedTargetChangeForCurrentChange(e,r,n){return new lp(n,r,qr(),qr(),qr())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ym{constructor(e,r,n,i){this.Se=e,this.removedTargetIds=r,this.key=n,this.be=i}}class SA{constructor(e,r){this.targetId=e,this.De=r}}class AA{constructor(e,r,n=Ia.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=r,this.resumeToken=n,this.cause=i}}class NE{constructor(){this.ve=0,this.Ce=CE(),this.Fe=Ia.EMPTY_BYTE_STRING,this.Me=!1,this.xe=!0}get current(){return this.Me}get resumeToken(){return this.Fe}get Oe(){return this.ve!==0}get Ne(){return this.xe}Be(e){e.approximateByteSize()>0&&(this.xe=!0,this.Fe=e)}Le(){let e=qr(),r=qr(),n=qr();return this.Ce.forEach((i,a)=>{switch(a){case 0:e=e.add(i);break;case 2:r=r.add(i);break;case 1:n=n.add(i);break;default:hr(38017,{changeType:a})}}),new lp(this.Fe,this.Me,e,r,n)}ke(){this.xe=!1,this.Ce=CE()}qe(e,r){this.xe=!0,this.Ce=this.Ce.insert(e,r)}Qe(e){this.xe=!0,this.Ce=this.Ce.remove(e)}$e(){this.ve+=1}Ue(){this.ve-=1,mn(this.ve>=0,3241,{ve:this.ve})}Ke(){this.xe=!0,this.Me=!0}}class dD{constructor(e){this.We=e,this.Ge=new Map,this.ze=lu(),this.je=Em(),this.Je=Em(),this.He=new ri(Rr)}Ye(e){for(const r of e.Se)e.be&&e.be.isFoundDocument()?this.Ze(r,e.be):this.Xe(r,e.key,e.be);for(const r of e.removedTargetIds)this.Xe(r,e.key,e.be)}et(e){this.forEachTarget(e,r=>{const n=this.tt(r);switch(e.state){case 0:this.nt(r)&&n.Be(e.resumeToken);break;case 1:n.Ue(),n.Oe||n.ke(),n.Be(e.resumeToken);break;case 2:n.Ue(),n.Oe||this.removeTarget(r);break;case 3:this.nt(r)&&(n.Ke(),n.Be(e.resumeToken));break;case 4:this.nt(r)&&(this.rt(r),n.Be(e.resumeToken));break;default:hr(56790,{state:e.state})}})}forEachTarget(e,r){e.targetIds.length>0?e.targetIds.forEach(r):this.Ge.forEach((n,i)=>{this.nt(i)&&r(i)})}it(e){const r=e.targetId,n=e.De.count,i=this.st(r);if(i){const a=i.target;if(P_(a))if(n===0){const o=new Jt(a.path);this.Xe(r,o,Ja.newNoDocument(o,vr.min()))}else mn(n===1,20013,{expectedCount:n});else{const o=this.ot(r);if(o!==n){const c=this._t(e),u=c?this.ut(c,e,o):1;if(u!==0){this.rt(r);const h=u===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.He=this.He.insert(r,h)}}}}}_t(e){const r=e.De.unchangedNames;if(!r||!r.bits)return null;const{bits:{bitmap:n="",padding:i=0},hashCount:a=0}=r;let o,c;try{o=vf(n).toUint8Array()}catch(u){if(u instanceof $S)return pf("Decoding the base64 bloom filter in existence filter failed ("+u.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw u}try{c=new $x(o,i,a)}catch(u){return pf(u instanceof s1?"BloomFilter error: ":"Applying bloom filter failed: ",u),null}return c.fe===0?null:c}ut(e,r,n){return r.De.count===n-this.ht(e,r.targetId)?0:2}ht(e,r){const n=this.We.getRemoteKeysForTarget(r);let i=0;return n.forEach(a=>{const o=this.We.lt(),c=`projects/${o.projectId}/databases/${o.database}/documents/${a.path.canonicalString()}`;e.mightContain(c)||(this.Xe(r,a,null),i++)}),i}Pt(e){const r=new Map;this.Ge.forEach((a,o)=>{const c=this.st(o);if(c){if(a.current&&P_(c.target)){const u=new Jt(c.target.path);this.Tt(u).has(o)||this.It(o,u)||this.Xe(o,u,Ja.newNoDocument(u,e))}a.Ne&&(r.set(o,a.Le()),a.ke())}});let n=qr();this.Je.forEach((a,o)=>{let c=!0;o.forEachWhile(u=>{const h=this.st(u);return!h||h.purpose==="TargetPurposeLimboResolution"||(c=!1,!1)}),c&&(n=n.add(a))}),this.ze.forEach((a,o)=>o.setReadTime(e));const i=new t2(e,r,this.He,this.ze,n);return this.ze=lu(),this.je=Em(),this.Je=Em(),this.He=new ri(Rr),i}Ze(e,r){if(!this.nt(e))return;const n=this.It(e,r.key)?2:0;this.tt(e).qe(r.key,n),this.ze=this.ze.insert(r.key,r),this.je=this.je.insert(r.key,this.Tt(r.key).add(e)),this.Je=this.Je.insert(r.key,this.dt(r.key).add(e))}Xe(e,r,n){if(!this.nt(e))return;const i=this.tt(e);this.It(e,r)?i.qe(r,1):i.Qe(r),this.Je=this.Je.insert(r,this.dt(r).delete(e)),this.Je=this.Je.insert(r,this.dt(r).add(e)),n&&(this.ze=this.ze.insert(r,n))}removeTarget(e){this.Ge.delete(e)}ot(e){const r=this.tt(e).Le();return this.We.getRemoteKeysForTarget(e).size+r.addedDocuments.size-r.removedDocuments.size}$e(e){this.tt(e).$e()}tt(e){let r=this.Ge.get(e);return r||(r=new NE,this.Ge.set(e,r)),r}dt(e){let r=this.Je.get(e);return r||(r=new Ji(Rr),this.Je=this.Je.insert(e,r)),r}Tt(e){let r=this.je.get(e);return r||(r=new Ji(Rr),this.je=this.je.insert(e,r)),r}nt(e){const r=this.st(e)!==null;return r||Ht("WatchChangeAggregator","Detected inactive target",e),r}st(e){const r=this.Ge.get(e);return r&&r.Oe?null:this.We.Et(e)}rt(e){this.Ge.set(e,new NE),this.We.getRemoteKeysForTarget(e).forEach(r=>{this.Xe(e,r,null)})}It(e,r){return this.We.getRemoteKeysForTarget(e).has(r)}}function Em(){return new ri(Jt.comparator)}function CE(){return new ri(Jt.comparator)}const pD={asc:"ASCENDING",desc:"DESCENDING"},mD={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},gD={and:"AND",or:"OR"};class vD{constructor(e,r){this.databaseId=e,this.useProto3Json=r}}function j_(t,e){return t.useProto3Json||Kg(e)?e:{value:e}}function yg(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function TA(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function _D(t,e){return yg(t,e.toTimestamp())}function hc(t){return mn(!!t,49232),vr.fromTimestamp(function(r){const n=gf(r);return new Un(n.seconds,n.nanos)}(t))}function Qx(t,e){return U_(t,e).canonicalString()}function U_(t,e){const r=function(i){return new Mn(["projects",i.projectId,"databases",i.database])}(t).child("documents");return e===void 0?r:r.child(e)}function kA(t){const e=Mn.fromString(t);return mn(LA(e),10190,{key:e.toString()}),e}function V_(t,e){return Qx(t.databaseId,e.path)}function Hv(t,e){const r=kA(e);if(r.get(1)!==t.databaseId.projectId)throw new Vt(dt.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+r.get(1)+" vs "+t.databaseId.projectId);if(r.get(3)!==t.databaseId.database)throw new Vt(dt.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+r.get(3)+" vs "+t.databaseId.database);return new Jt(CA(r))}function NA(t,e){return Qx(t.databaseId,e)}function xD(t){const e=kA(t);return e.length===4?Mn.emptyPath():CA(e)}function q_(t){return new Mn(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function CA(t){return mn(t.length>4&&t.get(4)==="documents",29091,{key:t.toString()}),t.popFirst(5)}function IE(t,e,r){return{name:V_(t,e),fields:r.value.mapValue.fields}}function yD(t,e){let r;if("targetChange"in e){e.targetChange;const n=function(h){return h==="NO_CHANGE"?0:h==="ADD"?1:h==="REMOVE"?2:h==="CURRENT"?3:h==="RESET"?4:hr(39313,{state:h})}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],a=function(h,d){return h.useProto3Json?(mn(d===void 0||typeof d=="string",58123),Ia.fromBase64String(d||"")):(mn(d===void 0||d instanceof Buffer||d instanceof Uint8Array,16193),Ia.fromUint8Array(d||new Uint8Array))}(t,e.targetChange.resumeToken),o=e.targetChange.cause,c=o&&function(h){const d=h.code===void 0?dt.UNKNOWN:bA(h.code);return new Vt(d,h.message||"")}(o);r=new AA(n,i,a,c||null)}else if("documentChange"in e){e.documentChange;const n=e.documentChange;n.document,n.document.name,n.document.updateTime;const i=Hv(t,n.document.name),a=hc(n.document.updateTime),o=n.document.createTime?hc(n.document.createTime):vr.min(),c=new Rs({mapValue:{fields:n.document.fields}}),u=Ja.newFoundDocument(i,a,o,c),h=n.targetIds||[],d=n.removedTargetIds||[];r=new Ym(h,d,u.key,u)}else if("documentDelete"in e){e.documentDelete;const n=e.documentDelete;n.document;const i=Hv(t,n.document),a=n.readTime?hc(n.readTime):vr.min(),o=Ja.newNoDocument(i,a),c=n.removedTargetIds||[];r=new Ym([],c,o.key,o)}else if("documentRemove"in e){e.documentRemove;const n=e.documentRemove;n.document;const i=Hv(t,n.document),a=n.removedTargetIds||[];r=new Ym([],a,i,null)}else{if(!("filter"in e))return hr(11601,{At:e});{e.filter;const n=e.filter;n.targetId;const{count:i=0,unchangedNames:a}=n,o=new uD(i,a),c=n.targetId;r=new SA(c,o)}}return r}function wD(t,e){let r;if(e instanceof op)r={update:IE(t,e.key,e.value)};else if(e instanceof Yx)r={delete:V_(t,e.key)};else if(e instanceof Lf)r={update:IE(t,e.key,e.data),updateMask:ID(e.fieldMask)};else{if(!(e instanceof oD))return hr(16599,{Rt:e.type});r={verify:V_(t,e.key)}}return e.fieldTransforms.length>0&&(r.updateTransforms=e.fieldTransforms.map(n=>function(a,o){const c=o.transform;if(c instanceof _g)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(c instanceof O1)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:c.elements}};if(c instanceof P1)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:c.elements}};if(c instanceof xg)return{fieldPath:o.field.canonicalString(),increment:c.Ee};throw hr(20930,{transform:o.transform})}(0,n))),e.precondition.isNone||(r.currentDocument=function(i,a){return a.updateTime!==void 0?{updateTime:_D(i,a.updateTime)}:a.exists!==void 0?{exists:a.exists}:hr(27497)}(t,e.precondition)),r}function ED(t,e){return t&&t.length>0?(mn(e!==void 0,14353),t.map(r=>function(i,a){let o=i.updateTime?hc(i.updateTime):hc(a);return o.isEqual(vr.min())&&(o=hc(a)),new iD(o,i.transformResults||[])}(r,e))):[]}function bD(t,e){return{documents:[NA(t,e.path)]}}function SD(t,e){const r={structuredQuery:{}},n=e.path;let i;e.collectionGroup!==null?(i=n,r.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=n.popLast(),r.structuredQuery.from=[{collectionId:n.lastSegment()}]),r.parent=NA(t,i);const a=function(h){if(h.length!==0)return RA(bl.create(h,"and"))}(e.filters);a&&(r.structuredQuery.where=a);const o=function(h){if(h.length!==0)return h.map(d=>function(x){return{field:S0(x.field),direction:kD(x.dir)}}(d))}(e.orderBy);o&&(r.structuredQuery.orderBy=o);const c=j_(t,e.limit);return c!==null&&(r.structuredQuery.limit=c),e.startAt&&(r.structuredQuery.startAt=function(h){return{before:h.inclusive,values:h.position}}(e.startAt)),e.endAt&&(r.structuredQuery.endAt=function(h){return{before:!h.inclusive,values:h.position}}(e.endAt)),{Vt:r,parent:i}}function AD(t){let e=xD(t.parent);const r=t.structuredQuery,n=r.from?r.from.length:0;let i=null;if(n>0){mn(n===1,65062);const d=r.from[0];d.allDescendants?i=d.collectionId:e=e.child(d.collectionId)}let a=[];r.where&&(a=function(g){const x=IA(g);return x instanceof bl&&sA(x)?x.getFilters():[x]}(r.where));let o=[];r.orderBy&&(o=function(g){return g.map(x=>function(b){return new vg(A0(b.field),function(A){switch(A){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(b.direction))}(x))}(r.orderBy));let c=null;r.limit&&(c=function(g){let x;return x=typeof g=="object"?g.value:g,Kg(x)?null:x}(r.limit));let u=null;r.startAt&&(u=function(g){const x=!!g.before,_=g.values||[];return new gg(_,x)}(r.startAt));let h=null;return r.endAt&&(h=function(g){const x=!g.before,_=g.values||[];return new gg(_,x)}(r.endAt)),GL(e,i,o,a,c,"F",u,h)}function TD(t,e){const r=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return hr(28987,{purpose:i})}}(e.purpose);return r==null?null:{"goog-listen-tags":r}}function IA(t){return t.unaryFilter!==void 0?function(r){switch(r.unaryFilter.op){case"IS_NAN":const n=A0(r.unaryFilter.field);return qi.create(n,"==",{doubleValue:NaN});case"IS_NULL":const i=A0(r.unaryFilter.field);return qi.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const a=A0(r.unaryFilter.field);return qi.create(a,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=A0(r.unaryFilter.field);return qi.create(o,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return hr(61313);default:return hr(60726)}}(t):t.fieldFilter!==void 0?function(r){return qi.create(A0(r.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return hr(58110);default:return hr(50506)}}(r.fieldFilter.op),r.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(r){return bl.create(r.compositeFilter.filters.map(n=>IA(n)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return hr(1026)}}(r.compositeFilter.op))}(t):hr(30097,{filter:t})}function kD(t){return pD[t]}function ND(t){return mD[t]}function CD(t){return gD[t]}function S0(t){return{fieldPath:t.canonicalString()}}function A0(t){return Na.fromServerFormat(t.fieldPath)}function RA(t){return t instanceof qi?function(r){if(r.op==="=="){if(vE(r.value))return{unaryFilter:{field:S0(r.field),op:"IS_NAN"}};if(gE(r.value))return{unaryFilter:{field:S0(r.field),op:"IS_NULL"}}}else if(r.op==="!="){if(vE(r.value))return{unaryFilter:{field:S0(r.field),op:"IS_NOT_NAN"}};if(gE(r.value))return{unaryFilter:{field:S0(r.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:S0(r.field),op:ND(r.op),value:r.value}}}(t):t instanceof bl?function(r){const n=r.getFilters().map(i=>RA(i));return n.length===1?n[0]:{compositeFilter:{op:CD(r.op),filters:n}}}(t):hr(54877,{filter:t})}function ID(t){const e=[];return t.fields.forEach(r=>e.push(r.canonicalString())),{fieldPaths:e}}function LA(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nf{constructor(e,r,n,i,a=vr.min(),o=vr.min(),c=Ia.EMPTY_BYTE_STRING,u=null){this.target=e,this.targetId=r,this.purpose=n,this.sequenceNumber=i,this.snapshotVersion=a,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=c,this.expectedCount=u}withSequenceNumber(e){return new nf(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,r){return new nf(this.target,this.targetId,this.purpose,this.sequenceNumber,r,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new nf(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new nf(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RD{constructor(e){this.gt=e}}function LD(t){const e=AD({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?B_(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DD{constructor(){this.Dn=new FD}addToCollectionParentIndex(e,r){return this.Dn.add(r),gt.resolve()}getCollectionParents(e,r){return gt.resolve(this.Dn.getEntries(r))}addFieldIndex(e,r){return gt.resolve()}deleteFieldIndex(e,r){return gt.resolve()}deleteAllFieldIndexes(e){return gt.resolve()}createTargetIndexes(e,r){return gt.resolve()}getDocumentsMatchingTarget(e,r){return gt.resolve(null)}getIndexType(e,r){return gt.resolve(0)}getFieldIndexes(e,r){return gt.resolve([])}getNextCollectionGroupToUpdate(e){return gt.resolve(null)}getMinOffset(e,r){return gt.resolve(mf.min())}getMinOffsetFromCollectionGroup(e,r){return gt.resolve(mf.min())}updateCollectionGroup(e,r,n){return gt.resolve()}updateIndexEntries(e,r){return gt.resolve()}}class FD{constructor(){this.index={}}add(e){const r=e.lastSegment(),n=e.popLast(),i=this.index[r]||new Ji(Mn.comparator),a=!i.has(n);return this.index[r]=i.add(n),a}has(e){const r=e.lastSegment(),n=e.popLast(),i=this.index[r];return i&&i.has(n)}getEntries(e){return(this.index[e]||new Ji(Mn.comparator)).toArray()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const RE={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},DA=41943040;class Is{static withCacheSize(e){return new Is(e,Is.DEFAULT_COLLECTION_PERCENTILE,Is.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,r,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=r,this.maximumSequenceNumbersToCollect=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Is.DEFAULT_COLLECTION_PERCENTILE=10,Is.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Is.DEFAULT=new Is(DA,Is.DEFAULT_COLLECTION_PERCENTILE,Is.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Is.DISABLED=new Is(-1,0,0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class K0{constructor(e){this._r=e}next(){return this._r+=2,this._r}static ar(){return new K0(0)}static ur(){return new K0(-1)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const LE="LruGarbageCollector",OD=1048576;function DE([t,e],[r,n]){const i=Rr(t,r);return i===0?Rr(e,n):i}class PD{constructor(e){this.Tr=e,this.buffer=new Ji(DE),this.Ir=0}dr(){return++this.Ir}Er(e){const r=[e,this.dr()];if(this.buffer.size<this.Tr)this.buffer=this.buffer.add(r);else{const n=this.buffer.last();DE(r,n)<0&&(this.buffer=this.buffer.delete(n).add(r))}}get maxValue(){return this.buffer.last()[0]}}class MD{constructor(e,r,n){this.garbageCollector=e,this.asyncQueue=r,this.localStore=n,this.Ar=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Rr(6e4)}stop(){this.Ar&&(this.Ar.cancel(),this.Ar=null)}get started(){return this.Ar!==null}Rr(e){Ht(LE,`Garbage collection scheduled in ${e}ms`),this.Ar=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Ar=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(r){sd(r)?Ht(LE,"Ignoring IndexedDB error during garbage collection: ",r):await ad(r)}await this.Rr(3e5)})}}class BD{constructor(e,r){this.Vr=e,this.params=r}calculateTargetCount(e,r){return this.Vr.mr(e).next(n=>Math.floor(r/100*n))}nthSequenceNumber(e,r){if(r===0)return gt.resolve(Yg.ue);const n=new PD(r);return this.Vr.forEachTarget(e,i=>n.Er(i.sequenceNumber)).next(()=>this.Vr.gr(e,i=>n.Er(i))).next(()=>n.maxValue)}removeTargets(e,r,n){return this.Vr.removeTargets(e,r,n)}removeOrphanedDocuments(e,r){return this.Vr.removeOrphanedDocuments(e,r)}collect(e,r){return this.params.cacheSizeCollectionThreshold===-1?(Ht("LruGarbageCollector","Garbage collection skipped; disabled"),gt.resolve(RE)):this.getCacheSize(e).next(n=>n<this.params.cacheSizeCollectionThreshold?(Ht("LruGarbageCollector",`Garbage collection skipped; Cache size ${n} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),RE):this.pr(e,r))}getCacheSize(e){return this.Vr.getCacheSize(e)}pr(e,r){let n,i,a,o,c,u,h;const d=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(g=>(g>this.params.maximumSequenceNumbersToCollect?(Ht("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${g}`),i=this.params.maximumSequenceNumbersToCollect):i=g,o=Date.now(),this.nthSequenceNumber(e,i))).next(g=>(n=g,c=Date.now(),this.removeTargets(e,n,r))).next(g=>(a=g,u=Date.now(),this.removeOrphanedDocuments(e,n))).next(g=>(h=Date.now(),E0()<=Vr.DEBUG&&Ht("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-d}ms
	Determined least recently used ${i} in `+(c-o)+`ms
	Removed ${a} targets in `+(u-c)+`ms
	Removed ${g} documents in `+(h-u)+`ms
Total Duration: ${h-d}ms`),gt.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:a,documentsRemoved:g})))}}function jD(t,e){return new BD(t,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UD{constructor(){this.changes=new Lh(e=>e.toString(),(e,r)=>e.isEqual(r)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,r){this.assertNotApplied(),this.changes.set(e,Ja.newInvalidDocument(e).setReadTime(r))}getEntry(e,r){this.assertNotApplied();const n=this.changes.get(r);return n!==void 0?gt.resolve(n):this.getFromCache(e,r)}getEntries(e,r){return this.getAllFromCache(e,r)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VD{constructor(e,r){this.overlayedDocument=e,this.mutatedFields=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qD{constructor(e,r,n,i){this.remoteDocumentCache=e,this.mutationQueue=r,this.documentOverlayCache=n,this.indexManager=i}getDocument(e,r){let n=null;return this.documentOverlayCache.getOverlay(e,r).next(i=>(n=i,this.remoteDocumentCache.getEntry(e,r))).next(i=>(n!==null&&g1(n.mutation,i,ro.empty(),Un.now()),i))}getDocuments(e,r){return this.remoteDocumentCache.getEntries(e,r).next(n=>this.getLocalViewOfDocuments(e,n,qr()).next(()=>n))}getLocalViewOfDocuments(e,r,n=qr()){const i=ch();return this.populateOverlays(e,i,r).next(()=>this.computeViews(e,r,i,n).next(a=>{let o=a1();return a.forEach((c,u)=>{o=o.insert(c,u.overlayedDocument)}),o}))}getOverlayedDocuments(e,r){const n=ch();return this.populateOverlays(e,n,r).next(()=>this.computeViews(e,r,n,qr()))}populateOverlays(e,r,n){const i=[];return n.forEach(a=>{r.has(a)||i.push(a)}),this.documentOverlayCache.getOverlays(e,i).next(a=>{a.forEach((o,c)=>{r.set(o,c)})})}computeViews(e,r,n,i){let a=lu();const o=m1(),c=function(){return m1()}();return r.forEach((u,h)=>{const d=n.get(h.key);i.has(h.key)&&(d===void 0||d.mutation instanceof Lf)?a=a.insert(h.key,h):d!==void 0?(o.set(h.key,d.mutation.getFieldMask()),g1(d.mutation,h,d.mutation.getFieldMask(),Un.now())):o.set(h.key,ro.empty())}),this.recalculateAndSaveOverlays(e,a).next(u=>(u.forEach((h,d)=>o.set(h,d)),r.forEach((h,d)=>{var g;return c.set(h,new VD(d,(g=o.get(h))!==null&&g!==void 0?g:null))}),c))}recalculateAndSaveOverlays(e,r){const n=m1();let i=new ri((o,c)=>o-c),a=qr();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,r).next(o=>{for(const c of o)c.keys().forEach(u=>{const h=r.get(u);if(h===null)return;let d=n.get(u)||ro.empty();d=c.applyToLocalView(h,d),n.set(u,d);const g=(i.get(c.batchId)||qr()).add(u);i=i.insert(c.batchId,g)})}).next(()=>{const o=[],c=i.getReverseIterator();for(;c.hasNext();){const u=c.getNext(),h=u.key,d=u.value,g=mA();d.forEach(x=>{if(!a.has(x)){const _=wA(r.get(x),n.get(x));_!==null&&g.set(x,_),a=a.add(x)}}),o.push(this.documentOverlayCache.saveOverlays(e,h,g))}return gt.waitFor(o)}).next(()=>n)}recalculateAndSaveOverlaysForDocumentKeys(e,r){return this.remoteDocumentCache.getEntries(e,r).next(n=>this.recalculateAndSaveOverlays(e,n))}getDocumentsMatchingQuery(e,r,n,i){return function(o){return Jt.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(r)?this.getDocumentsMatchingDocumentQuery(e,r.path):uA(r)?this.getDocumentsMatchingCollectionGroupQuery(e,r,n,i):this.getDocumentsMatchingCollectionQuery(e,r,n,i)}getNextDocuments(e,r,n,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,r,n,i).next(a=>{const o=i-a.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,r,n.largestBatchId,i-a.size):gt.resolve(ch());let c=R1,u=a;return o.next(h=>gt.forEach(h,(d,g)=>(c<g.largestBatchId&&(c=g.largestBatchId),a.get(d)?gt.resolve():this.remoteDocumentCache.getEntry(e,d).next(x=>{u=u.insert(d,x)}))).next(()=>this.populateOverlays(e,h,a)).next(()=>this.computeViews(e,u,h,qr())).next(d=>({batchId:c,changes:pA(d)})))})}getDocumentsMatchingDocumentQuery(e,r){return this.getDocument(e,new Jt(r)).next(n=>{let i=a1();return n.isFoundDocument()&&(i=i.insert(n.key,n)),i})}getDocumentsMatchingCollectionGroupQuery(e,r,n,i){const a=r.collectionGroup;let o=a1();return this.indexManager.getCollectionParents(e,a).next(c=>gt.forEach(c,u=>{const h=function(g,x){return new sp(x,null,g.explicitOrderBy.slice(),g.filters.slice(),g.limit,g.limitType,g.startAt,g.endAt)}(r,u.child(a));return this.getDocumentsMatchingCollectionQuery(e,h,n,i).next(d=>{d.forEach((g,x)=>{o=o.insert(g,x)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,r,n,i){let a;return this.documentOverlayCache.getOverlaysForCollection(e,r.path,n.largestBatchId).next(o=>(a=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,r,n,a,i))).next(o=>{a.forEach((u,h)=>{const d=h.getKey();o.get(d)===null&&(o=o.insert(d,Ja.newInvalidDocument(d)))});let c=a1();return o.forEach((u,h)=>{const d=a.get(u);d!==void 0&&g1(d.mutation,h,ro.empty(),Un.now()),Jg(r,h)&&(c=c.insert(u,h))}),c})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zD{constructor(e){this.serializer=e,this.Br=new Map,this.Lr=new Map}getBundleMetadata(e,r){return gt.resolve(this.Br.get(r))}saveBundleMetadata(e,r){return this.Br.set(r.id,function(i){return{id:i.id,version:i.version,createTime:hc(i.createTime)}}(r)),gt.resolve()}getNamedQuery(e,r){return gt.resolve(this.Lr.get(r))}saveNamedQuery(e,r){return this.Lr.set(r.name,function(i){return{name:i.name,query:LD(i.bundledQuery),readTime:hc(i.readTime)}}(r)),gt.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HD{constructor(){this.overlays=new ri(Jt.comparator),this.kr=new Map}getOverlay(e,r){return gt.resolve(this.overlays.get(r))}getOverlays(e,r){const n=ch();return gt.forEach(r,i=>this.getOverlay(e,i).next(a=>{a!==null&&n.set(i,a)})).next(()=>n)}saveOverlays(e,r,n){return n.forEach((i,a)=>{this.wt(e,r,a)}),gt.resolve()}removeOverlaysForBatchId(e,r,n){const i=this.kr.get(n);return i!==void 0&&(i.forEach(a=>this.overlays=this.overlays.remove(a)),this.kr.delete(n)),gt.resolve()}getOverlaysForCollection(e,r,n){const i=ch(),a=r.length+1,o=new Jt(r.child("")),c=this.overlays.getIteratorFrom(o);for(;c.hasNext();){const u=c.getNext().value,h=u.getKey();if(!r.isPrefixOf(h.path))break;h.path.length===a&&u.largestBatchId>n&&i.set(u.getKey(),u)}return gt.resolve(i)}getOverlaysForCollectionGroup(e,r,n,i){let a=new ri((h,d)=>h-d);const o=this.overlays.getIterator();for(;o.hasNext();){const h=o.getNext().value;if(h.getKey().getCollectionGroup()===r&&h.largestBatchId>n){let d=a.get(h.largestBatchId);d===null&&(d=ch(),a=a.insert(h.largestBatchId,d)),d.set(h.getKey(),h)}}const c=ch(),u=a.getIterator();for(;u.hasNext()&&(u.getNext().value.forEach((h,d)=>c.set(h,d)),!(c.size()>=i)););return gt.resolve(c)}wt(e,r,n){const i=this.overlays.get(n.key);if(i!==null){const o=this.kr.get(i.largestBatchId).delete(n.key);this.kr.set(i.largestBatchId,o)}this.overlays=this.overlays.insert(n.key,new cD(r,n));let a=this.kr.get(r);a===void 0&&(a=qr(),this.kr.set(r,a)),this.kr.set(r,a.add(n.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GD{constructor(){this.sessionToken=Ia.EMPTY_BYTE_STRING}getSessionToken(e){return gt.resolve(this.sessionToken)}setSessionToken(e,r){return this.sessionToken=r,gt.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jx{constructor(){this.qr=new Ji(ua.Qr),this.$r=new Ji(ua.Ur)}isEmpty(){return this.qr.isEmpty()}addReference(e,r){const n=new ua(e,r);this.qr=this.qr.add(n),this.$r=this.$r.add(n)}Kr(e,r){e.forEach(n=>this.addReference(n,r))}removeReference(e,r){this.Wr(new ua(e,r))}Gr(e,r){e.forEach(n=>this.removeReference(n,r))}zr(e){const r=new Jt(new Mn([])),n=new ua(r,e),i=new ua(r,e+1),a=[];return this.$r.forEachInRange([n,i],o=>{this.Wr(o),a.push(o.key)}),a}jr(){this.qr.forEach(e=>this.Wr(e))}Wr(e){this.qr=this.qr.delete(e),this.$r=this.$r.delete(e)}Jr(e){const r=new Jt(new Mn([])),n=new ua(r,e),i=new ua(r,e+1);let a=qr();return this.$r.forEachInRange([n,i],o=>{a=a.add(o.key)}),a}containsKey(e){const r=new ua(e,0),n=this.qr.firstAfterOrEqual(r);return n!==null&&e.isEqual(n.key)}}class ua{constructor(e,r){this.key=e,this.Hr=r}static Qr(e,r){return Jt.comparator(e.key,r.key)||Rr(e.Hr,r.Hr)}static Ur(e,r){return Rr(e.Hr,r.Hr)||Jt.comparator(e.key,r.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WD{constructor(e,r){this.indexManager=e,this.referenceDelegate=r,this.mutationQueue=[],this.er=1,this.Yr=new Ji(ua.Qr)}checkEmpty(e){return gt.resolve(this.mutationQueue.length===0)}addMutationBatch(e,r,n,i){const a=this.er;this.er++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new lD(a,r,n,i);this.mutationQueue.push(o);for(const c of i)this.Yr=this.Yr.add(new ua(c.key,a)),this.indexManager.addToCollectionParentIndex(e,c.key.path.popLast());return gt.resolve(o)}lookupMutationBatch(e,r){return gt.resolve(this.Zr(r))}getNextMutationBatchAfterBatchId(e,r){const n=r+1,i=this.Xr(n),a=i<0?0:i;return gt.resolve(this.mutationQueue.length>a?this.mutationQueue[a]:null)}getHighestUnacknowledgedBatchId(){return gt.resolve(this.mutationQueue.length===0?Vx:this.er-1)}getAllMutationBatches(e){return gt.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,r){const n=new ua(r,0),i=new ua(r,Number.POSITIVE_INFINITY),a=[];return this.Yr.forEachInRange([n,i],o=>{const c=this.Zr(o.Hr);a.push(c)}),gt.resolve(a)}getAllMutationBatchesAffectingDocumentKeys(e,r){let n=new Ji(Rr);return r.forEach(i=>{const a=new ua(i,0),o=new ua(i,Number.POSITIVE_INFINITY);this.Yr.forEachInRange([a,o],c=>{n=n.add(c.Hr)})}),gt.resolve(this.ei(n))}getAllMutationBatchesAffectingQuery(e,r){const n=r.path,i=n.length+1;let a=n;Jt.isDocumentKey(a)||(a=a.child(""));const o=new ua(new Jt(a),0);let c=new Ji(Rr);return this.Yr.forEachWhile(u=>{const h=u.key.path;return!!n.isPrefixOf(h)&&(h.length===i&&(c=c.add(u.Hr)),!0)},o),gt.resolve(this.ei(c))}ei(e){const r=[];return e.forEach(n=>{const i=this.Zr(n);i!==null&&r.push(i)}),r}removeMutationBatch(e,r){mn(this.ti(r.batchId,"removed")===0,55003),this.mutationQueue.shift();let n=this.Yr;return gt.forEach(r.mutations,i=>{const a=new ua(i.key,r.batchId);return n=n.delete(a),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.Yr=n})}rr(e){}containsKey(e,r){const n=new ua(r,0),i=this.Yr.firstAfterOrEqual(n);return gt.resolve(r.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,gt.resolve()}ti(e,r){return this.Xr(e)}Xr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Zr(e){const r=this.Xr(e);return r<0||r>=this.mutationQueue.length?null:this.mutationQueue[r]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XD{constructor(e){this.ni=e,this.docs=function(){return new ri(Jt.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,r){const n=r.key,i=this.docs.get(n),a=i?i.size:0,o=this.ni(r);return this.docs=this.docs.insert(n,{document:r.mutableCopy(),size:o}),this.size+=o-a,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const r=this.docs.get(e);r&&(this.docs=this.docs.remove(e),this.size-=r.size)}getEntry(e,r){const n=this.docs.get(r);return gt.resolve(n?n.document.mutableCopy():Ja.newInvalidDocument(r))}getEntries(e,r){let n=lu();return r.forEach(i=>{const a=this.docs.get(i);n=n.insert(i,a?a.document.mutableCopy():Ja.newInvalidDocument(i))}),gt.resolve(n)}getDocumentsMatchingQuery(e,r,n,i){let a=lu();const o=r.path,c=new Jt(o.child("__id-9223372036854775808__")),u=this.docs.getIteratorFrom(c);for(;u.hasNext();){const{key:h,value:{document:d}}=u.getNext();if(!o.isPrefixOf(h.path))break;h.path.length>o.length+1||bL(EL(d),n)<=0||(i.has(d.key)||Jg(r,d))&&(a=a.insert(d.key,d.mutableCopy()))}return gt.resolve(a)}getAllFromCollectionGroup(e,r,n,i){hr(9500)}ri(e,r){return gt.forEach(this.docs,n=>r(n))}newChangeBuffer(e){return new YD(this)}getSize(e){return gt.resolve(this.size)}}class YD extends UD{constructor(e){super(),this.Or=e}applyChanges(e){const r=[];return this.changes.forEach((n,i)=>{i.isValidDocument()?r.push(this.Or.addEntry(e,i)):this.Or.removeEntry(n)}),gt.waitFor(r)}getFromCache(e,r){return this.Or.getEntry(e,r)}getAllFromCache(e,r){return this.Or.getEntries(e,r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KD{constructor(e){this.persistence=e,this.ii=new Lh(r=>Hx(r),Gx),this.lastRemoteSnapshotVersion=vr.min(),this.highestTargetId=0,this.si=0,this.oi=new Jx,this.targetCount=0,this._i=K0.ar()}forEachTarget(e,r){return this.ii.forEach((n,i)=>r(i)),gt.resolve()}getLastRemoteSnapshotVersion(e){return gt.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return gt.resolve(this.si)}allocateTargetId(e){return this.highestTargetId=this._i.next(),gt.resolve(this.highestTargetId)}setTargetsMetadata(e,r,n){return n&&(this.lastRemoteSnapshotVersion=n),r>this.si&&(this.si=r),gt.resolve()}hr(e){this.ii.set(e.target,e);const r=e.targetId;r>this.highestTargetId&&(this._i=new K0(r),this.highestTargetId=r),e.sequenceNumber>this.si&&(this.si=e.sequenceNumber)}addTargetData(e,r){return this.hr(r),this.targetCount+=1,gt.resolve()}updateTargetData(e,r){return this.hr(r),gt.resolve()}removeTargetData(e,r){return this.ii.delete(r.target),this.oi.zr(r.targetId),this.targetCount-=1,gt.resolve()}removeTargets(e,r,n){let i=0;const a=[];return this.ii.forEach((o,c)=>{c.sequenceNumber<=r&&n.get(c.targetId)===null&&(this.ii.delete(o),a.push(this.removeMatchingKeysForTargetId(e,c.targetId)),i++)}),gt.waitFor(a).next(()=>i)}getTargetCount(e){return gt.resolve(this.targetCount)}getTargetData(e,r){const n=this.ii.get(r)||null;return gt.resolve(n)}addMatchingKeys(e,r,n){return this.oi.Kr(r,n),gt.resolve()}removeMatchingKeys(e,r,n){this.oi.Gr(r,n);const i=this.persistence.referenceDelegate,a=[];return i&&r.forEach(o=>{a.push(i.markPotentiallyOrphaned(e,o))}),gt.waitFor(a)}removeMatchingKeysForTargetId(e,r){return this.oi.zr(r),gt.resolve()}getMatchingKeysForTargetId(e,r){const n=this.oi.Jr(r);return gt.resolve(n)}containsKey(e,r){return gt.resolve(this.oi.containsKey(r))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FA{constructor(e,r){this.ai={},this.overlays={},this.ui=new Yg(0),this.ci=!1,this.ci=!0,this.li=new GD,this.referenceDelegate=e(this),this.hi=new KD(this),this.indexManager=new DD,this.remoteDocumentCache=function(i){return new XD(i)}(n=>this.referenceDelegate.Pi(n)),this.serializer=new RD(r),this.Ti=new zD(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.ci=!1,Promise.resolve()}get started(){return this.ci}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let r=this.overlays[e.toKey()];return r||(r=new HD,this.overlays[e.toKey()]=r),r}getMutationQueue(e,r){let n=this.ai[e.toKey()];return n||(n=new WD(r,this.referenceDelegate),this.ai[e.toKey()]=n),n}getGlobalsCache(){return this.li}getTargetCache(){return this.hi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ti}runTransaction(e,r,n){Ht("MemoryPersistence","Starting transaction:",e);const i=new $D(this.ui.next());return this.referenceDelegate.Ii(),n(i).next(a=>this.referenceDelegate.di(i).next(()=>a)).toPromise().then(a=>(i.raiseOnCommittedEvent(),a))}Ei(e,r){return gt.or(Object.values(this.ai).map(n=>()=>n.containsKey(e,r)))}}class $D extends AL{constructor(e){super(),this.currentSequenceNumber=e}}class Zx{constructor(e){this.persistence=e,this.Ai=new Jx,this.Ri=null}static Vi(e){return new Zx(e)}get mi(){if(this.Ri)return this.Ri;throw hr(60996)}addReference(e,r,n){return this.Ai.addReference(n,r),this.mi.delete(n.toString()),gt.resolve()}removeReference(e,r,n){return this.Ai.removeReference(n,r),this.mi.add(n.toString()),gt.resolve()}markPotentiallyOrphaned(e,r){return this.mi.add(r.toString()),gt.resolve()}removeTarget(e,r){this.Ai.zr(r.targetId).forEach(i=>this.mi.add(i.toString()));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,r.targetId).next(i=>{i.forEach(a=>this.mi.add(a.toString()))}).next(()=>n.removeTargetData(e,r))}Ii(){this.Ri=new Set}di(e){const r=this.persistence.getRemoteDocumentCache().newChangeBuffer();return gt.forEach(this.mi,n=>{const i=Jt.fromPath(n);return this.fi(e,i).next(a=>{a||r.removeEntry(i,vr.min())})}).next(()=>(this.Ri=null,r.apply(e)))}updateLimboDocument(e,r){return this.fi(e,r).next(n=>{n?this.mi.delete(r.toString()):this.mi.add(r.toString())})}Pi(e){return 0}fi(e,r){return gt.or([()=>gt.resolve(this.Ai.containsKey(r)),()=>this.persistence.getTargetCache().containsKey(e,r),()=>this.persistence.Ei(e,r)])}}class wg{constructor(e,r){this.persistence=e,this.gi=new Lh(n=>NL(n.path),(n,i)=>n.isEqual(i)),this.garbageCollector=jD(this,r)}static Vi(e,r){return new wg(e,r)}Ii(){}di(e){return gt.resolve()}forEachTarget(e,r){return this.persistence.getTargetCache().forEachTarget(e,r)}mr(e){const r=this.yr(e);return this.persistence.getTargetCache().getTargetCount(e).next(n=>r.next(i=>n+i))}yr(e){let r=0;return this.gr(e,n=>{r++}).next(()=>r)}gr(e,r){return gt.forEach(this.gi,(n,i)=>this.Sr(e,n,i).next(a=>a?gt.resolve():r(i)))}removeTargets(e,r,n){return this.persistence.getTargetCache().removeTargets(e,r,n)}removeOrphanedDocuments(e,r){let n=0;const i=this.persistence.getRemoteDocumentCache(),a=i.newChangeBuffer();return i.ri(e,o=>this.Sr(e,o,r).next(c=>{c||(n++,a.removeEntry(o,vr.min()))})).next(()=>a.apply(e)).next(()=>n)}markPotentiallyOrphaned(e,r){return this.gi.set(r,e.currentSequenceNumber),gt.resolve()}removeTarget(e,r){const n=r.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,n)}addReference(e,r,n){return this.gi.set(n,e.currentSequenceNumber),gt.resolve()}removeReference(e,r,n){return this.gi.set(n,e.currentSequenceNumber),gt.resolve()}updateLimboDocument(e,r){return this.gi.set(r,e.currentSequenceNumber),gt.resolve()}Pi(e){let r=e.key.toString().length;return e.isFoundDocument()&&(r+=Gm(e.data.value)),r}Sr(e,r,n){return gt.or([()=>this.persistence.Ei(e,r),()=>this.persistence.getTargetCache().containsKey(e,r),()=>{const i=this.gi.get(r);return gt.resolve(i!==void 0&&i>n)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ey{constructor(e,r,n,i){this.targetId=e,this.fromCache=r,this.Is=n,this.ds=i}static Es(e,r){let n=qr(),i=qr();for(const a of r.docChanges)switch(a.type){case 0:n=n.add(a.doc.key);break;case 1:i=i.add(a.doc.key)}return new ey(e,r.fromCache,n,i)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QD{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JD{constructor(){this.As=!1,this.Rs=!1,this.Vs=100,this.fs=function(){return LC()?8:TL(ns())>0?6:4}()}initialize(e,r){this.gs=e,this.indexManager=r,this.As=!0}getDocumentsMatchingQuery(e,r,n,i){const a={result:null};return this.ps(e,r).next(o=>{a.result=o}).next(()=>{if(!a.result)return this.ys(e,r,i,n).next(o=>{a.result=o})}).next(()=>{if(a.result)return;const o=new QD;return this.ws(e,r,o).next(c=>{if(a.result=c,this.Rs)return this.Ss(e,r,o,c.size)})}).next(()=>a.result)}Ss(e,r,n,i){return n.documentReadCount<this.Vs?(E0()<=Vr.DEBUG&&Ht("QueryEngine","SDK will not create cache indexes for query:",b0(r),"since it only creates cache indexes for collection contains","more than or equal to",this.Vs,"documents"),gt.resolve()):(E0()<=Vr.DEBUG&&Ht("QueryEngine","Query:",b0(r),"scans",n.documentReadCount,"local documents and returns",i,"documents as results."),n.documentReadCount>this.fs*i?(E0()<=Vr.DEBUG&&Ht("QueryEngine","The SDK decides to create cache indexes for query:",b0(r),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,fc(r))):gt.resolve())}ps(e,r){if(wE(r))return gt.resolve(null);let n=fc(r);return this.indexManager.getIndexType(e,n).next(i=>i===0?null:(r.limit!==null&&i===1&&(r=B_(r,null,"F"),n=fc(r)),this.indexManager.getDocumentsMatchingTarget(e,n).next(a=>{const o=qr(...a);return this.gs.getDocuments(e,o).next(c=>this.indexManager.getMinOffset(e,n).next(u=>{const h=this.bs(r,c);return this.Ds(r,h,o,u.readTime)?this.ps(e,B_(r,null,"F")):this.vs(e,h,r,u)}))})))}ys(e,r,n,i){return wE(r)||i.isEqual(vr.min())?gt.resolve(null):this.gs.getDocuments(e,n).next(a=>{const o=this.bs(r,a);return this.Ds(r,o,n,i)?gt.resolve(null):(E0()<=Vr.DEBUG&&Ht("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),b0(r)),this.vs(e,o,r,wL(i,R1)).next(c=>c))})}bs(e,r){let n=new Ji(hA(e));return r.forEach((i,a)=>{Jg(e,a)&&(n=n.add(a))}),n}Ds(e,r,n,i){if(e.limit===null)return!1;if(n.size!==r.size)return!0;const a=e.limitType==="F"?r.last():r.first();return!!a&&(a.hasPendingWrites||a.version.compareTo(i)>0)}ws(e,r,n){return E0()<=Vr.DEBUG&&Ht("QueryEngine","Using full collection scan to execute query:",b0(r)),this.gs.getDocumentsMatchingQuery(e,r,mf.min(),n)}vs(e,r,n,i){return this.gs.getDocumentsMatchingQuery(e,n,i).next(a=>(r.forEach(o=>{a=a.insert(o.key,o)}),a))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ty="LocalStore",ZD=3e8;class eF{constructor(e,r,n,i){this.persistence=e,this.Cs=r,this.serializer=i,this.Fs=new ri(Rr),this.Ms=new Lh(a=>Hx(a),Gx),this.xs=new Map,this.Os=e.getRemoteDocumentCache(),this.hi=e.getTargetCache(),this.Ti=e.getBundleCache(),this.Ns(n)}Ns(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new qD(this.Os,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Os.setIndexManager(this.indexManager),this.Cs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",r=>e.collect(r,this.Fs))}}function tF(t,e,r,n){return new eF(t,e,r,n)}async function OA(t,e){const r=xr(t);return await r.persistence.runTransaction("Handle user change","readonly",n=>{let i;return r.mutationQueue.getAllMutationBatches(n).next(a=>(i=a,r.Ns(e),r.mutationQueue.getAllMutationBatches(n))).next(a=>{const o=[],c=[];let u=qr();for(const h of i){o.push(h.batchId);for(const d of h.mutations)u=u.add(d.key)}for(const h of a){c.push(h.batchId);for(const d of h.mutations)u=u.add(d.key)}return r.localDocuments.getDocuments(n,u).next(h=>({Bs:h,removedBatchIds:o,addedBatchIds:c}))})})}function rF(t,e){const r=xr(t);return r.persistence.runTransaction("Acknowledge batch","readwrite-primary",n=>{const i=e.batch.keys(),a=r.Os.newChangeBuffer({trackRemovals:!0});return function(c,u,h,d){const g=h.batch,x=g.keys();let _=gt.resolve();return x.forEach(b=>{_=_.next(()=>d.getEntry(u,b)).next(E=>{const A=h.docVersions.get(b);mn(A!==null,48541),E.version.compareTo(A)<0&&(g.applyToRemoteDocument(E,h),E.isValidDocument()&&(E.setReadTime(h.commitVersion),d.addEntry(E)))})}),_.next(()=>c.mutationQueue.removeMutationBatch(u,g))}(r,n,e,a).next(()=>a.apply(n)).next(()=>r.mutationQueue.performConsistencyCheck(n)).next(()=>r.documentOverlayCache.removeOverlaysForBatchId(n,i,e.batch.batchId)).next(()=>r.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(n,function(c){let u=qr();for(let h=0;h<c.mutationResults.length;++h)c.mutationResults[h].transformResults.length>0&&(u=u.add(c.batch.mutations[h].key));return u}(e))).next(()=>r.localDocuments.getDocuments(n,i))})}function PA(t){const e=xr(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",r=>e.hi.getLastRemoteSnapshotVersion(r))}function nF(t,e){const r=xr(t),n=e.snapshotVersion;let i=r.Fs;return r.persistence.runTransaction("Apply remote event","readwrite-primary",a=>{const o=r.Os.newChangeBuffer({trackRemovals:!0});i=r.Fs;const c=[];e.targetChanges.forEach((d,g)=>{const x=i.get(g);if(!x)return;c.push(r.hi.removeMatchingKeys(a,d.removedDocuments,g).next(()=>r.hi.addMatchingKeys(a,d.addedDocuments,g)));let _=x.withSequenceNumber(a.currentSequenceNumber);e.targetMismatches.get(g)!==null?_=_.withResumeToken(Ia.EMPTY_BYTE_STRING,vr.min()).withLastLimboFreeSnapshotVersion(vr.min()):d.resumeToken.approximateByteSize()>0&&(_=_.withResumeToken(d.resumeToken,n)),i=i.insert(g,_),function(E,A,O){return E.resumeToken.approximateByteSize()===0||A.snapshotVersion.toMicroseconds()-E.snapshotVersion.toMicroseconds()>=ZD?!0:O.addedDocuments.size+O.modifiedDocuments.size+O.removedDocuments.size>0}(x,_,d)&&c.push(r.hi.updateTargetData(a,_))});let u=lu(),h=qr();if(e.documentUpdates.forEach(d=>{e.resolvedLimboDocuments.has(d)&&c.push(r.persistence.referenceDelegate.updateLimboDocument(a,d))}),c.push(iF(a,o,e.documentUpdates).next(d=>{u=d.Ls,h=d.ks})),!n.isEqual(vr.min())){const d=r.hi.getLastRemoteSnapshotVersion(a).next(g=>r.hi.setTargetsMetadata(a,a.currentSequenceNumber,n));c.push(d)}return gt.waitFor(c).next(()=>o.apply(a)).next(()=>r.localDocuments.getLocalViewOfDocuments(a,u,h)).next(()=>u)}).then(a=>(r.Fs=i,a))}function iF(t,e,r){let n=qr(),i=qr();return r.forEach(a=>n=n.add(a)),e.getEntries(t,n).next(a=>{let o=lu();return r.forEach((c,u)=>{const h=a.get(c);u.isFoundDocument()!==h.isFoundDocument()&&(i=i.add(c)),u.isNoDocument()&&u.version.isEqual(vr.min())?(e.removeEntry(c,u.readTime),o=o.insert(c,u)):!h.isValidDocument()||u.version.compareTo(h.version)>0||u.version.compareTo(h.version)===0&&h.hasPendingWrites?(e.addEntry(u),o=o.insert(c,u)):Ht(ty,"Ignoring outdated watch update for ",c,". Current version:",h.version," Watch version:",u.version)}),{Ls:o,ks:i}})}function aF(t,e){const r=xr(t);return r.persistence.runTransaction("Get next mutation batch","readonly",n=>(e===void 0&&(e=Vx),r.mutationQueue.getNextMutationBatchAfterBatchId(n,e)))}function sF(t,e){const r=xr(t);return r.persistence.runTransaction("Allocate target","readwrite",n=>{let i;return r.hi.getTargetData(n,e).next(a=>a?(i=a,gt.resolve(i)):r.hi.allocateTargetId(n).next(o=>(i=new nf(e,o,"TargetPurposeListen",n.currentSequenceNumber),r.hi.addTargetData(n,i).next(()=>i))))}).then(n=>{const i=r.Fs.get(n.targetId);return(i===null||n.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(r.Fs=r.Fs.insert(n.targetId,n),r.Ms.set(e,n.targetId)),n})}async function z_(t,e,r){const n=xr(t),i=n.Fs.get(e),a=r?"readwrite":"readwrite-primary";try{r||await n.persistence.runTransaction("Release target",a,o=>n.persistence.referenceDelegate.removeTarget(o,i))}catch(o){if(!sd(o))throw o;Ht(ty,`Failed to update sequence numbers for target ${e}: ${o}`)}n.Fs=n.Fs.remove(e),n.Ms.delete(i.target)}function FE(t,e,r){const n=xr(t);let i=vr.min(),a=qr();return n.persistence.runTransaction("Execute query","readwrite",o=>function(u,h,d){const g=xr(u),x=g.Ms.get(d);return x!==void 0?gt.resolve(g.Fs.get(x)):g.hi.getTargetData(h,d)}(n,o,fc(e)).next(c=>{if(c)return i=c.lastLimboFreeSnapshotVersion,n.hi.getMatchingKeysForTargetId(o,c.targetId).next(u=>{a=u})}).next(()=>n.Cs.getDocumentsMatchingQuery(o,e,r?i:vr.min(),r?a:qr())).next(c=>(oF(n,XL(e),c),{documents:c,qs:a})))}function oF(t,e,r){let n=t.xs.get(e)||vr.min();r.forEach((i,a)=>{a.readTime.compareTo(n)>0&&(n=a.readTime)}),t.xs.set(e,n)}class OE{constructor(){this.activeTargetIds=ZL()}Gs(e){this.activeTargetIds=this.activeTargetIds.add(e)}zs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Ws(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class lF{constructor(){this.Fo=new OE,this.Mo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,r,n){}addLocalQueryTarget(e,r=!0){return r&&this.Fo.Gs(e),this.Mo[e]||"not-current"}updateQueryState(e,r,n){this.Mo[e]=r}removeLocalQueryTarget(e){this.Fo.zs(e)}isLocalQueryTarget(e){return this.Fo.activeTargetIds.has(e)}clearQueryState(e){delete this.Mo[e]}getAllActiveQueryTargets(){return this.Fo.activeTargetIds}isActiveQueryTarget(e){return this.Fo.activeTargetIds.has(e)}start(){return this.Fo=new OE,Promise.resolve()}handleUserChange(e,r,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cF{xo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const PE="ConnectivityMonitor";class ME{constructor(){this.Oo=()=>this.No(),this.Bo=()=>this.Lo(),this.ko=[],this.qo()}xo(e){this.ko.push(e)}shutdown(){window.removeEventListener("online",this.Oo),window.removeEventListener("offline",this.Bo)}qo(){window.addEventListener("online",this.Oo),window.addEventListener("offline",this.Bo)}No(){Ht(PE,"Network connectivity changed: AVAILABLE");for(const e of this.ko)e(0)}Lo(){Ht(PE,"Network connectivity changed: UNAVAILABLE");for(const e of this.ko)e(1)}static C(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let bm=null;function H_(){return bm===null?bm=function(){return 268435456+Math.round(2147483648*Math.random())}():bm++,"0x"+bm.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Gv="RestConnection",uF={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class fF{get Qo(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const r=e.ssl?"https":"http",n=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.$o=r+"://"+e.host,this.Uo=`projects/${n}/databases/${i}`,this.Ko=this.databaseId.database===pg?`project_id=${n}`:`project_id=${n}&database_id=${i}`}Wo(e,r,n,i,a){const o=H_(),c=this.Go(e,r.toUriEncodedString());Ht(Gv,`Sending RPC '${e}' ${o}:`,c,n);const u={"google-cloud-resource-prefix":this.Uo,"x-goog-request-params":this.Ko};this.zo(u,i,a);const{host:h}=new URL(c),d=td(h);return this.jo(e,c,u,n,d).then(g=>(Ht(Gv,`Received RPC '${e}' ${o}: `,g),g),g=>{throw pf(Gv,`RPC '${e}' ${o} failed with error: `,g,"url: ",c,"request:",n),g})}Jo(e,r,n,i,a,o){return this.Wo(e,r,n,i,a)}zo(e,r,n){e["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+id}(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((i,a)=>e[a]=i),n&&n.headers.forEach((i,a)=>e[a]=i)}Go(e,r){const n=uF[e];return`${this.$o}/v1/${r}:${n}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hF{constructor(e){this.Ho=e.Ho,this.Yo=e.Yo}Zo(e){this.Xo=e}e_(e){this.t_=e}n_(e){this.r_=e}onMessage(e){this.i_=e}close(){this.Yo()}send(e){this.Ho(e)}s_(){this.Xo()}o_(){this.t_()}__(e){this.r_(e)}a_(e){this.i_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const za="WebChannelConnection";class dF extends fF{constructor(e){super(e),this.u_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}jo(e,r,n,i,a){const o=H_();return new Promise((c,u)=>{const h=new BS;h.setWithCredentials(!0),h.listenOnce(jS.COMPLETE,()=>{try{switch(h.getLastErrorCode()){case Hm.NO_ERROR:const g=h.getResponseJson();Ht(za,`XHR for RPC '${e}' ${o} received:`,JSON.stringify(g)),c(g);break;case Hm.TIMEOUT:Ht(za,`RPC '${e}' ${o} timed out`),u(new Vt(dt.DEADLINE_EXCEEDED,"Request time out"));break;case Hm.HTTP_ERROR:const x=h.getStatus();if(Ht(za,`RPC '${e}' ${o} failed with status:`,x,"response text:",h.getResponseText()),x>0){let _=h.getResponseJson();Array.isArray(_)&&(_=_[0]);const b=_?.error;if(b&&b.status&&b.message){const E=function(O){const M=O.toLowerCase().replace(/_/g,"-");return Object.values(dt).indexOf(M)>=0?M:dt.UNKNOWN}(b.status);u(new Vt(E,b.message))}else u(new Vt(dt.UNKNOWN,"Server responded with status "+h.getStatus()))}else u(new Vt(dt.UNAVAILABLE,"Connection failed."));break;default:hr(9055,{c_:e,streamId:o,l_:h.getLastErrorCode(),h_:h.getLastError()})}}finally{Ht(za,`RPC '${e}' ${o} completed.`)}});const d=JSON.stringify(i);Ht(za,`RPC '${e}' ${o} sending request:`,i),h.send(r,"POST",d,n,15)})}P_(e,r,n){const i=H_(),a=[this.$o,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=qS(),c=VS(),u={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},h=this.longPollingOptions.timeoutSeconds;h!==void 0&&(u.longPollingTimeout=Math.round(1e3*h)),this.useFetchStreams&&(u.useFetchStreams=!0),this.zo(u.initMessageHeaders,r,n),u.encodeInitMessageHeaders=!0;const d=a.join("");Ht(za,`Creating RPC '${e}' stream ${i}: ${d}`,u);const g=o.createWebChannel(d,u);this.T_(g);let x=!1,_=!1;const b=new hF({Ho:A=>{_?Ht(za,`Not sending because RPC '${e}' stream ${i} is closed:`,A):(x||(Ht(za,`Opening RPC '${e}' stream ${i} transport.`),g.open(),x=!0),Ht(za,`RPC '${e}' stream ${i} sending:`,A),g.send(A))},Yo:()=>g.close()}),E=(A,O,M)=>{A.listen(O,B=>{try{M(B)}catch(Q){setTimeout(()=>{throw Q},0)}})};return E(g,i1.EventType.OPEN,()=>{_||(Ht(za,`RPC '${e}' stream ${i} transport opened.`),b.s_())}),E(g,i1.EventType.CLOSE,()=>{_||(_=!0,Ht(za,`RPC '${e}' stream ${i} transport closed`),b.__(),this.I_(g))}),E(g,i1.EventType.ERROR,A=>{_||(_=!0,pf(za,`RPC '${e}' stream ${i} transport errored. Name:`,A.name,"Message:",A.message),b.__(new Vt(dt.UNAVAILABLE,"The operation could not be completed")))}),E(g,i1.EventType.MESSAGE,A=>{var O;if(!_){const M=A.data[0];mn(!!M,16349);const B=M,Q=B?.error||((O=B[0])===null||O===void 0?void 0:O.error);if(Q){Ht(za,`RPC '${e}' stream ${i} received error:`,Q);const ee=Q.status;let he=function(S){const U=Bi[S];if(U!==void 0)return bA(U)}(ee),F=Q.message;he===void 0&&(he=dt.INTERNAL,F="Unknown error status: "+ee+" with message "+Q.message),_=!0,b.__(new Vt(he,F)),g.close()}else Ht(za,`RPC '${e}' stream ${i} received:`,M),b.a_(M)}}),E(c,US.STAT_EVENT,A=>{A.stat===R_.PROXY?Ht(za,`RPC '${e}' stream ${i} detected buffering proxy`):A.stat===R_.NOPROXY&&Ht(za,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{b.o_()},0),b}terminate(){this.u_.forEach(e=>e.close()),this.u_=[]}T_(e){this.u_.push(e)}I_(e){this.u_=this.u_.filter(r=>r===e)}}function Wv(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function r2(t){return new vD(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MA{constructor(e,r,n=1e3,i=1.5,a=6e4){this.Fi=e,this.timerId=r,this.d_=n,this.E_=i,this.A_=a,this.R_=0,this.V_=null,this.m_=Date.now(),this.reset()}reset(){this.R_=0}f_(){this.R_=this.A_}g_(e){this.cancel();const r=Math.floor(this.R_+this.p_()),n=Math.max(0,Date.now()-this.m_),i=Math.max(0,r-n);i>0&&Ht("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.R_} ms, delay with jitter: ${r} ms, last attempt: ${n} ms ago)`),this.V_=this.Fi.enqueueAfterDelay(this.timerId,i,()=>(this.m_=Date.now(),e())),this.R_*=this.E_,this.R_<this.d_&&(this.R_=this.d_),this.R_>this.A_&&(this.R_=this.A_)}y_(){this.V_!==null&&(this.V_.skipDelay(),this.V_=null)}cancel(){this.V_!==null&&(this.V_.cancel(),this.V_=null)}p_(){return(Math.random()-.5)*this.R_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const BE="PersistentStream";class BA{constructor(e,r,n,i,a,o,c,u){this.Fi=e,this.w_=n,this.S_=i,this.connection=a,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=c,this.listener=u,this.state=0,this.b_=0,this.D_=null,this.v_=null,this.stream=null,this.C_=0,this.F_=new MA(e,r)}M_(){return this.state===1||this.state===5||this.x_()}x_(){return this.state===2||this.state===3}start(){this.C_=0,this.state!==4?this.auth():this.O_()}async stop(){this.M_()&&await this.close(0)}N_(){this.state=0,this.F_.reset()}B_(){this.x_()&&this.D_===null&&(this.D_=this.Fi.enqueueAfterDelay(this.w_,6e4,()=>this.L_()))}k_(e){this.q_(),this.stream.send(e)}async L_(){if(this.x_())return this.close(0)}q_(){this.D_&&(this.D_.cancel(),this.D_=null)}Q_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,r){this.q_(),this.Q_(),this.F_.cancel(),this.b_++,e!==4?this.F_.reset():r&&r.code===dt.RESOURCE_EXHAUSTED?(ou(r.toString()),ou("Using maximum backoff delay to prevent overloading the backend."),this.F_.f_()):r&&r.code===dt.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.U_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.n_(r)}U_(){}auth(){this.state=1;const e=this.K_(this.b_),r=this.b_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([n,i])=>{this.b_===r&&this.W_(n,i)},n=>{e(()=>{const i=new Vt(dt.UNKNOWN,"Fetching auth token failed: "+n.message);return this.G_(i)})})}W_(e,r){const n=this.K_(this.b_);this.stream=this.z_(e,r),this.stream.Zo(()=>{n(()=>this.listener.Zo())}),this.stream.e_(()=>{n(()=>(this.state=2,this.v_=this.Fi.enqueueAfterDelay(this.S_,1e4,()=>(this.x_()&&(this.state=3),Promise.resolve())),this.listener.e_()))}),this.stream.n_(i=>{n(()=>this.G_(i))}),this.stream.onMessage(i=>{n(()=>++this.C_==1?this.j_(i):this.onNext(i))})}O_(){this.state=5,this.F_.g_(async()=>{this.state=0,this.start()})}G_(e){return Ht(BE,`close with error: ${e}`),this.stream=null,this.close(4,e)}K_(e){return r=>{this.Fi.enqueueAndForget(()=>this.b_===e?r():(Ht(BE,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class pF extends BA{constructor(e,r,n,i,a,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",r,n,i,o),this.serializer=a}z_(e,r){return this.connection.P_("Listen",e,r)}j_(e){return this.onNext(e)}onNext(e){this.F_.reset();const r=yD(this.serializer,e),n=function(a){if(!("targetChange"in a))return vr.min();const o=a.targetChange;return o.targetIds&&o.targetIds.length?vr.min():o.readTime?hc(o.readTime):vr.min()}(e);return this.listener.J_(r,n)}H_(e){const r={};r.database=q_(this.serializer),r.addTarget=function(a,o){let c;const u=o.target;if(c=P_(u)?{documents:bD(a,u)}:{query:SD(a,u).Vt},c.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){c.resumeToken=TA(a,o.resumeToken);const h=j_(a,o.expectedCount);h!==null&&(c.expectedCount=h)}else if(o.snapshotVersion.compareTo(vr.min())>0){c.readTime=yg(a,o.snapshotVersion.toTimestamp());const h=j_(a,o.expectedCount);h!==null&&(c.expectedCount=h)}return c}(this.serializer,e);const n=TD(this.serializer,e);n&&(r.labels=n),this.k_(r)}Y_(e){const r={};r.database=q_(this.serializer),r.removeTarget=e,this.k_(r)}}class mF extends BA{constructor(e,r,n,i,a,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",r,n,i,o),this.serializer=a}get Z_(){return this.C_>0}start(){this.lastStreamToken=void 0,super.start()}U_(){this.Z_&&this.X_([])}z_(e,r){return this.connection.P_("Write",e,r)}j_(e){return mn(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,mn(!e.writeResults||e.writeResults.length===0,55816),this.listener.ea()}onNext(e){mn(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.F_.reset();const r=ED(e.writeResults,e.commitTime),n=hc(e.commitTime);return this.listener.ta(n,r)}na(){const e={};e.database=q_(this.serializer),this.k_(e)}X_(e){const r={streamToken:this.lastStreamToken,writes:e.map(n=>wD(this.serializer,n))};this.k_(r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gF{}class vF extends gF{constructor(e,r,n,i){super(),this.authCredentials=e,this.appCheckCredentials=r,this.connection=n,this.serializer=i,this.ra=!1}ia(){if(this.ra)throw new Vt(dt.FAILED_PRECONDITION,"The client has already been terminated.")}Wo(e,r,n,i){return this.ia(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([a,o])=>this.connection.Wo(e,U_(r,n),i,a,o)).catch(a=>{throw a.name==="FirebaseError"?(a.code===dt.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new Vt(dt.UNKNOWN,a.toString())})}Jo(e,r,n,i,a){return this.ia(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,c])=>this.connection.Jo(e,U_(r,n),i,o,c,a)).catch(o=>{throw o.name==="FirebaseError"?(o.code===dt.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new Vt(dt.UNKNOWN,o.toString())})}terminate(){this.ra=!0,this.connection.terminate()}}class _F{constructor(e,r){this.asyncQueue=e,this.onlineStateHandler=r,this.state="Unknown",this.sa=0,this.oa=null,this._a=!0}aa(){this.sa===0&&(this.ua("Unknown"),this.oa=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.oa=null,this.ca("Backend didn't respond within 10 seconds."),this.ua("Offline"),Promise.resolve())))}la(e){this.state==="Online"?this.ua("Unknown"):(this.sa++,this.sa>=1&&(this.ha(),this.ca(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ua("Offline")))}set(e){this.ha(),this.sa=0,e==="Online"&&(this._a=!1),this.ua(e)}ua(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}ca(e){const r=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this._a?(ou(r),this._a=!1):Ht("OnlineStateTracker",r)}ha(){this.oa!==null&&(this.oa.cancel(),this.oa=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bh="RemoteStore";class xF{constructor(e,r,n,i,a){this.localStore=e,this.datastore=r,this.asyncQueue=n,this.remoteSyncer={},this.Pa=[],this.Ta=new Map,this.Ia=new Set,this.da=[],this.Ea=a,this.Ea.xo(o=>{n.enqueueAndForget(async()=>{Dh(this)&&(Ht(bh,"Restarting streams for network reachability change."),await async function(u){const h=xr(u);h.Ia.add(4),await cp(h),h.Aa.set("Unknown"),h.Ia.delete(4),await n2(h)}(this))})}),this.Aa=new _F(n,i)}}async function n2(t){if(Dh(t))for(const e of t.da)await e(!0)}async function cp(t){for(const e of t.da)await e(!1)}function jA(t,e){const r=xr(t);r.Ta.has(e.targetId)||(r.Ta.set(e.targetId,e),ay(r)?iy(r):od(r).x_()&&ny(r,e))}function ry(t,e){const r=xr(t),n=od(r);r.Ta.delete(e),n.x_()&&UA(r,e),r.Ta.size===0&&(n.x_()?n.B_():Dh(r)&&r.Aa.set("Unknown"))}function ny(t,e){if(t.Ra.$e(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(vr.min())>0){const r=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(r)}od(t).H_(e)}function UA(t,e){t.Ra.$e(e),od(t).Y_(e)}function iy(t){t.Ra=new dD({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),Et:e=>t.Ta.get(e)||null,lt:()=>t.datastore.serializer.databaseId}),od(t).start(),t.Aa.aa()}function ay(t){return Dh(t)&&!od(t).M_()&&t.Ta.size>0}function Dh(t){return xr(t).Ia.size===0}function VA(t){t.Ra=void 0}async function yF(t){t.Aa.set("Online")}async function wF(t){t.Ta.forEach((e,r)=>{ny(t,e)})}async function EF(t,e){VA(t),ay(t)?(t.Aa.la(e),iy(t)):t.Aa.set("Unknown")}async function bF(t,e,r){if(t.Aa.set("Online"),e instanceof AA&&e.state===2&&e.cause)try{await async function(i,a){const o=a.cause;for(const c of a.targetIds)i.Ta.has(c)&&(await i.remoteSyncer.rejectListen(c,o),i.Ta.delete(c),i.Ra.removeTarget(c))}(t,e)}catch(n){Ht(bh,"Failed to remove targets %s: %s ",e.targetIds.join(","),n),await Eg(t,n)}else if(e instanceof Ym?t.Ra.Ye(e):e instanceof SA?t.Ra.it(e):t.Ra.et(e),!r.isEqual(vr.min()))try{const n=await PA(t.localStore);r.compareTo(n)>=0&&await function(a,o){const c=a.Ra.Pt(o);return c.targetChanges.forEach((u,h)=>{if(u.resumeToken.approximateByteSize()>0){const d=a.Ta.get(h);d&&a.Ta.set(h,d.withResumeToken(u.resumeToken,o))}}),c.targetMismatches.forEach((u,h)=>{const d=a.Ta.get(u);if(!d)return;a.Ta.set(u,d.withResumeToken(Ia.EMPTY_BYTE_STRING,d.snapshotVersion)),UA(a,u);const g=new nf(d.target,u,h,d.sequenceNumber);ny(a,g)}),a.remoteSyncer.applyRemoteEvent(c)}(t,r)}catch(n){Ht(bh,"Failed to raise snapshot:",n),await Eg(t,n)}}async function Eg(t,e,r){if(!sd(e))throw e;t.Ia.add(1),await cp(t),t.Aa.set("Offline"),r||(r=()=>PA(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{Ht(bh,"Retrying IndexedDB access"),await r(),t.Ia.delete(1),await n2(t)})}function qA(t,e){return e().catch(r=>Eg(t,r,e))}async function i2(t){const e=xr(t),r=xf(e);let n=e.Pa.length>0?e.Pa[e.Pa.length-1].batchId:Vx;for(;SF(e);)try{const i=await aF(e.localStore,n);if(i===null){e.Pa.length===0&&r.B_();break}n=i.batchId,AF(e,i)}catch(i){await Eg(e,i)}zA(e)&&HA(e)}function SF(t){return Dh(t)&&t.Pa.length<10}function AF(t,e){t.Pa.push(e);const r=xf(t);r.x_()&&r.Z_&&r.X_(e.mutations)}function zA(t){return Dh(t)&&!xf(t).M_()&&t.Pa.length>0}function HA(t){xf(t).start()}async function TF(t){xf(t).na()}async function kF(t){const e=xf(t);for(const r of t.Pa)e.X_(r.mutations)}async function NF(t,e,r){const n=t.Pa.shift(),i=Kx.from(n,e,r);await qA(t,()=>t.remoteSyncer.applySuccessfulWrite(i)),await i2(t)}async function CF(t,e){e&&xf(t).Z_&&await async function(n,i){if(function(o){return fD(o)&&o!==dt.ABORTED}(i.code)){const a=n.Pa.shift();xf(n).N_(),await qA(n,()=>n.remoteSyncer.rejectFailedWrite(a.batchId,i)),await i2(n)}}(t,e),zA(t)&&HA(t)}async function jE(t,e){const r=xr(t);r.asyncQueue.verifyOperationInProgress(),Ht(bh,"RemoteStore received new credentials");const n=Dh(r);r.Ia.add(3),await cp(r),n&&r.Aa.set("Unknown"),await r.remoteSyncer.handleCredentialChange(e),r.Ia.delete(3),await n2(r)}async function IF(t,e){const r=xr(t);e?(r.Ia.delete(2),await n2(r)):e||(r.Ia.add(2),await cp(r),r.Aa.set("Unknown"))}function od(t){return t.Va||(t.Va=function(r,n,i){const a=xr(r);return a.ia(),new pF(n,a.connection,a.authCredentials,a.appCheckCredentials,a.serializer,i)}(t.datastore,t.asyncQueue,{Zo:yF.bind(null,t),e_:wF.bind(null,t),n_:EF.bind(null,t),J_:bF.bind(null,t)}),t.da.push(async e=>{e?(t.Va.N_(),ay(t)?iy(t):t.Aa.set("Unknown")):(await t.Va.stop(),VA(t))})),t.Va}function xf(t){return t.ma||(t.ma=function(r,n,i){const a=xr(r);return a.ia(),new mF(n,a.connection,a.authCredentials,a.appCheckCredentials,a.serializer,i)}(t.datastore,t.asyncQueue,{Zo:()=>Promise.resolve(),e_:TF.bind(null,t),n_:CF.bind(null,t),ea:kF.bind(null,t),ta:NF.bind(null,t)}),t.da.push(async e=>{e?(t.ma.N_(),await i2(t)):(await t.ma.stop(),t.Pa.length>0&&(Ht(bh,`Stopping write stream with ${t.Pa.length} pending writes`),t.Pa=[]))})),t.ma}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sy{constructor(e,r,n,i,a){this.asyncQueue=e,this.timerId=r,this.targetTimeMs=n,this.op=i,this.removalCallback=a,this.deferred=new tu,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,r,n,i,a){const o=Date.now()+n,c=new sy(e,r,o,i,a);return c.start(n),c}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new Vt(dt.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function oy(t,e){if(ou("AsyncQueue",`${e}: ${t}`),sd(t))return new Vt(dt.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class O0{static emptySet(e){return new O0(e.comparator)}constructor(e){this.comparator=e?(r,n)=>e(r,n)||Jt.comparator(r.key,n.key):(r,n)=>Jt.comparator(r.key,n.key),this.keyedMap=a1(),this.sortedSet=new ri(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const r=this.keyedMap.get(e);return r?this.sortedSet.indexOf(r):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((r,n)=>(e(r),!1))}add(e){const r=this.delete(e.key);return r.copy(r.keyedMap.insert(e.key,e),r.sortedSet.insert(e,null))}delete(e){const r=this.get(e);return r?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(r)):this}isEqual(e){if(!(e instanceof O0)||this.size!==e.size)return!1;const r=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;r.hasNext();){const i=r.getNext().key,a=n.getNext().key;if(!i.isEqual(a))return!1}return!0}toString(){const e=[];return this.forEach(r=>{e.push(r.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,r){const n=new O0;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=r,n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UE{constructor(){this.fa=new ri(Jt.comparator)}track(e){const r=e.doc.key,n=this.fa.get(r);n?e.type!==0&&n.type===3?this.fa=this.fa.insert(r,e):e.type===3&&n.type!==1?this.fa=this.fa.insert(r,{type:n.type,doc:e.doc}):e.type===2&&n.type===2?this.fa=this.fa.insert(r,{type:2,doc:e.doc}):e.type===2&&n.type===0?this.fa=this.fa.insert(r,{type:0,doc:e.doc}):e.type===1&&n.type===0?this.fa=this.fa.remove(r):e.type===1&&n.type===2?this.fa=this.fa.insert(r,{type:1,doc:n.doc}):e.type===0&&n.type===1?this.fa=this.fa.insert(r,{type:2,doc:e.doc}):hr(63341,{At:e,ga:n}):this.fa=this.fa.insert(r,e)}pa(){const e=[];return this.fa.inorderTraversal((r,n)=>{e.push(n)}),e}}class $0{constructor(e,r,n,i,a,o,c,u,h){this.query=e,this.docs=r,this.oldDocs=n,this.docChanges=i,this.mutatedKeys=a,this.fromCache=o,this.syncStateChanged=c,this.excludesMetadataChanges=u,this.hasCachedResults=h}static fromInitialDocuments(e,r,n,i,a){const o=[];return r.forEach(c=>{o.push({type:0,doc:c})}),new $0(e,r,O0.emptySet(r),o,n,i,!0,!1,a)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Qg(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const r=this.docChanges,n=e.docChanges;if(r.length!==n.length)return!1;for(let i=0;i<r.length;i++)if(r[i].type!==n[i].type||!r[i].doc.isEqual(n[i].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RF{constructor(){this.ya=void 0,this.wa=[]}Sa(){return this.wa.some(e=>e.ba())}}class LF{constructor(){this.queries=VE(),this.onlineState="Unknown",this.Da=new Set}terminate(){(function(r,n){const i=xr(r),a=i.queries;i.queries=VE(),a.forEach((o,c)=>{for(const u of c.wa)u.onError(n)})})(this,new Vt(dt.ABORTED,"Firestore shutting down"))}}function VE(){return new Lh(t=>fA(t),Qg)}async function GA(t,e){const r=xr(t);let n=3;const i=e.query;let a=r.queries.get(i);a?!a.Sa()&&e.ba()&&(n=2):(a=new RF,n=e.ba()?0:1);try{switch(n){case 0:a.ya=await r.onListen(i,!0);break;case 1:a.ya=await r.onListen(i,!1);break;case 2:await r.onFirstRemoteStoreListen(i)}}catch(o){const c=oy(o,`Initialization of query '${b0(e.query)}' failed`);return void e.onError(c)}r.queries.set(i,a),a.wa.push(e),e.va(r.onlineState),a.ya&&e.Ca(a.ya)&&ly(r)}async function WA(t,e){const r=xr(t),n=e.query;let i=3;const a=r.queries.get(n);if(a){const o=a.wa.indexOf(e);o>=0&&(a.wa.splice(o,1),a.wa.length===0?i=e.ba()?0:1:!a.Sa()&&e.ba()&&(i=2))}switch(i){case 0:return r.queries.delete(n),r.onUnlisten(n,!0);case 1:return r.queries.delete(n),r.onUnlisten(n,!1);case 2:return r.onLastRemoteStoreUnlisten(n);default:return}}function DF(t,e){const r=xr(t);let n=!1;for(const i of e){const a=i.query,o=r.queries.get(a);if(o){for(const c of o.wa)c.Ca(i)&&(n=!0);o.ya=i}}n&&ly(r)}function FF(t,e,r){const n=xr(t),i=n.queries.get(e);if(i)for(const a of i.wa)a.onError(r);n.queries.delete(e)}function ly(t){t.Da.forEach(e=>{e.next()})}var G_,qE;(qE=G_||(G_={})).Fa="default",qE.Cache="cache";class XA{constructor(e,r,n){this.query=e,this.Ma=r,this.xa=!1,this.Oa=null,this.onlineState="Unknown",this.options=n||{}}Ca(e){if(!this.options.includeMetadataChanges){const n=[];for(const i of e.docChanges)i.type!==3&&n.push(i);e=new $0(e.query,e.docs,e.oldDocs,n,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let r=!1;return this.xa?this.Na(e)&&(this.Ma.next(e),r=!0):this.Ba(e,this.onlineState)&&(this.La(e),r=!0),this.Oa=e,r}onError(e){this.Ma.error(e)}va(e){this.onlineState=e;let r=!1;return this.Oa&&!this.xa&&this.Ba(this.Oa,e)&&(this.La(this.Oa),r=!0),r}Ba(e,r){if(!e.fromCache||!this.ba())return!0;const n=r!=="Offline";return(!this.options.ka||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||r==="Offline")}Na(e){if(e.docChanges.length>0)return!0;const r=this.Oa&&this.Oa.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!r)&&this.options.includeMetadataChanges===!0}La(e){e=$0.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.xa=!0,this.Ma.next(e)}ba(){return this.options.source!==G_.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YA{constructor(e){this.key=e}}class KA{constructor(e){this.key=e}}class OF{constructor(e,r){this.query=e,this.Ha=r,this.Ya=null,this.hasCachedResults=!1,this.current=!1,this.Za=qr(),this.mutatedKeys=qr(),this.Xa=hA(e),this.eu=new O0(this.Xa)}get tu(){return this.Ha}nu(e,r){const n=r?r.ru:new UE,i=r?r.eu:this.eu;let a=r?r.mutatedKeys:this.mutatedKeys,o=i,c=!1;const u=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,h=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((d,g)=>{const x=i.get(d),_=Jg(this.query,g)?g:null,b=!!x&&this.mutatedKeys.has(x.key),E=!!_&&(_.hasLocalMutations||this.mutatedKeys.has(_.key)&&_.hasCommittedMutations);let A=!1;x&&_?x.data.isEqual(_.data)?b!==E&&(n.track({type:3,doc:_}),A=!0):this.iu(x,_)||(n.track({type:2,doc:_}),A=!0,(u&&this.Xa(_,u)>0||h&&this.Xa(_,h)<0)&&(c=!0)):!x&&_?(n.track({type:0,doc:_}),A=!0):x&&!_&&(n.track({type:1,doc:x}),A=!0,(u||h)&&(c=!0)),A&&(_?(o=o.add(_),a=E?a.add(d):a.delete(d)):(o=o.delete(d),a=a.delete(d)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const d=this.query.limitType==="F"?o.last():o.first();o=o.delete(d.key),a=a.delete(d.key),n.track({type:1,doc:d})}return{eu:o,ru:n,Ds:c,mutatedKeys:a}}iu(e,r){return e.hasLocalMutations&&r.hasCommittedMutations&&!r.hasLocalMutations}applyChanges(e,r,n,i){const a=this.eu;this.eu=e.eu,this.mutatedKeys=e.mutatedKeys;const o=e.ru.pa();o.sort((d,g)=>function(_,b){const E=A=>{switch(A){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return hr(20277,{At:A})}};return E(_)-E(b)}(d.type,g.type)||this.Xa(d.doc,g.doc)),this.su(n),i=i!=null&&i;const c=r&&!i?this.ou():[],u=this.Za.size===0&&this.current&&!i?1:0,h=u!==this.Ya;return this.Ya=u,o.length!==0||h?{snapshot:new $0(this.query,e.eu,a,o,e.mutatedKeys,u===0,h,!1,!!n&&n.resumeToken.approximateByteSize()>0),_u:c}:{_u:c}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({eu:this.eu,ru:new UE,mutatedKeys:this.mutatedKeys,Ds:!1},!1)):{_u:[]}}au(e){return!this.Ha.has(e)&&!!this.eu.has(e)&&!this.eu.get(e).hasLocalMutations}su(e){e&&(e.addedDocuments.forEach(r=>this.Ha=this.Ha.add(r)),e.modifiedDocuments.forEach(r=>{}),e.removedDocuments.forEach(r=>this.Ha=this.Ha.delete(r)),this.current=e.current)}ou(){if(!this.current)return[];const e=this.Za;this.Za=qr(),this.eu.forEach(n=>{this.au(n.key)&&(this.Za=this.Za.add(n.key))});const r=[];return e.forEach(n=>{this.Za.has(n)||r.push(new KA(n))}),this.Za.forEach(n=>{e.has(n)||r.push(new YA(n))}),r}uu(e){this.Ha=e.qs,this.Za=qr();const r=this.nu(e.documents);return this.applyChanges(r,!0)}cu(){return $0.fromInitialDocuments(this.query,this.eu,this.mutatedKeys,this.Ya===0,this.hasCachedResults)}}const cy="SyncEngine";class PF{constructor(e,r,n){this.query=e,this.targetId=r,this.view=n}}class MF{constructor(e){this.key=e,this.lu=!1}}class BF{constructor(e,r,n,i,a,o){this.localStore=e,this.remoteStore=r,this.eventManager=n,this.sharedClientState=i,this.currentUser=a,this.maxConcurrentLimboResolutions=o,this.hu={},this.Pu=new Lh(c=>fA(c),Qg),this.Tu=new Map,this.Iu=new Set,this.du=new ri(Jt.comparator),this.Eu=new Map,this.Au=new Jx,this.Ru={},this.Vu=new Map,this.mu=K0.ur(),this.onlineState="Unknown",this.fu=void 0}get isPrimaryClient(){return this.fu===!0}}async function jF(t,e,r=!0){const n=tT(t);let i;const a=n.Pu.get(e);return a?(n.sharedClientState.addLocalQueryTarget(a.targetId),i=a.view.cu()):i=await $A(n,e,r,!0),i}async function UF(t,e){const r=tT(t);await $A(r,e,!0,!1)}async function $A(t,e,r,n){const i=await sF(t.localStore,fc(e)),a=i.targetId,o=t.sharedClientState.addLocalQueryTarget(a,r);let c;return n&&(c=await VF(t,e,a,o==="current",i.resumeToken)),t.isPrimaryClient&&r&&jA(t.remoteStore,i),c}async function VF(t,e,r,n,i){t.gu=(g,x,_)=>async function(E,A,O,M){let B=A.view.nu(O);B.Ds&&(B=await FE(E.localStore,A.query,!1).then(({documents:F})=>A.view.nu(F,B)));const Q=M&&M.targetChanges.get(A.targetId),ee=M&&M.targetMismatches.get(A.targetId)!=null,he=A.view.applyChanges(B,E.isPrimaryClient,Q,ee);return HE(E,A.targetId,he._u),he.snapshot}(t,g,x,_);const a=await FE(t.localStore,e,!0),o=new OF(e,a.qs),c=o.nu(a.documents),u=lp.createSynthesizedTargetChangeForCurrentChange(r,n&&t.onlineState!=="Offline",i),h=o.applyChanges(c,t.isPrimaryClient,u);HE(t,r,h._u);const d=new PF(e,r,o);return t.Pu.set(e,d),t.Tu.has(r)?t.Tu.get(r).push(e):t.Tu.set(r,[e]),h.snapshot}async function qF(t,e,r){const n=xr(t),i=n.Pu.get(e),a=n.Tu.get(i.targetId);if(a.length>1)return n.Tu.set(i.targetId,a.filter(o=>!Qg(o,e))),void n.Pu.delete(e);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(i.targetId),n.sharedClientState.isActiveQueryTarget(i.targetId)||await z_(n.localStore,i.targetId,!1).then(()=>{n.sharedClientState.clearQueryState(i.targetId),r&&ry(n.remoteStore,i.targetId),W_(n,i.targetId)}).catch(ad)):(W_(n,i.targetId),await z_(n.localStore,i.targetId,!0))}async function zF(t,e){const r=xr(t),n=r.Pu.get(e),i=r.Tu.get(n.targetId);r.isPrimaryClient&&i.length===1&&(r.sharedClientState.removeLocalQueryTarget(n.targetId),ry(r.remoteStore,n.targetId))}async function HF(t,e,r){const n=QF(t);try{const i=await function(o,c){const u=xr(o),h=Un.now(),d=c.reduce((_,b)=>_.add(b.key),qr());let g,x;return u.persistence.runTransaction("Locally write mutations","readwrite",_=>{let b=lu(),E=qr();return u.Os.getEntries(_,d).next(A=>{b=A,b.forEach((O,M)=>{M.isValidDocument()||(E=E.add(O))})}).next(()=>u.localDocuments.getOverlayedDocuments(_,b)).next(A=>{g=A;const O=[];for(const M of c){const B=sD(M,g.get(M.key).overlayedDocument);B!=null&&O.push(new Lf(M.key,B,nA(B.value.mapValue),jo.exists(!0)))}return u.mutationQueue.addMutationBatch(_,h,O,c)}).next(A=>{x=A;const O=A.applyToLocalDocumentSet(g,E);return u.documentOverlayCache.saveOverlays(_,A.batchId,O)})}).then(()=>({batchId:x.batchId,changes:pA(g)}))}(n.localStore,e);n.sharedClientState.addPendingMutation(i.batchId),function(o,c,u){let h=o.Ru[o.currentUser.toKey()];h||(h=new ri(Rr)),h=h.insert(c,u),o.Ru[o.currentUser.toKey()]=h}(n,i.batchId,r),await up(n,i.changes),await i2(n.remoteStore)}catch(i){const a=oy(i,"Failed to persist write");r.reject(a)}}async function QA(t,e){const r=xr(t);try{const n=await nF(r.localStore,e);e.targetChanges.forEach((i,a)=>{const o=r.Eu.get(a);o&&(mn(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1,22616),i.addedDocuments.size>0?o.lu=!0:i.modifiedDocuments.size>0?mn(o.lu,14607):i.removedDocuments.size>0&&(mn(o.lu,42227),o.lu=!1))}),await up(r,n,e)}catch(n){await ad(n)}}function zE(t,e,r){const n=xr(t);if(n.isPrimaryClient&&r===0||!n.isPrimaryClient&&r===1){const i=[];n.Pu.forEach((a,o)=>{const c=o.view.va(e);c.snapshot&&i.push(c.snapshot)}),function(o,c){const u=xr(o);u.onlineState=c;let h=!1;u.queries.forEach((d,g)=>{for(const x of g.wa)x.va(c)&&(h=!0)}),h&&ly(u)}(n.eventManager,e),i.length&&n.hu.J_(i),n.onlineState=e,n.isPrimaryClient&&n.sharedClientState.setOnlineState(e)}}async function GF(t,e,r){const n=xr(t);n.sharedClientState.updateQueryState(e,"rejected",r);const i=n.Eu.get(e),a=i&&i.key;if(a){let o=new ri(Jt.comparator);o=o.insert(a,Ja.newNoDocument(a,vr.min()));const c=qr().add(a),u=new t2(vr.min(),new Map,new ri(Rr),o,c);await QA(n,u),n.du=n.du.remove(a),n.Eu.delete(e),uy(n)}else await z_(n.localStore,e,!1).then(()=>W_(n,e,r)).catch(ad)}async function WF(t,e){const r=xr(t),n=e.batch.batchId;try{const i=await rF(r.localStore,e);ZA(r,n,null),JA(r,n),r.sharedClientState.updateMutationState(n,"acknowledged"),await up(r,i)}catch(i){await ad(i)}}async function XF(t,e,r){const n=xr(t);try{const i=await function(o,c){const u=xr(o);return u.persistence.runTransaction("Reject batch","readwrite-primary",h=>{let d;return u.mutationQueue.lookupMutationBatch(h,c).next(g=>(mn(g!==null,37113),d=g.keys(),u.mutationQueue.removeMutationBatch(h,g))).next(()=>u.mutationQueue.performConsistencyCheck(h)).next(()=>u.documentOverlayCache.removeOverlaysForBatchId(h,d,c)).next(()=>u.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(h,d)).next(()=>u.localDocuments.getDocuments(h,d))})}(n.localStore,e);ZA(n,e,r),JA(n,e),n.sharedClientState.updateMutationState(e,"rejected",r),await up(n,i)}catch(i){await ad(i)}}function JA(t,e){(t.Vu.get(e)||[]).forEach(r=>{r.resolve()}),t.Vu.delete(e)}function ZA(t,e,r){const n=xr(t);let i=n.Ru[n.currentUser.toKey()];if(i){const a=i.get(e);a&&(r?a.reject(r):a.resolve(),i=i.remove(e)),n.Ru[n.currentUser.toKey()]=i}}function W_(t,e,r=null){t.sharedClientState.removeLocalQueryTarget(e);for(const n of t.Tu.get(e))t.Pu.delete(n),r&&t.hu.pu(n,r);t.Tu.delete(e),t.isPrimaryClient&&t.Au.zr(e).forEach(n=>{t.Au.containsKey(n)||eT(t,n)})}function eT(t,e){t.Iu.delete(e.path.canonicalString());const r=t.du.get(e);r!==null&&(ry(t.remoteStore,r),t.du=t.du.remove(e),t.Eu.delete(r),uy(t))}function HE(t,e,r){for(const n of r)n instanceof YA?(t.Au.addReference(n.key,e),YF(t,n)):n instanceof KA?(Ht(cy,"Document no longer in limbo: "+n.key),t.Au.removeReference(n.key,e),t.Au.containsKey(n.key)||eT(t,n.key)):hr(19791,{yu:n})}function YF(t,e){const r=e.key,n=r.path.canonicalString();t.du.get(r)||t.Iu.has(n)||(Ht(cy,"New document in limbo: "+r),t.Iu.add(n),uy(t))}function uy(t){for(;t.Iu.size>0&&t.du.size<t.maxConcurrentLimboResolutions;){const e=t.Iu.values().next().value;t.Iu.delete(e);const r=new Jt(Mn.fromString(e)),n=t.mu.next();t.Eu.set(n,new MF(r)),t.du=t.du.insert(r,n),jA(t.remoteStore,new nf(fc(Wx(r.path)),n,"TargetPurposeLimboResolution",Yg.ue))}}async function up(t,e,r){const n=xr(t),i=[],a=[],o=[];n.Pu.isEmpty()||(n.Pu.forEach((c,u)=>{o.push(n.gu(u,e,r).then(h=>{var d;if((h||r)&&n.isPrimaryClient){const g=h?!h.fromCache:(d=r?.targetChanges.get(u.targetId))===null||d===void 0?void 0:d.current;n.sharedClientState.updateQueryState(u.targetId,g?"current":"not-current")}if(h){i.push(h);const g=ey.Es(u.targetId,h);a.push(g)}}))}),await Promise.all(o),n.hu.J_(i),await async function(u,h){const d=xr(u);try{await d.persistence.runTransaction("notifyLocalViewChanges","readwrite",g=>gt.forEach(h,x=>gt.forEach(x.Is,_=>d.persistence.referenceDelegate.addReference(g,x.targetId,_)).next(()=>gt.forEach(x.ds,_=>d.persistence.referenceDelegate.removeReference(g,x.targetId,_)))))}catch(g){if(!sd(g))throw g;Ht(ty,"Failed to update sequence numbers: "+g)}for(const g of h){const x=g.targetId;if(!g.fromCache){const _=d.Fs.get(x),b=_.snapshotVersion,E=_.withLastLimboFreeSnapshotVersion(b);d.Fs=d.Fs.insert(x,E)}}}(n.localStore,a))}async function KF(t,e){const r=xr(t);if(!r.currentUser.isEqual(e)){Ht(cy,"User change. New user:",e.toKey());const n=await OA(r.localStore,e);r.currentUser=e,function(a,o){a.Vu.forEach(c=>{c.forEach(u=>{u.reject(new Vt(dt.CANCELLED,o))})}),a.Vu.clear()}(r,"'waitForPendingWrites' promise is rejected due to a user change."),r.sharedClientState.handleUserChange(e,n.removedBatchIds,n.addedBatchIds),await up(r,n.Bs)}}function $F(t,e){const r=xr(t),n=r.Eu.get(e);if(n&&n.lu)return qr().add(n.key);{let i=qr();const a=r.Tu.get(e);if(!a)return i;for(const o of a){const c=r.Pu.get(o);i=i.unionWith(c.view.tu)}return i}}function tT(t){const e=xr(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=QA.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=$F.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=GF.bind(null,e),e.hu.J_=DF.bind(null,e.eventManager),e.hu.pu=FF.bind(null,e.eventManager),e}function QF(t){const e=xr(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=WF.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=XF.bind(null,e),e}class bg{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=r2(e.databaseInfo.databaseId),this.sharedClientState=this.bu(e),this.persistence=this.Du(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Cu(e,this.localStore),this.indexBackfillerScheduler=this.Fu(e,this.localStore)}Cu(e,r){return null}Fu(e,r){return null}vu(e){return tF(this.persistence,new JD,e.initialUser,this.serializer)}Du(e){return new FA(Zx.Vi,this.serializer)}bu(e){return new lF}async terminate(){var e,r;(e=this.gcScheduler)===null||e===void 0||e.stop(),(r=this.indexBackfillerScheduler)===null||r===void 0||r.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}bg.provider={build:()=>new bg};class JF extends bg{constructor(e){super(),this.cacheSizeBytes=e}Cu(e,r){mn(this.persistence.referenceDelegate instanceof wg,46915);const n=this.persistence.referenceDelegate.garbageCollector;return new MD(n,e.asyncQueue,r)}Du(e){const r=this.cacheSizeBytes!==void 0?Is.withCacheSize(this.cacheSizeBytes):Is.DEFAULT;return new FA(n=>wg.Vi(n,r),this.serializer)}}class X_{async initialize(e,r){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(r),this.remoteStore=this.createRemoteStore(r),this.eventManager=this.createEventManager(r),this.syncEngine=this.createSyncEngine(r,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=n=>zE(this.syncEngine,n,1),this.remoteStore.remoteSyncer.handleCredentialChange=KF.bind(null,this.syncEngine),await IF(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new LF}()}createDatastore(e){const r=r2(e.databaseInfo.databaseId),n=function(a){return new dF(a)}(e.databaseInfo);return function(a,o,c,u){return new vF(a,o,c,u)}(e.authCredentials,e.appCheckCredentials,n,r)}createRemoteStore(e){return function(n,i,a,o,c){return new xF(n,i,a,o,c)}(this.localStore,this.datastore,e.asyncQueue,r=>zE(this.syncEngine,r,0),function(){return ME.C()?new ME:new cF}())}createSyncEngine(e,r){return function(i,a,o,c,u,h,d){const g=new BF(i,a,o,c,u,h);return d&&(g.fu=!0),g}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,r)}async terminate(){var e,r;await async function(i){const a=xr(i);Ht(bh,"RemoteStore shutting down."),a.Ia.add(5),await cp(a),a.Ea.shutdown(),a.Aa.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(r=this.eventManager)===null||r===void 0||r.terminate()}}X_.provider={build:()=>new X_};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rT{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.xu(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.xu(this.observer.error,e):ou("Uncaught Error in snapshot listener:",e.toString()))}Ou(){this.muted=!0}xu(e,r){setTimeout(()=>{this.muted||e(r)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yf="FirestoreClient";class ZF{constructor(e,r,n,i,a){this.authCredentials=e,this.appCheckCredentials=r,this.asyncQueue=n,this.databaseInfo=i,this.user=Ka.UNAUTHENTICATED,this.clientId=Ux.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=a,this.authCredentials.start(n,async o=>{Ht(yf,"Received user=",o.uid),await this.authCredentialListener(o),this.user=o}),this.appCheckCredentials.start(n,o=>(Ht(yf,"Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new tu;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(r){const n=oy(r,"Failed to shutdown persistence");e.reject(n)}}),e.promise}}async function Xv(t,e){t.asyncQueue.verifyOperationInProgress(),Ht(yf,"Initializing OfflineComponentProvider");const r=t.configuration;await e.initialize(r);let n=r.initialUser;t.setCredentialChangeListener(async i=>{n.isEqual(i)||(await OA(e.localStore,i),n=i)}),e.persistence.setDatabaseDeletedListener(()=>{pf("Terminating Firestore due to IndexedDb database deletion"),t.terminate().then(()=>{Ht("Terminating Firestore due to IndexedDb database deletion completed successfully")}).catch(i=>{pf("Terminating Firestore due to IndexedDb database deletion failed",i)})}),t._offlineComponents=e}async function GE(t,e){t.asyncQueue.verifyOperationInProgress();const r=await eO(t);Ht(yf,"Initializing OnlineComponentProvider"),await e.initialize(r,t.configuration),t.setCredentialChangeListener(n=>jE(e.remoteStore,n)),t.setAppCheckTokenChangeListener((n,i)=>jE(e.remoteStore,i)),t._onlineComponents=e}async function eO(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){Ht(yf,"Using user provided OfflineComponentProvider");try{await Xv(t,t._uninitializedComponentsProvider._offline)}catch(e){const r=e;if(!function(i){return i.name==="FirebaseError"?i.code===dt.FAILED_PRECONDITION||i.code===dt.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11}(r))throw r;pf("Error using user provided cache. Falling back to memory cache: "+r),await Xv(t,new bg)}}else Ht(yf,"Using default OfflineComponentProvider"),await Xv(t,new JF(void 0));return t._offlineComponents}async function nT(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(Ht(yf,"Using user provided OnlineComponentProvider"),await GE(t,t._uninitializedComponentsProvider._online)):(Ht(yf,"Using default OnlineComponentProvider"),await GE(t,new X_))),t._onlineComponents}function tO(t){return nT(t).then(e=>e.syncEngine)}async function iT(t){const e=await nT(t),r=e.eventManager;return r.onListen=jF.bind(null,e.syncEngine),r.onUnlisten=qF.bind(null,e.syncEngine),r.onFirstRemoteStoreListen=UF.bind(null,e.syncEngine),r.onLastRemoteStoreUnlisten=zF.bind(null,e.syncEngine),r}function rO(t,e,r={}){const n=new tu;return t.asyncQueue.enqueueAndForget(async()=>function(a,o,c,u,h){const d=new rT({next:x=>{d.Ou(),o.enqueueAndForget(()=>WA(a,g));const _=x.docs.has(c);!_&&x.fromCache?h.reject(new Vt(dt.UNAVAILABLE,"Failed to get document because the client is offline.")):_&&x.fromCache&&u&&u.source==="server"?h.reject(new Vt(dt.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):h.resolve(x)},error:x=>h.reject(x)}),g=new XA(Wx(c.path),d,{includeMetadataChanges:!0,ka:!0});return GA(a,g)}(await iT(t),t.asyncQueue,e,r,n)),n.promise}function nO(t,e,r={}){const n=new tu;return t.asyncQueue.enqueueAndForget(async()=>function(a,o,c,u,h){const d=new rT({next:x=>{d.Ou(),o.enqueueAndForget(()=>WA(a,g)),x.fromCache&&u.source==="server"?h.reject(new Vt(dt.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):h.resolve(x)},error:x=>h.reject(x)}),g=new XA(c,d,{includeMetadataChanges:!0,ka:!0});return GA(a,g)}(await iT(t),t.asyncQueue,e,r,n)),n.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function aT(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WE=new Map;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sT="firestore.googleapis.com",XE=!0;class YE{constructor(e){var r,n;if(e.host===void 0){if(e.ssl!==void 0)throw new Vt(dt.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=sT,this.ssl=XE}else this.host=e.host,this.ssl=(r=e.ssl)!==null&&r!==void 0?r:XE;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=DA;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<OD)throw new Vt(dt.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}yL("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=aT((n=e.experimentalLongPollingOptions)!==null&&n!==void 0?n:{}),function(a){if(a.timeoutSeconds!==void 0){if(isNaN(a.timeoutSeconds))throw new Vt(dt.INVALID_ARGUMENT,`invalid long polling timeout: ${a.timeoutSeconds} (must not be NaN)`);if(a.timeoutSeconds<5)throw new Vt(dt.INVALID_ARGUMENT,`invalid long polling timeout: ${a.timeoutSeconds} (minimum allowed value is 5)`);if(a.timeoutSeconds>30)throw new Vt(dt.INVALID_ARGUMENT,`invalid long polling timeout: ${a.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(n,i){return n.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class a2{constructor(e,r,n,i){this._authCredentials=e,this._appCheckCredentials=r,this._databaseId=n,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new YE({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new Vt(dt.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new Vt(dt.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new YE(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=function(n){if(!n)return new fL;switch(n.type){case"firstParty":return new mL(n.sessionIndex||"0",n.iamToken||null,n.authTokenFactory||null);case"provider":return n.client;default:throw new Vt(dt.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(r){const n=WE.get(r);n&&(Ht("ComponentProvider","Removing Datastore"),WE.delete(r),n.terminate())}(this),Promise.resolve()}}function iO(t,e,r,n={}){var i;t=El(t,a2);const a=td(e),o=t._getSettings(),c=Object.assign(Object.assign({},o),{emulatorOptions:t._getEmulatorOptions()}),u=`${e}:${r}`;a&&(Kb(`https://${u}`),$b("Firestore",!0)),o.host!==sT&&o.host!==u&&pf("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const h=Object.assign(Object.assign({},o),{host:u,ssl:a,emulatorOptions:n});if(!_h(h,c)&&(t._setSettings(h),n.mockUserToken)){let d,g;if(typeof n.mockUserToken=="string")d=n.mockUserToken,g=Ka.MOCK_USER;else{d=bC(n.mockUserToken,(i=t._app)===null||i===void 0?void 0:i.options.projectId);const x=n.mockUserToken.sub||n.mockUserToken.user_id;if(!x)throw new Vt(dt.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");g=new Ka(x)}t._authCredentials=new hL(new HS(d,g))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ld{constructor(e,r,n){this.converter=r,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new ld(this.firestore,e,this._query)}}class Ti{constructor(e,r,n){this.converter=r,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new df(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Ti(this.firestore,e,this._key)}toJSON(){return{type:Ti._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,r,n){if(ap(r,Ti._jsonSchema))return new Ti(e,n||null,new Jt(Mn.fromString(r.referencePath)))}}Ti._jsonSchemaVersion="firestore/documentReference/1.0",Ti._jsonSchema={type:zi("string",Ti._jsonSchemaVersion),referencePath:zi("string")};class df extends ld{constructor(e,r,n){super(e,r,Wx(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Ti(this.firestore,null,new Jt(e))}withConverter(e){return new df(this.firestore,e,this._path)}}function Vi(t,e,...r){if(t=ma(t),WS("collection","path",e),t instanceof a2){const n=Mn.fromString(e,...r);return oE(n),new df(t,null,n)}{if(!(t instanceof Ti||t instanceof df))throw new Vt(dt.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=t._path.child(Mn.fromString(e,...r));return oE(n),new df(t.firestore,null,n)}}function no(t,e,...r){if(t=ma(t),arguments.length===1&&(e=Ux.newId()),WS("doc","path",e),t instanceof a2){const n=Mn.fromString(e,...r);return sE(n),new Ti(t,null,new Jt(n))}{if(!(t instanceof Ti||t instanceof df))throw new Vt(dt.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=t._path.child(Mn.fromString(e,...r));return sE(n),new Ti(t.firestore,t instanceof df?t.converter:null,new Jt(n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const KE="AsyncQueue";class $E{constructor(e=Promise.resolve()){this.Zu=[],this.Xu=!1,this.ec=[],this.tc=null,this.nc=!1,this.rc=!1,this.sc=[],this.F_=new MA(this,"async_queue_retry"),this.oc=()=>{const n=Wv();n&&Ht(KE,"Visibility state changed to "+n.visibilityState),this.F_.y_()},this._c=e;const r=Wv();r&&typeof r.addEventListener=="function"&&r.addEventListener("visibilitychange",this.oc)}get isShuttingDown(){return this.Xu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.ac(),this.uc(e)}enterRestrictedMode(e){if(!this.Xu){this.Xu=!0,this.rc=e||!1;const r=Wv();r&&typeof r.removeEventListener=="function"&&r.removeEventListener("visibilitychange",this.oc)}}enqueue(e){if(this.ac(),this.Xu)return new Promise(()=>{});const r=new tu;return this.uc(()=>this.Xu&&this.rc?Promise.resolve():(e().then(r.resolve,r.reject),r.promise)).then(()=>r.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Zu.push(e),this.cc()))}async cc(){if(this.Zu.length!==0){try{await this.Zu[0](),this.Zu.shift(),this.F_.reset()}catch(e){if(!sd(e))throw e;Ht(KE,"Operation failed with retryable error: "+e)}this.Zu.length>0&&this.F_.g_(()=>this.cc())}}uc(e){const r=this._c.then(()=>(this.nc=!0,e().catch(n=>{throw this.tc=n,this.nc=!1,ou("INTERNAL UNHANDLED ERROR: ",QE(n)),n}).then(n=>(this.nc=!1,n))));return this._c=r,r}enqueueAfterDelay(e,r,n){this.ac(),this.sc.indexOf(e)>-1&&(r=0);const i=sy.createAndSchedule(this,e,r,n,a=>this.lc(a));return this.ec.push(i),i}ac(){this.tc&&hr(47125,{hc:QE(this.tc)})}verifyOperationInProgress(){}async Pc(){let e;do e=this._c,await e;while(e!==this._c)}Tc(e){for(const r of this.ec)if(r.timerId===e)return!0;return!1}Ic(e){return this.Pc().then(()=>{this.ec.sort((r,n)=>r.targetTimeMs-n.targetTimeMs);for(const r of this.ec)if(r.skipDelay(),e!=="all"&&r.timerId===e)break;return this.Pc()})}dc(e){this.sc.push(e)}lc(e){const r=this.ec.indexOf(e);this.ec.splice(r,1)}}function QE(t){let e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+`
`+t.stack),e}class Fh extends a2{constructor(e,r,n,i){super(e,r,n,i),this.type="firestore",this._queue=new $E,this._persistenceKey=i?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new $E(e),this._firestoreClient=void 0,await e}}}function aO(t,e){const r=typeof t=="object"?t:eS(),n=typeof t=="string"?t:pg,i=Cx(r,"firestore").getImmediate({identifier:n});if(!i._initialized){const a=wC("firestore");a&&iO(i,...a)}return i}function fy(t){if(t._terminated)throw new Vt(dt.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||sO(t),t._firestoreClient}function sO(t){var e,r,n;const i=t._freezeSettings(),a=function(c,u,h,d){return new RL(c,u,h,d.host,d.ssl,d.experimentalForceLongPolling,d.experimentalAutoDetectLongPolling,aT(d.experimentalLongPollingOptions),d.useFetchStreams,d.isUsingEmulator)}(t._databaseId,((e=t._app)===null||e===void 0?void 0:e.options.appId)||"",t._persistenceKey,i);t._componentsProvider||!((r=i.localCache)===null||r===void 0)&&r._offlineComponentProvider&&(!((n=i.localCache)===null||n===void 0)&&n._onlineComponentProvider)&&(t._componentsProvider={_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider}),t._firestoreClient=new ZF(t._authCredentials,t._appCheckCredentials,t._queue,a,t._componentsProvider&&function(c){const u=c?._online.build();return{_offline:c?._offline.build(u),_online:u}}(t._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bo{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Bo(Ia.fromBase64String(e))}catch(r){throw new Vt(dt.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+r)}}static fromUint8Array(e){return new Bo(Ia.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:Bo._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(ap(e,Bo._jsonSchema))return Bo.fromBase64String(e.bytes)}}Bo._jsonSchemaVersion="firestore/bytes/1.0",Bo._jsonSchema={type:zi("string",Bo._jsonSchemaVersion),bytes:zi("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class s2{constructor(...e){for(let r=0;r<e.length;++r)if(e[r].length===0)throw new Vt(dt.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Na(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hy{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dc{constructor(e,r){if(!isFinite(e)||e<-90||e>90)throw new Vt(dt.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(r)||r<-180||r>180)throw new Vt(dt.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+r);this._lat=e,this._long=r}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return Rr(this._lat,e._lat)||Rr(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:dc._jsonSchemaVersion}}static fromJSON(e){if(ap(e,dc._jsonSchema))return new dc(e.latitude,e.longitude)}}dc._jsonSchemaVersion="firestore/geoPoint/1.0",dc._jsonSchema={type:zi("string",dc._jsonSchemaVersion),latitude:zi("number"),longitude:zi("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pc{constructor(e){this._values=(e||[]).map(r=>r)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(n,i){if(n.length!==i.length)return!1;for(let a=0;a<n.length;++a)if(n[a]!==i[a])return!1;return!0}(this._values,e._values)}toJSON(){return{type:pc._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(ap(e,pc._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every(r=>typeof r=="number"))return new pc(e.vectorValues);throw new Vt(dt.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}pc._jsonSchemaVersion="firestore/vectorValue/1.0",pc._jsonSchema={type:zi("string",pc._jsonSchemaVersion),vectorValues:zi("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oO=/^__.*__$/;class lO{constructor(e,r,n){this.data=e,this.fieldMask=r,this.fieldTransforms=n}toMutation(e,r){return this.fieldMask!==null?new Lf(e,this.data,this.fieldMask,r,this.fieldTransforms):new op(e,this.data,r,this.fieldTransforms)}}class oT{constructor(e,r,n){this.data=e,this.fieldMask=r,this.fieldTransforms=n}toMutation(e,r){return new Lf(e,this.data,this.fieldMask,r,this.fieldTransforms)}}function lT(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw hr(40011,{Ec:t})}}class dy{constructor(e,r,n,i,a,o){this.settings=e,this.databaseId=r,this.serializer=n,this.ignoreUndefinedProperties=i,a===void 0&&this.Ac(),this.fieldTransforms=a||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Ec(){return this.settings.Ec}Rc(e){return new dy(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Vc(e){var r;const n=(r=this.path)===null||r===void 0?void 0:r.child(e),i=this.Rc({path:n,mc:!1});return i.fc(e),i}gc(e){var r;const n=(r=this.path)===null||r===void 0?void 0:r.child(e),i=this.Rc({path:n,mc:!1});return i.Ac(),i}yc(e){return this.Rc({path:void 0,mc:!0})}wc(e){return Sg(e,this.settings.methodName,this.settings.Sc||!1,this.path,this.settings.bc)}contains(e){return this.fieldMask.find(r=>e.isPrefixOf(r))!==void 0||this.fieldTransforms.find(r=>e.isPrefixOf(r.field))!==void 0}Ac(){if(this.path)for(let e=0;e<this.path.length;e++)this.fc(this.path.get(e))}fc(e){if(e.length===0)throw this.wc("Document fields must not be empty");if(lT(this.Ec)&&oO.test(e))throw this.wc('Document fields cannot begin and end with "__"')}}class cO{constructor(e,r,n){this.databaseId=e,this.ignoreUndefinedProperties=r,this.serializer=n||r2(e)}Dc(e,r,n,i=!1){return new dy({Ec:e,methodName:r,bc:n,path:Na.emptyPath(),mc:!1,Sc:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function o2(t){const e=t._freezeSettings(),r=r2(t._databaseId);return new cO(t._databaseId,!!e.ignoreUndefinedProperties,r)}function cT(t,e,r,n,i,a={}){const o=t.Dc(a.merge||a.mergeFields?2:0,e,r,i);py("Data must be an object, but it was:",o,n);const c=uT(n,o);let u,h;if(a.merge)u=new ro(o.fieldMask),h=o.fieldTransforms;else if(a.mergeFields){const d=[];for(const g of a.mergeFields){const x=Y_(e,g,r);if(!o.contains(x))throw new Vt(dt.INVALID_ARGUMENT,`Field '${x}' is specified in your field mask but missing from your input data.`);hT(d,x)||d.push(x)}u=new ro(d),h=o.fieldTransforms.filter(g=>u.covers(g.field))}else u=null,h=o.fieldTransforms;return new lO(new Rs(c),u,h)}class l2 extends hy{_toFieldTransform(e){if(e.Ec!==2)throw e.Ec===1?e.wc(`${this._methodName}() can only appear at the top level of your update data`):e.wc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof l2}}function uO(t,e,r,n){const i=t.Dc(1,e,r);py("Data must be an object, but it was:",i,n);const a=[],o=Rs.empty();Rf(n,(u,h)=>{const d=my(e,u,r);h=ma(h);const g=i.gc(d);if(h instanceof l2)a.push(d);else{const x=fp(h,g);x!=null&&(a.push(d),o.set(d,x))}});const c=new ro(a);return new oT(o,c,i.fieldTransforms)}function fO(t,e,r,n,i,a){const o=t.Dc(1,e,r),c=[Y_(e,n,r)],u=[i];if(a.length%2!=0)throw new Vt(dt.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let x=0;x<a.length;x+=2)c.push(Y_(e,a[x])),u.push(a[x+1]);const h=[],d=Rs.empty();for(let x=c.length-1;x>=0;--x)if(!hT(h,c[x])){const _=c[x];let b=u[x];b=ma(b);const E=o.gc(_);if(b instanceof l2)h.push(_);else{const A=fp(b,E);A!=null&&(h.push(_),d.set(_,A))}}const g=new ro(h);return new oT(d,g,o.fieldTransforms)}function hO(t,e,r,n=!1){return fp(r,t.Dc(n?4:3,e))}function fp(t,e){if(fT(t=ma(t)))return py("Unsupported field value:",e,t),uT(t,e);if(t instanceof hy)return function(n,i){if(!lT(i.Ec))throw i.wc(`${n._methodName}() can only be used with update() and set()`);if(!i.path)throw i.wc(`${n._methodName}() is not currently supported inside arrays`);const a=n._toFieldTransform(i);a&&i.fieldTransforms.push(a)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.mc&&e.Ec!==4)throw e.wc("Nested arrays are not supported");return function(n,i){const a=[];let o=0;for(const c of n){let u=fp(c,i.yc(o));u==null&&(u={nullValue:"NULL_VALUE"}),a.push(u),o++}return{arrayValue:{values:a}}}(t,e)}return function(n,i){if((n=ma(n))===null)return{nullValue:"NULL_VALUE"};if(typeof n=="number")return eD(i.serializer,n);if(typeof n=="boolean")return{booleanValue:n};if(typeof n=="string")return{stringValue:n};if(n instanceof Date){const a=Un.fromDate(n);return{timestampValue:yg(i.serializer,a)}}if(n instanceof Un){const a=new Un(n.seconds,1e3*Math.floor(n.nanoseconds/1e3));return{timestampValue:yg(i.serializer,a)}}if(n instanceof dc)return{geoPointValue:{latitude:n.latitude,longitude:n.longitude}};if(n instanceof Bo)return{bytesValue:TA(i.serializer,n._byteString)};if(n instanceof Ti){const a=i.databaseId,o=n.firestore._databaseId;if(!o.isEqual(a))throw i.wc(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${a.projectId}/${a.database}`);return{referenceValue:Qx(n.firestore._databaseId||i.databaseId,n._key.path)}}if(n instanceof pc)return function(o,c){return{mapValue:{fields:{[tA]:{stringValue:rA},[mg]:{arrayValue:{values:o.toArray().map(h=>{if(typeof h!="number")throw c.wc("VectorValues must only contain numeric values.");return Xx(c.serializer,h)})}}}}}}(n,i);throw i.wc(`Unsupported field value: ${Xg(n)}`)}(t,e)}function uT(t,e){const r={};return KS(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Rf(t,(n,i)=>{const a=fp(i,e.Vc(n));a!=null&&(r[n]=a)}),{mapValue:{fields:r}}}function fT(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof Un||t instanceof dc||t instanceof Bo||t instanceof Ti||t instanceof hy||t instanceof pc)}function py(t,e,r){if(!fT(r)||!XS(r)){const n=Xg(r);throw n==="an object"?e.wc(t+" a custom object"):e.wc(t+" "+n)}}function Y_(t,e,r){if((e=ma(e))instanceof s2)return e._internalPath;if(typeof e=="string")return my(t,e);throw Sg("Field path arguments must be of type string or ",t,!1,void 0,r)}const dO=new RegExp("[~\\*/\\[\\]]");function my(t,e,r){if(e.search(dO)>=0)throw Sg(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,r);try{return new s2(...e.split("."))._internalPath}catch{throw Sg(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,r)}}function Sg(t,e,r,n,i){const a=n&&!n.isEmpty(),o=i!==void 0;let c=`Function ${e}() called with invalid data`;r&&(c+=" (via `toFirestore()`)"),c+=". ";let u="";return(a||o)&&(u+=" (found",a&&(u+=` in field ${n}`),o&&(u+=` in document ${i}`),u+=")"),new Vt(dt.INVALID_ARGUMENT,c+t+u)}function hT(t,e){return t.some(r=>r.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dT{constructor(e,r,n,i,a){this._firestore=e,this._userDataWriter=r,this._key=n,this._document=i,this._converter=a}get id(){return this._key.path.lastSegment()}get ref(){return new Ti(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new pO(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const r=this._document.data.field(gy("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r)}}}class pO extends dT{data(){return super.data()}}function gy(t,e){return typeof e=="string"?my(t,e):e instanceof s2?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mO(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new Vt(dt.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class vy{}class gO extends vy{}function _y(t,e,...r){let n=[];e instanceof vy&&n.push(e),n=n.concat(r),function(a){const o=a.filter(u=>u instanceof xy).length,c=a.filter(u=>u instanceof c2).length;if(o>1||o>0&&c>0)throw new Vt(dt.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(n);for(const i of n)t=i._apply(t);return t}class c2 extends gO{constructor(e,r,n){super(),this._field=e,this._op=r,this._value=n,this.type="where"}static _create(e,r,n){return new c2(e,r,n)}_apply(e){const r=this._parse(e);return pT(e._query,r),new ld(e.firestore,e.converter,M_(e._query,r))}_parse(e){const r=o2(e.firestore);return function(a,o,c,u,h,d,g){let x;if(h.isKeyField()){if(d==="array-contains"||d==="array-contains-any")throw new Vt(dt.INVALID_ARGUMENT,`Invalid Query. You can't perform '${d}' queries on documentId().`);if(d==="in"||d==="not-in"){ZE(g,d);const b=[];for(const E of g)b.push(JE(u,a,E));x={arrayValue:{values:b}}}else x=JE(u,a,g)}else d!=="in"&&d!=="not-in"&&d!=="array-contains-any"||ZE(g,d),x=hO(c,o,g,d==="in"||d==="not-in");return qi.create(h,d,x)}(e._query,"where",r,e.firestore._databaseId,this._field,this._op,this._value)}}function Ag(t,e,r){const n=e,i=gy("where",t);return c2._create(i,n,r)}class xy extends vy{constructor(e,r){super(),this.type=e,this._queryConstraints=r}static _create(e,r){return new xy(e,r)}_parse(e){const r=this._queryConstraints.map(n=>n._parse(e)).filter(n=>n.getFilters().length>0);return r.length===1?r[0]:bl.create(r,this._getOperator())}_apply(e){const r=this._parse(e);return r.getFilters().length===0?e:(function(i,a){let o=i;const c=a.getFlattenedFilters();for(const u of c)pT(o,u),o=M_(o,u)}(e._query,r),new ld(e.firestore,e.converter,M_(e._query,r)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}function JE(t,e,r){if(typeof(r=ma(r))=="string"){if(r==="")throw new Vt(dt.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!uA(e)&&r.indexOf("/")!==-1)throw new Vt(dt.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${r}' contains a '/' character.`);const n=e.path.child(Mn.fromString(r));if(!Jt.isDocumentKey(n))throw new Vt(dt.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${n}' is not because it has an odd number of segments (${n.length}).`);return mE(t,new Jt(n))}if(r instanceof Ti)return mE(t,r._key);throw new Vt(dt.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Xg(r)}.`)}function ZE(t,e){if(!Array.isArray(t)||t.length===0)throw new Vt(dt.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function pT(t,e){const r=function(i,a){for(const o of i)for(const c of o.getFlattenedFilters())if(a.indexOf(c.op)>=0)return c.op;return null}(t.filters,function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(r!==null)throw r===e.op?new Vt(dt.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new Vt(dt.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${r.toString()}' filters.`)}class vO{convertValue(e,r="none"){switch(_f(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Ei(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,r);case 5:return e.stringValue;case 6:return this.convertBytes(vf(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,r);case 11:return this.convertObject(e.mapValue,r);case 10:return this.convertVectorValue(e.mapValue);default:throw hr(62114,{value:e})}}convertObject(e,r){return this.convertObjectMap(e.fields,r)}convertObjectMap(e,r="none"){const n={};return Rf(e,(i,a)=>{n[i]=this.convertValue(a,r)}),n}convertVectorValue(e){var r,n,i;const a=(i=(n=(r=e.fields)===null||r===void 0?void 0:r[mg].arrayValue)===null||n===void 0?void 0:n.values)===null||i===void 0?void 0:i.map(o=>Ei(o.doubleValue));return new pc(a)}convertGeoPoint(e){return new dc(Ei(e.latitude),Ei(e.longitude))}convertArray(e,r){return(e.values||[]).map(n=>this.convertValue(n,r))}convertServerTimestamp(e,r){switch(r){case"previous":const n=$g(e);return n==null?null:this.convertValue(n,r);case"estimate":return this.convertTimestamp(L1(e));default:return null}}convertTimestamp(e){const r=gf(e);return new Un(r.seconds,r.nanos)}convertDocumentKey(e,r){const n=Mn.fromString(e);mn(LA(n),9688,{name:e});const i=new D1(n.get(1),n.get(3)),a=new Jt(n.popFirst(5));return i.isEqual(r)||ou(`Document ${a} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${r.projectId}/${r.database}) instead.`),a}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mT(t,e,r){let n;return n=t?t.toFirestore(e):e,n}class o1{constructor(e,r){this.hasPendingWrites=e,this.fromCache=r}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class fh extends dT{constructor(e,r,n,i,a,o){super(e,r,n,i,o),this._firestore=e,this._firestoreImpl=e,this.metadata=a}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const r=new Km(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(r,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,r={}){if(this._document){const n=this._document.data.field(gy("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n,r.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new Vt(dt.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,r={};return r.type=fh._jsonSchemaVersion,r.bundle="",r.bundleSource="DocumentSnapshot",r.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?r:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),r.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),r)}}fh._jsonSchemaVersion="firestore/documentSnapshot/1.0",fh._jsonSchema={type:zi("string",fh._jsonSchemaVersion),bundleSource:zi("string","DocumentSnapshot"),bundleName:zi("string"),bundle:zi("string")};class Km extends fh{data(e={}){return super.data(e)}}class P0{constructor(e,r,n,i){this._firestore=e,this._userDataWriter=r,this._snapshot=i,this.metadata=new o1(i.hasPendingWrites,i.fromCache),this.query=n}get docs(){const e=[];return this.forEach(r=>e.push(r)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,r){this._snapshot.docs.forEach(n=>{e.call(r,new Km(this._firestore,this._userDataWriter,n.key,n,new o1(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const r=!!e.includeMetadataChanges;if(r&&this._snapshot.excludesMetadataChanges)throw new Vt(dt.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===r||(this._cachedChanges=function(i,a){if(i._snapshot.oldDocs.isEmpty()){let o=0;return i._snapshot.docChanges.map(c=>{const u=new Km(i._firestore,i._userDataWriter,c.doc.key,c.doc,new o1(i._snapshot.mutatedKeys.has(c.doc.key),i._snapshot.fromCache),i.query.converter);return c.doc,{type:"added",doc:u,oldIndex:-1,newIndex:o++}})}{let o=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(c=>a||c.type!==3).map(c=>{const u=new Km(i._firestore,i._userDataWriter,c.doc.key,c.doc,new o1(i._snapshot.mutatedKeys.has(c.doc.key),i._snapshot.fromCache),i.query.converter);let h=-1,d=-1;return c.type!==0&&(h=o.indexOf(c.doc.key),o=o.delete(c.doc.key)),c.type!==1&&(o=o.add(c.doc),d=o.indexOf(c.doc.key)),{type:_O(c.type),doc:u,oldIndex:h,newIndex:d}})}}(this,r),this._cachedChangesIncludeMetadataChanges=r),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new Vt(dt.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=P0._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=Ux.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const r=[],n=[],i=[];return this.docs.forEach(a=>{a._document!==null&&(r.push(a._document),n.push(this._userDataWriter.convertObjectMap(a._document.data.value.mapValue.fields,"previous")),i.push(a.ref.path))}),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function _O(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return hr(61501,{type:t})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gT(t){t=El(t,Ti);const e=El(t.firestore,Fh);return rO(fy(e),t._key).then(r=>xO(e,t,r))}P0._jsonSchemaVersion="firestore/querySnapshot/1.0",P0._jsonSchema={type:zi("string",P0._jsonSchemaVersion),bundleSource:zi("string","QuerySnapshot"),bundleName:zi("string"),bundle:zi("string")};class vT extends vO{constructor(e){super(),this.firestore=e}convertBytes(e){return new Bo(e)}convertReference(e){const r=this.convertDocumentKey(e,this.firestore._databaseId);return new Ti(this.firestore,null,r)}}function io(t){t=El(t,ld);const e=El(t.firestore,Fh),r=fy(e),n=new vT(e);return mO(t._query),nO(r,t._query).then(i=>new P0(e,n,t,i))}function _T(t,e,r){t=El(t,Ti);const n=El(t.firestore,Fh),i=mT(t.converter,e);return f2(n,[cT(o2(n),"setDoc",t._key,i,t.converter!==null,r).toMutation(t._key,jo.none())])}function u2(t,e,r,...n){t=El(t,Ti);const i=El(t.firestore,Fh),a=o2(i);let o;return o=typeof(e=ma(e))=="string"||e instanceof s2?fO(a,"updateDoc",t._key,e,r,n):uO(a,"updateDoc",t._key,e),f2(i,[o.toMutation(t._key,jo.exists(!0))])}function Tg(t){return f2(El(t.firestore,Fh),[new Yx(t._key,jo.none())])}function hh(t,e){const r=El(t.firestore,Fh),n=no(t),i=mT(t.converter,e);return f2(r,[cT(o2(t.firestore),"addDoc",n._key,i,t.converter!==null,{}).toMutation(n._key,jo.exists(!1))]).then(()=>n)}function f2(t,e){return function(n,i){const a=new tu;return n.asyncQueue.enqueueAndForget(async()=>HF(await tO(n),i,a)),a.promise}(fy(t),e)}function xO(t,e,r){const n=r.docs.get(e._key),i=new vT(t);return new fh(t,i,e._key,n,new o1(r.hasPendingWrites,r.fromCache),e.converter)}(function(e,r=!0){(function(i){id=i})(rd),G0(new xh("firestore",(n,{instanceIdentifier:i,options:a})=>{const o=n.getProvider("app").getImmediate(),c=new Fh(new dL(n.getProvider("auth-internal")),new gL(o,n.getProvider("app-check-internal")),function(h,d){if(!Object.prototype.hasOwnProperty.apply(h.options,["projectId"]))throw new Vt(dt.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new D1(h.options.projectId,d)}(o,i),o);return a=Object.assign({useFetchStreams:r},a),c._setSettings(a),c},"PUBLIC").setMultipleInstances(!0)),ff(tE,rE,e),ff(tE,rE,"esm2017")})();var yO="firebase",wO="11.10.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ff(yO,wO,"app");const EO={apiKey:"AIzaSyAADvft0ne-CpB00qBPOkJMcFqCGe-tOaU",authDomain:"evalstage2-lucas2025.firebaseapp.com",projectId:"evalstage2-lucas2025",storageBucket:"evalstage2-lucas2025.appspot.com",messagingSenderId:"1074657513257",appId:"1:1074657513257:web:f3fcc8ec7a421801277138"},xT=Zb(EO),$m=cL(xT),fn=aO(xT),yT=lt.createContext(void 0),hp=()=>{const t=lt.useContext(yT);if(t===void 0)throw new Error("useAuth must be used within an AuthProvider");return t},bO=({children:t})=>{const[e,r]=lt.useState(null),[n,i]=lt.useState(null),[a,o]=lt.useState(!0);lt.useEffect(()=>QR($m,async g=>{if(console.log(" Changement d'tat auth:",g?.uid||"null"),i(g),g)try{const x=await gT(no(fn,"users",g.uid));if(x.exists()){const _=x.data(),b=_.createdAt?.toDate?.()||new Date(_.createdAt)||new Date,E={id:g.uid,nom:_.nom||"",prenom:_.prenom||"",email:g.email||"",role:_.role||"professeur",createdAt:b};console.log(" Utilisateur charg:",E.email,"- Rle:",E.role),r(E)}else{console.log(" Cration du profil utilisateur manquant...");const _={id:g.uid,nom:"",prenom:"",email:g.email||"",role:"professeur",createdAt:new Date};await _T(no(fn,"users",g.uid),{nom:_.nom,prenom:_.prenom,email:_.email,role:_.role,createdAt:_.createdAt}),r(_)}}catch(x){console.error(" Erreur lors du chargement utilisateur:",x),r(null)}else console.log(" Aucun utilisateur connect"),r(null);o(!1)}),[]);const h={currentUser:e,firebaseUser:n,loading:a,login:async(d,g)=>{try{console.log(" Tentative de connexion..."),await YR($m,d,g),console.log(" Connexion russie")}catch(x){throw console.error(" Erreur de connexion:",x),x}},logout:async()=>{try{await JR($m),r(null),i(null)}catch(d){throw console.error("Erreur lors de la dconnexion:",d),d}}};return H.jsx(yT.Provider,{value:h,children:t})},SO=()=>{const[t,e]=lt.useState(!1),{currentUser:r,logout:n}=hp(),i=async()=>{try{await n(),e(!1)}catch(o){console.error("Erreur lors de la dconnexion:",o)}},a=()=>{e(!t)};return H.jsx("nav",{className:"navigation",children:H.jsxs("div",{className:"nav-container",children:[H.jsx("button",{className:"menu-toggle",onClick:a,"aria-label":"Menu",children:""}),H.jsx("div",{className:`nav-menu ${t?"open":""}`,children:r&&H.jsxs(H.Fragment,{children:[H.jsxs("div",{className:"user-info",children:[H.jsx("p",{children:"Connect en tant que :"}),H.jsxs("strong",{children:[r.prenom," ",r.nom]}),H.jsxs("span",{className:"user-role",children:["(",r.role,")"]})]}),H.jsxs("div",{className:"nav-links",children:[H.jsx(ih,{to:"/",className:"nav-link",onClick:()=>e(!1),children:"Accueil"}),r.role==="admin"&&H.jsx(ih,{to:"/classes",className:"nav-link",onClick:()=>e(!1),children:"Grer les classes"}),r.role==="admin"&&H.jsx(ih,{to:"/periodes-stage",className:"nav-link",onClick:()=>e(!1),children:"Priodes de stage"}),H.jsx(ih,{to:"/evaluations",className:"nav-link",onClick:()=>e(!1),children:"valuer un lve"}),H.jsx(ih,{to:"/rapports",className:"nav-link",onClick:()=>e(!1),children:"Exporter rapports"}),r.role==="admin"&&H.jsx(ih,{to:"/comptes",className:"nav-link",onClick:()=>e(!1),children:"Gestion des comptes"})]}),H.jsx("div",{className:"nav-actions",children:H.jsx("button",{onClick:i,className:"logout-button",children:"Se dconnecter"})})]})})]})})},AO=()=>{const[t,e]=lt.useState(""),[r,n]=lt.useState(""),[i,a]=lt.useState(""),[o,c]=lt.useState(!1),{login:u,currentUser:h,loading:d}=hp(),g=Tx();lt.useEffect(()=>{h&&!d&&(console.log(" Redirection vers accueil - utilisateur connect:",h.email),g("/"))},[h,d,g]);const x=async _=>{if(_.preventDefault(),!t||!r){a("Veuillez remplir tous les champs");return}try{a(""),c(!0),console.log(" Tentative de connexion pour:",t),await u(t,r),console.log(" Login russi, en attente de la redirection...")}catch(b){console.error(" Erreur de connexion:",b),a("Email ou mot de passe incorrect")}finally{c(!1)}};return d?H.jsx("div",{className:"login-container",children:H.jsx("div",{className:"login-form",children:H.jsx("div",{className:"loading",children:"Authentification en cours..."})})}):H.jsx("div",{className:"login-container",children:H.jsxs("div",{className:"login-form",children:[H.jsx("h1",{children:"Connexion"}),H.jsx("p",{children:"Application de gestion des valuations PFMP"}),i&&H.jsx("div",{className:"error-message",children:i}),H.jsxs("form",{onSubmit:x,children:[H.jsxs("div",{className:"form-group",children:[H.jsx("label",{htmlFor:"email",children:"Email"}),H.jsx("input",{type:"email",id:"email",value:t,onChange:_=>e(_.target.value),placeholder:"votre.email@exemple.com",required:!0})]}),H.jsxs("div",{className:"form-group",children:[H.jsx("label",{htmlFor:"password",children:"Mot de passe"}),H.jsx("input",{type:"password",id:"password",value:r,onChange:_=>n(_.target.value),placeholder:"",required:!0})]}),H.jsx("button",{type:"submit",className:"login-button",disabled:o,children:o?"Connexion...":"Se connecter"})]})]})})};/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var kg={};kg.version="0.18.5";var wT=1252,TO=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],yy={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},wy=function(t){TO.indexOf(t)!=-1&&(wT=yy[0]=t)};function kO(){wy(1252)}var vl=function(t){wy(t)};function Ey(){vl(1200),kO()}function e3(t){for(var e=[],r=0,n=t.length;r<n;++r)e[r]=t.charCodeAt(r);return e}function NO(t){for(var e=[],r=0;r<t.length>>1;++r)e[r]=String.fromCharCode(t.charCodeAt(2*r)+(t.charCodeAt(2*r+1)<<8));return e.join("")}function ET(t){for(var e=[],r=0;r<t.length>>1;++r)e[r]=String.fromCharCode(t.charCodeAt(2*r+1)+(t.charCodeAt(2*r)<<8));return e.join("")}var l1=function(t){var e=t.charCodeAt(0),r=t.charCodeAt(1);return e==255&&r==254?NO(t.slice(2)):e==254&&r==255?ET(t.slice(2)):e==65279?t.slice(1):t},Sm=function(e){return String.fromCharCode(e)},t3=function(e){return String.fromCharCode(e)},M1,af="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function B1(t){for(var e="",r=0,n=0,i=0,a=0,o=0,c=0,u=0,h=0;h<t.length;)r=t.charCodeAt(h++),a=r>>2,n=t.charCodeAt(h++),o=(r&3)<<4|n>>4,i=t.charCodeAt(h++),c=(n&15)<<2|i>>6,u=i&63,isNaN(n)?c=u=64:isNaN(i)&&(u=64),e+=af.charAt(a)+af.charAt(o)+af.charAt(c)+af.charAt(u);return e}function so(t){var e="",r=0,n=0,i=0,a=0,o=0,c=0,u=0;t=t.replace(/[^\w\+\/\=]/g,"");for(var h=0;h<t.length;)a=af.indexOf(t.charAt(h++)),o=af.indexOf(t.charAt(h++)),r=a<<2|o>>4,e+=String.fromCharCode(r),c=af.indexOf(t.charAt(h++)),n=(o&15)<<4|c>>2,c!==64&&(e+=String.fromCharCode(n)),u=af.indexOf(t.charAt(h++)),i=(c&3)<<6|u,u!==64&&(e+=String.fromCharCode(i));return e}var Lr=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),fu=function(){if(typeof Buffer<"u"){var t=!Buffer.from;if(!t)try{Buffer.from("foo","utf8")}catch{t=!0}return t?function(e,r){return r?new Buffer(e,r):new Buffer(e)}:Buffer.from.bind(Buffer)}return function(){}}();function wf(t){return Lr?Buffer.alloc?Buffer.alloc(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}function r3(t){return Lr?Buffer.allocUnsafe?Buffer.allocUnsafe(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}var eo=function(e){return Lr?fu(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)&255})};function h2(t){if(typeof ArrayBuffer>"u")return eo(t);for(var e=new ArrayBuffer(t.length),r=new Uint8Array(e),n=0;n!=t.length;++n)r[n]=t.charCodeAt(n)&255;return e}function Df(t){if(Array.isArray(t))return t.map(function(n){return String.fromCharCode(n)}).join("");for(var e=[],r=0;r<t.length;++r)e[r]=String.fromCharCode(t[r]);return e.join("")}function CO(t){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(t)}function by(t){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(t instanceof ArrayBuffer)return by(new Uint8Array(t));for(var e=new Array(t.length),r=0;r<t.length;++r)e[r]=t[r];return e}var da=Lr?function(t){return Buffer.concat(t.map(function(e){return Buffer.isBuffer(e)?e:fu(e)}))}:function(t){if(typeof Uint8Array<"u"){var e=0,r=0;for(e=0;e<t.length;++e)r+=t[e].length;var n=new Uint8Array(r),i=0;for(e=0,r=0;e<t.length;r+=i,++e)if(i=t[e].length,t[e]instanceof Uint8Array)n.set(t[e],r);else{if(typeof t[e]=="string")throw"wtf";n.set(new Uint8Array(t[e]),r)}return n}return[].concat.apply([],t.map(function(a){return Array.isArray(a)?a:[].slice.call(a)}))};function IO(t){for(var e=[],r=0,n=t.length+250,i=wf(t.length+255),a=0;a<t.length;++a){var o=t.charCodeAt(a);if(o<128)i[r++]=o;else if(o<2048)i[r++]=192|o>>6&31,i[r++]=128|o&63;else if(o>=55296&&o<57344){o=(o&1023)+64;var c=t.charCodeAt(++a)&1023;i[r++]=240|o>>8&7,i[r++]=128|o>>2&63,i[r++]=128|c>>6&15|(o&3)<<4,i[r++]=128|c&63}else i[r++]=224|o>>12&15,i[r++]=128|o>>6&63,i[r++]=128|o&63;r>n&&(e.push(i.slice(0,r)),r=0,i=wf(65535),n=65530)}return e.push(i.slice(0,r)),da(e)}var hs=/\u0000/g,c1=/[\u0001-\u0006]/g;function M0(t){for(var e="",r=t.length-1;r>=0;)e+=t.charAt(r--);return e}function _l(t,e){var r=""+t;return r.length>=e?r:ui("0",e-r.length)+r}function Sy(t,e){var r=""+t;return r.length>=e?r:ui(" ",e-r.length)+r}function Ng(t,e){var r=""+t;return r.length>=e?r:r+ui(" ",e-r.length)}function RO(t,e){var r=""+Math.round(t);return r.length>=e?r:ui("0",e-r.length)+r}function LO(t,e){var r=""+t;return r.length>=e?r:ui("0",e-r.length)+r}var n3=Math.pow(2,32);function v0(t,e){if(t>n3||t<-n3)return RO(t,e);var r=Math.round(t);return LO(r,e)}function Cg(t,e){return e=e||0,t.length>=7+e&&(t.charCodeAt(e)|32)===103&&(t.charCodeAt(e+1)|32)===101&&(t.charCodeAt(e+2)|32)===110&&(t.charCodeAt(e+3)|32)===101&&(t.charCodeAt(e+4)|32)===114&&(t.charCodeAt(e+5)|32)===97&&(t.charCodeAt(e+6)|32)===108}var i3=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],Yv=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function DO(t){return t||(t={}),t[0]="General",t[1]="0",t[2]="0.00",t[3]="#,##0",t[4]="#,##0.00",t[9]="0%",t[10]="0.00%",t[11]="0.00E+00",t[12]="# ?/?",t[13]="# ??/??",t[14]="m/d/yy",t[15]="d-mmm-yy",t[16]="d-mmm",t[17]="mmm-yy",t[18]="h:mm AM/PM",t[19]="h:mm:ss AM/PM",t[20]="h:mm",t[21]="h:mm:ss",t[22]="m/d/yy h:mm",t[37]="#,##0 ;(#,##0)",t[38]="#,##0 ;[Red](#,##0)",t[39]="#,##0.00;(#,##0.00)",t[40]="#,##0.00;[Red](#,##0.00)",t[45]="mm:ss",t[46]="[h]:mm:ss",t[47]="mmss.0",t[48]="##0.0E+0",t[49]="@",t[56]='"/ "hh""mm""ss" "',t}var sr={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},a3={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},FO={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function Ig(t,e,r){for(var n=t<0?-1:1,i=t*n,a=0,o=1,c=0,u=1,h=0,d=0,g=Math.floor(i);h<e&&(g=Math.floor(i),c=g*o+a,d=g*h+u,!(i-g<5e-8));)i=1/(i-g),a=o,o=c,u=h,h=d;if(d>e&&(h>e?(d=u,c=a):(d=h,c=o)),!r)return[0,n*c,d];var x=Math.floor(n*c/d);return[x,n*c-x*d,d]}function uh(t,e,r){if(t>2958465||t<0)return null;var n=t|0,i=Math.floor(86400*(t-n)),a=0,o=[],c={D:n,T:i,u:86400*(t-n)-i,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(c.u)<1e-6&&(c.u=0),e&&e.date1904&&(n+=1462),c.u>.9999&&(c.u=0,++i==86400&&(c.T=i=0,++n,++c.D)),n===60)o=r?[1317,10,29]:[1900,2,29],a=3;else if(n===0)o=r?[1317,8,29]:[1900,1,0],a=6;else{n>60&&--n;var u=new Date(1900,0,1);u.setDate(u.getDate()+n-1),o=[u.getFullYear(),u.getMonth()+1,u.getDate()],a=u.getDay(),n<60&&(a=(a+6)%7),r&&(a=UO(u,o))}return c.y=o[0],c.m=o[1],c.d=o[2],c.S=i%60,i=Math.floor(i/60),c.M=i%60,i=Math.floor(i/60),c.H=i,c.q=a,c}var bT=new Date(1899,11,31,0,0,0),OO=bT.getTime(),PO=new Date(1900,2,1,0,0,0);function ST(t,e){var r=t.getTime();return e?r-=1461*24*60*60*1e3:t>=PO&&(r+=24*60*60*1e3),(r-(OO+(t.getTimezoneOffset()-bT.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function Ay(t){return t.indexOf(".")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function MO(t){return t.indexOf("E")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function BO(t){var e=t<0?12:11,r=Ay(t.toFixed(12));return r.length<=e||(r=t.toPrecision(10),r.length<=e)?r:t.toExponential(5)}function jO(t){var e=Ay(t.toFixed(11));return e.length>(t<0?12:11)||e==="0"||e==="-0"?t.toPrecision(6):e}function j1(t){var e=Math.floor(Math.log(Math.abs(t))*Math.LOG10E),r;return e>=-4&&e<=-1?r=t.toPrecision(10+e):Math.abs(e)<=9?r=BO(t):e===10?r=t.toFixed(10).substr(0,12):r=jO(t),Ay(MO(r.toUpperCase()))}function Sh(t,e){switch(typeof t){case"string":return t;case"boolean":return t?"TRUE":"FALSE";case"number":return(t|0)===t?t.toString(10):j1(t);case"undefined":return"";case"object":if(t==null)return"";if(t instanceof Date)return Vo(14,ST(t,e&&e.date1904),e)}throw new Error("unsupported value in General format: "+t)}function UO(t,e){e[0]-=581;var r=t.getDay();return t<60&&(r=(r+6)%7),r}function VO(t,e,r,n){var i="",a=0,o=0,c=r.y,u,h=0;switch(t){case 98:c=r.y+543;case 121:switch(e.length){case 1:case 2:u=c%100,h=2;break;default:u=c%1e4,h=4;break}break;case 109:switch(e.length){case 1:case 2:u=r.m,h=e.length;break;case 3:return Yv[r.m-1][1];case 5:return Yv[r.m-1][0];default:return Yv[r.m-1][2]}break;case 100:switch(e.length){case 1:case 2:u=r.d,h=e.length;break;case 3:return i3[r.q][0];default:return i3[r.q][1]}break;case 104:switch(e.length){case 1:case 2:u=1+(r.H+11)%12,h=e.length;break;default:throw"bad hour format: "+e}break;case 72:switch(e.length){case 1:case 2:u=r.H,h=e.length;break;default:throw"bad hour format: "+e}break;case 77:switch(e.length){case 1:case 2:u=r.M,h=e.length;break;default:throw"bad minute format: "+e}break;case 115:if(e!="s"&&e!="ss"&&e!=".0"&&e!=".00"&&e!=".000")throw"bad second format: "+e;return r.u===0&&(e=="s"||e=="ss")?_l(r.S,e.length):(n>=2?o=n===3?1e3:100:o=n===1?10:1,a=Math.round(o*(r.S+r.u)),a>=60*o&&(a=0),e==="s"?a===0?"0":""+a/o:(i=_l(a,2+n),e==="ss"?i.substr(0,2):"."+i.substr(2,e.length-1)));case 90:switch(e){case"[h]":case"[hh]":u=r.D*24+r.H;break;case"[m]":case"[mm]":u=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":u=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+e}h=e.length===3?1:2;break;case 101:u=c,h=1;break}var d=h>0?_l(u,h):"";return d}function sf(t){var e=3;if(t.length<=e)return t;for(var r=t.length%e,n=t.substr(0,r);r!=t.length;r+=e)n+=(n.length>0?",":"")+t.substr(r,e);return n}var AT=/%/g;function qO(t,e,r){var n=e.replace(AT,""),i=e.length-n.length;return ru(t,n,r*Math.pow(10,2*i))+ui("%",i)}function zO(t,e,r){for(var n=e.length-1;e.charCodeAt(n-1)===44;)--n;return ru(t,e.substr(0,n),r/Math.pow(10,3*(e.length-n)))}function TT(t,e){var r,n=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+TT(t,-e);var i=t.indexOf(".");i===-1&&(i=t.indexOf("E"));var a=Math.floor(Math.log(e)*Math.LOG10E)%i;if(a<0&&(a+=i),r=(e/Math.pow(10,a)).toPrecision(n+1+(i+a)%i),r.indexOf("e")===-1){var o=Math.floor(Math.log(e)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(o-r.length+a):r+="E+"+(o-a);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,i)+"."+r.substr(2+i),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(c,u,h,d){return u+h+d.substr(0,(i+a)%i)+"."+d.substr(a)+"E"})}else r=e.toExponential(n);return t.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),t.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var kT=/# (\?+)( ?)\/( ?)(\d+)/;function HO(t,e,r){var n=parseInt(t[4],10),i=Math.round(e*n),a=Math.floor(i/n),o=i-a*n,c=n;return r+(a===0?"":""+a)+" "+(o===0?ui(" ",t[1].length+1+t[4].length):Sy(o,t[1].length)+t[2]+"/"+t[3]+_l(c,t[4].length))}function GO(t,e,r){return r+(e===0?"":""+e)+ui(" ",t[1].length+2+t[4].length)}var NT=/^#*0*\.([0#]+)/,CT=/\).*[0#]/,IT=/\(###\) ###\\?-####/;function us(t){for(var e="",r,n=0;n!=t.length;++n)switch(r=t.charCodeAt(n)){case 35:break;case 63:e+=" ";break;case 48:e+="0";break;default:e+=String.fromCharCode(r)}return e}function s3(t,e){var r=Math.pow(10,e);return""+Math.round(t*r)/r}function o3(t,e){var r=t-Math.floor(t),n=Math.pow(10,e);return e<(""+Math.round(r*n)).length?0:Math.round(r*n)}function WO(t,e){return e<(""+Math.round((t-Math.floor(t))*Math.pow(10,e))).length?1:0}function XO(t){return t<2147483647&&t>-2147483648?""+(t>=0?t|0:t-1|0):""+Math.floor(t)}function Lo(t,e,r){if(t.charCodeAt(0)===40&&!e.match(CT)){var n=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Lo("n",n,r):"("+Lo("n",n,-r)+")"}if(e.charCodeAt(e.length-1)===44)return zO(t,e,r);if(e.indexOf("%")!==-1)return qO(t,e,r);if(e.indexOf("E")!==-1)return TT(e,r);if(e.charCodeAt(0)===36)return"$"+Lo(t,e.substr(e.charAt(1)==" "?2:1),r);var i,a,o,c,u=Math.abs(r),h=r<0?"-":"";if(e.match(/^00+$/))return h+v0(u,e.length);if(e.match(/^[#?]+$/))return i=v0(r,0),i==="0"&&(i=""),i.length>e.length?i:us(e.substr(0,e.length-i.length))+i;if(a=e.match(kT))return HO(a,u,h);if(e.match(/^#+0+$/))return h+v0(u,e.length-e.indexOf("0"));if(a=e.match(NT))return i=s3(r,a[1].length).replace(/^([^\.]+)$/,"$1."+us(a[1])).replace(/\.$/,"."+us(a[1])).replace(/\.(\d*)$/,function(b,E){return"."+E+ui("0",us(a[1]).length-E.length)}),e.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),a=e.match(/^(0*)\.(#*)$/))return h+s3(u,a[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,a[1].length?"0.":".");if(a=e.match(/^#{1,3},##0(\.?)$/))return h+sf(v0(u,0));if(a=e.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Lo(t,e,-r):sf(""+(Math.floor(r)+WO(r,a[1].length)))+"."+_l(o3(r,a[1].length),a[1].length);if(a=e.match(/^#,#*,#0/))return Lo(t,e.replace(/^#,#*,/,""),r);if(a=e.match(/^([0#]+)(\\?-([0#]+))+$/))return i=M0(Lo(t,e.replace(/[\\-]/g,""),r)),o=0,M0(M0(e.replace(/\\/g,"")).replace(/[0#]/g,function(b){return o<i.length?i.charAt(o++):b==="0"?"0":""}));if(e.match(IT))return i=Lo(t,"##########",r),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var d="";if(a=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(a[4].length,7),c=Ig(u,Math.pow(10,o)-1,!1),i=""+h,d=ru("n",a[1],c[1]),d.charAt(d.length-1)==" "&&(d=d.substr(0,d.length-1)+"0"),i+=d+a[2]+"/"+a[3],d=Ng(c[2],o),d.length<a[4].length&&(d=us(a[4].substr(a[4].length-d.length))+d),i+=d,i;if(a=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(a[1].length,a[4].length),7),c=Ig(u,Math.pow(10,o)-1,!0),h+(c[0]||(c[1]?"":"0"))+" "+(c[1]?Sy(c[1],o)+a[2]+"/"+a[3]+Ng(c[2],o):ui(" ",2*o+1+a[2].length+a[3].length));if(a=e.match(/^[#0?]+$/))return i=v0(r,0),e.length<=i.length?i:us(e.substr(0,e.length-i.length))+i;if(a=e.match(/^([#0?]+)\.([#0]+)$/)){i=""+r.toFixed(Math.min(a[2].length,10)).replace(/([^0])0+$/,"$1"),o=i.indexOf(".");var g=e.indexOf(".")-o,x=e.length-i.length-g;return us(e.substr(0,g)+i+e.substr(e.length-x))}if(a=e.match(/^00,000\.([#0]*0)$/))return o=o3(r,a[1].length),r<0?"-"+Lo(t,e,-r):sf(XO(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(b){return"00,"+(b.length<3?_l(0,3-b.length):"")+b})+"."+_l(o,a[1].length);switch(e){case"###,##0.00":return Lo(t,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var _=sf(v0(u,0));return _!=="0"?h+_:"";case"###,###.00":return Lo(t,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return Lo(t,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+e+"|")}function YO(t,e,r){for(var n=e.length-1;e.charCodeAt(n-1)===44;)--n;return ru(t,e.substr(0,n),r/Math.pow(10,3*(e.length-n)))}function KO(t,e,r){var n=e.replace(AT,""),i=e.length-n.length;return ru(t,n,r*Math.pow(10,2*i))+ui("%",i)}function RT(t,e){var r,n=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+RT(t,-e);var i=t.indexOf(".");i===-1&&(i=t.indexOf("E"));var a=Math.floor(Math.log(e)*Math.LOG10E)%i;if(a<0&&(a+=i),r=(e/Math.pow(10,a)).toPrecision(n+1+(i+a)%i),!r.match(/[Ee]/)){var o=Math.floor(Math.log(e)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(o-r.length+a):r+="E+"+(o-a),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(c,u,h,d){return u+h+d.substr(0,(i+a)%i)+"."+d.substr(a)+"E"})}else r=e.toExponential(n);return t.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),t.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function nc(t,e,r){if(t.charCodeAt(0)===40&&!e.match(CT)){var n=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?nc("n",n,r):"("+nc("n",n,-r)+")"}if(e.charCodeAt(e.length-1)===44)return YO(t,e,r);if(e.indexOf("%")!==-1)return KO(t,e,r);if(e.indexOf("E")!==-1)return RT(e,r);if(e.charCodeAt(0)===36)return"$"+nc(t,e.substr(e.charAt(1)==" "?2:1),r);var i,a,o,c,u=Math.abs(r),h=r<0?"-":"";if(e.match(/^00+$/))return h+_l(u,e.length);if(e.match(/^[#?]+$/))return i=""+r,r===0&&(i=""),i.length>e.length?i:us(e.substr(0,e.length-i.length))+i;if(a=e.match(kT))return GO(a,u,h);if(e.match(/^#+0+$/))return h+_l(u,e.length-e.indexOf("0"));if(a=e.match(NT))return i=(""+r).replace(/^([^\.]+)$/,"$1."+us(a[1])).replace(/\.$/,"."+us(a[1])),i=i.replace(/\.(\d*)$/,function(b,E){return"."+E+ui("0",us(a[1]).length-E.length)}),e.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),a=e.match(/^(0*)\.(#*)$/))return h+(""+u).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,a[1].length?"0.":".");if(a=e.match(/^#{1,3},##0(\.?)$/))return h+sf(""+u);if(a=e.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+nc(t,e,-r):sf(""+r)+"."+ui("0",a[1].length);if(a=e.match(/^#,#*,#0/))return nc(t,e.replace(/^#,#*,/,""),r);if(a=e.match(/^([0#]+)(\\?-([0#]+))+$/))return i=M0(nc(t,e.replace(/[\\-]/g,""),r)),o=0,M0(M0(e.replace(/\\/g,"")).replace(/[0#]/g,function(b){return o<i.length?i.charAt(o++):b==="0"?"0":""}));if(e.match(IT))return i=nc(t,"##########",r),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var d="";if(a=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(a[4].length,7),c=Ig(u,Math.pow(10,o)-1,!1),i=""+h,d=ru("n",a[1],c[1]),d.charAt(d.length-1)==" "&&(d=d.substr(0,d.length-1)+"0"),i+=d+a[2]+"/"+a[3],d=Ng(c[2],o),d.length<a[4].length&&(d=us(a[4].substr(a[4].length-d.length))+d),i+=d,i;if(a=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(a[1].length,a[4].length),7),c=Ig(u,Math.pow(10,o)-1,!0),h+(c[0]||(c[1]?"":"0"))+" "+(c[1]?Sy(c[1],o)+a[2]+"/"+a[3]+Ng(c[2],o):ui(" ",2*o+1+a[2].length+a[3].length));if(a=e.match(/^[#0?]+$/))return i=""+r,e.length<=i.length?i:us(e.substr(0,e.length-i.length))+i;if(a=e.match(/^([#0]+)\.([#0]+)$/)){i=""+r.toFixed(Math.min(a[2].length,10)).replace(/([^0])0+$/,"$1"),o=i.indexOf(".");var g=e.indexOf(".")-o,x=e.length-i.length-g;return us(e.substr(0,g)+i+e.substr(e.length-x))}if(a=e.match(/^00,000\.([#0]*0)$/))return r<0?"-"+nc(t,e,-r):sf(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(b){return"00,"+(b.length<3?_l(0,3-b.length):"")+b})+"."+_l(0,a[1].length);switch(e){case"###,###":case"##,###":case"#,###":var _=sf(""+u);return _!=="0"?h+_:"";default:if(e.match(/\.[0#?]*$/))return nc(t,e.slice(0,e.lastIndexOf(".")),r)+us(e.slice(e.lastIndexOf(".")))}throw new Error("unsupported format |"+e+"|")}function ru(t,e,r){return(r|0)===r?nc(t,e,r):Lo(t,e,r)}function $O(t){for(var e=[],r=!1,n=0,i=0;n<t.length;++n)switch(t.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:e[e.length]=t.substr(i,n-i),i=n+1}if(e[e.length]=t.substr(i),r===!0)throw new Error("Format |"+t+"| unterminated string ");return e}var LT=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function cd(t){for(var e=0,r="",n="";e<t.length;)switch(r=t.charAt(e)){case"G":Cg(t,e)&&(e+=6),e++;break;case'"':for(;t.charCodeAt(++e)!==34&&e<t.length;);++e;break;case"\\":e+=2;break;case"_":e+=2;break;case"@":++e;break;case"B":case"b":if(t.charAt(e+1)==="1"||t.charAt(e+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(t.substr(e,3).toUpperCase()==="A/P"||t.substr(e,5).toUpperCase()==="AM/PM"||t.substr(e,5).toUpperCase()==="/")return!0;++e;break;case"[":for(n=r;t.charAt(e++)!=="]"&&e<t.length;)n+=t.charAt(e);if(n.match(LT))return!0;break;case".":case"0":case"#":for(;e<t.length&&("0#?.,E+-%".indexOf(r=t.charAt(++e))>-1||r=="\\"&&t.charAt(e+1)=="-"&&"0#".indexOf(t.charAt(e+2))>-1););break;case"?":for(;t.charAt(++e)===r;);break;case"*":++e,(t.charAt(e)==" "||t.charAt(e)=="*")&&++e;break;case"(":case")":++e;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;e<t.length&&"0123456789".indexOf(t.charAt(++e))>-1;);break;case" ":++e;break;default:++e;break}return!1}function QO(t,e,r,n){for(var i=[],a="",o=0,c="",u="t",h,d,g,x="H";o<t.length;)switch(c=t.charAt(o)){case"G":if(!Cg(t,o))throw new Error("unrecognized character "+c+" in "+t);i[i.length]={t:"G",v:"General"},o+=7;break;case'"':for(a="";(g=t.charCodeAt(++o))!==34&&o<t.length;)a+=String.fromCharCode(g);i[i.length]={t:"t",v:a},++o;break;case"\\":var _=t.charAt(++o),b=_==="("||_===")"?_:"t";i[i.length]={t:b,v:_},++o;break;case"_":i[i.length]={t:"t",v:" "},o+=2;break;case"@":i[i.length]={t:"T",v:e},++o;break;case"B":case"b":if(t.charAt(o+1)==="1"||t.charAt(o+1)==="2"){if(h==null&&(h=uh(e,r,t.charAt(o+1)==="2"),h==null))return"";i[i.length]={t:"X",v:t.substr(o,2)},u=c,o+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":c=c.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(e<0||h==null&&(h=uh(e,r),h==null))return"";for(a=c;++o<t.length&&t.charAt(o).toLowerCase()===c;)a+=c;c==="m"&&u.toLowerCase()==="h"&&(c="M"),c==="h"&&(c=x),i[i.length]={t:c,v:a},u=c;break;case"A":case"a":case"":var E={t:c,v:c};if(h==null&&(h=uh(e,r)),t.substr(o,3).toUpperCase()==="A/P"?(h!=null&&(E.v=h.H>=12?"P":"A"),E.t="T",x="h",o+=3):t.substr(o,5).toUpperCase()==="AM/PM"?(h!=null&&(E.v=h.H>=12?"PM":"AM"),E.t="T",o+=5,x="h"):t.substr(o,5).toUpperCase()==="/"?(h!=null&&(E.v=h.H>=12?"":""),E.t="T",o+=5,x="h"):(E.t="t",++o),h==null&&E.t==="T")return"";i[i.length]=E,u=c;break;case"[":for(a=c;t.charAt(o++)!=="]"&&o<t.length;)a+=t.charAt(o);if(a.slice(-1)!=="]")throw'unterminated "[" block: |'+a+"|";if(a.match(LT)){if(h==null&&(h=uh(e,r),h==null))return"";i[i.length]={t:"Z",v:a.toLowerCase()},u=a.charAt(1)}else a.indexOf("$")>-1&&(a=(a.match(/\$([^-\[\]]*)/)||[])[1]||"$",cd(t)||(i[i.length]={t:"t",v:a}));break;case".":if(h!=null){for(a=c;++o<t.length&&(c=t.charAt(o))==="0";)a+=c;i[i.length]={t:"s",v:a};break}case"0":case"#":for(a=c;++o<t.length&&"0#?.,E+-%".indexOf(c=t.charAt(o))>-1;)a+=c;i[i.length]={t:"n",v:a};break;case"?":for(a=c;t.charAt(++o)===c;)a+=c;i[i.length]={t:c,v:a},u=c;break;case"*":++o,(t.charAt(o)==" "||t.charAt(o)=="*")&&++o;break;case"(":case")":i[i.length]={t:n===1?"t":c,v:c},++o;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(a=c;o<t.length&&"0123456789".indexOf(t.charAt(++o))>-1;)a+=t.charAt(o);i[i.length]={t:"D",v:a};break;case" ":i[i.length]={t:c,v:c},++o;break;case"$":i[i.length]={t:"t",v:"$"},++o;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(c)===-1)throw new Error("unrecognized character "+c+" in "+t);i[i.length]={t:"t",v:c},++o;break}var A=0,O=0,M;for(o=i.length-1,u="t";o>=0;--o)switch(i[o].t){case"h":case"H":i[o].t=x,u="h",A<1&&(A=1);break;case"s":(M=i[o].v.match(/\.0+$/))&&(O=Math.max(O,M[0].length-1)),A<3&&(A=3);case"d":case"y":case"M":case"e":u=i[o].t;break;case"m":u==="s"&&(i[o].t="M",A<2&&(A=2));break;case"X":break;case"Z":A<1&&i[o].v.match(/[Hh]/)&&(A=1),A<2&&i[o].v.match(/[Mm]/)&&(A=2),A<3&&i[o].v.match(/[Ss]/)&&(A=3)}switch(A){case 0:break;case 1:h.u>=.5&&(h.u=0,++h.S),h.S>=60&&(h.S=0,++h.M),h.M>=60&&(h.M=0,++h.H);break;case 2:h.u>=.5&&(h.u=0,++h.S),h.S>=60&&(h.S=0,++h.M);break}var B="",Q;for(o=0;o<i.length;++o)switch(i[o].t){case"t":case"T":case" ":case"D":break;case"X":i[o].v="",i[o].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":i[o].v=VO(i[o].t.charCodeAt(0),i[o].v,h,O),i[o].t="t";break;case"n":case"?":for(Q=o+1;i[Q]!=null&&((c=i[Q].t)==="?"||c==="D"||(c===" "||c==="t")&&i[Q+1]!=null&&(i[Q+1].t==="?"||i[Q+1].t==="t"&&i[Q+1].v==="/")||i[o].t==="("&&(c===" "||c==="n"||c===")")||c==="t"&&(i[Q].v==="/"||i[Q].v===" "&&i[Q+1]!=null&&i[Q+1].t=="?"));)i[o].v+=i[Q].v,i[Q]={v:"",t:";"},++Q;B+=i[o].v,o=Q-1;break;case"G":i[o].t="t",i[o].v=Sh(e,r);break}var ee="",he,F;if(B.length>0){B.charCodeAt(0)==40?(he=e<0&&B.charCodeAt(0)===45?-e:e,F=ru("n",B,he)):(he=e<0&&n>1?-e:e,F=ru("n",B,he),he<0&&i[0]&&i[0].t=="t"&&(F=F.substr(1),i[0].v="-"+i[0].v)),Q=F.length-1;var k=i.length;for(o=0;o<i.length;++o)if(i[o]!=null&&i[o].t!="t"&&i[o].v.indexOf(".")>-1){k=o;break}var S=i.length;if(k===i.length&&F.indexOf("E")===-1){for(o=i.length-1;o>=0;--o)i[o]==null||"n?".indexOf(i[o].t)===-1||(Q>=i[o].v.length-1?(Q-=i[o].v.length,i[o].v=F.substr(Q+1,i[o].v.length)):Q<0?i[o].v="":(i[o].v=F.substr(0,Q+1),Q=-1),i[o].t="t",S=o);Q>=0&&S<i.length&&(i[S].v=F.substr(0,Q+1)+i[S].v)}else if(k!==i.length&&F.indexOf("E")===-1){for(Q=F.indexOf(".")-1,o=k;o>=0;--o)if(!(i[o]==null||"n?".indexOf(i[o].t)===-1)){for(d=i[o].v.indexOf(".")>-1&&o===k?i[o].v.indexOf(".")-1:i[o].v.length-1,ee=i[o].v.substr(d+1);d>=0;--d)Q>=0&&(i[o].v.charAt(d)==="0"||i[o].v.charAt(d)==="#")&&(ee=F.charAt(Q--)+ee);i[o].v=ee,i[o].t="t",S=o}for(Q>=0&&S<i.length&&(i[S].v=F.substr(0,Q+1)+i[S].v),Q=F.indexOf(".")+1,o=k;o<i.length;++o)if(!(i[o]==null||"n?(".indexOf(i[o].t)===-1&&o!==k)){for(d=i[o].v.indexOf(".")>-1&&o===k?i[o].v.indexOf(".")+1:0,ee=i[o].v.substr(0,d);d<i[o].v.length;++d)Q<F.length&&(ee+=F.charAt(Q++));i[o].v=ee,i[o].t="t",S=o}}}for(o=0;o<i.length;++o)i[o]!=null&&"n?".indexOf(i[o].t)>-1&&(he=n>1&&e<0&&o>0&&i[o-1].v==="-"?-e:e,i[o].v=ru(i[o].t,i[o].v,he),i[o].t="t");var U="";for(o=0;o!==i.length;++o)i[o]!=null&&(U+=i[o].v);return U}var l3=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function c3(t,e){if(e==null)return!1;var r=parseFloat(e[2]);switch(e[1]){case"=":if(t==r)return!0;break;case">":if(t>r)return!0;break;case"<":if(t<r)return!0;break;case"<>":if(t!=r)return!0;break;case">=":if(t>=r)return!0;break;case"<=":if(t<=r)return!0;break}return!1}function JO(t,e){var r=$O(t),n=r.length,i=r[n-1].indexOf("@");if(n<4&&i>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof e!="number")return[4,r.length===4||i>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=i>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=i>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=i>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var a=e>0?r[0]:e<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,a];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var o=r[0].match(l3),c=r[1].match(l3);return c3(e,o)?[n,r[0]]:c3(e,c)?[n,r[1]]:[n,r[o!=null&&c!=null?2:1]]}return[n,a]}function Vo(t,e,r){r==null&&(r={});var n="";switch(typeof t){case"string":t=="m/d/yy"&&r.dateNF?n=r.dateNF:n=t;break;case"number":t==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:sr)[t],n==null&&(n=r.table&&r.table[a3[t]]||sr[a3[t]]),n==null&&(n=FO[t]||"General");break}if(Cg(n,0))return Sh(e,r);e instanceof Date&&(e=ST(e,r.date1904));var i=JO(n,e);if(Cg(i[1]))return Sh(e,r);if(e===!0)e="TRUE";else if(e===!1)e="FALSE";else if(e===""||e==null)return"";return QO(i[1],e,r,i[0])}function nu(t,e){if(typeof e!="number"){e=+e||-1;for(var r=0;r<392;++r){if(sr[r]==null){e<0&&(e=r);continue}if(sr[r]==t){e=r;break}}e<0&&(e=391)}return sr[e]=t,e}function d2(t){for(var e=0;e!=392;++e)t[e]!==void 0&&nu(t[e],e)}function ud(){sr=DO()}var ZO={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},DT=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function eP(t){var e=typeof t=="number"?sr[t]:t;return e=e.replace(DT,"(\\d+)"),new RegExp("^"+e+"$")}function tP(t,e,r){var n=-1,i=-1,a=-1,o=-1,c=-1,u=-1;(e.match(DT)||[]).forEach(function(g,x){var _=parseInt(r[x+1],10);switch(g.toLowerCase().charAt(0)){case"y":n=_;break;case"d":a=_;break;case"h":o=_;break;case"s":u=_;break;case"m":o>=0?c=_:i=_;break}}),u>=0&&c==-1&&i>=0&&(c=i,i=-1);var h=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(i>=1?i:1)).slice(-2)+"-"+("00"+(a>=1?a:1)).slice(-2);h.length==7&&(h="0"+h),h.length==8&&(h="20"+h);var d=("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(c>=0?c:0)).slice(-2)+":"+("00"+(u>=0?u:0)).slice(-2);return o==-1&&c==-1&&u==-1?h:n==-1&&i==-1&&a==-1?d:h+"T"+d}var rP=function(){var t={};t.version="1.2.0";function e(){for(var F=0,k=new Array(256),S=0;S!=256;++S)F=S,F=F&1?-306674912^F>>>1:F>>>1,F=F&1?-306674912^F>>>1:F>>>1,F=F&1?-306674912^F>>>1:F>>>1,F=F&1?-306674912^F>>>1:F>>>1,F=F&1?-306674912^F>>>1:F>>>1,F=F&1?-306674912^F>>>1:F>>>1,F=F&1?-306674912^F>>>1:F>>>1,F=F&1?-306674912^F>>>1:F>>>1,k[S]=F;return typeof Int32Array<"u"?new Int32Array(k):k}var r=e();function n(F){var k=0,S=0,U=0,I=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(U=0;U!=256;++U)I[U]=F[U];for(U=0;U!=256;++U)for(S=F[U],k=256+U;k<4096;k+=256)S=I[k]=S>>>8^F[S&255];var C=[];for(U=1;U!=16;++U)C[U-1]=typeof Int32Array<"u"?I.subarray(U*256,U*256+256):I.slice(U*256,U*256+256);return C}var i=n(r),a=i[0],o=i[1],c=i[2],u=i[3],h=i[4],d=i[5],g=i[6],x=i[7],_=i[8],b=i[9],E=i[10],A=i[11],O=i[12],M=i[13],B=i[14];function Q(F,k){for(var S=k^-1,U=0,I=F.length;U<I;)S=S>>>8^r[(S^F.charCodeAt(U++))&255];return~S}function ee(F,k){for(var S=k^-1,U=F.length-15,I=0;I<U;)S=B[F[I++]^S&255]^M[F[I++]^S>>8&255]^O[F[I++]^S>>16&255]^A[F[I++]^S>>>24]^E[F[I++]]^b[F[I++]]^_[F[I++]]^x[F[I++]]^g[F[I++]]^d[F[I++]]^h[F[I++]]^u[F[I++]]^c[F[I++]]^o[F[I++]]^a[F[I++]]^r[F[I++]];for(U+=15;I<U;)S=S>>>8^r[(S^F[I++])&255];return~S}function he(F,k){for(var S=k^-1,U=0,I=F.length,C=0,R=0;U<I;)C=F.charCodeAt(U++),C<128?S=S>>>8^r[(S^C)&255]:C<2048?(S=S>>>8^r[(S^(192|C>>6&31))&255],S=S>>>8^r[(S^(128|C&63))&255]):C>=55296&&C<57344?(C=(C&1023)+64,R=F.charCodeAt(U++)&1023,S=S>>>8^r[(S^(240|C>>8&7))&255],S=S>>>8^r[(S^(128|C>>2&63))&255],S=S>>>8^r[(S^(128|R>>6&15|(C&3)<<4))&255],S=S>>>8^r[(S^(128|R&63))&255]):(S=S>>>8^r[(S^(224|C>>12&15))&255],S=S>>>8^r[(S^(128|C>>6&63))&255],S=S>>>8^r[(S^(128|C&63))&255]);return~S}return t.table=r,t.bstr=Q,t.buf=ee,t.str=he,t}(),Qt=function(){var e={};e.version="1.2.1";function r(te,be){for(var me=te.split("/"),ve=be.split("/"),we=0,Se=0,Ve=Math.min(me.length,ve.length);we<Ve;++we){if(Se=me[we].length-ve[we].length)return Se;if(me[we]!=ve[we])return me[we]<ve[we]?-1:1}return me.length-ve.length}function n(te){if(te.charAt(te.length-1)=="/")return te.slice(0,-1).indexOf("/")===-1?te:n(te.slice(0,-1));var be=te.lastIndexOf("/");return be===-1?te:te.slice(0,be+1)}function i(te){if(te.charAt(te.length-1)=="/")return i(te.slice(0,-1));var be=te.lastIndexOf("/");return be===-1?te:te.slice(be+1)}function a(te,be){typeof be=="string"&&(be=new Date(be));var me=be.getHours();me=me<<6|be.getMinutes(),me=me<<5|be.getSeconds()>>>1,te.write_shift(2,me);var ve=be.getFullYear()-1980;ve=ve<<4|be.getMonth()+1,ve=ve<<5|be.getDate(),te.write_shift(2,ve)}function o(te){var be=te.read_shift(2)&65535,me=te.read_shift(2)&65535,ve=new Date,we=me&31;me>>>=5;var Se=me&15;me>>>=4,ve.setMilliseconds(0),ve.setFullYear(me+1980),ve.setMonth(Se-1),ve.setDate(we);var Ve=be&31;be>>>=5;var $e=be&63;return be>>>=6,ve.setHours(be),ve.setMinutes($e),ve.setSeconds(Ve<<1),ve}function c(te){ka(te,0);for(var be={},me=0;te.l<=te.length-4;){var ve=te.read_shift(2),we=te.read_shift(2),Se=te.l+we,Ve={};switch(ve){case 21589:me=te.read_shift(1),me&1&&(Ve.mtime=te.read_shift(4)),we>5&&(me&2&&(Ve.atime=te.read_shift(4)),me&4&&(Ve.ctime=te.read_shift(4))),Ve.mtime&&(Ve.mt=new Date(Ve.mtime*1e3));break}te.l=Se,be[ve]=Ve}return be}var u;function h(){return u||(u={})}function d(te,be){if(te[0]==80&&te[1]==75)return hn(te,be);if((te[0]|32)==109&&(te[1]|32)==105)return ga(te,be);if(te.length<512)throw new Error("CFB file size "+te.length+" < 512");var me=3,ve=512,we=0,Se=0,Ve=0,$e=0,Me=0,He=[],Ye=te.slice(0,512);ka(Ye,0);var pt=g(Ye);switch(me=pt[0],me){case 3:ve=512;break;case 4:ve=4096;break;case 0:if(pt[1]==0)return hn(te,be);default:throw new Error("Major Version: Expected 3 or 4 saw "+me)}ve!==512&&(Ye=te.slice(0,ve),ka(Ye,28));var At=te.slice(0,ve);x(Ye,me);var Bt=Ye.read_shift(4,"i");if(me===3&&Bt!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Bt);Ye.l+=4,Ve=Ye.read_shift(4,"i"),Ye.l+=4,Ye.chk("00100000","Mini Stream Cutoff Size: "),$e=Ye.read_shift(4,"i"),we=Ye.read_shift(4,"i"),Me=Ye.read_shift(4,"i"),Se=Ye.read_shift(4,"i");for(var St=-1,Rt=0;Rt<109&&(St=Ye.read_shift(4,"i"),!(St<0));++Rt)He[Rt]=St;var er=_(te,ve);A(Me,Se,er,ve,He);var kr=M(er,Ve,He,ve);kr[Ve].name="!Directory",we>0&&$e!==R&&(kr[$e].name="!MiniFAT"),kr[He[0]].name="!FAT",kr.fat_addrs=He,kr.ssz=ve;var Nr={},Fr=[],Hi=[],ds=[];B(Ve,kr,er,Fr,we,Nr,Hi,$e),b(Hi,ds,Fr),Fr.shift();var Ri={FileIndex:Hi,FullPaths:ds};return be&&be.raw&&(Ri.raw={header:At,sectors:er}),Ri}function g(te){if(te[te.l]==80&&te[te.l+1]==75)return[0,0];te.chk(se,"Header Signature: "),te.l+=16;var be=te.read_shift(2,"u");return[te.read_shift(2,"u"),be]}function x(te,be){var me=9;switch(te.l+=2,me=te.read_shift(2)){case 9:if(be!=3)throw new Error("Sector Shift: Expected 9 saw "+me);break;case 12:if(be!=4)throw new Error("Sector Shift: Expected 12 saw "+me);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+me)}te.chk("0600","Mini Sector Shift: "),te.chk("000000000000","Reserved: ")}function _(te,be){for(var me=Math.ceil(te.length/be)-1,ve=[],we=1;we<me;++we)ve[we-1]=te.slice(we*be,(we+1)*be);return ve[me-1]=te.slice(me*be),ve}function b(te,be,me){for(var ve=0,we=0,Se=0,Ve=0,$e=0,Me=me.length,He=[],Ye=[];ve<Me;++ve)He[ve]=Ye[ve]=ve,be[ve]=me[ve];for(;$e<Ye.length;++$e)ve=Ye[$e],we=te[ve].L,Se=te[ve].R,Ve=te[ve].C,He[ve]===ve&&(we!==-1&&He[we]!==we&&(He[ve]=He[we]),Se!==-1&&He[Se]!==Se&&(He[ve]=He[Se])),Ve!==-1&&(He[Ve]=ve),we!==-1&&ve!=He[ve]&&(He[we]=He[ve],Ye.lastIndexOf(we)<$e&&Ye.push(we)),Se!==-1&&ve!=He[ve]&&(He[Se]=He[ve],Ye.lastIndexOf(Se)<$e&&Ye.push(Se));for(ve=1;ve<Me;++ve)He[ve]===ve&&(Se!==-1&&He[Se]!==Se?He[ve]=He[Se]:we!==-1&&He[we]!==we&&(He[ve]=He[we]));for(ve=1;ve<Me;++ve)if(te[ve].type!==0){if($e=ve,$e!=He[$e])do $e=He[$e],be[ve]=be[$e]+"/"+be[ve];while($e!==0&&He[$e]!==-1&&$e!=He[$e]);He[ve]=-1}for(be[0]+="/",ve=1;ve<Me;++ve)te[ve].type!==2&&(be[ve]+="/")}function E(te,be,me){for(var ve=te.start,we=te.size,Se=[],Ve=ve;me&&we>0&&Ve>=0;)Se.push(be.slice(Ve*C,Ve*C+C)),we-=C,Ve=oh(me,Ve*4);return Se.length===0?it(0):da(Se).slice(0,te.size)}function A(te,be,me,ve,we){var Se=R;if(te===R){if(be!==0)throw new Error("DIFAT chain shorter than expected")}else if(te!==-1){var Ve=me[te],$e=(ve>>>2)-1;if(!Ve)return;for(var Me=0;Me<$e&&(Se=oh(Ve,Me*4))!==R;++Me)we.push(Se);A(oh(Ve,ve-4),be-1,me,ve,we)}}function O(te,be,me,ve,we){var Se=[],Ve=[];we||(we=[]);var $e=ve-1,Me=0,He=0;for(Me=be;Me>=0;){we[Me]=!0,Se[Se.length]=Me,Ve.push(te[Me]);var Ye=me[Math.floor(Me*4/ve)];if(He=Me*4&$e,ve<4+He)throw new Error("FAT boundary crossed: "+Me+" 4 "+ve);if(!te[Ye])break;Me=oh(te[Ye],He)}return{nodes:Se,data:w3([Ve])}}function M(te,be,me,ve){var we=te.length,Se=[],Ve=[],$e=[],Me=[],He=ve-1,Ye=0,pt=0,At=0,Bt=0;for(Ye=0;Ye<we;++Ye)if($e=[],At=Ye+be,At>=we&&(At-=we),!Ve[At]){Me=[];var St=[];for(pt=At;pt>=0;){St[pt]=!0,Ve[pt]=!0,$e[$e.length]=pt,Me.push(te[pt]);var Rt=me[Math.floor(pt*4/ve)];if(Bt=pt*4&He,ve<4+Bt)throw new Error("FAT boundary crossed: "+pt+" 4 "+ve);if(!te[Rt]||(pt=oh(te[Rt],Bt),St[pt]))break}Se[At]={nodes:$e,data:w3([Me])}}return Se}function B(te,be,me,ve,we,Se,Ve,$e){for(var Me=0,He=ve.length?2:0,Ye=be[te].data,pt=0,At=0,Bt;pt<Ye.length;pt+=128){var St=Ye.slice(pt,pt+128);ka(St,64),At=St.read_shift(2),Bt=Ly(St,0,At-He),ve.push(Bt);var Rt={name:Bt,type:St.read_shift(1),color:St.read_shift(1),L:St.read_shift(4,"i"),R:St.read_shift(4,"i"),C:St.read_shift(4,"i"),clsid:St.read_shift(16),state:St.read_shift(4,"i"),start:0,size:0},er=St.read_shift(2)+St.read_shift(2)+St.read_shift(2)+St.read_shift(2);er!==0&&(Rt.ct=Q(St,St.l-8));var kr=St.read_shift(2)+St.read_shift(2)+St.read_shift(2)+St.read_shift(2);kr!==0&&(Rt.mt=Q(St,St.l-8)),Rt.start=St.read_shift(4,"i"),Rt.size=St.read_shift(4,"i"),Rt.size<0&&Rt.start<0&&(Rt.size=Rt.type=0,Rt.start=R,Rt.name=""),Rt.type===5?(Me=Rt.start,we>0&&Me!==R&&(be[Me].name="!StreamData")):Rt.size>=4096?(Rt.storage="fat",be[Rt.start]===void 0&&(be[Rt.start]=O(me,Rt.start,be.fat_addrs,be.ssz)),be[Rt.start].name=Rt.name,Rt.content=be[Rt.start].data.slice(0,Rt.size)):(Rt.storage="minifat",Rt.size<0?Rt.size=0:Me!==R&&Rt.start!==R&&be[Me]&&(Rt.content=E(Rt,be[Me].data,(be[$e]||{}).data))),Rt.content&&ka(Rt.content,0),Se[Bt]=Rt,Ve.push(Rt)}}function Q(te,be){return new Date((Zs(te,be+4)/1e7*Math.pow(2,32)+Zs(te,be)/1e7-11644473600)*1e3)}function ee(te,be){return h(),d(u.readFileSync(te),be)}function he(te,be){var me=be&&be.type;switch(me||Lr&&Buffer.isBuffer(te)&&(me="buffer"),me||"base64"){case"file":return ee(te,be);case"base64":return d(eo(so(te)),be);case"binary":return d(eo(te),be)}return d(te,be)}function F(te,be){var me=be||{},ve=me.root||"Root Entry";if(te.FullPaths||(te.FullPaths=[]),te.FileIndex||(te.FileIndex=[]),te.FullPaths.length!==te.FileIndex.length)throw new Error("inconsistent CFB structure");te.FullPaths.length===0&&(te.FullPaths[0]=ve+"/",te.FileIndex[0]={name:ve,type:5}),me.CLSID&&(te.FileIndex[0].clsid=me.CLSID),k(te)}function k(te){var be="Sh33tJ5";if(!Qt.find(te,"/"+be)){var me=it(4);me[0]=55,me[1]=me[3]=50,me[2]=54,te.FileIndex.push({name:be,type:2,content:me,size:4,L:69,R:69,C:69}),te.FullPaths.push(te.FullPaths[0]+be),S(te)}}function S(te,be){F(te);for(var me=!1,ve=!1,we=te.FullPaths.length-1;we>=0;--we){var Se=te.FileIndex[we];switch(Se.type){case 0:ve?me=!0:(te.FileIndex.pop(),te.FullPaths.pop());break;case 1:case 2:case 5:ve=!0,isNaN(Se.R*Se.L*Se.C)&&(me=!0),Se.R>-1&&Se.L>-1&&Se.R==Se.L&&(me=!0);break;default:me=!0;break}}if(!(!me&&!be)){var Ve=new Date(1987,1,19),$e=0,Me=Object.create?Object.create(null):{},He=[];for(we=0;we<te.FullPaths.length;++we)Me[te.FullPaths[we]]=!0,te.FileIndex[we].type!==0&&He.push([te.FullPaths[we],te.FileIndex[we]]);for(we=0;we<He.length;++we){var Ye=n(He[we][0]);ve=Me[Ye],ve||(He.push([Ye,{name:i(Ye).replace("/",""),type:1,clsid:J,ct:Ve,mt:Ve,content:null}]),Me[Ye]=!0)}for(He.sort(function(Bt,St){return r(Bt[0],St[0])}),te.FullPaths=[],te.FileIndex=[],we=0;we<He.length;++we)te.FullPaths[we]=He[we][0],te.FileIndex[we]=He[we][1];for(we=0;we<He.length;++we){var pt=te.FileIndex[we],At=te.FullPaths[we];if(pt.name=i(At).replace("/",""),pt.L=pt.R=pt.C=-(pt.color=1),pt.size=pt.content?pt.content.length:0,pt.start=0,pt.clsid=pt.clsid||J,we===0)pt.C=He.length>1?1:-1,pt.size=0,pt.type=5;else if(At.slice(-1)=="/"){for($e=we+1;$e<He.length&&n(te.FullPaths[$e])!=At;++$e);for(pt.C=$e>=He.length?-1:$e,$e=we+1;$e<He.length&&n(te.FullPaths[$e])!=n(At);++$e);pt.R=$e>=He.length?-1:$e,pt.type=1}else n(te.FullPaths[we+1]||"")==n(At)&&(pt.R=we+1),pt.type=2}}}function U(te,be){var me=be||{};if(me.fileType=="mad")return jt(te,me);switch(S(te),me.fileType){case"zip":return di(te,me)}var ve=function(Bt){for(var St=0,Rt=0,er=0;er<Bt.FileIndex.length;++er){var kr=Bt.FileIndex[er];if(kr.content){var Nr=kr.content.length;Nr>0&&(Nr<4096?St+=Nr+63>>6:Rt+=Nr+511>>9)}}for(var Fr=Bt.FullPaths.length+3>>2,Hi=St+7>>3,ds=St+127>>7,Ri=Hi+Rt+Fr+ds,ta=Ri+127>>7,va=ta<=109?0:Math.ceil((ta-109)/127);Ri+ta+va+127>>7>ta;)va=++ta<=109?0:Math.ceil((ta-109)/127);var Gi=[1,va,ta,ds,Fr,Rt,St,0];return Bt.FileIndex[0].size=St<<6,Gi[7]=(Bt.FileIndex[0].start=Gi[0]+Gi[1]+Gi[2]+Gi[3]+Gi[4]+Gi[5])+(Gi[6]+7>>3),Gi}(te),we=it(ve[7]<<9),Se=0,Ve=0;{for(Se=0;Se<8;++Se)we.write_shift(1,ne[Se]);for(Se=0;Se<8;++Se)we.write_shift(2,0);for(we.write_shift(2,62),we.write_shift(2,3),we.write_shift(2,65534),we.write_shift(2,9),we.write_shift(2,6),Se=0;Se<3;++Se)we.write_shift(2,0);for(we.write_shift(4,0),we.write_shift(4,ve[2]),we.write_shift(4,ve[0]+ve[1]+ve[2]+ve[3]-1),we.write_shift(4,0),we.write_shift(4,4096),we.write_shift(4,ve[3]?ve[0]+ve[1]+ve[2]-1:R),we.write_shift(4,ve[3]),we.write_shift(-4,ve[1]?ve[0]-1:R),we.write_shift(4,ve[1]),Se=0;Se<109;++Se)we.write_shift(-4,Se<ve[2]?ve[1]+Se:-1)}if(ve[1])for(Ve=0;Ve<ve[1];++Ve){for(;Se<236+Ve*127;++Se)we.write_shift(-4,Se<ve[2]?ve[1]+Se:-1);we.write_shift(-4,Ve===ve[1]-1?R:Ve+1)}var $e=function(Bt){for(Ve+=Bt;Se<Ve-1;++Se)we.write_shift(-4,Se+1);Bt&&(++Se,we.write_shift(-4,R))};for(Ve=Se=0,Ve+=ve[1];Se<Ve;++Se)we.write_shift(-4,de.DIFSECT);for(Ve+=ve[2];Se<Ve;++Se)we.write_shift(-4,de.FATSECT);$e(ve[3]),$e(ve[4]);for(var Me=0,He=0,Ye=te.FileIndex[0];Me<te.FileIndex.length;++Me)Ye=te.FileIndex[Me],Ye.content&&(He=Ye.content.length,!(He<4096)&&(Ye.start=Ve,$e(He+511>>9)));for($e(ve[6]+7>>3);we.l&511;)we.write_shift(-4,de.ENDOFCHAIN);for(Ve=Se=0,Me=0;Me<te.FileIndex.length;++Me)Ye=te.FileIndex[Me],Ye.content&&(He=Ye.content.length,!(!He||He>=4096)&&(Ye.start=Ve,$e(He+63>>6)));for(;we.l&511;)we.write_shift(-4,de.ENDOFCHAIN);for(Se=0;Se<ve[4]<<2;++Se){var pt=te.FullPaths[Se];if(!pt||pt.length===0){for(Me=0;Me<17;++Me)we.write_shift(4,0);for(Me=0;Me<3;++Me)we.write_shift(4,-1);for(Me=0;Me<12;++Me)we.write_shift(4,0);continue}Ye=te.FileIndex[Se],Se===0&&(Ye.start=Ye.size?Ye.start-1:R);var At=Se===0&&me.root||Ye.name;if(He=2*(At.length+1),we.write_shift(64,At,"utf16le"),we.write_shift(2,He),we.write_shift(1,Ye.type),we.write_shift(1,Ye.color),we.write_shift(-4,Ye.L),we.write_shift(-4,Ye.R),we.write_shift(-4,Ye.C),Ye.clsid)we.write_shift(16,Ye.clsid,"hex");else for(Me=0;Me<4;++Me)we.write_shift(4,0);we.write_shift(4,Ye.state||0),we.write_shift(4,0),we.write_shift(4,0),we.write_shift(4,0),we.write_shift(4,0),we.write_shift(4,Ye.start),we.write_shift(4,Ye.size),we.write_shift(4,0)}for(Se=1;Se<te.FileIndex.length;++Se)if(Ye=te.FileIndex[Se],Ye.size>=4096)if(we.l=Ye.start+1<<9,Lr&&Buffer.isBuffer(Ye.content))Ye.content.copy(we,we.l,0,Ye.size),we.l+=Ye.size+511&-512;else{for(Me=0;Me<Ye.size;++Me)we.write_shift(1,Ye.content[Me]);for(;Me&511;++Me)we.write_shift(1,0)}for(Se=1;Se<te.FileIndex.length;++Se)if(Ye=te.FileIndex[Se],Ye.size>0&&Ye.size<4096)if(Lr&&Buffer.isBuffer(Ye.content))Ye.content.copy(we,we.l,0,Ye.size),we.l+=Ye.size+63&-64;else{for(Me=0;Me<Ye.size;++Me)we.write_shift(1,Ye.content[Me]);for(;Me&63;++Me)we.write_shift(1,0)}if(Lr)we.l=we.length;else for(;we.l<we.length;)we.write_shift(1,0);return we}function I(te,be){var me=te.FullPaths.map(function(Me){return Me.toUpperCase()}),ve=me.map(function(Me){var He=Me.split("/");return He[He.length-(Me.slice(-1)=="/"?2:1)]}),we=!1;be.charCodeAt(0)===47?(we=!0,be=me[0].slice(0,-1)+be):we=be.indexOf("/")!==-1;var Se=be.toUpperCase(),Ve=we===!0?me.indexOf(Se):ve.indexOf(Se);if(Ve!==-1)return te.FileIndex[Ve];var $e=!Se.match(c1);for(Se=Se.replace(hs,""),$e&&(Se=Se.replace(c1,"!")),Ve=0;Ve<me.length;++Ve)if(($e?me[Ve].replace(c1,"!"):me[Ve]).replace(hs,"")==Se||($e?ve[Ve].replace(c1,"!"):ve[Ve]).replace(hs,"")==Se)return te.FileIndex[Ve];return null}var C=64,R=-2,se="d0cf11e0a1b11ae1",ne=[208,207,17,224,161,177,26,225],J="00000000000000000000000000000000",de={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:R,FREESECT:-1,HEADER_SIGNATURE:se,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:J,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function oe(te,be,me){h();var ve=U(te,me);u.writeFileSync(be,ve)}function Z(te){for(var be=new Array(te.length),me=0;me<te.length;++me)be[me]=String.fromCharCode(te[me]);return be.join("")}function X(te,be){var me=U(te,be);switch(be&&be.type||"buffer"){case"file":return h(),u.writeFileSync(be.filename,me),me;case"binary":return typeof me=="string"?me:Z(me);case"base64":return B1(typeof me=="string"?me:Z(me));case"buffer":if(Lr)return Buffer.isBuffer(me)?me:fu(me);case"array":return typeof me=="string"?eo(me):me}return me}var xe;function L(te){try{var be=te.InflateRaw,me=new be;if(me._processChunk(new Uint8Array([3,0]),me._finishFlushFlag),me.bytesRead)xe=te;else throw new Error("zlib does not expose bytesRead")}catch(ve){console.error("cannot use native zlib: "+(ve.message||ve))}}function j(te,be){if(!xe)return Tr(te,be);var me=xe.InflateRaw,ve=new me,we=ve._processChunk(te.slice(te.l),ve._finishFlushFlag);return te.l+=ve.bytesRead,we}function z(te){return xe?xe.deflateRawSync(te):Nt(te)}var G=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],ae=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],Ae=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function _e(te){var be=(te<<1|te<<11)&139536|(te<<5|te<<15)&558144;return(be>>16|be>>8|be)&255}for(var Ee=typeof Uint8Array<"u",Ce=Ee?new Uint8Array(256):[],Oe=0;Oe<256;++Oe)Ce[Oe]=_e(Oe);function fe(te,be){var me=Ce[te&255];return be<=8?me>>>8-be:(me=me<<8|Ce[te>>8&255],be<=16?me>>>16-be:(me=me<<8|Ce[te>>16&255],me>>>24-be))}function rt(te,be){var me=be&7,ve=be>>>3;return(te[ve]|(me<=6?0:te[ve+1]<<8))>>>me&3}function ot(te,be){var me=be&7,ve=be>>>3;return(te[ve]|(me<=5?0:te[ve+1]<<8))>>>me&7}function Pe(te,be){var me=be&7,ve=be>>>3;return(te[ve]|(me<=4?0:te[ve+1]<<8))>>>me&15}function ge(te,be){var me=be&7,ve=be>>>3;return(te[ve]|(me<=3?0:te[ve+1]<<8))>>>me&31}function Je(te,be){var me=be&7,ve=be>>>3;return(te[ve]|(me<=1?0:te[ve+1]<<8))>>>me&127}function nt(te,be,me){var ve=be&7,we=be>>>3,Se=(1<<me)-1,Ve=te[we]>>>ve;return me<8-ve||(Ve|=te[we+1]<<8-ve,me<16-ve)||(Ve|=te[we+2]<<16-ve,me<24-ve)||(Ve|=te[we+3]<<24-ve),Ve&Se}function et(te,be,me){var ve=be&7,we=be>>>3;return ve<=5?te[we]|=(me&7)<<ve:(te[we]|=me<<ve&255,te[we+1]=(me&7)>>8-ve),be+3}function vt(te,be,me){var ve=be&7,we=be>>>3;return me=(me&1)<<ve,te[we]|=me,be+1}function Et(te,be,me){var ve=be&7,we=be>>>3;return me<<=ve,te[we]|=me&255,me>>>=8,te[we+1]=me,be+8}function bt(te,be,me){var ve=be&7,we=be>>>3;return me<<=ve,te[we]|=me&255,me>>>=8,te[we+1]=me&255,te[we+2]=me>>>8,be+16}function Mt(te,be){var me=te.length,ve=2*me>be?2*me:be+5,we=0;if(me>=be)return te;if(Lr){var Se=r3(ve);if(te.copy)te.copy(Se);else for(;we<te.length;++we)Se[we]=te[we];return Se}else if(Ee){var Ve=new Uint8Array(ve);if(Ve.set)Ve.set(te);else for(;we<me;++we)Ve[we]=te[we];return Ve}return te.length=ve,te}function Dt(te){for(var be=new Array(te),me=0;me<te;++me)be[me]=0;return be}function qt(te,be,me){var ve=1,we=0,Se=0,Ve=0,$e=0,Me=te.length,He=Ee?new Uint16Array(32):Dt(32);for(Se=0;Se<32;++Se)He[Se]=0;for(Se=Me;Se<me;++Se)te[Se]=0;Me=te.length;var Ye=Ee?new Uint16Array(Me):Dt(Me);for(Se=0;Se<Me;++Se)He[we=te[Se]]++,ve<we&&(ve=we),Ye[Se]=0;for(He[0]=0,Se=1;Se<=ve;++Se)He[Se+16]=$e=$e+He[Se-1]<<1;for(Se=0;Se<Me;++Se)$e=te[Se],$e!=0&&(Ye[Se]=He[$e+16]++);var pt=0;for(Se=0;Se<Me;++Se)if(pt=te[Se],pt!=0)for($e=fe(Ye[Se],ve)>>ve-pt,Ve=(1<<ve+4-pt)-1;Ve>=0;--Ve)be[$e|Ve<<pt]=pt&15|Se<<4;return ve}var Tt=Ee?new Uint16Array(512):Dt(512),kt=Ee?new Uint16Array(32):Dt(32);if(!Ee){for(var zt=0;zt<512;++zt)Tt[zt]=0;for(zt=0;zt<32;++zt)kt[zt]=0}(function(){for(var te=[],be=0;be<32;be++)te.push(5);qt(te,kt,32);var me=[];for(be=0;be<=143;be++)me.push(8);for(;be<=255;be++)me.push(9);for(;be<=279;be++)me.push(7);for(;be<=287;be++)me.push(8);qt(me,Tt,288)})();var Pt=function(){for(var be=Ee?new Uint8Array(32768):[],me=0,ve=0;me<Ae.length-1;++me)for(;ve<Ae[me+1];++ve)be[ve]=me;for(;ve<32768;++ve)be[ve]=29;var we=Ee?new Uint8Array(259):[];for(me=0,ve=0;me<ae.length-1;++me)for(;ve<ae[me+1];++ve)we[ve]=me;function Se($e,Me){for(var He=0;He<$e.length;){var Ye=Math.min(65535,$e.length-He),pt=He+Ye==$e.length;for(Me.write_shift(1,+pt),Me.write_shift(2,Ye),Me.write_shift(2,~Ye&65535);Ye-- >0;)Me[Me.l++]=$e[He++]}return Me.l}function Ve($e,Me){for(var He=0,Ye=0,pt=Ee?new Uint16Array(32768):[];Ye<$e.length;){var At=Math.min(65535,$e.length-Ye);if(At<10){for(He=et(Me,He,+(Ye+At==$e.length)),He&7&&(He+=8-(He&7)),Me.l=He/8|0,Me.write_shift(2,At),Me.write_shift(2,~At&65535);At-- >0;)Me[Me.l++]=$e[Ye++];He=Me.l*8;continue}He=et(Me,He,+(Ye+At==$e.length)+2);for(var Bt=0;At-- >0;){var St=$e[Ye];Bt=(Bt<<5^St)&32767;var Rt=-1,er=0;if((Rt=pt[Bt])&&(Rt|=Ye&-32768,Rt>Ye&&(Rt-=32768),Rt<Ye))for(;$e[Rt+er]==$e[Ye+er]&&er<250;)++er;if(er>2){St=we[er],St<=22?He=Et(Me,He,Ce[St+1]>>1)-1:(Et(Me,He,3),He+=5,Et(Me,He,Ce[St-23]>>5),He+=3);var kr=St<8?0:St-4>>2;kr>0&&(bt(Me,He,er-ae[St]),He+=kr),St=be[Ye-Rt],He=Et(Me,He,Ce[St]>>3),He-=3;var Nr=St<4?0:St-2>>1;Nr>0&&(bt(Me,He,Ye-Rt-Ae[St]),He+=Nr);for(var Fr=0;Fr<er;++Fr)pt[Bt]=Ye&32767,Bt=(Bt<<5^$e[Ye])&32767,++Ye;At-=er-1}else St<=143?St=St+48:He=vt(Me,He,1),He=Et(Me,He,Ce[St]),pt[Bt]=Ye&32767,++Ye}He=Et(Me,He,0)-1}return Me.l=(He+7)/8|0,Me.l}return function(Me,He){return Me.length<8?Se(Me,He):Ve(Me,He)}}();function Nt(te){var be=it(50+Math.floor(te.length*1.1)),me=Pt(te,be);return be.slice(0,me)}var _t=Ee?new Uint16Array(32768):Dt(32768),or=Ee?new Uint16Array(32768):Dt(32768),Gt=Ee?new Uint16Array(128):Dt(128),zr=1,yr=1;function Qr(te,be){var me=ge(te,be)+257;be+=5;var ve=ge(te,be)+1;be+=5;var we=Pe(te,be)+4;be+=4;for(var Se=0,Ve=Ee?new Uint8Array(19):Dt(19),$e=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],Me=1,He=Ee?new Uint8Array(8):Dt(8),Ye=Ee?new Uint8Array(8):Dt(8),pt=Ve.length,At=0;At<we;++At)Ve[G[At]]=Se=ot(te,be),Me<Se&&(Me=Se),He[Se]++,be+=3;var Bt=0;for(He[0]=0,At=1;At<=Me;++At)Ye[At]=Bt=Bt+He[At-1]<<1;for(At=0;At<pt;++At)(Bt=Ve[At])!=0&&($e[At]=Ye[Bt]++);var St=0;for(At=0;At<pt;++At)if(St=Ve[At],St!=0){Bt=Ce[$e[At]]>>8-St;for(var Rt=(1<<7-St)-1;Rt>=0;--Rt)Gt[Bt|Rt<<St]=St&7|At<<3}var er=[];for(Me=1;er.length<me+ve;)switch(Bt=Gt[Je(te,be)],be+=Bt&7,Bt>>>=3){case 16:for(Se=3+rt(te,be),be+=2,Bt=er[er.length-1];Se-- >0;)er.push(Bt);break;case 17:for(Se=3+ot(te,be),be+=3;Se-- >0;)er.push(0);break;case 18:for(Se=11+Je(te,be),be+=7;Se-- >0;)er.push(0);break;default:er.push(Bt),Me<Bt&&(Me=Bt);break}var kr=er.slice(0,me),Nr=er.slice(me);for(At=me;At<286;++At)kr[At]=0;for(At=ve;At<30;++At)Nr[At]=0;return zr=qt(kr,_t,286),yr=qt(Nr,or,30),be}function Ii(te,be){if(te[0]==3&&!(te[1]&3))return[wf(be),2];for(var me=0,ve=0,we=r3(be||1<<18),Se=0,Ve=we.length>>>0,$e=0,Me=0;(ve&1)==0;){if(ve=ot(te,me),me+=3,ve>>>1)ve>>1==1?($e=9,Me=5):(me=Qr(te,me),$e=zr,Me=yr);else{me&7&&(me+=8-(me&7));var He=te[me>>>3]|te[(me>>>3)+1]<<8;if(me+=32,He>0)for(!be&&Ve<Se+He&&(we=Mt(we,Se+He),Ve=we.length);He-- >0;)we[Se++]=te[me>>>3],me+=8;continue}for(;;){!be&&Ve<Se+32767&&(we=Mt(we,Se+32767),Ve=we.length);var Ye=nt(te,me,$e),pt=ve>>>1==1?Tt[Ye]:_t[Ye];if(me+=pt&15,pt>>>=4,(pt>>>8&255)===0)we[Se++]=pt;else{if(pt==256)break;pt-=257;var At=pt<8?0:pt-4>>2;At>5&&(At=0);var Bt=Se+ae[pt];At>0&&(Bt+=nt(te,me,At),me+=At),Ye=nt(te,me,Me),pt=ve>>>1==1?kt[Ye]:or[Ye],me+=pt&15,pt>>>=4;var St=pt<4?0:pt-2>>1,Rt=Ae[pt];for(St>0&&(Rt+=nt(te,me,St),me+=St),!be&&Ve<Bt&&(we=Mt(we,Bt+100),Ve=we.length);Se<Bt;)we[Se]=we[Se-Rt],++Se}}}return be?[we,me+7>>>3]:[we.slice(0,Se),me+7>>>3]}function Tr(te,be){var me=te.slice(te.l||0),ve=Ii(me,be);return te.l+=ve[1],ve[0]}function Ra(te,be){if(te)typeof console<"u"&&console.error(be);else throw new Error(be)}function hn(te,be){var me=te;ka(me,0);var ve=[],we=[],Se={FileIndex:ve,FullPaths:we};F(Se,{root:be.root});for(var Ve=me.length-4;(me[Ve]!=80||me[Ve+1]!=75||me[Ve+2]!=5||me[Ve+3]!=6)&&Ve>=0;)--Ve;me.l=Ve+4,me.l+=4;var $e=me.read_shift(2);me.l+=6;var Me=me.read_shift(4);for(me.l=Me,Ve=0;Ve<$e;++Ve){me.l+=20;var He=me.read_shift(4),Ye=me.read_shift(4),pt=me.read_shift(2),At=me.read_shift(2),Bt=me.read_shift(2);me.l+=8;var St=me.read_shift(4),Rt=c(me.slice(me.l+pt,me.l+pt+At));me.l+=pt+At+Bt;var er=me.l;me.l=St+4,Yn(me,He,Ye,Se,Rt),me.l=er}return Se}function Yn(te,be,me,ve,we){te.l+=2;var Se=te.read_shift(2),Ve=te.read_shift(2),$e=o(te);if(Se&8257)throw new Error("Unsupported ZIP encryption");for(var Me=te.read_shift(4),He=te.read_shift(4),Ye=te.read_shift(4),pt=te.read_shift(2),At=te.read_shift(2),Bt="",St=0;St<pt;++St)Bt+=String.fromCharCode(te[te.l++]);if(At){var Rt=c(te.slice(te.l,te.l+At));(Rt[21589]||{}).mt&&($e=Rt[21589].mt),((we||{})[21589]||{}).mt&&($e=we[21589].mt)}te.l+=At;var er=te.slice(te.l,te.l+He);switch(Ve){case 8:er=j(te,Ye);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+Ve)}var kr=!1;Se&8&&(Me=te.read_shift(4),Me==134695760&&(Me=te.read_shift(4),kr=!0),He=te.read_shift(4),Ye=te.read_shift(4)),He!=be&&Ra(kr,"Bad compressed size: "+be+" != "+He),Ye!=me&&Ra(kr,"Bad uncompressed size: "+me+" != "+Ye),Hr(ve,Bt,er,{unsafe:!0,mt:$e})}function di(te,be){var me=be||{},ve=[],we=[],Se=it(1),Ve=me.compression?8:0,$e=0,Me=0,He=0,Ye=0,pt=0,At=te.FullPaths[0],Bt=At,St=te.FileIndex[0],Rt=[],er=0;for(Me=1;Me<te.FullPaths.length;++Me)if(Bt=te.FullPaths[Me].slice(At.length),St=te.FileIndex[Me],!(!St.size||!St.content||Bt=="Sh33tJ5")){var kr=Ye,Nr=it(Bt.length);for(He=0;He<Bt.length;++He)Nr.write_shift(1,Bt.charCodeAt(He)&127);Nr=Nr.slice(0,Nr.l),Rt[pt]=rP.buf(St.content,0);var Fr=St.content;Ve==8&&(Fr=z(Fr)),Se=it(30),Se.write_shift(4,67324752),Se.write_shift(2,20),Se.write_shift(2,$e),Se.write_shift(2,Ve),St.mt?a(Se,St.mt):Se.write_shift(4,0),Se.write_shift(-4,Rt[pt]),Se.write_shift(4,Fr.length),Se.write_shift(4,St.content.length),Se.write_shift(2,Nr.length),Se.write_shift(2,0),Ye+=Se.length,ve.push(Se),Ye+=Nr.length,ve.push(Nr),Ye+=Fr.length,ve.push(Fr),Se=it(46),Se.write_shift(4,33639248),Se.write_shift(2,0),Se.write_shift(2,20),Se.write_shift(2,$e),Se.write_shift(2,Ve),Se.write_shift(4,0),Se.write_shift(-4,Rt[pt]),Se.write_shift(4,Fr.length),Se.write_shift(4,St.content.length),Se.write_shift(2,Nr.length),Se.write_shift(2,0),Se.write_shift(2,0),Se.write_shift(2,0),Se.write_shift(2,0),Se.write_shift(4,0),Se.write_shift(4,kr),er+=Se.l,we.push(Se),er+=Nr.length,we.push(Nr),++pt}return Se=it(22),Se.write_shift(4,101010256),Se.write_shift(2,0),Se.write_shift(2,0),Se.write_shift(2,pt),Se.write_shift(2,pt),Se.write_shift(4,er),Se.write_shift(4,Ye),Se.write_shift(2,0),da([da(ve),da(we),Se])}var Jr={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function Kt(te,be){if(te.ctype)return te.ctype;var me=te.name||"",ve=me.match(/\.([^\.]+)$/);return ve&&Jr[ve[1]]||be&&(ve=(me=be).match(/[\.\\]([^\.\\])+$/),ve&&Jr[ve[1]])?Jr[ve[1]]:"application/octet-stream"}function Dr(te){for(var be=B1(te),me=[],ve=0;ve<be.length;ve+=76)me.push(be.slice(ve,ve+76));return me.join(`\r
`)+`\r
`}function ea(te){var be=te.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(He){var Ye=He.charCodeAt(0).toString(16).toUpperCase();return"="+(Ye.length==1?"0"+Ye:Ye)});be=be.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),be.charAt(0)==`
`&&(be="=0D"+be.slice(1)),be=be.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var me=[],ve=be.split(`\r
`),we=0;we<ve.length;++we){var Se=ve[we];if(Se.length==0){me.push("");continue}for(var Ve=0;Ve<Se.length;){var $e=76,Me=Se.slice(Ve,Ve+$e);Me.charAt($e-1)=="="?$e--:Me.charAt($e-2)=="="?$e-=2:Me.charAt($e-3)=="="&&($e-=3),Me=Se.slice(Ve,Ve+$e),Ve+=$e,Ve<Se.length&&(Me+="="),me.push(Me)}}return me.join(`\r
`)}function Dn(te){for(var be=[],me=0;me<te.length;++me){for(var ve=te[me];me<=te.length&&ve.charAt(ve.length-1)=="=";)ve=ve.slice(0,ve.length-1)+te[++me];be.push(ve)}for(var we=0;we<be.length;++we)be[we]=be[we].replace(/[=][0-9A-Fa-f]{2}/g,function(Se){return String.fromCharCode(parseInt(Se.slice(1),16))});return eo(be.join(`\r
`))}function pi(te,be,me){for(var ve="",we="",Se="",Ve,$e=0;$e<10;++$e){var Me=be[$e];if(!Me||Me.match(/^\s*$/))break;var He=Me.match(/^(.*?):\s*([^\s].*)$/);if(He)switch(He[1].toLowerCase()){case"content-location":ve=He[2].trim();break;case"content-type":Se=He[2].trim();break;case"content-transfer-encoding":we=He[2].trim();break}}switch(++$e,we.toLowerCase()){case"base64":Ve=eo(so(be.slice($e).join("")));break;case"quoted-printable":Ve=Dn(be.slice($e));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+we)}var Ye=Hr(te,ve.slice(me.length),Ve,{unsafe:!0});Se&&(Ye.ctype=Se)}function ga(te,be){if(Z(te.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var me=be&&be.root||"",ve=(Lr&&Buffer.isBuffer(te)?te.toString("binary"):Z(te)).split(`\r
`),we=0,Se="";for(we=0;we<ve.length;++we)if(Se=ve[we],!!/^Content-Location:/i.test(Se)&&(Se=Se.slice(Se.indexOf("file")),me||(me=Se.slice(0,Se.lastIndexOf("/")+1)),Se.slice(0,me.length)!=me))for(;me.length>0&&(me=me.slice(0,me.length-1),me=me.slice(0,me.lastIndexOf("/")+1),Se.slice(0,me.length)!=me););var Ve=(ve[1]||"").match(/boundary="(.*?)"/);if(!Ve)throw new Error("MAD cannot find boundary");var $e="--"+(Ve[1]||""),Me=[],He=[],Ye={FileIndex:Me,FullPaths:He};F(Ye);var pt,At=0;for(we=0;we<ve.length;++we){var Bt=ve[we];Bt!==$e&&Bt!==$e+"--"||(At++&&pi(Ye,ve.slice(pt,we),me),pt=we)}return Ye}function jt(te,be){var me=be||{},ve=me.boundary||"SheetJS";ve="------="+ve;for(var we=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+ve.slice(2)+'"',"","",""],Se=te.FullPaths[0],Ve=Se,$e=te.FileIndex[0],Me=1;Me<te.FullPaths.length;++Me)if(Ve=te.FullPaths[Me].slice(Se.length),$e=te.FileIndex[Me],!(!$e.size||!$e.content||Ve=="Sh33tJ5")){Ve=Ve.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(er){return"_x"+er.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(er){return"_u"+er.charCodeAt(0).toString(16)+"_"});for(var He=$e.content,Ye=Lr&&Buffer.isBuffer(He)?He.toString("binary"):Z(He),pt=0,At=Math.min(1024,Ye.length),Bt=0,St=0;St<=At;++St)(Bt=Ye.charCodeAt(St))>=32&&Bt<128&&++pt;var Rt=pt>=At*4/5;we.push(ve),we.push("Content-Location: "+(me.root||"file:///C:/SheetJS/")+Ve),we.push("Content-Transfer-Encoding: "+(Rt?"quoted-printable":"base64")),we.push("Content-Type: "+Kt($e,Ve)),we.push(""),we.push(Rt?ea(Ye):Dr(Ye))}return we.push(ve+`--\r
`),we.join(`\r
`)}function Zr(te){var be={};return F(be,te),be}function Hr(te,be,me,ve){var we=ve&&ve.unsafe;we||F(te);var Se=!we&&Qt.find(te,be);if(!Se){var Ve=te.FullPaths[0];be.slice(0,Ve.length)==Ve?Ve=be:(Ve.slice(-1)!="/"&&(Ve+="/"),Ve=(Ve+be).replace("//","/")),Se={name:i(be),type:2},te.FileIndex.push(Se),te.FullPaths.push(Ve),we||Qt.utils.cfb_gc(te)}return Se.content=me,Se.size=me?me.length:0,ve&&(ve.CLSID&&(Se.clsid=ve.CLSID),ve.mt&&(Se.mt=ve.mt),ve.ct&&(Se.ct=ve.ct)),Se}function gn(te,be){F(te);var me=Qt.find(te,be);if(me){for(var ve=0;ve<te.FileIndex.length;++ve)if(te.FileIndex[ve]==me)return te.FileIndex.splice(ve,1),te.FullPaths.splice(ve,1),!0}return!1}function In(te,be,me){F(te);var ve=Qt.find(te,be);if(ve){for(var we=0;we<te.FileIndex.length;++we)if(te.FileIndex[we]==ve)return te.FileIndex[we].name=i(me),te.FullPaths[we]=me,!0}return!1}function Fn(te){S(te,!0)}return e.find=I,e.read=he,e.parse=d,e.write=X,e.writeFile=oe,e.utils={cfb_new:Zr,cfb_add:Hr,cfb_del:gn,cfb_mov:In,cfb_gc:Fn,ReadShift:v1,CheckField:t6,prep_blob:ka,bconcat:da,use_zlib:L,_deflateRaw:Nt,_inflateRaw:Tr,consts:de},e}();function nP(t){return typeof t=="string"?h2(t):Array.isArray(t)?CO(t):t}function dp(t,e,r){if(typeof Deno<"u"){if(r&&typeof e=="string")switch(r){case"utf8":e=new TextEncoder(r).encode(e);break;case"binary":e=h2(e);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(t,e)}var n=r=="utf8"?oc(e):e;if(typeof IE_SaveFile<"u")return IE_SaveFile(n,t);if(typeof Blob<"u"){var i=new Blob([nP(n)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(i,t);if(typeof saveAs<"u")return saveAs(i,t);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var a=URL.createObjectURL(i);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(a)},6e4),chrome.downloads.download({url:a,filename:t,saveAs:!0});var o=document.createElement("a");if(o.download!=null)return o.download=t,o.href=a,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(a)},6e4),a}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var c=File(t);return c.open("w"),c.encoding="binary",Array.isArray(e)&&(e=Df(e)),c.write(e),c.close(),e}catch(u){if(!u.message||!u.message.match(/onstruct/))throw u}throw new Error("cannot save file "+t)}function iP(t){if(typeof Deno<"u")return Deno.readFileSync(t);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var e=File(t);e.open("r"),e.encoding="binary";var r=e.read();return e.close(),r}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+t)}function hi(t){for(var e=Object.keys(t),r=[],n=0;n<e.length;++n)Object.prototype.hasOwnProperty.call(t,e[n])&&r.push(e[n]);return r}function u3(t,e){for(var r=[],n=hi(t),i=0;i!==n.length;++i)r[t[n[i]][e]]==null&&(r[t[n[i]][e]]=n[i]);return r}function p2(t){for(var e=[],r=hi(t),n=0;n!==r.length;++n)e[t[r[n]]]=r[n];return e}function m2(t){for(var e=[],r=hi(t),n=0;n!==r.length;++n)e[t[r[n]]]=parseInt(r[n],10);return e}function aP(t){for(var e=[],r=hi(t),n=0;n!==r.length;++n)e[t[r[n]]]==null&&(e[t[r[n]]]=[]),e[t[r[n]]].push(r[n]);return e}var Rg=new Date(1899,11,30,0,0,0);function Zi(t,e){var r=t.getTime(),n=Rg.getTime()+(t.getTimezoneOffset()-Rg.getTimezoneOffset())*6e4;return(r-n)/(24*60*60*1e3)}var FT=new Date,sP=Rg.getTime()+(FT.getTimezoneOffset()-Rg.getTimezoneOffset())*6e4,f3=FT.getTimezoneOffset();function g2(t){var e=new Date;return e.setTime(t*24*60*60*1e3+sP),e.getTimezoneOffset()!==f3&&e.setTime(e.getTime()+(e.getTimezoneOffset()-f3)*6e4),e}function oP(t){var e=0,r=0,n=!1,i=t.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!i)throw new Error("|"+t+"| is not an ISO8601 Duration");for(var a=1;a!=i.length;++a)if(i[a]){switch(r=1,a>3&&(n=!0),i[a].slice(i[a].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+i[a].slice(i[a].length-1));case"D":r*=24;case"H":r*=60;case"M":if(n)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}e+=r*parseInt(i[a],10)}return e}var h3=new Date("2017-02-19T19:06:09.000Z"),OT=isNaN(h3.getFullYear())?new Date("2/19/17"):h3,lP=OT.getFullYear()==2017;function qn(t,e){var r=new Date(t);if(lP)return e>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):e<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(t instanceof Date)return t;if(OT.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return t.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var i=t.match(/\d+/g)||["2017","2","19","0","0","0"],a=new Date(+i[0],+i[1]-1,+i[2],+i[3]||0,+i[4]||0,+i[5]||0);return t.indexOf("Z")>-1&&(a=new Date(a.getTime()-a.getTimezoneOffset()*60*1e3)),a}function Ah(t,e){if(Lr&&Buffer.isBuffer(t)){if(e){if(t[0]==255&&t[1]==254)return oc(t.slice(2).toString("utf16le"));if(t[1]==254&&t[2]==255)return oc(ET(t.slice(2).toString("binary")))}return t.toString("binary")}if(typeof TextDecoder<"u")try{if(e){if(t[0]==255&&t[1]==254)return oc(new TextDecoder("utf-16le").decode(t.slice(2)));if(t[0]==254&&t[1]==255)return oc(new TextDecoder("utf-16be").decode(t.slice(2)))}var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(t)&&(t=new Uint8Array(t)),new TextDecoder("latin1").decode(t).replace(/[]/g,function(a){return r[a]||a})}catch{}for(var n=[],i=0;i!=t.length;++i)n.push(String.fromCharCode(t[i]));return n.join("")}function zn(t){if(typeof JSON<"u"&&!Array.isArray(t))return JSON.parse(JSON.stringify(t));if(typeof t!="object"||t==null)return t;if(t instanceof Date)return new Date(t.getTime());var e={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=zn(t[r]));return e}function ui(t,e){for(var r="";r.length<e;)r+=t;return r}function xl(t){var e=Number(t);if(!isNaN(e))return isFinite(e)?e:NaN;if(!/\d/.test(t))return e;var r=1,n=t.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(e=Number(n))||(n=n.replace(/[(](.*)[)]/,function(i,a){return r=-r,a}),!isNaN(e=Number(n)))?e/r:e}var cP=["january","february","march","april","may","june","july","august","september","october","november","december"];function Q0(t){var e=new Date(t),r=new Date(NaN),n=e.getYear(),i=e.getMonth(),a=e.getDate();if(isNaN(a))return r;var o=t.toLowerCase();if(o.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(o=o.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),o.length>3&&cP.indexOf(o)==-1)return r}else if(o.match(/[a-z]/))return r;return n<0||n>8099?r:(i>0||a>1)&&n!=101?e:t.match(/[^-0-9:,\/\\]/)?r:e}var uP=function(){var t="abacaba".split(/(:?b)/i).length==5;return function(r,n,i){if(t||typeof n=="string")return r.split(n);for(var a=r.split(n),o=[a[0]],c=1;c<a.length;++c)o.push(i),o.push(a[c]);return o}}();function PT(t){return t?t.content&&t.type?Ah(t.content,!0):t.data?l1(t.data):t.asNodeBuffer&&Lr?l1(t.asNodeBuffer().toString("binary")):t.asBinary?l1(t.asBinary()):t._data&&t._data.getContent?l1(Ah(Array.prototype.slice.call(t._data.getContent(),0))):null:null}function MT(t){if(!t)return null;if(t.data)return e3(t.data);if(t.asNodeBuffer&&Lr)return t.asNodeBuffer();if(t._data&&t._data.getContent){var e=t._data.getContent();return typeof e=="string"?e3(e):Array.prototype.slice.call(e)}return t.content&&t.type?t.content:null}function fP(t){return t&&t.name.slice(-4)===".bin"?MT(t):PT(t)}function Oo(t,e){for(var r=t.FullPaths||hi(t.files),n=e.toLowerCase().replace(/[\/]/g,"\\"),i=n.replace(/\\/g,"/"),a=0;a<r.length;++a){var o=r[a].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==o||i==o)return t.files?t.files[r[a]]:t.FileIndex[a]}return null}function Ty(t,e){var r=Oo(t,e);if(r==null)throw new Error("Cannot find file "+e+" in zip");return r}function ji(t,e,r){if(!r)return fP(Ty(t,e));if(!e)return null;try{return ji(t,e)}catch{return null}}function to(t,e,r){if(!r)return PT(Ty(t,e));if(!e)return null;try{return to(t,e)}catch{return null}}function hP(t,e,r){return MT(Ty(t,e))}function d3(t){for(var e=t.FullPaths||hi(t.files),r=[],n=0;n<e.length;++n)e[n].slice(-1)!="/"&&r.push(e[n].replace(/^Root Entry[\/]/,""));return r.sort()}function Sr(t,e,r){if(t.FullPaths){if(typeof r=="string"){var n;return Lr?n=fu(r):n=IO(r),Qt.utils.cfb_add(t,e,n)}Qt.utils.cfb_add(t,e,r)}else t.file(e,r)}function ky(){return Qt.utils.cfb_new()}function BT(t,e){switch(e.type){case"base64":return Qt.read(t,{type:"base64"});case"binary":return Qt.read(t,{type:"binary"});case"buffer":case"array":return Qt.read(t,{type:"buffer"})}throw new Error("Unrecognized type "+e.type)}function u1(t,e){if(t.charAt(0)=="/")return t.slice(1);var r=e.split("/");e.slice(-1)!="/"&&r.pop();for(var n=t.split("/");n.length!==0;){var i=n.shift();i===".."?r.pop():i!=="."&&r.push(i)}return r.join("/")}var Ci=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,dP=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,p3=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,pP=/<[^>]*>/g,as=Ci.match(p3)?p3:pP,mP=/<\w*:/,gP=/<(\/?)\w+:/;function pr(t,e,r){for(var n={},i=0,a=0;i!==t.length&&!((a=t.charCodeAt(i))===32||a===10||a===13);++i);if(e||(n[0]=t.slice(0,i)),i===t.length)return n;var o=t.match(dP),c=0,u="",h=0,d="",g="",x=1;if(o)for(h=0;h!=o.length;++h){for(g=o[h],a=0;a!=g.length&&g.charCodeAt(a)!==61;++a);for(d=g.slice(0,a).trim();g.charCodeAt(a+1)==32;)++a;for(x=(i=g.charCodeAt(a+1))==34||i==39?1:0,u=g.slice(a+1+x,g.length-x),c=0;c!=d.length&&d.charCodeAt(c)!==58;++c);if(c===d.length)d.indexOf("_")>0&&(d=d.slice(0,d.indexOf("_"))),n[d]=u,n[d.toLowerCase()]=u;else{var _=(c===5&&d.slice(0,5)==="xmlns"?"xmlns":"")+d.slice(c+1);if(n[_]&&d.slice(c-3,c)=="ext")continue;n[_]=u,n[_.toLowerCase()]=u}}return n}function vc(t){return t.replace(gP,"<$1")}var jT={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},Ny=p2(jT),tn=function(){var t=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,e=/_x([\da-fA-F]{4})_/ig;return function r(n){var i=n+"",a=i.indexOf("<![CDATA[");if(a==-1)return i.replace(t,function(c,u){return jT[c]||String.fromCharCode(parseInt(u,c.indexOf("x")>-1?16:10))||c}).replace(e,function(c,u){return String.fromCharCode(parseInt(u,16))});var o=i.indexOf("]]>");return r(i.slice(0,a))+i.slice(a+9,o)+r(i.slice(o+3))}}(),Cy=/[&<>'"]/g,vP=/[\u0000-\u0008\u000b-\u001f]/g;function bn(t){var e=t+"";return e.replace(Cy,function(r){return Ny[r]}).replace(vP,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function m3(t){return bn(t).replace(/ /g,"_x0020_")}var UT=/[\u0000-\u001f]/g;function Iy(t){var e=t+"";return e.replace(Cy,function(r){return Ny[r]}).replace(/\n/g,"<br/>").replace(UT,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function _P(t){var e=t+"";return e.replace(Cy,function(r){return Ny[r]}).replace(UT,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}var g3=function(){var t=/&#(\d+);/g;function e(r,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(t,e)}}();function xP(t){return t.replace(/(\r\n|[\r\n])/g,"&#10;")}function jn(t){switch(t){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function Kv(t){for(var e="",r=0,n=0,i=0,a=0,o=0,c=0;r<t.length;){if(n=t.charCodeAt(r++),n<128){e+=String.fromCharCode(n);continue}if(i=t.charCodeAt(r++),n>191&&n<224){o=(n&31)<<6,o|=i&63,e+=String.fromCharCode(o);continue}if(a=t.charCodeAt(r++),n<240){e+=String.fromCharCode((n&15)<<12|(i&63)<<6|a&63);continue}o=t.charCodeAt(r++),c=((n&7)<<18|(i&63)<<12|(a&63)<<6|o&63)-65536,e+=String.fromCharCode(55296+(c>>>10&1023)),e+=String.fromCharCode(56320+(c&1023))}return e}function v3(t){var e=wf(2*t.length),r,n,i=1,a=0,o=0,c;for(n=0;n<t.length;n+=i)i=1,(c=t.charCodeAt(n))<128?r=c:c<224?(r=(c&31)*64+(t.charCodeAt(n+1)&63),i=2):c<240?(r=(c&15)*4096+(t.charCodeAt(n+1)&63)*64+(t.charCodeAt(n+2)&63),i=3):(i=4,r=(c&7)*262144+(t.charCodeAt(n+1)&63)*4096+(t.charCodeAt(n+2)&63)*64+(t.charCodeAt(n+3)&63),r-=65536,o=55296+(r>>>10&1023),r=56320+(r&1023)),o!==0&&(e[a++]=o&255,e[a++]=o>>>8,o=0),e[a++]=r%256,e[a++]=r>>>8;return e.slice(0,a).toString("ucs2")}function _3(t){return fu(t,"binary").toString("utf8")}var Am="foo bar baz",Cn=Lr&&(_3(Am)==Kv(Am)&&_3||v3(Am)==Kv(Am)&&v3)||Kv,oc=Lr?function(t){return fu(t,"utf8").toString("binary")}:function(t){for(var e=[],r=0,n=0,i=0;r<t.length;)switch(n=t.charCodeAt(r++),!0){case n<128:e.push(String.fromCharCode(n));break;case n<2048:e.push(String.fromCharCode(192+(n>>6))),e.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,i=t.charCodeAt(r++)-56320+(n<<10),e.push(String.fromCharCode(240+(i>>18&7))),e.push(String.fromCharCode(144+(i>>12&63))),e.push(String.fromCharCode(128+(i>>6&63))),e.push(String.fromCharCode(128+(i&63)));break;default:e.push(String.fromCharCode(224+(n>>12))),e.push(String.fromCharCode(128+(n>>6&63))),e.push(String.fromCharCode(128+(n&63)))}return e.join("")},U1=function(){var t={};return function(r,n){var i=r+"|"+(n||"");return t[i]?t[i]:t[i]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",n||"")}}(),VT=function(){var t=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(e){return[new RegExp("&"+e[0]+";","ig"),e[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),i=0;i<t.length;++i)n=n.replace(t[i][0],t[i][1]);return n}}(),yP=function(){var t={};return function(r){return t[r]!==void 0?t[r]:t[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}}(),wP=/<\/?(?:vt:)?variant>/g,EP=/<(?:vt:)([^>]*)>([\s\S]*)</;function x3(t,e){var r=pr(t),n=t.match(yP(r.baseType))||[],i=[];if(n.length!=r.size){if(e.WTF)throw new Error("unexpected vector length "+n.length+" != "+r.size);return i}return n.forEach(function(a){var o=a.replace(wP,"").match(EP);o&&i.push({v:Cn(o[2]),t:o[1]})}),i}var qT=/(^\s|\s$|\n)/;function Ca(t,e){return"<"+t+(e.match(qT)?' xml:space="preserve"':"")+">"+e+"</"+t+">"}function V1(t){return hi(t).map(function(e){return" "+e+'="'+t[e]+'"'}).join("")}function Ct(t,e,r){return"<"+t+(r!=null?V1(r):"")+(e!=null?(e.match(qT)?' xml:space="preserve"':"")+">"+e+"</"+t:"/")+">"}function K_(t,e){try{return t.toISOString().replace(/\.\d*/,"")}catch(r){if(e)throw r}return""}function bP(t,e){switch(typeof t){case"string":var r=Ct("vt:lpwstr",bn(t));return r=r.replace(/&quot;/g,"_x0022_"),r;case"number":return Ct((t|0)==t?"vt:i4":"vt:r8",bn(String(t)));case"boolean":return Ct("vt:bool",t?"true":"false")}if(t instanceof Date)return Ct("vt:filetime",K_(t));throw new Error("Unable to serialize "+t)}function Ry(t){if(Lr&&Buffer.isBuffer(t))return t.toString("utf8");if(typeof t=="string")return t;if(typeof Uint8Array<"u"&&t instanceof Uint8Array)return Cn(Df(by(t)));throw new Error("Bad input format: expected Buffer or string")}var q1=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,Qi={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},Oh=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],Js={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function SP(t,e){for(var r=1-2*(t[e+7]>>>7),n=((t[e+7]&127)<<4)+(t[e+6]>>>4&15),i=t[e+6]&15,a=5;a>=0;--a)i=i*256+t[e+a];return n==2047?i==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,i+=Math.pow(2,52)),r*Math.pow(2,n-52)*i)}function AP(t,e,r){var n=(e<0||1/e==-1/0?1:0)<<7,i=0,a=0,o=n?-e:e;isFinite(o)?o==0?i=a=0:(i=Math.floor(Math.log(o)/Math.LN2),a=o*Math.pow(2,52-i),i<=-1023&&(!isFinite(a)||a<Math.pow(2,52))?i=-1022:(a-=Math.pow(2,52),i+=1023)):(i=2047,a=isNaN(e)?26985:0);for(var c=0;c<=5;++c,a/=256)t[r+c]=a&255;t[r+6]=(i&15)<<4|a&15,t[r+7]=i>>4|n}var y3=function(t){for(var e=[],r=10240,n=0;n<t[0].length;++n)if(t[0][n])for(var i=0,a=t[0][n].length;i<a;i+=r)e.push.apply(e,t[0][n].slice(i,i+r));return e},w3=Lr?function(t){return t[0].length>0&&Buffer.isBuffer(t[0][0])?Buffer.concat(t[0].map(function(e){return Buffer.isBuffer(e)?e:fu(e)})):y3(t)}:y3,E3=function(t,e,r){for(var n=[],i=e;i<r;i+=2)n.push(String.fromCharCode(Zc(t,i)));return n.join("").replace(hs,"")},Ly=Lr?function(t,e,r){return Buffer.isBuffer(t)?t.toString("utf16le",e,r).replace(hs,""):E3(t,e,r)}:E3,b3=function(t,e,r){for(var n=[],i=e;i<e+r;++i)n.push(("0"+t[i].toString(16)).slice(-2));return n.join("")},zT=Lr?function(t,e,r){return Buffer.isBuffer(t)?t.toString("hex",e,e+r):b3(t,e,r)}:b3,S3=function(t,e,r){for(var n=[],i=e;i<r;i++)n.push(String.fromCharCode(T0(t,i)));return n.join("")},pp=Lr?function(e,r,n){return Buffer.isBuffer(e)?e.toString("utf8",r,n):S3(e,r,n)}:S3,HT=function(t,e){var r=Zs(t,e);return r>0?pp(t,e+4,e+4+r-1):""},GT=HT,WT=function(t,e){var r=Zs(t,e);return r>0?pp(t,e+4,e+4+r-1):""},XT=WT,YT=function(t,e){var r=2*Zs(t,e);return r>0?pp(t,e+4,e+4+r-1):""},KT=YT,$T=function(e,r){var n=Zs(e,r);return n>0?Ly(e,r+4,r+4+n):""},QT=$T,JT=function(t,e){var r=Zs(t,e);return r>0?pp(t,e+4,e+4+r):""},ZT=JT,e6=function(t,e){return SP(t,e)},Lg=e6,Dy=function(e){return Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array};Lr&&(GT=function(e,r){if(!Buffer.isBuffer(e))return HT(e,r);var n=e.readUInt32LE(r);return n>0?e.toString("utf8",r+4,r+4+n-1):""},XT=function(e,r){if(!Buffer.isBuffer(e))return WT(e,r);var n=e.readUInt32LE(r);return n>0?e.toString("utf8",r+4,r+4+n-1):""},KT=function(e,r){if(!Buffer.isBuffer(e))return YT(e,r);var n=2*e.readUInt32LE(r);return e.toString("utf16le",r+4,r+4+n-1)},QT=function(e,r){if(!Buffer.isBuffer(e))return $T(e,r);var n=e.readUInt32LE(r);return e.toString("utf16le",r+4,r+4+n)},ZT=function(e,r){if(!Buffer.isBuffer(e))return JT(e,r);var n=e.readUInt32LE(r);return e.toString("utf8",r+4,r+4+n)},Lg=function(e,r){return Buffer.isBuffer(e)?e.readDoubleLE(r):e6(e,r)},Dy=function(e){return Buffer.isBuffer(e)||Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array});var T0=function(t,e){return t[e]},Zc=function(t,e){return t[e+1]*256+t[e]},TP=function(t,e){var r=t[e+1]*256+t[e];return r<32768?r:(65535-r+1)*-1},Zs=function(t,e){return t[e+3]*(1<<24)+(t[e+2]<<16)+(t[e+1]<<8)+t[e]},oh=function(t,e){return t[e+3]<<24|t[e+2]<<16|t[e+1]<<8|t[e]},kP=function(t,e){return t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3]};function v1(t,e){var r="",n,i,a=[],o,c,u,h;switch(e){case"dbcs":if(h=this.l,Lr&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*t).toString("utf16le");else for(u=0;u<t;++u)r+=String.fromCharCode(Zc(this,h)),h+=2;t*=2;break;case"utf8":r=pp(this,this.l,this.l+t);break;case"utf16le":t*=2,r=Ly(this,this.l,this.l+t);break;case"wstr":return v1.call(this,t,"dbcs");case"lpstr-ansi":r=GT(this,this.l),t=4+Zs(this,this.l);break;case"lpstr-cp":r=XT(this,this.l),t=4+Zs(this,this.l);break;case"lpwstr":r=KT(this,this.l),t=4+2*Zs(this,this.l);break;case"lpp4":t=4+Zs(this,this.l),r=QT(this,this.l),t&2&&(t+=2);break;case"8lpp4":t=4+Zs(this,this.l),r=ZT(this,this.l),t&3&&(t+=4-(t&3));break;case"cstr":for(t=0,r="";(o=T0(this,this.l+t++))!==0;)a.push(Sm(o));r=a.join("");break;case"_wstr":for(t=0,r="";(o=Zc(this,this.l+t))!==0;)a.push(Sm(o)),t+=2;t+=2,r=a.join("");break;case"dbcs-cont":for(r="",h=this.l,u=0;u<t;++u){if(this.lens&&this.lens.indexOf(h)!==-1)return o=T0(this,h),this.l=h+1,c=v1.call(this,t-u,o?"dbcs-cont":"sbcs-cont"),a.join("")+c;a.push(Sm(Zc(this,h))),h+=2}r=a.join(""),t*=2;break;case"cpstr":case"sbcs-cont":for(r="",h=this.l,u=0;u!=t;++u){if(this.lens&&this.lens.indexOf(h)!==-1)return o=T0(this,h),this.l=h+1,c=v1.call(this,t-u,o?"dbcs-cont":"sbcs-cont"),a.join("")+c;a.push(Sm(T0(this,h))),h+=1}r=a.join("");break;default:switch(t){case 1:return n=T0(this,this.l),this.l++,n;case 2:return n=(e==="i"?TP:Zc)(this,this.l),this.l+=2,n;case 4:case-4:return e==="i"||(this[this.l+3]&128)===0?(n=(t>0?oh:kP)(this,this.l),this.l+=4,n):(i=Zs(this,this.l),this.l+=4,i);case 8:case-8:if(e==="f")return t==8?i=Lg(this,this.l):i=Lg([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,i;t=8;case 16:r=zT(this,this.l,t);break}}return this.l+=t,r}var NP=function(t,e,r){t[r]=e&255,t[r+1]=e>>>8&255,t[r+2]=e>>>16&255,t[r+3]=e>>>24&255},CP=function(t,e,r){t[r]=e&255,t[r+1]=e>>8&255,t[r+2]=e>>16&255,t[r+3]=e>>24&255},IP=function(t,e,r){t[r]=e&255,t[r+1]=e>>>8&255};function RP(t,e,r){var n=0,i=0;if(r==="dbcs"){for(i=0;i!=e.length;++i)IP(this,e.charCodeAt(i),this.l+2*i);n=2*e.length}else if(r==="sbcs"){for(e=e.replace(/[^\x00-\x7F]/g,"_"),i=0;i!=e.length;++i)this[this.l+i]=e.charCodeAt(i)&255;n=e.length}else if(r==="hex"){for(;i<t;++i)this[this.l++]=parseInt(e.slice(2*i,2*i+2),16)||0;return this}else if(r==="utf16le"){var a=Math.min(this.l+t,this.length);for(i=0;i<Math.min(e.length,t);++i){var o=e.charCodeAt(i);this[this.l++]=o&255,this[this.l++]=o>>8}for(;this.l<a;)this[this.l++]=0;return this}else switch(t){case 1:n=1,this[this.l]=e&255;break;case 2:n=2,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255;break;case 3:n=3,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255,e>>>=8,this[this.l+2]=e&255;break;case 4:n=4,NP(this,e,this.l);break;case 8:if(n=8,r==="f"){AP(this,e,this.l);break}case 16:break;case-4:n=4,CP(this,e,this.l);break}return this.l+=n,this}function t6(t,e){var r=zT(this,this.l,t.length>>1);if(r!==t)throw new Error(e+"Expected "+t+" saw "+r);this.l+=t.length>>1}function ka(t,e){t.l=e,t.read_shift=v1,t.chk=t6,t.write_shift=RP}function is(t,e){t.l+=e}function it(t){var e=wf(t);return ka(e,0),e}function hu(t,e,r){if(t){var n,i,a;ka(t,t.l||0);for(var o=t.length,c=0,u=0;t.l<o;){c=t.read_shift(1),c&128&&(c=(c&127)+((t.read_shift(1)&127)<<7));var h=Y1[c]||Y1[65535];for(n=t.read_shift(1),a=n&127,i=1;i<4&&n&128;++i)a+=((n=t.read_shift(1))&127)<<7*i;u=t.l+a;var d=h.f&&h.f(t,a,r);if(t.l=u,e(d,h,c))return}}}function Ls(){var t=[],e=Lr?256:2048,r=function(h){var d=it(h);return ka(d,0),d},n=r(e),i=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&t.push(n),n=null)},a=function(h){return n&&h<n.length-n.l?n:(i(),n=r(Math.max(h+1,e)))},o=function(){return i(),da(t)},c=function(h){i(),n=h,n.l==null&&(n.l=n.length),a(e)};return{next:a,push:c,end:o,_bufs:t}}function xt(t,e,r,n){var i=+e,a;if(!isNaN(i)){n||(n=Y1[i].p||(r||[]).length||0),a=1+(i>=128?1:0)+1,n>=128&&++a,n>=16384&&++a,n>=2097152&&++a;var o=t.next(a);i<=127?o.write_shift(1,i):(o.write_shift(1,(i&127)+128),o.write_shift(1,i>>7));for(var c=0;c!=4;++c)if(n>=128)o.write_shift(1,(n&127)+128),n>>=7;else{o.write_shift(1,n);break}n>0&&Dy(r)&&t.push(r)}}function _1(t,e,r){var n=zn(t);if(e.s?(n.cRel&&(n.c+=e.s.c),n.rRel&&(n.r+=e.s.r)):(n.cRel&&(n.c+=e.c),n.rRel&&(n.r+=e.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function A3(t,e,r){var n=zn(t);return n.s=_1(n.s,e.s,r),n.e=_1(n.e,e.s,r),n}function x1(t,e){if(t.cRel&&t.c<0)for(t=zn(t);t.c<0;)t.c+=e>8?16384:256;if(t.rRel&&t.r<0)for(t=zn(t);t.r<0;)t.r+=e>8?1048576:e>5?65536:16384;var r=ur(t);return!t.cRel&&t.cRel!=null&&(r=FP(r)),!t.rRel&&t.rRel!=null&&(r=LP(r)),r}function $v(t,e){return t.s.r==0&&!t.s.rRel&&t.e.r==(e.biff>=12?1048575:e.biff>=8?65536:16384)&&!t.e.rRel?(t.s.cRel?"":"$")+ei(t.s.c)+":"+(t.e.cRel?"":"$")+ei(t.e.c):t.s.c==0&&!t.s.cRel&&t.e.c==(e.biff>=12?16383:255)&&!t.e.cRel?(t.s.rRel?"":"$")+Ni(t.s.r)+":"+(t.e.rRel?"":"$")+Ni(t.e.r):x1(t.s,e.biff)+":"+x1(t.e,e.biff)}function Fy(t){return parseInt(DP(t),10)-1}function Ni(t){return""+(t+1)}function LP(t){return t.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function DP(t){return t.replace(/\$(\d+)$/,"$1")}function Oy(t){for(var e=OP(t),r=0,n=0;n!==e.length;++n)r=26*r+e.charCodeAt(n)-64;return r-1}function ei(t){if(t<0)throw new Error("invalid column "+t);var e="";for(++t;t;t=Math.floor((t-1)/26))e=String.fromCharCode((t-1)%26+65)+e;return e}function FP(t){return t.replace(/^([A-Z])/,"$$$1")}function OP(t){return t.replace(/^\$([A-Z])/,"$1")}function PP(t){return t.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function ti(t){for(var e=0,r=0,n=0;n<t.length;++n){var i=t.charCodeAt(n);i>=48&&i<=57?e=10*e+(i-48):i>=65&&i<=90&&(r=26*r+(i-64))}return{c:r-1,r:e-1}}function ur(t){for(var e=t.c+1,r="";e;e=(e-1)/26|0)r=String.fromCharCode((e-1)%26+65)+r;return r+(t.r+1)}function Ds(t){var e=t.indexOf(":");return e==-1?{s:ti(t),e:ti(t)}:{s:ti(t.slice(0,e)),e:ti(t.slice(e+1))}}function wr(t,e){return typeof e>"u"||typeof e=="number"?wr(t.s,t.e):(typeof t!="string"&&(t=ur(t)),typeof e!="string"&&(e=ur(e)),t==e?t:t+":"+e)}function rn(t){var e={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,i=0,a=t.length;for(r=0;n<a&&!((i=t.charCodeAt(n)-64)<1||i>26);++n)r=26*r+i;for(e.s.c=--r,r=0;n<a&&!((i=t.charCodeAt(n)-48)<0||i>9);++n)r=10*r+i;if(e.s.r=--r,n===a||i!=10)return e.e.c=e.s.c,e.e.r=e.s.r,e;for(++n,r=0;n!=a&&!((i=t.charCodeAt(n)-64)<1||i>26);++n)r=26*r+i;for(e.e.c=--r,r=0;n!=a&&!((i=t.charCodeAt(n)-48)<0||i>9);++n)r=10*r+i;return e.e.r=--r,e}function T3(t,e){var r=t.t=="d"&&e instanceof Date;if(t.z!=null)try{return t.w=Vo(t.z,r?Zi(e):e)}catch{}try{return t.w=Vo((t.XF||{}).numFmtId||(r?14:0),r?Zi(e):e)}catch{return""+e}}function cu(t,e,r){return t==null||t.t==null||t.t=="z"?"":t.w!==void 0?t.w:(t.t=="d"&&!t.z&&r&&r.dateNF&&(t.z=r.dateNF),t.t=="e"?du[t.v]||t.v:e==null?T3(t,t.v):T3(t,e))}function Ff(t,e){var r=e&&e.sheet?e.sheet:"Sheet1",n={};return n[r]=t,{SheetNames:[r],Sheets:n}}function r6(t,e,r){var n=r||{},i=t?Array.isArray(t):n.dense,a=t||(i?[]:{}),o=0,c=0;if(a&&n.origin!=null){if(typeof n.origin=="number")o=n.origin;else{var u=typeof n.origin=="string"?ti(n.origin):n.origin;o=u.r,c=u.c}a["!ref"]||(a["!ref"]="A1:A1")}var h={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(a["!ref"]){var d=rn(a["!ref"]);h.s.c=d.s.c,h.s.r=d.s.r,h.e.c=Math.max(h.e.c,d.e.c),h.e.r=Math.max(h.e.r,d.e.r),o==-1&&(h.e.r=o=d.e.r+1)}for(var g=0;g!=e.length;++g)if(e[g]){if(!Array.isArray(e[g]))throw new Error("aoa_to_sheet expects an array of arrays");for(var x=0;x!=e[g].length;++x)if(!(typeof e[g][x]>"u")){var _={v:e[g][x]},b=o+g,E=c+x;if(h.s.r>b&&(h.s.r=b),h.s.c>E&&(h.s.c=E),h.e.r<b&&(h.e.r=b),h.e.c<E&&(h.e.c=E),e[g][x]&&typeof e[g][x]=="object"&&!Array.isArray(e[g][x])&&!(e[g][x]instanceof Date))_=e[g][x];else if(Array.isArray(_.v)&&(_.f=e[g][x][1],_.v=_.v[0]),_.v===null)if(_.f)_.t="n";else if(n.nullError)_.t="e",_.v=0;else if(n.sheetStubs)_.t="z";else continue;else typeof _.v=="number"?_.t="n":typeof _.v=="boolean"?_.t="b":_.v instanceof Date?(_.z=n.dateNF||sr[14],n.cellDates?(_.t="d",_.w=Vo(_.z,Zi(_.v))):(_.t="n",_.v=Zi(_.v),_.w=Vo(_.z,_.v))):_.t="s";if(i)a[b]||(a[b]=[]),a[b][E]&&a[b][E].z&&(_.z=a[b][E].z),a[b][E]=_;else{var A=ur({c:E,r:b});a[A]&&a[A].z&&(_.z=a[A].z),a[A]=_}}}return h.s.c<1e7&&(a["!ref"]=wr(h)),a}function fd(t,e){return r6(null,t,e)}function MP(t){return t.read_shift(4,"i")}function yl(t,e){return e||(e=it(4)),e.write_shift(4,t),e}function rs(t){var e=t.read_shift(4);return e===0?"":t.read_shift(e,"dbcs")}function pa(t,e){var r=!1;return e==null&&(r=!0,e=it(4+2*t.length)),e.write_shift(4,t.length),t.length>0&&e.write_shift(0,t,"dbcs"),r?e.slice(0,e.l):e}function BP(t){return{ich:t.read_shift(2),ifnt:t.read_shift(2)}}function jP(t,e){return e||(e=it(4)),e.write_shift(2,0),e.write_shift(2,0),e}function Py(t,e){var r=t.l,n=t.read_shift(1),i=rs(t),a=[],o={t:i,h:i};if((n&1)!==0){for(var c=t.read_shift(4),u=0;u!=c;++u)a.push(BP(t));o.r=a}else o.r=[{ich:0,ifnt:0}];return t.l=r+e,o}function UP(t,e){var r=!1;return e==null&&(r=!0,e=it(15+4*t.t.length)),e.write_shift(1,0),pa(t.t,e),r?e.slice(0,e.l):e}var VP=Py;function qP(t,e){var r=!1;return e==null&&(r=!0,e=it(23+4*t.t.length)),e.write_shift(1,1),pa(t.t,e),e.write_shift(4,1),jP({},e),r?e.slice(0,e.l):e}function qo(t){var e=t.read_shift(4),r=t.read_shift(2);return r+=t.read_shift(1)<<16,t.l++,{c:e,iStyleRef:r}}function Ph(t,e){return e==null&&(e=it(8)),e.write_shift(-4,t.c),e.write_shift(3,t.iStyleRef||t.s),e.write_shift(1,0),e}function Mh(t){var e=t.read_shift(2);return e+=t.read_shift(1)<<16,t.l++,{c:-1,iStyleRef:e}}function Bh(t,e){return e==null&&(e=it(4)),e.write_shift(3,t.iStyleRef||t.s),e.write_shift(1,0),e}var zP=rs,n6=pa;function My(t){var e=t.read_shift(4);return e===0||e===4294967295?"":t.read_shift(e,"dbcs")}function Dg(t,e){var r=!1;return e==null&&(r=!0,e=it(127)),e.write_shift(4,t.length>0?t.length:4294967295),t.length>0&&e.write_shift(0,t,"dbcs"),r?e.slice(0,e.l):e}var HP=rs,$_=My,By=Dg;function jy(t){var e=t.slice(t.l,t.l+4),r=e[0]&1,n=e[0]&2;t.l+=4;var i=n===0?Lg([0,0,0,0,e[0]&252,e[1],e[2],e[3]],0):oh(e,0)>>2;return r?i/100:i}function i6(t,e){e==null&&(e=it(4));var r=0,n=0,i=t*100;if(t==(t|0)&&t>=-536870912&&t<1<<29?n=1:i==(i|0)&&i>=-536870912&&i<1<<29&&(n=1,r=1),n)e.write_shift(-4,((r?i:t)<<2)+(r+2));else throw new Error("unsupported RkNumber "+t)}function a6(t){var e={s:{},e:{}};return e.s.r=t.read_shift(4),e.e.r=t.read_shift(4),e.s.c=t.read_shift(4),e.e.c=t.read_shift(4),e}function GP(t,e){return e||(e=it(16)),e.write_shift(4,t.s.r),e.write_shift(4,t.e.r),e.write_shift(4,t.s.c),e.write_shift(4,t.e.c),e}var jh=a6,hd=GP;function es(t){if(t.length-t.l<8)throw"XLS Xnum Buffer underflow";return t.read_shift(8,"f")}function Th(t,e){return(e||it(8)).write_shift(8,t,"f")}function WP(t){var e={},r=t.read_shift(1),n=r>>>1,i=t.read_shift(1),a=t.read_shift(2,"i"),o=t.read_shift(1),c=t.read_shift(1),u=t.read_shift(1);switch(t.l++,n){case 0:e.auto=1;break;case 1:e.index=i;var h=dh[i];h&&(e.rgb=H1(h));break;case 2:e.rgb=H1([o,c,u]);break;case 3:e.theme=i;break}return a!=0&&(e.tint=a>0?a/32767:a/32768),e}function Fg(t,e){if(e||(e=it(8)),!t||t.auto)return e.write_shift(4,0),e.write_shift(4,0),e;t.index!=null?(e.write_shift(1,2),e.write_shift(1,t.index)):t.theme!=null?(e.write_shift(1,6),e.write_shift(1,t.theme)):(e.write_shift(1,5),e.write_shift(1,0));var r=t.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),e.write_shift(2,r),!t.rgb||t.theme!=null)e.write_shift(2,0),e.write_shift(1,0),e.write_shift(1,0);else{var n=t.rgb||"FFFFFF";typeof n=="number"&&(n=("000000"+n.toString(16)).slice(-6)),e.write_shift(1,parseInt(n.slice(0,2),16)),e.write_shift(1,parseInt(n.slice(2,4),16)),e.write_shift(1,parseInt(n.slice(4,6),16)),e.write_shift(1,255)}return e}function XP(t){var e=t.read_shift(1);t.l++;var r={fBold:e&1,fItalic:e&2,fUnderline:e&4,fStrikeout:e&8,fOutline:e&16,fShadow:e&32,fCondense:e&64,fExtend:e&128};return r}function YP(t,e){e||(e=it(2));var r=(t.italic?2:0)|(t.strike?8:0)|(t.outline?16:0)|(t.shadow?32:0)|(t.condense?64:0)|(t.extend?128:0);return e.write_shift(1,r),e.write_shift(1,0),e}function s6(t,e){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=t.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return r[t.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return t.l-=4,t.read_shift(0,e==1?"lpstr":"lpwstr")}function KP(t){return s6(t,1)}function $P(t){return s6(t,2)}var Uy=2,Cs=3,Tm=11,k3=12,Og=19,km=64,QP=65,JP=71,ZP=4108,e9=4126,fa=80,o6=81,t9=[fa,o6],Q_={1:{n:"CodePage",t:Uy},2:{n:"Category",t:fa},3:{n:"PresentationFormat",t:fa},4:{n:"ByteCount",t:Cs},5:{n:"LineCount",t:Cs},6:{n:"ParagraphCount",t:Cs},7:{n:"SlideCount",t:Cs},8:{n:"NoteCount",t:Cs},9:{n:"HiddenCount",t:Cs},10:{n:"MultimediaClipCount",t:Cs},11:{n:"ScaleCrop",t:Tm},12:{n:"HeadingPairs",t:ZP},13:{n:"TitlesOfParts",t:e9},14:{n:"Manager",t:fa},15:{n:"Company",t:fa},16:{n:"LinksUpToDate",t:Tm},17:{n:"CharacterCount",t:Cs},19:{n:"SharedDoc",t:Tm},22:{n:"HyperlinksChanged",t:Tm},23:{n:"AppVersion",t:Cs,p:"version"},24:{n:"DigSig",t:QP},26:{n:"ContentType",t:fa},27:{n:"ContentStatus",t:fa},28:{n:"Language",t:fa},29:{n:"Version",t:fa},255:{},2147483648:{n:"Locale",t:Og},2147483651:{n:"Behavior",t:Og},1919054434:{}},J_={1:{n:"CodePage",t:Uy},2:{n:"Title",t:fa},3:{n:"Subject",t:fa},4:{n:"Author",t:fa},5:{n:"Keywords",t:fa},6:{n:"Comments",t:fa},7:{n:"Template",t:fa},8:{n:"LastAuthor",t:fa},9:{n:"RevNumber",t:fa},10:{n:"EditTime",t:km},11:{n:"LastPrinted",t:km},12:{n:"CreatedDate",t:km},13:{n:"ModifiedDate",t:km},14:{n:"PageCount",t:Cs},15:{n:"WordCount",t:Cs},16:{n:"CharCount",t:Cs},17:{n:"Thumbnail",t:JP},18:{n:"Application",t:fa},19:{n:"DocSecurity",t:Cs},255:{},2147483648:{n:"Locale",t:Og},2147483651:{n:"Behavior",t:Og},1919054434:{}},N3={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},r9=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function n9(t){return t.map(function(e){return[e>>16&255,e>>8&255,e&255]})}var i9=n9([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),dh=zn(i9),du={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},l6={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},Z_={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},Nm={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function Vy(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function a9(t){var e=Vy();if(!t||!t.match)return e;var r={};if((t.match(as)||[]).forEach(function(n){var i=pr(n);switch(i[0].replace(mP,"<")){case"<?xml":break;case"<Types":e.xmlns=i["xmlns"+(i[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[i.Extension]=i.ContentType;break;case"<Override":e[Z_[i.ContentType]]!==void 0&&e[Z_[i.ContentType]].push(i.PartName);break}}),e.xmlns!==Qi.CT)throw new Error("Unknown Namespace: "+e.xmlns);return e.calcchain=e.calcchains.length>0?e.calcchains[0]:"",e.sst=e.strs.length>0?e.strs[0]:"",e.style=e.styles.length>0?e.styles[0]:"",e.defaults=r,delete e.calcchains,e}function c6(t,e){var r=aP(Z_),n=[],i;n[n.length]=Ci,n[n.length]=Ct("Types",null,{xmlns:Qi.CT,"xmlns:xsd":Qi.xsd,"xmlns:xsi":Qi.xsi}),n=n.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(u){return Ct("Default",null,{Extension:u[0],ContentType:u[1]})}));var a=function(u){t[u]&&t[u].length>0&&(i=t[u][0],n[n.length]=Ct("Override",null,{PartName:(i[0]=="/"?"":"/")+i,ContentType:Nm[u][e.bookType]||Nm[u].xlsx}))},o=function(u){(t[u]||[]).forEach(function(h){n[n.length]=Ct("Override",null,{PartName:(h[0]=="/"?"":"/")+h,ContentType:Nm[u][e.bookType]||Nm[u].xlsx})})},c=function(u){(t[u]||[]).forEach(function(h){n[n.length]=Ct("Override",null,{PartName:(h[0]=="/"?"":"/")+h,ContentType:r[u][0]})})};return a("workbooks"),o("sheets"),o("charts"),c("themes"),["strs","styles"].forEach(a),["coreprops","extprops","custprops"].forEach(c),c("vba"),c("comments"),c("threadedcomments"),c("drawings"),o("metadata"),c("people"),n.length>2&&(n[n.length]="</Types>",n[1]=n[1].replace("/>",">")),n.join("")}var Br={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function z1(t){var e=t.lastIndexOf("/");return t.slice(0,e+1)+"_rels/"+t.slice(e+1)+".rels"}function y1(t,e){var r={"!id":{}};if(!t)return r;e.charAt(0)!=="/"&&(e="/"+e);var n={};return(t.match(as)||[]).forEach(function(i){var a=pr(i);if(a[0]==="<Relationship"){var o={};o.Type=a.Type,o.Target=a.Target,o.Id=a.Id,a.TargetMode&&(o.TargetMode=a.TargetMode);var c=a.TargetMode==="External"?a.Target:u1(a.Target,e);r[c]=o,n[a.Id]=o}}),r["!id"]=n,r}function B0(t){var e=[Ci,Ct("Relationships",null,{xmlns:Qi.RELS})];return hi(t["!id"]).forEach(function(r){e[e.length]=Ct("Relationship",null,t["!id"][r])}),e.length>2&&(e[e.length]="</Relationships>",e[1]=e[1].replace("/>",">")),e.join("")}function En(t,e,r,n,i,a){if(i||(i={}),t["!id"]||(t["!id"]={}),t["!idx"]||(t["!idx"]=1),e<0)for(e=t["!idx"];t["!id"]["rId"+e];++e);if(t["!idx"]=e+1,i.Id="rId"+e,i.Type=n,i.Target=r,[Br.HLINK,Br.XPATH,Br.XMISS].indexOf(i.Type)>-1&&(i.TargetMode="External"),t["!id"][i.Id])throw new Error("Cannot rewrite rId "+e);return t["!id"][i.Id]=i,t[("/"+i.Target).replace("//","/")]=i,e}var s9="application/vnd.oasis.opendocument.spreadsheet";function o9(t,e){for(var r=Ry(t),n,i;n=q1.exec(r);)switch(n[3]){case"manifest":break;case"file-entry":if(i=pr(n[0],!1),i.path=="/"&&i.type!==s9)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(e&&e.WTF)throw n}}function l9(t){var e=[Ci];e.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),e.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<t.length;++r)e.push('  <manifest:file-entry manifest:full-path="'+t[r][0]+'" manifest:media-type="'+t[r][1]+`"/>
`);return e.push("</manifest:manifest>"),e.join("")}function C3(t,e,r){return['  <rdf:Description rdf:about="'+t+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+e+`"/>
`,`  </rdf:Description>
`].join("")}function c9(t,e){return['  <rdf:Description rdf:about="'+t+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+e+`"/>
`,`  </rdf:Description>
`].join("")}function u9(t){var e=[Ci];e.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=t.length;++r)e.push(C3(t[r][0],t[r][1])),e.push(c9("",t[r][0]));return e.push(C3("","Document","pkg")),e.push("</rdf:RDF>"),e.join("")}function u6(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+kg.version+"</meta:generator></office:meta></office:document-meta>"}var Uo=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],f9=function(){for(var t=new Array(Uo.length),e=0;e<Uo.length;++e){var r=Uo[e],n="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);t[e]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return t}();function f6(t){var e={};t=Cn(t);for(var r=0;r<Uo.length;++r){var n=Uo[r],i=t.match(f9[r]);i!=null&&i.length>0&&(e[n[1]]=tn(i[1])),n[2]==="date"&&e[n[1]]&&(e[n[1]]=qn(e[n[1]]))}return e}function Qv(t,e,r,n,i){i[t]!=null||e==null||e===""||(i[t]=e,e=bn(e),n[n.length]=r?Ct(t,e,r):Ca(t,e))}function h6(t,e){var r=e||{},n=[Ci,Ct("cp:coreProperties",null,{"xmlns:cp":Qi.CORE_PROPS,"xmlns:dc":Qi.dc,"xmlns:dcterms":Qi.dcterms,"xmlns:dcmitype":Qi.dcmitype,"xmlns:xsi":Qi.xsi})],i={};if(!t&&!r.Props)return n.join("");t&&(t.CreatedDate!=null&&Qv("dcterms:created",typeof t.CreatedDate=="string"?t.CreatedDate:K_(t.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,i),t.ModifiedDate!=null&&Qv("dcterms:modified",typeof t.ModifiedDate=="string"?t.ModifiedDate:K_(t.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,i));for(var a=0;a!=Uo.length;++a){var o=Uo[a],c=r.Props&&r.Props[o[1]]!=null?r.Props[o[1]]:t?t[o[1]]:null;c===!0?c="1":c===!1?c="0":typeof c=="number"&&(c=String(c)),c!=null&&Qv(o[0],c,null,n,i)}return n.length>2&&(n[n.length]="</cp:coreProperties>",n[1]=n[1].replace("/>",">")),n.join("")}var ph=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],d6=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function p6(t,e,r,n){var i=[];if(typeof t=="string")i=x3(t,n);else for(var a=0;a<t.length;++a)i=i.concat(t[a].map(function(d){return{v:d}}));var o=typeof e=="string"?x3(e,n).map(function(d){return d.v}):e,c=0,u=0;if(o.length>0)for(var h=0;h!==i.length;h+=2){switch(u=+i[h+1].v,i[h].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":r.Worksheets=u,r.SheetNames=o.slice(c,c+u);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":r.NamedRanges=u,r.DefinedNames=o.slice(c,c+u);break;case"Charts":case"Diagramme":r.Chartsheets=u,r.ChartNames=o.slice(c,c+u);break}c+=u}}function h9(t,e,r){var n={};return e||(e={}),t=Cn(t),ph.forEach(function(i){var a=(t.match(U1(i[0]))||[])[1];switch(i[2]){case"string":a&&(e[i[1]]=tn(a));break;case"bool":e[i[1]]=a==="true";break;case"raw":var o=t.match(new RegExp("<"+i[0]+"[^>]*>([\\s\\S]*?)</"+i[0]+">"));o&&o.length>0&&(n[i[1]]=o[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&p6(n.HeadingPairs,n.TitlesOfParts,e,r),e}function m6(t){var e=[],r=Ct;return t||(t={}),t.Application="SheetJS",e[e.length]=Ci,e[e.length]=Ct("Properties",null,{xmlns:Qi.EXT_PROPS,"xmlns:vt":Qi.vt}),ph.forEach(function(n){if(t[n[1]]!==void 0){var i;switch(n[2]){case"string":i=bn(String(t[n[1]]));break;case"bool":i=t[n[1]]?"true":"false";break}i!==void 0&&(e[e.length]=r(n[0],i))}}),e[e.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(t.Worksheets))),{size:2,baseType:"variant"})),e[e.length]=r("TitlesOfParts",r("vt:vector",t.SheetNames.map(function(n){return"<vt:lpstr>"+bn(n)+"</vt:lpstr>"}).join(""),{size:t.Worksheets,baseType:"lpstr"})),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}var d9=/<[^>]+>[^<]*/g;function p9(t,e){var r={},n="",i=t.match(d9);if(i)for(var a=0;a!=i.length;++a){var o=i[a],c=pr(o);switch(c[0]){case"<?xml":break;case"<Properties":break;case"<property":n=tn(c.name);break;case"</property>":n=null;break;default:if(o.indexOf("<vt:")===0){var u=o.split(">"),h=u[0].slice(4),d=u[1];switch(h){case"lpstr":case"bstr":case"lpwstr":r[n]=tn(d);break;case"bool":r[n]=jn(d);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[n]=parseInt(d,10);break;case"r4":case"r8":case"decimal":r[n]=parseFloat(d);break;case"filetime":case"date":r[n]=qn(d);break;case"cy":case"error":r[n]=tn(d);break;default:if(h.slice(-1)=="/")break;e.WTF&&typeof console<"u"&&console.warn("Unexpected",o,h,u)}}else if(o.slice(0,2)!=="</"){if(e.WTF)throw new Error(o)}}}return r}function g6(t){var e=[Ci,Ct("Properties",null,{xmlns:Qi.CUST_PROPS,"xmlns:vt":Qi.vt})];if(!t)return e.join("");var r=1;return hi(t).forEach(function(i){++r,e[e.length]=Ct("property",bP(t[i]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:bn(i)})}),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}var ex={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},Jv;function m9(t,e,r){Jv||(Jv=p2(ex)),e=Jv[e]||e,t[e]=r}function g9(t,e){var r=[];return hi(ex).map(function(n){for(var i=0;i<Uo.length;++i)if(Uo[i][1]==n)return Uo[i];for(i=0;i<ph.length;++i)if(ph[i][1]==n)return ph[i];throw n}).forEach(function(n){if(t[n[1]]!=null){var i=e&&e.Props&&e.Props[n[1]]!=null?e.Props[n[1]]:t[n[1]];switch(n[2]){case"date":i=new Date(i).toISOString().replace(/\.\d*Z/,"Z");break}typeof i=="number"?i=String(i):i===!0||i===!1?i=i?"1":"0":i instanceof Date&&(i=new Date(i).toISOString().replace(/\.\d*Z/,"")),r.push(Ca(ex[n[1]]||n[1],i))}}),Ct("DocumentProperties",r.join(""),{xmlns:Js.o})}function v9(t,e){var r=["Worksheets","SheetNames"],n="CustomDocumentProperties",i=[];return t&&hi(t).forEach(function(a){if(Object.prototype.hasOwnProperty.call(t,a)){for(var o=0;o<Uo.length;++o)if(a==Uo[o][1])return;for(o=0;o<ph.length;++o)if(a==ph[o][1])return;for(o=0;o<r.length;++o)if(a==r[o])return;var c=t[a],u="string";typeof c=="number"?(u="float",c=String(c)):c===!0||c===!1?(u="boolean",c=c?"1":"0"):c=String(c),i.push(Ct(m3(a),c,{"dt:dt":u}))}}),e&&hi(e).forEach(function(a){if(Object.prototype.hasOwnProperty.call(e,a)&&!(t&&Object.prototype.hasOwnProperty.call(t,a))){var o=e[a],c="string";typeof o=="number"?(c="float",o=String(o)):o===!0||o===!1?(c="boolean",o=o?"1":"0"):o instanceof Date?(c="dateTime.tz",o=o.toISOString()):o=String(o),i.push(Ct(m3(a),o,{"dt:dt":c}))}}),"<"+n+' xmlns="'+Js.o+'">'+i.join("")+"</"+n+">"}function qy(t){var e=t.read_shift(4),r=t.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+e/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function _9(t){var e=typeof t=="string"?new Date(Date.parse(t)):t,r=e.getTime()/1e3+11644473600,n=r%Math.pow(2,32),i=(r-n)/Math.pow(2,32);n*=1e7,i*=1e7;var a=n/Math.pow(2,32)|0;a>0&&(n=n%Math.pow(2,32),i+=a);var o=it(8);return o.write_shift(4,n),o.write_shift(4,i),o}function v6(t,e,r){var n=t.l,i=t.read_shift(0,"lpstr-cp");if(r)for(;t.l-n&3;)++t.l;return i}function _6(t,e,r){var n=t.read_shift(0,"lpwstr");return n}function x6(t,e,r){return e===31?_6(t):v6(t,e,r)}function tx(t,e,r){return x6(t,e,r===!1?0:4)}function x9(t,e){if(!e)throw new Error("VtUnalignedString must have positive length");return x6(t,e,0)}function y9(t){for(var e=t.read_shift(4),r=[],n=0;n!=e;++n){var i=t.l;r[n]=t.read_shift(0,"lpwstr").replace(hs,""),t.l-i&2&&(t.l+=2)}return r}function w9(t){for(var e=t.read_shift(4),r=[],n=0;n!=e;++n)r[n]=t.read_shift(0,"lpstr-cp").replace(hs,"");return r}function E9(t){var e=t.l,r=Pg(t,o6);t[t.l]==0&&t[t.l+1]==0&&t.l-e&2&&(t.l+=2);var n=Pg(t,Cs);return[r,n]}function b9(t){for(var e=t.read_shift(4),r=[],n=0;n<e/2;++n)r.push(E9(t));return r}function I3(t,e){for(var r=t.read_shift(4),n={},i=0;i!=r;++i){var a=t.read_shift(4),o=t.read_shift(4);n[a]=t.read_shift(o,e===1200?"utf16le":"utf8").replace(hs,"").replace(c1,"!"),e===1200&&o%2&&(t.l+=2)}return t.l&3&&(t.l=t.l>>3<<2),n}function y6(t){var e=t.read_shift(4),r=t.slice(t.l,t.l+e);return t.l+=e,(e&3)>0&&(t.l+=4-(e&3)&3),r}function S9(t){var e={};return e.Size=t.read_shift(4),t.l+=e.Size+3-(e.Size-1)%4,e}function Pg(t,e,r){var n=t.read_shift(2),i,a=r||{};if(t.l+=2,e!==k3&&n!==e&&t9.indexOf(e)===-1&&!((e&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+e+" saw "+n);switch(e===k3?n:e){case 2:return i=t.read_shift(2,"i"),a.raw||(t.l+=2),i;case 3:return i=t.read_shift(4,"i"),i;case 11:return t.read_shift(4)!==0;case 19:return i=t.read_shift(4),i;case 30:return v6(t,n,4).replace(hs,"");case 31:return _6(t);case 64:return qy(t);case 65:return y6(t);case 71:return S9(t);case 80:return tx(t,n,!a.raw).replace(hs,"");case 81:return x9(t,n).replace(hs,"");case 4108:return b9(t);case 4126:case 4127:return n==4127?y9(t):w9(t);default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+n)}}function R3(t,e){var r=it(4),n=it(4);switch(r.write_shift(4,t==80?31:t),t){case 3:n.write_shift(-4,e);break;case 5:n=it(8),n.write_shift(8,e,"f");break;case 11:n.write_shift(4,e?1:0);break;case 64:n=_9(e);break;case 31:case 80:for(n=it(4+2*(e.length+1)+(e.length%2?0:2)),n.write_shift(4,e.length+1),n.write_shift(0,e,"dbcs");n.l!=n.length;)n.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+e)}return da([r,n])}function L3(t,e){var r=t.l,n=t.read_shift(4),i=t.read_shift(4),a=[],o=0,c=0,u=-1,h={};for(o=0;o!=i;++o){var d=t.read_shift(4),g=t.read_shift(4);a[o]=[d,g+r]}a.sort(function(M,B){return M[1]-B[1]});var x={};for(o=0;o!=i;++o){if(t.l!==a[o][1]){var _=!0;if(o>0&&e)switch(e[a[o-1][0]].t){case 2:t.l+2===a[o][1]&&(t.l+=2,_=!1);break;case 80:t.l<=a[o][1]&&(t.l=a[o][1],_=!1);break;case 4108:t.l<=a[o][1]&&(t.l=a[o][1],_=!1);break}if((!e||o==0)&&t.l<=a[o][1]&&(_=!1,t.l=a[o][1]),_)throw new Error("Read Error: Expected address "+a[o][1]+" at "+t.l+" :"+o)}if(e){var b=e[a[o][0]];if(x[b.n]=Pg(t,b.t,{raw:!0}),b.p==="version"&&(x[b.n]=String(x[b.n]>>16)+"."+("0000"+String(x[b.n]&65535)).slice(-4)),b.n=="CodePage")switch(x[b.n]){case 0:x[b.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:vl(c=x[b.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+x[b.n])}}else if(a[o][0]===1){if(c=x.CodePage=Pg(t,Uy),vl(c),u!==-1){var E=t.l;t.l=a[u][1],h=I3(t,c),t.l=E}}else if(a[o][0]===0){if(c===0){u=o,t.l=a[o+1][1];continue}h=I3(t,c)}else{var A=h[a[o][0]],O;switch(t[t.l]){case 65:t.l+=4,O=y6(t);break;case 30:t.l+=4,O=tx(t,t[t.l-4]).replace(/\u0000+$/,"");break;case 31:t.l+=4,O=tx(t,t[t.l-4]).replace(/\u0000+$/,"");break;case 3:t.l+=4,O=t.read_shift(4,"i");break;case 19:t.l+=4,O=t.read_shift(4);break;case 5:t.l+=4,O=t.read_shift(8,"f");break;case 11:t.l+=4,O=wi(t,4);break;case 64:t.l+=4,O=qn(qy(t));break;default:throw new Error("unparsed value: "+t[t.l])}x[A]=O}}return t.l=r+n,x}var w6=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function A9(t){switch(typeof t){case"boolean":return 11;case"number":return(t|0)==t?3:5;case"string":return 31;case"object":if(t instanceof Date)return 64;break}return-1}function D3(t,e,r){var n=it(8),i=[],a=[],o=8,c=0,u=it(8),h=it(8);if(u.write_shift(4,2),u.write_shift(4,1200),h.write_shift(4,1),a.push(u),i.push(h),o+=8+u.length,!e){h=it(8),h.write_shift(4,0),i.unshift(h);var d=[it(4)];for(d[0].write_shift(4,t.length),c=0;c<t.length;++c){var g=t[c][0];for(u=it(8+2*(g.length+1)+(g.length%2?0:2)),u.write_shift(4,c+2),u.write_shift(4,g.length+1),u.write_shift(0,g,"dbcs");u.l!=u.length;)u.write_shift(1,0);d.push(u)}u=da(d),a.unshift(u),o+=8+u.length}for(c=0;c<t.length;++c)if(!(e&&!e[t[c][0]])&&!(w6.indexOf(t[c][0])>-1||d6.indexOf(t[c][0])>-1)&&t[c][1]!=null){var x=t[c][1],_=0;if(e){_=+e[t[c][0]];var b=r[_];if(b.p=="version"&&typeof x=="string"){var E=x.split(".");x=(+E[0]<<16)+(+E[1]||0)}u=R3(b.t,x)}else{var A=A9(x);A==-1&&(A=31,x=String(x)),u=R3(A,x)}a.push(u),h=it(8),h.write_shift(4,e?_:2+c),i.push(h),o+=8+u.length}var O=8*(a.length+1);for(c=0;c<a.length;++c)i[c].write_shift(4,O),O+=a[c].length;return n.write_shift(4,o),n.write_shift(4,a.length),da([n].concat(i).concat(a))}function F3(t,e,r){var n=t.content;if(!n)return{};ka(n,0);var i,a,o,c,u=0;n.chk("feff","Byte Order: "),n.read_shift(2);var h=n.read_shift(4),d=n.read_shift(16);if(d!==Qt.utils.consts.HEADER_CLSID&&d!==r)throw new Error("Bad PropertySet CLSID "+d);if(i=n.read_shift(4),i!==1&&i!==2)throw new Error("Unrecognized #Sets: "+i);if(a=n.read_shift(16),c=n.read_shift(4),i===1&&c!==n.l)throw new Error("Length mismatch: "+c+" !== "+n.l);i===2&&(o=n.read_shift(16),u=n.read_shift(4));var g=L3(n,e),x={SystemIdentifier:h};for(var _ in g)x[_]=g[_];if(x.FMTID=a,i===1)return x;if(u-n.l==2&&(n.l+=2),n.l!==u)throw new Error("Length mismatch 2: "+n.l+" !== "+u);var b;try{b=L3(n,null)}catch{}for(_ in b)x[_]=b[_];return x.FMTID=[a,o],x}function O3(t,e,r,n,i,a){var o=it(i?68:48),c=[o];o.write_shift(2,65534),o.write_shift(2,0),o.write_shift(4,842412599),o.write_shift(16,Qt.utils.consts.HEADER_CLSID,"hex"),o.write_shift(4,i?2:1),o.write_shift(16,e,"hex"),o.write_shift(4,i?68:48);var u=D3(t,r,n);if(c.push(u),i){var h=D3(i,null,null);o.write_shift(16,a,"hex"),o.write_shift(4,68+u.length),c.push(h)}return da(c)}function Ku(t,e){return t.read_shift(e),null}function T9(t,e){e||(e=it(t));for(var r=0;r<t;++r)e.write_shift(1,0);return e}function k9(t,e,r){for(var n=[],i=t.l+e;t.l<i;)n.push(r(t,i-t.l));if(i!==t.l)throw new Error("Slurp error");return n}function wi(t,e){return t.read_shift(e)===1}function fs(t,e){return e||(e=it(2)),e.write_shift(2,+!!t),e}function Ui(t){return t.read_shift(2,"u")}function Po(t,e){return e||(e=it(2)),e.write_shift(2,t),e}function E6(t,e){return k9(t,e,Ui)}function N9(t){var e=t.read_shift(1),r=t.read_shift(1);return r===1?e:e===1}function b6(t,e,r){return r||(r=it(2)),r.write_shift(1,e=="e"?+t:+!!t),r.write_shift(1,e=="e"?1:0),r}function mp(t,e,r){var n=t.read_shift(r&&r.biff>=12?2:1),i="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var a=t.read_shift(1);a&&(i="dbcs-cont")}else r.biff==12&&(i="wstr");r.biff>=2&&r.biff<=5&&(i="cpstr");var o=n?t.read_shift(n,i):"";return o}function C9(t){var e=t.read_shift(2),r=t.read_shift(1),n=r&4,i=r&8,a=1+(r&1),o=0,c,u={};i&&(o=t.read_shift(2)),n&&(c=t.read_shift(4));var h=a==2?"dbcs-cont":"sbcs-cont",d=e===0?"":t.read_shift(e,h);return i&&(t.l+=4*o),n&&(t.l+=c),u.t=d,i||(u.raw="<t>"+u.t+"</t>",u.r=u.t),u}function I9(t){var e=t.t||"",r=it(3);r.write_shift(2,e.length),r.write_shift(1,1);var n=it(2*e.length);n.write_shift(2*e.length,e,"utf16le");var i=[r,n];return da(i)}function kh(t,e,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return t.read_shift(e,"cpstr");if(r.biff>=12)return t.read_shift(e,"dbcs-cont")}var i=t.read_shift(1);return i===0?n=t.read_shift(e,"sbcs-cont"):n=t.read_shift(e,"dbcs-cont"),n}function gp(t,e,r){var n=t.read_shift(r&&r.biff==2?1:2);return n===0?(t.l++,""):kh(t,n,r)}function Uh(t,e,r){if(r.biff>5)return gp(t,e,r);var n=t.read_shift(1);return n===0?(t.l++,""):t.read_shift(n,r.biff<=4||!t.lens?"cpstr":"sbcs-cont")}function S6(t,e,r){return r||(r=it(3+2*t.length)),r.write_shift(2,t.length),r.write_shift(1,1),r.write_shift(31,t,"utf16le"),r}function R9(t){var e=t.read_shift(1);t.l++;var r=t.read_shift(2);return t.l+=2,[e,r]}function L9(t){var e=t.read_shift(4),r=t.l,n=!1;e>24&&(t.l+=e-24,t.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),t.l=r);var i=t.read_shift((n?e-24:e)>>1,"utf16le").replace(hs,"");return n&&(t.l+=24),i}function D9(t){for(var e=t.read_shift(2),r="";e-- >0;)r+="../";var n=t.read_shift(0,"lpstr-ansi");if(t.l+=2,t.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var i=t.read_shift(4);if(i===0)return r+n.replace(/\\/g,"/");var a=t.read_shift(4);if(t.read_shift(2)!=3)throw new Error("Bad FileMoniker");var o=t.read_shift(a>>1,"utf16le").replace(hs,"");return r+o}function F9(t,e){var r=t.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return L9(t);case"0303000000000000c000000000000046":return D9(t);default:throw new Error("Unsupported Moniker "+r)}}function Cm(t){var e=t.read_shift(4),r=e>0?t.read_shift(e,"utf16le").replace(hs,""):"";return r}function P3(t,e){e||(e=it(6+t.length*2)),e.write_shift(4,1+t.length);for(var r=0;r<t.length;++r)e.write_shift(2,t.charCodeAt(r));return e.write_shift(2,0),e}function O9(t,e){var r=t.l+e,n=t.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var i=t.read_shift(2);t.l+=2;var a,o,c,u,h="",d,g;i&16&&(a=Cm(t,r-t.l)),i&128&&(o=Cm(t,r-t.l)),(i&257)===257&&(c=Cm(t,r-t.l)),(i&257)===1&&(u=F9(t,r-t.l)),i&8&&(h=Cm(t,r-t.l)),i&32&&(d=t.read_shift(16)),i&64&&(g=qy(t)),t.l=r;var x=o||c||u||"";x&&h&&(x+="#"+h),x||(x="#"+h),i&2&&x.charAt(0)=="/"&&x.charAt(1)!="/"&&(x="file://"+x);var _={Target:x};return d&&(_.guid=d),g&&(_.time=g),a&&(_.Tooltip=a),_}function P9(t){var e=it(512),r=0,n=t.Target;n.slice(0,7)=="file://"&&(n=n.slice(7));var i=n.indexOf("#"),a=i>-1?31:23;switch(n.charAt(0)){case"#":a=28;break;case".":a&=-3;break}e.write_shift(4,2),e.write_shift(4,a);var o=[8,6815827,6619237,4849780,83];for(r=0;r<o.length;++r)e.write_shift(4,o[r]);if(a==28)n=n.slice(1),P3(n,e);else if(a&2){for(o="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<o.length;++r)e.write_shift(1,parseInt(o[r],16));var c=i>-1?n.slice(0,i):n;for(e.write_shift(4,2*(c.length+1)),r=0;r<c.length;++r)e.write_shift(2,c.charCodeAt(r));e.write_shift(2,0),a&8&&P3(i>-1?n.slice(i+1):"",e)}else{for(o="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<o.length;++r)e.write_shift(1,parseInt(o[r],16));for(var u=0;n.slice(u*3,u*3+3)=="../"||n.slice(u*3,u*3+3)=="..\\";)++u;for(e.write_shift(2,u),e.write_shift(4,n.length-3*u+1),r=0;r<n.length-3*u;++r)e.write_shift(1,n.charCodeAt(r+3*u)&255);for(e.write_shift(1,0),e.write_shift(2,65535),e.write_shift(2,57005),r=0;r<6;++r)e.write_shift(4,0)}return e.slice(0,e.l)}function A6(t){var e=t.read_shift(1),r=t.read_shift(1),n=t.read_shift(1),i=t.read_shift(1);return[e,r,n,i]}function T6(t,e){var r=A6(t);return r[3]=0,r}function _c(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2);return{r:e,c:r,ixfe:n}}function Nh(t,e,r,n){return n||(n=it(6)),n.write_shift(2,t),n.write_shift(2,e),n.write_shift(2,r||0),n}function M9(t){var e=t.read_shift(2),r=t.read_shift(2);return t.l+=8,{type:e,flags:r}}function B9(t,e,r){return e===0?"":Uh(t,e,r)}function j9(t,e,r){var n=r.biff>8?4:2,i=t.read_shift(n),a=t.read_shift(n,"i"),o=t.read_shift(n,"i");return[i,a,o]}function k6(t){var e=t.read_shift(2),r=jy(t);return[e,r]}function U9(t,e,r){t.l+=4,e-=4;var n=t.l+e,i=mp(t,e,r),a=t.read_shift(2);if(n-=t.l,a!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+a);return t.l+=a,i}function v2(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2),i=t.read_shift(2);return{s:{c:n,r:e},e:{c:i,r}}}function N6(t,e){return e||(e=it(8)),e.write_shift(2,t.s.r),e.write_shift(2,t.e.r),e.write_shift(2,t.s.c),e.write_shift(2,t.e.c),e}function C6(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(1),i=t.read_shift(1);return{s:{c:n,r:e},e:{c:i,r}}}var V9=C6;function I6(t){t.l+=4;var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2);return t.l+=12,[r,e,n]}function q9(t){var e={};return t.l+=4,t.l+=16,e.fSharedNote=t.read_shift(2),t.l+=4,e}function z9(t){var e={};return t.l+=4,t.cf=t.read_shift(2),e}function Ha(t){t.l+=2,t.l+=t.read_shift(2)}var H9={0:Ha,4:Ha,5:Ha,6:Ha,7:z9,8:Ha,9:Ha,10:Ha,11:Ha,12:Ha,13:q9,14:Ha,15:Ha,16:Ha,17:Ha,18:Ha,19:Ha,20:Ha,21:I6};function G9(t,e){for(var r=t.l+e,n=[];t.l<r;){var i=t.read_shift(2);t.l-=2;try{n.push(H9[i](t,r-t.l))}catch{return t.l=r,n}}return t.l!=r&&(t.l=r),n}function Im(t,e){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=t.read_shift(2),e-=2,e>=2&&(r.dt=t.read_shift(2),t.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(e>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return t.read_shift(e),r}function zy(t,e,r){var n=1536,i=16;switch(r.bookType){case"biff8":break;case"biff5":n=1280,i=8;break;case"biff4":n=4,i=6;break;case"biff3":n=3,i=6;break;case"biff2":n=2,i=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var a=it(i);return a.write_shift(2,n),a.write_shift(2,e),i>4&&a.write_shift(2,29282),i>6&&a.write_shift(2,1997),i>8&&(a.write_shift(2,49161),a.write_shift(2,1),a.write_shift(2,1798),a.write_shift(2,0)),a}function W9(t,e){return e===0||t.read_shift(2),1200}function X9(t,e,r){if(r.enc)return t.l+=e,"";var n=t.l,i=Uh(t,0,r);return t.read_shift(e+n-t.l),i}function Y9(t,e){var r=!e||e.biff==8,n=it(r?112:54);for(n.write_shift(e.biff==8?2:1,7),r&&n.write_shift(1,0),n.write_shift(4,859007059),n.write_shift(4,5458548|(r?0:536870912));n.l<n.length;)n.write_shift(1,r?0:32);return n}function K9(t,e,r){var n=r&&r.biff==8||e==2?t.read_shift(2):(t.l+=e,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function $9(t,e,r){var n=t.read_shift(4),i=t.read_shift(1)&3,a=t.read_shift(1);switch(a){case 0:a="Worksheet";break;case 1:a="Macrosheet";break;case 2:a="Chartsheet";break;case 6:a="VBAModule";break}var o=mp(t,0,r);return o.length===0&&(o="Sheet1"),{pos:n,hs:i,dt:a,name:o}}function Q9(t,e){var r=!e||e.biff>=8?2:1,n=it(8+r*t.name.length);n.write_shift(4,t.pos),n.write_shift(1,t.hs||0),n.write_shift(1,t.dt),n.write_shift(1,t.name.length),e.biff>=8&&n.write_shift(1,1),n.write_shift(r*t.name.length,t.name,e.biff<8?"sbcs":"utf16le");var i=n.slice(0,n.l);return i.l=n.l,i}function J9(t,e){for(var r=t.l+e,n=t.read_shift(4),i=t.read_shift(4),a=[],o=0;o!=i&&t.l<r;++o)a.push(C9(t));return a.Count=n,a.Unique=i,a}function Z9(t,e){var r=it(8);r.write_shift(4,t.Count),r.write_shift(4,t.Unique);for(var n=[],i=0;i<t.length;++i)n[i]=I9(t[i]);var a=da([r].concat(n));return a.parts=[r.length].concat(n.map(function(o){return o.length})),a}function eM(t,e){var r={};return r.dsst=t.read_shift(2),t.l+=e-2,r}function tM(t){var e={};e.r=t.read_shift(2),e.c=t.read_shift(2),e.cnt=t.read_shift(2)-e.c;var r=t.read_shift(2);t.l+=4;var n=t.read_shift(1);return t.l+=3,n&7&&(e.level=n&7),n&32&&(e.hidden=!0),n&64&&(e.hpt=r/20),e}function rM(t){var e=M9(t);if(e.type!=2211)throw new Error("Invalid Future Record "+e.type);var r=t.read_shift(4);return r!==0}function nM(t){return t.read_shift(2),t.read_shift(4)}function M3(t,e,r){var n=0;r&&r.biff==2||(n=t.read_shift(2));var i=t.read_shift(2);r&&r.biff==2&&(n=1-(i>>15),i&=32767);var a={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[a,i]}function iM(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2),i=t.read_shift(2),a=t.read_shift(2),o=t.read_shift(2),c=t.read_shift(2),u=t.read_shift(2),h=t.read_shift(2);return{Pos:[e,r],Dim:[n,i],Flags:a,CurTab:o,FirstTab:c,Selected:u,TabRatio:h}}function aM(){var t=it(18);return t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,29280),t.write_shift(2,17600),t.write_shift(2,56),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,1),t.write_shift(2,500),t}function sM(t,e,r){if(r&&r.biff>=2&&r.biff<5)return{};var n=t.read_shift(2);return{RTL:n&64}}function oM(t){var e=it(18),r=1718;return t&&t.RTL&&(r|=64),e.write_shift(2,r),e.write_shift(4,0),e.write_shift(4,64),e.write_shift(4,0),e.write_shift(4,0),e}function lM(){}function cM(t,e,r){var n={dyHeight:t.read_shift(2),fl:t.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:t.l+=2;break;default:t.l+=10;break}return n.name=mp(t,0,r),n}function uM(t,e){var r=t.name||"Arial",n=e&&e.biff==5,i=n?15+r.length:16+2*r.length,a=it(i);return a.write_shift(2,t.sz*20),a.write_shift(4,0),a.write_shift(2,400),a.write_shift(4,0),a.write_shift(2,0),a.write_shift(1,r.length),n||a.write_shift(1,1),a.write_shift((n?1:2)*r.length,r,n?"sbcs":"utf16le"),a}function fM(t){var e=_c(t);return e.isst=t.read_shift(4),e}function hM(t,e,r,n){var i=it(10);return Nh(t,e,n,i),i.write_shift(4,r),i}function dM(t,e,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=t.l+e,i=_c(t);r.biff==2&&t.l++;var a=gp(t,n-t.l,r);return i.val=a,i}function pM(t,e,r,n,i){var a=!i||i.biff==8,o=it(8+ +a+(1+a)*r.length);return Nh(t,e,n,o),o.write_shift(2,r.length),a&&o.write_shift(1,1),o.write_shift((1+a)*r.length,r,a?"utf16le":"sbcs"),o}function mM(t,e,r){var n=t.read_shift(2),i=Uh(t,0,r);return[n,i]}function gM(t,e,r,n){var i=r&&r.biff==5;n||(n=it(i?3+e.length:5+2*e.length)),n.write_shift(2,t),n.write_shift(i?1:2,e.length),i||n.write_shift(1,1),n.write_shift((i?1:2)*e.length,e,i?"sbcs":"utf16le");var a=n.length>n.l?n.slice(0,n.l):n;return a.l==null&&(a.l=a.length),a}var vM=Uh;function B3(t,e,r){var n=t.l+e,i=r.biff==8||!r.biff?4:2,a=t.read_shift(i),o=t.read_shift(i),c=t.read_shift(2),u=t.read_shift(2);return t.l=n,{s:{r:a,c},e:{r:o,c:u}}}function _M(t,e){var r=e.biff==8||!e.biff?4:2,n=it(2*r+6);return n.write_shift(r,t.s.r),n.write_shift(r,t.e.r+1),n.write_shift(2,t.s.c),n.write_shift(2,t.e.c+1),n.write_shift(2,0),n}function xM(t){var e=t.read_shift(2),r=t.read_shift(2),n=k6(t);return{r:e,c:r,ixfe:n[0],rknum:n[1]}}function yM(t,e){for(var r=t.l+e-2,n=t.read_shift(2),i=t.read_shift(2),a=[];t.l<r;)a.push(k6(t));if(t.l!==r)throw new Error("MulRK read error");var o=t.read_shift(2);if(a.length!=o-i+1)throw new Error("MulRK length mismatch");return{r:n,c:i,C:o,rkrec:a}}function wM(t,e){for(var r=t.l+e-2,n=t.read_shift(2),i=t.read_shift(2),a=[];t.l<r;)a.push(t.read_shift(2));if(t.l!==r)throw new Error("MulBlank read error");var o=t.read_shift(2);if(a.length!=o-i+1)throw new Error("MulBlank length mismatch");return{r:n,c:i,C:o,ixfe:a}}function EM(t,e,r,n){var i={},a=t.read_shift(4),o=t.read_shift(4),c=t.read_shift(4),u=t.read_shift(2);return i.patternType=r9[c>>26],n.cellStyles&&(i.alc=a&7,i.fWrap=a>>3&1,i.alcV=a>>4&7,i.fJustLast=a>>7&1,i.trot=a>>8&255,i.cIndent=a>>16&15,i.fShrinkToFit=a>>20&1,i.iReadOrder=a>>22&2,i.fAtrNum=a>>26&1,i.fAtrFnt=a>>27&1,i.fAtrAlc=a>>28&1,i.fAtrBdr=a>>29&1,i.fAtrPat=a>>30&1,i.fAtrProt=a>>31&1,i.dgLeft=o&15,i.dgRight=o>>4&15,i.dgTop=o>>8&15,i.dgBottom=o>>12&15,i.icvLeft=o>>16&127,i.icvRight=o>>23&127,i.grbitDiag=o>>30&3,i.icvTop=c&127,i.icvBottom=c>>7&127,i.icvDiag=c>>14&127,i.dgDiag=c>>21&15,i.icvFore=u&127,i.icvBack=u>>7&127,i.fsxButton=u>>14&1),i}function bM(t,e,r){var n={};return n.ifnt=t.read_shift(2),n.numFmtId=t.read_shift(2),n.flags=t.read_shift(2),n.fStyle=n.flags>>2&1,e-=6,n.data=EM(t,e,n.fStyle,r),n}function j3(t,e,r,n){var i=r&&r.biff==5;n||(n=it(i?16:20)),n.write_shift(2,0),t.style?(n.write_shift(2,t.numFmtId||0),n.write_shift(2,65524)):(n.write_shift(2,t.numFmtId||0),n.write_shift(2,e<<4));var a=0;return t.numFmtId>0&&i&&(a|=1024),n.write_shift(4,a),n.write_shift(4,0),i||n.write_shift(4,0),n.write_shift(2,0),n}function SM(t){t.l+=4;var e=[t.read_shift(2),t.read_shift(2)];if(e[0]!==0&&e[0]--,e[1]!==0&&e[1]--,e[0]>7||e[1]>7)throw new Error("Bad Gutters: "+e.join("|"));return e}function AM(t){var e=it(8);return e.write_shift(4,0),e.write_shift(2,0),e.write_shift(2,0),e}function U3(t,e,r){var n=_c(t);(r.biff==2||e==9)&&++t.l;var i=N9(t);return n.val=i,n.t=i===!0||i===!1?"b":"e",n}function TM(t,e,r,n,i,a){var o=it(8);return Nh(t,e,n,o),b6(r,a,o),o}function kM(t,e,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=_c(t),i=es(t);return n.val=i,n}function NM(t,e,r,n){var i=it(14);return Nh(t,e,n,i),Th(r,i),i}var V3=B9;function CM(t,e,r){var n=t.l+e,i=t.read_shift(2),a=t.read_shift(2);if(r.sbcch=a,a==1025||a==14849)return[a,i];if(a<1||a>255)throw new Error("Unexpected SupBook type: "+a);for(var o=kh(t,a),c=[];n>t.l;)c.push(gp(t));return[a,i,o,c]}function q3(t,e,r){var n=t.read_shift(2),i,a={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return r.sbcch===14849&&(i=U9(t,e-2,r)),a.body=i||t.read_shift(e-2),typeof i=="string"&&(a.Name=i),a}var IM=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function z3(t,e,r){var n=t.l+e,i=t.read_shift(2),a=t.read_shift(1),o=t.read_shift(1),c=t.read_shift(r&&r.biff==2?1:2),u=0;(!r||r.biff>=5)&&(r.biff!=5&&(t.l+=2),u=t.read_shift(2),r.biff==5&&(t.l+=2),t.l+=4);var h=kh(t,o,r);i&32&&(h=IM[h.charCodeAt(0)]);var d=n-t.l;r&&r.biff==2&&--d;var g=n==t.l||c===0||!(d>0)?[]:GV(t,d,r,c);return{chKey:a,Name:h,itab:u,rgce:g}}function R6(t,e,r){if(r.biff<8)return RM(t,e,r);for(var n=[],i=t.l+e,a=t.read_shift(r.biff>8?4:2);a--!==0;)n.push(j9(t,r.biff>8?12:6,r));if(t.l!=i)throw new Error("Bad ExternSheet: "+t.l+" != "+i);return n}function RM(t,e,r){t[t.l+1]==3&&t[t.l]++;var n=mp(t,e,r);return n.charCodeAt(0)==3?n.slice(1):n}function LM(t,e,r){if(r.biff<8){t.l+=e;return}var n=t.read_shift(2),i=t.read_shift(2),a=kh(t,n,r),o=kh(t,i,r);return[a,o]}function DM(t,e,r){var n=C6(t);t.l++;var i=t.read_shift(1);return e-=8,[WV(t,e,r),i,n]}function H3(t,e,r){var n=V9(t);switch(r.biff){case 2:t.l++,e-=7;break;case 3:case 4:t.l+=2,e-=8;break;default:t.l+=6,e-=12}return[n,zV(t,e,r)]}function FM(t){var e=t.read_shift(4)!==0,r=t.read_shift(4)!==0,n=t.read_shift(4);return[e,r,n]}function OM(t,e,r){if(!(r.biff<8)){var n=t.read_shift(2),i=t.read_shift(2),a=t.read_shift(2),o=t.read_shift(2),c=Uh(t,0,r);return r.biff<8&&t.read_shift(1),[{r:n,c:i},c,o,a]}}function PM(t,e,r){return OM(t,e,r)}function MM(t,e){for(var r=[],n=t.read_shift(2);n--;)r.push(v2(t));return r}function BM(t){var e=it(2+t.length*8);e.write_shift(2,t.length);for(var r=0;r<t.length;++r)N6(t[r],e);return e}function jM(t,e,r){if(r&&r.biff<8)return VM(t,e,r);var n=I6(t),i=G9(t,e-22,n[1]);return{cmo:n,ft:i}}var UM={8:function(t,e){var r=t.l+e;t.l+=10;var n=t.read_shift(2);t.l+=4,t.l+=2,t.l+=2,t.l+=2,t.l+=4;var i=t.read_shift(1);return t.l+=i,t.l=r,{fmt:n}}};function VM(t,e,r){t.l+=4;var n=t.read_shift(2),i=t.read_shift(2),a=t.read_shift(2);t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=6,e-=36;var o=[];return o.push((UM[n]||is)(t,e,r)),{cmo:[i,n,a],ft:o}}function qM(t,e,r){var n=t.l,i="";try{t.l+=4;var a=(r.lastobj||{cmo:[0,0]}).cmo[1],o;[0,5,7,11,12,14].indexOf(a)==-1?t.l+=6:o=R9(t,6,r);var c=t.read_shift(2);t.read_shift(2),Ui(t,2);var u=t.read_shift(2);t.l+=u;for(var h=1;h<t.lens.length-1;++h){if(t.l-n!=t.lens[h])throw new Error("TxO: bad continue record");var d=t[t.l],g=kh(t,t.lens[h+1]-t.lens[h]-1);if(i+=g,i.length>=(d?c:2*c))break}if(i.length!==c&&i.length!==c*2)throw new Error("cchText: "+c+" != "+i.length);return t.l=n+e,{t:i}}catch{return t.l=n+e,{t:i}}}function zM(t,e){var r=v2(t);t.l+=16;var n=O9(t,e-24);return[r,n]}function HM(t){var e=it(24),r=ti(t[0]);e.write_shift(2,r.r),e.write_shift(2,r.r),e.write_shift(2,r.c),e.write_shift(2,r.c);for(var n="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),i=0;i<16;++i)e.write_shift(1,parseInt(n[i],16));return da([e,P9(t[1])])}function GM(t,e){t.read_shift(2);var r=v2(t),n=t.read_shift((e-10)/2,"dbcs-cont");return n=n.replace(hs,""),[r,n]}function WM(t){var e=t[1].Tooltip,r=it(10+2*(e.length+1));r.write_shift(2,2048);var n=ti(t[0]);r.write_shift(2,n.r),r.write_shift(2,n.r),r.write_shift(2,n.c),r.write_shift(2,n.c);for(var i=0;i<e.length;++i)r.write_shift(2,e.charCodeAt(i));return r.write_shift(2,0),r}function XM(t){var e=[0,0],r;return r=t.read_shift(2),e[0]=N3[r]||r,r=t.read_shift(2),e[1]=N3[r]||r,e}function YM(t){return t||(t=it(4)),t.write_shift(2,1),t.write_shift(2,1),t}function KM(t){for(var e=t.read_shift(2),r=[];e-- >0;)r.push(T6(t));return r}function $M(t){for(var e=t.read_shift(2),r=[];e-- >0;)r.push(T6(t));return r}function QM(t){t.l+=2;var e={cxfs:0,crc:0};return e.cxfs=t.read_shift(2),e.crc=t.read_shift(4),e}function L6(t,e,r){if(!r.cellStyles)return is(t,e);var n=r&&r.biff>=12?4:2,i=t.read_shift(n),a=t.read_shift(n),o=t.read_shift(n),c=t.read_shift(n),u=t.read_shift(2);n==2&&(t.l+=2);var h={s:i,e:a,w:o,ixfe:c,flags:u};return(r.biff>=5||!r.biff)&&(h.level=u>>8&7),h}function JM(t,e){var r=it(12);r.write_shift(2,e),r.write_shift(2,e),r.write_shift(2,t.width*256),r.write_shift(2,0);var n=0;return t.hidden&&(n|=1),r.write_shift(1,n),n=t.level||0,r.write_shift(1,n),r.write_shift(2,0),r}function ZM(t,e){var r={};return e<32||(t.l+=16,r.header=es(t),r.footer=es(t),t.l+=2),r}function eB(t,e,r){var n={area:!1};if(r.biff!=5)return t.l+=e,n;var i=t.read_shift(1);return t.l+=3,i&16&&(n.area=!0),n}function tB(t){for(var e=it(2*t),r=0;r<t;++r)e.write_shift(2,r+1);return e}var rB=_c,nB=E6,iB=gp;function aB(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(4),i={fmt:e,env:r,len:n,data:t.slice(t.l,t.l+n)};return t.l+=n,i}function sB(t,e,r){r.biffguess&&r.biff==5&&(r.biff=2);var n=_c(t);++t.l;var i=Uh(t,e-7,r);return n.t="str",n.val=i,n}function oB(t){var e=_c(t);++t.l;var r=es(t);return e.t="n",e.val=r,e}function lB(t,e,r){var n=it(15);return yp(n,t,e),n.write_shift(8,r,"f"),n}function cB(t){var e=_c(t);++t.l;var r=t.read_shift(2);return e.t="n",e.val=r,e}function uB(t,e,r){var n=it(9);return yp(n,t,e),n.write_shift(2,r),n}function fB(t){var e=t.read_shift(1);return e===0?(t.l++,""):t.read_shift(e,"sbcs-cont")}function hB(t,e){t.l+=6,t.l+=2,t.l+=1,t.l+=3,t.l+=1,t.l+=e-13}function dB(t,e,r){var n=t.l+e,i=_c(t),a=t.read_shift(2),o=kh(t,a,r);return t.l=n,i.t="str",i.val=o,i}var pB=[2,3,48,49,131,139,140,245],rx=function(){var t={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},e=p2({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(c,u){var h=[],d=wf(1);switch(u.type){case"base64":d=eo(so(c));break;case"binary":d=eo(c);break;case"buffer":case"array":d=c;break}ka(d,0);var g=d.read_shift(1),x=!!(g&136),_=!1,b=!1;switch(g){case 2:break;case 3:break;case 48:_=!0,x=!0;break;case 49:_=!0,x=!0;break;case 131:break;case 139:break;case 140:b=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+g.toString(16))}var E=0,A=521;g==2&&(E=d.read_shift(2)),d.l+=3,g!=2&&(E=d.read_shift(4)),E>1048576&&(E=1e6),g!=2&&(A=d.read_shift(2));var O=d.read_shift(2),M=u.codepage||1252;g!=2&&(d.l+=16,d.read_shift(1),d[d.l]!==0&&(M=t[d[d.l]]),d.l+=1,d.l+=2),b&&(d.l+=36);for(var B=[],Q={},ee=Math.min(d.length,g==2?521:A-10-(_?264:0)),he=b?32:11;d.l<ee&&d[d.l]!=13;)switch(Q={},Q.name=M1.utils.decode(M,d.slice(d.l,d.l+he)).replace(/[\u0000\r\n].*$/g,""),d.l+=he,Q.type=String.fromCharCode(d.read_shift(1)),g!=2&&!b&&(Q.offset=d.read_shift(4)),Q.len=d.read_shift(1),g==2&&(Q.offset=d.read_shift(2)),Q.dec=d.read_shift(1),Q.name.length&&B.push(Q),g!=2&&(d.l+=b?13:14),Q.type){case"B":(!_||Q.len!=8)&&u.WTF&&console.log("Skipping "+Q.name+":"+Q.type);break;case"G":case"P":u.WTF&&console.log("Skipping "+Q.name+":"+Q.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+Q.type)}if(d[d.l]!==13&&(d.l=A-1),d.read_shift(1)!==13)throw new Error("DBF Terminator not found "+d.l+" "+d[d.l]);d.l=A;var F=0,k=0;for(h[0]=[],k=0;k!=B.length;++k)h[0][k]=B[k].name;for(;E-- >0;){if(d[d.l]===42){d.l+=O;continue}for(++d.l,h[++F]=[],k=0,k=0;k!=B.length;++k){var S=d.slice(d.l,d.l+B[k].len);d.l+=B[k].len,ka(S,0);var U=M1.utils.decode(M,S);switch(B[k].type){case"C":U.trim().length&&(h[F][k]=U.replace(/\s+$/,""));break;case"D":U.length===8?h[F][k]=new Date(+U.slice(0,4),+U.slice(4,6)-1,+U.slice(6,8)):h[F][k]=U;break;case"F":h[F][k]=parseFloat(U.trim());break;case"+":case"I":h[F][k]=b?S.read_shift(-4,"i")^2147483648:S.read_shift(4,"i");break;case"L":switch(U.trim().toUpperCase()){case"Y":case"T":h[F][k]=!0;break;case"N":case"F":h[F][k]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+U+"|")}break;case"M":if(!x)throw new Error("DBF Unexpected MEMO for type "+g.toString(16));h[F][k]="##MEMO##"+(b?parseInt(U.trim(),10):S.read_shift(4));break;case"N":U=U.replace(/\u0000/g,"").trim(),U&&U!="."&&(h[F][k]=+U||0);break;case"@":h[F][k]=new Date(S.read_shift(-8,"f")-621356832e5);break;case"T":h[F][k]=new Date((S.read_shift(4)-2440588)*864e5+S.read_shift(4));break;case"Y":h[F][k]=S.read_shift(4,"i")/1e4+S.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":h[F][k]=-S.read_shift(-8,"f");break;case"B":if(_&&B[k].len==8){h[F][k]=S.read_shift(8,"f");break}case"G":case"P":S.l+=B[k].len;break;case"0":if(B[k].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+B[k].type)}}}if(g!=2&&d.l<d.length&&d[d.l++]!=26)throw new Error("DBF EOF Marker missing "+(d.l-1)+" of "+d.length+" "+d[d.l-1].toString(16));return u&&u.sheetRows&&(h=h.slice(0,u.sheetRows)),u.DBF=B,h}function n(c,u){var h=u||{};h.dateNF||(h.dateNF="yyyymmdd");var d=fd(r(c,h),h);return d["!cols"]=h.DBF.map(function(g){return{wch:g.len,DBF:g}}),delete h.DBF,d}function i(c,u){try{return Ff(n(c,u),u)}catch(h){if(u&&u.WTF)throw h}return{SheetNames:[],Sheets:{}}}var a={B:8,C:250,L:1,D:8,"?":0,"":0};function o(c,u){var h=u||{};if(+h.codepage>=0&&vl(+h.codepage),h.type=="string")throw new Error("Cannot write DBF to JS string");var d=Ls(),g=jg(c,{header:1,raw:!0,cellDates:!0}),x=g[0],_=g.slice(1),b=c["!cols"]||[],E=0,A=0,O=0,M=1;for(E=0;E<x.length;++E){if(((b[E]||{}).DBF||{}).name){x[E]=b[E].DBF.name,++O;continue}if(x[E]!=null){if(++O,typeof x[E]=="number"&&(x[E]=x[E].toString(10)),typeof x[E]!="string")throw new Error("DBF Invalid column name "+x[E]+" |"+typeof x[E]+"|");if(x.indexOf(x[E])!==E){for(A=0;A<1024;++A)if(x.indexOf(x[E]+"_"+A)==-1){x[E]+="_"+A;break}}}}var B=rn(c["!ref"]),Q=[],ee=[],he=[];for(E=0;E<=B.e.c-B.s.c;++E){var F="",k="",S=0,U=[];for(A=0;A<_.length;++A)_[A][E]!=null&&U.push(_[A][E]);if(U.length==0||x[E]==null){Q[E]="?";continue}for(A=0;A<U.length;++A){switch(typeof U[A]){case"number":k="B";break;case"string":k="C";break;case"boolean":k="L";break;case"object":k=U[A]instanceof Date?"D":"C";break;default:k="C"}S=Math.max(S,String(U[A]).length),F=F&&F!=k?"C":k}S>250&&(S=250),k=((b[E]||{}).DBF||{}).type,k=="C"&&b[E].DBF.len>S&&(S=b[E].DBF.len),F=="B"&&k=="N"&&(F="N",he[E]=b[E].DBF.dec,S=b[E].DBF.len),ee[E]=F=="C"||k=="N"?S:a[F]||0,M+=ee[E],Q[E]=F}var I=d.next(32);for(I.write_shift(4,318902576),I.write_shift(4,_.length),I.write_shift(2,296+32*O),I.write_shift(2,M),E=0;E<4;++E)I.write_shift(4,0);for(I.write_shift(4,0|(+e[wT]||3)<<8),E=0,A=0;E<x.length;++E)if(x[E]!=null){var C=d.next(32),R=(x[E].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);C.write_shift(1,R,"sbcs"),C.write_shift(1,Q[E]=="?"?"C":Q[E],"sbcs"),C.write_shift(4,A),C.write_shift(1,ee[E]||a[Q[E]]||0),C.write_shift(1,he[E]||0),C.write_shift(1,2),C.write_shift(4,0),C.write_shift(1,0),C.write_shift(4,0),C.write_shift(4,0),A+=ee[E]||a[Q[E]]||0}var se=d.next(264);for(se.write_shift(4,13),E=0;E<65;++E)se.write_shift(4,0);for(E=0;E<_.length;++E){var ne=d.next(M);for(ne.write_shift(1,0),A=0;A<x.length;++A)if(x[A]!=null)switch(Q[A]){case"L":ne.write_shift(1,_[E][A]==null?63:_[E][A]?84:70);break;case"B":ne.write_shift(8,_[E][A]||0,"f");break;case"N":var J="0";for(typeof _[E][A]=="number"&&(J=_[E][A].toFixed(he[A]||0)),O=0;O<ee[A]-J.length;++O)ne.write_shift(1,32);ne.write_shift(1,J,"sbcs");break;case"D":_[E][A]?(ne.write_shift(4,("0000"+_[E][A].getFullYear()).slice(-4),"sbcs"),ne.write_shift(2,("00"+(_[E][A].getMonth()+1)).slice(-2),"sbcs"),ne.write_shift(2,("00"+_[E][A].getDate()).slice(-2),"sbcs")):ne.write_shift(8,"00000000","sbcs");break;case"C":var de=String(_[E][A]!=null?_[E][A]:"").slice(0,ee[A]);for(ne.write_shift(1,de,"sbcs"),O=0;O<ee[A]-de.length;++O)ne.write_shift(1,32);break}}return d.next(1).write_shift(1,26),d.end()}return{to_workbook:i,to_sheet:n,from_sheet:o}}(),D6=function(){var t={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},e=new RegExp("\x1BN("+hi(t).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(x,_){var b=t[_];return typeof b=="number"?t3(b):b},n=function(x,_,b){var E=_.charCodeAt(0)-32<<4|b.charCodeAt(0)-48;return E==59?x:t3(E)};t["|"]=254;function i(x,_){switch(_.type){case"base64":return a(so(x),_);case"binary":return a(x,_);case"buffer":return a(Lr&&Buffer.isBuffer(x)?x.toString("binary"):Df(x),_);case"array":return a(Ah(x),_)}throw new Error("Unrecognized type "+_.type)}function a(x,_){var b=x.split(/[\n\r]+/),E=-1,A=-1,O=0,M=0,B=[],Q=[],ee=null,he={},F=[],k=[],S=[],U=0,I;for(+_.codepage>=0&&vl(+_.codepage);O!==b.length;++O){U=0;var C=b[O].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(e,r),R=C.replace(/;;/g,"\0").split(";").map(function(G){return G.replace(/\u0000/g,";")}),se=R[0],ne;if(C.length>0)switch(se){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":R[1].charAt(0)=="P"&&Q.push(C.slice(3).replace(/;;/g,";"));break;case"C":var J=!1,de=!1,oe=!1,Z=!1,X=-1,xe=-1;for(M=1;M<R.length;++M)switch(R[M].charAt(0)){case"A":break;case"X":A=parseInt(R[M].slice(1))-1,de=!0;break;case"Y":for(E=parseInt(R[M].slice(1))-1,de||(A=0),I=B.length;I<=E;++I)B[I]=[];break;case"K":ne=R[M].slice(1),ne.charAt(0)==='"'?ne=ne.slice(1,ne.length-1):ne==="TRUE"?ne=!0:ne==="FALSE"?ne=!1:isNaN(xl(ne))?isNaN(Q0(ne).getDate())||(ne=qn(ne)):(ne=xl(ne),ee!==null&&cd(ee)&&(ne=g2(ne))),J=!0;break;case"E":Z=!0;var L=j0(R[M].slice(1),{r:E,c:A});B[E][A]=[B[E][A],L];break;case"S":oe=!0,B[E][A]=[B[E][A],"S5S"];break;case"G":break;case"R":X=parseInt(R[M].slice(1))-1;break;case"C":xe=parseInt(R[M].slice(1))-1;break;default:if(_&&_.WTF)throw new Error("SYLK bad record "+C)}if(J&&(B[E][A]&&B[E][A].length==2?B[E][A][0]=ne:B[E][A]=ne,ee=null),oe){if(Z)throw new Error("SYLK shared formula cannot have own formula");var j=X>-1&&B[X][xe];if(!j||!j[1])throw new Error("SYLK shared formula cannot find base");B[E][A][1]=Q6(j[1],{r:E-X,c:A-xe})}break;case"F":var z=0;for(M=1;M<R.length;++M)switch(R[M].charAt(0)){case"X":A=parseInt(R[M].slice(1))-1,++z;break;case"Y":for(E=parseInt(R[M].slice(1))-1,I=B.length;I<=E;++I)B[I]=[];break;case"M":U=parseInt(R[M].slice(1))/20;break;case"F":break;case"G":break;case"P":ee=Q[parseInt(R[M].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(S=R[M].slice(1).split(" "),I=parseInt(S[0],10);I<=parseInt(S[1],10);++I)U=parseInt(S[2],10),k[I-1]=U===0?{hidden:!0}:{wch:U},Ef(k[I-1]);break;case"C":A=parseInt(R[M].slice(1))-1,k[A]||(k[A]={});break;case"R":E=parseInt(R[M].slice(1))-1,F[E]||(F[E]={}),U>0?(F[E].hpt=U,F[E].hpx=Z0(U)):U===0&&(F[E].hidden=!0);break;default:if(_&&_.WTF)throw new Error("SYLK bad record "+C)}z<1&&(ee=null);break;default:if(_&&_.WTF)throw new Error("SYLK bad record "+C)}}return F.length>0&&(he["!rows"]=F),k.length>0&&(he["!cols"]=k),_&&_.sheetRows&&(B=B.slice(0,_.sheetRows)),[B,he]}function o(x,_){var b=i(x,_),E=b[0],A=b[1],O=fd(E,_);return hi(A).forEach(function(M){O[M]=A[M]}),O}function c(x,_){return Ff(o(x,_),_)}function u(x,_,b,E){var A="C;Y"+(b+1)+";X"+(E+1)+";K";switch(x.t){case"n":A+=x.v||0,x.f&&!x.F&&(A+=";E"+Ky(x.f,{r:b,c:E}));break;case"b":A+=x.v?"TRUE":"FALSE";break;case"e":A+=x.w||x.v;break;case"d":A+='"'+(x.w||x.v)+'"';break;case"s":A+='"'+x.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return A}function h(x,_){_.forEach(function(b,E){var A="F;W"+(E+1)+" "+(E+1)+" ";b.hidden?A+="0":(typeof b.width=="number"&&!b.wpx&&(b.wpx=G1(b.width)),typeof b.wpx=="number"&&!b.wch&&(b.wch=W1(b.wpx)),typeof b.wch=="number"&&(A+=Math.round(b.wch))),A.charAt(A.length-1)!=" "&&x.push(A)})}function d(x,_){_.forEach(function(b,E){var A="F;";b.hidden?A+="M0;":b.hpt?A+="M"+20*b.hpt+";":b.hpx&&(A+="M"+20*X1(b.hpx)+";"),A.length>2&&x.push(A+"R"+(E+1))})}function g(x,_){var b=["ID;PWXL;N;E"],E=[],A=rn(x["!ref"]),O,M=Array.isArray(x),B=`\r
`;b.push("P;PGeneral"),b.push("F;P0;DG0G8;M255"),x["!cols"]&&h(b,x["!cols"]),x["!rows"]&&d(b,x["!rows"]),b.push("B;Y"+(A.e.r-A.s.r+1)+";X"+(A.e.c-A.s.c+1)+";D"+[A.s.c,A.s.r,A.e.c,A.e.r].join(" "));for(var Q=A.s.r;Q<=A.e.r;++Q)for(var ee=A.s.c;ee<=A.e.c;++ee){var he=ur({r:Q,c:ee});O=M?(x[Q]||[])[ee]:x[he],!(!O||O.v==null&&(!O.f||O.F))&&E.push(u(O,x,Q,ee))}return b.join(B)+B+E.join(B)+B+"E"+B}return{to_workbook:c,to_sheet:o,from_sheet:g}}(),F6=function(){function t(a,o){switch(o.type){case"base64":return e(so(a),o);case"binary":return e(a,o);case"buffer":return e(Lr&&Buffer.isBuffer(a)?a.toString("binary"):Df(a),o);case"array":return e(Ah(a),o)}throw new Error("Unrecognized type "+o.type)}function e(a,o){for(var c=a.split(`
`),u=-1,h=-1,d=0,g=[];d!==c.length;++d){if(c[d].trim()==="BOT"){g[++u]=[],h=0;continue}if(!(u<0)){var x=c[d].trim().split(","),_=x[0],b=x[1];++d;for(var E=c[d]||"";(E.match(/["]/g)||[]).length&1&&d<c.length-1;)E+=`
`+c[++d];switch(E=E.trim(),+_){case-1:if(E==="BOT"){g[++u]=[],h=0;continue}else if(E!=="EOD")throw new Error("Unrecognized DIF special command "+E);break;case 0:E==="TRUE"?g[u][h]=!0:E==="FALSE"?g[u][h]=!1:isNaN(xl(b))?isNaN(Q0(b).getDate())?g[u][h]=b:g[u][h]=qn(b):g[u][h]=xl(b),++h;break;case 1:E=E.slice(1,E.length-1),E=E.replace(/""/g,'"'),E&&E.match(/^=".*"$/)&&(E=E.slice(2,-1)),g[u][h++]=E!==""?E:null;break}if(E==="EOD")break}}return o&&o.sheetRows&&(g=g.slice(0,o.sheetRows)),g}function r(a,o){return fd(t(a,o),o)}function n(a,o){return Ff(r(a,o),o)}var i=function(){var a=function(u,h,d,g,x){u.push(h),u.push(d+","+g),u.push('"'+x.replace(/"/g,'""')+'"')},o=function(u,h,d,g){u.push(h+","+d),u.push(h==1?'"'+g.replace(/"/g,'""')+'"':g)};return function(u){var h=[],d=rn(u["!ref"]),g,x=Array.isArray(u);a(h,"TABLE",0,1,"sheetjs"),a(h,"VECTORS",0,d.e.r-d.s.r+1,""),a(h,"TUPLES",0,d.e.c-d.s.c+1,""),a(h,"DATA",0,0,"");for(var _=d.s.r;_<=d.e.r;++_){o(h,-1,0,"BOT");for(var b=d.s.c;b<=d.e.c;++b){var E=ur({r:_,c:b});if(g=x?(u[_]||[])[b]:u[E],!g){o(h,1,0,"");continue}switch(g.t){case"n":var A=g.w;!A&&g.v!=null&&(A=g.v),A==null?g.f&&!g.F?o(h,1,0,"="+g.f):o(h,1,0,""):o(h,0,A,"V");break;case"b":o(h,0,g.v?1:0,g.v?"TRUE":"FALSE");break;case"s":o(h,1,0,isNaN(g.v)?g.v:'="'+g.v+'"');break;case"d":g.w||(g.w=Vo(g.z||sr[14],Zi(qn(g.v)))),o(h,0,g.w,"V");break;default:o(h,1,0,"")}}}o(h,-1,0,"EOD");var O=`\r
`,M=h.join(O);return M}}();return{to_workbook:n,to_sheet:r,from_sheet:i}}(),O6=function(){function t(g){return g.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function e(g){return g.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(g,x){for(var _=g.split(`
`),b=-1,E=-1,A=0,O=[];A!==_.length;++A){var M=_[A].trim().split(":");if(M[0]==="cell"){var B=ti(M[1]);if(O.length<=B.r)for(b=O.length;b<=B.r;++b)O[b]||(O[b]=[]);switch(b=B.r,E=B.c,M[2]){case"t":O[b][E]=t(M[3]);break;case"v":O[b][E]=+M[3];break;case"vtf":var Q=M[M.length-1];case"vtc":switch(M[3]){case"nl":O[b][E]=!!+M[4];break;default:O[b][E]=+M[4];break}M[2]=="vtf"&&(O[b][E]=[O[b][E],Q])}}}return x&&x.sheetRows&&(O=O.slice(0,x.sheetRows)),O}function n(g,x){return fd(r(g,x),x)}function i(g,x){return Ff(n(g,x),x)}var a=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),o=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,c=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),u="--SocialCalcSpreadsheetControlSave--";function h(g){if(!g||!g["!ref"])return"";for(var x=[],_=[],b,E="",A=Ds(g["!ref"]),O=Array.isArray(g),M=A.s.r;M<=A.e.r;++M)for(var B=A.s.c;B<=A.e.c;++B)if(E=ur({r:M,c:B}),b=O?(g[M]||[])[B]:g[E],!(!b||b.v==null||b.t==="z")){switch(_=["cell",E,"t"],b.t){case"s":case"str":_.push(e(b.v));break;case"n":b.f?(_[2]="vtf",_[3]="n",_[4]=b.v,_[5]=e(b.f)):(_[2]="v",_[3]=b.v);break;case"b":_[2]="vt"+(b.f?"f":"c"),_[3]="nl",_[4]=b.v?"1":"0",_[5]=e(b.f||(b.v?"TRUE":"FALSE"));break;case"d":var Q=Zi(qn(b.v));_[2]="vtc",_[3]="nd",_[4]=""+Q,_[5]=b.w||Vo(b.z||sr[14],Q);break;case"e":continue}x.push(_.join(":"))}return x.push("sheet:c:"+(A.e.c-A.s.c+1)+":r:"+(A.e.r-A.s.r+1)+":tvf:1"),x.push("valueformat:1:text-wiki"),x.join(`
`)}function d(g){return[a,o,c,o,h(g),u].join(`
`)}return{to_workbook:i,to_sheet:n,from_sheet:d}}(),J0=function(){function t(d,g,x,_,b){b.raw?g[x][_]=d:d===""||(d==="TRUE"?g[x][_]=!0:d==="FALSE"?g[x][_]=!1:isNaN(xl(d))?isNaN(Q0(d).getDate())?g[x][_]=d:g[x][_]=qn(d):g[x][_]=xl(d))}function e(d,g){var x=g||{},_=[];if(!d||d.length===0)return _;for(var b=d.split(/[\r\n]/),E=b.length-1;E>=0&&b[E].length===0;)--E;for(var A=10,O=0,M=0;M<=E;++M)O=b[M].indexOf(" "),O==-1?O=b[M].length:O++,A=Math.max(A,O);for(M=0;M<=E;++M){_[M]=[];var B=0;for(t(b[M].slice(0,A).trim(),_,M,B,x),B=1;B<=(b[M].length-A)/10+1;++B)t(b[M].slice(A+(B-1)*10,A+B*10).trim(),_,M,B,x)}return x.sheetRows&&(_=_.slice(0,x.sheetRows)),_}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function i(d){for(var g={},x=!1,_=0,b=0;_<d.length;++_)(b=d.charCodeAt(_))==34?x=!x:!x&&b in r&&(g[b]=(g[b]||0)+1);b=[];for(_ in g)Object.prototype.hasOwnProperty.call(g,_)&&b.push([g[_],_]);if(!b.length){g=n;for(_ in g)Object.prototype.hasOwnProperty.call(g,_)&&b.push([g[_],_])}return b.sort(function(E,A){return E[0]-A[0]||n[E[1]]-n[A[1]]}),r[b.pop()[1]]||44}function a(d,g){var x=g||{},_="",b=x.dense?[]:{},E={s:{c:0,r:0},e:{c:0,r:0}};d.slice(0,4)=="sep="?d.charCodeAt(5)==13&&d.charCodeAt(6)==10?(_=d.charAt(4),d=d.slice(7)):d.charCodeAt(5)==13||d.charCodeAt(5)==10?(_=d.charAt(4),d=d.slice(6)):_=i(d.slice(0,1024)):x&&x.FS?_=x.FS:_=i(d.slice(0,1024));var A=0,O=0,M=0,B=0,Q=0,ee=_.charCodeAt(0),he=!1,F=0,k=d.charCodeAt(0);d=d.replace(/\r\n/mg,`
`);var S=x.dateNF!=null?eP(x.dateNF):null;function U(){var I=d.slice(B,Q),C={};if(I.charAt(0)=='"'&&I.charAt(I.length-1)=='"'&&(I=I.slice(1,-1).replace(/""/g,'"')),I.length===0)C.t="z";else if(x.raw)C.t="s",C.v=I;else if(I.trim().length===0)C.t="s",C.v=I;else if(I.charCodeAt(0)==61)I.charCodeAt(1)==34&&I.charCodeAt(I.length-1)==34?(C.t="s",C.v=I.slice(2,-1).replace(/""/g,'"')):CU(I)?(C.t="n",C.f=I.slice(1)):(C.t="s",C.v=I);else if(I=="TRUE")C.t="b",C.v=!0;else if(I=="FALSE")C.t="b",C.v=!1;else if(!isNaN(M=xl(I)))C.t="n",x.cellText!==!1&&(C.w=I),C.v=M;else if(!isNaN(Q0(I).getDate())||S&&I.match(S)){C.z=x.dateNF||sr[14];var R=0;S&&I.match(S)&&(I=tP(I,x.dateNF,I.match(S)||[]),R=1),x.cellDates?(C.t="d",C.v=qn(I,R)):(C.t="n",C.v=Zi(qn(I,R))),x.cellText!==!1&&(C.w=Vo(C.z,C.v instanceof Date?Zi(C.v):C.v)),x.cellNF||delete C.z}else C.t="s",C.v=I;if(C.t=="z"||(x.dense?(b[A]||(b[A]=[]),b[A][O]=C):b[ur({c:O,r:A})]=C),B=Q+1,k=d.charCodeAt(B),E.e.c<O&&(E.e.c=O),E.e.r<A&&(E.e.r=A),F==ee)++O;else if(O=0,++A,x.sheetRows&&x.sheetRows<=A)return!0}e:for(;Q<d.length;++Q)switch(F=d.charCodeAt(Q)){case 34:k===34&&(he=!he);break;case ee:case 10:case 13:if(!he&&U())break e;break}return Q-B>0&&U(),b["!ref"]=wr(E),b}function o(d,g){return!(g&&g.PRN)||g.FS||d.slice(0,4)=="sep="||d.indexOf("	")>=0||d.indexOf(",")>=0||d.indexOf(";")>=0?a(d,g):fd(e(d,g),g)}function c(d,g){var x="",_=g.type=="string"?[0,0,0,0]:n5(d,g);switch(g.type){case"base64":x=so(d);break;case"binary":x=d;break;case"buffer":g.codepage==65001?x=d.toString("utf8"):g.codepage&&typeof M1<"u"||(x=Lr&&Buffer.isBuffer(d)?d.toString("binary"):Df(d));break;case"array":x=Ah(d);break;case"string":x=d;break;default:throw new Error("Unrecognized type "+g.type)}return _[0]==239&&_[1]==187&&_[2]==191?x=Cn(x.slice(3)):g.type!="string"&&g.type!="buffer"&&g.codepage==65001?x=Cn(x):g.type=="binary"&&typeof M1<"u",x.slice(0,19)=="socialcalc:version:"?O6.to_sheet(g.type=="string"?x:Cn(x),g):o(x,g)}function u(d,g){return Ff(c(d,g),g)}function h(d){for(var g=[],x=rn(d["!ref"]),_,b=Array.isArray(d),E=x.s.r;E<=x.e.r;++E){for(var A=[],O=x.s.c;O<=x.e.c;++O){var M=ur({r:E,c:O});if(_=b?(d[E]||[])[O]:d[M],!_||_.v==null){A.push("          ");continue}for(var B=(_.w||(cu(_),_.w)||"").slice(0,10);B.length<10;)B+=" ";A.push(B+(O===0?" ":""))}g.push(A.join(""))}return g.join(`
`)}return{to_workbook:u,to_sheet:c,from_sheet:h}}();function mB(t,e){var r=e||{},n=!!r.WTF;r.WTF=!0;try{var i=D6.to_workbook(t,r);return r.WTF=n,i}catch(a){if(r.WTF=n,!a.message.match(/SYLK bad record ID/)&&n)throw a;return J0.to_workbook(t,e)}}var mh=function(){function t(L,j,z){if(L){ka(L,L.l||0);for(var G=z.Enum||X;L.l<L.length;){var ae=L.read_shift(2),Ae=G[ae]||G[65535],_e=L.read_shift(2),Ee=L.l+_e,Ce=Ae.f&&Ae.f(L,_e,z);if(L.l=Ee,j(Ce,Ae,ae))return}}}function e(L,j){switch(j.type){case"base64":return r(eo(so(L)),j);case"binary":return r(eo(L),j);case"buffer":case"array":return r(L,j)}throw"Unsupported type "+j.type}function r(L,j){if(!L)return L;var z=j||{},G=z.dense?[]:{},ae="Sheet1",Ae="",_e=0,Ee={},Ce=[],Oe=[],fe={s:{r:0,c:0},e:{r:0,c:0}},rt=z.sheetRows||0;if(L[2]==0&&(L[3]==8||L[3]==9)&&L.length>=16&&L[14]==5&&L[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(L[2]==2)z.Enum=X,t(L,function(Je,nt,et){switch(et){case 0:z.vers=Je,Je>=4096&&(z.qpro=!0);break;case 6:fe=Je;break;case 204:Je&&(Ae=Je);break;case 222:Ae=Je;break;case 15:case 51:z.qpro||(Je[1].v=Je[1].v.slice(1));case 13:case 14:case 16:et==14&&(Je[2]&112)==112&&(Je[2]&15)>1&&(Je[2]&15)<15&&(Je[1].z=z.dateNF||sr[14],z.cellDates&&(Je[1].t="d",Je[1].v=g2(Je[1].v))),z.qpro&&Je[3]>_e&&(G["!ref"]=wr(fe),Ee[ae]=G,Ce.push(ae),G=z.dense?[]:{},fe={s:{r:0,c:0},e:{r:0,c:0}},_e=Je[3],ae=Ae||"Sheet"+(_e+1),Ae="");var vt=z.dense?(G[Je[0].r]||[])[Je[0].c]:G[ur(Je[0])];if(vt){vt.t=Je[1].t,vt.v=Je[1].v,Je[1].z!=null&&(vt.z=Je[1].z),Je[1].f!=null&&(vt.f=Je[1].f);break}z.dense?(G[Je[0].r]||(G[Je[0].r]=[]),G[Je[0].r][Je[0].c]=Je[1]):G[ur(Je[0])]=Je[1];break}},z);else if(L[2]==26||L[2]==14)z.Enum=xe,L[2]==14&&(z.qpro=!0,L.l=0),t(L,function(Je,nt,et){switch(et){case 204:ae=Je;break;case 22:Je[1].v=Je[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(Je[3]>_e&&(G["!ref"]=wr(fe),Ee[ae]=G,Ce.push(ae),G=z.dense?[]:{},fe={s:{r:0,c:0},e:{r:0,c:0}},_e=Je[3],ae="Sheet"+(_e+1)),rt>0&&Je[0].r>=rt)break;z.dense?(G[Je[0].r]||(G[Je[0].r]=[]),G[Je[0].r][Je[0].c]=Je[1]):G[ur(Je[0])]=Je[1],fe.e.c<Je[0].c&&(fe.e.c=Je[0].c),fe.e.r<Je[0].r&&(fe.e.r=Je[0].r);break;case 27:Je[14e3]&&(Oe[Je[14e3][0]]=Je[14e3][1]);break;case 1537:Oe[Je[0]]=Je[1],Je[0]==_e&&(ae=Je[1]);break}},z);else throw new Error("Unrecognized LOTUS BOF "+L[2]);if(G["!ref"]=wr(fe),Ee[Ae||ae]=G,Ce.push(Ae||ae),!Oe.length)return{SheetNames:Ce,Sheets:Ee};for(var ot={},Pe=[],ge=0;ge<Oe.length;++ge)Ee[Ce[ge]]?(Pe.push(Oe[ge]||Ce[ge]),ot[Oe[ge]]=Ee[Oe[ge]]||Ee[Ce[ge]]):(Pe.push(Oe[ge]),ot[Oe[ge]]={"!ref":"A1"});return{SheetNames:Pe,Sheets:ot}}function n(L,j){var z=j||{};if(+z.codepage>=0&&vl(+z.codepage),z.type=="string")throw new Error("Cannot write WK1 to JS string");var G=Ls(),ae=rn(L["!ref"]),Ae=Array.isArray(L),_e=[];It(G,0,a(1030)),It(G,6,u(ae));for(var Ee=Math.min(ae.e.r,8191),Ce=ae.s.r;Ce<=Ee;++Ce)for(var Oe=Ni(Ce),fe=ae.s.c;fe<=ae.e.c;++fe){Ce===ae.s.r&&(_e[fe]=ei(fe));var rt=_e[fe]+Oe,ot=Ae?(L[Ce]||[])[fe]:L[rt];if(!(!ot||ot.t=="z"))if(ot.t=="n")(ot.v|0)==ot.v&&ot.v>=-32768&&ot.v<=32767?It(G,13,_(Ce,fe,ot.v)):It(G,14,E(Ce,fe,ot.v));else{var Pe=cu(ot);It(G,15,g(Ce,fe,Pe.slice(0,239)))}}return It(G,1),G.end()}function i(L,j){var z=j||{};if(+z.codepage>=0&&vl(+z.codepage),z.type=="string")throw new Error("Cannot write WK3 to JS string");var G=Ls();It(G,0,o(L));for(var ae=0,Ae=0;ae<L.SheetNames.length;++ae)(L.Sheets[L.SheetNames[ae]]||{})["!ref"]&&It(G,27,Z(L.SheetNames[ae],Ae++));var _e=0;for(ae=0;ae<L.SheetNames.length;++ae){var Ee=L.Sheets[L.SheetNames[ae]];if(!(!Ee||!Ee["!ref"])){for(var Ce=rn(Ee["!ref"]),Oe=Array.isArray(Ee),fe=[],rt=Math.min(Ce.e.r,8191),ot=Ce.s.r;ot<=rt;++ot)for(var Pe=Ni(ot),ge=Ce.s.c;ge<=Ce.e.c;++ge){ot===Ce.s.r&&(fe[ge]=ei(ge));var Je=fe[ge]+Pe,nt=Oe?(Ee[ot]||[])[ge]:Ee[Je];if(!(!nt||nt.t=="z"))if(nt.t=="n")It(G,23,U(ot,ge,_e,nt.v));else{var et=cu(nt);It(G,22,F(ot,ge,_e,et.slice(0,239)))}}++_e}}return It(G,1),G.end()}function a(L){var j=it(2);return j.write_shift(2,L),j}function o(L){var j=it(26);j.write_shift(2,4096),j.write_shift(2,4),j.write_shift(4,0);for(var z=0,G=0,ae=0,Ae=0;Ae<L.SheetNames.length;++Ae){var _e=L.SheetNames[Ae],Ee=L.Sheets[_e];if(!(!Ee||!Ee["!ref"])){++ae;var Ce=Ds(Ee["!ref"]);z<Ce.e.r&&(z=Ce.e.r),G<Ce.e.c&&(G=Ce.e.c)}}return z>8191&&(z=8191),j.write_shift(2,z),j.write_shift(1,ae),j.write_shift(1,G),j.write_shift(2,0),j.write_shift(2,0),j.write_shift(1,1),j.write_shift(1,2),j.write_shift(4,0),j.write_shift(4,0),j}function c(L,j,z){var G={s:{c:0,r:0},e:{c:0,r:0}};return j==8&&z.qpro?(G.s.c=L.read_shift(1),L.l++,G.s.r=L.read_shift(2),G.e.c=L.read_shift(1),L.l++,G.e.r=L.read_shift(2),G):(G.s.c=L.read_shift(2),G.s.r=L.read_shift(2),j==12&&z.qpro&&(L.l+=2),G.e.c=L.read_shift(2),G.e.r=L.read_shift(2),j==12&&z.qpro&&(L.l+=2),G.s.c==65535&&(G.s.c=G.e.c=G.s.r=G.e.r=0),G)}function u(L){var j=it(8);return j.write_shift(2,L.s.c),j.write_shift(2,L.s.r),j.write_shift(2,L.e.c),j.write_shift(2,L.e.r),j}function h(L,j,z){var G=[{c:0,r:0},{t:"n",v:0},0,0];return z.qpro&&z.vers!=20768?(G[0].c=L.read_shift(1),G[3]=L.read_shift(1),G[0].r=L.read_shift(2),L.l+=2):(G[2]=L.read_shift(1),G[0].c=L.read_shift(2),G[0].r=L.read_shift(2)),G}function d(L,j,z){var G=L.l+j,ae=h(L,j,z);if(ae[1].t="s",z.vers==20768){L.l++;var Ae=L.read_shift(1);return ae[1].v=L.read_shift(Ae,"utf8"),ae}return z.qpro&&L.l++,ae[1].v=L.read_shift(G-L.l,"cstr"),ae}function g(L,j,z){var G=it(7+z.length);G.write_shift(1,255),G.write_shift(2,j),G.write_shift(2,L),G.write_shift(1,39);for(var ae=0;ae<G.length;++ae){var Ae=z.charCodeAt(ae);G.write_shift(1,Ae>=128?95:Ae)}return G.write_shift(1,0),G}function x(L,j,z){var G=h(L,j,z);return G[1].v=L.read_shift(2,"i"),G}function _(L,j,z){var G=it(7);return G.write_shift(1,255),G.write_shift(2,j),G.write_shift(2,L),G.write_shift(2,z,"i"),G}function b(L,j,z){var G=h(L,j,z);return G[1].v=L.read_shift(8,"f"),G}function E(L,j,z){var G=it(13);return G.write_shift(1,255),G.write_shift(2,j),G.write_shift(2,L),G.write_shift(8,z,"f"),G}function A(L,j,z){var G=L.l+j,ae=h(L,j,z);if(ae[1].v=L.read_shift(8,"f"),z.qpro)L.l=G;else{var Ae=L.read_shift(2);Q(L.slice(L.l,L.l+Ae),ae),L.l+=Ae}return ae}function O(L,j,z){var G=j&32768;return j&=-32769,j=(G?L:0)+(j>=8192?j-16384:j),(G?"":"$")+(z?ei(j):Ni(j))}var M={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},B=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function Q(L,j){ka(L,0);for(var z=[],G=0,ae="",Ae="",_e="",Ee="";L.l<L.length;){var Ce=L[L.l++];switch(Ce){case 0:z.push(L.read_shift(8,"f"));break;case 1:Ae=O(j[0].c,L.read_shift(2),!0),ae=O(j[0].r,L.read_shift(2),!1),z.push(Ae+ae);break;case 2:{var Oe=O(j[0].c,L.read_shift(2),!0),fe=O(j[0].r,L.read_shift(2),!1);Ae=O(j[0].c,L.read_shift(2),!0),ae=O(j[0].r,L.read_shift(2),!1),z.push(Oe+fe+":"+Ae+ae)}break;case 3:if(L.l<L.length){console.error("WK1 premature formula end");return}break;case 4:z.push("("+z.pop()+")");break;case 5:z.push(L.read_shift(2));break;case 6:{for(var rt="";Ce=L[L.l++];)rt+=String.fromCharCode(Ce);z.push('"'+rt.replace(/"/g,'""')+'"')}break;case 8:z.push("-"+z.pop());break;case 23:z.push("+"+z.pop());break;case 22:z.push("NOT("+z.pop()+")");break;case 20:case 21:Ee=z.pop(),_e=z.pop(),z.push(["AND","OR"][Ce-20]+"("+_e+","+Ee+")");break;default:if(Ce<32&&B[Ce])Ee=z.pop(),_e=z.pop(),z.push(_e+B[Ce]+Ee);else if(M[Ce]){if(G=M[Ce][1],G==69&&(G=L[L.l++]),G>z.length){console.error("WK1 bad formula parse 0x"+Ce.toString(16)+":|"+z.join("|")+"|");return}var ot=z.slice(-G);z.length-=G,z.push(M[Ce][0]+"("+ot.join(",")+")")}else return Ce<=7?console.error("WK1 invalid opcode "+Ce.toString(16)):Ce<=24?console.error("WK1 unsupported op "+Ce.toString(16)):Ce<=30?console.error("WK1 invalid opcode "+Ce.toString(16)):Ce<=115?console.error("WK1 unsupported function opcode "+Ce.toString(16)):console.error("WK1 unrecognized opcode "+Ce.toString(16))}}z.length==1?j[1].f=""+z[0]:console.error("WK1 bad formula parse |"+z.join("|")+"|")}function ee(L){var j=[{c:0,r:0},{t:"n",v:0},0];return j[0].r=L.read_shift(2),j[3]=L[L.l++],j[0].c=L[L.l++],j}function he(L,j){var z=ee(L);return z[1].t="s",z[1].v=L.read_shift(j-4,"cstr"),z}function F(L,j,z,G){var ae=it(6+G.length);ae.write_shift(2,L),ae.write_shift(1,z),ae.write_shift(1,j),ae.write_shift(1,39);for(var Ae=0;Ae<G.length;++Ae){var _e=G.charCodeAt(Ae);ae.write_shift(1,_e>=128?95:_e)}return ae.write_shift(1,0),ae}function k(L,j){var z=ee(L);z[1].v=L.read_shift(2);var G=z[1].v>>1;if(z[1].v&1)switch(G&7){case 0:G=(G>>3)*5e3;break;case 1:G=(G>>3)*500;break;case 2:G=(G>>3)/20;break;case 3:G=(G>>3)/200;break;case 4:G=(G>>3)/2e3;break;case 5:G=(G>>3)/2e4;break;case 6:G=(G>>3)/16;break;case 7:G=(G>>3)/64;break}return z[1].v=G,z}function S(L,j){var z=ee(L),G=L.read_shift(4),ae=L.read_shift(4),Ae=L.read_shift(2);if(Ae==65535)return G===0&&ae===3221225472?(z[1].t="e",z[1].v=15):G===0&&ae===3489660928?(z[1].t="e",z[1].v=42):z[1].v=0,z;var _e=Ae&32768;return Ae=(Ae&32767)-16446,z[1].v=(1-_e*2)*(ae*Math.pow(2,Ae+32)+G*Math.pow(2,Ae)),z}function U(L,j,z,G){var ae=it(14);if(ae.write_shift(2,L),ae.write_shift(1,z),ae.write_shift(1,j),G==0)return ae.write_shift(4,0),ae.write_shift(4,0),ae.write_shift(2,65535),ae;var Ae=0,_e=0,Ee=0,Ce=0;return G<0&&(Ae=1,G=-G),_e=Math.log2(G)|0,G/=Math.pow(2,_e-31),Ce=G>>>0,(Ce&2147483648)==0&&(G/=2,++_e,Ce=G>>>0),G-=Ce,Ce|=2147483648,Ce>>>=0,G*=Math.pow(2,32),Ee=G>>>0,ae.write_shift(4,Ee),ae.write_shift(4,Ce),_e+=16383+(Ae?32768:0),ae.write_shift(2,_e),ae}function I(L,j){var z=S(L);return L.l+=j-14,z}function C(L,j){var z=ee(L),G=L.read_shift(4);return z[1].v=G>>6,z}function R(L,j){var z=ee(L),G=L.read_shift(8,"f");return z[1].v=G,z}function se(L,j){var z=R(L);return L.l+=j-10,z}function ne(L,j){return L[L.l+j-1]==0?L.read_shift(j,"cstr"):""}function J(L,j){var z=L[L.l++];z>j-1&&(z=j-1);for(var G="";G.length<z;)G+=String.fromCharCode(L[L.l++]);return G}function de(L,j,z){if(!(!z.qpro||j<21)){var G=L.read_shift(1);L.l+=17,L.l+=1,L.l+=2;var ae=L.read_shift(j-21,"cstr");return[G,ae]}}function oe(L,j){for(var z={},G=L.l+j;L.l<G;){var ae=L.read_shift(2);if(ae==14e3){for(z[ae]=[0,""],z[ae][0]=L.read_shift(2);L[L.l];)z[ae][1]+=String.fromCharCode(L[L.l]),L.l++;L.l++}}return z}function Z(L,j){var z=it(5+L.length);z.write_shift(2,14e3),z.write_shift(2,j);for(var G=0;G<L.length;++G){var ae=L.charCodeAt(G);z[z.l++]=ae>127?95:ae}return z[z.l++]=0,z}var X={0:{n:"BOF",f:Ui},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:c},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:x},14:{n:"NUMBER",f:b},15:{n:"LABEL",f:d},16:{n:"FORMULA",f:A},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:d},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:ne},222:{n:"SHEETNAMELP",f:J},65535:{n:""}},xe={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:he},23:{n:"NUMBER17",f:S},24:{n:"NUMBER18",f:k},25:{n:"FORMULA19",f:I},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:oe},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:C},38:{n:"??"},39:{n:"NUMBER27",f:R},40:{n:"FORMULA28",f:se},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:ne},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:de},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:i,to_workbook:e}}();function gB(t){var e={},r=t.match(as),n=0,i=!1;if(r)for(;n!=r.length;++n){var a=pr(r[n]);switch(a[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!a.val)break;case"<shadow>":case"<shadow/>":e.shadow=1;break;case"</shadow>":break;case"<charset":if(a.val=="1")break;e.cp=yy[parseInt(a.val,10)];break;case"<outline":if(!a.val)break;case"<outline>":case"<outline/>":e.outline=1;break;case"</outline>":break;case"<rFont":e.name=a.val;break;case"<sz":e.sz=a.val;break;case"<strike":if(!a.val)break;case"<strike>":case"<strike/>":e.strike=1;break;case"</strike>":break;case"<u":if(!a.val)break;switch(a.val){case"double":e.uval="double";break;case"singleAccounting":e.uval="single-accounting";break;case"doubleAccounting":e.uval="double-accounting";break}case"<u>":case"<u/>":e.u=1;break;case"</u>":break;case"<b":if(a.val=="0")break;case"<b>":case"<b/>":e.b=1;break;case"</b>":break;case"<i":if(a.val=="0")break;case"<i>":case"<i/>":e.i=1;break;case"</i>":break;case"<color":a.rgb&&(e.color=a.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":e.family=a.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":e.valign=a.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(a[0].charCodeAt(1)!==47&&!i)throw new Error("Unrecognized rich format "+a[0])}}return e}var vB=function(){var t=U1("t"),e=U1("rPr");function r(a){var o=a.match(t);if(!o)return{t:"s",v:""};var c={t:"s",v:tn(o[1])},u=a.match(e);return u&&(c.s=gB(u[1])),c}var n=/<(?:\w+:)?r>/g,i=/<\/(?:\w+:)?r>/;return function(o){return o.replace(n,"").split(i).map(r).filter(function(c){return c.v})}}(),_B=function(){var e=/(\r\n|\n)/g;function r(i,a,o){var c=[];i.u&&c.push("text-decoration: underline;"),i.uval&&c.push("text-underline-style:"+i.uval+";"),i.sz&&c.push("font-size:"+i.sz+"pt;"),i.outline&&c.push("text-effect: outline;"),i.shadow&&c.push("text-shadow: auto;"),a.push('<span style="'+c.join("")+'">'),i.b&&(a.push("<b>"),o.push("</b>")),i.i&&(a.push("<i>"),o.push("</i>")),i.strike&&(a.push("<s>"),o.push("</s>"));var u=i.valign||"";return u=="superscript"||u=="super"?u="sup":u=="subscript"&&(u="sub"),u!=""&&(a.push("<"+u+">"),o.push("</"+u+">")),o.push("</span>"),i}function n(i){var a=[[],i.v,[]];return i.v?(i.s&&r(i.s,a[0],a[2]),a[0].join("")+a[1].replace(e,"<br/>")+a[2].join("")):""}return function(a){return a.map(n).join("")}}(),xB=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,yB=/<(?:\w+:)?r>/,wB=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function Hy(t,e){var r=e?e.cellHTML:!0,n={};return t?(t.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=tn(Cn(t.slice(t.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=Cn(t),r&&(n.h=Iy(n.t))):t.match(yB)&&(n.r=Cn(t),n.t=tn(Cn((t.replace(wB,"").match(xB)||[]).join("").replace(as,""))),r&&(n.h=_B(vB(n.r)))),n):{t:""}}var EB=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,bB=/<(?:\w+:)?(?:si|sstItem)>/g,SB=/<\/(?:\w+:)?(?:si|sstItem)>/;function AB(t,e){var r=[],n="";if(!t)return r;var i=t.match(EB);if(i){n=i[2].replace(bB,"").split(SB);for(var a=0;a!=n.length;++a){var o=Hy(n[a].trim(),e);o!=null&&(r[r.length]=o)}i=pr(i[1]),r.Count=i.count,r.Unique=i.uniqueCount}return r}var TB=/^\s|\s$|[\t\n\r]/;function P6(t,e){if(!e.bookSST)return"";var r=[Ci];r[r.length]=Ct("sst",null,{xmlns:Oh[0],count:t.Count,uniqueCount:t.Unique});for(var n=0;n!=t.length;++n)if(t[n]!=null){var i=t[n],a="<si>";i.r?a+=i.r:(a+="<t",i.t||(i.t=""),i.t.match(TB)&&(a+=' xml:space="preserve"'),a+=">"+bn(i.t)+"</t>"),a+="</si>",r[r.length]=a}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function kB(t){return[t.read_shift(4),t.read_shift(4)]}function NB(t,e){var r=[],n=!1;return hu(t,function(a,o,c){switch(c){case 159:r.Count=a[0],r.Unique=a[1];break;case 19:r.push(a);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(o.T,!n||e.WTF)throw new Error("Unexpected record 0x"+c.toString(16))}}),r}function CB(t,e){return e||(e=it(8)),e.write_shift(4,t.Count),e.write_shift(4,t.Unique),e}var IB=UP;function RB(t){var e=Ls();xt(e,159,CB(t));for(var r=0;r<t.length;++r)xt(e,19,IB(t[r]));return xt(e,160),e.end()}function M6(t){for(var e=[],r=t.split(""),n=0;n<r.length;++n)e[n]=r[n].charCodeAt(0);return e}function iu(t,e){var r={};return r.Major=t.read_shift(2),r.Minor=t.read_shift(2),e>=4&&(t.l+=e-4),r}function LB(t){var e={};return e.id=t.read_shift(0,"lpp4"),e.R=iu(t,4),e.U=iu(t,4),e.W=iu(t,4),e}function DB(t){for(var e=t.read_shift(4),r=t.l+e-4,n={},i=t.read_shift(4),a=[];i-- >0;)a.push({t:t.read_shift(4),v:t.read_shift(0,"lpp4")});if(n.name=t.read_shift(0,"lpp4"),n.comps=a,t.l!=r)throw new Error("Bad DataSpaceMapEntry: "+t.l+" != "+r);return n}function FB(t){var e=[];t.l+=4;for(var r=t.read_shift(4);r-- >0;)e.push(DB(t));return e}function OB(t){var e=[];t.l+=4;for(var r=t.read_shift(4);r-- >0;)e.push(t.read_shift(0,"lpp4"));return e}function PB(t){var e={};return t.read_shift(4),t.l+=4,e.id=t.read_shift(0,"lpp4"),e.name=t.read_shift(0,"lpp4"),e.R=iu(t,4),e.U=iu(t,4),e.W=iu(t,4),e}function MB(t){var e=PB(t);if(e.ename=t.read_shift(0,"8lpp4"),e.blksz=t.read_shift(4),e.cmode=t.read_shift(4),t.read_shift(4)!=4)throw new Error("Bad !Primary record");return e}function B6(t,e){var r=t.l+e,n={};n.Flags=t.read_shift(4)&63,t.l+=4,n.AlgID=t.read_shift(4);var i=!1;switch(n.AlgID){case 26126:case 26127:case 26128:i=n.Flags==36;break;case 26625:i=n.Flags==4;break;case 0:i=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!i)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=t.read_shift(4),n.KeySize=t.read_shift(4),n.ProviderType=t.read_shift(4),t.l+=8,n.CSPName=t.read_shift(r-t.l>>1,"utf16le"),t.l=r,n}function j6(t,e){var r={},n=t.l+e;return t.l+=4,r.Salt=t.slice(t.l,t.l+16),t.l+=16,r.Verifier=t.slice(t.l,t.l+16),t.l+=16,t.read_shift(4),r.VerifierHash=t.slice(t.l,n),t.l=n,r}function BB(t){var e=iu(t);switch(e.Minor){case 2:return[e.Minor,jB(t)];case 3:return[e.Minor,UB()];case 4:return[e.Minor,VB(t)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+e.Minor)}function jB(t){var e=t.read_shift(4);if((e&63)!=36)throw new Error("EncryptionInfo mismatch");var r=t.read_shift(4),n=B6(t,r),i=j6(t,t.length-t.l);return{t:"Std",h:n,v:i}}function UB(){throw new Error("File is password-protected: ECMA-376 Extensible")}function VB(t){var e=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];t.l+=4;var r=t.read_shift(t.length-t.l,"utf8"),n={};return r.replace(as,function(a){var o=pr(a);switch(vc(o[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":e.forEach(function(c){n[c]=o[c]});break;case"<dataIntegrity":n.encryptedHmacKey=o.encryptedHmacKey,n.encryptedHmacValue=o.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=o.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(o);break;default:throw o[0]}}),n}function qB(t,e){var r={},n=r.EncryptionVersionInfo=iu(t,4);if(e-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);r.Flags=t.read_shift(4),e-=4;var i=t.read_shift(4);return e-=4,r.EncryptionHeader=B6(t,i),e-=i,r.EncryptionVerifier=j6(t,e),r}function zB(t){var e={},r=e.EncryptionVersionInfo=iu(t,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return e.Salt=t.read_shift(16),e.EncryptedVerifier=t.read_shift(16),e.EncryptedVerifierHash=t.read_shift(16),e}function Gy(t){var e=0,r,n=M6(t),i=n.length+1,a,o,c,u,h;for(r=wf(i),r[0]=n.length,a=1;a!=i;++a)r[a]=n[a-1];for(a=i-1;a>=0;--a)o=r[a],c=(e&16384)===0?0:1,u=e<<1&32767,h=c|u,e=h^o;return e^52811}var U6=function(){var t=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],e=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(o){return(o/2|o*128)&255},i=function(o,c){return n(o^c)},a=function(o){for(var c=e[o.length-1],u=104,h=o.length-1;h>=0;--h)for(var d=o[h],g=0;g!=7;++g)d&64&&(c^=r[u]),d*=2,--u;return c};return function(o){for(var c=M6(o),u=a(c),h=c.length,d=wf(16),g=0;g!=16;++g)d[g]=0;var x,_,b;for((h&1)===1&&(x=u>>8,d[h]=i(t[0],x),--h,x=u&255,_=c[c.length-1],d[h]=i(_,x));h>0;)--h,x=u>>8,d[h]=i(c[h],x),--h,x=u&255,d[h]=i(c[h],x);for(h=15,b=15-c.length;b>0;)x=u>>8,d[h]=i(t[b],x),--h,--b,x=u&255,d[h]=i(c[h],x),--h,--b;return d}}(),HB=function(t,e,r,n,i){i||(i=e),n||(n=U6(t));var a,o;for(a=0;a!=e.length;++a)o=e[a],o^=n[r],o=(o>>5|o<<3)&255,i[a]=o,++r;return[i,r,n]},GB=function(t){var e=0,r=U6(t);return function(n){var i=HB("",n,e,r);return e=i[1],i[0]}};function WB(t,e,r,n){var i={key:Ui(t),verificationBytes:Ui(t)};return r.password&&(i.verifier=Gy(r.password)),n.valid=i.verificationBytes===i.verifier,n.valid&&(n.insitu=GB(r.password)),i}function XB(t,e,r){var n=r||{};return n.Info=t.read_shift(2),t.l-=2,n.Info===1?n.Data=zB(t):n.Data=qB(t,e),n}function YB(t,e,r){var n={Type:r.biff>=8?t.read_shift(2):0};return n.Type?XB(t,e-2,n):WB(t,r.biff>=8?e:e-2,r,n),n}var V6=function(){function t(i,a){switch(a.type){case"base64":return e(so(i),a);case"binary":return e(i,a);case"buffer":return e(Lr&&Buffer.isBuffer(i)?i.toString("binary"):Df(i),a);case"array":return e(Ah(i),a)}throw new Error("Unrecognized type "+a.type)}function e(i,a){var o=a||{},c=o.dense?[]:{},u=i.match(/\\trowd.*?\\row\b/g);if(!u.length)throw new Error("RTF missing table");var h={s:{c:0,r:0},e:{c:0,r:u.length-1}};return u.forEach(function(d,g){Array.isArray(c)&&(c[g]=[]);for(var x=/\\\w+\b/g,_=0,b,E=-1;b=x.exec(d);){switch(b[0]){case"\\cell":var A=d.slice(_,x.lastIndex-b[0].length);if(A[0]==" "&&(A=A.slice(1)),++E,A.length){var O={v:A,t:"s"};Array.isArray(c)?c[g][E]=O:c[ur({r:g,c:E})]=O}break}_=x.lastIndex}E>h.e.c&&(h.e.c=E)}),c["!ref"]=wr(h),c}function r(i,a){return Ff(t(i,a),a)}function n(i){for(var a=["{\\rtf1\\ansi"],o=rn(i["!ref"]),c,u=Array.isArray(i),h=o.s.r;h<=o.e.r;++h){a.push("\\trowd\\trautofit1");for(var d=o.s.c;d<=o.e.c;++d)a.push("\\cellx"+(d+1));for(a.push("\\pard\\intbl"),d=o.s.c;d<=o.e.c;++d){var g=ur({r:h,c:d});c=u?(i[h]||[])[d]:i[g],!(!c||c.v==null&&(!c.f||c.F))&&(a.push(" "+(c.w||(cu(c),c.w))),a.push("\\cell"))}a.push("\\pard\\intbl\\row")}return a.join("")+"}"}return{to_workbook:r,to_sheet:t,from_sheet:n}}();function KB(t){var e=t.slice(t[0]==="#"?1:0).slice(0,6);return[parseInt(e.slice(0,2),16),parseInt(e.slice(2,4),16),parseInt(e.slice(4,6),16)]}function H1(t){for(var e=0,r=1;e!=3;++e)r=r*256+(t[e]>255?255:t[e]<0?0:t[e]);return r.toString(16).toUpperCase().slice(1)}function $B(t){var e=t[0]/255,r=t[1]/255,n=t[2]/255,i=Math.max(e,r,n),a=Math.min(e,r,n),o=i-a;if(o===0)return[0,0,e];var c=0,u=0,h=i+a;switch(u=o/(h>1?2-h:h),i){case e:c=((r-n)/o+6)%6;break;case r:c=(n-e)/o+2;break;case n:c=(e-r)/o+4;break}return[c/6,u,h/2]}function QB(t){var e=t[0],r=t[1],n=t[2],i=r*2*(n<.5?n:1-n),a=n-i/2,o=[a,a,a],c=6*e,u;if(r!==0)switch(c|0){case 0:case 6:u=i*c,o[0]+=i,o[1]+=u;break;case 1:u=i*(2-c),o[0]+=u,o[1]+=i;break;case 2:u=i*(c-2),o[1]+=i,o[2]+=u;break;case 3:u=i*(4-c),o[1]+=u,o[2]+=i;break;case 4:u=i*(c-4),o[2]+=i,o[0]+=u;break;case 5:u=i*(6-c),o[2]+=u,o[0]+=i;break}for(var h=0;h!=3;++h)o[h]=Math.round(o[h]*255);return o}function Mg(t,e){if(e===0)return t;var r=$B(KB(t));return e<0?r[2]=r[2]*(1+e):r[2]=1-(1-r[2])*(1-e),H1(QB(r))}var q6=6,JB=15,ZB=1,Za=q6;function G1(t){return Math.floor((t+Math.round(128/Za)/256)*Za)}function W1(t){return Math.floor((t-5)/Za*100+.5)/100}function Bg(t){return Math.round((t*Za+5)/Za*256)/256}function Zv(t){return Bg(W1(G1(t)))}function Wy(t){var e=Math.abs(t-Zv(t)),r=Za;if(e>.005)for(Za=ZB;Za<JB;++Za)Math.abs(t-Zv(t))<=e&&(e=Math.abs(t-Zv(t)),r=Za);Za=r}function Ef(t){t.width?(t.wpx=G1(t.width),t.wch=W1(t.wpx),t.MDW=Za):t.wpx?(t.wch=W1(t.wpx),t.width=Bg(t.wch),t.MDW=Za):typeof t.wch=="number"&&(t.width=Bg(t.wch),t.wpx=G1(t.width),t.MDW=Za),t.customWidth&&delete t.customWidth}var ej=96,z6=ej;function X1(t){return t*96/z6}function Z0(t){return t*z6/96}var tj={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function rj(t,e,r,n){e.Borders=[];var i={},a=!1;(t[0].match(as)||[]).forEach(function(o){var c=pr(o);switch(vc(c[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":i={},c.diagonalUp&&(i.diagonalUp=jn(c.diagonalUp)),c.diagonalDown&&(i.diagonalDown=jn(c.diagonalDown)),e.Borders.push(i);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(n&&n.WTF&&!a)throw new Error("unrecognized "+c[0]+" in borders")}})}function nj(t,e,r,n){e.Fills=[];var i={},a=!1;(t[0].match(as)||[]).forEach(function(o){var c=pr(o);switch(vc(c[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":i={},e.Fills.push(i);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":e.Fills.push(i),i={};break;case"<patternFill":case"<patternFill>":c.patternType&&(i.patternType=c.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":i.bgColor||(i.bgColor={}),c.indexed&&(i.bgColor.indexed=parseInt(c.indexed,10)),c.theme&&(i.bgColor.theme=parseInt(c.theme,10)),c.tint&&(i.bgColor.tint=parseFloat(c.tint)),c.rgb&&(i.bgColor.rgb=c.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":i.fgColor||(i.fgColor={}),c.theme&&(i.fgColor.theme=parseInt(c.theme,10)),c.tint&&(i.fgColor.tint=parseFloat(c.tint)),c.rgb!=null&&(i.fgColor.rgb=c.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(n&&n.WTF&&!a)throw new Error("unrecognized "+c[0]+" in fills")}})}function ij(t,e,r,n){e.Fonts=[];var i={},a=!1;(t[0].match(as)||[]).forEach(function(o){var c=pr(o);switch(vc(c[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":e.Fonts.push(i),i={};break;case"<name":c.val&&(i.name=Cn(c.val));break;case"<name/>":case"</name>":break;case"<b":i.bold=c.val?jn(c.val):1;break;case"<b/>":i.bold=1;break;case"<i":i.italic=c.val?jn(c.val):1;break;case"<i/>":i.italic=1;break;case"<u":switch(c.val){case"none":i.underline=0;break;case"single":i.underline=1;break;case"double":i.underline=2;break;case"singleAccounting":i.underline=33;break;case"doubleAccounting":i.underline=34;break}break;case"<u/>":i.underline=1;break;case"<strike":i.strike=c.val?jn(c.val):1;break;case"<strike/>":i.strike=1;break;case"<outline":i.outline=c.val?jn(c.val):1;break;case"<outline/>":i.outline=1;break;case"<shadow":i.shadow=c.val?jn(c.val):1;break;case"<shadow/>":i.shadow=1;break;case"<condense":i.condense=c.val?jn(c.val):1;break;case"<condense/>":i.condense=1;break;case"<extend":i.extend=c.val?jn(c.val):1;break;case"<extend/>":i.extend=1;break;case"<sz":c.val&&(i.sz=+c.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":c.val&&(i.vertAlign=c.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":c.val&&(i.family=parseInt(c.val,10));break;case"<family/>":case"</family>":break;case"<scheme":c.val&&(i.scheme=c.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(c.val=="1")break;c.codepage=yy[parseInt(c.val,10)];break;case"<color":if(i.color||(i.color={}),c.auto&&(i.color.auto=jn(c.auto)),c.rgb)i.color.rgb=c.rgb.slice(-6);else if(c.indexed){i.color.index=parseInt(c.indexed,10);var u=dh[i.color.index];i.color.index==81&&(u=dh[1]),u||(u=dh[1]),i.color.rgb=u[0].toString(16)+u[1].toString(16)+u[2].toString(16)}else c.theme&&(i.color.theme=parseInt(c.theme,10),c.tint&&(i.color.tint=parseFloat(c.tint)),c.theme&&r.themeElements&&r.themeElements.clrScheme&&(i.color.rgb=Mg(r.themeElements.clrScheme[i.color.theme].rgb,i.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":a=!0;break;case"</AlternateContent>":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(n&&n.WTF&&!a)throw new Error("unrecognized "+c[0]+" in fonts")}})}function aj(t,e,r){e.NumberFmt=[];for(var n=hi(sr),i=0;i<n.length;++i)e.NumberFmt[n[i]]=sr[n[i]];var a=t[0].match(as);if(a)for(i=0;i<a.length;++i){var o=pr(a[i]);switch(vc(o[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var c=tn(Cn(o.formatCode)),u=parseInt(o.numFmtId,10);if(e.NumberFmt[u]=c,u>0){if(u>392){for(u=392;u>60&&e.NumberFmt[u]!=null;--u);e.NumberFmt[u]=c}nu(c,u)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+o[0]+" in numFmts")}}}function sj(t){var e=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var n=r[0];n<=r[1];++n)t[n]!=null&&(e[e.length]=Ct("numFmt",null,{numFmtId:n,formatCode:bn(t[n])}))}),e.length===1?"":(e[e.length]="</numFmts>",e[0]=Ct("numFmts",null,{count:e.length-2}).replace("/>",">"),e.join(""))}var Rm=["numFmtId","fillId","fontId","borderId","xfId"],Lm=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function oj(t,e,r){e.CellXf=[];var n,i=!1;(t[0].match(as)||[]).forEach(function(a){var o=pr(a),c=0;switch(vc(o[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=o,delete n[0],c=0;c<Rm.length;++c)n[Rm[c]]&&(n[Rm[c]]=parseInt(n[Rm[c]],10));for(c=0;c<Lm.length;++c)n[Lm[c]]&&(n[Lm[c]]=jn(n[Lm[c]]));if(e.NumberFmt&&n.numFmtId>392){for(c=392;c>60;--c)if(e.NumberFmt[n.numFmtId]==e.NumberFmt[c]){n.numFmtId=c;break}}e.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var u={};o.vertical&&(u.vertical=o.vertical),o.horizontal&&(u.horizontal=o.horizontal),o.textRotation!=null&&(u.textRotation=o.textRotation),o.indent&&(u.indent=o.indent),o.wrapText&&(u.wrapText=jn(o.wrapText)),n.alignment=u;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":i=!0;break;case"</AlternateContent>":i=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(r&&r.WTF&&!i)throw new Error("unrecognized "+o[0]+" in cellXfs")}})}function lj(t){var e=[];return e[e.length]=Ct("cellXfs",null),t.forEach(function(r){e[e.length]=Ct("xf",null,r)}),e[e.length]="</cellXfs>",e.length===2?"":(e[0]=Ct("cellXfs",null,{count:e.length-2}).replace("/>",">"),e.join(""))}var cj=function(){var e=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,i=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,a=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(c,u,h){var d={};if(!c)return d;c=c.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var g;return(g=c.match(e))&&aj(g,d,h),(g=c.match(i))&&ij(g,d,u,h),(g=c.match(n))&&nj(g,d,u,h),(g=c.match(a))&&rj(g,d,u,h),(g=c.match(r))&&oj(g,d,h),d}}();function H6(t,e){var r=[Ci,Ct("styleSheet",null,{xmlns:Oh[0],"xmlns:vt":Qi.vt})],n;return t.SSF&&(n=sj(t.SSF))!=null&&(r[r.length]=n),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(n=lj(e.cellXfs))&&(r[r.length]=n),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function uj(t,e){var r=t.read_shift(2),n=rs(t);return[r,n]}function fj(t,e,r){r||(r=it(6+4*e.length)),r.write_shift(2,t),pa(e,r);var n=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),n}function hj(t,e,r){var n={};n.sz=t.read_shift(2)/20;var i=XP(t);i.fItalic&&(n.italic=1),i.fCondense&&(n.condense=1),i.fExtend&&(n.extend=1),i.fShadow&&(n.shadow=1),i.fOutline&&(n.outline=1),i.fStrikeout&&(n.strike=1);var a=t.read_shift(2);switch(a===700&&(n.bold=1),t.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var o=t.read_shift(1);o!=0&&(n.underline=o);var c=t.read_shift(1);c>0&&(n.family=c);var u=t.read_shift(1);switch(u>0&&(n.charset=u),t.l++,n.color=WP(t),t.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=rs(t),n}function dj(t,e){e||(e=it(25+4*32)),e.write_shift(2,t.sz*20),YP(t,e),e.write_shift(2,t.bold?700:400);var r=0;t.vertAlign=="superscript"?r=1:t.vertAlign=="subscript"&&(r=2),e.write_shift(2,r),e.write_shift(1,t.underline||0),e.write_shift(1,t.family||0),e.write_shift(1,t.charset||0),e.write_shift(1,0),Fg(t.color,e);var n=0;return n=2,e.write_shift(1,n),pa(t.name,e),e.length>e.l?e.slice(0,e.l):e}var pj=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],e_,mj=is;function G3(t,e){e||(e=it(4*3+8*7+16*1)),e_||(e_=p2(pj));var r=e_[t.patternType];r==null&&(r=40),e.write_shift(4,r);var n=0;if(r!=40)for(Fg({auto:1},e),Fg({auto:1},e);n<12;++n)e.write_shift(4,0);else{for(;n<4;++n)e.write_shift(4,0);for(;n<12;++n)e.write_shift(4,0)}return e.length>e.l?e.slice(0,e.l):e}function gj(t,e){var r=t.l+e,n=t.read_shift(2),i=t.read_shift(2);return t.l=r,{ixfe:n,numFmtId:i}}function G6(t,e,r){r||(r=it(16)),r.write_shift(2,e||0),r.write_shift(2,t.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var n=0;return r.write_shift(1,n),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function Zd(t,e){return e||(e=it(10)),e.write_shift(1,0),e.write_shift(1,0),e.write_shift(4,0),e.write_shift(4,0),e}var vj=is;function _j(t,e){return e||(e=it(51)),e.write_shift(1,0),Zd(null,e),Zd(null,e),Zd(null,e),Zd(null,e),Zd(null,e),e.length>e.l?e.slice(0,e.l):e}function xj(t,e){return e||(e=it(12+4*10)),e.write_shift(4,t.xfId),e.write_shift(2,1),e.write_shift(1,0),e.write_shift(1,0),Dg(t.name||"",e),e.length>e.l?e.slice(0,e.l):e}function yj(t,e,r){var n=it(2052);return n.write_shift(4,t),Dg(e,n),Dg(r,n),n.length>n.l?n.slice(0,n.l):n}function wj(t,e,r){var n={};n.NumberFmt=[];for(var i in sr)n.NumberFmt[i]=sr[i];n.CellXf=[],n.Fonts=[];var a=[],o=!1;return hu(t,function(u,h,d){switch(d){case 44:n.NumberFmt[u[0]]=u[1],nu(u[1],u[0]);break;case 43:n.Fonts.push(u),u.color.theme!=null&&e&&e.themeElements&&e.themeElements.clrScheme&&(u.color.rgb=Mg(e.themeElements.clrScheme[u.color.theme].rgb,u.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:a[a.length-1]==617&&n.CellXf.push(u);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:a.push(d),o=!0;break;case 38:a.pop(),o=!1;break;default:if(h.T>0)a.push(d);else if(h.T<0)a.pop();else if(!o||r.WTF&&a[a.length-1]!=37)throw new Error("Unexpected record 0x"+d.toString(16))}}),n}function Ej(t,e){if(e){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)e[i]!=null&&++r}),r!=0&&(xt(t,615,yl(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)e[i]!=null&&xt(t,44,fj(i,e[i]))}),xt(t,616))}}function bj(t){var e=1;xt(t,611,yl(e)),xt(t,43,dj({sz:12,color:{theme:1},name:"Calibri",family:2})),xt(t,612)}function Sj(t){var e=2;xt(t,603,yl(e)),xt(t,45,G3({patternType:"none"})),xt(t,45,G3({patternType:"gray125"})),xt(t,604)}function Aj(t){var e=1;xt(t,613,yl(e)),xt(t,46,_j()),xt(t,614)}function Tj(t){var e=1;xt(t,626,yl(e)),xt(t,47,G6({numFmtId:0},65535)),xt(t,627)}function kj(t,e){xt(t,617,yl(e.length)),e.forEach(function(r){xt(t,47,G6(r,0))}),xt(t,618)}function Nj(t){var e=1;xt(t,619,yl(e)),xt(t,48,xj({xfId:0,name:"Normal"})),xt(t,620)}function Cj(t){var e=0;xt(t,505,yl(e)),xt(t,506)}function Ij(t){var e=0;xt(t,508,yj(e,"TableStyleMedium9","PivotStyleMedium4")),xt(t,509)}function Rj(t,e){var r=Ls();return xt(r,278),Ej(r,t.SSF),bj(r),Sj(r),Aj(r),Tj(r),kj(r,e.cellXfs),Nj(r),Cj(r),Ij(r),xt(r,279),r.end()}var Lj=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function Dj(t,e,r){e.themeElements.clrScheme=[];var n={};(t[0].match(as)||[]).forEach(function(i){var a=pr(i);switch(a[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=a.val;break;case"<a:sysClr":n.rgb=a.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":a[0].charAt(1)==="/"?(e.themeElements.clrScheme[Lj.indexOf(a[0])]=n,n={}):n.name=a[0].slice(3,a[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+a[0]+" in clrScheme")}})}function Fj(){}function Oj(){}var Pj=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,Mj=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,Bj=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function jj(t,e,r){e.themeElements={};var n;[["clrScheme",Pj,Dj],["fontScheme",Mj,Fj],["fmtScheme",Bj,Oj]].forEach(function(i){if(!(n=t.match(i[1])))throw new Error(i[0]+" not found in themeElements");i[2](n,e,r)})}var Uj=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function W6(t,e){(!t||t.length===0)&&(t=Xy());var r,n={};if(!(r=t.match(Uj)))throw new Error("themeElements not found in theme");return jj(r[0],n,e),n.raw=t,n}function Xy(t,e){if(e&&e.themeXLSX)return e.themeXLSX;if(t&&typeof t.raw=="string")return t.raw;var r=[Ci];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function Vj(t,e,r){var n=t.l+e,i=t.read_shift(4);if(i!==124226){if(!r.cellStyles){t.l=n;return}var a=t.slice(t.l);t.l=n;var o;try{o=BT(a,{type:"array"})}catch{return}var c=to(o,"theme/theme/theme1.xml",!0);if(c)return W6(c,r)}}function qj(t){return t.read_shift(4)}function zj(t){var e={};switch(e.xclrType=t.read_shift(2),e.nTintShade=t.read_shift(2),e.xclrType){case 0:t.l+=4;break;case 1:e.xclrValue=Hj(t,4);break;case 2:e.xclrValue=A6(t);break;case 3:e.xclrValue=qj(t);break;case 4:t.l+=4;break}return t.l+=8,e}function Hj(t,e){return is(t,e)}function Gj(t,e){return is(t,e)}function Wj(t){var e=t.read_shift(2),r=t.read_shift(2)-4,n=[e];switch(e){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=zj(t);break;case 6:n[1]=Gj(t,r);break;case 14:case 15:n[1]=t.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+e+" "+r)}return n}function Xj(t,e){var r=t.l+e;t.l+=2;var n=t.read_shift(2);t.l+=2;for(var i=t.read_shift(2),a=[];i-- >0;)a.push(Wj(t,r-t.l));return{ixfe:n,ext:a}}function Yj(t,e){e.forEach(function(r){r[0]})}function Kj(t,e){return{flags:t.read_shift(4),version:t.read_shift(4),name:rs(t)}}function $j(t){var e=it(12+2*t.name.length);return e.write_shift(4,t.flags),e.write_shift(4,t.version),pa(t.name,e),e.slice(0,e.l)}function Qj(t){for(var e=[],r=t.read_shift(4);r-- >0;)e.push([t.read_shift(4),t.read_shift(4)]);return e}function Jj(t){var e=it(4+8*t.length);e.write_shift(4,t.length);for(var r=0;r<t.length;++r)e.write_shift(4,t[r][0]),e.write_shift(4,t[r][1]);return e}function Zj(t,e){var r=it(8+2*e.length);return r.write_shift(4,t),pa(e,r),r.slice(0,r.l)}function eU(t){return t.l+=4,t.read_shift(4)!=0}function tU(t,e){var r=it(8);return r.write_shift(4,t),r.write_shift(4,1),r}function rU(t,e,r){var n={Types:[],Cell:[],Value:[]},i=r||{},a=[],o=!1,c=2;return hu(t,function(u,h,d){switch(d){case 335:n.Types.push({name:u.name});break;case 51:u.forEach(function(g){c==1?n.Cell.push({type:n.Types[g[0]-1].name,index:g[1]}):c==0&&n.Value.push({type:n.Types[g[0]-1].name,index:g[1]})});break;case 337:c=u?1:0;break;case 338:c=2;break;case 35:a.push(d),o=!0;break;case 36:a.pop(),o=!1;break;default:if(!h.T){if(!o||i.WTF&&a[a.length-1]!=35)throw new Error("Unexpected record 0x"+d.toString(16))}}}),n}function nU(){var t=Ls();return xt(t,332),xt(t,334,yl(1)),xt(t,335,$j({name:"XLDAPR",version:12e4,flags:3496657072})),xt(t,336),xt(t,339,Zj(1,"XLDAPR")),xt(t,52),xt(t,35,yl(514)),xt(t,4096,yl(0)),xt(t,4097,Po(1)),xt(t,36),xt(t,53),xt(t,340),xt(t,337,tU(1)),xt(t,51,Jj([[1,0]])),xt(t,338),xt(t,333),t.end()}function iU(t,e,r){var n={Types:[],Cell:[],Value:[]};if(!t)return n;var i=!1,a=2,o;return t.replace(as,function(c){var u=pr(c);switch(vc(u[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:u.name});break;case"</metadataType>":break;case"<futureMetadata":for(var h=0;h<n.Types.length;++h)n.Types[h].name==u.name&&(o=n.Types[h]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":a==1?n.Cell.push({type:n.Types[u.t-1].name,index:+u.v}):a==0&&n.Value.push({type:n.Types[u.t-1].name,index:+u.v});break;case"</rc>":break;case"<cellMetadata":a=1;break;case"</cellMetadata>":a=2;break;case"<valueMetadata":a=0;break;case"</valueMetadata>":a=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;case"<rvb":if(!o)break;o.offsets||(o.offsets=[]),o.offsets.push(+u.i);break;default:if(!i&&r.WTF)throw new Error("unrecognized "+u[0]+" in metadata")}return c}),n}function X6(){var t=[Ci];return t.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),t.join("")}function aU(t){var e=[];if(!t)return e;var r=1;return(t.match(as)||[]).forEach(function(n){var i=pr(n);switch(i[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete i[0],i.i?r=i.i:i.i=r,e.push(i);break}}),e}function sU(t){var e={};e.i=t.read_shift(4);var r={};r.r=t.read_shift(4),r.c=t.read_shift(4),e.r=ur(r);var n=t.read_shift(1);return n&2&&(e.l="1"),n&8&&(e.a="1"),e}function oU(t,e,r){var n=[];return hu(t,function(a,o,c){switch(c){case 63:n.push(a);break;default:if(!o.T)throw new Error("Unexpected record 0x"+c.toString(16))}}),n}function lU(t,e,r,n){if(!t)return t;var i=n||{},a=!1;hu(t,function(c,u,h){switch(h){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:a=!0;break;case 36:a=!1;break;default:if(!u.T){if(!a||i.WTF)throw new Error("Unexpected record 0x"+h.toString(16))}}},i)}function cU(t,e){if(!t)return"??";var r=(t.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return e["!id"][r].Target}var I0=1024;function Y6(t,e){for(var r=[21600,21600],n=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),i=[Ct("xml",null,{"xmlns:v":Js.v,"xmlns:o":Js.o,"xmlns:x":Js.x,"xmlns:mv":Js.mv}).replace(/\/>/,">"),Ct("o:shapelayout",Ct("o:idmap",null,{"v:ext":"edit",data:t}),{"v:ext":"edit"}),Ct("v:shapetype",[Ct("v:stroke",null,{joinstyle:"miter"}),Ct("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:n})];I0<t*1e3;)I0+=1e3;return e.forEach(function(a){var o=ti(a[0]),c={color2:"#BEFF82",type:"gradient"};c.type=="gradient"&&(c.angle="-180");var u=c.type=="gradient"?Ct("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,h=Ct("v:fill",u,c),d={on:"t",obscured:"t"};++I0,i=i.concat(["<v:shape"+V1({id:"_x0000_s"+I0,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(a[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",h,Ct("v:shadow",null,d),Ct("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",Ca("x:Anchor",[o.c+1,0,o.r+1,0,o.c+3,20,o.r+5,20].join(",")),Ca("x:AutoFill","False"),Ca("x:Row",String(o.r)),Ca("x:Column",String(o.c)),a[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),i.push("</xml>"),i.join("")}function W3(t,e,r,n){var i=Array.isArray(t),a;e.forEach(function(o){var c=ti(o.ref);if(i?(t[c.r]||(t[c.r]=[]),a=t[c.r][c.c]):a=t[o.ref],!a){a={t:"z"},i?t[c.r][c.c]=a:t[o.ref]=a;var u=rn(t["!ref"]||"BDWGO1000001:A1");u.s.r>c.r&&(u.s.r=c.r),u.e.r<c.r&&(u.e.r=c.r),u.s.c>c.c&&(u.s.c=c.c),u.e.c<c.c&&(u.e.c=c.c);var h=wr(u);h!==t["!ref"]&&(t["!ref"]=h)}a.c||(a.c=[]);var d={a:o.author,t:o.t,r:o.r,T:r};o.h&&(d.h=o.h);for(var g=a.c.length-1;g>=0;--g){if(!r&&a.c[g].T)return;r&&!a.c[g].T&&a.c.splice(g,1)}if(r&&n){for(g=0;g<n.length;++g)if(d.a==n[g].id){d.a=n[g].name||d.a;break}}a.c.push(d)})}function uU(t,e){if(t.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],n=[],i=t.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);i&&i[1]&&i[1].split(/<\/\w*:?author>/).forEach(function(o){if(!(o===""||o.trim()==="")){var c=o.match(/<(?:\w+:)?author[^>]*>(.*)/);c&&r.push(c[1])}});var a=t.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return a&&a[1]&&a[1].split(/<\/\w*:?comment>/).forEach(function(o){if(!(o===""||o.trim()==="")){var c=o.match(/<(?:\w+:)?comment[^>]*>/);if(c){var u=pr(c[0]),h={author:u.authorId&&r[u.authorId]||"sheetjsghost",ref:u.ref,guid:u.guid},d=ti(u.ref);if(!(e.sheetRows&&e.sheetRows<=d.r)){var g=o.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),x=!!g&&!!g[1]&&Hy(g[1])||{r:"",t:"",h:""};h.r=x.r,x.r=="<t></t>"&&(x.t=x.h=""),h.t=(x.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.cellHTML&&(h.h=x.h),n.push(h)}}}}),n}function K6(t){var e=[Ci,Ct("comments",null,{xmlns:Oh[0]})],r=[];return e.push("<authors>"),t.forEach(function(n){n[1].forEach(function(i){var a=bn(i.a);r.indexOf(a)==-1&&(r.push(a),e.push("<author>"+a+"</author>")),i.T&&i.ID&&r.indexOf("tc="+i.ID)==-1&&(r.push("tc="+i.ID),e.push("<author>tc="+i.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),e.push("<author>SheetJ5</author>")),e.push("</authors>"),e.push("<commentList>"),t.forEach(function(n){var i=0,a=[];if(n[1][0]&&n[1][0].T&&n[1][0].ID?i=r.indexOf("tc="+n[1][0].ID):n[1].forEach(function(u){u.a&&(i=r.indexOf(bn(u.a))),a.push(u.t||"")}),e.push('<comment ref="'+n[0]+'" authorId="'+i+'"><text>'),a.length<=1)e.push(Ca("t",bn(a[0]||"")));else{for(var o=`Comment:
    `+a[0]+`
`,c=1;c<a.length;++c)o+=`Reply:
    `+a[c]+`
`;e.push(Ca("t",bn(o)))}e.push("</text></comment>")}),e.push("</commentList>"),e.length>2&&(e[e.length]="</comments>",e[1]=e[1].replace("/>",">")),e.join("")}function fU(t,e){var r=[],n=!1,i={},a=0;return t.replace(as,function(c,u){var h=pr(c);switch(vc(h[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":i={author:h.personId,guid:h.id,ref:h.ref,T:1};break;case"</threadedComment>":i.t!=null&&r.push(i);break;case"<text>":case"<text":a=u+c.length;break;case"</text>":i.t=t.slice(a,u).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&e.WTF)throw new Error("unrecognized "+h[0]+" in threaded comments")}return c}),r}function hU(t,e,r){var n=[Ci,Ct("ThreadedComments",null,{xmlns:Qi.TCMNT}).replace(/[\/]>/,">")];return t.forEach(function(i){var a="";(i[1]||[]).forEach(function(o,c){if(!o.T){delete o.ID;return}o.a&&e.indexOf(o.a)==-1&&e.push(o.a);var u={ref:i[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};c==0?a=u.id:u.parentId=a,o.ID=u.id,o.a&&(u.personId="{54EE7950-7262-4200-6969-"+("000000000000"+e.indexOf(o.a)).slice(-12)+"}"),n.push(Ct("threadedComment",Ca("text",o.t||""),u))})}),n.push("</ThreadedComments>"),n.join("")}function dU(t,e){var r=[],n=!1;return t.replace(as,function(a){var o=pr(a);switch(vc(o[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:o.displayname,id:o.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&e.WTF)throw new Error("unrecognized "+o[0]+" in threaded comments")}return a}),r}function pU(t){var e=[Ci,Ct("personList",null,{xmlns:Qi.TCMNT,"xmlns:x":Oh[0]}).replace(/[\/]>/,">")];return t.forEach(function(r,n){e.push(Ct("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+n).slice(-12)+"}",userId:r,providerId:"None"}))}),e.push("</personList>"),e.join("")}function mU(t){var e={};e.iauthor=t.read_shift(4);var r=jh(t);return e.rfx=r.s,e.ref=ur(r.s),t.l+=16,e}function gU(t,e){return e==null&&(e=it(36)),e.write_shift(4,t[1].iauthor),hd(t[0],e),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e}var vU=rs;function _U(t){return pa(t.slice(0,54))}function xU(t,e){var r=[],n=[],i={},a=!1;return hu(t,function(c,u,h){switch(h){case 632:n.push(c);break;case 635:i=c;break;case 637:i.t=c.t,i.h=c.h,i.r=c.r;break;case 636:if(i.author=n[i.iauthor],delete i.iauthor,e.sheetRows&&i.rfx&&e.sheetRows<=i.rfx.r)break;i.t||(i.t=""),delete i.rfx,r.push(i);break;case 3072:break;case 35:a=!0;break;case 36:a=!1;break;case 37:break;case 38:break;default:if(!u.T){if(!a||e.WTF)throw new Error("Unexpected record 0x"+h.toString(16))}}}),r}function yU(t){var e=Ls(),r=[];return xt(e,628),xt(e,630),t.forEach(function(n){n[1].forEach(function(i){r.indexOf(i.a)>-1||(r.push(i.a.slice(0,54)),xt(e,632,_U(i.a)))})}),xt(e,631),xt(e,633),t.forEach(function(n){n[1].forEach(function(i){i.iauthor=r.indexOf(i.a);var a={s:ti(n[0]),e:ti(n[0])};xt(e,635,gU([a,i])),i.t&&i.t.length>0&&xt(e,637,qP(i)),xt(e,636),delete i.iauthor})}),xt(e,634),xt(e,629),e.end()}var wU="application/vnd.ms-office.vbaProject";function EU(t){var e=Qt.utils.cfb_new({root:"R"});return t.FullPaths.forEach(function(r,n){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var i=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");Qt.utils.cfb_add(e,i,t.FileIndex[n].content)}}),Qt.write(e)}function bU(t,e){e.FullPaths.forEach(function(r,n){if(n!=0){var i=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");i.slice(-1)!=="/"&&Qt.utils.cfb_add(t,i,e.FileIndex[n].content)}})}var $6=["xlsb","xlsm","xlam","biff8","xla"];function SU(){return{"!type":"dialog"}}function AU(){return{"!type":"dialog"}}function TU(){return{"!type":"macro"}}function kU(){return{"!type":"macro"}}var j0=function(){var t=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,e={r:0,c:0};function r(n,i,a,o){var c=!1,u=!1;a.length==0?u=!0:a.charAt(0)=="["&&(u=!0,a=a.slice(1,-1)),o.length==0?c=!0:o.charAt(0)=="["&&(c=!0,o=o.slice(1,-1));var h=a.length>0?parseInt(a,10)|0:0,d=o.length>0?parseInt(o,10)|0:0;return c?d+=e.c:--d,u?h+=e.r:--h,i+(c?"":"$")+ei(d)+(u?"":"$")+Ni(h)}return function(i,a){return e=a,i.replace(t,r)}}(),Yy=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,Ky=function(){return function(e,r){return e.replace(Yy,function(n,i,a,o,c,u){var h=Oy(o)-(a?0:r.c),d=Fy(u)-(c?0:r.r),g=d==0?"":c?d+1:"["+d+"]",x=h==0?"":a?h+1:"["+h+"]";return i+"R"+g+"C"+x})}}();function Q6(t,e){return t.replace(Yy,function(r,n,i,a,o,c){return n+(i=="$"?i+a:ei(Oy(a)+e.c))+(o=="$"?o+c:Ni(Fy(c)+e.r))})}function NU(t,e,r){var n=Ds(e),i=n.s,a=ti(r),o={r:a.r-i.r,c:a.c-i.c};return Q6(t,o)}function CU(t){return t.length!=1}function X3(t){return t.replace(/_xlfn\./g,"")}function Mi(t){t.l+=1}function bf(t,e){var r=t.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function J6(t,e,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return Z6(t);r.biff==12&&(n=4)}var i=t.read_shift(n),a=t.read_shift(n),o=bf(t),c=bf(t);return{s:{r:i,c:o[0],cRel:o[1],rRel:o[2]},e:{r:a,c:c[0],cRel:c[1],rRel:c[2]}}}function Z6(t){var e=bf(t),r=bf(t),n=t.read_shift(1),i=t.read_shift(1);return{s:{r:e[0],c:n,cRel:e[1],rRel:e[2]},e:{r:r[0],c:i,cRel:r[1],rRel:r[2]}}}function IU(t,e,r){if(r.biff<8)return Z6(t);var n=t.read_shift(r.biff==12?4:2),i=t.read_shift(r.biff==12?4:2),a=bf(t),o=bf(t);return{s:{r:n,c:a[0],cRel:a[1],rRel:a[2]},e:{r:i,c:o[0],cRel:o[1],rRel:o[2]}}}function ek(t,e,r){if(r&&r.biff>=2&&r.biff<=5)return RU(t);var n=t.read_shift(r&&r.biff==12?4:2),i=bf(t);return{r:n,c:i[0],cRel:i[1],rRel:i[2]}}function RU(t){var e=bf(t),r=t.read_shift(1);return{r:e[0],c:r,cRel:e[1],rRel:e[2]}}function LU(t){var e=t.read_shift(2),r=t.read_shift(2);return{r:e,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function DU(t,e,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return FU(t);var i=t.read_shift(n>=12?4:2),a=t.read_shift(2),o=(a&16384)>>14,c=(a&32768)>>15;if(a&=16383,c==1)for(;i>524287;)i-=1048576;if(o==1)for(;a>8191;)a=a-16384;return{r:i,c:a,cRel:o,rRel:c}}function FU(t){var e=t.read_shift(2),r=t.read_shift(1),n=(e&32768)>>15,i=(e&16384)>>14;return e&=16383,n==1&&e>=8192&&(e=e-16384),i==1&&r>=128&&(r=r-256),{r:e,c:r,cRel:i,rRel:n}}function OU(t,e,r){var n=(t[t.l++]&96)>>5,i=J6(t,r.biff>=2&&r.biff<=5?6:8,r);return[n,i]}function PU(t,e,r){var n=(t[t.l++]&96)>>5,i=t.read_shift(2,"i"),a=8;if(r)switch(r.biff){case 5:t.l+=12,a=6;break;case 12:a=12;break}var o=J6(t,a,r);return[n,i,o]}function MU(t,e,r){var n=(t[t.l++]&96)>>5;return t.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function BU(t,e,r){var n=(t[t.l++]&96)>>5,i=t.read_shift(2),a=8;if(r)switch(r.biff){case 5:t.l+=12,a=6;break;case 12:a=12;break}return t.l+=a,[n,i]}function jU(t,e,r){var n=(t[t.l++]&96)>>5,i=IU(t,e-1,r);return[n,i]}function UU(t,e,r){var n=(t[t.l++]&96)>>5;return t.l+=r.biff==2?6:r.biff==12?14:7,[n]}function Y3(t){var e=t[t.l+1]&1,r=1;return t.l+=4,[e,r]}function VU(t,e,r){t.l+=2;for(var n=t.read_shift(r&&r.biff==2?1:2),i=[],a=0;a<=n;++a)i.push(t.read_shift(r&&r.biff==2?1:2));return i}function qU(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=2,[n,t.read_shift(r&&r.biff==2?1:2)]}function zU(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=2,[n,t.read_shift(r&&r.biff==2?1:2)]}function HU(t){var e=t[t.l+1]&255?1:0;return t.l+=2,[e,t.read_shift(2)]}function GU(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=r&&r.biff==2?3:4,[n]}function tk(t){var e=t.read_shift(1),r=t.read_shift(1);return[e,r]}function WU(t){return t.read_shift(2),tk(t)}function XU(t){return t.read_shift(2),tk(t)}function YU(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var i=ek(t,0,r);return[n,i]}function KU(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var i=DU(t,0,r);return[n,i]}function $U(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var i=t.read_shift(2);r&&r.biff==5&&(t.l+=12);var a=ek(t,0,r);return[n,i,a]}function QU(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var i=t.read_shift(r&&r.biff<=3?1:2);return[eq[i],ik[i],n]}function JU(t,e,r){var n=t[t.l++],i=t.read_shift(1),a=r&&r.biff<=3?[n==88?-1:0,t.read_shift(1)]:ZU(t);return[i,(a[0]===0?ik:ZV)[a[1]]]}function ZU(t){return[t[t.l+1]>>7,t.read_shift(2)&32767]}function eV(t,e,r){t.l+=r&&r.biff==2?3:4}function tV(t,e,r){if(t.l++,r&&r.biff==12)return[t.read_shift(4,"i"),0];var n=t.read_shift(2),i=t.read_shift(r&&r.biff==2?1:2);return[n,i]}function rV(t){return t.l++,du[t.read_shift(1)]}function nV(t){return t.l++,t.read_shift(2)}function iV(t){return t.l++,t.read_shift(1)!==0}function aV(t){return t.l++,es(t)}function sV(t,e,r){return t.l++,mp(t,e-1,r)}function oV(t,e){var r=[t.read_shift(1)];if(e==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=wi(t,1)?"TRUE":"FALSE",e!=12&&(t.l+=7);break;case 37:case 16:r[1]=du[t[t.l]],t.l+=e==12?4:8;break;case 0:t.l+=8;break;case 1:r[1]=es(t);break;case 2:r[1]=Uh(t,0,{biff:e>0&&e<8?2:e});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function lV(t,e,r){for(var n=t.read_shift(r.biff==12?4:2),i=[],a=0;a!=n;++a)i.push((r.biff==12?jh:v2)(t));return i}function cV(t,e,r){var n=0,i=0;r.biff==12?(n=t.read_shift(4),i=t.read_shift(4)):(i=1+t.read_shift(1),n=1+t.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--i==0&&(i=256));for(var a=0,o=[];a!=n&&(o[a]=[]);++a)for(var c=0;c!=i;++c)o[a][c]=oV(t,r.biff);return o}function uV(t,e,r){var n=t.read_shift(1)>>>5&3,i=!r||r.biff>=8?4:2,a=t.read_shift(i);switch(r.biff){case 2:t.l+=5;break;case 3:case 4:t.l+=8;break;case 5:t.l+=12;break}return[n,0,a]}function fV(t,e,r){if(r.biff==5)return hV(t);var n=t.read_shift(1)>>>5&3,i=t.read_shift(2),a=t.read_shift(4);return[n,i,a]}function hV(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2,"i");t.l+=8;var n=t.read_shift(2);return t.l+=12,[e,r,n]}function dV(t,e,r){var n=t.read_shift(1)>>>5&3;t.l+=r&&r.biff==2?3:4;var i=t.read_shift(r&&r.biff==2?1:2);return[n,i]}function pV(t,e,r){var n=t.read_shift(1)>>>5&3,i=t.read_shift(r&&r.biff==2?1:2);return[n,i]}function mV(t,e,r){var n=t.read_shift(1)>>>5&3;return t.l+=4,r.biff<8&&t.l--,r.biff==12&&(t.l+=2),[n]}function gV(t,e,r){var n=(t[t.l++]&96)>>5,i=t.read_shift(2),a=4;if(r)switch(r.biff){case 5:a=15;break;case 12:a=6;break}return t.l+=a,[n,i]}var vV=is,_V=is,xV=is;function vp(t,e,r){return t.l+=2,[LU(t)]}function $y(t){return t.l+=6,[]}var yV=vp,wV=$y,EV=$y,bV=vp;function rk(t){return t.l+=2,[Ui(t),t.read_shift(2)&1]}var SV=vp,AV=rk,TV=$y,kV=vp,NV=vp,CV=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function IV(t){t.l+=2;var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(4),i=t.read_shift(2),a=t.read_shift(2),o=CV[r>>2&31];return{ixti:e,coltype:r&3,rt:o,idx:n,c:i,C:a}}function RV(t){return t.l+=2,[t.read_shift(4)]}function LV(t,e,r){return t.l+=5,t.l+=2,t.l+=r.biff==2?1:4,["PTGSHEET"]}function DV(t,e,r){return t.l+=r.biff==2?4:5,["PTGENDSHEET"]}function FV(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2);return[e,r]}function OV(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2);return[e,r]}function PV(t){return t.l+=4,[0,0]}var K3={1:{n:"PtgExp",f:tV},2:{n:"PtgTbl",f:xV},3:{n:"PtgAdd",f:Mi},4:{n:"PtgSub",f:Mi},5:{n:"PtgMul",f:Mi},6:{n:"PtgDiv",f:Mi},7:{n:"PtgPower",f:Mi},8:{n:"PtgConcat",f:Mi},9:{n:"PtgLt",f:Mi},10:{n:"PtgLe",f:Mi},11:{n:"PtgEq",f:Mi},12:{n:"PtgGe",f:Mi},13:{n:"PtgGt",f:Mi},14:{n:"PtgNe",f:Mi},15:{n:"PtgIsect",f:Mi},16:{n:"PtgUnion",f:Mi},17:{n:"PtgRange",f:Mi},18:{n:"PtgUplus",f:Mi},19:{n:"PtgUminus",f:Mi},20:{n:"PtgPercent",f:Mi},21:{n:"PtgParen",f:Mi},22:{n:"PtgMissArg",f:Mi},23:{n:"PtgStr",f:sV},26:{n:"PtgSheet",f:LV},27:{n:"PtgEndSheet",f:DV},28:{n:"PtgErr",f:rV},29:{n:"PtgBool",f:iV},30:{n:"PtgInt",f:nV},31:{n:"PtgNum",f:aV},32:{n:"PtgArray",f:UU},33:{n:"PtgFunc",f:QU},34:{n:"PtgFuncVar",f:JU},35:{n:"PtgName",f:uV},36:{n:"PtgRef",f:YU},37:{n:"PtgArea",f:OU},38:{n:"PtgMemArea",f:dV},39:{n:"PtgMemErr",f:vV},40:{n:"PtgMemNoMem",f:_V},41:{n:"PtgMemFunc",f:pV},42:{n:"PtgRefErr",f:mV},43:{n:"PtgAreaErr",f:MU},44:{n:"PtgRefN",f:KU},45:{n:"PtgAreaN",f:jU},46:{n:"PtgMemAreaN",f:FV},47:{n:"PtgMemNoMemN",f:OV},57:{n:"PtgNameX",f:fV},58:{n:"PtgRef3d",f:$U},59:{n:"PtgArea3d",f:PU},60:{n:"PtgRefErr3d",f:gV},61:{n:"PtgAreaErr3d",f:BU},255:{}},MV={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},BV={1:{n:"PtgElfLel",f:rk},2:{n:"PtgElfRw",f:kV},3:{n:"PtgElfCol",f:yV},6:{n:"PtgElfRwV",f:NV},7:{n:"PtgElfColV",f:bV},10:{n:"PtgElfRadical",f:SV},11:{n:"PtgElfRadicalS",f:TV},13:{n:"PtgElfColS",f:wV},15:{n:"PtgElfColSV",f:EV},16:{n:"PtgElfRadicalLel",f:AV},25:{n:"PtgList",f:IV},29:{n:"PtgSxName",f:RV},255:{}},jV={0:{n:"PtgAttrNoop",f:PV},1:{n:"PtgAttrSemi",f:GU},2:{n:"PtgAttrIf",f:zU},4:{n:"PtgAttrChoose",f:VU},8:{n:"PtgAttrGoto",f:qU},16:{n:"PtgAttrSum",f:eV},32:{n:"PtgAttrBaxcel",f:Y3},33:{n:"PtgAttrBaxcel",f:Y3},64:{n:"PtgAttrSpace",f:WU},65:{n:"PtgAttrSpaceSemi",f:XU},128:{n:"PtgAttrIfError",f:HU},255:{}};function _p(t,e,r,n){if(n.biff<8)return is(t,e);for(var i=t.l+e,a=[],o=0;o!==r.length;++o)switch(r[o][0]){case"PtgArray":r[o][1]=cV(t,0,n),a.push(r[o][1]);break;case"PtgMemArea":r[o][2]=lV(t,r[o][1],n),a.push(r[o][2]);break;case"PtgExp":n&&n.biff==12&&(r[o][1][1]=t.read_shift(4),a.push(r[o][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[o][0]}return e=i-t.l,e!==0&&a.push(is(t,e)),a}function xp(t,e,r){for(var n=t.l+e,i,a,o=[];n!=t.l;)e=n-t.l,a=t[t.l],i=K3[a]||K3[MV[a]],(a===24||a===25)&&(i=(a===24?BV:jV)[t[t.l+1]]),!i||!i.f?is(t,e):o.push([i.n,i.f(t,e,r)]);return o}function UV(t){for(var e=[],r=0;r<t.length;++r){for(var n=t[r],i=[],a=0;a<n.length;++a){var o=n[a];if(o)switch(o[0]){case 2:i.push('"'+o[1].replace(/"/g,'""')+'"');break;default:i.push(o[1])}else i.push("")}e.push(i.join(","))}return e.join(";")}var VV={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function qV(t,e){if(!t&&!(e&&e.biff<=5&&e.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(t)?"'"+t+"'":t}function nk(t,e,r){if(!t)return"SH33TJSERR0";if(r.biff>8&&(!t.XTI||!t.XTI[e]))return t.SheetNames[e];if(!t.XTI)return"SH33TJSERR6";var n=t.XTI[e];if(r.biff<8)return e>1e4&&(e-=65536),e<0&&(e=-e),e==0?"":t.XTI[e-1];if(!n)return"SH33TJSERR1";var i="";if(r.biff>8)switch(t[n[0]][0]){case 357:return i=n[1]==-1?"#REF":t.SheetNames[n[1]],n[1]==n[2]?i:i+":"+t.SheetNames[n[2]];case 358:return r.SID!=null?t.SheetNames[r.SID]:"SH33TJSSAME"+t[n[0]][0];case 355:default:return"SH33TJSSRC"+t[n[0]][0]}switch(t[n[0]][0][0]){case 1025:return i=n[1]==-1?"#REF":t.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?i:i+":"+t.SheetNames[n[2]];case 14849:return t[n[0]].slice(1).map(function(a){return a.Name}).join(";;");default:return t[n[0]][0][3]?(i=n[1]==-1?"#REF":t[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?i:i+":"+t[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function $3(t,e,r){var n=nk(t,e,r);return n=="#REF"?n:qV(n,r)}function Qa(t,e,r,n,i){var a=i&&i.biff||8,o={s:{c:0,r:0}},c=[],u,h,d,g=0,x=0,_,b="";if(!t[0]||!t[0][0])return"";for(var E=-1,A="",O=0,M=t[0].length;O<M;++O){var B=t[0][O];switch(B[0]){case"PtgUminus":c.push("-"+c.pop());break;case"PtgUplus":c.push("+"+c.pop());break;case"PtgPercent":c.push(c.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(u=c.pop(),h=c.pop(),E>=0){switch(t[0][E][1][0]){case 0:A=ui(" ",t[0][E][1][1]);break;case 1:A=ui("\r",t[0][E][1][1]);break;default:if(A="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][E][1][0])}h=h+A,E=-1}c.push(h+VV[B[0]]+u);break;case"PtgIsect":u=c.pop(),h=c.pop(),c.push(h+" "+u);break;case"PtgUnion":u=c.pop(),h=c.pop(),c.push(h+","+u);break;case"PtgRange":u=c.pop(),h=c.pop(),c.push(h+":"+u);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":d=_1(B[1][1],o,i),c.push(x1(d,a));break;case"PtgRefN":d=r?_1(B[1][1],r,i):B[1][1],c.push(x1(d,a));break;case"PtgRef3d":g=B[1][1],d=_1(B[1][2],o,i),b=$3(n,g,i),c.push(b+"!"+x1(d,a));break;case"PtgFunc":case"PtgFuncVar":var Q=B[1][0],ee=B[1][1];Q||(Q=0),Q&=127;var he=Q==0?[]:c.slice(-Q);c.length-=Q,ee==="User"&&(ee=he.shift()),c.push(ee+"("+he.join(",")+")");break;case"PtgBool":c.push(B[1]?"TRUE":"FALSE");break;case"PtgInt":c.push(B[1]);break;case"PtgNum":c.push(String(B[1]));break;case"PtgStr":c.push('"'+B[1].replace(/"/g,'""')+'"');break;case"PtgErr":c.push(B[1]);break;case"PtgAreaN":_=A3(B[1][1],r?{s:r}:o,i),c.push($v(_,i));break;case"PtgArea":_=A3(B[1][1],o,i),c.push($v(_,i));break;case"PtgArea3d":g=B[1][1],_=B[1][2],b=$3(n,g,i),c.push(b+"!"+$v(_,i));break;case"PtgAttrSum":c.push("SUM("+c.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":x=B[1][2];var F=(n.names||[])[x-1]||(n[0]||[])[x],k=F?F.Name:"SH33TJSNAME"+String(x);k&&k.slice(0,6)=="_xlfn."&&!i.xlfn&&(k=k.slice(6)),c.push(k);break;case"PtgNameX":var S=B[1][1];x=B[1][2];var U;if(i.biff<=5)S<0&&(S=-S),n[S]&&(U=n[S][x]);else{var I="";if(((n[S]||[])[0]||[])[0]==14849||(((n[S]||[])[0]||[])[0]==1025?n[S][x]&&n[S][x].itab>0&&(I=n.SheetNames[n[S][x].itab-1]+"!"):I=n.SheetNames[x-1]+"!"),n[S]&&n[S][x])I+=n[S][x].Name;else if(n[0]&&n[0][x])I+=n[0][x].Name;else{var C=(nk(n,S,i)||"").split(";;");C[x-1]?I=C[x-1]:I+="SH33TJSERRX"}c.push(I);break}U||(U={Name:"SH33TJSERRY"}),c.push(U.Name);break;case"PtgParen":var R="(",se=")";if(E>=0){switch(A="",t[0][E][1][0]){case 2:R=ui(" ",t[0][E][1][1])+R;break;case 3:R=ui("\r",t[0][E][1][1])+R;break;case 4:se=ui(" ",t[0][E][1][1])+se;break;case 5:se=ui("\r",t[0][E][1][1])+se;break;default:if(i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][E][1][0])}E=-1}c.push(R+c.pop()+se);break;case"PtgRefErr":c.push("#REF!");break;case"PtgRefErr3d":c.push("#REF!");break;case"PtgExp":d={c:B[1][1],r:B[1][0]};var ne={c:r.c,r:r.r};if(n.sharedf[ur(d)]){var J=n.sharedf[ur(d)];c.push(Qa(J,o,ne,n,i))}else{var de=!1;for(u=0;u!=n.arrayf.length;++u)if(h=n.arrayf[u],!(d.c<h[0].s.c||d.c>h[0].e.c)&&!(d.r<h[0].s.r||d.r>h[0].e.r)){c.push(Qa(h[1],o,ne,n,i)),de=!0;break}de||c.push(B[1])}break;case"PtgArray":c.push("{"+UV(B[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":E=O;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":c.push("");break;case"PtgAreaErr":c.push("#REF!");break;case"PtgAreaErr3d":c.push("#REF!");break;case"PtgList":c.push("Table"+B[1].idx+"[#"+B[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(B));default:throw new Error("Unrecognized Formula Token: "+String(B))}var oe=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(i.biff!=3&&E>=0&&oe.indexOf(t[0][O][0])==-1){B=t[0][E];var Z=!0;switch(B[1][0]){case 4:Z=!1;case 0:A=ui(" ",B[1][1]);break;case 5:Z=!1;case 1:A=ui("\r",B[1][1]);break;default:if(A="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+B[1][0])}c.push((Z?A:"")+c.pop()+(Z?"":A)),E=-1}}if(c.length>1&&i.WTF)throw new Error("bad formula stack");return c[0]}function zV(t,e,r){var n=t.l+e,i=r.biff==2?1:2,a,o=t.read_shift(i);if(o==65535)return[[],is(t,e-2)];var c=xp(t,o,r);return e!==o+i&&(a=_p(t,e-o-i,c,r)),t.l=n,[c,a]}function HV(t,e,r){var n=t.l+e,i=r.biff==2?1:2,a,o=t.read_shift(i);if(o==65535)return[[],is(t,e-2)];var c=xp(t,o,r);return e!==o+i&&(a=_p(t,e-o-i,c,r)),t.l=n,[c,a]}function GV(t,e,r,n){var i=t.l+e,a=xp(t,n,r),o;return i!==t.l&&(o=_p(t,i-t.l,a,r)),[a,o]}function WV(t,e,r){var n=t.l+e,i,a=t.read_shift(2),o=xp(t,a,r);return a==65535?[[],is(t,e-2)]:(e!==a+2&&(i=_p(t,n-a-2,o,r)),[o,i])}function XV(t){var e;if(Zc(t,t.l+6)!==65535)return[es(t),"n"];switch(t[t.l]){case 0:return t.l+=8,["String","s"];case 1:return e=t[t.l+2]===1,t.l+=8,[e,"b"];case 2:return e=t[t.l+2],t.l+=8,[e,"e"];case 3:return t.l+=8,["","s"]}return[]}function YV(t){if(t==null){var e=it(8);return e.write_shift(1,3),e.write_shift(1,0),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,65535),e}else if(typeof t=="number")return Th(t);return Th(0)}function t_(t,e,r){var n=t.l+e,i=_c(t);r.biff==2&&++t.l;var a=XV(t),o=t.read_shift(1);r.biff!=2&&(t.read_shift(1),r.biff>=5&&t.read_shift(4));var c=HV(t,n-t.l,r);return{cell:i,val:a[0],formula:c,shared:o>>3&1,tt:a[1]}}function KV(t,e,r,n,i){var a=Nh(e,r,i),o=YV(t.v),c=it(6),u=33;c.write_shift(2,u),c.write_shift(4,0);for(var h=it(t.bf.length),d=0;d<t.bf.length;++d)h[d]=t.bf[d];var g=da([a,o,c,h]);return g}function _2(t,e,r){var n=t.read_shift(4),i=xp(t,n,r),a=t.read_shift(4),o=a>0?_p(t,a,i,r):null;return[i,o]}var $V=_2,x2=_2,QV=_2,JV=_2,ZV={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},ik={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},eq={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function Q3(t){return t.slice(0,3)=="of:"&&(t=t.slice(3)),t.charCodeAt(0)==61&&(t=t.slice(1),t.charCodeAt(0)==61&&(t=t.slice(1))),t=t.replace(/COM\.MICROSOFT\./g,""),t=t.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(e,r){return r.replace(/\./g,"")}),t=t.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),t.replace(/[;~]/g,",").replace(/\|/g,";")}function tq(t){var e="of:="+t.replace(Yy,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return e.replace(/;/g,"|").replace(/,/g,";")}function r_(t){var e=t.split(":"),r=e[0].split(".")[0];return[r,e[0].split(".")[1]+(e.length>1?":"+(e[1].split(".")[1]||e[1].split(".")[0]):"")]}function rq(t){return t.replace(/\./,"!")}var w1={},U0={},E1=typeof Map<"u";function Qy(t,e,r){var n=0,i=t.length;if(r){if(E1?r.has(e):Object.prototype.hasOwnProperty.call(r,e)){for(var a=E1?r.get(e):r[e];n<a.length;++n)if(t[a[n]].t===e)return t.Count++,a[n]}}else for(;n<i;++n)if(t[n].t===e)return t.Count++,n;return t[i]={t:e},t.Count++,t.Unique++,r&&(E1?(r.has(e)||r.set(e,[]),r.get(e).push(i)):(Object.prototype.hasOwnProperty.call(r,e)||(r[e]=[]),r[e].push(i))),i}function y2(t,e){var r={min:t+1,max:t+1},n=-1;return e.MDW&&(Za=e.MDW),e.width!=null?r.customWidth=1:e.wpx!=null?n=W1(e.wpx):e.wch!=null&&(n=e.wch),n>-1?(r.width=Bg(n),r.customWidth=1):e.width!=null&&(r.width=e.width),e.hidden&&(r.hidden=!0),e.level!=null&&(r.outlineLevel=r.level=e.level),r}function gh(t,e){if(t){var r=[.7,.7,.75,.75,.3,.3];e=="xlml"&&(r=[1,1,1,1,.5,.5]),t.left==null&&(t.left=r[0]),t.right==null&&(t.right=r[1]),t.top==null&&(t.top=r[2]),t.bottom==null&&(t.bottom=r[3]),t.header==null&&(t.header=r[4]),t.footer==null&&(t.footer=r[5])}}function Of(t,e,r){var n=r.revssf[e.z!=null?e.z:"General"],i=60,a=t.length;if(n==null&&r.ssf){for(;i<392;++i)if(r.ssf[i]==null){nu(e.z,i),r.ssf[i]=e.z,r.revssf[e.z]=n=i;break}}for(i=0;i!=a;++i)if(t[i].numFmtId===n)return i;return t[a]={numFmtId:n,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},a}function ak(t,e,r,n,i,a){try{n.cellNF&&(t.z=sr[e])}catch(c){if(n.WTF)throw c}if(!(t.t==="z"&&!n.cellStyles)){if(t.t==="d"&&typeof t.v=="string"&&(t.v=qn(t.v)),(!n||n.cellText!==!1)&&t.t!=="z")try{if(sr[e]==null&&nu(ZO[e]||"General",e),t.t==="e")t.w=t.w||du[t.v];else if(e===0)if(t.t==="n")(t.v|0)===t.v?t.w=t.v.toString(10):t.w=j1(t.v);else if(t.t==="d"){var o=Zi(t.v);(o|0)===o?t.w=o.toString(10):t.w=j1(o)}else{if(t.v===void 0)return"";t.w=Sh(t.v,U0)}else t.t==="d"?t.w=Vo(e,Zi(t.v),U0):t.w=Vo(e,t.v,U0)}catch(c){if(n.WTF)throw c}if(n.cellStyles&&r!=null)try{t.s=a.Fills[r],t.s.fgColor&&t.s.fgColor.theme&&!t.s.fgColor.rgb&&(t.s.fgColor.rgb=Mg(i.themeElements.clrScheme[t.s.fgColor.theme].rgb,t.s.fgColor.tint||0),n.WTF&&(t.s.fgColor.raw_rgb=i.themeElements.clrScheme[t.s.fgColor.theme].rgb)),t.s.bgColor&&t.s.bgColor.theme&&(t.s.bgColor.rgb=Mg(i.themeElements.clrScheme[t.s.bgColor.theme].rgb,t.s.bgColor.tint||0),n.WTF&&(t.s.bgColor.raw_rgb=i.themeElements.clrScheme[t.s.bgColor.theme].rgb))}catch(c){if(n.WTF&&a.Fills)throw c}}}function nq(t,e,r){if(t&&t["!ref"]){var n=rn(t["!ref"]);if(n.e.c<n.s.c||n.e.r<n.s.r)throw new Error("Bad range ("+r+"): "+t["!ref"])}}function iq(t,e){var r=rn(e);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(t["!ref"]=wr(r))}var aq=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,sq=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,oq=/<(?:\w:)?hyperlink [^>]*>/mg,lq=/"(\w*:\w*)"/,cq=/<(?:\w:)?col\b[^>]*[\/]?>/g,uq=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,fq=/<(?:\w:)?pageMargins[^>]*\/>/g,sk=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,hq=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,dq=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function pq(t,e,r,n,i,a,o){if(!t)return t;n||(n={"!id":{}});var c=e.dense?[]:{},u={s:{r:2e6,c:2e6},e:{r:0,c:0}},h="",d="",g=t.match(sq);g?(h=t.slice(0,g.index),d=t.slice(g.index+g[0].length)):h=d=t;var x=h.match(sk);x?Jy(x[0],c,i,r):(x=h.match(hq))&&gq(x[0],x[1]||"",c,i,r);var _=(h.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(_>0){var b=h.slice(_,_+50).match(lq);b&&iq(c,b[1])}var E=h.match(dq);E&&E[1]&&Cq(E[1],i);var A=[];if(e.cellStyles){var O=h.match(cq);O&&Sq(A,O)}g&&Lq(g[1],c,e,u,a,o);var M=d.match(uq);M&&(c["!autofilter"]=Tq(M[0]));var B=[],Q=d.match(aq);if(Q)for(_=0;_!=Q.length;++_)B[_]=rn(Q[_].slice(Q[_].indexOf('"')+1));var ee=d.match(oq);ee&&wq(c,ee,n);var he=d.match(fq);if(he&&(c["!margins"]=Eq(pr(he[0]))),!c["!ref"]&&u.e.c>=u.s.c&&u.e.r>=u.s.r&&(c["!ref"]=wr(u)),e.sheetRows>0&&c["!ref"]){var F=rn(c["!ref"]);e.sheetRows<=+F.e.r&&(F.e.r=e.sheetRows-1,F.e.r>u.e.r&&(F.e.r=u.e.r),F.e.r<F.s.r&&(F.s.r=F.e.r),F.e.c>u.e.c&&(F.e.c=u.e.c),F.e.c<F.s.c&&(F.s.c=F.e.c),c["!fullref"]=c["!ref"],c["!ref"]=wr(F))}return A.length>0&&(c["!cols"]=A),B.length>0&&(c["!merges"]=B),c}function mq(t){if(t.length===0)return"";for(var e='<mergeCells count="'+t.length+'">',r=0;r!=t.length;++r)e+='<mergeCell ref="'+wr(t[r])+'"/>';return e+"</mergeCells>"}function Jy(t,e,r,n){var i=pr(t);r.Sheets[n]||(r.Sheets[n]={}),i.codeName&&(r.Sheets[n].CodeName=tn(Cn(i.codeName)))}function gq(t,e,r,n,i){Jy(t.slice(0,t.indexOf(">")),r,n,i)}function vq(t,e,r,n,i){var a=!1,o={},c=null;if(n.bookType!=="xlsx"&&e.vbaraw){var u=e.SheetNames[r];try{e.Workbook&&(u=e.Workbook.Sheets[r].CodeName||u)}catch{}a=!0,o.codeName=oc(bn(u))}if(t&&t["!outline"]){var h={summaryBelow:1,summaryRight:1};t["!outline"].above&&(h.summaryBelow=0),t["!outline"].left&&(h.summaryRight=0),c=(c||"")+Ct("outlinePr",null,h)}!a&&!c||(i[i.length]=Ct("sheetPr",c,o))}var _q=["objects","scenarios","selectLockedCells","selectUnlockedCells"],xq=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function yq(t){var e={sheet:1};return _q.forEach(function(r){t[r]!=null&&t[r]&&(e[r]="1")}),xq.forEach(function(r){t[r]!=null&&!t[r]&&(e[r]="0")}),t.password&&(e.password=Gy(t.password).toString(16).toUpperCase()),Ct("sheetProtection",null,e)}function wq(t,e,r){for(var n=Array.isArray(t),i=0;i!=e.length;++i){var a=pr(Cn(e[i]),!0);if(!a.ref)return;var o=((r||{})["!id"]||[])[a.id];o?(a.Target=o.Target,a.location&&(a.Target+="#"+tn(a.location))):(a.Target="#"+tn(a.location),o={Target:a.Target,TargetMode:"Internal"}),a.Rel=o,a.tooltip&&(a.Tooltip=a.tooltip,delete a.tooltip);for(var c=rn(a.ref),u=c.s.r;u<=c.e.r;++u)for(var h=c.s.c;h<=c.e.c;++h){var d=ur({c:h,r:u});n?(t[u]||(t[u]=[]),t[u][h]||(t[u][h]={t:"z",v:void 0}),t[u][h].l=a):(t[d]||(t[d]={t:"z",v:void 0}),t[d].l=a)}}}function Eq(t){var e={};return["left","right","top","bottom","header","footer"].forEach(function(r){t[r]&&(e[r]=parseFloat(t[r]))}),e}function bq(t){return gh(t),Ct("pageMargins",null,t)}function Sq(t,e){for(var r=!1,n=0;n!=e.length;++n){var i=pr(e[n],!0);i.hidden&&(i.hidden=jn(i.hidden));var a=parseInt(i.min,10)-1,o=parseInt(i.max,10)-1;for(i.outlineLevel&&(i.level=+i.outlineLevel||0),delete i.min,delete i.max,i.width=+i.width,!r&&i.width&&(r=!0,Wy(i.width)),Ef(i);a<=o;)t[a++]=zn(i)}}function Aq(t,e){for(var r=["<cols>"],n,i=0;i!=e.length;++i)(n=e[i])&&(r[r.length]=Ct("col",null,y2(i,n)));return r[r.length]="</cols>",r.join("")}function Tq(t){var e={ref:(t.match(/ref="([^"]*)"/)||[])[1]};return e}function kq(t,e,r,n){var i=typeof t.ref=="string"?t.ref:wr(t.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var a=r.Workbook.Names,o=Ds(i);o.s.r==o.e.r&&(o.e.r=Ds(e["!ref"]).e.r,i=wr(o));for(var c=0;c<a.length;++c){var u=a[c];if(u.Name=="_xlnm._FilterDatabase"&&u.Sheet==n){u.Ref="'"+r.SheetNames[n]+"'!"+i;break}}return c==a.length&&a.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+i}),Ct("autoFilter",null,{ref:i})}var Nq=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function Cq(t,e){e.Views||(e.Views=[{}]),(t.match(Nq)||[]).forEach(function(r,n){var i=pr(r);e.Views[n]||(e.Views[n]={}),+i.zoomScale&&(e.Views[n].zoom=+i.zoomScale),jn(i.rightToLeft)&&(e.Views[n].RTL=!0)})}function Iq(t,e,r,n){var i={workbookViewId:"0"};return(((n||{}).Workbook||{}).Views||[])[0]&&(i.rightToLeft=n.Workbook.Views[0].RTL?"1":"0"),Ct("sheetViews",Ct("sheetView",null,i),{})}function Rq(t,e,r,n){if(t.c&&r["!comments"].push([e,t.c]),t.v===void 0&&typeof t.f!="string"||t.t==="z"&&!t.f)return"";var i="",a=t.t,o=t.v;if(t.t!=="z")switch(t.t){case"b":i=t.v?"1":"0";break;case"n":i=""+t.v;break;case"e":i=du[t.v];break;case"d":n&&n.cellDates?i=qn(t.v,-1).toISOString():(t=zn(t),t.t="n",i=""+(t.v=Zi(qn(t.v)))),typeof t.z>"u"&&(t.z=sr[14]);break;default:i=t.v;break}var c=Ca("v",bn(i)),u={r:e},h=Of(n.cellXfs,t,n);switch(h!==0&&(u.s=h),t.t){case"n":break;case"d":u.t="d";break;case"b":u.t="b";break;case"e":u.t="e";break;case"z":break;default:if(t.v==null){delete t.t;break}if(t.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(n&&n.bookSST){c=Ca("v",""+Qy(n.Strings,t.v,n.revStrings)),u.t="s";break}u.t="str";break}if(t.t!=a&&(t.t=a,t.v=o),typeof t.f=="string"&&t.f){var d=t.F&&t.F.slice(0,e.length)==e?{t:"array",ref:t.F}:null;c=Ct("f",bn(t.f),d)+(t.v!=null?c:"")}return t.l&&r["!links"].push([e,t.l]),t.D&&(u.cm=1),Ct("c",c,u)}var Lq=function(){var t=/<(?:\w+:)?c[ \/>]/,e=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,i=/ref=["']([^"']*)["']/,a=U1("v"),o=U1("f");return function(u,h,d,g,x,_){for(var b=0,E="",A=[],O=[],M=0,B=0,Q=0,ee="",he,F,k=0,S=0,U,I,C=0,R=0,se=Array.isArray(_.CellXf),ne,J=[],de=[],oe=Array.isArray(h),Z=[],X={},xe=!1,L=!!d.sheetStubs,j=u.split(e),z=0,G=j.length;z!=G;++z){E=j[z].trim();var ae=E.length;if(ae!==0){var Ae=0;e:for(b=0;b<ae;++b)switch(E[b]){case">":if(E[b-1]!="/"){++b;break e}if(d&&d.cellStyles){if(F=pr(E.slice(Ae,b),!0),k=F.r!=null?parseInt(F.r,10):k+1,S=-1,d.sheetRows&&d.sheetRows<k)continue;X={},xe=!1,F.ht&&(xe=!0,X.hpt=parseFloat(F.ht),X.hpx=Z0(X.hpt)),F.hidden=="1"&&(xe=!0,X.hidden=!0),F.outlineLevel!=null&&(xe=!0,X.level=+F.outlineLevel),xe&&(Z[k-1]=X)}break;case"<":Ae=b;break}if(Ae>=b)break;if(F=pr(E.slice(Ae,b),!0),k=F.r!=null?parseInt(F.r,10):k+1,S=-1,!(d.sheetRows&&d.sheetRows<k)){g.s.r>k-1&&(g.s.r=k-1),g.e.r<k-1&&(g.e.r=k-1),d&&d.cellStyles&&(X={},xe=!1,F.ht&&(xe=!0,X.hpt=parseFloat(F.ht),X.hpx=Z0(X.hpt)),F.hidden=="1"&&(xe=!0,X.hidden=!0),F.outlineLevel!=null&&(xe=!0,X.level=+F.outlineLevel),xe&&(Z[k-1]=X)),A=E.slice(b).split(t);for(var _e=0;_e!=A.length&&A[_e].trim().charAt(0)=="<";++_e);for(A=A.slice(_e),b=0;b!=A.length;++b)if(E=A[b].trim(),E.length!==0){if(O=E.match(r),M=b,B=0,Q=0,E="<c "+(E.slice(0,1)=="<"?">":"")+E,O!=null&&O.length===2){for(M=0,ee=O[1],B=0;B!=ee.length&&!((Q=ee.charCodeAt(B)-64)<1||Q>26);++B)M=26*M+Q;--M,S=M}else++S;for(B=0;B!=E.length&&E.charCodeAt(B)!==62;++B);if(++B,F=pr(E.slice(0,B),!0),F.r||(F.r=ur({r:k-1,c:S})),ee=E.slice(B),he={t:""},(O=ee.match(a))!=null&&O[1]!==""&&(he.v=tn(O[1])),d.cellFormula){if((O=ee.match(o))!=null&&O[1]!==""){if(he.f=tn(Cn(O[1])).replace(/\r\n/g,`
`),d.xlfn||(he.f=X3(he.f)),O[0].indexOf('t="array"')>-1)he.F=(ee.match(i)||[])[1],he.F.indexOf(":")>-1&&J.push([rn(he.F),he.F]);else if(O[0].indexOf('t="shared"')>-1){I=pr(O[0]);var Ee=tn(Cn(O[1]));d.xlfn||(Ee=X3(Ee)),de[parseInt(I.si,10)]=[I,Ee,F.r]}}else(O=ee.match(/<f[^>]*\/>/))&&(I=pr(O[0]),de[I.si]&&(he.f=NU(de[I.si][1],de[I.si][2],F.r)));var Ce=ti(F.r);for(B=0;B<J.length;++B)Ce.r>=J[B][0].s.r&&Ce.r<=J[B][0].e.r&&Ce.c>=J[B][0].s.c&&Ce.c<=J[B][0].e.c&&(he.F=J[B][1])}if(F.t==null&&he.v===void 0)if(he.f||he.F)he.v=0,he.t="n";else if(L)he.t="z";else continue;else he.t=F.t||"n";switch(g.s.c>S&&(g.s.c=S),g.e.c<S&&(g.e.c=S),he.t){case"n":if(he.v==""||he.v==null){if(!L)continue;he.t="z"}else he.v=parseFloat(he.v);break;case"s":if(typeof he.v>"u"){if(!L)continue;he.t="z"}else U=w1[parseInt(he.v,10)],he.v=U.t,he.r=U.r,d.cellHTML&&(he.h=U.h);break;case"str":he.t="s",he.v=he.v!=null?Cn(he.v):"",d.cellHTML&&(he.h=Iy(he.v));break;case"inlineStr":O=ee.match(n),he.t="s",O!=null&&(U=Hy(O[1]))?(he.v=U.t,d.cellHTML&&(he.h=U.h)):he.v="";break;case"b":he.v=jn(he.v);break;case"d":d.cellDates?he.v=qn(he.v,1):(he.v=Zi(qn(he.v,1)),he.t="n");break;case"e":(!d||d.cellText!==!1)&&(he.w=he.v),he.v=l6[he.v];break}if(C=R=0,ne=null,se&&F.s!==void 0&&(ne=_.CellXf[F.s],ne!=null&&(ne.numFmtId!=null&&(C=ne.numFmtId),d.cellStyles&&ne.fillId!=null&&(R=ne.fillId))),ak(he,C,R,d,x,_),d.cellDates&&se&&he.t=="n"&&cd(sr[C])&&(he.t="d",he.v=g2(he.v)),F.cm&&d.xlmeta){var Oe=(d.xlmeta.Cell||[])[+F.cm-1];Oe&&Oe.type=="XLDAPR"&&(he.D=!0)}if(oe){var fe=ti(F.r);h[fe.r]||(h[fe.r]=[]),h[fe.r][fe.c]=he}else h[F.r]=he}}}}Z.length>0&&(h["!rows"]=Z)}}();function Dq(t,e,r,n){var i=[],a=[],o=rn(t["!ref"]),c="",u,h="",d=[],g=0,x=0,_=t["!rows"],b=Array.isArray(t),E={r:h},A,O=-1;for(x=o.s.c;x<=o.e.c;++x)d[x]=ei(x);for(g=o.s.r;g<=o.e.r;++g){for(a=[],h=Ni(g),x=o.s.c;x<=o.e.c;++x){u=d[x]+h;var M=b?(t[g]||[])[x]:t[u];M!==void 0&&(c=Rq(M,u,t,e))!=null&&a.push(c)}(a.length>0||_&&_[g])&&(E={r:h},_&&_[g]&&(A=_[g],A.hidden&&(E.hidden=1),O=-1,A.hpx?O=X1(A.hpx):A.hpt&&(O=A.hpt),O>-1&&(E.ht=O,E.customHeight=1),A.level&&(E.outlineLevel=A.level)),i[i.length]=Ct("row",a.join(""),E))}if(_)for(;g<_.length;++g)_&&_[g]&&(E={r:g+1},A=_[g],A.hidden&&(E.hidden=1),O=-1,A.hpx?O=X1(A.hpx):A.hpt&&(O=A.hpt),O>-1&&(E.ht=O,E.customHeight=1),A.level&&(E.outlineLevel=A.level),i[i.length]=Ct("row","",E));return i.join("")}function ok(t,e,r,n){var i=[Ci,Ct("worksheet",null,{xmlns:Oh[0],"xmlns:r":Qi.r})],a=r.SheetNames[t],o=0,c="",u=r.Sheets[a];u==null&&(u={});var h=u["!ref"]||"A1",d=rn(h);if(d.e.c>16383||d.e.r>1048575){if(e.WTF)throw new Error("Range "+h+" exceeds format limit A1:XFD1048576");d.e.c=Math.min(d.e.c,16383),d.e.r=Math.min(d.e.c,1048575),h=wr(d)}n||(n={}),u["!comments"]=[];var g=[];vq(u,r,t,e,i),i[i.length]=Ct("dimension",null,{ref:h}),i[i.length]=Iq(u,e,t,r),e.sheetFormat&&(i[i.length]=Ct("sheetFormatPr",null,{defaultRowHeight:e.sheetFormat.defaultRowHeight||"16",baseColWidth:e.sheetFormat.baseColWidth||"10",outlineLevelRow:e.sheetFormat.outlineLevelRow||"7"})),u["!cols"]!=null&&u["!cols"].length>0&&(i[i.length]=Aq(u,u["!cols"])),i[o=i.length]="<sheetData/>",u["!links"]=[],u["!ref"]!=null&&(c=Dq(u,e),c.length>0&&(i[i.length]=c)),i.length>o+1&&(i[i.length]="</sheetData>",i[o]=i[o].replace("/>",">")),u["!protect"]&&(i[i.length]=yq(u["!protect"])),u["!autofilter"]!=null&&(i[i.length]=kq(u["!autofilter"],u,r,t)),u["!merges"]!=null&&u["!merges"].length>0&&(i[i.length]=mq(u["!merges"]));var x=-1,_,b=-1;return u["!links"].length>0&&(i[i.length]="<hyperlinks>",u["!links"].forEach(function(E){E[1].Target&&(_={ref:E[0]},E[1].Target.charAt(0)!="#"&&(b=En(n,-1,bn(E[1].Target).replace(/#.*$/,""),Br.HLINK),_["r:id"]="rId"+b),(x=E[1].Target.indexOf("#"))>-1&&(_.location=bn(E[1].Target.slice(x+1))),E[1].Tooltip&&(_.tooltip=bn(E[1].Tooltip)),i[i.length]=Ct("hyperlink",null,_))}),i[i.length]="</hyperlinks>"),delete u["!links"],u["!margins"]!=null&&(i[i.length]=bq(u["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&(i[i.length]=Ca("ignoredErrors",Ct("ignoredError",null,{numberStoredAsText:1,sqref:h}))),g.length>0&&(b=En(n,-1,"../drawings/drawing"+(t+1)+".xml",Br.DRAW),i[i.length]=Ct("drawing",null,{"r:id":"rId"+b}),u["!drawing"]=g),u["!comments"].length>0&&(b=En(n,-1,"../drawings/vmlDrawing"+(t+1)+".vml",Br.VML),i[i.length]=Ct("legacyDrawing",null,{"r:id":"rId"+b}),u["!legacy"]=b),i.length>1&&(i[i.length]="</worksheet>",i[1]=i[1].replace("/>",">")),i.join("")}function Fq(t,e){var r={},n=t.l+e;r.r=t.read_shift(4),t.l+=4;var i=t.read_shift(2);t.l+=1;var a=t.read_shift(1);return t.l=n,a&7&&(r.level=a&7),a&16&&(r.hidden=!0),a&32&&(r.hpt=i/20),r}function Oq(t,e,r){var n=it(145),i=(r["!rows"]||[])[t]||{};n.write_shift(4,t),n.write_shift(4,0);var a=320;i.hpx?a=X1(i.hpx)*20:i.hpt&&(a=i.hpt*20),n.write_shift(2,a),n.write_shift(1,0);var o=0;i.level&&(o|=i.level),i.hidden&&(o|=16),(i.hpx||i.hpt)&&(o|=32),n.write_shift(1,o),n.write_shift(1,0);var c=0,u=n.l;n.l+=4;for(var h={r:t,c:0},d=0;d<16;++d)if(!(e.s.c>d+1<<10||e.e.c<d<<10)){for(var g=-1,x=-1,_=d<<10;_<d+1<<10;++_){h.c=_;var b=Array.isArray(r)?(r[h.r]||[])[h.c]:r[ur(h)];b&&(g<0&&(g=_),x=_)}g<0||(++c,n.write_shift(4,g),n.write_shift(4,x))}var E=n.l;return n.l=u,n.write_shift(4,c),n.l=E,n.length>n.l?n.slice(0,n.l):n}function Pq(t,e,r,n){var i=Oq(n,r,e);(i.length>17||(e["!rows"]||[])[n])&&xt(t,0,i)}var Mq=jh,Bq=hd;function jq(){}function Uq(t,e){var r={},n=t[t.l];return++t.l,r.above=!(n&64),r.left=!(n&128),t.l+=18,r.name=zP(t),r}function Vq(t,e,r){r==null&&(r=it(84+4*t.length));var n=192;e&&(e.above&&(n&=-65),e.left&&(n&=-129)),r.write_shift(1,n);for(var i=1;i<3;++i)r.write_shift(1,0);return Fg({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),n6(t,r),r.slice(0,r.l)}function qq(t){var e=qo(t);return[e]}function zq(t,e,r){return r==null&&(r=it(8)),Ph(e,r)}function Hq(t){var e=Mh(t);return[e]}function Gq(t,e,r){return r==null&&(r=it(4)),Bh(e,r)}function Wq(t){var e=qo(t),r=t.read_shift(1);return[e,r,"b"]}function Xq(t,e,r){return r==null&&(r=it(9)),Ph(e,r),r.write_shift(1,t.v?1:0),r}function Yq(t){var e=Mh(t),r=t.read_shift(1);return[e,r,"b"]}function Kq(t,e,r){return r==null&&(r=it(5)),Bh(e,r),r.write_shift(1,t.v?1:0),r}function $q(t){var e=qo(t),r=t.read_shift(1);return[e,r,"e"]}function Qq(t,e,r){return r==null&&(r=it(9)),Ph(e,r),r.write_shift(1,t.v),r}function Jq(t){var e=Mh(t),r=t.read_shift(1);return[e,r,"e"]}function Zq(t,e,r){return r==null&&(r=it(8)),Bh(e,r),r.write_shift(1,t.v),r.write_shift(2,0),r.write_shift(1,0),r}function ez(t){var e=qo(t),r=t.read_shift(4);return[e,r,"s"]}function tz(t,e,r){return r==null&&(r=it(12)),Ph(e,r),r.write_shift(4,e.v),r}function rz(t){var e=Mh(t),r=t.read_shift(4);return[e,r,"s"]}function nz(t,e,r){return r==null&&(r=it(8)),Bh(e,r),r.write_shift(4,e.v),r}function iz(t){var e=qo(t),r=es(t);return[e,r,"n"]}function az(t,e,r){return r==null&&(r=it(16)),Ph(e,r),Th(t.v,r),r}function lk(t){var e=Mh(t),r=es(t);return[e,r,"n"]}function sz(t,e,r){return r==null&&(r=it(12)),Bh(e,r),Th(t.v,r),r}function oz(t){var e=qo(t),r=jy(t);return[e,r,"n"]}function lz(t,e,r){return r==null&&(r=it(12)),Ph(e,r),i6(t.v,r),r}function cz(t){var e=Mh(t),r=jy(t);return[e,r,"n"]}function uz(t,e,r){return r==null&&(r=it(8)),Bh(e,r),i6(t.v,r),r}function fz(t){var e=qo(t),r=Py(t);return[e,r,"is"]}function hz(t){var e=qo(t),r=rs(t);return[e,r,"str"]}function dz(t,e,r){return r==null&&(r=it(12+4*t.v.length)),Ph(e,r),pa(t.v,r),r.length>r.l?r.slice(0,r.l):r}function pz(t){var e=Mh(t),r=rs(t);return[e,r,"str"]}function mz(t,e,r){return r==null&&(r=it(8+4*t.v.length)),Bh(e,r),pa(t.v,r),r.length>r.l?r.slice(0,r.l):r}function gz(t,e,r){var n=t.l+e,i=qo(t);i.r=r["!row"];var a=t.read_shift(1),o=[i,a,"b"];if(r.cellFormula){t.l+=2;var c=x2(t,n-t.l,r);o[3]=Qa(c,null,i,r.supbooks,r)}else t.l=n;return o}function vz(t,e,r){var n=t.l+e,i=qo(t);i.r=r["!row"];var a=t.read_shift(1),o=[i,a,"e"];if(r.cellFormula){t.l+=2;var c=x2(t,n-t.l,r);o[3]=Qa(c,null,i,r.supbooks,r)}else t.l=n;return o}function _z(t,e,r){var n=t.l+e,i=qo(t);i.r=r["!row"];var a=es(t),o=[i,a,"n"];if(r.cellFormula){t.l+=2;var c=x2(t,n-t.l,r);o[3]=Qa(c,null,i,r.supbooks,r)}else t.l=n;return o}function xz(t,e,r){var n=t.l+e,i=qo(t);i.r=r["!row"];var a=rs(t),o=[i,a,"str"];if(r.cellFormula){t.l+=2;var c=x2(t,n-t.l,r);o[3]=Qa(c,null,i,r.supbooks,r)}else t.l=n;return o}var yz=jh,wz=hd;function Ez(t,e){return e==null&&(e=it(4)),e.write_shift(4,t),e}function bz(t,e){var r=t.l+e,n=jh(t),i=My(t),a=rs(t),o=rs(t),c=rs(t);t.l=r;var u={rfx:n,relId:i,loc:a,display:c};return o&&(u.Tooltip=o),u}function Sz(t,e){var r=it(50+4*(t[1].Target.length+(t[1].Tooltip||"").length));hd({s:ti(t[0]),e:ti(t[0])},r),By("rId"+e,r);var n=t[1].Target.indexOf("#"),i=n==-1?"":t[1].Target.slice(n+1);return pa(i||"",r),pa(t[1].Tooltip||"",r),pa("",r),r.slice(0,r.l)}function Az(){}function Tz(t,e,r){var n=t.l+e,i=a6(t),a=t.read_shift(1),o=[i];if(o[2]=a,r.cellFormula){var c=$V(t,n-t.l,r);o[1]=c}else t.l=n;return o}function kz(t,e,r){var n=t.l+e,i=jh(t),a=[i];if(r.cellFormula){var o=JV(t,n-t.l,r);a[1]=o,t.l=n}else t.l=n;return a}function Nz(t,e,r){r==null&&(r=it(18));var n=y2(t,e);r.write_shift(-4,t),r.write_shift(-4,t),r.write_shift(4,(n.width||10)*256),r.write_shift(4,0);var i=0;return e.hidden&&(i|=1),typeof n.width=="number"&&(i|=2),e.level&&(i|=e.level<<8),r.write_shift(2,i),r}var ck=["left","right","top","bottom","header","footer"];function Cz(t){var e={};return ck.forEach(function(r){e[r]=es(t)}),e}function Iz(t,e){return e==null&&(e=it(6*8)),gh(t),ck.forEach(function(r){Th(t[r],e)}),e}function Rz(t){var e=t.read_shift(2);return t.l+=28,{RTL:e&32}}function Lz(t,e,r){r==null&&(r=it(30));var n=924;return(((e||{}).Views||[])[0]||{}).RTL&&(n|=32),r.write_shift(2,n),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function Dz(t){var e=it(24);return e.write_shift(4,4),e.write_shift(4,1),hd(t,e),e}function Fz(t,e){return e==null&&(e=it(16*4+2)),e.write_shift(2,t.password?Gy(t.password):0),e.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?e.write_shift(4,t[r[0]]!=null&&!t[r[0]]?1:0):e.write_shift(4,t[r[0]]!=null&&t[r[0]]?0:1)}),e}function Oz(){}function Pz(){}function Mz(t,e,r,n,i,a,o){if(!t)return t;var c=e||{};n||(n={"!id":{}});var u=c.dense?[]:{},h,d={s:{r:2e6,c:2e6},e:{r:0,c:0}},g=!1,x=!1,_,b,E,A,O,M,B,Q,ee,he=[];c.biff=12,c["!row"]=0;var F=0,k=!1,S=[],U={},I=c.supbooks||i.supbooks||[[]];if(I.sharedf=U,I.arrayf=S,I.SheetNames=i.SheetNames||i.Sheets.map(function(oe){return oe.name}),!c.supbooks&&(c.supbooks=I,i.Names))for(var C=0;C<i.Names.length;++C)I[0][C+1]=i.Names[C];var R=[],se=[],ne=!1;Y1[16]={n:"BrtShortReal",f:lk};var J;if(hu(t,function(Z,X,xe){if(!x)switch(xe){case 148:h=Z;break;case 0:_=Z,c.sheetRows&&c.sheetRows<=_.r&&(x=!0),Q=Ni(A=_.r),c["!row"]=_.r,(Z.hidden||Z.hpt||Z.level!=null)&&(Z.hpt&&(Z.hpx=Z0(Z.hpt)),se[Z.r]=Z);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(b={t:Z[2]},Z[2]){case"n":b.v=Z[1];break;case"s":B=w1[Z[1]],b.v=B.t,b.r=B.r;break;case"b":b.v=!!Z[1];break;case"e":b.v=Z[1],c.cellText!==!1&&(b.w=du[b.v]);break;case"str":b.t="s",b.v=Z[1];break;case"is":b.t="s",b.v=Z[1].t;break}if((E=o.CellXf[Z[0].iStyleRef])&&ak(b,E.numFmtId,null,c,a,o),O=Z[0].c==-1?O+1:Z[0].c,c.dense?(u[A]||(u[A]=[]),u[A][O]=b):u[ei(O)+Q]=b,c.cellFormula){for(k=!1,F=0;F<S.length;++F){var L=S[F];_.r>=L[0].s.r&&_.r<=L[0].e.r&&O>=L[0].s.c&&O<=L[0].e.c&&(b.F=wr(L[0]),k=!0)}!k&&Z.length>3&&(b.f=Z[3])}if(d.s.r>_.r&&(d.s.r=_.r),d.s.c>O&&(d.s.c=O),d.e.r<_.r&&(d.e.r=_.r),d.e.c<O&&(d.e.c=O),c.cellDates&&E&&b.t=="n"&&cd(sr[E.numFmtId])){var j=uh(b.v);j&&(b.t="d",b.v=new Date(j.y,j.m-1,j.d,j.H,j.M,j.S,j.u))}J&&(J.type=="XLDAPR"&&(b.D=!0),J=void 0);break;case 1:case 12:if(!c.sheetStubs||g)break;b={t:"z",v:void 0},O=Z[0].c==-1?O+1:Z[0].c,c.dense?(u[A]||(u[A]=[]),u[A][O]=b):u[ei(O)+Q]=b,d.s.r>_.r&&(d.s.r=_.r),d.s.c>O&&(d.s.c=O),d.e.r<_.r&&(d.e.r=_.r),d.e.c<O&&(d.e.c=O),J&&(J.type=="XLDAPR"&&(b.D=!0),J=void 0);break;case 176:he.push(Z);break;case 49:J=((c.xlmeta||{}).Cell||[])[Z-1];break;case 494:var z=n["!id"][Z.relId];for(z?(Z.Target=z.Target,Z.loc&&(Z.Target+="#"+Z.loc),Z.Rel=z):Z.relId==""&&(Z.Target="#"+Z.loc),A=Z.rfx.s.r;A<=Z.rfx.e.r;++A)for(O=Z.rfx.s.c;O<=Z.rfx.e.c;++O)c.dense?(u[A]||(u[A]=[]),u[A][O]||(u[A][O]={t:"z",v:void 0}),u[A][O].l=Z):(M=ur({c:O,r:A}),u[M]||(u[M]={t:"z",v:void 0}),u[M].l=Z);break;case 426:if(!c.cellFormula)break;S.push(Z),ee=c.dense?u[A][O]:u[ei(O)+Q],ee.f=Qa(Z[1],d,{r:_.r,c:O},I,c),ee.F=wr(Z[0]);break;case 427:if(!c.cellFormula)break;U[ur(Z[0].s)]=Z[1],ee=c.dense?u[A][O]:u[ei(O)+Q],ee.f=Qa(Z[1],d,{r:_.r,c:O},I,c);break;case 60:if(!c.cellStyles)break;for(;Z.e>=Z.s;)R[Z.e--]={width:Z.w/256,hidden:!!(Z.flags&1),level:Z.level},ne||(ne=!0,Wy(Z.w/256)),Ef(R[Z.e+1]);break;case 161:u["!autofilter"]={ref:wr(Z)};break;case 476:u["!margins"]=Z;break;case 147:i.Sheets[r]||(i.Sheets[r]={}),Z.name&&(i.Sheets[r].CodeName=Z.name),(Z.above||Z.left)&&(u["!outline"]={above:Z.above,left:Z.left});break;case 137:i.Views||(i.Views=[{}]),i.Views[0]||(i.Views[0]={}),Z.RTL&&(i.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:g=!0;break;case 36:g=!1;break;case 37:g=!0;break;case 38:g=!1;break;default:if(!X.T){if(!g||c.WTF)throw new Error("Unexpected record 0x"+xe.toString(16))}}},c),delete c.supbooks,delete c["!row"],!u["!ref"]&&(d.s.r<2e6||h&&(h.e.r>0||h.e.c>0||h.s.r>0||h.s.c>0))&&(u["!ref"]=wr(h||d)),c.sheetRows&&u["!ref"]){var de=rn(u["!ref"]);c.sheetRows<=+de.e.r&&(de.e.r=c.sheetRows-1,de.e.r>d.e.r&&(de.e.r=d.e.r),de.e.r<de.s.r&&(de.s.r=de.e.r),de.e.c>d.e.c&&(de.e.c=d.e.c),de.e.c<de.s.c&&(de.s.c=de.e.c),u["!fullref"]=u["!ref"],u["!ref"]=wr(de))}return he.length>0&&(u["!merges"]=he),R.length>0&&(u["!cols"]=R),se.length>0&&(u["!rows"]=se),u}function Bz(t,e,r,n,i,a,o){if(e.v===void 0)return!1;var c="";switch(e.t){case"b":c=e.v?"1":"0";break;case"d":e=zn(e),e.z=e.z||sr[14],e.v=Zi(qn(e.v)),e.t="n";break;case"n":case"e":c=""+e.v;break;default:c=e.v;break}var u={r,c:n};switch(u.s=Of(i.cellXfs,e,i),e.l&&a["!links"].push([ur(u),e.l]),e.c&&a["!comments"].push([ur(u),e.c]),e.t){case"s":case"str":return i.bookSST?(c=Qy(i.Strings,e.v,i.revStrings),u.t="s",u.v=c,o?xt(t,18,nz(e,u)):xt(t,7,tz(e,u))):(u.t="str",o?xt(t,17,mz(e,u)):xt(t,6,dz(e,u))),!0;case"n":return e.v==(e.v|0)&&e.v>-1e3&&e.v<1e3?o?xt(t,13,uz(e,u)):xt(t,2,lz(e,u)):o?xt(t,16,sz(e,u)):xt(t,5,az(e,u)),!0;case"b":return u.t="b",o?xt(t,15,Kq(e,u)):xt(t,4,Xq(e,u)),!0;case"e":return u.t="e",o?xt(t,14,Zq(e,u)):xt(t,3,Qq(e,u)),!0}return o?xt(t,12,Gq(e,u)):xt(t,1,zq(e,u)),!0}function jz(t,e,r,n){var i=rn(e["!ref"]||"A1"),a,o="",c=[];xt(t,145);var u=Array.isArray(e),h=i.e.r;e["!rows"]&&(h=Math.max(i.e.r,e["!rows"].length-1));for(var d=i.s.r;d<=h;++d){o=Ni(d),Pq(t,e,i,d);var g=!1;if(d<=i.e.r)for(var x=i.s.c;x<=i.e.c;++x){d===i.s.r&&(c[x]=ei(x)),a=c[x]+o;var _=u?(e[d]||[])[x]:e[a];if(!_){g=!1;continue}g=Bz(t,_,d,x,n,e,g)}}xt(t,146)}function Uz(t,e){!e||!e["!merges"]||(xt(t,177,Ez(e["!merges"].length)),e["!merges"].forEach(function(r){xt(t,176,wz(r))}),xt(t,178))}function Vz(t,e){!e||!e["!cols"]||(xt(t,390),e["!cols"].forEach(function(r,n){r&&xt(t,60,Nz(n,r))}),xt(t,391))}function qz(t,e){!e||!e["!ref"]||(xt(t,648),xt(t,649,Dz(rn(e["!ref"]))),xt(t,650))}function zz(t,e,r){e["!links"].forEach(function(n){if(n[1].Target){var i=En(r,-1,n[1].Target.replace(/#.*$/,""),Br.HLINK);xt(t,494,Sz(n,i))}}),delete e["!links"]}function Hz(t,e,r,n){if(e["!comments"].length>0){var i=En(n,-1,"../drawings/vmlDrawing"+(r+1)+".vml",Br.VML);xt(t,551,By("rId"+i)),e["!legacy"]=i}}function Gz(t,e,r,n){if(e["!autofilter"]){var i=e["!autofilter"],a=typeof i.ref=="string"?i.ref:wr(i.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var o=r.Workbook.Names,c=Ds(a);c.s.r==c.e.r&&(c.e.r=Ds(e["!ref"]).e.r,a=wr(c));for(var u=0;u<o.length;++u){var h=o[u];if(h.Name=="_xlnm._FilterDatabase"&&h.Sheet==n){h.Ref="'"+r.SheetNames[n]+"'!"+a;break}}u==o.length&&o.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+a}),xt(t,161,hd(rn(a))),xt(t,162)}}function Wz(t,e,r){xt(t,133),xt(t,137,Lz(e,r)),xt(t,138),xt(t,134)}function Xz(t,e){e["!protect"]&&xt(t,535,Fz(e["!protect"]))}function Yz(t,e,r,n){var i=Ls(),a=r.SheetNames[t],o=r.Sheets[a]||{},c=a;try{r&&r.Workbook&&(c=r.Workbook.Sheets[t].CodeName||c)}catch{}var u=rn(o["!ref"]||"A1");if(u.e.c>16383||u.e.r>1048575){if(e.WTF)throw new Error("Range "+(o["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");u.e.c=Math.min(u.e.c,16383),u.e.r=Math.min(u.e.c,1048575)}return o["!links"]=[],o["!comments"]=[],xt(i,129),(r.vbaraw||o["!outline"])&&xt(i,147,Vq(c,o["!outline"])),xt(i,148,Bq(u)),Wz(i,o,r.Workbook),Vz(i,o),jz(i,o,t,e),Xz(i,o),Gz(i,o,r,t),Uz(i,o),zz(i,o,n),o["!margins"]&&xt(i,476,Iz(o["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&qz(i,o),Hz(i,o,t,n),xt(i,130),i.end()}function Kz(t){var e=[],r=t.match(/^<c:numCache>/),n;(t.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(a){var o=a.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);o&&(e[+o[1]]=r?+o[2]:o[2])});var i=tn((t.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(t.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(a){n=a.replace(/<.*?>/g,"")}),[e,i,n]}function $z(t,e,r,n,i,a){var o=a||{"!type":"chart"};if(!t)return a;var c=0,u=0,h="A",d={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(t.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(g){var x=Kz(g);d.s.r=d.s.c=0,d.e.c=c,h=ei(c),x[0].forEach(function(_,b){o[h+Ni(b)]={t:"n",v:_,z:x[1]},u=b}),d.e.r<u&&(d.e.r=u),++c}),c>0&&(o["!ref"]=wr(d)),o}function Qz(t,e,r,n,i){if(!t)return t;n||(n={"!id":{}});var a={"!type":"chart","!drawel":null,"!rel":""},o,c=t.match(sk);return c&&Jy(c[0],a,i,r),(o=t.match(/drawing r:id="(.*?)"/))&&(a["!rel"]=o[1]),n["!id"][a["!rel"]]&&(a["!drawel"]=n["!id"][a["!rel"]]),a}function Jz(t,e){t.l+=10;var r=rs(t);return{name:r}}function Zz(t,e,r,n,i){if(!t)return t;n||(n={"!id":{}});var a={"!type":"chart","!drawel":null,"!rel":""},o=!1;return hu(t,function(u,h,d){switch(d){case 550:a["!rel"]=u;break;case 651:i.Sheets[r]||(i.Sheets[r]={}),u.name&&(i.Sheets[r].CodeName=u.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:break;case 38:break;default:if(!(h.T>0)){if(!(h.T<0)){if(!o||e.WTF)throw new Error("Unexpected record 0x"+d.toString(16))}}}},e),n["!id"][a["!rel"]]&&(a["!drawel"]=n["!id"][a["!rel"]]),a}var Zy=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],eH=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],tH=[],rH=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function J3(t,e){for(var r=0;r!=t.length;++r)for(var n=t[r],i=0;i!=e.length;++i){var a=e[i];if(n[a[0]]==null)n[a[0]]=a[1];else switch(a[2]){case"bool":typeof n[a[0]]=="string"&&(n[a[0]]=jn(n[a[0]]));break;case"int":typeof n[a[0]]=="string"&&(n[a[0]]=parseInt(n[a[0]],10));break}}}function Z3(t,e){for(var r=0;r!=e.length;++r){var n=e[r];if(t[n[0]]==null)t[n[0]]=n[1];else switch(n[2]){case"bool":typeof t[n[0]]=="string"&&(t[n[0]]=jn(t[n[0]]));break;case"int":typeof t[n[0]]=="string"&&(t[n[0]]=parseInt(t[n[0]],10));break}}}function uk(t){Z3(t.WBProps,Zy),Z3(t.CalcPr,rH),J3(t.WBView,eH),J3(t.Sheets,tH),U0.date1904=jn(t.WBProps.date1904)}function nH(t){return!t.Workbook||!t.Workbook.WBProps?"false":jn(t.Workbook.WBProps.date1904)?"true":"false"}var iH="][*?/\\".split("");function fk(t,e){if(t.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return iH.forEach(function(n){if(t.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}function aH(t,e,r){t.forEach(function(n,i){fk(n);for(var a=0;a<i;++a)if(n==t[a])throw new Error("Duplicate Sheet Name: "+n);if(r){var o=e&&e[i]&&e[i].CodeName||n;if(o.charCodeAt(0)==95&&o.length>22)throw new Error("Bad Code Name: Worksheet"+o)}})}function sH(t){if(!t||!t.SheetNames||!t.Sheets)throw new Error("Invalid Workbook");if(!t.SheetNames.length)throw new Error("Workbook is empty");var e=t.Workbook&&t.Workbook.Sheets||[];aH(t.SheetNames,e,!!t.vbaraw);for(var r=0;r<t.SheetNames.length;++r)nq(t.Sheets[t.SheetNames[r]],t.SheetNames[r],r)}var oH=/<\w+:workbook/;function lH(t,e){if(!t)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,i="xmlns",a={},o=0;if(t.replace(as,function(u,h){var d=pr(u);switch(vc(d[0])){case"<?xml":break;case"<workbook":u.match(oH)&&(i="xmlns"+u.match(/<(\w+):/)[1]),r.xmlns=d[i];break;case"</workbook>":break;case"<fileVersion":delete d[0],r.AppVersion=d;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":Zy.forEach(function(g){if(d[g[0]]!=null)switch(g[2]){case"bool":r.WBProps[g[0]]=jn(d[g[0]]);break;case"int":r.WBProps[g[0]]=parseInt(d[g[0]],10);break;default:r.WBProps[g[0]]=d[g[0]]}}),d.codeName&&(r.WBProps.CodeName=Cn(d.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete d[0],r.WBView.push(d);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(d.state){case"hidden":d.Hidden=1;break;case"veryHidden":d.Hidden=2;break;default:d.Hidden=0}delete d.state,d.name=tn(Cn(d.name)),delete d[0],r.Sheets.push(d);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":a={},a.Name=Cn(d.name),d.comment&&(a.Comment=d.comment),d.localSheetId&&(a.Sheet=+d.localSheetId),jn(d.hidden||"0")&&(a.Hidden=!0),o=h+u.length;break;case"</definedName>":a.Ref=tn(Cn(t.slice(o,h))),r.Names.push(a);break;case"<definedName/>":break;case"<calcPr":delete d[0],r.CalcPr=d;break;case"<calcPr/>":delete d[0],r.CalcPr=d;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&e.WTF)throw new Error("unrecognized "+d[0]+" in workbook")}return u}),Oh.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return uk(r),r}function hk(t){var e=[Ci];e[e.length]=Ct("workbook",null,{xmlns:Oh[0],"xmlns:r":Qi.r});var r=t.Workbook&&(t.Workbook.Names||[]).length>0,n={codeName:"ThisWorkbook"};t.Workbook&&t.Workbook.WBProps&&(Zy.forEach(function(c){t.Workbook.WBProps[c[0]]!=null&&t.Workbook.WBProps[c[0]]!=c[1]&&(n[c[0]]=t.Workbook.WBProps[c[0]])}),t.Workbook.WBProps.CodeName&&(n.codeName=t.Workbook.WBProps.CodeName,delete n.CodeName)),e[e.length]=Ct("workbookPr",null,n);var i=t.Workbook&&t.Workbook.Sheets||[],a=0;if(i&&i[0]&&i[0].Hidden){for(e[e.length]="<bookViews>",a=0;a!=t.SheetNames.length&&!(!i[a]||!i[a].Hidden);++a);a==t.SheetNames.length&&(a=0),e[e.length]='<workbookView firstSheet="'+a+'" activeTab="'+a+'"/>',e[e.length]="</bookViews>"}for(e[e.length]="<sheets>",a=0;a!=t.SheetNames.length;++a){var o={name:bn(t.SheetNames[a].slice(0,31))};if(o.sheetId=""+(a+1),o["r:id"]="rId"+(a+1),i[a])switch(i[a].Hidden){case 1:o.state="hidden";break;case 2:o.state="veryHidden";break}e[e.length]=Ct("sheet",null,o)}return e[e.length]="</sheets>",r&&(e[e.length]="<definedNames>",t.Workbook&&t.Workbook.Names&&t.Workbook.Names.forEach(function(c){var u={name:c.Name};c.Comment&&(u.comment=c.Comment),c.Sheet!=null&&(u.localSheetId=""+c.Sheet),c.Hidden&&(u.hidden="1"),c.Ref&&(e[e.length]=Ct("definedName",bn(c.Ref),u))}),e[e.length]="</definedNames>"),e.length>2&&(e[e.length]="</workbook>",e[1]=e[1].replace("/>",">")),e.join("")}function cH(t,e){var r={};return r.Hidden=t.read_shift(4),r.iTabID=t.read_shift(4),r.strRelID=$_(t),r.name=rs(t),r}function uH(t,e){return e||(e=it(127)),e.write_shift(4,t.Hidden),e.write_shift(4,t.iTabID),By(t.strRelID,e),pa(t.name.slice(0,31),e),e.length>e.l?e.slice(0,e.l):e}function fH(t,e){var r={},n=t.read_shift(4);r.defaultThemeVersion=t.read_shift(4);var i=e>8?rs(t):"";return i.length>0&&(r.CodeName=i),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function hH(t,e){e||(e=it(72));var r=0;return t&&t.filterPrivacy&&(r|=8),e.write_shift(4,r),e.write_shift(4,0),n6(t&&t.CodeName||"ThisWorkbook",e),e.slice(0,e.l)}function dH(t,e){var r={};return t.read_shift(4),r.ArchID=t.read_shift(4),t.l+=e-8,r}function pH(t,e,r){var n=t.l+e;t.l+=4,t.l+=1;var i=t.read_shift(4),a=HP(t),o=QV(t,0,r),c=My(t);t.l=n;var u={Name:a,Ptg:o};return i<268435455&&(u.Sheet=i),c&&(u.Comment=c),u}function mH(t,e){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],i=!1;e||(e={}),e.biff=12;var a=[],o=[[]];return o.SheetNames=[],o.XTI=[],Y1[16]={n:"BrtFRTArchID$",f:dH},hu(t,function(u,h,d){switch(d){case 156:o.SheetNames.push(u.name),r.Sheets.push(u);break;case 153:r.WBProps=u;break;case 39:u.Sheet!=null&&(e.SID=u.Sheet),u.Ref=Qa(u.Ptg,null,null,o,e),delete e.SID,delete u.Ptg,a.push(u);break;case 1036:break;case 357:case 358:case 355:case 667:o[0].length?o.push([d,u]):o[0]=[d,u],o[o.length-1].XTI=[];break;case 362:o.length===0&&(o[0]=[],o[0].XTI=[]),o[o.length-1].XTI=o[o.length-1].XTI.concat(u),o.XTI=o.XTI.concat(u);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(d),i=!0;break;case 36:n.pop(),i=!1;break;case 37:n.push(d),i=!0;break;case 38:n.pop(),i=!1;break;case 16:break;default:if(!h.T){if(!i||e.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+d.toString(16))}}},e),uk(r),r.Names=a,r.supbooks=o,r}function gH(t,e){xt(t,143);for(var r=0;r!=e.SheetNames.length;++r){var n=e.Workbook&&e.Workbook.Sheets&&e.Workbook.Sheets[r]&&e.Workbook.Sheets[r].Hidden||0,i={Hidden:n,iTabID:r+1,strRelID:"rId"+(r+1),name:e.SheetNames[r]};xt(t,156,uH(i))}xt(t,144)}function vH(t,e){e||(e=it(127));for(var r=0;r!=4;++r)e.write_shift(4,0);return pa("SheetJS",e),pa(kg.version,e),pa(kg.version,e),pa("7262",e),e.length>e.l?e.slice(0,e.l):e}function _H(t,e){e||(e=it(29)),e.write_shift(-4,0),e.write_shift(-4,460),e.write_shift(4,28800),e.write_shift(4,17600),e.write_shift(4,500),e.write_shift(4,t),e.write_shift(4,t);var r=120;return e.write_shift(1,r),e.length>e.l?e.slice(0,e.l):e}function xH(t,e){if(!(!e.Workbook||!e.Workbook.Sheets)){for(var r=e.Workbook.Sheets,n=0,i=-1,a=-1;n<r.length;++n)!r[n]||!r[n].Hidden&&i==-1?i=n:r[n].Hidden==1&&a==-1&&(a=n);a>i||(xt(t,135),xt(t,158,_H(i)),xt(t,136))}}function yH(t,e){var r=Ls();return xt(r,131),xt(r,128,vH()),xt(r,153,hH(t.Workbook&&t.Workbook.WBProps||null)),xH(r,t),gH(r,t),xt(r,132),r.end()}function wH(t,e,r){return e.slice(-4)===".bin"?mH(t,r):lH(t,r)}function EH(t,e,r,n,i,a,o,c){return e.slice(-4)===".bin"?Mz(t,n,r,i,a,o,c):pq(t,n,r,i,a,o,c)}function bH(t,e,r,n,i,a,o,c){return e.slice(-4)===".bin"?Zz(t,n,r,i,a):Qz(t,n,r,i,a)}function SH(t,e,r,n,i,a,o,c){return e.slice(-4)===".bin"?TU():kU()}function AH(t,e,r,n,i,a,o,c){return e.slice(-4)===".bin"?SU():AU()}function TH(t,e,r,n){return e.slice(-4)===".bin"?wj(t,r,n):cj(t,r,n)}function kH(t,e,r){return W6(t,r)}function NH(t,e,r){return e.slice(-4)===".bin"?NB(t,r):AB(t,r)}function CH(t,e,r){return e.slice(-4)===".bin"?xU(t,r):uU(t,r)}function IH(t,e,r){return e.slice(-4)===".bin"?oU(t):aU(t)}function RH(t,e,r,n){return r.slice(-4)===".bin"?lU(t,e,r,n):void 0}function LH(t,e,r){return e.slice(-4)===".bin"?rU(t,e,r):iU(t,e,r)}function DH(t,e,r){return(e.slice(-4)===".bin"?yH:hk)(t)}function FH(t,e,r,n,i){return(e.slice(-4)===".bin"?Yz:ok)(t,r,n,i)}function OH(t,e,r){return(e.slice(-4)===".bin"?Rj:H6)(t,r)}function PH(t,e,r){return(e.slice(-4)===".bin"?RB:P6)(t,r)}function MH(t,e,r){return(e.slice(-4)===".bin"?yU:K6)(t)}function BH(t){return(t.slice(-4)===".bin"?nU:X6)()}var dk=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,pk=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function hl(t,e){var r=t.split(/\s+/),n=[];if(n[0]=r[0],r.length===1)return n;var i=t.match(dk),a,o,c,u;if(i)for(u=0;u!=i.length;++u)a=i[u].match(pk),(o=a[1].indexOf(":"))===-1?n[a[1]]=a[2].slice(1,a[2].length-1):(a[1].slice(0,6)==="xmlns:"?c="xmlns"+a[1].slice(6):c=a[1].slice(o+1),n[c]=a[2].slice(1,a[2].length-1));return n}function jH(t){var e=t.split(/\s+/),r={};if(e.length===1)return r;var n=t.match(dk),i,a,o,c;if(n)for(c=0;c!=n.length;++c)i=n[c].match(pk),(a=i[1].indexOf(":"))===-1?r[i[1]]=i[2].slice(1,i[2].length-1):(i[1].slice(0,6)==="xmlns:"?o="xmlns"+i[1].slice(6):o=i[1].slice(a+1),r[o]=i[2].slice(1,i[2].length-1));return r}var b1;function UH(t,e){var r=b1[t]||tn(t);return r==="General"?Sh(e):Vo(r,e)}function VH(t,e,r,n){var i=n;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":i=jn(n);break;case"i2":case"int":i=parseInt(n,10);break;case"r4":case"float":i=parseFloat(n);break;case"date":case"dateTime.tz":i=qn(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}t[tn(e)]=i}function qH(t,e,r){if(t.t!=="z"){if(!r||r.cellText!==!1)try{t.t==="e"?t.w=t.w||du[t.v]:e==="General"?t.t==="n"?(t.v|0)===t.v?t.w=t.v.toString(10):t.w=j1(t.v):t.w=Sh(t.v):t.w=UH(e||"General",t.v)}catch(a){if(r.WTF)throw a}try{var n=b1[e]||e||"General";if(r.cellNF&&(t.z=n),r.cellDates&&t.t=="n"&&cd(n)){var i=uh(t.v);i&&(t.t="d",t.v=new Date(i.y,i.m-1,i.d,i.H,i.M,i.S,i.u))}}catch(a){if(r.WTF)throw a}}}function zH(t,e,r){if(r.cellStyles&&e.Interior){var n=e.Interior;n.Pattern&&(n.patternType=tj[n.Pattern]||n.Pattern)}t[e.ID]=e}function HH(t,e,r,n,i,a,o,c,u,h){var d="General",g=n.StyleID,x={};h=h||{};var _=[],b=0;for(g===void 0&&c&&(g=c.StyleID),g===void 0&&o&&(g=o.StyleID);a[g]!==void 0&&(a[g].nf&&(d=a[g].nf),a[g].Interior&&_.push(a[g].Interior),!!a[g].Parent);)g=a[g].Parent;switch(r.Type){case"Boolean":n.t="b",n.v=jn(t);break;case"String":n.t="s",n.r=g3(tn(t)),n.v=t.indexOf("<")>-1?tn(e||t).replace(/<.*?>/g,""):n.r;break;case"DateTime":t.slice(-1)!="Z"&&(t+="Z"),n.v=(qn(t)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),n.v!==n.v?n.v=tn(t):n.v<60&&(n.v=n.v-1),(!d||d=="General")&&(d="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+t),n.t||(n.t="n");break;case"Error":n.t="e",n.v=l6[t],h.cellText!==!1&&(n.w=t);break;default:t==""&&e==""?n.t="z":(n.t="s",n.v=g3(e||t));break}if(qH(n,d,h),h.cellFormula!==!1)if(n.Formula){var E=tn(n.Formula);E.charCodeAt(0)==61&&(E=E.slice(1)),n.f=j0(E,i),delete n.Formula,n.ArrayRange=="RC"?n.F=j0("RC:RC",i):n.ArrayRange&&(n.F=j0(n.ArrayRange,i),u.push([rn(n.F),n.F]))}else for(b=0;b<u.length;++b)i.r>=u[b][0].s.r&&i.r<=u[b][0].e.r&&i.c>=u[b][0].s.c&&i.c<=u[b][0].e.c&&(n.F=u[b][1]);h.cellStyles&&(_.forEach(function(A){!x.patternType&&A.patternType&&(x.patternType=A.patternType)}),n.s=x),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function GH(t){t.t=t.v||"",t.t=t.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.v=t.w=t.ixfe=void 0}function n_(t,e){var r=e||{};ud();var n=l1(Ry(t));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(n=Cn(n));var i=n.slice(0,1024).toLowerCase(),a=!1;if(i=i.replace(/".*?"/g,""),(i.indexOf(">")&1023)>Math.min(i.indexOf(",")&1023,i.indexOf(";")&1023)){var o=zn(r);return o.type="string",J0.to_workbook(n,o)}if(i.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(nt){i.indexOf("<"+nt)>=0&&(a=!0)}),a)return IG(n,r);b1={"General Number":"General","General Date":sr[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":sr[15],"Short Date":sr[14],"Long Time":sr[19],"Medium Time":sr[18],"Short Time":sr[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:sr[2],Standard:sr[4],Percent:sr[10],Scientific:sr[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var c,u=[],h,d={},g=[],x=r.dense?[]:{},_="",b={},E={},A=hl('<Data ss:Type="String">'),O=0,M=0,B=0,Q={s:{r:2e6,c:2e6},e:{r:0,c:0}},ee={},he={},F="",k=0,S=[],U={},I={},C=0,R=[],se=[],ne={},J=[],de,oe=!1,Z=[],X=[],xe={},L=0,j=0,z={Sheets:[],WBProps:{date1904:!1}},G={};q1.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var ae="";c=q1.exec(n);)switch(c[3]=(ae=c[3]).toLowerCase()){case"data":if(ae=="data"){if(c[1]==="/"){if((h=u.pop())[0]!==c[3])throw new Error("Bad state: "+h.join("|"))}else c[0].charAt(c[0].length-2)!=="/"&&u.push([c[3],!0]);break}if(u[u.length-1][1])break;c[1]==="/"?HH(n.slice(O,c.index),F,A,u[u.length-1][0]=="comment"?ne:b,{c:M,r:B},ee,J[M],E,Z,r):(F="",A=hl(c[0]),O=c.index+c[0].length);break;case"cell":if(c[1]==="/")if(se.length>0&&(b.c=se),(!r.sheetRows||r.sheetRows>B)&&b.v!==void 0&&(r.dense?(x[B]||(x[B]=[]),x[B][M]=b):x[ei(M)+Ni(B)]=b),b.HRef&&(b.l={Target:tn(b.HRef)},b.HRefScreenTip&&(b.l.Tooltip=b.HRefScreenTip),delete b.HRef,delete b.HRefScreenTip),(b.MergeAcross||b.MergeDown)&&(L=M+(parseInt(b.MergeAcross,10)|0),j=B+(parseInt(b.MergeDown,10)|0),S.push({s:{c:M,r:B},e:{c:L,r:j}})),!r.sheetStubs)b.MergeAcross?M=L+1:++M;else if(b.MergeAcross||b.MergeDown){for(var Ae=M;Ae<=L;++Ae)for(var _e=B;_e<=j;++_e)(Ae>M||_e>B)&&(r.dense?(x[_e]||(x[_e]=[]),x[_e][Ae]={t:"z"}):x[ei(Ae)+Ni(_e)]={t:"z"});M=L+1}else++M;else b=jH(c[0]),b.Index&&(M=+b.Index-1),M<Q.s.c&&(Q.s.c=M),M>Q.e.c&&(Q.e.c=M),c[0].slice(-2)==="/>"&&++M,se=[];break;case"row":c[1]==="/"||c[0].slice(-2)==="/>"?(B<Q.s.r&&(Q.s.r=B),B>Q.e.r&&(Q.e.r=B),c[0].slice(-2)==="/>"&&(E=hl(c[0]),E.Index&&(B=+E.Index-1)),M=0,++B):(E=hl(c[0]),E.Index&&(B=+E.Index-1),xe={},(E.AutoFitHeight=="0"||E.Height)&&(xe.hpx=parseInt(E.Height,10),xe.hpt=X1(xe.hpx),X[B]=xe),E.Hidden=="1"&&(xe.hidden=!0,X[B]=xe));break;case"worksheet":if(c[1]==="/"){if((h=u.pop())[0]!==c[3])throw new Error("Bad state: "+h.join("|"));g.push(_),Q.s.r<=Q.e.r&&Q.s.c<=Q.e.c&&(x["!ref"]=wr(Q),r.sheetRows&&r.sheetRows<=Q.e.r&&(x["!fullref"]=x["!ref"],Q.e.r=r.sheetRows-1,x["!ref"]=wr(Q))),S.length&&(x["!merges"]=S),J.length>0&&(x["!cols"]=J),X.length>0&&(x["!rows"]=X),d[_]=x}else Q={s:{r:2e6,c:2e6},e:{r:0,c:0}},B=M=0,u.push([c[3],!1]),h=hl(c[0]),_=tn(h.Name),x=r.dense?[]:{},S=[],Z=[],X=[],G={name:_,Hidden:0},z.Sheets.push(G);break;case"table":if(c[1]==="/"){if((h=u.pop())[0]!==c[3])throw new Error("Bad state: "+h.join("|"))}else{if(c[0].slice(-2)=="/>")break;u.push([c[3],!1]),J=[],oe=!1}break;case"style":c[1]==="/"?zH(ee,he,r):he=hl(c[0]);break;case"numberformat":he.nf=tn(hl(c[0]).Format||"General"),b1[he.nf]&&(he.nf=b1[he.nf]);for(var Ee=0;Ee!=392&&sr[Ee]!=he.nf;++Ee);if(Ee==392){for(Ee=57;Ee!=392;++Ee)if(sr[Ee]==null){nu(he.nf,Ee);break}}break;case"column":if(u[u.length-1][0]!=="table")break;if(de=hl(c[0]),de.Hidden&&(de.hidden=!0,delete de.Hidden),de.Width&&(de.wpx=parseInt(de.Width,10)),!oe&&de.wpx>10){oe=!0,Za=q6;for(var Ce=0;Ce<J.length;++Ce)J[Ce]&&Ef(J[Ce])}oe&&Ef(de),J[de.Index-1||J.length]=de;for(var Oe=0;Oe<+de.Span;++Oe)J[J.length]=zn(de);break;case"namedrange":if(c[1]==="/")break;z.Names||(z.Names=[]);var fe=pr(c[0]),rt={Name:fe.Name,Ref:j0(fe.RefersTo.slice(1),{r:0,c:0})};z.Sheets.length>0&&(rt.Sheet=z.Sheets.length-1),z.Names.push(rt);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(c[0].slice(-2)==="/>")break;c[1]==="/"?F+=n.slice(k,c.index):k=c.index+c[0].length;break;case"interior":if(!r.cellStyles)break;he.Interior=hl(c[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(c[0].slice(-2)==="/>")break;c[1]==="/"?m9(U,ae,n.slice(C,c.index)):C=c.index+c[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(c[1]==="/"){if((h=u.pop())[0]!==c[3])throw new Error("Bad state: "+h.join("|"))}else u.push([c[3],!1]);break;case"comment":if(c[1]==="/"){if((h=u.pop())[0]!==c[3])throw new Error("Bad state: "+h.join("|"));GH(ne),se.push(ne)}else u.push([c[3],!1]),h=hl(c[0]),ne={a:h.Author};break;case"autofilter":if(c[1]==="/"){if((h=u.pop())[0]!==c[3])throw new Error("Bad state: "+h.join("|"))}else if(c[0].charAt(c[0].length-2)!=="/"){var ot=hl(c[0]);x["!autofilter"]={ref:j0(ot.Range).replace(/\$/g,"")},u.push([c[3],!0])}break;case"name":break;case"datavalidation":if(c[1]==="/"){if((h=u.pop())[0]!==c[3])throw new Error("Bad state: "+h.join("|"))}else c[0].charAt(c[0].length-2)!=="/"&&u.push([c[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(c[1]==="/"){if((h=u.pop())[0]!==c[3])throw new Error("Bad state: "+h.join("|"))}else c[0].charAt(c[0].length-2)!=="/"&&u.push([c[3],!0]);break;case"null":break;default:if(u.length==0&&c[3]=="document"||u.length==0&&c[3]=="uof")return ib(n,r);var Pe=!0;switch(u[u.length-1][0]){case"officedocumentsettings":switch(c[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:Pe=!1}break;case"componentoptions":switch(c[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:Pe=!1}break;case"excelworkbook":switch(c[3]){case"date1904":z.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:Pe=!1}break;case"workbookoptions":switch(c[3]){case"owcversion":break;case"height":break;case"width":break;default:Pe=!1}break;case"worksheetoptions":switch(c[3]){case"visible":if(c[0].slice(-2)!=="/>")if(c[1]==="/")switch(n.slice(C,c.index)){case"SheetHidden":G.Hidden=1;break;case"SheetVeryHidden":G.Hidden=2;break}else C=c.index+c[0].length;break;case"header":x["!margins"]||gh(x["!margins"]={},"xlml"),isNaN(+pr(c[0]).Margin)||(x["!margins"].header=+pr(c[0]).Margin);break;case"footer":x["!margins"]||gh(x["!margins"]={},"xlml"),isNaN(+pr(c[0]).Margin)||(x["!margins"].footer=+pr(c[0]).Margin);break;case"pagemargins":var ge=pr(c[0]);x["!margins"]||gh(x["!margins"]={},"xlml"),isNaN(+ge.Top)||(x["!margins"].top=+ge.Top),isNaN(+ge.Left)||(x["!margins"].left=+ge.Left),isNaN(+ge.Right)||(x["!margins"].right=+ge.Right),isNaN(+ge.Bottom)||(x["!margins"].bottom=+ge.Bottom);break;case"displayrighttoleft":z.Views||(z.Views=[]),z.Views[0]||(z.Views[0]={}),z.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":x["!outline"]||(x["!outline"]={}),x["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":x["!outline"]||(x["!outline"]={}),x["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:Pe=!1}break;case"pivottable":case"pivotcache":switch(c[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:Pe=!1}break;case"pagebreaks":switch(c[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:Pe=!1}break;case"autofilter":switch(c[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:Pe=!1}break;case"querytable":switch(c[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:Pe=!1}break;case"datavalidation":switch(c[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:Pe=!1}break;case"sorting":case"conditionalformatting":switch(c[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:Pe=!1}break;case"mapinfo":case"schema":case"data":switch(c[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:Pe=!1}break;case"smarttags":break;default:Pe=!1;break}if(Pe||c[3].match(/!\[CDATA/))break;if(!u[u.length-1][1])throw"Unrecognized tag: "+c[3]+"|"+u.join("|");if(u[u.length-1][0]==="customdocumentproperties"){if(c[0].slice(-2)==="/>")break;c[1]==="/"?VH(I,ae,R,n.slice(C,c.index)):(R=c,C=c.index+c[0].length);break}if(r.WTF)throw"Unrecognized tag: "+c[3]+"|"+u.join("|")}var Je={};return!r.bookSheets&&!r.bookProps&&(Je.Sheets=d),Je.SheetNames=g,Je.Workbook=z,Je.SSF=zn(sr),Je.Props=U,Je.Custprops=I,Je}function nx(t,e){switch(t5(e=e||{}),e.type||"base64"){case"base64":return n_(so(t),e);case"binary":case"buffer":case"file":return n_(t,e);case"array":return n_(Df(t),e)}}function WH(t,e){var r=[];return t.Props&&r.push(g9(t.Props,e)),t.Custprops&&r.push(v9(t.Props,t.Custprops)),r.join("")}function XH(){return""}function YH(t,e){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return e.cellXfs.forEach(function(n,i){var a=[];a.push(Ct("NumberFormat",null,{"ss:Format":bn(sr[n.numFmtId])}));var o={"ss:ID":"s"+(21+i)};r.push(Ct("Style",a.join(""),o))}),Ct("Styles",r.join(""))}function mk(t){return Ct("NamedRange",null,{"ss:Name":t.Name,"ss:RefersTo":"="+Ky(t.Ref,{r:0,c:0})})}function KH(t){if(!((t||{}).Workbook||{}).Names)return"";for(var e=t.Workbook.Names,r=[],n=0;n<e.length;++n){var i=e[n];i.Sheet==null&&(i.Name.match(/^_xlfn\./)||r.push(mk(i)))}return Ct("Names",r.join(""))}function $H(t,e,r,n){if(!t||!((n||{}).Workbook||{}).Names)return"";for(var i=n.Workbook.Names,a=[],o=0;o<i.length;++o){var c=i[o];c.Sheet==r&&(c.Name.match(/^_xlfn\./)||a.push(mk(c)))}return a.join("")}function QH(t,e,r,n){if(!t)return"";var i=[];if(t["!margins"]&&(i.push("<PageSetup>"),t["!margins"].header&&i.push(Ct("Header",null,{"x:Margin":t["!margins"].header})),t["!margins"].footer&&i.push(Ct("Footer",null,{"x:Margin":t["!margins"].footer})),i.push(Ct("PageMargins",null,{"x:Bottom":t["!margins"].bottom||"0.75","x:Left":t["!margins"].left||"0.7","x:Right":t["!margins"].right||"0.7","x:Top":t["!margins"].top||"0.75"})),i.push("</PageSetup>")),n&&n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[r])if(n.Workbook.Sheets[r].Hidden)i.push(Ct("Visible",n.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var a=0;a<r&&!(n.Workbook.Sheets[a]&&!n.Workbook.Sheets[a].Hidden);++a);a==r&&i.push("<Selected/>")}return((((n||{}).Workbook||{}).Views||[])[0]||{}).RTL&&i.push("<DisplayRightToLeft/>"),t["!protect"]&&(i.push(Ca("ProtectContents","True")),t["!protect"].objects&&i.push(Ca("ProtectObjects","True")),t["!protect"].scenarios&&i.push(Ca("ProtectScenarios","True")),t["!protect"].selectLockedCells!=null&&!t["!protect"].selectLockedCells?i.push(Ca("EnableSelection","NoSelection")):t["!protect"].selectUnlockedCells!=null&&!t["!protect"].selectUnlockedCells&&i.push(Ca("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(o){t["!protect"][o[0]]&&i.push("<"+o[1]+"/>")})),i.length==0?"":Ct("WorksheetOptions",i.join(""),{xmlns:Js.x})}function JH(t){return t.map(function(e){var r=xP(e.t||""),n=Ct("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return Ct("Comment",n,{"ss:Author":e.a})}).join("")}function ZH(t,e,r,n,i,a,o){if(!t||t.v==null&&t.f==null)return"";var c={};if(t.f&&(c["ss:Formula"]="="+bn(Ky(t.f,o))),t.F&&t.F.slice(0,e.length)==e){var u=ti(t.F.slice(e.length+1));c["ss:ArrayRange"]="RC:R"+(u.r==o.r?"":"["+(u.r-o.r)+"]")+"C"+(u.c==o.c?"":"["+(u.c-o.c)+"]")}if(t.l&&t.l.Target&&(c["ss:HRef"]=bn(t.l.Target),t.l.Tooltip&&(c["x:HRefScreenTip"]=bn(t.l.Tooltip))),r["!merges"])for(var h=r["!merges"],d=0;d!=h.length;++d)h[d].s.c!=o.c||h[d].s.r!=o.r||(h[d].e.c>h[d].s.c&&(c["ss:MergeAcross"]=h[d].e.c-h[d].s.c),h[d].e.r>h[d].s.r&&(c["ss:MergeDown"]=h[d].e.r-h[d].s.r));var g="",x="";switch(t.t){case"z":if(!n.sheetStubs)return"";break;case"n":g="Number",x=String(t.v);break;case"b":g="Boolean",x=t.v?"1":"0";break;case"e":g="Error",x=du[t.v];break;case"d":g="DateTime",x=new Date(t.v).toISOString(),t.z==null&&(t.z=t.z||sr[14]);break;case"s":g="String",x=_P(t.v||"");break}var _=Of(n.cellXfs,t,n);c["ss:StyleID"]="s"+(21+_),c["ss:Index"]=o.c+1;var b=t.v!=null?x:"",E=t.t=="z"?"":'<Data ss:Type="'+g+'">'+b+"</Data>";return(t.c||[]).length>0&&(E+=JH(t.c)),Ct("Cell",E,c)}function eG(t,e){var r='<Row ss:Index="'+(t+1)+'"';return e&&(e.hpt&&!e.hpx&&(e.hpx=Z0(e.hpt)),e.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+e.hpx+'"'),e.hidden&&(r+=' ss:Hidden="1"')),r+">"}function tG(t,e,r,n){if(!t["!ref"])return"";var i=rn(t["!ref"]),a=t["!merges"]||[],o=0,c=[];t["!cols"]&&t["!cols"].forEach(function(A,O){Ef(A);var M=!!A.width,B=y2(O,A),Q={"ss:Index":O+1};M&&(Q["ss:Width"]=G1(B.width)),A.hidden&&(Q["ss:Hidden"]="1"),c.push(Ct("Column",null,Q))});for(var u=Array.isArray(t),h=i.s.r;h<=i.e.r;++h){for(var d=[eG(h,(t["!rows"]||[])[h])],g=i.s.c;g<=i.e.c;++g){var x=!1;for(o=0;o!=a.length;++o)if(!(a[o].s.c>g)&&!(a[o].s.r>h)&&!(a[o].e.c<g)&&!(a[o].e.r<h)){(a[o].s.c!=g||a[o].s.r!=h)&&(x=!0);break}if(!x){var _={r:h,c:g},b=ur(_),E=u?(t[h]||[])[g]:t[b];d.push(ZH(E,b,t,e,r,n,_))}}d.push("</Row>"),d.length>2&&c.push(d.join(""))}return c.join("")}function rG(t,e,r){var n=[],i=r.SheetNames[t],a=r.Sheets[i],o=a?$H(a,e,t,r):"";return o.length>0&&n.push("<Names>"+o+"</Names>"),o=a?tG(a,e,t,r):"",o.length>0&&n.push("<Table>"+o+"</Table>"),n.push(QH(a,e,t,r)),n.join("")}function nG(t,e){e||(e={}),t.SSF||(t.SSF=zn(sr)),t.SSF&&(ud(),d2(t.SSF),e.revssf=m2(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF,e.cellXfs=[],Of(e.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(WH(t,e)),r.push(XH()),r.push(""),r.push("");for(var n=0;n<t.SheetNames.length;++n)r.push(Ct("Worksheet",rG(n,e,t),{"ss:Name":bn(t.SheetNames[n])}));return r[2]=YH(t,e),r[3]=KH(t),Ci+Ct("Workbook",r.join(""),{xmlns:Js.ss,"xmlns:o":Js.o,"xmlns:x":Js.x,"xmlns:ss":Js.ss,"xmlns:dt":Js.dt,"xmlns:html":Js.html})}function iG(t){var e={},r=t.content;if(r.l=28,e.AnsiUserType=r.read_shift(0,"lpstr-ansi"),e.AnsiClipboardFormat=KP(r),r.length-r.l<=4)return e;var n=r.read_shift(4);if(n==0||n>40||(r.l-=4,e.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(n=r.read_shift(4),n!==1907505652)||(e.UnicodeClipboardFormat=$P(r),n=r.read_shift(4),n==0||n>40))return e;r.l-=4,e.Reserved2=r.read_shift(0,"lpwstr")}var aG=[60,1084,2066,2165,2175];function sG(t,e,r,n,i){var a=n,o=[],c=r.slice(r.l,r.l+a);if(i&&i.enc&&i.enc.insitu&&c.length>0)switch(t){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:i.enc.insitu(c)}o.push(c),r.l+=a;for(var u=Zc(r,r.l),h=ix[u],d=0;h!=null&&aG.indexOf(u)>-1;)a=Zc(r,r.l+2),d=r.l+4,u==2066?d+=4:(u==2165||u==2175)&&(d+=12),c=r.slice(d,r.l+4+a),o.push(c),r.l+=4+a,h=ix[u=Zc(r,r.l)];var g=da(o);ka(g,0);var x=0;g.lens=[];for(var _=0;_<o.length;++_)g.lens.push(x),x+=o[_].length;if(g.length<n)throw"XLS Record 0x"+t.toString(16)+" Truncated: "+g.length+" < "+n;return e.f(g,g.length,i)}function rc(t,e,r){if(t.t!=="z"&&t.XF){var n=0;try{n=t.z||t.XF.numFmtId||0,e.cellNF&&(t.z=sr[n])}catch(a){if(e.WTF)throw a}if(!e||e.cellText!==!1)try{t.t==="e"?t.w=t.w||du[t.v]:n===0||n=="General"?t.t==="n"?(t.v|0)===t.v?t.w=t.v.toString(10):t.w=j1(t.v):t.w=Sh(t.v):t.w=Vo(n,t.v,{date1904:!!r,dateNF:e&&e.dateNF})}catch(a){if(e.WTF)throw a}if(e.cellDates&&n&&t.t=="n"&&cd(sr[n]||String(n))){var i=uh(t.v);i&&(t.t="d",t.v=new Date(i.y,i.m-1,i.d,i.H,i.M,i.S,i.u))}}}function Dm(t,e,r){return{v:t,ixfe:e,t:r}}function oG(t,e){var r={opts:{}},n={},i=e.dense?[]:{},a={},o={},c=null,u=[],h="",d={},g,x="",_,b,E,A,O={},M=[],B,Q,ee=[],he=[],F={Sheets:[],WBProps:{date1904:!1},Views:[{}]},k={},S=function(Nt){return Nt<8?dh[Nt]:Nt<64&&he[Nt-8]||dh[Nt]},U=function(Nt,_t,or){var Gt=_t.XF.data;if(!(!Gt||!Gt.patternType||!or||!or.cellStyles)){_t.s={},_t.s.patternType=Gt.patternType;var zr;(zr=H1(S(Gt.icvFore)))&&(_t.s.fgColor={rgb:zr}),(zr=H1(S(Gt.icvBack)))&&(_t.s.bgColor={rgb:zr})}},I=function(Nt,_t,or){if(!(xe>1)&&!(or.sheetRows&&Nt.r>=or.sheetRows)){if(or.cellStyles&&_t.XF&&_t.XF.data&&U(Nt,_t,or),delete _t.ixfe,delete _t.XF,g=Nt,x=ur(Nt),(!o||!o.s||!o.e)&&(o={s:{r:0,c:0},e:{r:0,c:0}}),Nt.r<o.s.r&&(o.s.r=Nt.r),Nt.c<o.s.c&&(o.s.c=Nt.c),Nt.r+1>o.e.r&&(o.e.r=Nt.r+1),Nt.c+1>o.e.c&&(o.e.c=Nt.c+1),or.cellFormula&&_t.f){for(var Gt=0;Gt<M.length;++Gt)if(!(M[Gt][0].s.c>Nt.c||M[Gt][0].s.r>Nt.r)&&!(M[Gt][0].e.c<Nt.c||M[Gt][0].e.r<Nt.r)){_t.F=wr(M[Gt][0]),(M[Gt][0].s.c!=Nt.c||M[Gt][0].s.r!=Nt.r)&&delete _t.f,_t.f&&(_t.f=""+Qa(M[Gt][1],o,Nt,Z,C));break}}or.dense?(i[Nt.r]||(i[Nt.r]=[]),i[Nt.r][Nt.c]=_t):i[x]=_t}},C={enc:!1,sbcch:0,snames:[],sharedf:O,arrayf:M,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!e&&!!e.cellStyles,WTF:!!e&&!!e.wtf};e.password&&(C.password=e.password);var R,se=[],ne=[],J=[],de=[],oe=!1,Z=[];Z.SheetNames=C.snames,Z.sharedf=C.sharedf,Z.arrayf=C.arrayf,Z.names=[],Z.XTI=[];var X=0,xe=0,L=0,j=[],z=[],G;C.codepage=1200,vl(1200);for(var ae=!1;t.l<t.length-1;){var Ae=t.l,_e=t.read_shift(2);if(_e===0&&X===10)break;var Ee=t.l===t.length?0:t.read_shift(2),Ce=ix[_e];if(Ce&&Ce.f){if(e.bookSheets&&X===133&&_e!==133)break;if(X=_e,Ce.r===2||Ce.r==12){var Oe=t.read_shift(2);if(Ee-=2,!C.enc&&Oe!==_e&&((Oe&255)<<8|Oe>>8)!==_e)throw new Error("rt mismatch: "+Oe+"!="+_e);Ce.r==12&&(t.l+=10,Ee-=10)}var fe={};if(_e===10?fe=Ce.f(t,Ee,C):fe=sG(_e,Ce,t,Ee,C),xe==0&&[9,521,1033,2057].indexOf(X)===-1)continue;switch(_e){case 34:r.opts.Date1904=F.WBProps.date1904=fe;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(C.enc||(t.l=0),C.enc=fe,!e.password)throw new Error("File is password-protected");if(fe.valid==null)throw new Error("Encryption scheme unsupported");if(!fe.valid)throw new Error("Password is incorrect");break;case 92:C.lastuser=fe;break;case 66:var rt=Number(fe);switch(rt){case 21010:rt=1200;break;case 32768:rt=1e4;break;case 32769:rt=1252;break}vl(C.codepage=rt),ae=!0;break;case 317:C.rrtabid=fe;break;case 25:C.winlocked=fe;break;case 439:r.opts.RefreshAll=fe;break;case 12:r.opts.CalcCount=fe;break;case 16:r.opts.CalcDelta=fe;break;case 17:r.opts.CalcIter=fe;break;case 13:r.opts.CalcMode=fe;break;case 14:r.opts.CalcPrecision=fe;break;case 95:r.opts.CalcSaveRecalc=fe;break;case 15:C.CalcRefMode=fe;break;case 2211:r.opts.FullCalc=fe;break;case 129:fe.fDialog&&(i["!type"]="dialog"),fe.fBelow||((i["!outline"]||(i["!outline"]={})).above=!0),fe.fRight||((i["!outline"]||(i["!outline"]={})).left=!0);break;case 224:ee.push(fe);break;case 430:Z.push([fe]),Z[Z.length-1].XTI=[];break;case 35:case 547:Z[Z.length-1].push(fe);break;case 24:case 536:G={Name:fe.Name,Ref:Qa(fe.rgce,o,null,Z,C)},fe.itab>0&&(G.Sheet=fe.itab-1),Z.names.push(G),Z[0]||(Z[0]=[],Z[0].XTI=[]),Z[Z.length-1].push(fe),fe.Name=="_xlnm._FilterDatabase"&&fe.itab>0&&fe.rgce&&fe.rgce[0]&&fe.rgce[0][0]&&fe.rgce[0][0][0]=="PtgArea3d"&&(z[fe.itab-1]={ref:wr(fe.rgce[0][0][1][2])});break;case 22:C.ExternCount=fe;break;case 23:Z.length==0&&(Z[0]=[],Z[0].XTI=[]),Z[Z.length-1].XTI=Z[Z.length-1].XTI.concat(fe),Z.XTI=Z.XTI.concat(fe);break;case 2196:if(C.biff<8)break;G!=null&&(G.Comment=fe[1]);break;case 18:i["!protect"]=fe;break;case 19:fe!==0&&C.WTF&&console.error("Password verifier: "+fe);break;case 133:a[fe.pos]=fe,C.snames.push(fe.name);break;case 10:{if(--xe)break;if(o.e){if(o.e.r>0&&o.e.c>0){if(o.e.r--,o.e.c--,i["!ref"]=wr(o),e.sheetRows&&e.sheetRows<=o.e.r){var ot=o.e.r;o.e.r=e.sheetRows-1,i["!fullref"]=i["!ref"],i["!ref"]=wr(o),o.e.r=ot}o.e.r++,o.e.c++}se.length>0&&(i["!merges"]=se),ne.length>0&&(i["!objects"]=ne),J.length>0&&(i["!cols"]=J),de.length>0&&(i["!rows"]=de),F.Sheets.push(k)}h===""?d=i:n[h]=i,i=e.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(C.biff===8&&(C.biff={9:2,521:3,1033:4}[_e]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[fe.BIFFVer]||8),C.biffguess=fe.BIFFVer==0,fe.BIFFVer==0&&fe.dt==4096&&(C.biff=5,ae=!0,vl(C.codepage=28591)),C.biff==8&&fe.BIFFVer==0&&fe.dt==16&&(C.biff=2),xe++)break;if(i=e.dense?[]:{},C.biff<8&&!ae&&(ae=!0,vl(C.codepage=e.codepage||1252)),C.biff<5||fe.BIFFVer==0&&fe.dt==4096){h===""&&(h="Sheet1"),o={s:{r:0,c:0},e:{r:0,c:0}};var Pe={pos:t.l-Ee,name:h};a[Pe.pos]=Pe,C.snames.push(h)}else h=(a[Ae]||{name:""}).name;fe.dt==32&&(i["!type"]="chart"),fe.dt==64&&(i["!type"]="macro"),se=[],ne=[],C.arrayf=M=[],J=[],de=[],oe=!1,k={Hidden:(a[Ae]||{hs:0}).hs,name:h}}break;case 515:case 3:case 2:i["!type"]=="chart"&&(e.dense?(i[fe.r]||[])[fe.c]:i[ur({c:fe.c,r:fe.r})])&&++fe.c,B={ixfe:fe.ixfe,XF:ee[fe.ixfe]||{},v:fe.val,t:"n"},L>0&&(B.z=j[B.ixfe>>8&63]),rc(B,e,r.opts.Date1904),I({c:fe.c,r:fe.r},B,e);break;case 5:case 517:B={ixfe:fe.ixfe,XF:ee[fe.ixfe],v:fe.val,t:fe.t},L>0&&(B.z=j[B.ixfe>>8&63]),rc(B,e,r.opts.Date1904),I({c:fe.c,r:fe.r},B,e);break;case 638:B={ixfe:fe.ixfe,XF:ee[fe.ixfe],v:fe.rknum,t:"n"},L>0&&(B.z=j[B.ixfe>>8&63]),rc(B,e,r.opts.Date1904),I({c:fe.c,r:fe.r},B,e);break;case 189:for(var ge=fe.c;ge<=fe.C;++ge){var Je=fe.rkrec[ge-fe.c][0];B={ixfe:Je,XF:ee[Je],v:fe.rkrec[ge-fe.c][1],t:"n"},L>0&&(B.z=j[B.ixfe>>8&63]),rc(B,e,r.opts.Date1904),I({c:ge,r:fe.r},B,e)}break;case 6:case 518:case 1030:{if(fe.val=="String"){c=fe;break}if(B=Dm(fe.val,fe.cell.ixfe,fe.tt),B.XF=ee[B.ixfe],e.cellFormula){var nt=fe.formula;if(nt&&nt[0]&&nt[0][0]&&nt[0][0][0]=="PtgExp"){var et=nt[0][0][1][0],vt=nt[0][0][1][1],Et=ur({r:et,c:vt});O[Et]?B.f=""+Qa(fe.formula,o,fe.cell,Z,C):B.F=((e.dense?(i[et]||[])[vt]:i[Et])||{}).F}else B.f=""+Qa(fe.formula,o,fe.cell,Z,C)}L>0&&(B.z=j[B.ixfe>>8&63]),rc(B,e,r.opts.Date1904),I(fe.cell,B,e),c=fe}break;case 7:case 519:if(c)c.val=fe,B=Dm(fe,c.cell.ixfe,"s"),B.XF=ee[B.ixfe],e.cellFormula&&(B.f=""+Qa(c.formula,o,c.cell,Z,C)),L>0&&(B.z=j[B.ixfe>>8&63]),rc(B,e,r.opts.Date1904),I(c.cell,B,e),c=null;else throw new Error("String record expects Formula");break;case 33:case 545:{M.push(fe);var bt=ur(fe[0].s);if(_=e.dense?(i[fe[0].s.r]||[])[fe[0].s.c]:i[bt],e.cellFormula&&_){if(!c||!bt||!_)break;_.f=""+Qa(fe[1],o,fe[0],Z,C),_.F=wr(fe[0])}}break;case 1212:{if(!e.cellFormula)break;if(x){if(!c)break;O[ur(c.cell)]=fe[0],_=e.dense?(i[c.cell.r]||[])[c.cell.c]:i[ur(c.cell)],(_||{}).f=""+Qa(fe[0],o,g,Z,C)}}break;case 253:B=Dm(u[fe.isst].t,fe.ixfe,"s"),u[fe.isst].h&&(B.h=u[fe.isst].h),B.XF=ee[B.ixfe],L>0&&(B.z=j[B.ixfe>>8&63]),rc(B,e,r.opts.Date1904),I({c:fe.c,r:fe.r},B,e);break;case 513:e.sheetStubs&&(B={ixfe:fe.ixfe,XF:ee[fe.ixfe],t:"z"},L>0&&(B.z=j[B.ixfe>>8&63]),rc(B,e,r.opts.Date1904),I({c:fe.c,r:fe.r},B,e));break;case 190:if(e.sheetStubs)for(var Mt=fe.c;Mt<=fe.C;++Mt){var Dt=fe.ixfe[Mt-fe.c];B={ixfe:Dt,XF:ee[Dt],t:"z"},L>0&&(B.z=j[B.ixfe>>8&63]),rc(B,e,r.opts.Date1904),I({c:Mt,r:fe.r},B,e)}break;case 214:case 516:case 4:B=Dm(fe.val,fe.ixfe,"s"),B.XF=ee[B.ixfe],L>0&&(B.z=j[B.ixfe>>8&63]),rc(B,e,r.opts.Date1904),I({c:fe.c,r:fe.r},B,e);break;case 0:case 512:xe===1&&(o=fe);break;case 252:u=fe;break;case 1054:if(C.biff==4){j[L++]=fe[1];for(var qt=0;qt<L+163&&sr[qt]!=fe[1];++qt);qt>=163&&nu(fe[1],L+163)}else nu(fe[1],fe[0]);break;case 30:{j[L++]=fe;for(var Tt=0;Tt<L+163&&sr[Tt]!=fe;++Tt);Tt>=163&&nu(fe,L+163)}break;case 229:se=se.concat(fe);break;case 93:ne[fe.cmo[0]]=C.lastobj=fe;break;case 438:C.lastobj.TxO=fe;break;case 127:C.lastobj.ImData=fe;break;case 440:for(A=fe[0].s.r;A<=fe[0].e.r;++A)for(E=fe[0].s.c;E<=fe[0].e.c;++E)_=e.dense?(i[A]||[])[E]:i[ur({c:E,r:A})],_&&(_.l=fe[1]);break;case 2048:for(A=fe[0].s.r;A<=fe[0].e.r;++A)for(E=fe[0].s.c;E<=fe[0].e.c;++E)_=e.dense?(i[A]||[])[E]:i[ur({c:E,r:A})],_&&_.l&&(_.l.Tooltip=fe[1]);break;case 28:{if(C.biff<=5&&C.biff>=2)break;_=e.dense?(i[fe[0].r]||[])[fe[0].c]:i[ur(fe[0])];var kt=ne[fe[2]];_||(e.dense?(i[fe[0].r]||(i[fe[0].r]=[]),_=i[fe[0].r][fe[0].c]={t:"z"}):_=i[ur(fe[0])]={t:"z"},o.e.r=Math.max(o.e.r,fe[0].r),o.s.r=Math.min(o.s.r,fe[0].r),o.e.c=Math.max(o.e.c,fe[0].c),o.s.c=Math.min(o.s.c,fe[0].c)),_.c||(_.c=[]),b={a:fe[1],t:kt.TxO.t},_.c.push(b)}break;case 2173:Yj(ee[fe.ixfe],fe.ext);break;case 125:{if(!C.cellStyles)break;for(;fe.e>=fe.s;)J[fe.e--]={width:fe.w/256,level:fe.level||0,hidden:!!(fe.flags&1)},oe||(oe=!0,Wy(fe.w/256)),Ef(J[fe.e+1])}break;case 520:{var zt={};fe.level!=null&&(de[fe.r]=zt,zt.level=fe.level),fe.hidden&&(de[fe.r]=zt,zt.hidden=!0),fe.hpt&&(de[fe.r]=zt,zt.hpt=fe.hpt,zt.hpx=Z0(fe.hpt))}break;case 38:case 39:case 40:case 41:i["!margins"]||gh(i["!margins"]={}),i["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[_e]]=fe;break;case 161:i["!margins"]||gh(i["!margins"]={}),i["!margins"].header=fe.header,i["!margins"].footer=fe.footer;break;case 574:fe.RTL&&(F.Views[0].RTL=!0);break;case 146:he=fe;break;case 2198:R=fe;break;case 140:Q=fe;break;case 442:h?k.CodeName=fe||k.name:F.WBProps.CodeName=fe||"ThisWorkbook";break}}else Ce||console.error("Missing Info for XLS Record 0x"+_e.toString(16)),t.l+=Ee}return r.SheetNames=hi(a).sort(function(Pt,Nt){return Number(Pt)-Number(Nt)}).map(function(Pt){return a[Pt].name}),e.bookSheets||(r.Sheets=n),!r.SheetNames.length&&d["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=d)):r.Preamble=d,r.Sheets&&z.forEach(function(Pt,Nt){r.Sheets[r.SheetNames[Nt]]["!autofilter"]=Pt}),r.Strings=u,r.SSF=zn(sr),C.enc&&(r.Encryption=C.enc),R&&(r.Themes=R),r.Metadata={},Q!==void 0&&(r.Metadata.Country=Q),Z.names.length>0&&(F.Names=Z.names),r.Workbook=F,r}var S1={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function lG(t,e,r){var n=Qt.find(t,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var i=F3(n,Q_,S1.DSI);for(var a in i)e[a]=i[a]}catch(h){if(r.WTF)throw h}var o=Qt.find(t,"/!SummaryInformation");if(o&&o.size>0)try{var c=F3(o,J_,S1.SI);for(var u in c)e[u]==null&&(e[u]=c[u])}catch(h){if(r.WTF)throw h}e.HeadingPairs&&e.TitlesOfParts&&(p6(e.HeadingPairs,e.TitlesOfParts,e,r),delete e.HeadingPairs,delete e.TitlesOfParts)}function cG(t,e){var r=[],n=[],i=[],a=0,o,c=u3(Q_,"n"),u=u3(J_,"n");if(t.Props)for(o=hi(t.Props),a=0;a<o.length;++a)(Object.prototype.hasOwnProperty.call(c,o[a])?r:Object.prototype.hasOwnProperty.call(u,o[a])?n:i).push([o[a],t.Props[o[a]]]);if(t.Custprops)for(o=hi(t.Custprops),a=0;a<o.length;++a)Object.prototype.hasOwnProperty.call(t.Props||{},o[a])||(Object.prototype.hasOwnProperty.call(c,o[a])?r:Object.prototype.hasOwnProperty.call(u,o[a])?n:i).push([o[a],t.Custprops[o[a]]]);var h=[];for(a=0;a<i.length;++a)w6.indexOf(i[a][0])>-1||d6.indexOf(i[a][0])>-1||i[a][1]!=null&&h.push(i[a]);n.length&&Qt.utils.cfb_add(e,"/SummaryInformation",O3(n,S1.SI,u,J_)),(r.length||h.length)&&Qt.utils.cfb_add(e,"/DocumentSummaryInformation",O3(r,S1.DSI,c,Q_,h.length?h:null,S1.UDI))}function gk(t,e){e||(e={}),t5(e),Ey(),e.codepage&&wy(e.codepage);var r,n;if(t.FullPaths){if(Qt.find(t,"/encryption"))throw new Error("File is password-protected");r=Qt.find(t,"!CompObj"),n=Qt.find(t,"/Workbook")||Qt.find(t,"/Book")}else{switch(e.type){case"base64":t=eo(so(t));break;case"binary":t=eo(t);break;case"buffer":break;case"array":Array.isArray(t)||(t=Array.prototype.slice.call(t));break}ka(t,0),n={content:t}}var i,a;if(r&&iG(r),e.bookProps&&!e.bookSheets)i={};else{var o=Lr?"buffer":"array";if(n&&n.content)i=oG(n.content,e);else if((a=Qt.find(t,"PerfectOffice_MAIN"))&&a.content)i=mh.to_workbook(a.content,(e.type=o,e));else if((a=Qt.find(t,"NativeContent_MAIN"))&&a.content)i=mh.to_workbook(a.content,(e.type=o,e));else throw(a=Qt.find(t,"MN0"))&&a.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");e.bookVBA&&t.FullPaths&&Qt.find(t,"/_VBA_PROJECT_CUR/VBA/dir")&&(i.vbaraw=EU(t))}var c={};return t.FullPaths&&lG(t,c,e),i.Props=i.Custprops=c,e.bookFiles&&(i.cfb=t),i}function uG(t,e){var r=e||{},n=Qt.utils.cfb_new({root:"R"}),i="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":i="/Workbook",r.biff=8;break;case"biff5":i="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return Qt.utils.cfb_add(n,i,vk(t,r)),r.biff==8&&(t.Props||t.Custprops)&&cG(t,n),r.biff==8&&t.vbaraw&&bU(n,Qt.read(t.vbaraw,{type:typeof t.vbaraw=="string"?"binary":"buffer"})),n}var Y1={0:{f:Fq},1:{f:qq},2:{f:oz},3:{f:$q},4:{f:Wq},5:{f:iz},6:{f:hz},7:{f:ez},8:{f:xz},9:{f:_z},10:{f:gz},11:{f:vz},12:{f:Hq},13:{f:cz},14:{f:Jq},15:{f:Yq},16:{f:lk},17:{f:pz},18:{f:rz},19:{f:Py},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:pH},40:{},42:{},43:{f:hj},44:{f:uj},45:{f:mj},46:{f:vj},47:{f:gj},48:{},49:{f:MP},50:{},51:{f:Qj},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:L6},62:{f:fz},63:{f:sU},64:{f:Oz},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:is,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:Rz},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:Uq},148:{f:Mq,p:16},151:{f:Az},152:{},153:{f:fH},154:{},155:{},156:{f:cH},157:{},158:{},159:{T:1,f:kB},160:{T:-1},161:{T:1,f:jh},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:yz},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:Kj},336:{T:-1},337:{f:eU,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:$_},357:{},358:{},359:{},360:{T:1},361:{},362:{f:R6},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:Tz},427:{f:kz},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:Cz},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:jq},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:bz},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:$_},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:vU},633:{T:1},634:{T:-1},635:{T:1,f:mU},636:{T:-1},637:{f:VP},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:Jz},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:Pz},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},ix={6:{f:t_},10:{f:Ku},12:{f:Ui},13:{f:Ui},14:{f:wi},15:{f:wi},16:{f:es},17:{f:wi},18:{f:wi},19:{f:Ui},20:{f:V3},21:{f:V3},23:{f:R6},24:{f:z3},25:{f:wi},26:{},27:{},28:{f:PM},29:{},34:{f:wi},35:{f:q3},38:{f:es},39:{f:es},40:{f:es},41:{f:es},42:{f:wi},43:{f:wi},47:{f:YB},49:{f:cM},51:{f:Ui},60:{},61:{f:iM},64:{f:wi},65:{f:lM},66:{f:Ui},77:{},80:{},81:{},82:{},85:{f:Ui},89:{},90:{},91:{},92:{f:X9},93:{f:jM},94:{},95:{f:wi},96:{},97:{},99:{f:wi},125:{f:L6},128:{f:SM},129:{f:K9},130:{f:Ui},131:{f:wi},132:{f:wi},133:{f:$9},134:{},140:{f:XM},141:{f:Ui},144:{},146:{f:$M},151:{},152:{},153:{},154:{},155:{},156:{f:Ui},157:{},158:{},160:{f:nB},161:{f:ZM},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:yM},190:{f:wM},193:{f:Ku},197:{},198:{},199:{},200:{},201:{},202:{f:wi},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:Ui},220:{},221:{f:wi},222:{},224:{f:bM},225:{f:W9},226:{f:Ku},227:{},229:{f:MM},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:J9},253:{f:fM},255:{f:eM},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:E6},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:wi},353:{f:Ku},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:CM},431:{f:wi},432:{},433:{},434:{},437:{},438:{f:qM},439:{f:wi},440:{f:zM},441:{},442:{f:gp},443:{},444:{f:Ui},445:{},446:{},448:{f:Ku},449:{f:nM,r:2},450:{f:Ku},512:{f:B3},513:{f:rB},515:{f:kM},516:{f:dM},517:{f:U3},519:{f:iB},520:{f:tM},523:{},545:{f:H3},549:{f:M3},566:{},574:{f:sM},638:{f:xM},659:{},1048:{},1054:{f:mM},1084:{},1212:{f:DM},2048:{f:GM},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:Im},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:Ku},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:QM,r:12},2173:{f:Xj,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:wi,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:LM,r:12},2197:{},2198:{f:Vj,r:12},2199:{},2200:{},2201:{},2202:{f:FM,r:12},2203:{f:Ku},2204:{},2205:{},2206:{},2207:{},2211:{f:rM},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:Ui},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:eB},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:KM},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:B3},1:{},2:{f:cB},3:{f:oB},4:{f:sB},5:{f:U3},7:{f:fB},8:{},9:{f:Im},11:{},22:{f:Ui},30:{f:vM},31:{},32:{},33:{f:H3},36:{},37:{f:M3},50:{f:hB},62:{},52:{},67:{},68:{f:Ui},69:{},86:{},126:{},127:{f:aB},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:dB},223:{},234:{},354:{},421:{},518:{f:t_},521:{f:Im},536:{f:z3},547:{f:q3},561:{},579:{},1030:{f:t_},1033:{f:Im},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function It(t,e,r,n){var i=e;if(!isNaN(i)){var a=n||(r||[]).length||0,o=t.next(4);o.write_shift(2,i),o.write_shift(2,a),a>0&&Dy(r)&&t.push(r)}}function fG(t,e,r,n){var i=(r||[]).length||0;if(i<=8224)return It(t,e,r,i);var a=e;if(!isNaN(a)){for(var o=r.parts||[],c=0,u=0,h=0;h+(o[c]||8224)<=8224;)h+=o[c]||8224,c++;var d=t.next(4);for(d.write_shift(2,a),d.write_shift(2,h),t.push(r.slice(u,u+h)),u+=h;u<i;){for(d=t.next(4),d.write_shift(2,60),h=0;h+(o[c]||8224)<=8224;)h+=o[c]||8224,c++;d.write_shift(2,h),t.push(r.slice(u,u+h)),u+=h}}}function yp(t,e,r){return t||(t=it(7)),t.write_shift(2,e),t.write_shift(2,r),t.write_shift(2,0),t.write_shift(1,0),t}function hG(t,e,r,n){var i=it(9);return yp(i,t,e),b6(r,n||"b",i),i}function dG(t,e,r){var n=it(8+2*r.length);return yp(n,t,e),n.write_shift(1,r.length),n.write_shift(r.length,r,"sbcs"),n.l<n.length?n.slice(0,n.l):n}function pG(t,e,r,n){if(e.v!=null)switch(e.t){case"d":case"n":var i=e.t=="d"?Zi(qn(e.v)):e.v;i==(i|0)&&i>=0&&i<65536?It(t,2,uB(r,n,i)):It(t,3,lB(r,n,i));return;case"b":case"e":It(t,5,hG(r,n,e.v,e.t));return;case"s":case"str":It(t,4,dG(r,n,(e.v||"").slice(0,255)));return}It(t,1,yp(null,r,n))}function mG(t,e,r,n){var i=Array.isArray(e),a=rn(e["!ref"]||"A1"),o,c="",u=[];if(a.e.c>255||a.e.r>16383){if(n.WTF)throw new Error("Range "+(e["!ref"]||"A1")+" exceeds format limit A1:IV16384");a.e.c=Math.min(a.e.c,255),a.e.r=Math.min(a.e.c,16383),o=wr(a)}for(var h=a.s.r;h<=a.e.r;++h){c=Ni(h);for(var d=a.s.c;d<=a.e.c;++d){h===a.s.r&&(u[d]=ei(d)),o=u[d]+c;var g=i?(e[h]||[])[d]:e[o];g&&pG(t,g,h,d)}}}function gG(t,e){for(var r=e||{},n=Ls(),i=0,a=0;a<t.SheetNames.length;++a)t.SheetNames[a]==r.sheet&&(i=a);if(i==0&&r.sheet&&t.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return It(n,r.biff==4?1033:r.biff==3?521:9,zy(t,16,r)),mG(n,t.Sheets[t.SheetNames[i]],i,r),It(n,10),n.end()}function vG(t,e,r){It(t,49,uM({sz:12,name:"Arial"},r))}function _G(t,e,r){e&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)e[i]!=null&&It(t,1054,gM(i,e[i],r))})}function xG(t,e){var r=it(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),It(t,2151,r),r=it(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),N6(rn(e["!ref"]||"A1"),r),r.write_shift(4,4),It(t,2152,r)}function yG(t,e){for(var r=0;r<16;++r)It(t,224,j3({numFmtId:0,style:!0},0,e));e.cellXfs.forEach(function(n){It(t,224,j3(n,0,e))})}function wG(t,e){for(var r=0;r<e["!links"].length;++r){var n=e["!links"][r];It(t,440,HM(n)),n[1].Tooltip&&It(t,2048,WM(n))}delete e["!links"]}function EG(t,e){if(e){var r=0;e.forEach(function(n,i){++r<=256&&n&&It(t,125,JM(y2(i,n),i))})}}function bG(t,e,r,n,i){var a=16+Of(i.cellXfs,e,i);if(e.v==null&&!e.bf){It(t,513,Nh(r,n,a));return}if(e.bf)It(t,6,KV(e,r,n,i,a));else switch(e.t){case"d":case"n":var o=e.t=="d"?Zi(qn(e.v)):e.v;It(t,515,NM(r,n,o,a));break;case"b":case"e":It(t,517,TM(r,n,e.v,a,i,e.t));break;case"s":case"str":if(i.bookSST){var c=Qy(i.Strings,e.v,i.revStrings);It(t,253,hM(r,n,c,a))}else It(t,516,pM(r,n,(e.v||"").slice(0,255),a,i));break;default:It(t,513,Nh(r,n,a))}}function SG(t,e,r){var n=Ls(),i=r.SheetNames[t],a=r.Sheets[i]||{},o=(r||{}).Workbook||{},c=(o.Sheets||[])[t]||{},u=Array.isArray(a),h=e.biff==8,d,g="",x=[],_=rn(a["!ref"]||"A1"),b=h?65536:16384;if(_.e.c>255||_.e.r>=b){if(e.WTF)throw new Error("Range "+(a["!ref"]||"A1")+" exceeds format limit A1:IV16384");_.e.c=Math.min(_.e.c,255),_.e.r=Math.min(_.e.c,b-1)}It(n,2057,zy(r,16,e)),It(n,13,Po(1)),It(n,12,Po(100)),It(n,15,fs(!0)),It(n,17,fs(!1)),It(n,16,Th(.001)),It(n,95,fs(!0)),It(n,42,fs(!1)),It(n,43,fs(!1)),It(n,130,Po(1)),It(n,128,AM()),It(n,131,fs(!1)),It(n,132,fs(!1)),h&&EG(n,a["!cols"]),It(n,512,_M(_,e)),h&&(a["!links"]=[]);for(var E=_.s.r;E<=_.e.r;++E){g=Ni(E);for(var A=_.s.c;A<=_.e.c;++A){E===_.s.r&&(x[A]=ei(A)),d=x[A]+g;var O=u?(a[E]||[])[A]:a[d];O&&(bG(n,O,E,A,e),h&&O.l&&a["!links"].push([d,O.l]))}}var M=c.CodeName||c.name||i;return h&&It(n,574,oM((o.Views||[])[0])),h&&(a["!merges"]||[]).length&&It(n,229,BM(a["!merges"])),h&&wG(n,a),It(n,442,S6(M)),h&&xG(n,a),It(n,10),n.end()}function AG(t,e,r){var n=Ls(),i=(t||{}).Workbook||{},a=i.Sheets||[],o=i.WBProps||{},c=r.biff==8,u=r.biff==5;if(It(n,2057,zy(t,5,r)),r.bookType=="xla"&&It(n,135),It(n,225,c?Po(1200):null),It(n,193,T9(2)),u&&It(n,191),u&&It(n,192),It(n,226),It(n,92,Y9("SheetJS",r)),It(n,66,Po(c?1200:1252)),c&&It(n,353,Po(0)),c&&It(n,448),It(n,317,tB(t.SheetNames.length)),c&&t.vbaraw&&It(n,211),c&&t.vbaraw){var h=o.CodeName||"ThisWorkbook";It(n,442,S6(h))}It(n,156,Po(17)),It(n,25,fs(!1)),It(n,18,fs(!1)),It(n,19,Po(0)),c&&It(n,431,fs(!1)),c&&It(n,444,Po(0)),It(n,61,aM()),It(n,64,fs(!1)),It(n,141,Po(0)),It(n,34,fs(nH(t)=="true")),It(n,14,fs(!0)),c&&It(n,439,fs(!1)),It(n,218,Po(0)),vG(n,t,r),_G(n,t.SSF,r),yG(n,r),c&&It(n,352,fs(!1));var d=n.end(),g=Ls();c&&It(g,140,YM()),c&&r.Strings&&fG(g,252,Z9(r.Strings)),It(g,10);var x=g.end(),_=Ls(),b=0,E=0;for(E=0;E<t.SheetNames.length;++E)b+=(c?12:11)+(c?2:1)*t.SheetNames[E].length;var A=d.length+b+x.length;for(E=0;E<t.SheetNames.length;++E){var O=a[E]||{};It(_,133,Q9({pos:A,hs:O.Hidden||0,dt:0,name:t.SheetNames[E]},r)),A+=e[E].length}var M=_.end();if(b!=M.length)throw new Error("BS8 "+b+" != "+M.length);var B=[];return d.length&&B.push(d),M.length&&B.push(M),x.length&&B.push(x),da(B)}function TG(t,e){var r=e||{},n=[];t&&!t.SSF&&(t.SSF=zn(sr)),t&&t.SSF&&(ud(),d2(t.SSF),r.revssf=m2(t.SSF),r.revssf[t.SSF[65535]]=0,r.ssf=t.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,r5(r),r.cellXfs=[],Of(r.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={});for(var i=0;i<t.SheetNames.length;++i)n[n.length]=SG(i,r,t);return n.unshift(AG(t,n,r)),da(n)}function vk(t,e){for(var r=0;r<=t.SheetNames.length;++r){var n=t.Sheets[t.SheetNames[r]];if(!(!n||!n["!ref"])){var i=Ds(n["!ref"]);i.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+t.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var a=e||{};switch(a.biff||2){case 8:case 5:return TG(t,e);case 4:case 3:case 2:return gG(t,e)}throw new Error("invalid type "+a.bookType+" for BIFF")}function eb(t,e){var r=e||{},n=r.dense?[]:{};t=t.replace(/<!--.*?-->/g,"");var i=t.match(/<table/i);if(!i)throw new Error("Invalid HTML: could not find <table>");var a=t.match(/<\/table/i),o=i.index,c=a&&a.index||t.length,u=uP(t.slice(o,c),/(:?<tr[^>]*>)/i,"<tr>"),h=-1,d=0,g=0,x=0,_={s:{r:1e7,c:1e7},e:{r:0,c:0}},b=[];for(o=0;o<u.length;++o){var E=u[o].trim(),A=E.slice(0,3).toLowerCase();if(A=="<tr"){if(++h,r.sheetRows&&r.sheetRows<=h){--h;break}d=0;continue}if(!(A!="<td"&&A!="<th")){var O=E.split(/<\/t[dh]>/i);for(c=0;c<O.length;++c){var M=O[c].trim();if(M.match(/<t[dh]/i)){for(var B=M,Q=0;B.charAt(0)=="<"&&(Q=B.indexOf(">"))>-1;)B=B.slice(Q+1);for(var ee=0;ee<b.length;++ee){var he=b[ee];he.s.c==d&&he.s.r<h&&h<=he.e.r&&(d=he.e.c+1,ee=-1)}var F=pr(M.slice(0,M.indexOf(">")));x=F.colspan?+F.colspan:1,((g=+F.rowspan)>1||x>1)&&b.push({s:{r:h,c:d},e:{r:h+(g||1)-1,c:d+x-1}});var k=F.t||F["data-t"]||"";if(!B.length){d+=x;continue}if(B=VT(B),_.s.r>h&&(_.s.r=h),_.e.r<h&&(_.e.r=h),_.s.c>d&&(_.s.c=d),_.e.c<d&&(_.e.c=d),!B.length){d+=x;continue}var S={t:"s",v:B};r.raw||!B.trim().length||k=="s"||(B==="TRUE"?S={t:"b",v:!0}:B==="FALSE"?S={t:"b",v:!1}:isNaN(xl(B))?isNaN(Q0(B).getDate())||(S={t:"d",v:qn(B)},r.cellDates||(S={t:"n",v:Zi(S.v)}),S.z=r.dateNF||sr[14]):S={t:"n",v:xl(B)}),r.dense?(n[h]||(n[h]=[]),n[h][d]=S):n[ur({r:h,c:d})]=S,d+=x}}}}return n["!ref"]=wr(_),b.length&&(n["!merges"]=b),n}function kG(t,e,r,n){for(var i=t["!merges"]||[],a=[],o=e.s.c;o<=e.e.c;++o){for(var c=0,u=0,h=0;h<i.length;++h)if(!(i[h].s.r>r||i[h].s.c>o)&&!(i[h].e.r<r||i[h].e.c<o)){if(i[h].s.r<r||i[h].s.c<o){c=-1;break}c=i[h].e.r-i[h].s.r+1,u=i[h].e.c-i[h].s.c+1;break}if(!(c<0)){var d=ur({r,c:o}),g=n.dense?(t[r]||[])[o]:t[d],x=g&&g.v!=null&&(g.h||Iy(g.w||(cu(g),g.w)||""))||"",_={};c>1&&(_.rowspan=c),u>1&&(_.colspan=u),n.editable?x='<span contenteditable="true">'+x+"</span>":g&&(_["data-t"]=g&&g.t||"z",g.v!=null&&(_["data-v"]=g.v),g.z!=null&&(_["data-z"]=g.z),g.l&&(g.l.Target||"#").charAt(0)!="#"&&(x='<a href="'+g.l.Target+'">'+x+"</a>")),_.id=(n.id||"sjs")+"-"+d,a.push(Ct("td",x,_))}}var b="<tr>";return b+a.join("")+"</tr>"}var NG='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',CG="</body></html>";function IG(t,e){var r=t.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return Ff(eb(r[0],e),e);var n=a5();return r.forEach(function(i,a){s5(n,eb(i,e),"Sheet"+(a+1))}),n}function RG(t,e,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function _k(t,e){var r=e||{},n=r.header!=null?r.header:NG,i=r.footer!=null?r.footer:CG,a=[n],o=Ds(t["!ref"]);r.dense=Array.isArray(t),a.push(RG(t,o,r));for(var c=o.s.r;c<=o.e.r;++c)a.push(kG(t,o,c,r));return a.push("</table>"+i),a.join("")}function xk(t,e,r){var n=r||{},i=0,a=0;if(n.origin!=null)if(typeof n.origin=="number")i=n.origin;else{var o=typeof n.origin=="string"?ti(n.origin):n.origin;i=o.r,a=o.c}var c=e.getElementsByTagName("tr"),u=Math.min(n.sheetRows||1e7,c.length),h={s:{r:0,c:0},e:{r:i,c:a}};if(t["!ref"]){var d=Ds(t["!ref"]);h.s.r=Math.min(h.s.r,d.s.r),h.s.c=Math.min(h.s.c,d.s.c),h.e.r=Math.max(h.e.r,d.e.r),h.e.c=Math.max(h.e.c,d.e.c),i==-1&&(h.e.r=i=d.e.r+1)}var g=[],x=0,_=t["!rows"]||(t["!rows"]=[]),b=0,E=0,A=0,O=0,M=0,B=0;for(t["!cols"]||(t["!cols"]=[]);b<c.length&&E<u;++b){var Q=c[b];if(tb(Q)){if(n.display)continue;_[E]={hidden:!0}}var ee=Q.children;for(A=O=0;A<ee.length;++A){var he=ee[A];if(!(n.display&&tb(he))){var F=he.hasAttribute("data-v")?he.getAttribute("data-v"):he.hasAttribute("v")?he.getAttribute("v"):VT(he.innerHTML),k=he.getAttribute("data-z")||he.getAttribute("z");for(x=0;x<g.length;++x){var S=g[x];S.s.c==O+a&&S.s.r<E+i&&E+i<=S.e.r&&(O=S.e.c+1-a,x=-1)}B=+he.getAttribute("colspan")||1,((M=+he.getAttribute("rowspan")||1)>1||B>1)&&g.push({s:{r:E+i,c:O+a},e:{r:E+i+(M||1)-1,c:O+a+(B||1)-1}});var U={t:"s",v:F},I=he.getAttribute("data-t")||he.getAttribute("t")||"";F!=null&&(F.length==0?U.t=I||"z":n.raw||F.trim().length==0||I=="s"||(F==="TRUE"?U={t:"b",v:!0}:F==="FALSE"?U={t:"b",v:!1}:isNaN(xl(F))?isNaN(Q0(F).getDate())||(U={t:"d",v:qn(F)},n.cellDates||(U={t:"n",v:Zi(U.v)}),U.z=n.dateNF||sr[14]):U={t:"n",v:xl(F)})),U.z===void 0&&k!=null&&(U.z=k);var C="",R=he.getElementsByTagName("A");if(R&&R.length)for(var se=0;se<R.length&&!(R[se].hasAttribute("href")&&(C=R[se].getAttribute("href"),C.charAt(0)!="#"));++se);C&&C.charAt(0)!="#"&&(U.l={Target:C}),n.dense?(t[E+i]||(t[E+i]=[]),t[E+i][O+a]=U):t[ur({c:O+a,r:E+i})]=U,h.e.c<O+a&&(h.e.c=O+a),O+=B}}++E}return g.length&&(t["!merges"]=(t["!merges"]||[]).concat(g)),h.e.r=Math.max(h.e.r,E-1+i),t["!ref"]=wr(h),E>=u&&(t["!fullref"]=wr((h.e.r=c.length-b+E-1+i,h))),t}function yk(t,e){var r=e||{},n=r.dense?[]:{};return xk(n,t,e)}function LG(t,e){return Ff(yk(t,e),e)}function tb(t){var e="",r=DG(t);return r&&(e=r(t).getPropertyValue("display")),e||(e=t.style&&t.style.display),e==="none"}function DG(t){return t.ownerDocument.defaultView&&typeof t.ownerDocument.defaultView.getComputedStyle=="function"?t.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function FG(t){var e=t.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,i){return Array(parseInt(i,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=tn(e.replace(/<[^>]*>/g,""));return[r]}var rb={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function wk(t,e){var r=e||{},n=Ry(t),i=[],a,o,c={name:""},u="",h=0,d,g,x={},_=[],b=r.dense?[]:{},E,A,O={value:""},M="",B=0,Q=[],ee=-1,he=-1,F={s:{r:1e6,c:1e7},e:{r:0,c:0}},k=0,S={},U=[],I={},C=0,R=0,se=[],ne=1,J=1,de=[],oe={Names:[]},Z={},X=["",""],xe=[],L={},j="",z=0,G=!1,ae=!1,Ae=0;for(q1.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");E=q1.exec(n);)switch(E[3]=E[3].replace(/_.*$/,"")){case"table":case"":E[1]==="/"?(F.e.c>=F.s.c&&F.e.r>=F.s.r?b["!ref"]=wr(F):b["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=F.e.r&&(b["!fullref"]=b["!ref"],F.e.r=r.sheetRows-1,b["!ref"]=wr(F)),U.length&&(b["!merges"]=U),se.length&&(b["!rows"]=se),d.name=d.||d.name,typeof JSON<"u"&&JSON.stringify(d),_.push(d.name),x[d.name]=b,ae=!1):E[0].charAt(E[0].length-2)!=="/"&&(d=pr(E[0],!1),ee=he=-1,F.s.r=F.s.c=1e7,F.e.r=F.e.c=0,b=r.dense?[]:{},U=[],se=[],ae=!0);break;case"table-row-group":E[1]==="/"?--k:++k;break;case"table-row":case"":if(E[1]==="/"){ee+=ne,ne=1;break}if(g=pr(E[0],!1),g.?ee=g.-1:ee==-1&&(ee=0),ne=+g["number-rows-repeated"]||1,ne<10)for(Ae=0;Ae<ne;++Ae)k>0&&(se[ee+Ae]={level:k});he=-1;break;case"covered-table-cell":E[1]!=="/"&&++he,r.sheetStubs&&(r.dense?(b[ee]||(b[ee]=[]),b[ee][he]={t:"z"}):b[ur({r:ee,c:he})]={t:"z"}),M="",Q=[];break;case"table-cell":case"":if(E[0].charAt(E[0].length-2)==="/")++he,O=pr(E[0],!1),J=parseInt(O["number-columns-repeated"]||"1",10),A={t:"z",v:null},O.formula&&r.cellFormula!=!1&&(A.f=Q3(tn(O.formula))),(O.||O["value-type"])=="string"&&(A.t="s",A.v=tn(O["string-value"]||""),r.dense?(b[ee]||(b[ee]=[]),b[ee][he]=A):b[ur({r:ee,c:he})]=A),he+=J-1;else if(E[1]!=="/"){++he,M="",B=0,Q=[],J=1;var _e=ne?ee+ne-1:ee;if(he>F.e.c&&(F.e.c=he),he<F.s.c&&(F.s.c=he),ee<F.s.r&&(F.s.r=ee),_e>F.e.r&&(F.e.r=_e),O=pr(E[0],!1),xe=[],L={},A={t:O.||O["value-type"],v:null},r.cellFormula)if(O.formula&&(O.formula=tn(O.formula)),O["number-matrix-columns-spanned"]&&O["number-matrix-rows-spanned"]&&(C=parseInt(O["number-matrix-rows-spanned"],10)||0,R=parseInt(O["number-matrix-columns-spanned"],10)||0,I={s:{r:ee,c:he},e:{r:ee+C-1,c:he+R-1}},A.F=wr(I),de.push([I,A.F])),O.formula)A.f=Q3(O.formula);else for(Ae=0;Ae<de.length;++Ae)ee>=de[Ae][0].s.r&&ee<=de[Ae][0].e.r&&he>=de[Ae][0].s.c&&he<=de[Ae][0].e.c&&(A.F=de[Ae][1]);switch((O["number-columns-spanned"]||O["number-rows-spanned"])&&(C=parseInt(O["number-rows-spanned"],10)||0,R=parseInt(O["number-columns-spanned"],10)||0,I={s:{r:ee,c:he},e:{r:ee+C-1,c:he+R-1}},U.push(I)),O["number-columns-repeated"]&&(J=parseInt(O["number-columns-repeated"],10)),A.t){case"boolean":A.t="b",A.v=jn(O["boolean-value"]);break;case"float":A.t="n",A.v=parseFloat(O.value);break;case"percentage":A.t="n",A.v=parseFloat(O.value);break;case"currency":A.t="n",A.v=parseFloat(O.value);break;case"date":A.t="d",A.v=qn(O["date-value"]),r.cellDates||(A.t="n",A.v=Zi(A.v)),A.z="m/d/yy";break;case"time":A.t="n",A.v=oP(O["time-value"])/86400,r.cellDates&&(A.t="d",A.v=g2(A.v)),A.z="HH:MM:SS";break;case"number":A.t="n",A.v=parseFloat(O.);break;default:if(A.t==="string"||A.t==="text"||!A.t)A.t="s",O["string-value"]!=null&&(M=tn(O["string-value"]),Q=[]);else throw new Error("Unsupported value type "+A.t)}}else{if(G=!1,A.t==="s"&&(A.v=M||"",Q.length&&(A.R=Q),G=B==0),Z.Target&&(A.l=Z),xe.length>0&&(A.c=xe,xe=[]),M&&r.cellText!==!1&&(A.w=M),G&&(A.t="z",delete A.v),(!G||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=ee))for(var Ee=0;Ee<ne;++Ee){if(J=parseInt(O["number-columns-repeated"]||"1",10),r.dense)for(b[ee+Ee]||(b[ee+Ee]=[]),b[ee+Ee][he]=Ee==0?A:zn(A);--J>0;)b[ee+Ee][he+J]=zn(A);else for(b[ur({r:ee+Ee,c:he})]=A;--J>0;)b[ur({r:ee+Ee,c:he+J})]=zn(A);F.e.c<=he&&(F.e.c=he)}J=parseInt(O["number-columns-repeated"]||"1",10),he+=J-1,J=0,A={},M="",Q=[]}Z={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(E[1]==="/"){if((a=i.pop())[0]!==E[3])throw"Bad state: "+a}else E[0].charAt(E[0].length-2)!=="/"&&i.push([E[3],!0]);break;case"annotation":if(E[1]==="/"){if((a=i.pop())[0]!==E[3])throw"Bad state: "+a;L.t=M,Q.length&&(L.R=Q),L.a=j,xe.push(L)}else E[0].charAt(E[0].length-2)!=="/"&&i.push([E[3],!1]);j="",z=0,M="",B=0,Q=[];break;case"creator":E[1]==="/"?j=n.slice(z,E.index):z=E.index+E[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(E[1]==="/"){if((a=i.pop())[0]!==E[3])throw"Bad state: "+a}else E[0].charAt(E[0].length-2)!=="/"&&i.push([E[3],!1]);M="",B=0,Q=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(E[1]==="/"){if(S[c.name]=u,(a=i.pop())[0]!==E[3])throw"Bad state: "+a}else E[0].charAt(E[0].length-2)!=="/"&&(u="",c=pr(E[0],!1),i.push([E[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(i[i.length-1][0]){case"time-style":case"date-style":o=pr(E[0],!1),u+=rb[E[3]][o.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(i[i.length-1][0]){case"time-style":case"date-style":o=pr(E[0],!1),u+=rb[E[3]][o.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(E[0].slice(-2)==="/>")break;if(E[1]==="/")switch(i[i.length-1][0]){case"number-style":case"date-style":case"time-style":u+=n.slice(h,E.index);break}else h=E.index+E[0].length;break;case"named-range":o=pr(E[0],!1),X=r_(o["cell-range-address"]);var Ce={Name:o.name,Ref:X[0]+"!"+X[1]};ae&&(Ce.Sheet=_.length),oe.Names.push(Ce);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(i[i.length-1][0])>-1)break;if(E[1]==="/"&&(!O||!O["string-value"])){var Oe=FG(n.slice(B,E.index));M=(M.length>0?M+`
`:"")+Oe[0]}else pr(E[0],!1),B=E.index+E[0].length;break;case"s":break;case"database-range":if(E[1]==="/")break;try{X=r_(pr(E[0])["target-range-address"]),x[X[0]]["!autofilter"]={ref:X[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(E[1]!=="/"){if(Z=pr(E[0],!1),!Z.href)break;Z.Target=tn(Z.href),delete Z.href,Z.Target.charAt(0)=="#"&&Z.Target.indexOf(".")>-1?(X=r_(Z.Target.slice(1)),Z.Target="#"+X[0]+"!"+X[1]):Z.Target.match(/^\.\.[\\\/]/)&&(Z.Target=Z.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(E[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(r.WTF)throw new Error(E)}}var fe={Sheets:x,SheetNames:_,Workbook:oe};return r.bookSheets&&delete fe.Sheets,fe}function nb(t,e){e=e||{},Oo(t,"META-INF/manifest.xml")&&o9(ji(t,"META-INF/manifest.xml"),e);var r=to(t,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var n=wk(Cn(r),e);return Oo(t,"meta.xml")&&(n.Props=f6(ji(t,"meta.xml"))),n}function ib(t,e){return wk(t,e)}var OG=function(){var t=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),e="<office:document-styles "+V1({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+t+"</office:document-styles>";return function(){return Ci+e}}(),ab=function(){var t=function(a){return bn(a).replace(/  +/g,function(o){return'<text:s text:c="'+o.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},e=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,n=function(a,o,c){var u=[];u.push('      <table:table table:name="'+bn(o.SheetNames[c])+`" table:style-name="ta1">
`);var h=0,d=0,g=Ds(a["!ref"]||"A1"),x=a["!merges"]||[],_=0,b=Array.isArray(a);if(a["!cols"])for(d=0;d<=g.e.c;++d)u.push("        <table:table-column"+(a["!cols"][d]?' table:style-name="co'+a["!cols"][d].ods+'"':"")+`></table:table-column>
`);var E="",A=a["!rows"]||[];for(h=0;h<g.s.r;++h)E=A[h]?' table:style-name="ro'+A[h].ods+'"':"",u.push("        <table:table-row"+E+`></table:table-row>
`);for(;h<=g.e.r;++h){for(E=A[h]?' table:style-name="ro'+A[h].ods+'"':"",u.push("        <table:table-row"+E+`>
`),d=0;d<g.s.c;++d)u.push(e);for(;d<=g.e.c;++d){var O=!1,M={},B="";for(_=0;_!=x.length;++_)if(!(x[_].s.c>d)&&!(x[_].s.r>h)&&!(x[_].e.c<d)&&!(x[_].e.r<h)){(x[_].s.c!=d||x[_].s.r!=h)&&(O=!0),M["table:number-columns-spanned"]=x[_].e.c-x[_].s.c+1,M["table:number-rows-spanned"]=x[_].e.r-x[_].s.r+1;break}if(O){u.push(r);continue}var Q=ur({r:h,c:d}),ee=b?(a[h]||[])[d]:a[Q];if(ee&&ee.f&&(M["table:formula"]=bn(tq(ee.f)),ee.F&&ee.F.slice(0,Q.length)==Q)){var he=Ds(ee.F);M["table:number-matrix-columns-spanned"]=he.e.c-he.s.c+1,M["table:number-matrix-rows-spanned"]=he.e.r-he.s.r+1}if(!ee){u.push(e);continue}switch(ee.t){case"b":B=ee.v?"TRUE":"FALSE",M["office:value-type"]="boolean",M["office:boolean-value"]=ee.v?"true":"false";break;case"n":B=ee.w||String(ee.v||0),M["office:value-type"]="float",M["office:value"]=ee.v||0;break;case"s":case"str":B=ee.v==null?"":ee.v,M["office:value-type"]="string";break;case"d":B=ee.w||qn(ee.v).toISOString(),M["office:value-type"]="date",M["office:date-value"]=qn(ee.v).toISOString(),M["table:style-name"]="ce1";break;default:u.push(e);continue}var F=t(B);if(ee.l&&ee.l.Target){var k=ee.l.Target;k=k.charAt(0)=="#"?"#"+rq(k.slice(1)):k,k.charAt(0)!="#"&&!k.match(/^\w+:/)&&(k="../"+k),F=Ct("text:a",F,{"xlink:href":k.replace(/&/g,"&amp;")})}u.push("          "+Ct("table:table-cell",Ct("text:p",F,{}),M)+`
`)}u.push(`        </table:table-row>
`)}return u.push(`      </table:table>
`),u.join("")},i=function(a,o){a.push(` <office:automatic-styles>
`),a.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),a.push(`   <number:month number:style="long"/>
`),a.push(`   <number:text>/</number:text>
`),a.push(`   <number:day number:style="long"/>
`),a.push(`   <number:text>/</number:text>
`),a.push(`   <number:year/>
`),a.push(`  </number:date-style>
`);var c=0;o.SheetNames.map(function(h){return o.Sheets[h]}).forEach(function(h){if(h&&h["!cols"]){for(var d=0;d<h["!cols"].length;++d)if(h["!cols"][d]){var g=h["!cols"][d];if(g.width==null&&g.wpx==null&&g.wch==null)continue;Ef(g),g.ods=c;var x=h["!cols"][d].wpx+"px";a.push('  <style:style style:name="co'+c+`" style:family="table-column">
`),a.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+x+`"/>
`),a.push(`  </style:style>
`),++c}}});var u=0;o.SheetNames.map(function(h){return o.Sheets[h]}).forEach(function(h){if(h&&h["!rows"]){for(var d=0;d<h["!rows"].length;++d)if(h["!rows"][d]){h["!rows"][d].ods=u;var g=h["!rows"][d].hpx+"px";a.push('  <style:style style:name="ro'+u+`" style:family="table-row">
`),a.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+g+`"/>
`),a.push(`  </style:style>
`),++u}}}),a.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),a.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),a.push(`  </style:style>
`),a.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),a.push(` </office:automatic-styles>
`)};return function(o,c){var u=[Ci],h=V1({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),d=V1({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});c.bookType=="fods"?(u.push("<office:document"+h+d+`>
`),u.push(u6().replace(/office:document-meta/g,"office:meta"))):u.push("<office:document-content"+h+`>
`),i(u,o),u.push(`  <office:body>
`),u.push(`    <office:spreadsheet>
`);for(var g=0;g!=o.SheetNames.length;++g)u.push(n(o.Sheets[o.SheetNames[g]],o,g));return u.push(`    </office:spreadsheet>
`),u.push(`  </office:body>
`),c.bookType=="fods"?u.push("</office:document>"):u.push("</office:document-content>"),u.join("")}}();function Ek(t,e){if(e.bookType=="fods")return ab(t,e);var r=ky(),n="",i=[],a=[];return n="mimetype",Sr(r,n,"application/vnd.oasis.opendocument.spreadsheet"),n="content.xml",Sr(r,n,ab(t,e)),i.push([n,"text/xml"]),a.push([n,"ContentFile"]),n="styles.xml",Sr(r,n,OG(t,e)),i.push([n,"text/xml"]),a.push([n,"StylesFile"]),n="meta.xml",Sr(r,n,Ci+u6()),i.push([n,"text/xml"]),a.push([n,"MetadataFile"]),n="manifest.rdf",Sr(r,n,u9(a)),i.push([n,"application/rdf+xml"]),n="META-INF/manifest.xml",Sr(r,n,l9(i)),r}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function Ch(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}function ax(t){return typeof TextDecoder<"u"?new TextDecoder().decode(t):Cn(Df(t))}function PG(t){return typeof TextEncoder<"u"?new TextEncoder().encode(t):eo(oc(t))}function MG(t,e){e:for(var r=0;r<=t.length-e.length;++r){for(var n=0;n<e.length;++n)if(t[r+n]!=e[n])continue e;return!0}return!1}function Sf(t){var e=t.reduce(function(i,a){return i+a.length},0),r=new Uint8Array(e),n=0;return t.forEach(function(i){r.set(i,n),n+=i.length}),r}function sb(t){return t-=t>>1&1431655765,t=(t&858993459)+(t>>2&858993459),(t+(t>>4)&252645135)*16843009>>>24}function BG(t,e){for(var r=(t[e+15]&127)<<7|t[e+14]>>1,n=t[e+14]&1,i=e+13;i>=e;--i)n=n*256+t[i];return(t[e+15]&128?-n:n)*Math.pow(10,r-6176)}function jG(t,e,r){var n=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,i=r/Math.pow(10,n-6176);t[e+15]|=n>>7,t[e+14]|=(n&127)<<1;for(var a=0;i>=1;++a,i/=256)t[e+a]=i&255;t[e+15]|=r>=0?0:128}function K1(t,e){var r=e?e[0]:0,n=t[r]&127;e:if(t[r++]>=128&&(n|=(t[r]&127)<<7,t[r++]<128||(n|=(t[r]&127)<<14,t[r++]<128)||(n|=(t[r]&127)<<21,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,28),++r,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,35),++r,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,42),++r,t[r++]<128)))break e;return e&&(e[0]=r),n}function wn(t){var e=new Uint8Array(7);e[0]=t&127;var r=1;e:if(t>127){if(e[r-1]|=128,e[r]=t>>7&127,++r,t<=16383||(e[r-1]|=128,e[r]=t>>14&127,++r,t<=2097151)||(e[r-1]|=128,e[r]=t>>21&127,++r,t<=268435455)||(e[r-1]|=128,e[r]=t/256>>>21&127,++r,t<=34359738367)||(e[r-1]|=128,e[r]=t/65536>>>21&127,++r,t<=4398046511103))break e;e[r-1]|=128,e[r]=t/16777216>>>21&127,++r}return e.slice(0,r)}function fi(t){var e=0,r=t[e]&127;e:if(t[e++]>=128){if(r|=(t[e]&127)<<7,t[e++]<128||(r|=(t[e]&127)<<14,t[e++]<128)||(r|=(t[e]&127)<<21,t[e++]<128))break e;r|=(t[e]&127)<<28}return r}function un(t){for(var e=[],r=[0];r[0]<t.length;){var n=r[0],i=K1(t,r),a=i&7;i=Math.floor(i/8);var o=0,c;if(i==0)break;switch(a){case 0:{for(var u=r[0];t[r[0]++]>=128;);c=t.slice(u,r[0])}break;case 5:o=4,c=t.slice(r[0],r[0]+o),r[0]+=o;break;case 1:o=8,c=t.slice(r[0],r[0]+o),r[0]+=o;break;case 2:o=K1(t,r),c=t.slice(r[0],r[0]+o),r[0]+=o;break;case 3:case 4:default:throw new Error("PB Type ".concat(a," for Field ").concat(i," at offset ").concat(n))}var h={data:c,type:a};e[i]==null?e[i]=[h]:e[i].push(h)}return e}function Aa(t){var e=[];return t.forEach(function(r,n){r.forEach(function(i){i.data&&(e.push(wn(n*8+i.type)),i.type==2&&e.push(wn(i.data.length)),e.push(i.data))})}),Sf(e)}function e5(t,e){return t?.map(function(r){return e(r.data)})||[]}function Do(t){for(var e,r=[],n=[0];n[0]<t.length;){var i=K1(t,n),a=un(t.slice(n[0],n[0]+i));n[0]+=i;var o={id:fi(a[1][0].data),messages:[]};a[2].forEach(function(c){var u=un(c.data),h=fi(u[3][0].data);o.messages.push({meta:u,data:t.slice(n[0],n[0]+h)}),n[0]+=h}),(e=a[3])!=null&&e[0]&&(o.merge=fi(a[3][0].data)>>>0>0),r.push(o)}return r}function _0(t){var e=[];return t.forEach(function(r){var n=[];n[1]=[{data:wn(r.id),type:0}],n[2]=[],r.merge!=null&&(n[3]=[{data:wn(+!!r.merge),type:0}]);var i=[];r.messages.forEach(function(o){i.push(o.data),o.meta[3]=[{type:0,data:wn(o.data.length)}],n[2].push({data:Aa(o.meta),type:2})});var a=Aa(n);e.push(wn(a.length)),e.push(a),i.forEach(function(o){return e.push(o)})}),Sf(e)}function UG(t,e){if(t!=0)throw new Error("Unexpected Snappy chunk type ".concat(t));for(var r=[0],n=K1(e,r),i=[];r[0]<e.length;){var a=e[r[0]]&3;if(a==0){var o=e[r[0]++]>>2;if(o<60)++o;else{var c=o-59;o=e[r[0]],c>1&&(o|=e[r[0]+1]<<8),c>2&&(o|=e[r[0]+2]<<16),c>3&&(o|=e[r[0]+3]<<24),o>>>=0,o++,r[0]+=c}i.push(e.slice(r[0],r[0]+o)),r[0]+=o;continue}else{var u=0,h=0;if(a==1?(h=(e[r[0]]>>2&7)+4,u=(e[r[0]++]&224)<<3,u|=e[r[0]++]):(h=(e[r[0]++]>>2)+1,a==2?(u=e[r[0]]|e[r[0]+1]<<8,r[0]+=2):(u=(e[r[0]]|e[r[0]+1]<<8|e[r[0]+2]<<16|e[r[0]+3]<<24)>>>0,r[0]+=4)),i=[Sf(i)],u==0)throw new Error("Invalid offset 0");if(u>i[0].length)throw new Error("Invalid offset beyond length");if(h>=u)for(i.push(i[0].slice(-u)),h-=u;h>=i[i.length-1].length;)i.push(i[i.length-1]),h-=i[i.length-1].length;i.push(i[0].slice(-u,-u+h))}}var d=Sf(i);if(d.length!=n)throw new Error("Unexpected length: ".concat(d.length," != ").concat(n));return d}function Fo(t){for(var e=[],r=0;r<t.length;){var n=t[r++],i=t[r]|t[r+1]<<8|t[r+2]<<16;r+=3,e.push(UG(n,t.slice(r,r+i))),r+=i}if(r!==t.length)throw new Error("data is not a valid framed stream!");return Sf(e)}function x0(t){for(var e=[],r=0;r<t.length;){var n=Math.min(t.length-r,268435455),i=new Uint8Array(4);e.push(i);var a=wn(n),o=a.length;e.push(a),n<=60?(o++,e.push(new Uint8Array([n-1<<2]))):n<=256?(o+=2,e.push(new Uint8Array([240,n-1&255]))):n<=65536?(o+=3,e.push(new Uint8Array([244,n-1&255,n-1>>8&255]))):n<=16777216?(o+=4,e.push(new Uint8Array([248,n-1&255,n-1>>8&255,n-1>>16&255]))):n<=4294967296&&(o+=5,e.push(new Uint8Array([252,n-1&255,n-1>>8&255,n-1>>16&255,n-1>>>24&255]))),e.push(t.slice(r,r+n)),o+=n,i[0]=0,i[1]=o&255,i[2]=o>>8&255,i[3]=o>>16&255,r+=n}return Sf(e)}function VG(t,e,r,n){var i=Ch(t),a=i.getUint32(4,!0),o=(n>1?12:8)+sb(a&(n>1?3470:398))*4,c=-1,u=-1,h=NaN,d=new Date(2001,0,1);a&512&&(c=i.getUint32(o,!0),o+=4),o+=sb(a&(n>1?12288:4096))*4,a&16&&(u=i.getUint32(o,!0),o+=4),a&32&&(h=i.getFloat64(o,!0),o+=8),a&64&&(d.setTime(d.getTime()+i.getFloat64(o,!0)*1e3),o+=8);var g;switch(t[2]){case 0:break;case 2:g={t:"n",v:h};break;case 3:g={t:"s",v:e[u]};break;case 5:g={t:"d",v:d};break;case 6:g={t:"b",v:h>0};break;case 7:g={t:"n",v:h/86400};break;case 8:g={t:"e",v:0};break;case 9:if(c>-1)g={t:"s",v:r[c]};else if(u>-1)g={t:"s",v:e[u]};else if(!isNaN(h))g={t:"n",v:h};else throw new Error("Unsupported cell type ".concat(t.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(t.slice(0,4)))}return g}function qG(t,e,r){var n=Ch(t),i=n.getUint32(8,!0),a=12,o=-1,c=-1,u=NaN,h=NaN,d=new Date(2001,0,1);i&1&&(u=BG(t,a),a+=16),i&2&&(h=n.getFloat64(a,!0),a+=8),i&4&&(d.setTime(d.getTime()+n.getFloat64(a,!0)*1e3),a+=8),i&8&&(c=n.getUint32(a,!0),a+=4),i&16&&(o=n.getUint32(a,!0),a+=4);var g;switch(t[1]){case 0:break;case 2:g={t:"n",v:u};break;case 3:g={t:"s",v:e[c]};break;case 5:g={t:"d",v:d};break;case 6:g={t:"b",v:h>0};break;case 7:g={t:"n",v:h/86400};break;case 8:g={t:"e",v:0};break;case 9:if(o>-1)g={t:"s",v:r[o]};else throw new Error("Unsupported cell type ".concat(t[1]," : ").concat(i&31," : ").concat(t.slice(0,4)));break;case 10:g={t:"n",v:u};break;default:throw new Error("Unsupported cell type ".concat(t[1]," : ").concat(i&31," : ").concat(t.slice(0,4)))}return g}function i_(t,e){var r=new Uint8Array(32),n=Ch(r),i=12,a=0;switch(r[0]=5,t.t){case"n":r[1]=2,jG(r,i,t.v),a|=1,i+=16;break;case"b":r[1]=6,n.setFloat64(i,t.v?1:0,!0),a|=2,i+=8;break;case"s":if(e.indexOf(t.v)==-1)throw new Error("Value ".concat(t.v," missing from SST!"));r[1]=3,n.setUint32(i,e.indexOf(t.v),!0),a|=8,i+=4;break;default:throw"unsupported cell type "+t.t}return n.setUint32(8,a,!0),r.slice(0,i)}function a_(t,e){var r=new Uint8Array(32),n=Ch(r),i=12,a=0;switch(r[0]=3,t.t){case"n":r[2]=2,n.setFloat64(i,t.v,!0),a|=32,i+=8;break;case"b":r[2]=6,n.setFloat64(i,t.v?1:0,!0),a|=32,i+=8;break;case"s":if(e.indexOf(t.v)==-1)throw new Error("Value ".concat(t.v," missing from SST!"));r[2]=3,n.setUint32(i,e.indexOf(t.v),!0),a|=16,i+=4;break;default:throw"unsupported cell type "+t.t}return n.setUint32(4,a,!0),r.slice(0,i)}function zG(t,e,r){switch(t[0]){case 0:case 1:case 2:case 3:return VG(t,e,r,t[0]);case 5:return qG(t,e,r);default:throw new Error("Unsupported payload version ".concat(t[0]))}}function $a(t){var e=un(t);return K1(e[1][0].data)}function ob(t,e){var r=un(e.data),n=fi(r[1][0].data),i=r[3],a=[];return(i||[]).forEach(function(o){var c=un(o.data),u=fi(c[1][0].data)>>>0;switch(n){case 1:a[u]=ax(c[3][0].data);break;case 8:{var h=t[$a(c[9][0].data)][0],d=un(h.data),g=t[$a(d[1][0].data)][0],x=fi(g.meta[1][0].data);if(x!=2001)throw new Error("2000 unexpected reference to ".concat(x));var _=un(g.data);a[u]=_[3].map(function(b){return ax(b.data)}).join("")}break}}),a}function HG(t,e){var r,n,i,a,o,c,u,h,d,g,x,_,b,E,A=un(t),O=fi(A[1][0].data)>>>0,M=fi(A[2][0].data)>>>0,B=((n=(r=A[8])==null?void 0:r[0])==null?void 0:n.data)&&fi(A[8][0].data)>0||!1,Q,ee;if((a=(i=A[7])==null?void 0:i[0])!=null&&a.data&&e!=0)Q=(c=(o=A[7])==null?void 0:o[0])==null?void 0:c.data,ee=(h=(u=A[6])==null?void 0:u[0])==null?void 0:h.data;else if((g=(d=A[4])==null?void 0:d[0])!=null&&g.data&&e!=1)Q=(_=(x=A[4])==null?void 0:x[0])==null?void 0:_.data,ee=(E=(b=A[3])==null?void 0:b[0])==null?void 0:E.data;else throw"NUMBERS Tile missing ".concat(e," cell storage");for(var he=B?4:1,F=Ch(Q),k=[],S=0;S<Q.length/2;++S){var U=F.getUint16(S*2,!0);U<65535&&k.push([S,U])}if(k.length!=M)throw"Expected ".concat(M," cells, found ").concat(k.length);var I=[];for(S=0;S<k.length-1;++S)I[k[S][0]]=ee.subarray(k[S][1]*he,k[S+1][1]*he);return k.length>=1&&(I[k[k.length-1][0]]=ee.subarray(k[k.length-1][1]*he)),{R:O,cells:I}}function GG(t,e){var r,n=un(e.data),i=(r=n?.[7])!=null&&r[0]?fi(n[7][0].data)>>>0>0?1:0:-1,a=e5(n[5],function(o){return HG(o,i)});return{nrows:fi(n[4][0].data)>>>0,data:a.reduce(function(o,c){return o[c.R]||(o[c.R]=[]),c.cells.forEach(function(u,h){if(o[c.R][h])throw new Error("Duplicate cell r=".concat(c.R," c=").concat(h));o[c.R][h]=u}),o},[])}}function WG(t,e,r){var n,i=un(e.data),a={s:{r:0,c:0},e:{r:0,c:0}};if(a.e.r=(fi(i[6][0].data)>>>0)-1,a.e.r<0)throw new Error("Invalid row varint ".concat(i[6][0].data));if(a.e.c=(fi(i[7][0].data)>>>0)-1,a.e.c<0)throw new Error("Invalid col varint ".concat(i[7][0].data));r["!ref"]=wr(a);var o=un(i[4][0].data),c=ob(t,t[$a(o[4][0].data)][0]),u=(n=o[17])!=null&&n[0]?ob(t,t[$a(o[17][0].data)][0]):[],h=un(o[3][0].data),d=0;h[1].forEach(function(g){var x=un(g.data),_=t[$a(x[2][0].data)][0],b=fi(_.meta[1][0].data);if(b!=6002)throw new Error("6001 unexpected reference to ".concat(b));var E=GG(t,_);E.data.forEach(function(A,O){A.forEach(function(M,B){var Q=ur({r:d+O,c:B}),ee=zG(M,c,u);ee&&(r[Q]=ee)})}),d+=E.nrows})}function XG(t,e){var r=un(e.data),n={"!ref":"A1"},i=t[$a(r[2][0].data)],a=fi(i[0].meta[1][0].data);if(a!=6001)throw new Error("6000 unexpected reference to ".concat(a));return WG(t,i[0],n),n}function YG(t,e){var r,n=un(e.data),i={name:(r=n[1])!=null&&r[0]?ax(n[1][0].data):"",sheets:[]},a=e5(n[2],$a);return a.forEach(function(o){t[o].forEach(function(c){var u=fi(c.meta[1][0].data);u==6e3&&i.sheets.push(XG(t,c))})}),i}function KG(t,e){var r=a5(),n=un(e.data),i=e5(n[1],$a);if(i.forEach(function(a){t[a].forEach(function(o){var c=fi(o.meta[1][0].data);if(c==2){var u=YG(t,o);u.sheets.forEach(function(h,d){s5(r,h,d==0?u.name:u.name+"_"+d,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function s_(t){var e,r,n,i,a={},o=[];if(t.FullPaths.forEach(function(u){if(u.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),t.FileIndex.forEach(function(u){if(u.name.match(/\.iwa$/)){var h;try{h=Fo(u.content)}catch(g){return console.log("?? "+u.content.length+" "+(g.message||g))}var d;try{d=Do(h)}catch(g){return console.log("## "+(g.message||g))}d.forEach(function(g){a[g.id]=g.messages,o.push(g.id)})}}),!o.length)throw new Error("File has no messages");var c=((i=(n=(r=(e=a?.[1])==null?void 0:e[0])==null?void 0:r.meta)==null?void 0:n[1])==null?void 0:i[0].data)&&fi(a[1][0].meta[1][0].data)==1&&a[1][0];if(c||o.forEach(function(u){a[u].forEach(function(h){var d=fi(h.meta[1][0].data)>>>0;if(d==1)if(!c)c=h;else throw new Error("Document has multiple roots")})}),!c)throw new Error("Cannot find Document root");return KG(a,c)}function $G(t,e,r){var n,i,a,o;if(!((n=t[6])!=null&&n[0])||!((i=t[7])!=null&&i[0]))throw"Mutation only works on post-BNC storages!";var c=((o=(a=t[8])==null?void 0:a[0])==null?void 0:o.data)&&fi(t[8][0].data)>0||!1;if(c)throw"Math only works with normal offsets";for(var u=0,h=Ch(t[7][0].data),d=0,g=[],x=Ch(t[4][0].data),_=0,b=[],E=0;E<e.length;++E){if(e[E]==null){h.setUint16(E*2,65535,!0),x.setUint16(E*2,65535);continue}h.setUint16(E*2,d,!0),x.setUint16(E*2,_,!0);var A,O;switch(typeof e[E]){case"string":A=i_({t:"s",v:e[E]},r),O=a_({t:"s",v:e[E]},r);break;case"number":A=i_({t:"n",v:e[E]},r),O=a_({t:"n",v:e[E]},r);break;case"boolean":A=i_({t:"b",v:e[E]},r),O=a_({t:"b",v:e[E]},r);break;default:throw new Error("Unsupported value "+e[E])}g.push(A),d+=A.length,b.push(O),_+=O.length,++u}for(t[2][0].data=wn(u);E<t[7][0].data.length/2;++E)h.setUint16(E*2,65535,!0),x.setUint16(E*2,65535,!0);return t[6][0].data=Sf(g),t[3][0].data=Sf(b),u}function QG(t,e){if(!e||!e.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=t.Sheets[t.SheetNames[0]];t.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var n=Ds(r["!ref"]);n.s.r=n.s.c=0;var i=!1;n.e.c>9&&(i=!0,n.e.c=9),n.e.r>49&&(i=!0,n.e.r=49),i&&console.error("The Numbers writer is currently limited to ".concat(wr(n)));var a=jg(r,{range:n,header:1}),o=["~Sh33tJ5~"];a.forEach(function(j){return j.forEach(function(z){typeof z=="string"&&o.push(z)})});var c={},u=[],h=Qt.read(e.numbers,{type:"base64"});h.FileIndex.map(function(j,z){return[j,h.FullPaths[z]]}).forEach(function(j){var z=j[0],G=j[1];if(z.type==2&&z.name.match(/\.iwa/)){var ae=z.content,Ae=Fo(ae),_e=Do(Ae);_e.forEach(function(Ee){u.push(Ee.id),c[Ee.id]={deps:[],location:G,type:fi(Ee.messages[0].meta[1][0].data)}})}}),u.sort(function(j,z){return j-z});var d=u.filter(function(j){return j>1}).map(function(j){return[j,wn(j)]});h.FileIndex.map(function(j,z){return[j,h.FullPaths[z]]}).forEach(function(j){var z=j[0];if(j[1],!!z.name.match(/\.iwa/)){var G=Do(Fo(z.content));G.forEach(function(ae){ae.messages.forEach(function(Ae){d.forEach(function(_e){ae.messages.some(function(Ee){return fi(Ee.meta[1][0].data)!=11006&&MG(Ee.data,_e[1])})&&c[_e[0]].deps.push(ae.id)})})})}});for(var g=Qt.find(h,c[1].location),x=Do(Fo(g.content)),_,b=0;b<x.length;++b){var E=x[b];E.id==1&&(_=E)}var A=$a(un(_.messages[0].data)[1][0].data);for(g=Qt.find(h,c[A].location),x=Do(Fo(g.content)),b=0;b<x.length;++b)E=x[b],E.id==A&&(_=E);for(A=$a(un(_.messages[0].data)[2][0].data),g=Qt.find(h,c[A].location),x=Do(Fo(g.content)),b=0;b<x.length;++b)E=x[b],E.id==A&&(_=E);for(A=$a(un(_.messages[0].data)[2][0].data),g=Qt.find(h,c[A].location),x=Do(Fo(g.content)),b=0;b<x.length;++b)E=x[b],E.id==A&&(_=E);var O=un(_.messages[0].data);{O[6][0].data=wn(n.e.r+1),O[7][0].data=wn(n.e.c+1);var M=$a(O[46][0].data),B=Qt.find(h,c[M].location),Q=Do(Fo(B.content));{for(var ee=0;ee<Q.length&&Q[ee].id!=M;++ee);if(Q[ee].id!=M)throw"Bad ColumnRowUIDMapArchive";var he=un(Q[ee].messages[0].data);he[1]=[],he[2]=[],he[3]=[];for(var F=0;F<=n.e.c;++F){var k=[];k[1]=k[2]=[{type:0,data:wn(F+420690)}],he[1].push({type:2,data:Aa(k)}),he[2].push({type:0,data:wn(F)}),he[3].push({type:0,data:wn(F)})}he[4]=[],he[5]=[],he[6]=[];for(var S=0;S<=n.e.r;++S)k=[],k[1]=k[2]=[{type:0,data:wn(S+726270)}],he[4].push({type:2,data:Aa(k)}),he[5].push({type:0,data:wn(S)}),he[6].push({type:0,data:wn(S)});Q[ee].messages[0].data=Aa(he)}B.content=x0(_0(Q)),B.size=B.content.length,delete O[46];var U=un(O[4][0].data);{U[7][0].data=wn(n.e.r+1);var I=un(U[1][0].data),C=$a(I[2][0].data);B=Qt.find(h,c[C].location),Q=Do(Fo(B.content));{if(Q[0].id!=C)throw"Bad HeaderStorageBucket";var R=un(Q[0].messages[0].data);for(S=0;S<a.length;++S){var se=un(R[2][0].data);se[1][0].data=wn(S),se[4][0].data=wn(a[S].length),R[2][S]={type:R[2][0].type,data:Aa(se)}}Q[0].messages[0].data=Aa(R)}B.content=x0(_0(Q)),B.size=B.content.length;var ne=$a(U[2][0].data);B=Qt.find(h,c[ne].location),Q=Do(Fo(B.content));{if(Q[0].id!=ne)throw"Bad HeaderStorageBucket";for(R=un(Q[0].messages[0].data),F=0;F<=n.e.c;++F)se=un(R[2][0].data),se[1][0].data=wn(F),se[4][0].data=wn(n.e.r+1),R[2][F]={type:R[2][0].type,data:Aa(se)};Q[0].messages[0].data=Aa(R)}B.content=x0(_0(Q)),B.size=B.content.length;var J=$a(U[4][0].data);(function(){for(var j=Qt.find(h,c[J].location),z=Do(Fo(j.content)),G,ae=0;ae<z.length;++ae){var Ae=z[ae];Ae.id==J&&(G=Ae)}var _e=un(G.messages[0].data);{_e[3]=[];var Ee=[];o.forEach(function(fe,rt){Ee[1]=[{type:0,data:wn(rt)}],Ee[2]=[{type:0,data:wn(1)}],Ee[3]=[{type:2,data:PG(fe)}],_e[3].push({type:2,data:Aa(Ee)})})}G.messages[0].data=Aa(_e);var Ce=_0(z),Oe=x0(Ce);j.content=Oe,j.size=j.content.length})();var de=un(U[3][0].data);{var oe=de[1][0];delete de[2];var Z=un(oe.data);{var X=$a(Z[2][0].data);(function(){for(var j=Qt.find(h,c[X].location),z=Do(Fo(j.content)),G,ae=0;ae<z.length;++ae){var Ae=z[ae];Ae.id==X&&(G=Ae)}var _e=un(G.messages[0].data);{delete _e[6],delete de[7];var Ee=new Uint8Array(_e[5][0].data);_e[5]=[];for(var Ce=0,Oe=0;Oe<=n.e.r;++Oe){var fe=un(Ee);Ce+=$G(fe,a[Oe],o),fe[1][0].data=wn(Oe),_e[5].push({data:Aa(fe),type:2})}_e[1]=[{type:0,data:wn(n.e.c+1)}],_e[2]=[{type:0,data:wn(n.e.r+1)}],_e[3]=[{type:0,data:wn(Ce)}],_e[4]=[{type:0,data:wn(n.e.r+1)}]}G.messages[0].data=Aa(_e);var rt=_0(z),ot=x0(rt);j.content=ot,j.size=j.content.length})()}oe.data=Aa(Z)}U[3][0].data=Aa(de)}O[4][0].data=Aa(U)}_.messages[0].data=Aa(O);var xe=_0(x),L=x0(xe);return g.content=L,g.size=g.content.length,h}function bk(t){return function(r){for(var n=0;n!=t.length;++n){var i=t[n];r[i[0]]===void 0&&(r[i[0]]=i[1]),i[2]==="n"&&(r[i[0]]=Number(r[i[0]]))}}}function t5(t){bk([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(t)}function r5(t){bk([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(t)}function JG(t){return Br.WS.indexOf(t)>-1?"sheet":t==Br.CS?"chart":t==Br.DS?"dialog":t==Br.MS?"macro":t&&t.length?t:"sheet"}function ZG(t,e){if(!t)return 0;try{t=e.map(function(n){return n.id||(n.id=n.strRelID),[n.name,t["!id"][n.id].Target,JG(t["!id"][n.id].Type)]})}catch{return null}return!t||t.length===0?null:t}function eW(t,e,r,n,i,a,o,c,u,h,d,g){try{a[n]=y1(to(t,r,!0),e);var x=ji(t,e),_;switch(c){case"sheet":_=EH(x,e,i,u,a[n],h,d,g);break;case"chart":if(_=bH(x,e,i,u,a[n],h,d,g),!_||!_["!drawel"])break;var b=u1(_["!drawel"].Target,e),E=z1(b),A=cU(to(t,b,!0),y1(to(t,E,!0),b)),O=u1(A,b),M=z1(O);_=$z(to(t,O,!0),O,u,y1(to(t,M,!0),O),h,_);break;case"macro":_=SH(x,e,i,u,a[n],h,d,g);break;case"dialog":_=AH(x,e,i,u,a[n],h,d,g);break;default:throw new Error("Unrecognized sheet type "+c)}o[n]=_;var B=[];a&&a[n]&&hi(a[n]).forEach(function(Q){var ee="";if(a[n][Q].Type==Br.CMNT){ee=u1(a[n][Q].Target,e);var he=CH(ji(t,ee,!0),ee,u);if(!he||!he.length)return;W3(_,he,!1)}a[n][Q].Type==Br.TCMNT&&(ee=u1(a[n][Q].Target,e),B=B.concat(fU(ji(t,ee,!0),u)))}),B&&B.length&&W3(_,B,!0,u.people||[])}catch(Q){if(u.WTF)throw Q}}function Ro(t){return t.charAt(0)=="/"?t.slice(1):t}function tW(t,e){if(ud(),e=e||{},t5(e),Oo(t,"META-INF/manifest.xml")||Oo(t,"objectdata.xml"))return nb(t,e);if(Oo(t,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof s_<"u"){if(t.FileIndex)return s_(t);var r=Qt.utils.cfb_new();return d3(t).forEach(function(se){Sr(r,se,hP(t,se))}),s_(r)}throw new Error("Unsupported NUMBERS file")}if(!Oo(t,"[Content_Types].xml"))throw Oo(t,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):Oo(t,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=d3(t),i=a9(to(t,"[Content_Types].xml")),a=!1,o,c;if(i.workbooks.length===0&&(c="xl/workbook.xml",ji(t,c,!0)&&i.workbooks.push(c)),i.workbooks.length===0){if(c="xl/workbook.bin",!ji(t,c,!0))throw new Error("Could not find workbook");i.workbooks.push(c),a=!0}i.workbooks[0].slice(-3)=="bin"&&(a=!0);var u={},h={};if(!e.bookSheets&&!e.bookProps){if(w1=[],i.sst)try{w1=NH(ji(t,Ro(i.sst)),i.sst,e)}catch(se){if(e.WTF)throw se}e.cellStyles&&i.themes.length&&(u=kH(to(t,i.themes[0].replace(/^\//,""),!0)||"",i.themes[0],e)),i.style&&(h=TH(ji(t,Ro(i.style)),i.style,u,e))}i.links.map(function(se){try{var ne=y1(to(t,z1(Ro(se))),se);return RH(ji(t,Ro(se)),ne,se,e)}catch{}});var d=wH(ji(t,Ro(i.workbooks[0])),i.workbooks[0],e),g={},x="";i.coreprops.length&&(x=ji(t,Ro(i.coreprops[0]),!0),x&&(g=f6(x)),i.extprops.length!==0&&(x=ji(t,Ro(i.extprops[0]),!0),x&&h9(x,g,e)));var _={};(!e.bookSheets||e.bookProps)&&i.custprops.length!==0&&(x=to(t,Ro(i.custprops[0]),!0),x&&(_=p9(x,e)));var b={};if((e.bookSheets||e.bookProps)&&(d.Sheets?o=d.Sheets.map(function(ne){return ne.name}):g.Worksheets&&g.SheetNames.length>0&&(o=g.SheetNames),e.bookProps&&(b.Props=g,b.Custprops=_),e.bookSheets&&typeof o<"u"&&(b.SheetNames=o),e.bookSheets?b.SheetNames:e.bookProps))return b;o={};var E={};e.bookDeps&&i.calcchain&&(E=IH(ji(t,Ro(i.calcchain)),i.calcchain));var A=0,O={},M,B;{var Q=d.Sheets;g.Worksheets=Q.length,g.SheetNames=[];for(var ee=0;ee!=Q.length;++ee)g.SheetNames[ee]=Q[ee].name}var he=a?"bin":"xml",F=i.workbooks[0].lastIndexOf("/"),k=(i.workbooks[0].slice(0,F+1)+"_rels/"+i.workbooks[0].slice(F+1)+".rels").replace(/^\//,"");Oo(t,k)||(k="xl/_rels/workbook."+he+".rels");var S=y1(to(t,k,!0),k.replace(/_rels.*/,"s5s"));(i.metadata||[]).length>=1&&(e.xlmeta=LH(ji(t,Ro(i.metadata[0])),i.metadata[0],e)),(i.people||[]).length>=1&&(e.people=dU(ji(t,Ro(i.people[0])),e)),S&&(S=ZG(S,d.Sheets));var U=ji(t,"xl/worksheets/sheet.xml",!0)?1:0;e:for(A=0;A!=g.Worksheets;++A){var I="sheet";if(S&&S[A]?(M="xl/"+S[A][1].replace(/[\/]?xl\//,""),Oo(t,M)||(M=S[A][1]),Oo(t,M)||(M=k.replace(/_rels\/.*$/,"")+S[A][1]),I=S[A][2]):(M="xl/worksheets/sheet"+(A+1-U)+"."+he,M=M.replace(/sheet0\./,"sheet.")),B=M.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),e&&e.sheets!=null)switch(typeof e.sheets){case"number":if(A!=e.sheets)continue e;break;case"string":if(g.SheetNames[A].toLowerCase()!=e.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(e.sheets)){for(var C=!1,R=0;R!=e.sheets.length;++R)typeof e.sheets[R]=="number"&&e.sheets[R]==A&&(C=1),typeof e.sheets[R]=="string"&&e.sheets[R].toLowerCase()==g.SheetNames[A].toLowerCase()&&(C=1);if(!C)continue e}}eW(t,M,B,g.SheetNames[A],A,O,o,I,e,d,u,h)}return b={Directory:i,Workbook:d,Props:g,Custprops:_,Deps:E,Sheets:o,SheetNames:g.SheetNames,Strings:w1,Styles:h,Themes:u,SSF:zn(sr)},e&&e.bookFiles&&(t.files?(b.keys=n,b.files=t.files):(b.keys=[],b.files={},t.FullPaths.forEach(function(se,ne){se=se.replace(/^Root Entry[\/]/,""),b.keys.push(se),b.files[se]=t.FileIndex[ne]}))),e&&e.bookVBA&&(i.vba.length>0?b.vbaraw=ji(t,Ro(i.vba[0]),!0):i.defaults&&i.defaults.bin===wU&&(b.vbaraw=ji(t,"xl/vbaProject.bin",!0))),b}function rW(t,e){var r=e||{},n="Workbook",i=Qt.find(t,n);try{if(n="/!DataSpaces/Version",i=Qt.find(t,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(LB(i.content),n="/!DataSpaces/DataSpaceMap",i=Qt.find(t,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var a=FB(i.content);if(a.length!==1||a[0].comps.length!==1||a[0].comps[0].t!==0||a[0].name!=="StrongEncryptionDataSpace"||a[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",i=Qt.find(t,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var o=OB(i.content);if(o.length!=1||o[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",i=Qt.find(t,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);MB(i.content)}catch{}if(n="/EncryptionInfo",i=Qt.find(t,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var c=BB(i.content);if(n="/EncryptedPackage",i=Qt.find(t,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(c[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(c[1],i.content,r.password||"",r);if(c[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(c[1],i.content,r.password||"",r);throw new Error("File is password-protected")}function nW(t,e){return e.bookType=="ods"?Ek(t,e):e.bookType=="numbers"?QG(t,e):e.bookType=="xlsb"?iW(t,e):aW(t,e)}function iW(t,e){I0=1024,t&&!t.SSF&&(t.SSF=zn(sr)),t&&t.SSF&&(ud(),d2(t.SSF),e.revssf=m2(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,E1?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var r=e.bookType=="xlsb"?"bin":"xml",n=$6.indexOf(e.bookType)>-1,i=Vy();r5(e=e||{});var a=ky(),o="",c=0;if(e.cellXfs=[],Of(e.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={}),o="docProps/core.xml",Sr(a,o,h6(t.Props,e)),i.coreprops.push(o),En(e.rels,2,o,Br.CORE_PROPS),o="docProps/app.xml",!(t.Props&&t.Props.SheetNames))if(!t.Workbook||!t.Workbook.Sheets)t.Props.SheetNames=t.SheetNames;else{for(var u=[],h=0;h<t.SheetNames.length;++h)(t.Workbook.Sheets[h]||{}).Hidden!=2&&u.push(t.SheetNames[h]);t.Props.SheetNames=u}for(t.Props.Worksheets=t.Props.SheetNames.length,Sr(a,o,m6(t.Props)),i.extprops.push(o),En(e.rels,3,o,Br.EXT_PROPS),t.Custprops!==t.Props&&hi(t.Custprops||{}).length>0&&(o="docProps/custom.xml",Sr(a,o,g6(t.Custprops)),i.custprops.push(o),En(e.rels,4,o,Br.CUST_PROPS)),c=1;c<=t.SheetNames.length;++c){var d={"!id":{}},g=t.Sheets[t.SheetNames[c-1]],x=(g||{})["!type"]||"sheet";switch(x){case"chart":default:o="xl/worksheets/sheet"+c+"."+r,Sr(a,o,FH(c-1,o,e,t,d)),i.sheets.push(o),En(e.wbrels,-1,"worksheets/sheet"+c+"."+r,Br.WS[0])}if(g){var _=g["!comments"],b=!1,E="";_&&_.length>0&&(E="xl/comments"+c+"."+r,Sr(a,E,MH(_,E)),i.comments.push(E),En(d,-1,"../comments"+c+"."+r,Br.CMNT),b=!0),g["!legacy"]&&b&&Sr(a,"xl/drawings/vmlDrawing"+c+".vml",Y6(c,g["!comments"])),delete g["!comments"],delete g["!legacy"]}d["!id"].rId1&&Sr(a,z1(o),B0(d))}return e.Strings!=null&&e.Strings.length>0&&(o="xl/sharedStrings."+r,Sr(a,o,PH(e.Strings,o,e)),i.strs.push(o),En(e.wbrels,-1,"sharedStrings."+r,Br.SST)),o="xl/workbook."+r,Sr(a,o,DH(t,o)),i.workbooks.push(o),En(e.rels,1,o,Br.WB),o="xl/theme/theme1.xml",Sr(a,o,Xy(t.Themes,e)),i.themes.push(o),En(e.wbrels,-1,"theme/theme1.xml",Br.THEME),o="xl/styles."+r,Sr(a,o,OH(t,o,e)),i.styles.push(o),En(e.wbrels,-1,"styles."+r,Br.STY),t.vbaraw&&n&&(o="xl/vbaProject.bin",Sr(a,o,t.vbaraw),i.vba.push(o),En(e.wbrels,-1,"vbaProject.bin",Br.VBA)),o="xl/metadata."+r,Sr(a,o,BH(o)),i.metadata.push(o),En(e.wbrels,-1,"metadata."+r,Br.XLMETA),Sr(a,"[Content_Types].xml",c6(i,e)),Sr(a,"_rels/.rels",B0(e.rels)),Sr(a,"xl/_rels/workbook."+r+".rels",B0(e.wbrels)),delete e.revssf,delete e.ssf,a}function aW(t,e){I0=1024,t&&!t.SSF&&(t.SSF=zn(sr)),t&&t.SSF&&(ud(),d2(t.SSF),e.revssf=m2(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,E1?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var r="xml",n=$6.indexOf(e.bookType)>-1,i=Vy();r5(e=e||{});var a=ky(),o="",c=0;if(e.cellXfs=[],Of(e.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={}),o="docProps/core.xml",Sr(a,o,h6(t.Props,e)),i.coreprops.push(o),En(e.rels,2,o,Br.CORE_PROPS),o="docProps/app.xml",!(t.Props&&t.Props.SheetNames))if(!t.Workbook||!t.Workbook.Sheets)t.Props.SheetNames=t.SheetNames;else{for(var u=[],h=0;h<t.SheetNames.length;++h)(t.Workbook.Sheets[h]||{}).Hidden!=2&&u.push(t.SheetNames[h]);t.Props.SheetNames=u}t.Props.Worksheets=t.Props.SheetNames.length,Sr(a,o,m6(t.Props)),i.extprops.push(o),En(e.rels,3,o,Br.EXT_PROPS),t.Custprops!==t.Props&&hi(t.Custprops||{}).length>0&&(o="docProps/custom.xml",Sr(a,o,g6(t.Custprops)),i.custprops.push(o),En(e.rels,4,o,Br.CUST_PROPS));var d=["SheetJ5"];for(e.tcid=0,c=1;c<=t.SheetNames.length;++c){var g={"!id":{}},x=t.Sheets[t.SheetNames[c-1]],_=(x||{})["!type"]||"sheet";switch(_){case"chart":default:o="xl/worksheets/sheet"+c+"."+r,Sr(a,o,ok(c-1,e,t,g)),i.sheets.push(o),En(e.wbrels,-1,"worksheets/sheet"+c+"."+r,Br.WS[0])}if(x){var b=x["!comments"],E=!1,A="";if(b&&b.length>0){var O=!1;b.forEach(function(M){M[1].forEach(function(B){B.T==!0&&(O=!0)})}),O&&(A="xl/threadedComments/threadedComment"+c+"."+r,Sr(a,A,hU(b,d,e)),i.threadedcomments.push(A),En(g,-1,"../threadedComments/threadedComment"+c+"."+r,Br.TCMNT)),A="xl/comments"+c+"."+r,Sr(a,A,K6(b)),i.comments.push(A),En(g,-1,"../comments"+c+"."+r,Br.CMNT),E=!0}x["!legacy"]&&E&&Sr(a,"xl/drawings/vmlDrawing"+c+".vml",Y6(c,x["!comments"])),delete x["!comments"],delete x["!legacy"]}g["!id"].rId1&&Sr(a,z1(o),B0(g))}return e.Strings!=null&&e.Strings.length>0&&(o="xl/sharedStrings."+r,Sr(a,o,P6(e.Strings,e)),i.strs.push(o),En(e.wbrels,-1,"sharedStrings."+r,Br.SST)),o="xl/workbook."+r,Sr(a,o,hk(t)),i.workbooks.push(o),En(e.rels,1,o,Br.WB),o="xl/theme/theme1.xml",Sr(a,o,Xy(t.Themes,e)),i.themes.push(o),En(e.wbrels,-1,"theme/theme1.xml",Br.THEME),o="xl/styles."+r,Sr(a,o,H6(t,e)),i.styles.push(o),En(e.wbrels,-1,"styles."+r,Br.STY),t.vbaraw&&n&&(o="xl/vbaProject.bin",Sr(a,o,t.vbaraw),i.vba.push(o),En(e.wbrels,-1,"vbaProject.bin",Br.VBA)),o="xl/metadata."+r,Sr(a,o,X6()),i.metadata.push(o),En(e.wbrels,-1,"metadata."+r,Br.XLMETA),d.length>1&&(o="xl/persons/person.xml",Sr(a,o,pU(d)),i.people.push(o),En(e.wbrels,-1,"persons/person.xml",Br.PEOPLE)),Sr(a,"[Content_Types].xml",c6(i,e)),Sr(a,"_rels/.rels",B0(e.rels)),Sr(a,"xl/_rels/workbook."+r+".rels",B0(e.wbrels)),delete e.revssf,delete e.ssf,a}function n5(t,e){var r="";switch((e||{}).type||"base64"){case"buffer":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];case"base64":r=so(t.slice(0,12));break;case"binary":r=t;break;case"array":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];default:throw new Error("Unrecognized type "+(e&&e.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function sW(t,e){return Qt.find(t,"EncryptedPackage")?rW(t,e):gk(t,e)}function oW(t,e){var r,n=t,i=e||{};return i.type||(i.type=Lr&&Buffer.isBuffer(t)?"buffer":"base64"),r=BT(n,i),tW(r,i)}function Sk(t,e){var r=0;e:for(;r<t.length;)switch(t.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return nx(t.slice(r),e);default:break e}return J0.to_workbook(t,e)}function lW(t,e){var r="",n=n5(t,e);switch(e.type){case"base64":r=so(t);break;case"binary":r=t;break;case"buffer":r=t.toString("binary");break;case"array":r=Ah(t);break;default:throw new Error("Unrecognized type "+e.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(r=Cn(r)),e.type="binary",Sk(r,e)}function cW(t,e){var r=t;return e.type=="base64"&&(r=so(r)),r=M1.utils.decode(1200,r.slice(2),"str"),e.type="binary",Sk(r,e)}function uW(t){return t.match(/[^\x00-\x7F]/)?oc(t):t}function o_(t,e,r,n){return n?(r.type="string",J0.to_workbook(t,r)):J0.to_workbook(e,r)}function sx(t,e){Ey();var r=e||{};if(typeof ArrayBuffer<"u"&&t instanceof ArrayBuffer)return sx(new Uint8Array(t),(r=zn(r),r.type="array",r));typeof Uint8Array<"u"&&t instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var n=t,i=[0,0,0,0],a=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),U0={},r.dateNF&&(U0.dateNF=r.dateNF),r.type||(r.type=Lr&&Buffer.isBuffer(t)?"buffer":"base64"),r.type=="file"&&(r.type=Lr?"buffer":"binary",n=iP(t),typeof Uint8Array<"u"&&!Lr&&(r.type="array")),r.type=="string"&&(a=!0,r.type="binary",r.codepage=65001,n=uW(t)),r.type=="array"&&typeof Uint8Array<"u"&&t instanceof Uint8Array&&typeof ArrayBuffer<"u"){var o=new ArrayBuffer(3),c=new Uint8Array(o);if(c.foo="bar",!c.foo)return r=zn(r),r.type="array",sx(by(n),r)}switch((i=n5(n,r))[0]){case 208:if(i[1]===207&&i[2]===17&&i[3]===224&&i[4]===161&&i[5]===177&&i[6]===26&&i[7]===225)return sW(Qt.read(n,r),r);break;case 9:if(i[1]<=8)return gk(n,r);break;case 60:return nx(n,r);case 73:if(i[1]===73&&i[2]===42&&i[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(i[1]===68)return mB(n,r);break;case 84:if(i[1]===65&&i[2]===66&&i[3]===76)return F6.to_workbook(n,r);break;case 80:return i[1]===75&&i[2]<9&&i[3]<9?oW(n,r):o_(t,n,r,a);case 239:return i[3]===60?nx(n,r):o_(t,n,r,a);case 255:if(i[1]===254)return cW(n,r);if(i[1]===0&&i[2]===2&&i[3]===0)return mh.to_workbook(n,r);break;case 0:if(i[1]===0&&(i[2]>=2&&i[3]===0||i[2]===0&&(i[3]===8||i[3]===9)))return mh.to_workbook(n,r);break;case 3:case 131:case 139:case 140:return rx.to_workbook(n,r);case 123:if(i[1]===92&&i[2]===114&&i[3]===116)return V6.to_workbook(n,r);break;case 10:case 13:case 32:return lW(n,r);case 137:if(i[1]===80&&i[2]===78&&i[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return pB.indexOf(i[0])>-1&&i[2]<=12&&i[3]<=31?rx.to_workbook(n,r):o_(t,n,r,a)}function Ak(t,e){switch(e.type){case"base64":case"binary":break;case"buffer":case"array":e.type="";break;case"file":return dp(e.file,Qt.write(t,{type:Lr?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");default:throw new Error("Unrecognized type "+e.type)}return Qt.write(t,e)}function fW(t,e){var r=zn(e||{}),n=nW(t,r);return hW(n,r)}function hW(t,e){var r={},n=Lr?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(e.compression&&(r.compression="DEFLATE"),e.password)r.type=n;else switch(e.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");case"buffer":case"file":r.type=n;break;default:throw new Error("Unrecognized type "+e.type)}var i=t.FullPaths?Qt.write(t,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!e.compression}):t.generate(r);if(typeof Deno<"u"&&typeof i=="string"){if(e.type=="binary"||e.type=="base64")return i;i=new Uint8Array(h2(i))}return e.password&&typeof encrypt_agile<"u"?Ak(encrypt_agile(i,e.password),e):e.type==="file"?dp(e.file,i):e.type=="string"?Cn(i):i}function dW(t,e){var r=e||{},n=uG(t,r);return Ak(n,r)}function ic(t,e,r){r||(r="");var n=r+t;switch(e.type){case"base64":return B1(oc(n));case"binary":return oc(n);case"string":return t;case"file":return dp(e.file,n,"utf8");case"buffer":return Lr?fu(n,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(n):ic(n,{type:"binary"}).split("").map(function(i){return i.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function pW(t,e){switch(e.type){case"base64":return B1(t);case"binary":return t;case"string":return t;case"file":return dp(e.file,t,"binary");case"buffer":return Lr?fu(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function Fm(t,e){switch(e.type){case"string":case"base64":case"binary":for(var r="",n=0;n<t.length;++n)r+=String.fromCharCode(t[n]);return e.type=="base64"?B1(r):e.type=="string"?Cn(r):r;case"file":return dp(e.file,t);case"buffer":return t;default:throw new Error("Unrecognized type "+e.type)}}function Tk(t,e){Ey(),sH(t);var r=zn(e||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var n=Tk(t,r);return r.type="array",h2(n)}var i=0;if(r.sheet&&(typeof r.sheet=="number"?i=r.sheet:i=t.SheetNames.indexOf(r.sheet),!t.SheetNames[i]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return ic(nG(t,r),r);case"slk":case"sylk":return ic(D6.from_sheet(t.Sheets[t.SheetNames[i]],r),r);case"htm":case"html":return ic(_k(t.Sheets[t.SheetNames[i]],r),r);case"txt":return pW(kk(t.Sheets[t.SheetNames[i]],r),r);case"csv":return ic(i5(t.Sheets[t.SheetNames[i]],r),r,"\uFEFF");case"dif":return ic(F6.from_sheet(t.Sheets[t.SheetNames[i]],r),r);case"dbf":return Fm(rx.from_sheet(t.Sheets[t.SheetNames[i]],r),r);case"prn":return ic(J0.from_sheet(t.Sheets[t.SheetNames[i]],r),r);case"rtf":return ic(V6.from_sheet(t.Sheets[t.SheetNames[i]],r),r);case"eth":return ic(O6.from_sheet(t.Sheets[t.SheetNames[i]],r),r);case"fods":return ic(Ek(t,r),r);case"wk1":return Fm(mh.sheet_to_wk1(t.Sheets[t.SheetNames[i]],r),r);case"wk3":return Fm(mh.book_to_wk3(t,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),Fm(vk(t,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),dW(t,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return fW(t,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function mW(t){if(!t.bookType){var e={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},r=t.file.slice(t.file.lastIndexOf(".")).toLowerCase();r.match(/^\.[a-z]+$/)&&(t.bookType=r.slice(1)),t.bookType=e[t.bookType]||t.bookType}}function gW(t,e,r){var n={};return n.type="file",n.file=e,mW(n),Tk(t,n)}function vW(t,e,r,n,i,a,o,c){var u=Ni(r),h=c.defval,d=c.raw||!Object.prototype.hasOwnProperty.call(c,"raw"),g=!0,x=i===1?[]:{};if(i!==1)if(Object.defineProperty)try{Object.defineProperty(x,"__rowNum__",{value:r,enumerable:!1})}catch{x.__rowNum__=r}else x.__rowNum__=r;if(!o||t[r])for(var _=e.s.c;_<=e.e.c;++_){var b=o?t[r][_]:t[n[_]+u];if(b===void 0||b.t===void 0){if(h===void 0)continue;a[_]!=null&&(x[a[_]]=h);continue}var E=b.v;switch(b.t){case"z":if(E==null)break;continue;case"e":E=E==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+b.t)}if(a[_]!=null){if(E==null)if(b.t=="e"&&E===null)x[a[_]]=null;else if(h!==void 0)x[a[_]]=h;else if(d&&E===null)x[a[_]]=null;else continue;else x[a[_]]=d&&(b.t!=="n"||b.t==="n"&&c.rawNumbers!==!1)?E:cu(b,E,c);E!=null&&(g=!1)}}return{row:x,isempty:g}}function jg(t,e){if(t==null||t["!ref"]==null)return[];var r={t:"n",v:0},n=0,i=1,a=[],o=0,c="",u={s:{r:0,c:0},e:{r:0,c:0}},h=e||{},d=h.range!=null?h.range:t["!ref"];switch(h.header===1?n=1:h.header==="A"?n=2:Array.isArray(h.header)?n=3:h.header==null&&(n=0),typeof d){case"string":u=rn(d);break;case"number":u=rn(t["!ref"]),u.s.r=d;break;default:u=d}n>0&&(i=0);var g=Ni(u.s.r),x=[],_=[],b=0,E=0,A=Array.isArray(t),O=u.s.r,M=0,B={};A&&!t[O]&&(t[O]=[]);var Q=h.skipHidden&&t["!cols"]||[],ee=h.skipHidden&&t["!rows"]||[];for(M=u.s.c;M<=u.e.c;++M)if(!(Q[M]||{}).hidden)switch(x[M]=ei(M),r=A?t[O][M]:t[x[M]+g],n){case 1:a[M]=M-u.s.c;break;case 2:a[M]=x[M];break;case 3:a[M]=h.header[M-u.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),c=o=cu(r,null,h),E=B[o]||0,!E)B[o]=1;else{do c=o+"_"+E++;while(B[c]);B[o]=E,B[c]=1}a[M]=c}for(O=u.s.r+i;O<=u.e.r;++O)if(!(ee[O]||{}).hidden){var he=vW(t,u,O,x,n,a,A,h);(he.isempty===!1||(n===1?h.blankrows!==!1:h.blankrows))&&(_[b++]=he.row)}return _.length=b,_}var lb=/"/g;function _W(t,e,r,n,i,a,o,c){for(var u=!0,h=[],d="",g=Ni(r),x=e.s.c;x<=e.e.c;++x)if(n[x]){var _=c.dense?(t[r]||[])[x]:t[n[x]+g];if(_==null)d="";else if(_.v!=null){u=!1,d=""+(c.rawNumbers&&_.t=="n"?_.v:cu(_,null,c));for(var b=0,E=0;b!==d.length;++b)if((E=d.charCodeAt(b))===i||E===a||E===34||c.forceQuotes){d='"'+d.replace(lb,'""')+'"';break}d=="ID"&&(d='"ID"')}else _.f!=null&&!_.F?(u=!1,d="="+_.f,d.indexOf(",")>=0&&(d='"'+d.replace(lb,'""')+'"')):d="";h.push(d)}return c.blankrows===!1&&u?null:h.join(o)}function i5(t,e){var r=[],n=e??{};if(t==null||t["!ref"]==null)return"";var i=rn(t["!ref"]),a=n.FS!==void 0?n.FS:",",o=a.charCodeAt(0),c=n.RS!==void 0?n.RS:`
`,u=c.charCodeAt(0),h=new RegExp((a=="|"?"\\|":a)+"+$"),d="",g=[];n.dense=Array.isArray(t);for(var x=n.skipHidden&&t["!cols"]||[],_=n.skipHidden&&t["!rows"]||[],b=i.s.c;b<=i.e.c;++b)(x[b]||{}).hidden||(g[b]=ei(b));for(var E=0,A=i.s.r;A<=i.e.r;++A)(_[A]||{}).hidden||(d=_W(t,i,A,g,o,u,a,n),d!=null&&(n.strip&&(d=d.replace(h,"")),(d||n.blankrows!==!1)&&r.push((E++?c:"")+d)));return delete n.dense,r.join("")}function kk(t,e){e||(e={}),e.FS="	",e.RS=`
`;var r=i5(t,e);return r}function xW(t){var e="",r,n="";if(t==null||t["!ref"]==null)return[];var i=rn(t["!ref"]),a="",o=[],c,u=[],h=Array.isArray(t);for(c=i.s.c;c<=i.e.c;++c)o[c]=ei(c);for(var d=i.s.r;d<=i.e.r;++d)for(a=Ni(d),c=i.s.c;c<=i.e.c;++c)if(e=o[c]+a,r=h?(t[d]||[])[c]:t[e],n="",r!==void 0){if(r.F!=null){if(e=r.F,!r.f)continue;n=r.f,e.indexOf(":")==-1&&(e=e+":"+e)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}u[u.length]=e+"="+n}return u}function Nk(t,e,r){var n=r||{},i=+!n.skipHeader,a=t||{},o=0,c=0;if(a&&n.origin!=null)if(typeof n.origin=="number")o=n.origin;else{var u=typeof n.origin=="string"?ti(n.origin):n.origin;o=u.r,c=u.c}var h,d={s:{c:0,r:0},e:{c,r:o+e.length-1+i}};if(a["!ref"]){var g=rn(a["!ref"]);d.e.c=Math.max(d.e.c,g.e.c),d.e.r=Math.max(d.e.r,g.e.r),o==-1&&(o=g.e.r+1,d.e.r=o+e.length-1+i)}else o==-1&&(o=0,d.e.r=e.length-1+i);var x=n.header||[],_=0;e.forEach(function(E,A){hi(E).forEach(function(O){(_=x.indexOf(O))==-1&&(x[_=x.length]=O);var M=E[O],B="z",Q="",ee=ur({c:c+_,r:o+A+i});h=$1(a,ee),M&&typeof M=="object"&&!(M instanceof Date)?a[ee]=M:(typeof M=="number"?B="n":typeof M=="boolean"?B="b":typeof M=="string"?B="s":M instanceof Date?(B="d",n.cellDates||(B="n",M=Zi(M)),Q=n.dateNF||sr[14]):M===null&&n.nullError&&(B="e",M=0),h?(h.t=B,h.v=M,delete h.w,delete h.R,Q&&(h.z=Q)):a[ee]=h={t:B,v:M},Q&&(h.z=Q))})}),d.e.c=Math.max(d.e.c,c+x.length-1);var b=Ni(o);if(i)for(_=0;_<x.length;++_)a[ei(_+c)+b]={t:"s",v:x[_]};return a["!ref"]=wr(d),a}function yW(t,e){return Nk(null,t,e)}function $1(t,e,r){if(typeof e=="string"){if(Array.isArray(t)){var n=ti(e);return t[n.r]||(t[n.r]=[]),t[n.r][n.c]||(t[n.r][n.c]={t:"z"})}return t[e]||(t[e]={t:"z"})}return typeof e!="number"?$1(t,ur(e)):$1(t,ur({r:e,c:r||0}))}function wW(t,e){if(typeof e=="number"){if(e>=0&&t.SheetNames.length>e)return e;throw new Error("Cannot find sheet # "+e)}else if(typeof e=="string"){var r=t.SheetNames.indexOf(e);if(r>-1)return r;throw new Error("Cannot find sheet name |"+e+"|")}else throw new Error("Cannot find sheet |"+e+"|")}function a5(){return{SheetNames:[],Sheets:{}}}function s5(t,e,r,n){var i=1;if(!r)for(;i<=65535&&t.SheetNames.indexOf(r="Sheet"+i)!=-1;++i,r=void 0);if(!r||t.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&t.SheetNames.indexOf(r)>=0){var a=r.match(/(^.*?)(\d+)$/);i=a&&+a[2]||0;var o=a&&a[1]||r;for(++i;i<=65535&&t.SheetNames.indexOf(r=o+i)!=-1;++i);}if(fk(r),t.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return t.SheetNames.push(r),t.Sheets[r]=e,r}function EW(t,e,r){t.Workbook||(t.Workbook={}),t.Workbook.Sheets||(t.Workbook.Sheets=[]);var n=wW(t,e);switch(t.Workbook.Sheets[n]||(t.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}t.Workbook.Sheets[n].Hidden=r}function bW(t,e){return t.z=e,t}function Ck(t,e,r){return e?(t.l={Target:e},r&&(t.l.Tooltip=r)):delete t.l,t}function SW(t,e,r){return Ck(t,"#"+e,r)}function AW(t,e,r){t.c||(t.c=[]),t.c.push({t:e,a:r||"SheetJS"})}function TW(t,e,r,n){for(var i=typeof e!="string"?e:rn(e),a=typeof e=="string"?e:wr(e),o=i.s.r;o<=i.e.r;++o)for(var c=i.s.c;c<=i.e.c;++c){var u=$1(t,o,c);u.t="n",u.F=a,delete u.v,o==i.s.r&&c==i.s.c&&(u.f=r,n&&(u.D=!0))}return t}var Qm={encode_col:ei,encode_row:Ni,encode_cell:ur,encode_range:wr,decode_col:Oy,decode_row:Fy,split_cell:PP,decode_cell:ti,decode_range:Ds,format_cell:cu,sheet_add_aoa:r6,sheet_add_json:Nk,sheet_add_dom:xk,aoa_to_sheet:fd,json_to_sheet:yW,table_to_sheet:yk,table_to_book:LG,sheet_to_csv:i5,sheet_to_txt:kk,sheet_to_json:jg,sheet_to_html:_k,sheet_to_formulae:xW,sheet_to_row_object_array:jg,sheet_get_cell:$1,book_new:a5,book_append_sheet:s5,book_set_sheet_visibility:EW,cell_set_number_format:bW,cell_set_hyperlink:Ck,cell_set_internal_link:SW,cell_add_comment:AW,sheet_set_array_formula:TW,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}},Jm={exports:{}};/* @license
Papa Parse
v5.5.3
https://github.com/mholt/PapaParse
License: MIT
*/var kW=Jm.exports,cb;function NW(){return cb||(cb=1,function(t,e){((r,n)=>{t.exports=n()})(kW,function r(){var n=typeof self<"u"?self:typeof window<"u"?window:n!==void 0?n:{},i,a=!n.document&&!!n.postMessage,o=n.IS_PAPA_WORKER||!1,c={},u=0,h={};function d(k){this._handle=null,this._finished=!1,this._completed=!1,this._halted=!1,this._input=null,this._baseIndex=0,this._partialLine="",this._rowCount=0,this._start=0,this._nextChunk=null,this.isFirstChunk=!0,this._completeResults={data:[],errors:[],meta:{}},(function(S){var U=ee(S);U.chunkSize=parseInt(U.chunkSize),S.step||S.chunk||(U.chunkSize=null),this._handle=new E(U),(this._handle.streamer=this)._config=U}).call(this,k),this.parseChunk=function(S,U){var I=parseInt(this._config.skipFirstNLines)||0;if(this.isFirstChunk&&0<I){let R=this._config.newline;R||(C=this._config.quoteChar||'"',R=this._handle.guessLineEndings(S,C)),S=[...S.split(R).slice(I)].join(R)}this.isFirstChunk&&F(this._config.beforeFirstChunk)&&(C=this._config.beforeFirstChunk(S))!==void 0&&(S=C),this.isFirstChunk=!1,this._halted=!1;var I=this._partialLine+S,C=(this._partialLine="",this._handle.parse(I,this._baseIndex,!this._finished));if(!this._handle.paused()&&!this._handle.aborted()){if(S=C.meta.cursor,I=(this._finished||(this._partialLine=I.substring(S-this._baseIndex),this._baseIndex=S),C&&C.data&&(this._rowCount+=C.data.length),this._finished||this._config.preview&&this._rowCount>=this._config.preview),o)n.postMessage({results:C,workerId:h.WORKER_ID,finished:I});else if(F(this._config.chunk)&&!U){if(this._config.chunk(C,this._handle),this._handle.paused()||this._handle.aborted())return void(this._halted=!0);this._completeResults=C=void 0}return this._config.step||this._config.chunk||(this._completeResults.data=this._completeResults.data.concat(C.data),this._completeResults.errors=this._completeResults.errors.concat(C.errors),this._completeResults.meta=C.meta),this._completed||!I||!F(this._config.complete)||C&&C.meta.aborted||(this._config.complete(this._completeResults,this._input),this._completed=!0),I||C&&C.meta.paused||this._nextChunk(),C}this._halted=!0},this._sendError=function(S){F(this._config.error)?this._config.error(S):o&&this._config.error&&n.postMessage({workerId:h.WORKER_ID,error:S,finished:!1})}}function g(k){var S;(k=k||{}).chunkSize||(k.chunkSize=h.RemoteChunkSize),d.call(this,k),this._nextChunk=a?function(){this._readChunk(),this._chunkLoaded()}:function(){this._readChunk()},this.stream=function(U){this._input=U,this._nextChunk()},this._readChunk=function(){if(this._finished)this._chunkLoaded();else{if(S=new XMLHttpRequest,this._config.withCredentials&&(S.withCredentials=this._config.withCredentials),a||(S.onload=he(this._chunkLoaded,this),S.onerror=he(this._chunkError,this)),S.open(this._config.downloadRequestBody?"POST":"GET",this._input,!a),this._config.downloadRequestHeaders){var U,I=this._config.downloadRequestHeaders;for(U in I)S.setRequestHeader(U,I[U])}var C;this._config.chunkSize&&(C=this._start+this._config.chunkSize-1,S.setRequestHeader("Range","bytes="+this._start+"-"+C));try{S.send(this._config.downloadRequestBody)}catch(R){this._chunkError(R.message)}a&&S.status===0&&this._chunkError()}},this._chunkLoaded=function(){S.readyState===4&&(S.status<200||400<=S.status?this._chunkError():(this._start+=this._config.chunkSize||S.responseText.length,this._finished=!this._config.chunkSize||this._start>=(U=>(U=U.getResponseHeader("Content-Range"))!==null?parseInt(U.substring(U.lastIndexOf("/")+1)):-1)(S),this.parseChunk(S.responseText)))},this._chunkError=function(U){U=S.statusText||U,this._sendError(new Error(U))}}function x(k){(k=k||{}).chunkSize||(k.chunkSize=h.LocalChunkSize),d.call(this,k);var S,U,I=typeof FileReader<"u";this.stream=function(C){this._input=C,U=C.slice||C.webkitSlice||C.mozSlice,I?((S=new FileReader).onload=he(this._chunkLoaded,this),S.onerror=he(this._chunkError,this)):S=new FileReaderSync,this._nextChunk()},this._nextChunk=function(){this._finished||this._config.preview&&!(this._rowCount<this._config.preview)||this._readChunk()},this._readChunk=function(){var C=this._input,R=(this._config.chunkSize&&(R=Math.min(this._start+this._config.chunkSize,this._input.size),C=U.call(C,this._start,R)),S.readAsText(C,this._config.encoding));I||this._chunkLoaded({target:{result:R}})},this._chunkLoaded=function(C){this._start+=this._config.chunkSize,this._finished=!this._config.chunkSize||this._start>=this._input.size,this.parseChunk(C.target.result)},this._chunkError=function(){this._sendError(S.error)}}function _(k){var S;d.call(this,k=k||{}),this.stream=function(U){return S=U,this._nextChunk()},this._nextChunk=function(){var U,I;if(!this._finished)return U=this._config.chunkSize,S=U?(I=S.substring(0,U),S.substring(U)):(I=S,""),this._finished=!S,this.parseChunk(I)}}function b(k){d.call(this,k=k||{});var S=[],U=!0,I=!1;this.pause=function(){d.prototype.pause.apply(this,arguments),this._input.pause()},this.resume=function(){d.prototype.resume.apply(this,arguments),this._input.resume()},this.stream=function(C){this._input=C,this._input.on("data",this._streamData),this._input.on("end",this._streamEnd),this._input.on("error",this._streamError)},this._checkIsFinished=function(){I&&S.length===1&&(this._finished=!0)},this._nextChunk=function(){this._checkIsFinished(),S.length?this.parseChunk(S.shift()):U=!0},this._streamData=he(function(C){try{S.push(typeof C=="string"?C:C.toString(this._config.encoding)),U&&(U=!1,this._checkIsFinished(),this.parseChunk(S.shift()))}catch(R){this._streamError(R)}},this),this._streamError=he(function(C){this._streamCleanUp(),this._sendError(C)},this),this._streamEnd=he(function(){this._streamCleanUp(),I=!0,this._streamData("")},this),this._streamCleanUp=he(function(){this._input.removeListener("data",this._streamData),this._input.removeListener("end",this._streamEnd),this._input.removeListener("error",this._streamError)},this)}function E(k){var S,U,I,C,R=Math.pow(2,53),se=-R,ne=/^\s*-?(\d+\.?|\.\d+|\d+\.\d+)([eE][-+]?\d+)?\s*$/,J=/^((\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z)))$/,de=this,oe=0,Z=0,X=!1,xe=!1,L=[],j={data:[],errors:[],meta:{}};function z(_e){return k.skipEmptyLines==="greedy"?_e.join("").trim()==="":_e.length===1&&_e[0].length===0}function G(){if(j&&I&&(Ae("Delimiter","UndetectableDelimiter","Unable to auto-detect delimiting character; defaulted to '"+h.DefaultDelimiter+"'"),I=!1),k.skipEmptyLines&&(j.data=j.data.filter(function(Oe){return!z(Oe)})),ae()){let Oe=function(fe,rt){F(k.transformHeader)&&(fe=k.transformHeader(fe,rt)),L.push(fe)};if(j)if(Array.isArray(j.data[0])){for(var _e=0;ae()&&_e<j.data.length;_e++)j.data[_e].forEach(Oe);j.data.splice(0,1)}else j.data.forEach(Oe)}function Ee(Oe,fe){for(var rt=k.header?{}:[],ot=0;ot<Oe.length;ot++){var Pe=ot,ge=Oe[ot],ge=((Je,nt)=>(et=>(k.dynamicTypingFunction&&k.dynamicTyping[et]===void 0&&(k.dynamicTyping[et]=k.dynamicTypingFunction(et)),(k.dynamicTyping[et]||k.dynamicTyping)===!0))(Je)?nt==="true"||nt==="TRUE"||nt!=="false"&&nt!=="FALSE"&&((et=>{if(ne.test(et)&&(et=parseFloat(et),se<et&&et<R))return 1})(nt)?parseFloat(nt):J.test(nt)?new Date(nt):nt===""?null:nt):nt)(Pe=k.header?ot>=L.length?"__parsed_extra":L[ot]:Pe,ge=k.transform?k.transform(ge,Pe):ge);Pe==="__parsed_extra"?(rt[Pe]=rt[Pe]||[],rt[Pe].push(ge)):rt[Pe]=ge}return k.header&&(ot>L.length?Ae("FieldMismatch","TooManyFields","Too many fields: expected "+L.length+" fields but parsed "+ot,Z+fe):ot<L.length&&Ae("FieldMismatch","TooFewFields","Too few fields: expected "+L.length+" fields but parsed "+ot,Z+fe)),rt}var Ce;j&&(k.header||k.dynamicTyping||k.transform)&&(Ce=1,!j.data.length||Array.isArray(j.data[0])?(j.data=j.data.map(Ee),Ce=j.data.length):j.data=Ee(j.data,0),k.header&&j.meta&&(j.meta.fields=L),Z+=Ce)}function ae(){return k.header&&L.length===0}function Ae(_e,Ee,Ce,Oe){_e={type:_e,code:Ee,message:Ce},Oe!==void 0&&(_e.row=Oe),j.errors.push(_e)}F(k.step)&&(C=k.step,k.step=function(_e){j=_e,ae()?G():(G(),j.data.length!==0&&(oe+=_e.data.length,k.preview&&oe>k.preview?U.abort():(j.data=j.data[0],C(j,de))))}),this.parse=function(_e,Ee,Ce){var Oe=k.quoteChar||'"',Oe=(k.newline||(k.newline=this.guessLineEndings(_e,Oe)),I=!1,k.delimiter?F(k.delimiter)&&(k.delimiter=k.delimiter(_e),j.meta.delimiter=k.delimiter):((Oe=((fe,rt,ot,Pe,ge)=>{var Je,nt,et,vt;ge=ge||[",","	","|",";",h.RECORD_SEP,h.UNIT_SEP];for(var Et=0;Et<ge.length;Et++){for(var bt,Mt=ge[Et],Dt=0,qt=0,Tt=0,kt=(et=void 0,new O({comments:Pe,delimiter:Mt,newline:rt,preview:10}).parse(fe)),zt=0;zt<kt.data.length;zt++)ot&&z(kt.data[zt])?Tt++:(bt=kt.data[zt].length,qt+=bt,et===void 0?et=bt:0<bt&&(Dt+=Math.abs(bt-et),et=bt));0<kt.data.length&&(qt/=kt.data.length-Tt),(nt===void 0||Dt<=nt)&&(vt===void 0||vt<qt)&&1.99<qt&&(nt=Dt,Je=Mt,vt=qt)}return{successful:!!(k.delimiter=Je),bestDelimiter:Je}})(_e,k.newline,k.skipEmptyLines,k.comments,k.delimitersToGuess)).successful?k.delimiter=Oe.bestDelimiter:(I=!0,k.delimiter=h.DefaultDelimiter),j.meta.delimiter=k.delimiter),ee(k));return k.preview&&k.header&&Oe.preview++,S=_e,U=new O(Oe),j=U.parse(S,Ee,Ce),G(),X?{meta:{paused:!0}}:j||{meta:{paused:!1}}},this.paused=function(){return X},this.pause=function(){X=!0,U.abort(),S=F(k.chunk)?"":S.substring(U.getCharIndex())},this.resume=function(){de.streamer._halted?(X=!1,de.streamer.parseChunk(S,!0)):setTimeout(de.resume,3)},this.aborted=function(){return xe},this.abort=function(){xe=!0,U.abort(),j.meta.aborted=!0,F(k.complete)&&k.complete(j),S=""},this.guessLineEndings=function(fe,Oe){fe=fe.substring(0,1048576);var Oe=new RegExp(A(Oe)+"([^]*?)"+A(Oe),"gm"),Ce=(fe=fe.replace(Oe,"")).split("\r"),Oe=fe.split(`
`),fe=1<Oe.length&&Oe[0].length<Ce[0].length;if(Ce.length===1||fe)return`
`;for(var rt=0,ot=0;ot<Ce.length;ot++)Ce[ot][0]===`
`&&rt++;return rt>=Ce.length/2?`\r
`:"\r"}}function A(k){return k.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function O(k){var S=(k=k||{}).delimiter,U=k.newline,I=k.comments,C=k.step,R=k.preview,se=k.fastMode,ne=null,J=!1,de=k.quoteChar==null?'"':k.quoteChar,oe=de;if(k.escapeChar!==void 0&&(oe=k.escapeChar),(typeof S!="string"||-1<h.BAD_DELIMITERS.indexOf(S))&&(S=","),I===S)throw new Error("Comment character same as delimiter");I===!0?I="#":(typeof I!="string"||-1<h.BAD_DELIMITERS.indexOf(I))&&(I=!1),U!==`
`&&U!=="\r"&&U!==`\r
`&&(U=`
`);var Z=0,X=!1;this.parse=function(xe,L,j){if(typeof xe!="string")throw new Error("Input must be a string");var z=xe.length,G=S.length,ae=U.length,Ae=I.length,_e=F(C),Ee=[],Ce=[],Oe=[],fe=Z=0;if(!xe)return Dt();if(se||se!==!1&&xe.indexOf(de)===-1){for(var rt=xe.split(U),ot=0;ot<rt.length;ot++){if(Oe=rt[ot],Z+=Oe.length,ot!==rt.length-1)Z+=U.length;else if(j)return Dt();if(!I||Oe.substring(0,Ae)!==I){if(_e){if(Ee=[],vt(Oe.split(S)),qt(),X)return Dt()}else vt(Oe.split(S));if(R&&R<=ot)return Ee=Ee.slice(0,R),Dt(!0)}}return Dt()}for(var Pe=xe.indexOf(S,Z),ge=xe.indexOf(U,Z),Je=new RegExp(A(oe)+A(de),"g"),nt=xe.indexOf(de,Z);;)if(xe[Z]===de)for(nt=Z,Z++;;){if((nt=xe.indexOf(de,nt+1))===-1)return j||Ce.push({type:"Quotes",code:"MissingQuotes",message:"Quoted field unterminated",row:Ee.length,index:Z}),bt();if(nt===z-1)return bt(xe.substring(Z,nt).replace(Je,de));if(de===oe&&xe[nt+1]===oe)nt++;else if(de===oe||nt===0||xe[nt-1]!==oe){Pe!==-1&&Pe<nt+1&&(Pe=xe.indexOf(S,nt+1));var et=Et((ge=ge!==-1&&ge<nt+1?xe.indexOf(U,nt+1):ge)===-1?Pe:Math.min(Pe,ge));if(xe.substr(nt+1+et,G)===S){Oe.push(xe.substring(Z,nt).replace(Je,de)),xe[Z=nt+1+et+G]!==de&&(nt=xe.indexOf(de,Z)),Pe=xe.indexOf(S,Z),ge=xe.indexOf(U,Z);break}if(et=Et(ge),xe.substring(nt+1+et,nt+1+et+ae)===U){if(Oe.push(xe.substring(Z,nt).replace(Je,de)),Mt(nt+1+et+ae),Pe=xe.indexOf(S,Z),nt=xe.indexOf(de,Z),_e&&(qt(),X))return Dt();if(R&&Ee.length>=R)return Dt(!0);break}Ce.push({type:"Quotes",code:"InvalidQuotes",message:"Trailing quote on quoted field is malformed",row:Ee.length,index:Z}),nt++}}else if(I&&Oe.length===0&&xe.substring(Z,Z+Ae)===I){if(ge===-1)return Dt();Z=ge+ae,ge=xe.indexOf(U,Z),Pe=xe.indexOf(S,Z)}else if(Pe!==-1&&(Pe<ge||ge===-1))Oe.push(xe.substring(Z,Pe)),Z=Pe+G,Pe=xe.indexOf(S,Z);else{if(ge===-1)break;if(Oe.push(xe.substring(Z,ge)),Mt(ge+ae),_e&&(qt(),X))return Dt();if(R&&Ee.length>=R)return Dt(!0)}return bt();function vt(Tt){Ee.push(Tt),fe=Z}function Et(Tt){var kt=0;return kt=Tt!==-1&&(Tt=xe.substring(nt+1,Tt))&&Tt.trim()===""?Tt.length:kt}function bt(Tt){return j||(Tt===void 0&&(Tt=xe.substring(Z)),Oe.push(Tt),Z=z,vt(Oe),_e&&qt()),Dt()}function Mt(Tt){Z=Tt,vt(Oe),Oe=[],ge=xe.indexOf(U,Z)}function Dt(Tt){if(k.header&&!L&&Ee.length&&!J){var kt=Ee[0],zt=Object.create(null),Pt=new Set(kt);let Nt=!1;for(let _t=0;_t<kt.length;_t++){let or=kt[_t];if(zt[or=F(k.transformHeader)?k.transformHeader(or,_t):or]){let Gt,zr=zt[or];for(;Gt=or+"_"+zr,zr++,Pt.has(Gt););Pt.add(Gt),kt[_t]=Gt,zt[or]++,Nt=!0,(ne=ne===null?{}:ne)[Gt]=or}else zt[or]=1,kt[_t]=or;Pt.add(or)}Nt&&console.warn("Duplicate headers found and renamed."),J=!0}return{data:Ee,errors:Ce,meta:{delimiter:S,linebreak:U,aborted:X,truncated:!!Tt,cursor:fe+(L||0),renamedHeaders:ne}}}function qt(){C(Dt()),Ee=[],Ce=[]}},this.abort=function(){X=!0},this.getCharIndex=function(){return Z}}function M(k){var S=k.data,U=c[S.workerId],I=!1;if(S.error)U.userError(S.error,S.file);else if(S.results&&S.results.data){var C={abort:function(){I=!0,B(S.workerId,{data:[],errors:[],meta:{aborted:!0}})},pause:Q,resume:Q};if(F(U.userStep)){for(var R=0;R<S.results.data.length&&(U.userStep({data:S.results.data[R],errors:S.results.errors,meta:S.results.meta},C),!I);R++);delete S.results}else F(U.userChunk)&&(U.userChunk(S.results,C,S.file),delete S.results)}S.finished&&!I&&B(S.workerId,S.results)}function B(k,S){var U=c[k];F(U.userComplete)&&U.userComplete(S),U.terminate(),delete c[k]}function Q(){throw new Error("Not implemented.")}function ee(k){if(typeof k!="object"||k===null)return k;var S,U=Array.isArray(k)?[]:{};for(S in k)U[S]=ee(k[S]);return U}function he(k,S){return function(){k.apply(S,arguments)}}function F(k){return typeof k=="function"}return h.parse=function(k,S){var U=(S=S||{}).dynamicTyping||!1;if(F(U)&&(S.dynamicTypingFunction=U,U={}),S.dynamicTyping=U,S.transform=!!F(S.transform)&&S.transform,!S.worker||!h.WORKERS_SUPPORTED)return U=null,h.NODE_STREAM_INPUT,typeof k=="string"?(k=(I=>I.charCodeAt(0)!==65279?I:I.slice(1))(k),U=new(S.download?g:_)(S)):k.readable===!0&&F(k.read)&&F(k.on)?U=new b(S):(n.File&&k instanceof File||k instanceof Object)&&(U=new x(S)),U.stream(k);(U=(()=>{var I;return!!h.WORKERS_SUPPORTED&&(I=(()=>{var C=n.URL||n.webkitURL||null,R=r.toString();return h.BLOB_URL||(h.BLOB_URL=C.createObjectURL(new Blob(["var global = (function() { if (typeof self !== 'undefined') { return self; } if (typeof window !== 'undefined') { return window; } if (typeof global !== 'undefined') { return global; } return {}; })(); global.IS_PAPA_WORKER=true; ","(",R,")();"],{type:"text/javascript"})))})(),(I=new n.Worker(I)).onmessage=M,I.id=u++,c[I.id]=I)})()).userStep=S.step,U.userChunk=S.chunk,U.userComplete=S.complete,U.userError=S.error,S.step=F(S.step),S.chunk=F(S.chunk),S.complete=F(S.complete),S.error=F(S.error),delete S.worker,U.postMessage({input:k,config:S,workerId:U.id})},h.unparse=function(k,S){var U=!1,I=!0,C=",",R=`\r
`,se='"',ne=se+se,J=!1,de=null,oe=!1,Z=((()=>{if(typeof S=="object"){if(typeof S.delimiter!="string"||h.BAD_DELIMITERS.filter(function(L){return S.delimiter.indexOf(L)!==-1}).length||(C=S.delimiter),typeof S.quotes!="boolean"&&typeof S.quotes!="function"&&!Array.isArray(S.quotes)||(U=S.quotes),typeof S.skipEmptyLines!="boolean"&&typeof S.skipEmptyLines!="string"||(J=S.skipEmptyLines),typeof S.newline=="string"&&(R=S.newline),typeof S.quoteChar=="string"&&(se=S.quoteChar),typeof S.header=="boolean"&&(I=S.header),Array.isArray(S.columns)){if(S.columns.length===0)throw new Error("Option columns is empty");de=S.columns}S.escapeChar!==void 0&&(ne=S.escapeChar+se),S.escapeFormulae instanceof RegExp?oe=S.escapeFormulae:typeof S.escapeFormulae=="boolean"&&S.escapeFormulae&&(oe=/^[=+\-@\t\r].*$/)}})(),new RegExp(A(se),"g"));if(typeof k=="string"&&(k=JSON.parse(k)),Array.isArray(k)){if(!k.length||Array.isArray(k[0]))return X(null,k,J);if(typeof k[0]=="object")return X(de||Object.keys(k[0]),k,J)}else if(typeof k=="object")return typeof k.data=="string"&&(k.data=JSON.parse(k.data)),Array.isArray(k.data)&&(k.fields||(k.fields=k.meta&&k.meta.fields||de),k.fields||(k.fields=Array.isArray(k.data[0])?k.fields:typeof k.data[0]=="object"?Object.keys(k.data[0]):[]),Array.isArray(k.data[0])||typeof k.data[0]=="object"||(k.data=[k.data])),X(k.fields||[],k.data||[],J);throw new Error("Unable to serialize unrecognized input");function X(L,j,z){var G="",ae=(typeof L=="string"&&(L=JSON.parse(L)),typeof j=="string"&&(j=JSON.parse(j)),Array.isArray(L)&&0<L.length),Ae=!Array.isArray(j[0]);if(ae&&I){for(var _e=0;_e<L.length;_e++)0<_e&&(G+=C),G+=xe(L[_e],_e);0<j.length&&(G+=R)}for(var Ee=0;Ee<j.length;Ee++){var Ce=(ae?L:j[Ee]).length,Oe=!1,fe=ae?Object.keys(j[Ee]).length===0:j[Ee].length===0;if(z&&!ae&&(Oe=z==="greedy"?j[Ee].join("").trim()==="":j[Ee].length===1&&j[Ee][0].length===0),z==="greedy"&&ae){for(var rt=[],ot=0;ot<Ce;ot++){var Pe=Ae?L[ot]:ot;rt.push(j[Ee][Pe])}Oe=rt.join("").trim()===""}if(!Oe){for(var ge=0;ge<Ce;ge++){0<ge&&!fe&&(G+=C);var Je=ae&&Ae?L[ge]:ge;G+=xe(j[Ee][Je],ge)}Ee<j.length-1&&(!z||0<Ce&&!fe)&&(G+=R)}}return G}function xe(L,j){var z,G;return L==null?"":L.constructor===Date?JSON.stringify(L).slice(1,25):(G=!1,oe&&typeof L=="string"&&oe.test(L)&&(L="'"+L,G=!0),z=L.toString().replace(Z,ne),(G=G||U===!0||typeof U=="function"&&U(L,j)||Array.isArray(U)&&U[j]||((ae,Ae)=>{for(var _e=0;_e<Ae.length;_e++)if(-1<ae.indexOf(Ae[_e]))return!0;return!1})(z,h.BAD_DELIMITERS)||-1<z.indexOf(C)||z.charAt(0)===" "||z.charAt(z.length-1)===" ")?se+z+se:z)}},h.RECORD_SEP="",h.UNIT_SEP="",h.BYTE_ORDER_MARK="\uFEFF",h.BAD_DELIMITERS=["\r",`
`,'"',h.BYTE_ORDER_MARK],h.WORKERS_SUPPORTED=!a&&!!n.Worker,h.NODE_STREAM_INPUT=1,h.LocalChunkSize=10485760,h.RemoteChunkSize=5242880,h.DefaultDelimiter=",",h.Parser=O,h.ParserHandle=E,h.NetworkStreamer=g,h.FileStreamer=x,h.StringStreamer=_,h.ReadableStreamStreamer=b,n.jQuery&&((i=n.jQuery).fn.parse=function(k){var S=k.config||{},U=[];return this.each(function(R){if(!(i(this).prop("tagName").toUpperCase()==="INPUT"&&i(this).attr("type").toLowerCase()==="file"&&n.FileReader)||!this.files||this.files.length===0)return!0;for(var se=0;se<this.files.length;se++)U.push({file:this.files[se],inputElem:this,instanceConfig:i.extend({},S)})}),I(),this;function I(){if(U.length===0)F(k.complete)&&k.complete();else{var R,se,ne,J,de=U[0];if(F(k.before)){var oe=k.before(de.file,de.inputElem);if(typeof oe=="object"){if(oe.action==="abort")return R="AbortError",se=de.file,ne=de.inputElem,J=oe.reason,void(F(k.error)&&k.error({name:R},se,ne,J));if(oe.action==="skip")return void C();typeof oe.config=="object"&&(de.instanceConfig=i.extend(de.instanceConfig,oe.config))}else if(oe==="skip")return void C()}var Z=de.instanceConfig.complete;de.instanceConfig.complete=function(X){F(Z)&&Z(X,de.file,de.inputElem),C()},h.parse(de.file,de.instanceConfig)}}function C(){U.splice(0,1),I()}}),o&&(n.onmessage=function(k){k=k.data,h.WORKER_ID===void 0&&k&&(h.WORKER_ID=k.workerId),typeof k.input=="string"?n.postMessage({workerId:h.WORKER_ID,results:h.parse(k.input,k.config),finished:!0}):(n.File&&k.input instanceof File||k.input instanceof Object)&&(k=h.parse(k.input,k.config))&&n.postMessage({workerId:h.WORKER_ID,results:k,finished:!0})}),(g.prototype=Object.create(d.prototype)).constructor=g,(x.prototype=Object.create(d.prototype)).constructor=x,(_.prototype=Object.create(_.prototype)).constructor=_,(b.prototype=Object.create(d.prototype)).constructor=b,h})}(Jm)),Jm.exports}var CW=NW();const IW=xx(CW),RW=()=>{const[t,e]=lt.useState([]),[r,n]=lt.useState([]),[i,a]=lt.useState(!0),[o,c]=lt.useState(!1),[u,h]=lt.useState(!1),[d,g]=lt.useState(""),[x,_]=lt.useState(null),[b,E]=lt.useState({nom:"",annee:new Date().getFullYear().toString(),professeurPrincipal:""}),[A,O]=lt.useState({nom:"",prenom:"",dateNaissance:""});lt.useEffect(()=>{M(),B()},[]);const M=async()=>{try{const C=(await io(Vi(fn,"classes"))).docs.map(se=>({id:se.id,...se.data(),createdAt:se.data().createdAt?.toDate()||new Date})),R=await Promise.all(C.map(async se=>{const ne=_y(Vi(fn,"eleves"),Ag("classeId","==",se.id)),J=await io(ne);return{id:se.id,nom:se.nom,effectif:J.size}}));e(R)}catch(I){console.error("Erreur lors du chargement des classes:",I)}finally{a(!1)}},B=async()=>{try{const C=(await io(Vi(fn,"eleves"))).docs.map(R=>({id:R.id,...R.data()}));n(C)}catch(I){console.error("Erreur lors du chargement des lves:",I)}},Q=async I=>{I.preventDefault();try{x?(await u2(no(fn,"classes",x.id),{...b,updatedAt:new Date}),_(null)):await hh(Vi(fn,"classes"),{...b,createdAt:new Date}),E({nom:"",annee:new Date().getFullYear().toString(),professeurPrincipal:""}),c(!1),M()}catch(C){console.error("Erreur lors de la sauvegarde:",C)}},ee=async I=>{if(I.preventDefault(),!d){alert("Veuillez slectionner une classe");return}try{await hh(Vi(fn,"eleves"),{...A,classeId:d,createdAt:new Date}),O({nom:"",prenom:"",dateNaissance:""}),h(!1),B(),M()}catch(C){console.error("Erreur lors de la sauvegarde de l'lve:",C)}},he=async I=>{const C=I.target.files?.[0];if(!C||!d){alert("Veuillez slectionner une classe et un fichier");return}try{let R=[];if(C.name.endsWith(".csv")){const J=await C.text(),de=J.includes(";");R=IW.parse(J,{header:!0,delimiter:de?";":","}).data.filter(Z=>Object.values(Z).some(X=>X&&String(X).trim()!==""))}else if(C.name.endsWith(".xlsx")){const J=await C.arrayBuffer(),de=sx(J,{type:"array"}),oe=de.Sheets[de.SheetNames[0]];R=Qm.sheet_to_json(oe)}else{alert("Format de fichier non support. Utilisez .csv ou .xlsx");return}const se=["nom","prenom","dateNaissance"],ne=R[0]||{};for(const J of se)if(!Object.keys(ne).includes(J)){alert(`Colonne manquante : ${J}`);return}for(const J of R)await hh(Vi(fn,"eleves"),{nom:J.nom.trim(),prenom:J.prenom.trim(),dateNaissance:J.dateNaissance,classeId:d,createdAt:new Date});B(),M(),alert("Import termin !")}catch(R){console.error("Erreur lors de l'import:",R),alert("Erreur lors de l'import")}},F=I=>{_(I),E({nom:I.nom,annee:I.annee,professeurPrincipal:I.professeurPrincipal}),c(!0)},k=async I=>{if(window.confirm("tes-vous sr de vouloir supprimer cette classe ?"))try{await Tg(no(fn,"classes",I)),M()}catch(C){console.error("Erreur lors de la suppression:",C)}},S=async I=>{if(window.confirm("tes-vous sr de vouloir supprimer cet lve ?"))try{await Tg(no(fn,"eleves",I)),B(),M()}catch(C){console.error("Erreur lors de la suppression:",C)}},U=I=>r.filter(C=>C.classeId===I);return i?H.jsx("div",{className:"loading",children:"Chargement des classes..."}):H.jsxs("div",{className:"gestion-classes",children:[H.jsxs("div",{className:"header",children:[H.jsx("h1",{children:"Gestion des Classes"}),H.jsx("button",{className:"btn-primary",onClick:()=>{c(!0),_(null),E({nom:"",annee:new Date().getFullYear().toString(),professeurPrincipal:""})},children:"Ajouter une classe"})]}),o&&H.jsx("div",{className:"form-overlay",children:H.jsxs("div",{className:"form-container",children:[H.jsx("h2",{children:x?"Modifier la classe":"Nouvelle classe"}),H.jsxs("form",{onSubmit:Q,children:[H.jsxs("div",{className:"form-group",children:[H.jsx("label",{children:"Nom de la classe:"}),H.jsx("input",{type:"text",value:b.nom,onChange:I=>E({...b,nom:I.target.value}),required:!0})]}),H.jsxs("div",{className:"form-group",children:[H.jsx("label",{children:"Anne scolaire:"}),H.jsx("input",{type:"text",value:b.annee,onChange:I=>E({...b,annee:I.target.value}),required:!0})]}),H.jsxs("div",{className:"form-group",children:[H.jsx("label",{children:"Professeur principal:"}),H.jsx("input",{type:"text",value:b.professeurPrincipal,onChange:I=>E({...b,professeurPrincipal:I.target.value}),required:!0})]}),H.jsxs("div",{className:"form-actions",children:[H.jsx("button",{type:"submit",className:"btn-primary",children:x?"Modifier":"Ajouter"}),H.jsx("button",{type:"button",className:"btn-secondary",onClick:()=>{c(!1),_(null)},children:"Annuler"})]})]})]})}),u&&H.jsx("div",{className:"form-overlay",children:H.jsxs("div",{className:"form-container",children:[H.jsx("h2",{children:"Ajouter un lve"}),H.jsxs("form",{onSubmit:ee,children:[H.jsxs("div",{className:"form-group",children:[H.jsx("label",{children:"Classe:"}),H.jsxs("select",{value:d,onChange:I=>g(I.target.value),required:!0,children:[H.jsx("option",{value:"",children:"Slectionner une classe"}),t.map(I=>H.jsx("option",{value:I.id,children:I.nom},I.id))]})]}),H.jsxs("div",{className:"form-group",children:[H.jsx("label",{children:"Nom:"}),H.jsx("input",{type:"text",value:A.nom,onChange:I=>O({...A,nom:I.target.value}),required:!0})]}),H.jsxs("div",{className:"form-group",children:[H.jsx("label",{children:"Prnom:"}),H.jsx("input",{type:"text",value:A.prenom,onChange:I=>O({...A,prenom:I.target.value}),required:!0})]}),H.jsxs("div",{className:"form-group",children:[H.jsx("label",{children:"Date de naissance:"}),H.jsx("input",{type:"date",value:A.dateNaissance,onChange:I=>O({...A,dateNaissance:I.target.value}),required:!0})]}),H.jsxs("div",{className:"form-actions",children:[H.jsx("button",{type:"submit",className:"btn-primary",children:"Ajouter"}),H.jsx("button",{type:"button",className:"btn-secondary",onClick:()=>{h(!1),g(""),O({nom:"",prenom:"",dateNaissance:""})},children:"Annuler"})]})]})]})}),H.jsx("div",{className:"classes-grid",children:t.map(I=>{const C=U(I.id);return H.jsxs("div",{className:"class-tile",children:[H.jsxs("div",{className:"class-content",children:[H.jsx("h3",{children:I.nom}),H.jsxs("div",{className:"effectif",children:[H.jsx("span",{className:"effectif-number",children:I.effectif}),H.jsx("span",{className:"effectif-label",children:"lves"})]})]}),C.length>0&&H.jsxs("div",{className:"eleves-list",children:[H.jsx("h4",{children:"lves :"}),H.jsx("div",{className:"eleves-container",children:C.map(R=>H.jsxs("div",{className:"eleve-item",children:[H.jsxs("span",{children:[R.prenom," ",R.nom]}),H.jsx("button",{className:"btn-delete-small",onClick:()=>S(R.id),title:"Supprimer",children:""})]},R.id))})]}),H.jsxs("div",{className:"class-actions",children:[H.jsx("button",{className:"btn-add-eleve",onClick:()=>{g(I.id),h(!0)},title:"Ajouter un lve",children:"+"}),H.jsx("button",{className:"btn-import",onClick:()=>{g(I.id),document.getElementById("import-file")?.click()},title:"Importer des lves",children:""}),H.jsx("button",{className:"btn-edit",onClick:()=>F(I),title:"Modifier",children:""}),H.jsx("button",{className:"btn-delete",onClick:()=>k(I.id),title:"Supprimer",children:""})]})]},I.id)})}),H.jsx("input",{id:"import-file",type:"file",accept:".csv,.xlsx",style:{display:"none"},onChange:he}),t.length===0&&H.jsxs("div",{className:"empty-state",children:[H.jsx("p",{children:"Aucune classe enregistre"}),H.jsx("button",{className:"btn-primary",onClick:()=>c(!0),children:"Crer la premire classe"})]})]})},w2="periodesStage",Ik=async()=>{try{console.log("Service: Rcupration des priodes de stage...");const t=await io(Vi(fn,w2));console.log("Service: Nombre de documents trouvs:",t.docs.length);const e=t.docs.map(r=>{const n={id:r.id,...r.data()};return console.log("Service: Priode trouve:",n),n});return console.log("Service: Priodes retournes:",e),e}catch(t){throw console.error("Service: Erreur lors de la rcupration des priodes:",t),t}},LW=async t=>(await hh(Vi(fn,w2),t)).id,DW=async(t,e)=>{await u2(no(fn,w2,t),e)},FW=async t=>{await Tg(no(fn,w2,t))},ub=t=>t?new Date(t).toLocaleDateString("fr-FR"):"",OW=()=>{const[t,e]=lt.useState([]),[r,n]=lt.useState({nom:"",dateDebut:"",dateFin:""}),[i,a]=lt.useState(null),[o,c]=lt.useState(!1),[u,h]=lt.useState(!1),d=async()=>{c(!0),e(await Ik()),c(!1)};lt.useEffect(()=>{d()},[]);const g=A=>{n({...r,[A.target.name]:A.target.value})},x=async A=>{A.preventDefault(),i?(await DW(i,r),a(null)):await LW(r),n({nom:"",dateDebut:"",dateFin:""}),h(!1),d()},_=A=>{a(A.id),n({nom:A.nom,dateDebut:A.dateDebut,dateFin:A.dateFin}),h(!0)},b=async A=>{window.confirm("Supprimer cette priode ?")&&(await FW(A),d())},E=(A,O)=>{if(!A||!O)return 0;const M=new Date(A),B=new Date(O),Q=Math.abs(B.getTime()-M.getTime());return Math.ceil(Q/(1e3*60*60*24))};return o?H.jsx("div",{className:"loading",children:"Chargement des priodes..."}):H.jsxs("div",{className:"gestion-periodes-stage",children:[H.jsxs("div",{className:"header",children:[H.jsx("h1",{children:"Gestion des Priodes de Stage"}),H.jsx("button",{className:"btn-primary",onClick:()=>{h(!0),a(null),n({nom:"",dateDebut:"",dateFin:""})},children:"Ajouter une priode"})]}),u&&H.jsx("div",{className:"form-overlay",children:H.jsxs("div",{className:"form-container",children:[H.jsx("h2",{children:i?"Modifier la priode":"Nouvelle priode"}),H.jsxs("form",{onSubmit:x,children:[H.jsxs("div",{className:"form-group",children:[H.jsx("label",{children:"Nom de la priode:"}),H.jsx("input",{name:"nom",type:"text",placeholder:"Ex: PFMP1, PFMP2...",value:r.nom,onChange:g,required:!0})]}),H.jsxs("div",{className:"form-group",children:[H.jsx("label",{children:"Date de dbut:"}),H.jsx("input",{name:"dateDebut",type:"date",value:r.dateDebut,onChange:g,required:!0})]}),H.jsxs("div",{className:"form-group",children:[H.jsx("label",{children:"Date de fin:"}),H.jsx("input",{name:"dateFin",type:"date",value:r.dateFin,onChange:g,required:!0})]}),H.jsxs("div",{className:"form-actions",children:[H.jsx("button",{type:"submit",className:"btn-primary",children:i?"Modifier":"Ajouter"}),H.jsx("button",{type:"button",className:"btn-secondary",onClick:()=>{h(!1),a(null),n({nom:"",dateDebut:"",dateFin:""})},children:"Annuler"})]})]})]})}),H.jsx("div",{className:"periodes-grid",children:t.map(A=>{const O=E(A.dateDebut,A.dateFin);return H.jsxs("div",{className:"periode-tile",children:[H.jsxs("div",{className:"periode-content",children:[H.jsx("h3",{children:A.nom}),H.jsxs("div",{className:"periode-dates",children:[H.jsxs("div",{className:"date-item",children:[H.jsx("span",{className:"date-label",children:"Dbut"}),H.jsx("span",{className:"date-value",children:ub(A.dateDebut)})]}),H.jsxs("div",{className:"date-item",children:[H.jsx("span",{className:"date-label",children:"Fin"}),H.jsx("span",{className:"date-value",children:ub(A.dateFin)})]})]}),H.jsxs("div",{className:"periode-duree",children:[H.jsx("span",{className:"duree-number",children:O}),H.jsx("span",{className:"duree-label",children:"jours"})]})]}),H.jsxs("div",{className:"periode-actions",children:[H.jsx("button",{className:"btn-edit",onClick:()=>_(A),title:"Modifier",children:""}),H.jsx("button",{className:"btn-delete",onClick:()=>b(A.id),title:"Supprimer",children:""})]})]},A.id)})}),t.length===0&&H.jsxs("div",{className:"empty-state",children:[H.jsx("p",{children:"Aucune priode de stage enregistre"}),H.jsx("button",{className:"btn-primary",onClick:()=>h(!0),children:"Crer la premire priode"})]})]})},PW=()=>{const[t,e]=lt.useState([]),[r,n]=lt.useState([]),[i,a]=lt.useState([]),[o,c]=lt.useState(""),[u,h]=lt.useState(null),[d,g]=lt.useState(null),[x,_]=lt.useState(!0),[b,E]=lt.useState("selection"),[A,O]=lt.useState(""),[M,B]=lt.useState({eleveId:"",periodeId:"",dateEvaluation:new Date,nomEntreprise:"",domaineActivite:"",competences:{cc1_collecter_donnees:{niveau:"non_evaluee",commentaire:""},cc2_ordonner_donnees:{niveau:"non_evaluee",commentaire:""},cc2_reperer_contraintes:{niveau:"non_evaluee",commentaire:""},cc3_identifier_elements:{niveau:"non_evaluee",commentaire:""},cc3_identifier_grandeurs:{niveau:"non_evaluee",commentaire:""},cc3_representer_installation:{niveau:"non_evaluee",commentaire:""},cc4_implanter_cabler:{niveau:"non_evaluee",commentaire:""},cc4_realiser_installation:{niveau:"non_evaluee",commentaire:""},cc4_operer_attitude:{niveau:"non_evaluee",commentaire:""},cc7_controler_donnees:{niveau:"non_evaluee",commentaire:""},cc7_constater_defaillance:{niveau:"non_evaluee",commentaire:""},cc7_lister_hypotheses:{niveau:"non_evaluee",commentaire:""},cc8_completer_documents:{niveau:"non_evaluee",commentaire:""},cc8_expliquer_avancement:{niveau:"non_evaluee",commentaire:""},cc8_rediger_compte_rendu:{niveau:"non_evaluee",commentaire:""},cc9_interpreter_informations:{niveau:"non_evaluee",commentaire:""},cc9_expliquer_fonctionnement:{niveau:"non_evaluee",commentaire:""},cc9_informer_consignes:{niveau:"non_evaluee",commentaire:""}},commentaireGeneral:"",recommandations:""});lt.useEffect(()=>{Q()},[]);const Q=async()=>{try{console.log("=== DBUT CHARGEMENT DES DONNES ===");const Z=(await io(Vi(fn,"eleves"))).docs.map(j=>({id:j.id,...j.data()}));e(Z),console.log("lves chargs:",Z.length,Z);const xe=(await io(Vi(fn,"classes"))).docs.map(j=>({id:j.id,...j.data()}));n(xe),console.log("Classes charges:",xe.length,xe),console.log("Dbut chargement des priodes...");const L=await Ik();console.log("Priodes rcupres du service:",L),a(L),console.log("Priodes dfinies dans le state:",L.length),console.log("=== FIN CHARGEMENT DES DONNES ===")}catch(oe){console.error("Erreur lors du chargement des donnes:",oe)}finally{_(!1)}},ee=async()=>{try{const oe={nom:"PFMP1 - Test",dateDebut:"2024-01-15",dateFin:"2024-02-15"};await hh(Vi(fn,"periodesStage"),oe),console.log("Priode de test cre"),await Q(),alert("Priode de test cre avec succs !")}catch(oe){console.error("Erreur lors de la cration de la priode de test:",oe),alert("Erreur lors de la cration de la priode de test")}},he=async(oe,Z)=>{try{const X=_y(Vi(fn,"evaluations"),Ag("eleveId","==",oe),Ag("periodeId","==",Z)),xe=await io(X);if(xe.empty)return!1;{const L=xe.docs[0].data();return B({...L,id:xe.docs[0].id,dateEvaluation:L.dateEvaluation instanceof Date?L.dateEvaluation:new Date(L.dateEvaluation)}),!0}}catch(X){return console.error("Erreur lors du chargement de l'valuation existante:",X),!1}},F=async oe=>{if(o){if(!await he(o,oe)){const X={...M,eleveId:o,periodeId:oe,nomEntreprise:"",domaineActivite:"",competences:{cc1_collecter_donnees:{niveau:"non_evaluee",commentaire:""},cc2_ordonner_donnees:{niveau:"non_evaluee",commentaire:""},cc2_reperer_contraintes:{niveau:"non_evaluee",commentaire:""},cc3_identifier_elements:{niveau:"non_evaluee",commentaire:""},cc3_identifier_grandeurs:{niveau:"non_evaluee",commentaire:""},cc3_representer_installation:{niveau:"non_evaluee",commentaire:""},cc4_implanter_cabler:{niveau:"non_evaluee",commentaire:""},cc4_realiser_installation:{niveau:"non_evaluee",commentaire:""},cc4_operer_attitude:{niveau:"non_evaluee",commentaire:""},cc7_controler_donnees:{niveau:"non_evaluee",commentaire:""},cc7_constater_defaillance:{niveau:"non_evaluee",commentaire:""},cc7_lister_hypotheses:{niveau:"non_evaluee",commentaire:""},cc8_completer_documents:{niveau:"non_evaluee",commentaire:""},cc8_expliquer_avancement:{niveau:"non_evaluee",commentaire:""},cc8_rediger_compte_rendu:{niveau:"non_evaluee",commentaire:""},cc9_interpreter_informations:{niveau:"non_evaluee",commentaire:""},cc9_expliquer_fonctionnement:{niveau:"non_evaluee",commentaire:""},cc9_informer_consignes:{niveau:"non_evaluee",commentaire:""}},commentaireGeneral:"",recommandations:""};B(X)}}else B(Z=>({...Z,periodeId:oe}))},k=oe=>{const Z=t.find(xe=>xe.id===oe),X=r.find(xe=>xe.id===Z?.classeId);c(oe),h(Z||null),g(X||null),B(xe=>({...xe,eleveId:oe})),E("evaluation")},S=(oe,Z,X)=>{B(xe=>({...xe,competences:{...xe.competences,[oe]:{...xe.competences[oe],[Z]:X}}}))},U=oe=>({non_evaluee:"#gray",non_acquise:"#ff4444",en_cours:"#ff8800",partiellement_acquise:"#ffaa00",acquise:"#00aa44"})[oe],I=oe=>{if(!oe)return"";try{const Z=new Date(oe);return isNaN(Z.getTime())?oe:Z.toLocaleDateString("fr-FR")}catch{return oe}},C=oe=>{if(!oe)return"Non renseign";try{const Z=new Date(oe);return isNaN(Z.getTime())?oe.match(/^\d{4}-\d{2}-\d{2}$/)?oe.split("-").reverse().join("/"):oe:Z.toLocaleDateString("fr-FR")}catch{return oe}},R=(oe,Z)=>H.jsxs("select",{value:Z,onChange:X=>S(oe,"niveau",X.target.value),className:"niveau-select",style:{borderColor:U(Z)},children:[H.jsx("option",{value:"non_evaluee",children:" Non value"}),H.jsx("option",{value:"non_acquise",children:" Non acquise"}),H.jsx("option",{value:"en_cours",children:" En cours d'acquisition"}),H.jsx("option",{value:"partiellement_acquise",children:" Partiellement acquise"}),H.jsx("option",{value:"acquise",children:" Acquise"})]}),se=(oe,Z)=>{const X=M.competences[oe];return H.jsx("div",{className:"competence-tile",children:H.jsxs("div",{className:"competence-header",children:[H.jsx("h4",{className:"competence-title",children:Z}),R(oe,X.niveau)]})},oe)},ne=async oe=>{if(oe.preventDefault(),!M.eleveId||!M.periodeId){alert("Veuillez slectionner un lve et une priode");return}try{const Z={...M,dateEvaluation:new Date};if(M.id)console.log("Mise  jour de l'valuation existante:",M.id),await u2(no(fn,"evaluations",M.id),Z),alert("valuation mise  jour avec succs !");else{console.log("Cration d'une nouvelle valuation");const X=await hh(Vi(fn,"evaluations"),Z);console.log("Nouvelle valuation cre avec l'ID:",X.id),B(xe=>({...xe,id:X.id})),alert("valuation enregistre avec succs !")}}catch(Z){console.error("Erreur lors de la sauvegarde:",Z),alert("Erreur lors de la sauvegarde de l'valuation")}};if(x)return H.jsx("div",{className:"loading",children:"Chargement..."});const J=oe=>oe.normalize("NFD").replace(/[\u0300-\u036f]/g,"").toLowerCase(),de=t.filter(oe=>{const Z=J(A),X=J(oe.nom),xe=J(oe.prenom),L=J(`${oe.prenom} ${oe.nom}`);return X.includes(Z)||xe.includes(Z)||L.includes(Z)});return b==="selection"?H.jsxs("div",{className:"evaluation-eleve",children:[H.jsxs("div",{className:"header",children:[H.jsx("h1",{children:"valuation des lves"}),H.jsx("p",{children:"Slectionnez un lve pour commencer l'valuation"})]}),H.jsxs("div",{className:"search-section",children:[H.jsxs("div",{className:"search-box",children:[H.jsx("input",{type:"text",placeholder:"Rechercher un lve (nom ou prnom)...",value:A,onChange:oe=>O(oe.target.value),className:"search-input"}),H.jsx("span",{className:"search-icon",children:""})]}),A&&H.jsxs("p",{className:"search-results",children:[de.length,' lve(s) trouv(s) pour "',A,'"']})]}),H.jsx("div",{className:"eleves-grid",children:t.length===0?H.jsxs("div",{className:"no-data",children:[H.jsx("p",{children:"Aucun lve trouv."}),H.jsx("p",{children:`Veuillez d'abord aller dans "Gestion des Classes" pour ajouter des lves.`})]}):de.length===0?H.jsxs("div",{className:"no-data",children:[H.jsxs("p",{children:['Aucun lve trouv pour la recherche "',A,'".']}),H.jsx("p",{children:"Essayez avec un autre terme de recherche."})]}):de.sort((oe,Z)=>{const X=oe.nom.localeCompare(Z.nom,"fr",{sensitivity:"base"});return X!==0?X:oe.prenom.localeCompare(Z.prenom,"fr",{sensitivity:"base"})}).map(oe=>{const Z=r.find(X=>X.id===oe.classeId);return H.jsxs("div",{className:"eleve-tile",children:[H.jsxs("div",{className:"eleve-info",onClick:()=>k(oe.id),children:[H.jsxs("h3",{children:[oe.prenom," ",oe.nom.toUpperCase()]}),H.jsxs("p",{className:"classe",children:["Classe: ",Z?.nom||"Non assigne"]}),H.jsxs("p",{className:"naissance",children:["N(e) le: ",C(oe.dateNaissance)]})]}),H.jsx("div",{className:"eleve-actions",children:H.jsx("button",{className:"btn-evaluer",onClick:()=>k(oe.id),children:"valuer "})})]},oe.id)})})]}):H.jsxs("div",{className:"evaluation-eleve",children:[H.jsxs("div",{className:"header",children:[H.jsx("button",{className:"btn-retour",onClick:()=>E("selection"),children:" Retour  la slection"}),H.jsxs("div",{className:"eleve-selected",children:[H.jsxs("h1",{children:["valuation de ",u?.prenom," ",u?.nom.toUpperCase()]}),H.jsxs("p",{className:"classe-info",children:["Classe: ",d?.nom]})]})]}),H.jsxs("form",{onSubmit:ne,className:"evaluation-form",children:[H.jsxs("div",{className:"periode-selection-tile",children:[H.jsx("h2",{children:"Priode de stage"}),i.length===0?H.jsxs("div",{className:"no-periode",children:[H.jsx("p",{children:"Aucune priode de stage trouve."}),H.jsx("p",{children:`Veuillez d'abord aller dans "Gestion des Priodes de Stage" pour ajouter des priodes.`}),H.jsx("button",{type:"button",className:"btn-primary",onClick:ee,style:{marginTop:"1rem"},children:"Crer une priode de test"})]}):H.jsx("div",{className:"periodes-grid",children:i.map(oe=>H.jsxs("div",{className:`periode-tile ${M.periodeId===oe.id?"selected":""}`,onClick:()=>F(oe.id),children:[H.jsx("h3",{children:oe.nom}),H.jsxs("p",{children:[I(oe.dateDebut)," - ",I(oe.dateFin)]})]},oe.id))})]}),M.periodeId&&H.jsxs(H.Fragment,{children:[H.jsxs("div",{className:"entreprise-section",children:[H.jsx("h2",{children:"Informations de l'entreprise"}),H.jsxs("div",{className:"entreprise-grid",children:[H.jsxs("div",{className:"form-group",children:[H.jsx("label",{htmlFor:"nomEntreprise",children:"Nom de l'entreprise"}),H.jsx("input",{type:"text",id:"nomEntreprise",value:M.nomEntreprise,onChange:oe=>B({...M,nomEntreprise:oe.target.value}),placeholder:"Nom de l'entreprise d'accueil",className:"form-input"})]}),H.jsxs("div",{className:"form-group",children:[H.jsx("label",{htmlFor:"domaineActivite",children:"Domaine d'activit"}),H.jsx("input",{type:"text",id:"domaineActivite",value:M.domaineActivite,onChange:oe=>B({...M,domaineActivite:oe.target.value}),placeholder:"Domaine d'activit de l'entreprise",className:"form-input"})]})]})]}),H.jsxs("div",{className:"competence-section",children:[H.jsx("h2",{children:"CC1 - S'informer sur l'intervention ou la ralisation"}),H.jsx("div",{className:"competences-grid",children:se("cc1_collecter_donnees","Collecter les donnes ncessaires  l'intervention ou  la ralisation en utilisant les outils numriques")})]}),H.jsxs("div",{className:"competence-section",children:[H.jsx("h2",{children:"CC2 - Organiser la ralisation ou l'intervention"}),H.jsxs("div",{className:"competences-grid",children:[se("cc2_ordonner_donnees","Ordonner les donnes ncessaires  l'intervention ou  la ralisation en tenant compte des interactions avec les autres intervenants"),se("cc2_reperer_contraintes","Reprer les contraintes lies  l'efficacit nergtique")]})]}),H.jsxs("div",{className:"competence-section",children:[H.jsx("h2",{children:"CC3 - Analyser et exploiter les donnes"}),H.jsxs("div",{className:"competences-grid",children:[se("cc3_identifier_elements","Identifier les lments d'un systme nergtique, de son installation lectrique et de son environnement numrique"),se("cc3_identifier_grandeurs","Identifier les grandeurs physiques nominales associes  l'installation (tempratures, pressions, puissances, intensits, tensions, ...)"),se("cc3_representer_installation","Reprsenter tout ou partie d'une installation, manuellement ou avec un outil numrique")]})]}),H.jsxs("div",{className:"competence-section",children:[H.jsx("h2",{children:"CC4 - Raliser une installation ou une intervention"}),H.jsxs("div",{className:"competences-grid",children:[se("cc4_implanter_cabler","Implanter, cbler, raccorder les matriels, les supports, les appareillages et les quipements d'interconnexion"),se("cc4_realiser_installation","Raliser l'installation et/ou les modifications des rseaux fluidiques et/ou les cblages lectriques"),se("cc4_operer_attitude","Oprer avec une attitude coresponsable")]})]}),H.jsxs("div",{className:"competence-section",children:[H.jsx("h2",{children:"CC7 - tablir un pr-diagnostic  distance"}),H.jsxs("div",{className:"competences-grid",children:[se("cc7_controler_donnees","Contrler les donnes d'exploitation (indicateurs, voyants, ...) par rapport aux attendus"),se("cc7_constater_defaillance","Constater la dfaillance"),se("cc7_lister_hypotheses","Lister des hypothses de panne(s) et/ou de dysfonctionnement(s)")]})]}),H.jsxs("div",{className:"competence-section",children:[H.jsx("h2",{children:"CC8 - Renseigner les documents"}),H.jsxs("div",{className:"competences-grid",children:[se("cc8_completer_documents","Complter les documents techniques et administratifs"),se("cc8_expliquer_avancement","Expliquer l'tat d'avancement des oprations, leurs contraintes et leurs difficults"),se("cc8_rediger_compte_rendu","Rdiger un compte-rendu, un rapport d'activit")]})]}),H.jsxs("div",{className:"competence-section",children:[H.jsx("h2",{children:"CC9 - Communiquer avec le client et/ou l'usager"}),H.jsxs("div",{className:"competences-grid",children:[se("cc9_interpreter_informations","Interprter les informations du client et/ou l'exploitant sur ses besoins"),se("cc9_expliquer_fonctionnement","Expliquer le fonctionnement et l'utilisation de l'installation au client et/ou  l'exploitant"),se("cc9_informer_consignes","Informer oralement des consignes de scurit")]})]}),H.jsxs("div",{className:"commentaires-section",children:[H.jsxs("div",{className:"commentaire-tile",children:[H.jsx("h3",{children:"Commentaire gnral"}),H.jsx("textarea",{value:M.commentaireGeneral,onChange:oe=>B({...M,commentaireGeneral:oe.target.value}),rows:4,placeholder:"Commentaire gnral sur l'valuation..."})]}),H.jsxs("div",{className:"commentaire-tile",children:[H.jsx("h3",{children:"Recommandations"}),H.jsx("textarea",{value:M.recommandations,onChange:oe=>B({...M,recommandations:oe.target.value}),rows:4,placeholder:"Recommandations pour l'lve..."})]})]}),H.jsxs("div",{className:"form-actions",children:[H.jsx("button",{type:"submit",className:"btn-primary",children:M.id?" Mettre  jour l'valuation":" Enregistrer l'valuation"}),M.id&&H.jsx("p",{style:{marginTop:"0.5rem",fontSize:"0.9rem",color:"#666",textAlign:"center"},children:" Une valuation existe dj pour cette priode - elle sera mise  jour"})]})]})]})]})},MW="modulepreload",BW=function(t){return"/evalstage2/"+t},fb={},ox=function(e,r,n){let i=Promise.resolve();if(r&&r.length>0){let u=function(h){return Promise.all(h.map(d=>Promise.resolve(d).then(g=>({status:"fulfilled",value:g}),g=>({status:"rejected",reason:g}))))};document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),c=o?.nonce||o?.getAttribute("nonce");i=u(r.map(h=>{if(h=BW(h),h in fb)return;fb[h]=!0;const d=h.endsWith(".css"),g=d?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${h}"]${g}`))return;const x=document.createElement("link");if(x.rel=d?"stylesheet":MW,d||(x.as="script"),x.crossOrigin="",x.href=h,c&&x.setAttribute("nonce",c),document.head.appendChild(x),d)return new Promise((_,b)=>{x.addEventListener("load",_),x.addEventListener("error",()=>b(new Error(`Unable to preload CSS for ${h}`)))})}))}function a(o){const c=new Event("vite:preloadError",{cancelable:!0});if(c.payload=o,window.dispatchEvent(c),!c.defaultPrevented)throw o}return i.then(o=>{for(const c of o||[])c.status==="rejected"&&a(c.reason);return e().catch(a)})};function Sn(t){"@babel/helpers - typeof";return Sn=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Sn(t)}var ts=Uint8Array,ao=Uint16Array,o5=Int32Array,E2=new ts([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),b2=new ts([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),lx=new ts([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),Rk=function(t,e){for(var r=new ao(31),n=0;n<31;++n)r[n]=e+=1<<t[n-1];for(var i=new o5(r[30]),n=1;n<30;++n)for(var a=r[n];a<r[n+1];++a)i[a]=a-r[n]<<5|n;return{b:r,r:i}},Lk=Rk(E2,2),Dk=Lk.b,cx=Lk.r;Dk[28]=258,cx[258]=28;var Fk=Rk(b2,0),jW=Fk.b,hb=Fk.r,ux=new ao(32768);for(var Vn=0;Vn<32768;++Vn){var $u=(Vn&43690)>>1|(Vn&21845)<<1;$u=($u&52428)>>2|($u&13107)<<2,$u=($u&61680)>>4|($u&3855)<<4,ux[Vn]=(($u&65280)>>8|($u&255)<<8)>>1}var mc=function(t,e,r){for(var n=t.length,i=0,a=new ao(e);i<n;++i)t[i]&&++a[t[i]-1];var o=new ao(e);for(i=1;i<e;++i)o[i]=o[i-1]+a[i-1]<<1;var c;if(r){c=new ao(1<<e);var u=15-e;for(i=0;i<n;++i)if(t[i])for(var h=i<<4|t[i],d=e-t[i],g=o[t[i]-1]++<<d,x=g|(1<<d)-1;g<=x;++g)c[ux[g]>>u]=h}else for(c=new ao(n),i=0;i<n;++i)t[i]&&(c[i]=ux[o[t[i]-1]++]>>15-t[i]);return c},Af=new ts(288);for(var Vn=0;Vn<144;++Vn)Af[Vn]=8;for(var Vn=144;Vn<256;++Vn)Af[Vn]=9;for(var Vn=256;Vn<280;++Vn)Af[Vn]=7;for(var Vn=280;Vn<288;++Vn)Af[Vn]=8;var Q1=new ts(32);for(var Vn=0;Vn<32;++Vn)Q1[Vn]=5;var UW=mc(Af,9,0),VW=mc(Af,9,1),qW=mc(Q1,5,0),zW=mc(Q1,5,1),l_=function(t){for(var e=t[0],r=1;r<t.length;++r)t[r]>e&&(e=t[r]);return e},dl=function(t,e,r){var n=e/8|0;return(t[n]|t[n+1]<<8)>>(e&7)&r},c_=function(t,e){var r=e/8|0;return(t[r]|t[r+1]<<8|t[r+2]<<16)>>(e&7)},l5=function(t){return(t+7)/8|0},Ok=function(t,e,r){return(r==null||r>t.length)&&(r=t.length),new ts(t.subarray(e,r))},HW=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],ml=function(t,e,r){var n=new Error(e||HW[t]);if(n.code=t,Error.captureStackTrace&&Error.captureStackTrace(n,ml),!r)throw n;return n},GW=function(t,e,r,n){var i=t.length,a=0;if(!i||e.f&&!e.l)return r||new ts(0);var o=!r,c=o||e.i!=2,u=e.i;o&&(r=new ts(i*3));var h=function(Oe){var fe=r.length;if(Oe>fe){var rt=new ts(Math.max(fe*2,Oe));rt.set(r),r=rt}},d=e.f||0,g=e.p||0,x=e.b||0,_=e.l,b=e.d,E=e.m,A=e.n,O=i*8;do{if(!_){d=dl(t,g,1);var M=dl(t,g+1,3);if(g+=3,M)if(M==1)_=VW,b=zW,E=9,A=5;else if(M==2){var he=dl(t,g,31)+257,F=dl(t,g+10,15)+4,k=he+dl(t,g+5,31)+1;g+=14;for(var S=new ts(k),U=new ts(19),I=0;I<F;++I)U[lx[I]]=dl(t,g+I*3,7);g+=F*3;for(var C=l_(U),R=(1<<C)-1,se=mc(U,C,1),I=0;I<k;){var ne=se[dl(t,g,R)];g+=ne&15;var B=ne>>4;if(B<16)S[I++]=B;else{var J=0,de=0;for(B==16?(de=3+dl(t,g,3),g+=2,J=S[I-1]):B==17?(de=3+dl(t,g,7),g+=3):B==18&&(de=11+dl(t,g,127),g+=7);de--;)S[I++]=J}}var oe=S.subarray(0,he),Z=S.subarray(he);E=l_(oe),A=l_(Z),_=mc(oe,E,1),b=mc(Z,A,1)}else ml(1);else{var B=l5(g)+4,Q=t[B-4]|t[B-3]<<8,ee=B+Q;if(ee>i){u&&ml(0);break}c&&h(x+Q),r.set(t.subarray(B,ee),x),e.b=x+=Q,e.p=g=ee*8,e.f=d;continue}if(g>O){u&&ml(0);break}}c&&h(x+131072);for(var X=(1<<E)-1,xe=(1<<A)-1,L=g;;L=g){var J=_[c_(t,g)&X],j=J>>4;if(g+=J&15,g>O){u&&ml(0);break}if(J||ml(2),j<256)r[x++]=j;else if(j==256){L=g,_=null;break}else{var z=j-254;if(j>264){var I=j-257,G=E2[I];z=dl(t,g,(1<<G)-1)+Dk[I],g+=G}var ae=b[c_(t,g)&xe],Ae=ae>>4;ae||ml(3),g+=ae&15;var Z=jW[Ae];if(Ae>3){var G=b2[Ae];Z+=c_(t,g)&(1<<G)-1,g+=G}if(g>O){u&&ml(0);break}c&&h(x+131072);var _e=x+z;if(x<Z){var Ee=a-Z,Ce=Math.min(Z,_e);for(Ee+x<0&&ml(3);x<Ce;++x)r[x]=n[Ee+x]}for(;x<_e;++x)r[x]=r[x-Z]}}e.l=_,e.p=L,e.b=x,e.f=d,_&&(d=1,e.m=E,e.d=b,e.n=A)}while(!d);return x!=r.length&&o?Ok(r,0,x):r.subarray(0,x)},Kc=function(t,e,r){r<<=e&7;var n=e/8|0;t[n]|=r,t[n+1]|=r>>8},e1=function(t,e,r){r<<=e&7;var n=e/8|0;t[n]|=r,t[n+1]|=r>>8,t[n+2]|=r>>16},u_=function(t,e){for(var r=[],n=0;n<t.length;++n)t[n]&&r.push({s:n,f:t[n]});var i=r.length,a=r.slice();if(!i)return{t:Mk,l:0};if(i==1){var o=new ts(r[0].s+1);return o[r[0].s]=1,{t:o,l:1}}r.sort(function(ee,he){return ee.f-he.f}),r.push({s:-1,f:25001});var c=r[0],u=r[1],h=0,d=1,g=2;for(r[0]={s:-1,f:c.f+u.f,l:c,r:u};d!=i-1;)c=r[r[h].f<r[g].f?h++:g++],u=r[h!=d&&r[h].f<r[g].f?h++:g++],r[d++]={s:-1,f:c.f+u.f,l:c,r:u};for(var x=a[0].s,n=1;n<i;++n)a[n].s>x&&(x=a[n].s);var _=new ao(x+1),b=fx(r[d-1],_,0);if(b>e){var n=0,E=0,A=b-e,O=1<<A;for(a.sort(function(he,F){return _[F.s]-_[he.s]||he.f-F.f});n<i;++n){var M=a[n].s;if(_[M]>e)E+=O-(1<<b-_[M]),_[M]=e;else break}for(E>>=A;E>0;){var B=a[n].s;_[B]<e?E-=1<<e-_[B]++-1:++n}for(;n>=0&&E;--n){var Q=a[n].s;_[Q]==e&&(--_[Q],++E)}b=e}return{t:new ts(_),l:b}},fx=function(t,e,r){return t.s==-1?Math.max(fx(t.l,e,r+1),fx(t.r,e,r+1)):e[t.s]=r},db=function(t){for(var e=t.length;e&&!t[--e];);for(var r=new ao(++e),n=0,i=t[0],a=1,o=function(u){r[n++]=u},c=1;c<=e;++c)if(t[c]==i&&c!=e)++a;else{if(!i&&a>2){for(;a>138;a-=138)o(32754);a>2&&(o(a>10?a-11<<5|28690:a-3<<5|12305),a=0)}else if(a>3){for(o(i),--a;a>6;a-=6)o(8304);a>2&&(o(a-3<<5|8208),a=0)}for(;a--;)o(i);a=1,i=t[c]}return{c:r.subarray(0,n),n:e}},t1=function(t,e){for(var r=0,n=0;n<e.length;++n)r+=t[n]*e[n];return r},Pk=function(t,e,r){var n=r.length,i=l5(e+2);t[i]=n&255,t[i+1]=n>>8,t[i+2]=t[i]^255,t[i+3]=t[i+1]^255;for(var a=0;a<n;++a)t[i+a+4]=r[a];return(i+4+n)*8},pb=function(t,e,r,n,i,a,o,c,u,h,d){Kc(e,d++,r),++i[256];for(var g=u_(i,15),x=g.t,_=g.l,b=u_(a,15),E=b.t,A=b.l,O=db(x),M=O.c,B=O.n,Q=db(E),ee=Q.c,he=Q.n,F=new ao(19),k=0;k<M.length;++k)++F[M[k]&31];for(var k=0;k<ee.length;++k)++F[ee[k]&31];for(var S=u_(F,7),U=S.t,I=S.l,C=19;C>4&&!U[lx[C-1]];--C);var R=h+5<<3,se=t1(i,Af)+t1(a,Q1)+o,ne=t1(i,x)+t1(a,E)+o+14+3*C+t1(F,U)+2*F[16]+3*F[17]+7*F[18];if(u>=0&&R<=se&&R<=ne)return Pk(e,d,t.subarray(u,u+h));var J,de,oe,Z;if(Kc(e,d,1+(ne<se)),d+=2,ne<se){J=mc(x,_,0),de=x,oe=mc(E,A,0),Z=E;var X=mc(U,I,0);Kc(e,d,B-257),Kc(e,d+5,he-1),Kc(e,d+10,C-4),d+=14;for(var k=0;k<C;++k)Kc(e,d+3*k,U[lx[k]]);d+=3*C;for(var xe=[M,ee],L=0;L<2;++L)for(var j=xe[L],k=0;k<j.length;++k){var z=j[k]&31;Kc(e,d,X[z]),d+=U[z],z>15&&(Kc(e,d,j[k]>>5&127),d+=j[k]>>12)}}else J=UW,de=Af,oe=qW,Z=Q1;for(var k=0;k<c;++k){var G=n[k];if(G>255){var z=G>>18&31;e1(e,d,J[z+257]),d+=de[z+257],z>7&&(Kc(e,d,G>>23&31),d+=E2[z]);var ae=G&31;e1(e,d,oe[ae]),d+=Z[ae],ae>3&&(e1(e,d,G>>5&8191),d+=b2[ae])}else e1(e,d,J[G]),d+=de[G]}return e1(e,d,J[256]),d+de[256]},WW=new o5([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),Mk=new ts(0),XW=function(t,e,r,n,i,a){var o=a.z||t.length,c=new ts(n+o+5*(1+Math.ceil(o/7e3))+i),u=c.subarray(n,c.length-i),h=a.l,d=(a.r||0)&7;if(e){d&&(u[0]=a.r>>3);for(var g=WW[e-1],x=g>>13,_=g&8191,b=(1<<r)-1,E=a.p||new ao(32768),A=a.h||new ao(b+1),O=Math.ceil(r/3),M=2*O,B=function(ot){return(t[ot]^t[ot+1]<<O^t[ot+2]<<M)&b},Q=new o5(25e3),ee=new ao(288),he=new ao(32),F=0,k=0,S=a.i||0,U=0,I=a.w||0,C=0;S+2<o;++S){var R=B(S),se=S&32767,ne=A[R];if(E[se]=ne,A[R]=se,I<=S){var J=o-S;if((F>7e3||U>24576)&&(J>423||!h)){d=pb(t,u,0,Q,ee,he,k,U,C,S-C,d),U=F=k=0,C=S;for(var de=0;de<286;++de)ee[de]=0;for(var de=0;de<30;++de)he[de]=0}var oe=2,Z=0,X=_,xe=se-ne&32767;if(J>2&&R==B(S-xe))for(var L=Math.min(x,J)-1,j=Math.min(32767,S),z=Math.min(258,J);xe<=j&&--X&&se!=ne;){if(t[S+oe]==t[S+oe-xe]){for(var G=0;G<z&&t[S+G]==t[S+G-xe];++G);if(G>oe){if(oe=G,Z=xe,G>L)break;for(var ae=Math.min(xe,G-2),Ae=0,de=0;de<ae;++de){var _e=S-xe+de&32767,Ee=E[_e],Ce=_e-Ee&32767;Ce>Ae&&(Ae=Ce,ne=_e)}}}se=ne,ne=E[se],xe+=se-ne&32767}if(Z){Q[U++]=268435456|cx[oe]<<18|hb[Z];var Oe=cx[oe]&31,fe=hb[Z]&31;k+=E2[Oe]+b2[fe],++ee[257+Oe],++he[fe],I=S+oe,++F}else Q[U++]=t[S],++ee[t[S]]}}for(S=Math.max(S,I);S<o;++S)Q[U++]=t[S],++ee[t[S]];d=pb(t,u,h,Q,ee,he,k,U,C,S-C,d),h||(a.r=d&7|u[d/8|0]<<3,d-=7,a.h=A,a.p=E,a.i=S,a.w=I)}else{for(var S=a.w||0;S<o+h;S+=65535){var rt=S+65535;rt>=o&&(u[d/8|0]=h,rt=o),d=Pk(u,d+1,t.subarray(S,rt))}a.i=o}return Ok(c,0,n+l5(d)+i)},Bk=function(){var t=1,e=0;return{p:function(r){for(var n=t,i=e,a=r.length|0,o=0;o!=a;){for(var c=Math.min(o+2655,a);o<c;++o)i+=n+=r[o];n=(n&65535)+15*(n>>16),i=(i&65535)+15*(i>>16)}t=n,e=i},d:function(){return t%=65521,e%=65521,(t&255)<<24|(t&65280)<<8|(e&255)<<8|e>>8}}},YW=function(t,e,r,n,i){if(!i&&(i={l:1},e.dictionary)){var a=e.dictionary.subarray(-32768),o=new ts(a.length+t.length);o.set(a),o.set(t,a.length),t=o,i.w=a.length}return XW(t,e.level==null?6:e.level,e.mem==null?i.l?Math.ceil(Math.max(8,Math.min(13,Math.log(t.length)))*1.5):20:12+e.mem,r,n,i)},jk=function(t,e,r){for(;r;++e)t[e]=r,r>>>=8},KW=function(t,e){var r=e.level,n=r==0?0:r<6?1:r==9?3:2;if(t[0]=120,t[1]=n<<6|(e.dictionary&&32),t[1]|=31-(t[0]<<8|t[1])%31,e.dictionary){var i=Bk();i.p(e.dictionary),jk(t,2,i.d())}},$W=function(t,e){return((t[0]&15)!=8||t[0]>>4>7||(t[0]<<8|t[1])%31)&&ml(6,"invalid zlib data"),(t[1]>>5&1)==1&&ml(6,"invalid zlib data: "+(t[1]&32?"need":"unexpected")+" dictionary"),(t[1]>>3&4)+2};function hx(t,e){e||(e={});var r=Bk();r.p(t);var n=YW(t,e,e.dictionary?6:2,4);return KW(n,e),jk(n,n.length-4,r.d()),n}function QW(t,e){return GW(t.subarray($W(t),-4),{i:2},e,e)}var JW=typeof TextDecoder<"u"&&new TextDecoder,ZW=0;try{JW.decode(Mk,{stream:!0}),ZW=1}catch{}var cr=function(){return typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:this}();function f_(){cr.console&&typeof cr.console.log=="function"&&cr.console.log.apply(cr.console,arguments)}var Ln={log:f_,warn:function(t){cr.console&&(typeof cr.console.warn=="function"?cr.console.warn.apply(cr.console,arguments):f_.call(null,arguments))},error:function(t){cr.console&&(typeof cr.console.error=="function"?cr.console.error.apply(cr.console,arguments):f_(t))}};function h_(t,e,r){var n=new XMLHttpRequest;n.open("GET",t),n.responseType="blob",n.onload=function(){sh(n.response,e,r)},n.onerror=function(){Ln.error("could not download file")},n.send()}function mb(t){var e=new XMLHttpRequest;e.open("HEAD",t,!1);try{e.send()}catch{}return e.status>=200&&e.status<=299}function Om(t){try{t.dispatchEvent(new MouseEvent("click"))}catch{var e=document.createEvent("MouseEvents");e.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),t.dispatchEvent(e)}}var A1,dx,sh=cr.saveAs||((typeof window>"u"?"undefined":Sn(window))!=="object"||window!==cr?function(){}:typeof HTMLAnchorElement<"u"&&"download"in HTMLAnchorElement.prototype?function(t,e,r){var n=cr.URL||cr.webkitURL,i=document.createElement("a");e=e||t.name||"download",i.download=e,i.rel="noopener",typeof t=="string"?(i.href=t,i.origin!==location.origin?mb(i.href)?h_(t,e,r):Om(i,i.target="_blank"):Om(i)):(i.href=n.createObjectURL(t),setTimeout(function(){n.revokeObjectURL(i.href)},4e4),setTimeout(function(){Om(i)},0))}:"msSaveOrOpenBlob"in navigator?function(t,e,r){if(e=e||t.name||"download",typeof t=="string")if(mb(t))h_(t,e,r);else{var n=document.createElement("a");n.href=t,n.target="_blank",setTimeout(function(){Om(n)})}else navigator.msSaveOrOpenBlob(function(i,a){return a===void 0?a={autoBom:!1}:Sn(a)!=="object"&&(Ln.warn("Deprecated: Expected third argument to be a object"),a={autoBom:!a}),a.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(i.type)?new Blob(["\uFEFF",i],{type:i.type}):i}(t,r),e)}:function(t,e,r,n){if((n=n||open("","_blank"))&&(n.document.title=n.document.body.innerText="downloading..."),typeof t=="string")return h_(t,e,r);var i=t.type==="application/octet-stream",a=/constructor/i.test(cr.HTMLElement)||cr.safari,o=/CriOS\/[\d]+/.test(navigator.userAgent);if((o||i&&a)&&(typeof FileReader>"u"?"undefined":Sn(FileReader))==="object"){var c=new FileReader;c.onloadend=function(){var d=c.result;d=o?d:d.replace(/^data:[^;]*;/,"data:attachment/file;"),n?n.location.href=d:location=d,n=null},c.readAsDataURL(t)}else{var u=cr.URL||cr.webkitURL,h=u.createObjectURL(t);n?n.location=h:location.href=h,n=null,setTimeout(function(){u.revokeObjectURL(h)},4e4)}});/**
 * A class to parse color values
 * @author Stoyan Stefanov <sstoo@gmail.com>
 * {@link   http://www.phpied.com/rgb-color-parser-in-javascript/}
 * @license Use it if you like it
 */function Uk(t){var e;t=t||"",this.ok=!1,t.charAt(0)=="#"&&(t=t.substr(1,6)),t={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"}[t=(t=t.replace(/ /g,"")).toLowerCase()]||t;for(var r=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(c){return[parseInt(c[1]),parseInt(c[2]),parseInt(c[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(c){return[parseInt(c[1],16),parseInt(c[2],16),parseInt(c[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(c){return[parseInt(c[1]+c[1],16),parseInt(c[2]+c[2],16),parseInt(c[3]+c[3],16)]}}],n=0;n<r.length;n++){var i=r[n].re,a=r[n].process,o=i.exec(t);o&&(e=a(o),this.r=e[0],this.g=e[1],this.b=e[2],this.ok=!0)}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toHex=function(){var c=this.r.toString(16),u=this.g.toString(16),h=this.b.toString(16);return c.length==1&&(c="0"+c),u.length==1&&(u="0"+u),h.length==1&&(h="0"+h),"#"+c+u+h}}/**
 * @license
 * Joseph Myers does not specify a particular license for his work.
 *
 * Author: Joseph Myers
 * Accessed from: http://www.myersdaily.org/joseph/javascript/md5.js
 *
 * Modified by: Owen Leong
 */function d_(t,e){var r=t[0],n=t[1],i=t[2],a=t[3];r=Ga(r,n,i,a,e[0],7,-680876936),a=Ga(a,r,n,i,e[1],12,-389564586),i=Ga(i,a,r,n,e[2],17,606105819),n=Ga(n,i,a,r,e[3],22,-1044525330),r=Ga(r,n,i,a,e[4],7,-176418897),a=Ga(a,r,n,i,e[5],12,1200080426),i=Ga(i,a,r,n,e[6],17,-1473231341),n=Ga(n,i,a,r,e[7],22,-45705983),r=Ga(r,n,i,a,e[8],7,1770035416),a=Ga(a,r,n,i,e[9],12,-1958414417),i=Ga(i,a,r,n,e[10],17,-42063),n=Ga(n,i,a,r,e[11],22,-1990404162),r=Ga(r,n,i,a,e[12],7,1804603682),a=Ga(a,r,n,i,e[13],12,-40341101),i=Ga(i,a,r,n,e[14],17,-1502002290),r=Wa(r,n=Ga(n,i,a,r,e[15],22,1236535329),i,a,e[1],5,-165796510),a=Wa(a,r,n,i,e[6],9,-1069501632),i=Wa(i,a,r,n,e[11],14,643717713),n=Wa(n,i,a,r,e[0],20,-373897302),r=Wa(r,n,i,a,e[5],5,-701558691),a=Wa(a,r,n,i,e[10],9,38016083),i=Wa(i,a,r,n,e[15],14,-660478335),n=Wa(n,i,a,r,e[4],20,-405537848),r=Wa(r,n,i,a,e[9],5,568446438),a=Wa(a,r,n,i,e[14],9,-1019803690),i=Wa(i,a,r,n,e[3],14,-187363961),n=Wa(n,i,a,r,e[8],20,1163531501),r=Wa(r,n,i,a,e[13],5,-1444681467),a=Wa(a,r,n,i,e[2],9,-51403784),i=Wa(i,a,r,n,e[7],14,1735328473),r=Xa(r,n=Wa(n,i,a,r,e[12],20,-1926607734),i,a,e[5],4,-378558),a=Xa(a,r,n,i,e[8],11,-2022574463),i=Xa(i,a,r,n,e[11],16,1839030562),n=Xa(n,i,a,r,e[14],23,-35309556),r=Xa(r,n,i,a,e[1],4,-1530992060),a=Xa(a,r,n,i,e[4],11,1272893353),i=Xa(i,a,r,n,e[7],16,-155497632),n=Xa(n,i,a,r,e[10],23,-1094730640),r=Xa(r,n,i,a,e[13],4,681279174),a=Xa(a,r,n,i,e[0],11,-358537222),i=Xa(i,a,r,n,e[3],16,-722521979),n=Xa(n,i,a,r,e[6],23,76029189),r=Xa(r,n,i,a,e[9],4,-640364487),a=Xa(a,r,n,i,e[12],11,-421815835),i=Xa(i,a,r,n,e[15],16,530742520),r=Ya(r,n=Xa(n,i,a,r,e[2],23,-995338651),i,a,e[0],6,-198630844),a=Ya(a,r,n,i,e[7],10,1126891415),i=Ya(i,a,r,n,e[14],15,-1416354905),n=Ya(n,i,a,r,e[5],21,-57434055),r=Ya(r,n,i,a,e[12],6,1700485571),a=Ya(a,r,n,i,e[3],10,-1894986606),i=Ya(i,a,r,n,e[10],15,-1051523),n=Ya(n,i,a,r,e[1],21,-2054922799),r=Ya(r,n,i,a,e[8],6,1873313359),a=Ya(a,r,n,i,e[15],10,-30611744),i=Ya(i,a,r,n,e[6],15,-1560198380),n=Ya(n,i,a,r,e[13],21,1309151649),r=Ya(r,n,i,a,e[4],6,-145523070),a=Ya(a,r,n,i,e[11],10,-1120210379),i=Ya(i,a,r,n,e[2],15,718787259),n=Ya(n,i,a,r,e[9],21,-343485551),t[0]=of(r,t[0]),t[1]=of(n,t[1]),t[2]=of(i,t[2]),t[3]=of(a,t[3])}function S2(t,e,r,n,i,a){return e=of(of(e,t),of(n,a)),of(e<<i|e>>>32-i,r)}function Ga(t,e,r,n,i,a,o){return S2(e&r|~e&n,t,e,i,a,o)}function Wa(t,e,r,n,i,a,o){return S2(e&n|r&~n,t,e,i,a,o)}function Xa(t,e,r,n,i,a,o){return S2(e^r^n,t,e,i,a,o)}function Ya(t,e,r,n,i,a,o){return S2(r^(e|~n),t,e,i,a,o)}function Vk(t){var e,r=t.length,n=[1732584193,-271733879,-1732584194,271733878];for(e=64;e<=t.length;e+=64)d_(n,eX(t.substring(e-64,e)));t=t.substring(e-64);var i=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(e=0;e<t.length;e++)i[e>>2]|=t.charCodeAt(e)<<(e%4<<3);if(i[e>>2]|=128<<(e%4<<3),e>55)for(d_(n,i),e=0;e<16;e++)i[e]=0;return i[14]=8*r,d_(n,i),n}function eX(t){var e,r=[];for(e=0;e<64;e+=4)r[e>>2]=t.charCodeAt(e)+(t.charCodeAt(e+1)<<8)+(t.charCodeAt(e+2)<<16)+(t.charCodeAt(e+3)<<24);return r}A1=cr.atob.bind(cr),dx=cr.btoa.bind(cr);var gb="0123456789abcdef".split("");function tX(t){for(var e="",r=0;r<4;r++)e+=gb[t>>8*r+4&15]+gb[t>>8*r&15];return e}function rX(t){return String.fromCharCode((255&t)>>0,(65280&t)>>8,(16711680&t)>>16,(4278190080&t)>>24)}function px(t){return Vk(t).map(rX).join("")}var nX=function(t){for(var e=0;e<t.length;e++)t[e]=tX(t[e]);return t.join("")}(Vk("hello"))!="5d41402abc4b2a76b9719d911017c592";function of(t,e){if(nX){var r=(65535&t)+(65535&e);return(t>>16)+(e>>16)+(r>>16)<<16|65535&r}return t+e&4294967295}/**
 * @license
 * FPDF is released under a permissive license: there is no usage restriction.
 * You may embed it freely in your application (commercial or not), with or
 * without modifications.
 *
 * Reference: http://www.fpdf.org/en/script/script37.php
 */function mx(t,e){var r,n,i,a;if(t!==r){for(var o=(i=t,a=1+(256/t.length>>0),new Array(a+1).join(i)),c=[],u=0;u<256;u++)c[u]=u;var h=0;for(u=0;u<256;u++){var d=c[u];h=(h+d+o.charCodeAt(u))%256,c[u]=c[h],c[h]=d}r=t,n=c}else c=n;var g=e.length,x=0,_=0,b="";for(u=0;u<g;u++)_=(_+(d=c[x=(x+1)%256]))%256,c[x]=c[_],c[_]=d,o=c[(c[x]+c[_])%256],b+=String.fromCharCode(e.charCodeAt(u)^o);return b}/**
 * @license
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 * Author: Owen Leong (@owenl131)
 * Date: 15 Oct 2020
 * References:
 * https://www.cs.cmu.edu/~dst/Adobe/Gallery/anon21jul01-pdf-encryption.txt
 * https://github.com/foliojs/pdfkit/blob/master/lib/security.js
 * http://www.fpdf.org/en/script/script37.php
 */var vb={print:4,modify:8,copy:16,"annot-forms":32};function k0(t,e,r,n){this.v=1,this.r=2;var i=192;t.forEach(function(c){if(vb.perm!==void 0)throw new Error("Invalid permission: "+c);i+=vb[c]}),this.padding="(N^NuAd\0NV\b..\0h>/\fdSiz";var a=(e+this.padding).substr(0,32),o=(r+this.padding).substr(0,32);this.O=this.processOwnerPassword(a,o),this.P=-(1+(255^i)),this.encryptionKey=px(a+this.O+this.lsbFirstWord(this.P)+this.hexToBytes(n)).substr(0,5),this.U=mx(this.encryptionKey,this.padding)}function N0(t){if(/[^\u0000-\u00ff]/.test(t))throw new Error("Invalid PDF Name Object: "+t+", Only accept ASCII characters.");for(var e="",r=t.length,n=0;n<r;n++){var i=t.charCodeAt(n);i<33||i===35||i===37||i===40||i===41||i===47||i===60||i===62||i===91||i===93||i===123||i===125||i>126?e+="#"+("0"+i.toString(16)).slice(-2):e+=t[n]}return e}function _b(t){if(Sn(t)!=="object")throw new Error("Invalid Context passed to initialize PubSub (jsPDF-module)");var e={};this.subscribe=function(r,n,i){if(i=i||!1,typeof r!="string"||typeof n!="function"||typeof i!="boolean")throw new Error("Invalid arguments passed to PubSub.subscribe (jsPDF-module)");e.hasOwnProperty(r)||(e[r]={});var a=Math.random().toString(35);return e[r][a]=[n,!!i],a},this.unsubscribe=function(r){for(var n in e)if(e[n][r])return delete e[n][r],Object.keys(e[n]).length===0&&delete e[n],!0;return!1},this.publish=function(r){if(e.hasOwnProperty(r)){var n=Array.prototype.slice.call(arguments,1),i=[];for(var a in e[r]){var o=e[r][a];try{o[0].apply(t,n)}catch(c){cr.console&&Ln.error("jsPDF PubSub Error",c.message,c)}o[1]&&i.push(a)}i.length&&i.forEach(this.unsubscribe)}},this.getTopics=function(){return e}}function Ug(t){if(!(this instanceof Ug))return new Ug(t);var e="opacity,stroke-opacity".split(",");for(var r in t)t.hasOwnProperty(r)&&e.indexOf(r)>=0&&(this[r]=t[r]);this.id="",this.objectNumber=-1}function qk(t,e){this.gState=t,this.matrix=e,this.id="",this.objectNumber=-1}function lh(t,e,r,n,i){if(!(this instanceof lh))return new lh(t,e,r,n,i);this.type=t==="axial"?2:3,this.coords=e,this.colors=r,qk.call(this,n,i)}function R0(t,e,r,n,i){if(!(this instanceof R0))return new R0(t,e,r,n,i);this.boundingBox=t,this.xStep=e,this.yStep=r,this.stream="",this.cloneIndex=0,qk.call(this,n,i)}function ar(t){var e,r=typeof arguments[0]=="string"?arguments[0]:"p",n=arguments[1],i=arguments[2],a=arguments[3],o=[],c=1,u=16,h="S",d=null;Sn(t=t||{})==="object"&&(r=t.orientation,n=t.unit||n,i=t.format||i,a=t.compress||t.compressPdf||a,(d=t.encryption||null)!==null&&(d.userPassword=d.userPassword||"",d.ownerPassword=d.ownerPassword||"",d.userPermissions=d.userPermissions||[]),c=typeof t.userUnit=="number"?Math.abs(t.userUnit):1,t.precision!==void 0&&(e=t.precision),t.floatPrecision!==void 0&&(u=t.floatPrecision),h=t.defaultPathOperation||"S"),o=t.filters||(a===!0?["FlateEncode"]:o),n=n||"mm",r=(""+(r||"P")).toLowerCase();var g=t.putOnlyUsedFonts||!1,x={},_={internal:{},__private__:{}};_.__private__.PubSub=_b;var b="1.3",E=_.__private__.getPdfVersion=function(){return b};_.__private__.setPdfVersion=function(N){b=N};var A={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};_.__private__.getPageFormats=function(){return A};var O=_.__private__.getPageFormat=function(N){return A[N]};i=i||"a4";var M={COMPAT:"compat",ADVANCED:"advanced"},B=M.COMPAT;function Q(){this.saveGraphicsState(),ge(new jt(_t,0,0,-_t,0,aa()*_t).toString()+" cm"),this.setFontSize(this.getFontSize()/_t),h="n",B=M.ADVANCED}function ee(){this.restoreGraphicsState(),h="S",B=M.COMPAT}var he=_.__private__.combineFontStyleAndFontWeight=function(N,K){if(N=="bold"&&K=="normal"||N=="bold"&&K==400||N=="normal"&&K=="italic"||N=="bold"&&K=="italic")throw new Error("Invalid Combination of fontweight and fontstyle");return K&&(N=K==400||K==="normal"?N==="italic"?"italic":"normal":K!=700&&K!=="bold"||N!=="normal"?(K==700?"bold":K)+""+N:"bold"),N};_.advancedAPI=function(N){var K=B===M.COMPAT;return K&&Q.call(this),typeof N!="function"||(N(this),K&&ee.call(this)),this},_.compatAPI=function(N){var K=B===M.ADVANCED;return K&&ee.call(this),typeof N!="function"||(N(this),K&&Q.call(this)),this},_.isAdvancedAPI=function(){return B===M.ADVANCED};var F,k=function(N){if(B!==M.ADVANCED)throw new Error(N+" is only available in 'advanced' API mode. You need to call advancedAPI() first.")},S=_.roundToPrecision=_.__private__.roundToPrecision=function(N,K){var Te=e||K;if(isNaN(N)||isNaN(Te))throw new Error("Invalid argument passed to jsPDF.roundToPrecision");return N.toFixed(Te).replace(/0+$/,"")};F=_.hpf=_.__private__.hpf=typeof u=="number"?function(N){if(isNaN(N))throw new Error("Invalid argument passed to jsPDF.hpf");return S(N,u)}:u==="smart"?function(N){if(isNaN(N))throw new Error("Invalid argument passed to jsPDF.hpf");return S(N,N>-1&&N<1?16:5)}:function(N){if(isNaN(N))throw new Error("Invalid argument passed to jsPDF.hpf");return S(N,16)};var U=_.f2=_.__private__.f2=function(N){if(isNaN(N))throw new Error("Invalid argument passed to jsPDF.f2");return S(N,2)},I=_.__private__.f3=function(N){if(isNaN(N))throw new Error("Invalid argument passed to jsPDF.f3");return S(N,3)},C=_.scale=_.__private__.scale=function(N){if(isNaN(N))throw new Error("Invalid argument passed to jsPDF.scale");return B===M.COMPAT?N*_t:B===M.ADVANCED?N:void 0},R=function(N){return B===M.COMPAT?aa()-N:B===M.ADVANCED?N:void 0},se=function(N){return C(R(N))};_.__private__.setPrecision=_.setPrecision=function(N){typeof parseInt(N,10)=="number"&&(e=parseInt(N,10))};var ne,J="00000000000000000000000000000000",de=_.__private__.getFileId=function(){return J},oe=_.__private__.setFileId=function(N){return J=N!==void 0&&/^[a-fA-F0-9]{32}$/.test(N)?N.toUpperCase():J.split("").map(function(){return"ABCDEF0123456789".charAt(Math.floor(16*Math.random()))}).join(""),d!==null&&(vn=new k0(d.userPermissions,d.userPassword,d.ownerPassword,J)),J};_.setFileId=function(N){return oe(N),this},_.getFileId=function(){return de()};var Z=_.__private__.convertDateToPDFDate=function(N){var K=N.getTimezoneOffset(),Te=K<0?"+":"-",Ne=Math.floor(Math.abs(K/60)),Be=Math.abs(K%60),tt=[Te,z(Ne),"'",z(Be),"'"].join("");return["D:",N.getFullYear(),z(N.getMonth()+1),z(N.getDate()),z(N.getHours()),z(N.getMinutes()),z(N.getSeconds()),tt].join("")},X=_.__private__.convertPDFDateToDate=function(N){var K=parseInt(N.substr(2,4),10),Te=parseInt(N.substr(6,2),10)-1,Ne=parseInt(N.substr(8,2),10),Be=parseInt(N.substr(10,2),10),tt=parseInt(N.substr(12,2),10),yt=parseInt(N.substr(14,2),10);return new Date(K,Te,Ne,Be,tt,yt,0)},xe=_.__private__.setCreationDate=function(N){var K;if(N===void 0&&(N=new Date),N instanceof Date)K=Z(N);else{if(!/^D:(20[0-2][0-9]|203[0-7]|19[7-9][0-9])(0[0-9]|1[0-2])([0-2][0-9]|3[0-1])(0[0-9]|1[0-9]|2[0-3])(0[0-9]|[1-5][0-9])(0[0-9]|[1-5][0-9])(\+0[0-9]|\+1[0-4]|-0[0-9]|-1[0-1])'(0[0-9]|[1-5][0-9])'?$/.test(N))throw new Error("Invalid argument passed to jsPDF.setCreationDate");K=N}return ne=K},L=_.__private__.getCreationDate=function(N){var K=ne;return N==="jsDate"&&(K=X(ne)),K};_.setCreationDate=function(N){return xe(N),this},_.getCreationDate=function(N){return L(N)};var j,z=_.__private__.padd2=function(N){return("0"+parseInt(N)).slice(-2)},G=_.__private__.padd2Hex=function(N){return("00"+(N=N.toString())).substr(N.length)},ae=0,Ae=[],_e=[],Ee=0,Ce=[],Oe=[],fe=!1,rt=_e,ot=function(){ae=0,Ee=0,_e=[],Ae=[],Ce=[],me=Fn(),ve=Fn()};_.__private__.setCustomOutputDestination=function(N){fe=!0,rt=N};var Pe=function(N){fe||(rt=N)};_.__private__.resetCustomOutputDestination=function(){fe=!1,rt=_e};var ge=_.__private__.out=function(N){return N=N.toString(),Ee+=N.length+1,rt.push(N),rt},Je=_.__private__.write=function(N){return ge(arguments.length===1?N.toString():Array.prototype.join.call(arguments," "))},nt=_.__private__.getArrayBuffer=function(N){for(var K=N.length,Te=new ArrayBuffer(K),Ne=new Uint8Array(Te);K--;)Ne[K]=N.charCodeAt(K);return Te},et=[["Helvetica","helvetica","normal","WinAnsiEncoding"],["Helvetica-Bold","helvetica","bold","WinAnsiEncoding"],["Helvetica-Oblique","helvetica","italic","WinAnsiEncoding"],["Helvetica-BoldOblique","helvetica","bolditalic","WinAnsiEncoding"],["Courier","courier","normal","WinAnsiEncoding"],["Courier-Bold","courier","bold","WinAnsiEncoding"],["Courier-Oblique","courier","italic","WinAnsiEncoding"],["Courier-BoldOblique","courier","bolditalic","WinAnsiEncoding"],["Times-Roman","times","normal","WinAnsiEncoding"],["Times-Bold","times","bold","WinAnsiEncoding"],["Times-Italic","times","italic","WinAnsiEncoding"],["Times-BoldItalic","times","bolditalic","WinAnsiEncoding"],["ZapfDingbats","zapfdingbats","normal",null],["Symbol","symbol","normal",null]];_.__private__.getStandardFonts=function(){return et};var vt=t.fontSize||16;_.__private__.setFontSize=_.setFontSize=function(N){return vt=B===M.ADVANCED?N/_t:N,this};var Et,bt=_.__private__.getFontSize=_.getFontSize=function(){return B===M.COMPAT?vt:vt*_t},Mt=t.R2L||!1;_.__private__.setR2L=_.setR2L=function(N){return Mt=N,this},_.__private__.getR2L=_.getR2L=function(){return Mt};var Dt,qt=_.__private__.setZoomMode=function(N){var K=[void 0,null,"fullwidth","fullheight","fullpage","original"];if(/^(?:\d+\.\d*|\d*\.\d+|\d+)%$/.test(N))Et=N;else if(isNaN(N)){if(K.indexOf(N)===-1)throw new Error('zoom must be Integer (e.g. 2), a percentage Value (e.g. 300%) or fullwidth, fullheight, fullpage, original. "'+N+'" is not recognized.');Et=N}else Et=parseInt(N,10)};_.__private__.getZoomMode=function(){return Et};var Tt,kt=_.__private__.setPageMode=function(N){if([void 0,null,"UseNone","UseOutlines","UseThumbs","FullScreen"].indexOf(N)==-1)throw new Error('Page mode must be one of UseNone, UseOutlines, UseThumbs, or FullScreen. "'+N+'" is not recognized.');Dt=N};_.__private__.getPageMode=function(){return Dt};var zt=_.__private__.setLayoutMode=function(N){if([void 0,null,"continuous","single","twoleft","tworight","two"].indexOf(N)==-1)throw new Error('Layout mode must be one of continuous, single, twoleft, tworight. "'+N+'" is not recognized.');Tt=N};_.__private__.getLayoutMode=function(){return Tt},_.__private__.setDisplayMode=_.setDisplayMode=function(N,K,Te){return qt(N),zt(K),kt(Te),this};var Pt={title:"",subject:"",author:"",keywords:"",creator:""};_.__private__.getDocumentProperty=function(N){if(Object.keys(Pt).indexOf(N)===-1)throw new Error("Invalid argument passed to jsPDF.getDocumentProperty");return Pt[N]},_.__private__.getDocumentProperties=function(){return Pt},_.__private__.setDocumentProperties=_.setProperties=_.setDocumentProperties=function(N){for(var K in Pt)Pt.hasOwnProperty(K)&&N[K]&&(Pt[K]=N[K]);return this},_.__private__.setDocumentProperty=function(N,K){if(Object.keys(Pt).indexOf(N)===-1)throw new Error("Invalid arguments passed to jsPDF.setDocumentProperty");return Pt[N]=K};var Nt,_t,or,Gt,zr,yr={},Qr={},Ii=[],Tr={},Ra={},hn={},Yn={},di=null,Jr=0,Kt=[],Dr=new _b(_),ea=t.hotfixes||[],Dn={},pi={},ga=[],jt=function N(K,Te,Ne,Be,tt,yt){if(!(this instanceof N))return new N(K,Te,Ne,Be,tt,yt);isNaN(K)&&(K=1),isNaN(Te)&&(Te=0),isNaN(Ne)&&(Ne=0),isNaN(Be)&&(Be=1),isNaN(tt)&&(tt=0),isNaN(yt)&&(yt=0),this._matrix=[K,Te,Ne,Be,tt,yt]};Object.defineProperty(jt.prototype,"sx",{get:function(){return this._matrix[0]},set:function(N){this._matrix[0]=N}}),Object.defineProperty(jt.prototype,"shy",{get:function(){return this._matrix[1]},set:function(N){this._matrix[1]=N}}),Object.defineProperty(jt.prototype,"shx",{get:function(){return this._matrix[2]},set:function(N){this._matrix[2]=N}}),Object.defineProperty(jt.prototype,"sy",{get:function(){return this._matrix[3]},set:function(N){this._matrix[3]=N}}),Object.defineProperty(jt.prototype,"tx",{get:function(){return this._matrix[4]},set:function(N){this._matrix[4]=N}}),Object.defineProperty(jt.prototype,"ty",{get:function(){return this._matrix[5]},set:function(N){this._matrix[5]=N}}),Object.defineProperty(jt.prototype,"a",{get:function(){return this._matrix[0]},set:function(N){this._matrix[0]=N}}),Object.defineProperty(jt.prototype,"b",{get:function(){return this._matrix[1]},set:function(N){this._matrix[1]=N}}),Object.defineProperty(jt.prototype,"c",{get:function(){return this._matrix[2]},set:function(N){this._matrix[2]=N}}),Object.defineProperty(jt.prototype,"d",{get:function(){return this._matrix[3]},set:function(N){this._matrix[3]=N}}),Object.defineProperty(jt.prototype,"e",{get:function(){return this._matrix[4]},set:function(N){this._matrix[4]=N}}),Object.defineProperty(jt.prototype,"f",{get:function(){return this._matrix[5]},set:function(N){this._matrix[5]=N}}),Object.defineProperty(jt.prototype,"rotation",{get:function(){return Math.atan2(this.shx,this.sx)}}),Object.defineProperty(jt.prototype,"scaleX",{get:function(){return this.decompose().scale.sx}}),Object.defineProperty(jt.prototype,"scaleY",{get:function(){return this.decompose().scale.sy}}),Object.defineProperty(jt.prototype,"isIdentity",{get:function(){return this.sx===1&&this.shy===0&&this.shx===0&&this.sy===1&&this.tx===0&&this.ty===0}}),jt.prototype.join=function(N){return[this.sx,this.shy,this.shx,this.sy,this.tx,this.ty].map(F).join(N)},jt.prototype.multiply=function(N){var K=N.sx*this.sx+N.shy*this.shx,Te=N.sx*this.shy+N.shy*this.sy,Ne=N.shx*this.sx+N.sy*this.shx,Be=N.shx*this.shy+N.sy*this.sy,tt=N.tx*this.sx+N.ty*this.shx+this.tx,yt=N.tx*this.shy+N.ty*this.sy+this.ty;return new jt(K,Te,Ne,Be,tt,yt)},jt.prototype.decompose=function(){var N=this.sx,K=this.shy,Te=this.shx,Ne=this.sy,Be=this.tx,tt=this.ty,yt=Math.sqrt(N*N+K*K),Ft=(N/=yt)*Te+(K/=yt)*Ne;Te-=N*Ft,Ne-=K*Ft;var v=Math.sqrt(Te*Te+Ne*Ne);return Ft/=v,N*(Ne/=v)<K*(Te/=v)&&(N=-N,K=-K,Ft=-Ft,yt=-yt),{scale:new jt(yt,0,0,v,0,0),translate:new jt(1,0,0,1,Be,tt),rotate:new jt(N,K,-K,N,0,0),skew:new jt(1,0,Ft,1,0,0)}},jt.prototype.toString=function(N){return this.join(" ")},jt.prototype.inversed=function(){var N=this.sx,K=this.shy,Te=this.shx,Ne=this.sy,Be=this.tx,tt=this.ty,yt=1/(N*Ne-K*Te),Ft=Ne*yt,v=-K*yt,P=-Te*yt,q=N*yt;return new jt(Ft,v,P,q,-Ft*Be-P*tt,-v*Be-q*tt)},jt.prototype.applyToPoint=function(N){var K=N.x*this.sx+N.y*this.shx+this.tx,Te=N.x*this.shy+N.y*this.sy+this.ty;return new Xo(K,Te)},jt.prototype.applyToRectangle=function(N){var K=this.applyToPoint(N),Te=this.applyToPoint(new Xo(N.x+N.w,N.y+N.h));return new Rl(K.x,K.y,Te.x-K.x,Te.y-K.y)},jt.prototype.clone=function(){var N=this.sx,K=this.shy,Te=this.shx,Ne=this.sy,Be=this.tx,tt=this.ty;return new jt(N,K,Te,Ne,Be,tt)},_.Matrix=jt;var Zr=_.matrixMult=function(N,K){return K.multiply(N)},Hr=new jt(1,0,0,1,0,0);_.unitMatrix=_.identityMatrix=Hr;var gn=function(N,K){if(!Ra[N]){var Te=(K instanceof lh?"Sh":"P")+(Object.keys(Tr).length+1).toString(10);K.id=Te,Ra[N]=Te,Tr[Te]=K,Dr.publish("addPattern",K)}};_.ShadingPattern=lh,_.TilingPattern=R0,_.addShadingPattern=function(N,K){return k("addShadingPattern()"),gn(N,K),this},_.beginTilingPattern=function(N){k("beginTilingPattern()"),vo(N.boundingBox[0],N.boundingBox[1],N.boundingBox[2]-N.boundingBox[0],N.boundingBox[3]-N.boundingBox[1],N.matrix)},_.endTilingPattern=function(N,K){k("endTilingPattern()"),K.stream=Oe[j].join(`
`),gn(N,K),Dr.publish("endTilingPattern",K),ga.pop().restore()};var In=_.__private__.newObject=function(){var N=Fn();return te(N,!0),N},Fn=_.__private__.newObjectDeferred=function(){return ae++,Ae[ae]=function(){return Ee},ae},te=function(N,K){return K=typeof K=="boolean"&&K,Ae[N]=Ee,K&&ge(N+" 0 obj"),N},be=_.__private__.newAdditionalObject=function(){var N={objId:Fn(),content:""};return Ce.push(N),N},me=Fn(),ve=Fn(),we=_.__private__.decodeColorString=function(N){var K=N.split(" ");if(K.length!==2||K[1]!=="g"&&K[1]!=="G")K.length===5&&(K[4]==="k"||K[4]==="K")&&(K=[(1-K[0])*(1-K[3]),(1-K[1])*(1-K[3]),(1-K[2])*(1-K[3]),"r"]);else{var Te=parseFloat(K[0]);K=[Te,Te,Te,"r"]}for(var Ne="#",Be=0;Be<3;Be++)Ne+=("0"+Math.floor(255*parseFloat(K[Be])).toString(16)).slice(-2);return Ne},Se=_.__private__.encodeColorString=function(N){var K;typeof N=="string"&&(N={ch1:N});var Te=N.ch1,Ne=N.ch2,Be=N.ch3,tt=N.ch4,yt=N.pdfColorType==="draw"?["G","RG","K"]:["g","rg","k"];if(typeof Te=="string"&&Te.charAt(0)!=="#"){var Ft=new Uk(Te);if(Ft.ok)Te=Ft.toHex();else if(!/^\d*\.?\d*$/.test(Te))throw new Error('Invalid color "'+Te+'" passed to jsPDF.encodeColorString.')}if(typeof Te=="string"&&/^#[0-9A-Fa-f]{3}$/.test(Te)&&(Te="#"+Te[1]+Te[1]+Te[2]+Te[2]+Te[3]+Te[3]),typeof Te=="string"&&/^#[0-9A-Fa-f]{6}$/.test(Te)){var v=parseInt(Te.substr(1),16);Te=v>>16&255,Ne=v>>8&255,Be=255&v}if(Ne===void 0||tt===void 0&&Te===Ne&&Ne===Be)if(typeof Te=="string")K=Te+" "+yt[0];else switch(N.precision){case 2:K=U(Te/255)+" "+yt[0];break;case 3:default:K=I(Te/255)+" "+yt[0]}else if(tt===void 0||Sn(tt)==="object"){if(tt&&!isNaN(tt.a)&&tt.a===0)return K=["1.","1.","1.",yt[1]].join(" ");if(typeof Te=="string")K=[Te,Ne,Be,yt[1]].join(" ");else switch(N.precision){case 2:K=[U(Te/255),U(Ne/255),U(Be/255),yt[1]].join(" ");break;default:case 3:K=[I(Te/255),I(Ne/255),I(Be/255),yt[1]].join(" ")}}else if(typeof Te=="string")K=[Te,Ne,Be,tt,yt[2]].join(" ");else switch(N.precision){case 2:K=[U(Te),U(Ne),U(Be),U(tt),yt[2]].join(" ");break;case 3:default:K=[I(Te),I(Ne),I(Be),I(tt),yt[2]].join(" ")}return K},Ve=_.__private__.getFilters=function(){return o},$e=_.__private__.putStream=function(N){var K=(N=N||{}).data||"",Te=N.filters||Ve(),Ne=N.alreadyAppliedFilters||[],Be=N.addLength1||!1,tt=K.length,yt=N.objectId,Ft=function(rr){return rr};if(d!==null&&yt===void 0)throw new Error("ObjectId must be passed to putStream for file encryption");d!==null&&(Ft=vn.encryptor(yt,0));var v={};Te===!0&&(Te=["FlateEncode"]);var P=N.additionalKeyValues||[],q=(v=ar.API.processDataByFilters!==void 0?ar.API.processDataByFilters(K,Te):{data:K,reverseChain:[]}).reverseChain+(Array.isArray(Ne)?Ne.join(" "):Ne.toString());if(v.data.length!==0&&(P.push({key:"Length",value:v.data.length}),Be===!0&&P.push({key:"Length1",value:tt})),q.length!=0)if(q.split("/").length-1==1)P.push({key:"Filter",value:q});else{P.push({key:"Filter",value:"["+q+"]"});for(var ce=0;ce<P.length;ce+=1)if(P[ce].key==="DecodeParms"){for(var Fe=[],We=0;We<v.reverseChain.split("/").length-1;We+=1)Fe.push("null");Fe.push(P[ce].value),P[ce].value="["+Fe.join(" ")+"]"}}ge("<<");for(var wt=0;wt<P.length;wt++)ge("/"+P[wt].key+" "+P[wt].value);ge(">>"),v.data.length!==0&&(ge("stream"),ge(Ft(v.data)),ge("endstream"))},Me=_.__private__.putPage=function(N){var K=N.number,Te=N.data,Ne=N.objId,Be=N.contentsObjId;te(Ne,!0),ge("<</Type /Page"),ge("/Parent "+N.rootDictionaryObjId+" 0 R"),ge("/Resources "+N.resourceDictionaryObjId+" 0 R"),ge("/MediaBox ["+parseFloat(F(N.mediaBox.bottomLeftX))+" "+parseFloat(F(N.mediaBox.bottomLeftY))+" "+F(N.mediaBox.topRightX)+" "+F(N.mediaBox.topRightY)+"]"),N.cropBox!==null&&ge("/CropBox ["+F(N.cropBox.bottomLeftX)+" "+F(N.cropBox.bottomLeftY)+" "+F(N.cropBox.topRightX)+" "+F(N.cropBox.topRightY)+"]"),N.bleedBox!==null&&ge("/BleedBox ["+F(N.bleedBox.bottomLeftX)+" "+F(N.bleedBox.bottomLeftY)+" "+F(N.bleedBox.topRightX)+" "+F(N.bleedBox.topRightY)+"]"),N.trimBox!==null&&ge("/TrimBox ["+F(N.trimBox.bottomLeftX)+" "+F(N.trimBox.bottomLeftY)+" "+F(N.trimBox.topRightX)+" "+F(N.trimBox.topRightY)+"]"),N.artBox!==null&&ge("/ArtBox ["+F(N.artBox.bottomLeftX)+" "+F(N.artBox.bottomLeftY)+" "+F(N.artBox.topRightX)+" "+F(N.artBox.topRightY)+"]"),typeof N.userUnit=="number"&&N.userUnit!==1&&ge("/UserUnit "+N.userUnit),Dr.publish("putPage",{objId:Ne,pageContext:Kt[K],pageNumber:K,page:Te}),ge("/Contents "+Be+" 0 R"),ge(">>"),ge("endobj");var tt=Te.join(`
`);return B===M.ADVANCED&&(tt+=`
Q`),te(Be,!0),$e({data:tt,filters:Ve(),objectId:Be}),ge("endobj"),Ne},He=_.__private__.putPages=function(){var N,K,Te=[];for(N=1;N<=Jr;N++)Kt[N].objId=Fn(),Kt[N].contentsObjId=Fn();for(N=1;N<=Jr;N++)Te.push(Me({number:N,data:Oe[N],objId:Kt[N].objId,contentsObjId:Kt[N].contentsObjId,mediaBox:Kt[N].mediaBox,cropBox:Kt[N].cropBox,bleedBox:Kt[N].bleedBox,trimBox:Kt[N].trimBox,artBox:Kt[N].artBox,userUnit:Kt[N].userUnit,rootDictionaryObjId:me,resourceDictionaryObjId:ve}));te(me,!0),ge("<</Type /Pages");var Ne="/Kids [";for(K=0;K<Jr;K++)Ne+=Te[K]+" 0 R ";ge(Ne+"]"),ge("/Count "+Jr),ge(">>"),ge("endobj"),Dr.publish("postPutPages")},Ye=function(N){Dr.publish("putFont",{font:N,out:ge,newObject:In,putStream:$e}),N.isAlreadyPutted!==!0&&(N.objectNumber=In(),ge("<<"),ge("/Type /Font"),ge("/BaseFont /"+N0(N.postScriptName)),ge("/Subtype /Type1"),typeof N.encoding=="string"&&ge("/Encoding /"+N.encoding),ge("/FirstChar 32"),ge("/LastChar 255"),ge(">>"),ge("endobj"))},pt=function(){for(var N in yr)yr.hasOwnProperty(N)&&(g===!1||g===!0&&x.hasOwnProperty(N))&&Ye(yr[N])},At=function(N){N.objectNumber=In();var K=[];K.push({key:"Type",value:"/XObject"}),K.push({key:"Subtype",value:"/Form"}),K.push({key:"BBox",value:"["+[F(N.x),F(N.y),F(N.x+N.width),F(N.y+N.height)].join(" ")+"]"}),K.push({key:"Matrix",value:"["+N.matrix.toString()+"]"});var Te=N.pages[1].join(`
`);$e({data:Te,additionalKeyValues:K,objectId:N.objectNumber}),ge("endobj")},Bt=function(){for(var N in Dn)Dn.hasOwnProperty(N)&&At(Dn[N])},St=function(N,K){var Te,Ne=[],Be=1/(K-1);for(Te=0;Te<1;Te+=Be)Ne.push(Te);if(Ne.push(1),N[0].offset!=0){var tt={offset:0,color:N[0].color};N.unshift(tt)}if(N[N.length-1].offset!=1){var yt={offset:1,color:N[N.length-1].color};N.push(yt)}for(var Ft="",v=0,P=0;P<Ne.length;P++){for(Te=Ne[P];Te>N[v+1].offset;)v++;var q=N[v].offset,ce=(Te-q)/(N[v+1].offset-q),Fe=N[v].color,We=N[v+1].color;Ft+=G(Math.round((1-ce)*Fe[0]+ce*We[0]).toString(16))+G(Math.round((1-ce)*Fe[1]+ce*We[1]).toString(16))+G(Math.round((1-ce)*Fe[2]+ce*We[2]).toString(16))}return Ft.trim()},Rt=function(N,K){K||(K=21);var Te=In(),Ne=St(N.colors,K),Be=[];Be.push({key:"FunctionType",value:"0"}),Be.push({key:"Domain",value:"[0.0 1.0]"}),Be.push({key:"Size",value:"["+K+"]"}),Be.push({key:"BitsPerSample",value:"8"}),Be.push({key:"Range",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),Be.push({key:"Decode",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),$e({data:Ne,additionalKeyValues:Be,alreadyAppliedFilters:["/ASCIIHexDecode"],objectId:Te}),ge("endobj"),N.objectNumber=In(),ge("<< /ShadingType "+N.type),ge("/ColorSpace /DeviceRGB");var tt="/Coords ["+F(parseFloat(N.coords[0]))+" "+F(parseFloat(N.coords[1]))+" ";N.type===2?tt+=F(parseFloat(N.coords[2]))+" "+F(parseFloat(N.coords[3])):tt+=F(parseFloat(N.coords[2]))+" "+F(parseFloat(N.coords[3]))+" "+F(parseFloat(N.coords[4]))+" "+F(parseFloat(N.coords[5])),ge(tt+="]"),N.matrix&&ge("/Matrix ["+N.matrix.toString()+"]"),ge("/Function "+Te+" 0 R"),ge("/Extend [true true]"),ge(">>"),ge("endobj")},er=function(N,K){var Te=Fn(),Ne=In();K.push({resourcesOid:Te,objectOid:Ne}),N.objectNumber=Ne;var Be=[];Be.push({key:"Type",value:"/Pattern"}),Be.push({key:"PatternType",value:"1"}),Be.push({key:"PaintType",value:"1"}),Be.push({key:"TilingType",value:"1"}),Be.push({key:"BBox",value:"["+N.boundingBox.map(F).join(" ")+"]"}),Be.push({key:"XStep",value:F(N.xStep)}),Be.push({key:"YStep",value:F(N.yStep)}),Be.push({key:"Resources",value:Te+" 0 R"}),N.matrix&&Be.push({key:"Matrix",value:"["+N.matrix.toString()+"]"}),$e({data:N.stream,additionalKeyValues:Be,objectId:N.objectNumber}),ge("endobj")},kr=function(N){var K;for(K in Tr)Tr.hasOwnProperty(K)&&(Tr[K]instanceof lh?Rt(Tr[K]):Tr[K]instanceof R0&&er(Tr[K],N))},Nr=function(N){for(var K in N.objectNumber=In(),ge("<<"),N)switch(K){case"opacity":ge("/ca "+U(N[K]));break;case"stroke-opacity":ge("/CA "+U(N[K]))}ge(">>"),ge("endobj")},Fr=function(){var N;for(N in hn)hn.hasOwnProperty(N)&&Nr(hn[N])},Hi=function(){for(var N in ge("/XObject <<"),Dn)Dn.hasOwnProperty(N)&&Dn[N].objectNumber>=0&&ge("/"+N+" "+Dn[N].objectNumber+" 0 R");Dr.publish("putXobjectDict"),ge(">>")},ds=function(){vn.oid=In(),ge("<<"),ge("/Filter /Standard"),ge("/V "+vn.v),ge("/R "+vn.r),ge("/U <"+vn.toHexString(vn.U)+">"),ge("/O <"+vn.toHexString(vn.O)+">"),ge("/P "+vn.P),ge(">>"),ge("endobj")},Ri=function(){for(var N in ge("/Font <<"),yr)yr.hasOwnProperty(N)&&(g===!1||g===!0&&x.hasOwnProperty(N))&&ge("/"+N+" "+yr[N].objectNumber+" 0 R");ge(">>")},ta=function(){if(Object.keys(Tr).length>0){for(var N in ge("/Shading <<"),Tr)Tr.hasOwnProperty(N)&&Tr[N]instanceof lh&&Tr[N].objectNumber>=0&&ge("/"+N+" "+Tr[N].objectNumber+" 0 R");Dr.publish("putShadingPatternDict"),ge(">>")}},va=function(N){if(Object.keys(Tr).length>0){for(var K in ge("/Pattern <<"),Tr)Tr.hasOwnProperty(K)&&Tr[K]instanceof _.TilingPattern&&Tr[K].objectNumber>=0&&Tr[K].objectNumber<N&&ge("/"+K+" "+Tr[K].objectNumber+" 0 R");Dr.publish("putTilingPatternDict"),ge(">>")}},Gi=function(){if(Object.keys(hn).length>0){var N;for(N in ge("/ExtGState <<"),hn)hn.hasOwnProperty(N)&&hn[N].objectNumber>=0&&ge("/"+N+" "+hn[N].objectNumber+" 0 R");Dr.publish("putGStateDict"),ge(">>")}},An=function(N){te(N.resourcesOid,!0),ge("<<"),ge("/ProcSet [/PDF /Text /ImageB /ImageC /ImageI]"),Ri(),ta(),va(N.objectOid),Gi(),Hi(),ge(">>"),ge("endobj")},Li=function(){var N=[];pt(),Fr(),Bt(),kr(N),Dr.publish("putResources"),N.forEach(An),An({resourcesOid:ve,objectOid:Number.MAX_SAFE_INTEGER}),Dr.publish("postPutResources")},Tl=function(){Dr.publish("putAdditionalObjects");for(var N=0;N<Ce.length;N++){var K=Ce[N];te(K.objId,!0),ge(K.content),ge("endobj")}Dr.publish("postPutAdditionalObjects")},pu=function(N){Qr[N.fontName]=Qr[N.fontName]||{},Qr[N.fontName][N.fontStyle]=N.id},oo=function(N,K,Te,Ne,Be){var tt={id:"F"+(Object.keys(yr).length+1).toString(10),postScriptName:N,fontName:K,fontStyle:Te,encoding:Ne,isStandardFont:Be||!1,metadata:{}};return Dr.publish("addFont",{font:tt,instance:this}),yr[tt.id]=tt,pu(tt),tt.id},yc=function(N){for(var K=0,Te=et.length;K<Te;K++){var Ne=oo.call(this,N[K][0],N[K][1],N[K][2],et[K][3],!0);g===!1&&(x[Ne]=!0);var Be=N[K][0].split("-");pu({id:Ne,fontName:Be[0],fontStyle:Be[1]||""})}Dr.publish("addFonts",{fonts:yr,dictionary:Qr})},Wi=function(N){return N.foo=function(){try{return N.apply(this,arguments)}catch(Ne){var K=Ne.stack||"";~K.indexOf(" at ")&&(K=K.split(" at ")[1]);var Te="Error in function "+K.split(`
`)[0].split("<")[0]+": "+Ne.message;if(!cr.console)throw new Error(Te);cr.console.error(Te,Ne),cr.alert&&alert(Te)}},N.foo.bar=N,N.foo},kl=function(N,K){var Te,Ne,Be,tt,yt,Ft,v,P,q;if(Be=(K=K||{}).sourceEncoding||"Unicode",yt=K.outputEncoding,(K.autoencode||yt)&&yr[Nt].metadata&&yr[Nt].metadata[Be]&&yr[Nt].metadata[Be].encoding&&(tt=yr[Nt].metadata[Be].encoding,!yt&&yr[Nt].encoding&&(yt=yr[Nt].encoding),!yt&&tt.codePages&&(yt=tt.codePages[0]),typeof yt=="string"&&(yt=tt[yt]),yt)){for(v=!1,Ft=[],Te=0,Ne=N.length;Te<Ne;Te++)(P=yt[N.charCodeAt(Te)])?Ft.push(String.fromCharCode(P)):Ft.push(N[Te]),Ft[Te].charCodeAt(0)>>8&&(v=!0);N=Ft.join("")}for(Te=N.length;v===void 0&&Te!==0;)N.charCodeAt(Te-1)>>8&&(v=!0),Te--;if(!v)return N;for(Ft=K.noBOM?[]:[254,255],Te=0,Ne=N.length;Te<Ne;Te++){if((q=(P=N.charCodeAt(Te))>>8)>>8)throw new Error("Character at position "+Te+" of string '"+N+"' exceeds 16bits. Cannot be encoded into UCS-2 BE");Ft.push(q),Ft.push(P-(q<<8))}return String.fromCharCode.apply(void 0,Ft)},Gr=_.__private__.pdfEscape=_.pdfEscape=function(N,K){return kl(N,K).replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},Xi=_.__private__.beginPage=function(N){Oe[++Jr]=[],Kt[Jr]={objId:0,contentsObjId:0,userUnit:Number(c),artBox:null,bleedBox:null,cropBox:null,trimBox:null,mediaBox:{bottomLeftX:0,bottomLeftY:0,topRightX:Number(N[0]),topRightY:Number(N[1])}},ps(Jr),Pe(Oe[j])},lo=function(N,K){var Te,Ne,Be;switch(r=K||r,typeof N=="string"&&(Te=O(N.toLowerCase()),Array.isArray(Te)&&(Ne=Te[0],Be=Te[1])),Array.isArray(N)&&(Ne=N[0]*_t,Be=N[1]*_t),isNaN(Ne)&&(Ne=i[0],Be=i[1]),(Ne>14400||Be>14400)&&(Ln.warn("A page in a PDF can not be wider or taller than 14400 userUnit. jsPDF limits the width/height to 14400"),Ne=Math.min(14400,Ne),Be=Math.min(14400,Be)),i=[Ne,Be],r.substr(0,1)){case"l":Be>Ne&&(i=[Be,Ne]);break;case"p":Ne>Be&&(i=[Be,Ne])}Xi(i),Sc(ho),ge(Yi),Ac!==0&&ge(Ac+" J"),Wo!==0&&ge(Wo+" j"),Dr.publish("addPage",{pageNumber:Jr})},co=function(N){N>0&&N<=Jr&&(Oe.splice(N,1),Kt.splice(N,1),Jr--,j>Jr&&(j=Jr),this.setPage(j))},ps=function(N){N>0&&N<=Jr&&(j=N)},nn=_.__private__.getNumberOfPages=_.getNumberOfPages=function(){return Oe.length-1},uo=function(N,K,Te){var Ne,Be=void 0;return Te=Te||{},N=N!==void 0?N:yr[Nt].fontName,K=K!==void 0?K:yr[Nt].fontStyle,Ne=N.toLowerCase(),Qr[Ne]!==void 0&&Qr[Ne][K]!==void 0?Be=Qr[Ne][K]:Qr[N]!==void 0&&Qr[N][K]!==void 0?Be=Qr[N][K]:Te.disableWarning===!1&&Ln.warn("Unable to look up font label for font '"+N+"', '"+K+"'. Refer to getFontList() for available fonts."),Be||Te.noFallback||(Be=Qr.times[K])==null&&(Be=Qr.times.normal),Be},La=_.__private__.putInfo=function(){var N=In(),K=function(Ne){return Ne};for(var Te in d!==null&&(K=vn.encryptor(N,0)),ge("<<"),ge("/Producer ("+Gr(K("jsPDF "+ar.version))+")"),Pt)Pt.hasOwnProperty(Te)&&Pt[Te]&&ge("/"+Te.substr(0,1).toUpperCase()+Te.substr(1)+" ("+Gr(K(Pt[Te]))+")");ge("/CreationDate ("+Gr(K(ne))+")"),ge(">>"),ge("endobj")},Os=_.__private__.putCatalog=function(N){var K=(N=N||{}).rootDictionaryObjId||me;switch(In(),ge("<<"),ge("/Type /Catalog"),ge("/Pages "+K+" 0 R"),Et||(Et="fullwidth"),Et){case"fullwidth":ge("/OpenAction [3 0 R /FitH null]");break;case"fullheight":ge("/OpenAction [3 0 R /FitV null]");break;case"fullpage":ge("/OpenAction [3 0 R /Fit]");break;case"original":ge("/OpenAction [3 0 R /XYZ null null 1]");break;default:var Te=""+Et;Te.substr(Te.length-1)==="%"&&(Et=parseInt(Et)/100),typeof Et=="number"&&ge("/OpenAction [3 0 R /XYZ null null "+U(Et)+"]")}switch(Tt||(Tt="continuous"),Tt){case"continuous":ge("/PageLayout /OneColumn");break;case"single":ge("/PageLayout /SinglePage");break;case"two":case"twoleft":ge("/PageLayout /TwoColumnLeft");break;case"tworight":ge("/PageLayout /TwoColumnRight")}Dt&&ge("/PageMode /"+Dt),Dr.publish("putCatalog"),ge(">>"),ge("endobj")},mu=_.__private__.putTrailer=function(){ge("trailer"),ge("<<"),ge("/Size "+(ae+1)),ge("/Root "+ae+" 0 R"),ge("/Info "+(ae-1)+" 0 R"),d!==null&&ge("/Encrypt "+vn.oid+" 0 R"),ge("/ID [ <"+J+"> <"+J+"> ]"),ge(">>")},wc=_.__private__.putHeader=function(){ge("%PDF-"+b),ge("%")},Ec=_.__private__.putXRef=function(){var N="0000000000";ge("xref"),ge("0 "+(ae+1)),ge("0000000000 65535 f ");for(var K=1;K<=ae;K++)typeof Ae[K]=="function"?ge((N+Ae[K]()).slice(-10)+" 00000 n "):Ae[K]!==void 0?ge((N+Ae[K]).slice(-10)+" 00000 n "):ge("0000000000 00000 n ")},Ps=_.__private__.buildDocument=function(){ot(),Pe(_e),Dr.publish("buildDocument"),wc(),He(),Tl(),Li(),d!==null&&ds(),La(),Os();var N=Ee;return Ec(),mu(),ge("startxref"),ge(""+N),ge("%%EOF"),Pe(Oe[j]),_e.join(`
`)},Nl=_.__private__.getBlob=function(N){return new Blob([nt(N)],{type:"application/pdf"})},Ms=_.output=_.__private__.output=Wi(function(N,K){switch(typeof(K=K||{})=="string"?K={filename:K}:K.filename=K.filename||"generated.pdf",N){case void 0:return Ps();case"save":_.save(K.filename);break;case"arraybuffer":return nt(Ps());case"blob":return Nl(Ps());case"bloburi":case"bloburl":if(cr.URL!==void 0&&typeof cr.URL.createObjectURL=="function")return cr.URL&&cr.URL.createObjectURL(Nl(Ps()))||void 0;Ln.warn("bloburl is not supported by your system, because URL.createObjectURL is not supported by your browser.");break;case"datauristring":case"dataurlstring":var Te="",Ne=Ps();try{Te=dx(Ne)}catch{Te=dx(unescape(encodeURIComponent(Ne)))}return"data:application/pdf;filename="+K.filename+";base64,"+Te;case"pdfobjectnewwindow":if(Object.prototype.toString.call(cr)==="[object Window]"){var Be="https://cdnjs.cloudflare.com/ajax/libs/pdfobject/2.1.1/pdfobject.min.js",tt=' integrity="sha512-4ze/a9/4jqu+tX9dfOqJYSvyYd5M6qum/3HpCLr+/Jqf0whc37VUbkpNGHR7/8pSnCFw47T1fmIpwBV7UySh3g==" crossorigin="anonymous"';K.pdfObjectUrl&&(Be=K.pdfObjectUrl,tt="");var yt='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><script src="'+Be+'"'+tt+'><\/script><script >PDFObject.embed("'+this.output("dataurlstring")+'", '+JSON.stringify(K)+");<\/script></body></html>",Ft=cr.open();return Ft!==null&&Ft.document.write(yt),Ft}throw new Error("The option pdfobjectnewwindow just works in a browser-environment.");case"pdfjsnewwindow":if(Object.prototype.toString.call(cr)==="[object Window]"){var v='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe id="pdfViewer" src="'+(K.pdfJsUrl||"examples/PDF.js/web/viewer.html")+"?file=&downloadName="+K.filename+'" width="500px" height="400px" /></body></html>',P=cr.open();if(P!==null){P.document.write(v);var q=this;P.document.documentElement.querySelector("#pdfViewer").onload=function(){P.document.title=K.filename,P.document.documentElement.querySelector("#pdfViewer").contentWindow.PDFViewerApplication.open(q.output("bloburl"))}}return P}throw new Error("The option pdfjsnewwindow just works in a browser-environment.");case"dataurlnewwindow":if(Object.prototype.toString.call(cr)!=="[object Window]")throw new Error("The option dataurlnewwindow just works in a browser-environment.");var ce='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe src="'+this.output("datauristring",K)+'"></iframe></body></html>',Fe=cr.open();if(Fe!==null&&(Fe.document.write(ce),Fe.document.title=K.filename),Fe||typeof safari>"u")return Fe;break;case"datauri":case"dataurl":return cr.document.location.href=this.output("datauristring",K);default:return null}}),ms=function(N){return Array.isArray(ea)===!0&&ea.indexOf(N)>-1};switch(n){case"pt":_t=1;break;case"mm":_t=72/25.4;break;case"cm":_t=72/2.54;break;case"in":_t=72;break;case"px":_t=ms("px_scaling")==1?.75:96/72;break;case"pc":case"em":_t=12;break;case"ex":_t=6;break;default:if(typeof n!="number")throw new Error("Invalid unit: "+n);_t=n}var vn=null;xe(),oe();var Bs=function(N){return d!==null?vn.encryptor(N,0):function(K){return K}},gs=_.__private__.getPageInfo=_.getPageInfo=function(N){if(isNaN(N)||N%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfo");return{objId:Kt[N].objId,pageNumber:N,pageContext:Kt[N]}},tr=_.__private__.getPageInfoByObjId=function(N){if(isNaN(N)||N%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfoByObjId");for(var K in Kt)if(Kt[K].objId===N)break;return gs(K)},vs=_.__private__.getCurrentPageInfo=_.getCurrentPageInfo=function(){return{objId:Kt[j].objId,pageNumber:j,pageContext:Kt[j]}};_.addPage=function(){return lo.apply(this,arguments),this},_.setPage=function(){return ps.apply(this,arguments),Pe.call(this,Oe[j]),this},_.insertPage=function(N){return this.addPage(),this.movePage(j,N),this},_.movePage=function(N,K){var Te,Ne;if(N>K){Te=Oe[N],Ne=Kt[N];for(var Be=N;Be>K;Be--)Oe[Be]=Oe[Be-1],Kt[Be]=Kt[Be-1];Oe[K]=Te,Kt[K]=Ne,this.setPage(K)}else if(N<K){Te=Oe[N],Ne=Kt[N];for(var tt=N;tt<K;tt++)Oe[tt]=Oe[tt+1],Kt[tt]=Kt[tt+1];Oe[K]=Te,Kt[K]=Ne,this.setPage(K)}return this},_.deletePage=function(){return co.apply(this,arguments),this},_.__private__.text=_.text=function(N,K,Te,Ne,Be){var tt,yt,Ft,v,P,q,ce,Fe,We,wt=(Ne=Ne||{}).scope||this;if(typeof N=="number"&&typeof K=="number"&&(typeof Te=="string"||Array.isArray(Te))){var rr=Te;Te=K,K=N,N=rr}if(arguments[3]instanceof jt?(k("The transform parameter of text() with a Matrix value"),We=Be):(Ft=arguments[4],v=arguments[5],Sn(ce=arguments[3])==="object"&&ce!==null||(typeof Ft=="string"&&(v=Ft,Ft=null),typeof ce=="string"&&(v=ce,ce=null),typeof ce=="number"&&(Ft=ce,ce=null),Ne={flags:ce,angle:Ft,align:v})),isNaN(K)||isNaN(Te)||N==null)throw new Error("Invalid arguments passed to jsPDF.text");if(N.length===0)return wt;var Pr="",mr=!1,an=typeof Ne.lineHeightFactor=="number"?Ne.lineHeightFactor:Or,dn=wt.internal.scaleFactor;function ws(Cr){return Cr=Cr.split("	").join(Array(Ne.TabLen||9).join(" ")),Gr(Cr,ce)}function Kn(Cr){for(var Ir,Tn=Cr.concat(),$n=[],bs=Tn.length;bs--;)typeof(Ir=Tn.shift())=="string"?$n.push(Ir):Array.isArray(Cr)&&(Ir.length===1||Ir[1]===void 0&&Ir[2]===void 0)?$n.push(Ir[0]):$n.push([Ir[0],Ir[1],Ir[2]]);return $n}function Pa(Cr,Ir){var Tn;if(typeof Cr=="string")Tn=Ir(Cr)[0];else if(Array.isArray(Cr)){for(var $n,bs,ql=Cr.concat(),zl=[],Jo=ql.length;Jo--;)typeof($n=ql.shift())=="string"?zl.push(Ir($n)[0]):Array.isArray($n)&&typeof $n[0]=="string"&&(bs=Ir($n[0],$n[1],$n[2]),zl.push([bs[0],bs[1],bs[2]]));Tn=zl}return Tn}var xo=!1,Dl=!0;if(typeof N=="string")xo=!0;else if(Array.isArray(N)){var xu=N.concat();yt=[];for(var Tc,mi=xu.length;mi--;)(typeof(Tc=xu.shift())!="string"||Array.isArray(Tc)&&typeof Tc[0]!="string")&&(Dl=!1);xo=Dl}if(xo===!1)throw new Error('Type of text must be string or Array. "'+N+'" is not recognized.');typeof N=="string"&&(N=N.match(/[\r?\n]/)?N.split(/\r\n|\r|\n/g):[N]);var Fl=vt/wt.internal.scaleFactor,kc=Fl*(an-1);switch(Ne.baseline){case"bottom":Te-=kc;break;case"top":Te+=Fl-kc;break;case"hanging":Te+=Fl-2*kc;break;case"middle":Te+=Fl/2-kc}if((q=Ne.maxWidth||0)>0&&(typeof N=="string"?N=wt.splitTextToSize(N,q):Object.prototype.toString.call(N)==="[object Array]"&&(N=N.reduce(function(Cr,Ir){return Cr.concat(wt.splitTextToSize(Ir,q))},[]))),tt={text:N,x:K,y:Te,options:Ne,mutex:{pdfEscape:Gr,activeFontKey:Nt,fonts:yr,activeFontSize:vt}},Dr.publish("preProcessText",tt),N=tt.text,Ft=(Ne=tt.options).angle,!(We instanceof jt)&&Ft&&typeof Ft=="number"){Ft*=Math.PI/180,Ne.rotationDirection===0&&(Ft=-Ft),B===M.ADVANCED&&(Ft=-Ft);var Nc=Math.cos(Ft),yu=Math.sin(Ft);We=new jt(Nc,yu,-yu,Nc,0,0)}else Ft&&Ft instanceof jt&&(We=Ft);B!==M.ADVANCED||We||(We=Hr),(P=Ne.charSpace||Go)!==void 0&&(Pr+=F(C(P))+` Tc
`,this.setCharSpace(this.getCharSpace()||0)),(Fe=Ne.horizontalScale)!==void 0&&(Pr+=F(100*Fe)+` Tz
`),Ne.lang;var Ma=-1,dd=Ne.renderingMode!==void 0?Ne.renderingMode:Ne.stroke,Pf=wt.internal.getCurrentPageInfo().pageContext;switch(dd){case 0:case!1:case"fill":Ma=0;break;case 1:case!0:case"stroke":Ma=1;break;case 2:case"fillThenStroke":Ma=2;break;case 3:case"invisible":Ma=3;break;case 4:case"fillAndAddForClipping":Ma=4;break;case 5:case"strokeAndAddPathForClipping":Ma=5;break;case 6:case"fillThenStrokeAndAddToPathForClipping":Ma=6;break;case 7:case"addToPathForClipping":Ma=7}var qh=Pf.usedRenderingMode!==void 0?Pf.usedRenderingMode:-1;Ma!==-1?Pr+=Ma+` Tr
`:qh!==-1&&(Pr+=`0 Tr
`),Ma!==-1&&(Pf.usedRenderingMode=Ma),v=Ne.align||"left";var Es,Di=vt*an,Ol=wt.internal.pageSize.getWidth(),Mf=yr[Nt];P=Ne.charSpace||Go,q=Ne.maxWidth||0,ce=Object.assign({autoencode:!0,noBOM:!0},Ne.flags);var $o=[],Pl=function(Cr){return wt.getStringUnitWidth(Cr,{font:Mf,charSpace:P,fontSize:vt,doKerning:!1})*vt/dn};if(Object.prototype.toString.call(N)==="[object Array]"){var xa;yt=Kn(N),v!=="left"&&(Es=yt.map(Pl));var Ki,Ml=0;if(v==="right"){K-=Es[0],N=[],mi=yt.length;for(var Ba=0;Ba<mi;Ba++)Ba===0?(Ki=ia(K),xa=ii(Te)):(Ki=C(Ml-Es[Ba]),xa=-Di),N.push([yt[Ba],Ki,xa]),Ml=Es[Ba]}else if(v==="center"){K-=Es[0]/2,N=[],mi=yt.length;for(var qs=0;qs<mi;qs++)qs===0?(Ki=ia(K),xa=ii(Te)):(Ki=C((Ml-Es[qs])/2),xa=-Di),N.push([yt[qs],Ki,xa]),Ml=Es[qs]}else if(v==="left"){N=[],mi=yt.length;for(var yo=0;yo<mi;yo++)N.push(yt[yo])}else if(v==="justify"&&Mf.encoding==="Identity-H"){N=[],mi=yt.length,q=q!==0?q:Ol;for(var zs=0,Hn=0;Hn<mi;Hn++)if(xa=Hn===0?ii(Te):-Di,Ki=Hn===0?ia(K):zs,Hn<mi-1){var Hs=C((q-Es[Hn])/(yt[Hn].split(" ").length-1)),ai=yt[Hn].split(" ");N.push([ai[0]+" ",Ki,xa]),zs=0;for(var ja=1;ja<ai.length;ja++){var Cc=(Pl(ai[ja-1]+" "+ai[ja])-Pl(ai[ja]))*dn+Hs;ja==ai.length-1?N.push([ai[ja],Cc,0]):N.push([ai[ja]+" ",Cc,0]),zs-=Cc}}else N.push([yt[Hn],Ki,xa]);N.push(["",zs,0])}else{if(v!=="justify")throw new Error('Unrecognized alignment option, use "left", "center", "right" or "justify".');for(N=[],mi=yt.length,q=q!==0?q:Ol,Hn=0;Hn<mi;Hn++)xa=Hn===0?ii(Te):-Di,Ki=Hn===0?ia(K):0,Hn<mi-1?$o.push(F(C((q-Es[Hn])/(yt[Hn].split(" ").length-1)))):$o.push(0),N.push([yt[Hn],Ki,xa])}}var wo=typeof Ne.R2L=="boolean"?Ne.R2L:Mt;wo===!0&&(N=Pa(N,function(Cr,Ir,Tn){return[Cr.split("").reverse().join(""),Ir,Tn]})),tt={text:N,x:K,y:Te,options:Ne,mutex:{pdfEscape:Gr,activeFontKey:Nt,fonts:yr,activeFontSize:vt}},Dr.publish("postProcessText",tt),N=tt.text,mr=tt.mutex.isHex||!1;var wu=yr[Nt].encoding;wu!=="WinAnsiEncoding"&&wu!=="StandardEncoding"||(N=Pa(N,function(Cr,Ir,Tn){return[ws(Cr),Ir,Tn]})),yt=Kn(N),N=[];for(var Bl,jl,Ul,Ic=0,Eu=1,Vl=Array.isArray(yt[0])?Eu:Ic,Qo="",Rc=function(Cr,Ir,Tn){var $n="";return Tn instanceof jt?(Tn=typeof Ne.angle=="number"?Zr(Tn,new jt(1,0,0,1,Cr,Ir)):Zr(new jt(1,0,0,1,Cr,Ir),Tn),B===M.ADVANCED&&(Tn=Zr(new jt(1,0,0,-1,0,0),Tn)),$n=Tn.join(" ")+` Tm
`):$n=F(Cr)+" "+F(Ir)+` Td
`,$n},Gn=0;Gn<yt.length;Gn++){switch(Qo="",Vl){case Eu:Ul=(mr?"<":"(")+yt[Gn][0]+(mr?">":")"),Bl=parseFloat(yt[Gn][1]),jl=parseFloat(yt[Gn][2]);break;case Ic:Ul=(mr?"<":"(")+yt[Gn]+(mr?">":")"),Bl=ia(K),jl=ii(Te)}$o!==void 0&&$o[Gn]!==void 0&&(Qo=$o[Gn]+` Tw
`),Gn===0?N.push(Qo+Rc(Bl,jl,We)+Ul):Vl===Ic?N.push(Qo+Ul):Vl===Eu&&N.push(Qo+Rc(Bl,jl,We)+Ul)}N=Vl===Ic?N.join(` Tj
T* `):N.join(` Tj
`),N+=` Tj
`;var os=`BT
/`;return os+=Nt+" "+vt+` Tf
`,os+=F(vt*an)+` TL
`,os+=Us+`
`,os+=Pr,os+=N,ge(os+="ET"),x[Nt]=!0,wt};var gu=_.__private__.clip=_.clip=function(N){return ge(N==="evenodd"?"W*":"W"),this};_.clipEvenOdd=function(){return gu("evenodd")},_.__private__.discardPath=_.discardPath=function(){return ge("n"),this};var ra=_.__private__.isValidStyle=function(N){var K=!1;return[void 0,null,"S","D","F","DF","FD","f","f*","B","B*","n"].indexOf(N)!==-1&&(K=!0),K};_.__private__.setDefaultPathOperation=_.setDefaultPathOperation=function(N){return ra(N)&&(h=N),this};var Da=_.__private__.getStyle=_.getStyle=function(N){var K=h;switch(N){case"D":case"S":K="S";break;case"F":K="f";break;case"FD":case"DF":K="B";break;case"f":case"f*":case"B":case"B*":K=N}return K},_a=_.close=function(){return ge("h"),this};_.stroke=function(){return ge("S"),this},_.fill=function(N){return _s("f",N),this},_.fillEvenOdd=function(N){return _s("f*",N),this},_.fillStroke=function(N){return _s("B",N),this},_.fillStrokeEvenOdd=function(N){return _s("B*",N),this};var _s=function(N,K){Sn(K)==="object"?js(K,N):ge(N)},Fa=function(N){N===null||B===M.ADVANCED&&N===void 0||(N=Da(N),ge(N))};function fo(N,K,Te,Ne,Be){var tt=new R0(K||this.boundingBox,Te||this.xStep,Ne||this.yStep,this.gState,Be||this.matrix);tt.stream=this.stream;var yt=N+"$$"+this.cloneIndex+++"$$";return gn(yt,tt),tt}var js=function(N,K){var Te=Ra[N.key],Ne=Tr[Te];if(Ne instanceof lh)ge("q"),ge(bc(K)),Ne.gState&&_.setGState(Ne.gState),ge(N.matrix.toString()+" cm"),ge("/"+Te+" sh"),ge("Q");else if(Ne instanceof R0){var Be=new jt(1,0,0,-1,0,aa());N.matrix&&(Be=Be.multiply(N.matrix||Hr),Te=fo.call(Ne,N.key,N.boundingBox,N.xStep,N.yStep,Be).id),ge("q"),ge("/Pattern cs"),ge("/"+Te+" scn"),Ne.gState&&_.setGState(Ne.gState),ge(K),ge("Q")}},bc=function(N){switch(N){case"f":case"F":return"W n";case"f*":return"W* n";case"B":return"W S";case"B*":return"W* S";case"S":return"W S";case"n":return"W n"}},Oa=_.moveTo=function(N,K){return ge(F(C(N))+" "+F(se(K))+" m"),this},na=_.lineTo=function(N,K){return ge(F(C(N))+" "+F(se(K))+" l"),this},xs=_.curveTo=function(N,K,Te,Ne,Be,tt){return ge([F(C(N)),F(se(K)),F(C(Te)),F(se(Ne)),F(C(Be)),F(se(tt)),"c"].join(" ")),this};_.__private__.line=_.line=function(N,K,Te,Ne,Be){if(isNaN(N)||isNaN(K)||isNaN(Te)||isNaN(Ne)||!ra(Be))throw new Error("Invalid arguments passed to jsPDF.line");return B===M.COMPAT?this.lines([[Te-N,Ne-K]],N,K,[1,1],Be||"S"):this.lines([[Te-N,Ne-K]],N,K,[1,1]).stroke()},_.__private__.lines=_.lines=function(N,K,Te,Ne,Be,tt){var yt,Ft,v,P,q,ce,Fe,We,wt,rr,Pr,mr;if(typeof N=="number"&&(mr=Te,Te=K,K=N,N=mr),Ne=Ne||[1,1],tt=tt||!1,isNaN(K)||isNaN(Te)||!Array.isArray(N)||!Array.isArray(Ne)||!ra(Be)||typeof tt!="boolean")throw new Error("Invalid arguments passed to jsPDF.lines");for(Oa(K,Te),yt=Ne[0],Ft=Ne[1],P=N.length,rr=K,Pr=Te,v=0;v<P;v++)(q=N[v]).length===2?(rr=q[0]*yt+rr,Pr=q[1]*Ft+Pr,na(rr,Pr)):(ce=q[0]*yt+rr,Fe=q[1]*Ft+Pr,We=q[2]*yt+rr,wt=q[3]*Ft+Pr,rr=q[4]*yt+rr,Pr=q[5]*Ft+Pr,xs(ce,Fe,We,wt,rr,Pr));return tt&&_a(),Fa(Be),this},_.path=function(N){for(var K=0;K<N.length;K++){var Te=N[K],Ne=Te.c;switch(Te.op){case"m":Oa(Ne[0],Ne[1]);break;case"l":na(Ne[0],Ne[1]);break;case"c":xs.apply(this,Ne);break;case"h":_a()}}return this},_.__private__.rect=_.rect=function(N,K,Te,Ne,Be){if(isNaN(N)||isNaN(K)||isNaN(Te)||isNaN(Ne)||!ra(Be))throw new Error("Invalid arguments passed to jsPDF.rect");return B===M.COMPAT&&(Ne=-Ne),ge([F(C(N)),F(se(K)),F(C(Te)),F(C(Ne)),"re"].join(" ")),Fa(Be),this},_.__private__.triangle=_.triangle=function(N,K,Te,Ne,Be,tt,yt){if(isNaN(N)||isNaN(K)||isNaN(Te)||isNaN(Ne)||isNaN(Be)||isNaN(tt)||!ra(yt))throw new Error("Invalid arguments passed to jsPDF.triangle");return this.lines([[Te-N,Ne-K],[Be-Te,tt-Ne],[N-Be,K-tt]],N,K,[1,1],yt,!0),this},_.__private__.roundedRect=_.roundedRect=function(N,K,Te,Ne,Be,tt,yt){if(isNaN(N)||isNaN(K)||isNaN(Te)||isNaN(Ne)||isNaN(Be)||isNaN(tt)||!ra(yt))throw new Error("Invalid arguments passed to jsPDF.roundedRect");var Ft=4/3*(Math.SQRT2-1);return Be=Math.min(Be,.5*Te),tt=Math.min(tt,.5*Ne),this.lines([[Te-2*Be,0],[Be*Ft,0,Be,tt-tt*Ft,Be,tt],[0,Ne-2*tt],[0,tt*Ft,-Be*Ft,tt,-Be,tt],[2*Be-Te,0],[-Be*Ft,0,-Be,-tt*Ft,-Be,-tt],[0,2*tt-Ne],[0,-tt*Ft,Be*Ft,-tt,Be,-tt]],N+Be,K,[1,1],yt,!0),this},_.__private__.ellipse=_.ellipse=function(N,K,Te,Ne,Be){if(isNaN(N)||isNaN(K)||isNaN(Te)||isNaN(Ne)||!ra(Be))throw new Error("Invalid arguments passed to jsPDF.ellipse");var tt=4/3*(Math.SQRT2-1)*Te,yt=4/3*(Math.SQRT2-1)*Ne;return Oa(N+Te,K),xs(N+Te,K-yt,N+tt,K-Ne,N,K-Ne),xs(N-tt,K-Ne,N-Te,K-yt,N-Te,K),xs(N-Te,K+yt,N-tt,K+Ne,N,K+Ne),xs(N+tt,K+Ne,N+Te,K+yt,N+Te,K),Fa(Be),this},_.__private__.circle=_.circle=function(N,K,Te,Ne){if(isNaN(N)||isNaN(K)||isNaN(Te)||!ra(Ne))throw new Error("Invalid arguments passed to jsPDF.circle");return this.ellipse(N,K,Te,Te,Ne)},_.setFont=function(N,K,Te){return Te&&(K=he(K,Te)),Nt=uo(N,K,{disableWarning:!1}),this};var ni=_.__private__.getFont=_.getFont=function(){return yr[uo.apply(_,arguments)]};_.__private__.getFontList=_.getFontList=function(){var N,K,Te={};for(N in Qr)if(Qr.hasOwnProperty(N))for(K in Te[N]=[],Qr[N])Qr[N].hasOwnProperty(K)&&Te[N].push(K);return Te},_.addFont=function(N,K,Te,Ne,Be){var tt=["StandardEncoding","MacRomanEncoding","Identity-H","WinAnsiEncoding"];return arguments[3]&&tt.indexOf(arguments[3])!==-1?Be=arguments[3]:arguments[3]&&tt.indexOf(arguments[3])==-1&&(Te=he(Te,Ne)),Be=Be||"Identity-H",oo.call(this,N,K,Te,Be)};var Or,ho=t.lineWidth||.200025,ys=_.__private__.getLineWidth=_.getLineWidth=function(){return ho},Sc=_.__private__.setLineWidth=_.setLineWidth=function(N){return ho=N,ge(F(C(N))+" w"),this};_.__private__.setLineDash=ar.API.setLineDash=ar.API.setLineDashPattern=function(N,K){if(N=N||[],K=K||0,isNaN(K)||!Array.isArray(N))throw new Error("Invalid arguments passed to jsPDF.setLineDash");return N=N.map(function(Te){return F(C(Te))}).join(" "),K=F(C(K)),ge("["+N+"] "+K+" d"),this};var zo=_.__private__.getLineHeight=_.getLineHeight=function(){return vt*Or};_.__private__.getLineHeight=_.getLineHeight=function(){return vt*Or};var Ho=_.__private__.setLineHeightFactor=_.setLineHeightFactor=function(N){return typeof(N=N||1.15)=="number"&&(Or=N),this},ss=_.__private__.getLineHeightFactor=_.getLineHeightFactor=function(){return Or};Ho(t.lineHeight);var ia=_.__private__.getHorizontalCoordinate=function(N){return C(N)},ii=_.__private__.getVerticalCoordinate=function(N){return B===M.ADVANCED?N:Kt[j].mediaBox.topRightY-Kt[j].mediaBox.bottomLeftY-C(N)},vu=_.__private__.getHorizontalCoordinateString=_.getHorizontalCoordinateString=function(N){return F(ia(N))},po=_.__private__.getVerticalCoordinateString=_.getVerticalCoordinateString=function(N){return F(ii(N))},Yi=t.strokeColor||"0 G";_.__private__.getStrokeColor=_.getDrawColor=function(){return we(Yi)},_.__private__.setStrokeColor=_.setDrawColor=function(N,K,Te,Ne){return Yi=Se({ch1:N,ch2:K,ch3:Te,ch4:Ne,pdfColorType:"draw",precision:2}),ge(Yi),this};var mo=t.fillColor||"0 g";_.__private__.getFillColor=_.getFillColor=function(){return we(mo)},_.__private__.setFillColor=_.setFillColor=function(N,K,Te,Ne){return mo=Se({ch1:N,ch2:K,ch3:Te,ch4:Ne,pdfColorType:"fill",precision:2}),ge(mo),this};var Us=t.textColor||"0 g",Cl=_.__private__.getTextColor=_.getTextColor=function(){return we(Us)};_.__private__.setTextColor=_.setTextColor=function(N,K,Te,Ne){return Us=Se({ch1:N,ch2:K,ch3:Te,ch4:Ne,pdfColorType:"text",precision:3}),this};var Go=t.charSpace,Il=_.__private__.getCharSpace=_.getCharSpace=function(){return parseFloat(Go||0)};_.__private__.setCharSpace=_.setCharSpace=function(N){if(isNaN(N))throw new Error("Invalid argument passed to jsPDF.setCharSpace");return Go=N,this};var Ac=0;_.CapJoinStyles={0:0,butt:0,but:0,miter:0,1:1,round:1,rounded:1,circle:1,2:2,projecting:2,project:2,square:2,bevel:2},_.__private__.setLineCap=_.setLineCap=function(N){var K=_.CapJoinStyles[N];if(K===void 0)throw new Error("Line cap style of '"+N+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return Ac=K,ge(K+" J"),this};var Wo=0;_.__private__.setLineJoin=_.setLineJoin=function(N){var K=_.CapJoinStyles[N];if(K===void 0)throw new Error("Line join style of '"+N+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return Wo=K,ge(K+" j"),this},_.__private__.setLineMiterLimit=_.__private__.setMiterLimit=_.setLineMiterLimit=_.setMiterLimit=function(N){if(N=N||0,isNaN(N))throw new Error("Invalid argument passed to jsPDF.setLineMiterLimit");return ge(F(C(N))+" M"),this},_.GState=Ug,_.setGState=function(N){(N=typeof N=="string"?hn[Yn[N]]:go(null,N)).equals(di)||(ge("/"+N.id+" gs"),di=N)};var go=function(N,K){if(!N||!Yn[N]){var Te=!1;for(var Ne in hn)if(hn.hasOwnProperty(Ne)&&hn[Ne].equals(K)){Te=!0;break}if(Te)K=hn[Ne];else{var Be="GS"+(Object.keys(hn).length+1).toString(10);hn[Be]=K,K.id=Be}return N&&(Yn[N]=K.id),Dr.publish("addGState",K),K}};_.addGState=function(N,K){return go(N,K),this},_.saveGraphicsState=function(){return ge("q"),Ii.push({key:Nt,size:vt,color:Us}),this},_.restoreGraphicsState=function(){ge("Q");var N=Ii.pop();return Nt=N.key,vt=N.size,Us=N.color,di=null,this},_.setCurrentTransformationMatrix=function(N){return ge(N.toString()+" cm"),this},_.comment=function(N){return ge("#"+N),this};var Xo=function(N,K){var Te=N||0;Object.defineProperty(this,"x",{enumerable:!0,get:function(){return Te},set:function(tt){isNaN(tt)||(Te=parseFloat(tt))}});var Ne=K||0;Object.defineProperty(this,"y",{enumerable:!0,get:function(){return Ne},set:function(tt){isNaN(tt)||(Ne=parseFloat(tt))}});var Be="pt";return Object.defineProperty(this,"type",{enumerable:!0,get:function(){return Be},set:function(tt){Be=tt.toString()}}),this},Rl=function(N,K,Te,Ne){Xo.call(this,N,K),this.type="rect";var Be=Te||0;Object.defineProperty(this,"w",{enumerable:!0,get:function(){return Be},set:function(yt){isNaN(yt)||(Be=parseFloat(yt))}});var tt=Ne||0;return Object.defineProperty(this,"h",{enumerable:!0,get:function(){return tt},set:function(yt){isNaN(yt)||(tt=parseFloat(yt))}}),this},Yo=function(){this.page=Jr,this.currentPage=j,this.pages=Oe.slice(0),this.pagesContext=Kt.slice(0),this.x=or,this.y=Gt,this.matrix=zr,this.width=_o(j),this.height=aa(j),this.outputDestination=rt,this.id="",this.objectNumber=-1};Yo.prototype.restore=function(){Jr=this.page,j=this.currentPage,Kt=this.pagesContext,Oe=this.pages,or=this.x,Gt=this.y,zr=this.matrix,Ko(j,this.width),Ll(j,this.height),rt=this.outputDestination};var vo=function(N,K,Te,Ne,Be){ga.push(new Yo),Jr=j=0,Oe=[],or=N,Gt=K,zr=Be,Xi([Te,Ne])},_u=function(N){if(pi[N])ga.pop().restore();else{var K=new Yo,Te="Xo"+(Object.keys(Dn).length+1).toString(10);K.id=Te,pi[N]=Te,Dn[Te]=K,Dr.publish("addFormObject",K),ga.pop().restore()}};for(var Vs in _.beginFormObject=function(N,K,Te,Ne,Be){return vo(N,K,Te,Ne,Be),this},_.endFormObject=function(N){return _u(N),this},_.doFormObject=function(N,K){var Te=Dn[pi[N]];return ge("q"),ge(K.toString()+" cm"),ge("/"+Te.id+" Do"),ge("Q"),this},_.getFormObject=function(N){var K=Dn[pi[N]];return{x:K.x,y:K.y,width:K.width,height:K.height,matrix:K.matrix}},_.save=function(N,K){return N=N||"generated.pdf",(K=K||{}).returnPromise=K.returnPromise||!1,K.returnPromise===!1?(sh(Nl(Ps()),N),typeof sh.unload=="function"&&cr.setTimeout&&setTimeout(sh.unload,911),this):new Promise(function(Te,Ne){try{var Be=sh(Nl(Ps()),N);typeof sh.unload=="function"&&cr.setTimeout&&setTimeout(sh.unload,911),Te(Be)}catch(tt){Ne(tt.message)}})},ar.API)ar.API.hasOwnProperty(Vs)&&(Vs==="events"&&ar.API.events.length?function(N,K){var Te,Ne,Be;for(Be=K.length-1;Be!==-1;Be--)Te=K[Be][0],Ne=K[Be][1],N.subscribe.apply(N,[Te].concat(typeof Ne=="function"?[Ne]:Ne))}(Dr,ar.API.events):_[Vs]=ar.API[Vs]);var _o=_.getPageWidth=function(N){return(Kt[N=N||j].mediaBox.topRightX-Kt[N].mediaBox.bottomLeftX)/_t},Ko=_.setPageWidth=function(N,K){Kt[N].mediaBox.topRightX=K*_t+Kt[N].mediaBox.bottomLeftX},aa=_.getPageHeight=function(N){return(Kt[N=N||j].mediaBox.topRightY-Kt[N].mediaBox.bottomLeftY)/_t},Ll=_.setPageHeight=function(N,K){Kt[N].mediaBox.topRightY=K*_t+Kt[N].mediaBox.bottomLeftY};return _.internal={pdfEscape:Gr,getStyle:Da,getFont:ni,getFontSize:bt,getCharSpace:Il,getTextColor:Cl,getLineHeight:zo,getLineHeightFactor:ss,getLineWidth:ys,write:Je,getHorizontalCoordinate:ia,getVerticalCoordinate:ii,getCoordinateString:vu,getVerticalCoordinateString:po,collections:{},newObject:In,newAdditionalObject:be,newObjectDeferred:Fn,newObjectDeferredBegin:te,getFilters:Ve,putStream:$e,events:Dr,scaleFactor:_t,pageSize:{getWidth:function(){return _o(j)},setWidth:function(N){Ko(j,N)},getHeight:function(){return aa(j)},setHeight:function(N){Ll(j,N)}},encryptionOptions:d,encryption:vn,getEncryptor:Bs,output:Ms,getNumberOfPages:nn,pages:Oe,out:ge,f2:U,f3:I,getPageInfo:gs,getPageInfoByObjId:tr,getCurrentPageInfo:vs,getPDFVersion:E,Point:Xo,Rectangle:Rl,Matrix:jt,hasHotfix:ms},Object.defineProperty(_.internal.pageSize,"width",{get:function(){return _o(j)},set:function(N){Ko(j,N)},enumerable:!0,configurable:!0}),Object.defineProperty(_.internal.pageSize,"height",{get:function(){return aa(j)},set:function(N){Ll(j,N)},enumerable:!0,configurable:!0}),yc.call(_,et),Nt="F1",lo(i,r),Dr.publish("initialized"),_}k0.prototype.lsbFirstWord=function(t){return String.fromCharCode(t>>0&255,t>>8&255,t>>16&255,t>>24&255)},k0.prototype.toHexString=function(t){return t.split("").map(function(e){return("0"+(255&e.charCodeAt(0)).toString(16)).slice(-2)}).join("")},k0.prototype.hexToBytes=function(t){for(var e=[],r=0;r<t.length;r+=2)e.push(String.fromCharCode(parseInt(t.substr(r,2),16)));return e.join("")},k0.prototype.processOwnerPassword=function(t,e){return mx(px(e).substr(0,5),t)},k0.prototype.encryptor=function(t,e){var r=px(this.encryptionKey+String.fromCharCode(255&t,t>>8&255,t>>16&255,255&e,e>>8&255)).substr(0,10);return function(n){return mx(r,n)}},Ug.prototype.equals=function(t){var e,r="id,objectNumber,equals";if(!t||Sn(t)!==Sn(this))return!1;var n=0;for(e in this)if(!(r.indexOf(e)>=0)){if(this.hasOwnProperty(e)&&!t.hasOwnProperty(e)||this[e]!==t[e])return!1;n++}for(e in t)t.hasOwnProperty(e)&&r.indexOf(e)<0&&n--;return n===0},ar.API={events:[]},ar.version="3.0.1";var ci=ar.API,c5=1,Vh=function(t){return t.replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},y0=function(t){return t.replace(/\\\\/g,"\\").replace(/\\\(/g,"(").replace(/\\\)/g,")")},_r=function(t){return t.toFixed(2)},Qu=function(t){return t.toFixed(5)};ci.__acroform__={};var Fs=function(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t},xb=function(t){return t*c5},ac=function(t){var e=new Hk,r=Xt.internal.getHeight(t)||0,n=Xt.internal.getWidth(t)||0;return e.BBox=[0,0,Number(_r(n)),Number(_r(r))],e},iX=ci.__acroform__.setBit=function(t,e){if(t=t||0,e=e||0,isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBit");return t|=1<<e},aX=ci.__acroform__.clearBit=function(t,e){if(t=t||0,e=e||0,isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBit");return t&=~(1<<e)},sX=ci.__acroform__.getBit=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBit");return(t&1<<e)==0?0:1},bi=ci.__acroform__.getBitForPdf=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBitForPdf");return sX(t,e-1)},Si=ci.__acroform__.setBitForPdf=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBitForPdf");return iX(t,e-1)},Ai=ci.__acroform__.clearBitForPdf=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBitForPdf");return aX(t,e-1)},oX=ci.__acroform__.calculateCoordinates=function(t,e){var r=e.internal.getHorizontalCoordinate,n=e.internal.getVerticalCoordinate,i=t[0],a=t[1],o=t[2],c=t[3],u={};return u.lowerLeft_X=r(i)||0,u.lowerLeft_Y=n(a+c)||0,u.upperRight_X=r(i+o)||0,u.upperRight_Y=n(a)||0,[Number(_r(u.lowerLeft_X)),Number(_r(u.lowerLeft_Y)),Number(_r(u.upperRight_X)),Number(_r(u.upperRight_Y))]},lX=function(t){if(t.appearanceStreamContent)return t.appearanceStreamContent;if(t.V||t.DV){var e=[],r=t._V||t.DV,n=gx(t,r),i=t.scope.internal.getFont(t.fontName,t.fontStyle).id;e.push("/Tx BMC"),e.push("q"),e.push("BT"),e.push(t.scope.__private__.encodeColorString(t.color)),e.push("/"+i+" "+_r(n.fontSize)+" Tf"),e.push("1 0 0 1 0 0 Tm"),e.push(n.text),e.push("ET"),e.push("Q"),e.push("EMC");var a=ac(t);return a.scope=t.scope,a.stream=e.join(`
`),a}},gx=function(t,e){var r=t.fontSize===0?t.maxFontSize:t.fontSize,n={text:"",fontSize:""},i=(e=(e=e.substr(0,1)=="("?e.substr(1):e).substr(e.length-1)==")"?e.substr(0,e.length-1):e).split(" ");i=t.multiline?i.map(function(I){return I.split(`
`)}):i.map(function(I){return[I]});var a=r,o=Xt.internal.getHeight(t)||0;o=o<0?-o:o;var c=Xt.internal.getWidth(t)||0;c=c<0?-c:c;var u=function(I,C,R){if(I+1<i.length){var se=C+" "+i[I+1][0];return Pm(se,t,R).width<=c-4}return!1};a++;e:for(;a>0;){e="",a--;var h,d,g=Pm("3",t,a).height,x=t.multiline?o-a:(o-g)/2,_=x+=2,b=0,E=0,A=0;if(a<=0){e=`(...) Tj
`,e+="% Width of Text: "+Pm(e,t,a=12).width+", FieldWidth:"+c+`
`;break}for(var O="",M=0,B=0;B<i.length;B++)if(i.hasOwnProperty(B)){var Q=!1;if(i[B].length!==1&&A!==i[B].length-1){if((g+2)*(M+2)+2>o)continue e;O+=i[B][A],Q=!0,E=B,B--}else{O=(O+=i[B][A]+" ").substr(O.length-1)==" "?O.substr(0,O.length-1):O;var ee=parseInt(B),he=u(ee,O,a),F=B>=i.length-1;if(he&&!F){O+=" ",A=0;continue}if(he||F){if(F)E=ee;else if(t.multiline&&(g+2)*(M+2)+2>o)continue e}else{if(!t.multiline||(g+2)*(M+2)+2>o)continue e;E=ee}}for(var k="",S=b;S<=E;S++){var U=i[S];if(t.multiline){if(S===E){k+=U[A]+" ",A=(A+1)%U.length;continue}if(S===b){k+=U[U.length-1]+" ";continue}}k+=U[0]+" "}switch(k=k.substr(k.length-1)==" "?k.substr(0,k.length-1):k,d=Pm(k,t,a).width,t.textAlign){case"right":h=c-d-2;break;case"center":h=(c-d)/2;break;case"left":default:h=2}e+=_r(h)+" "+_r(_)+` Td
`,e+="("+Vh(k)+`) Tj
`,e+=-_r(h)+` 0 Td
`,_=-(a+2),d=0,b=Q?E:E+1,M++,O=""}break}return n.text=e,n.fontSize=a,n},Pm=function(t,e,r){var n=e.scope.internal.getFont(e.fontName,e.fontStyle),i=e.scope.getStringUnitWidth(t,{font:n,fontSize:parseFloat(r),charSpace:0})*parseFloat(r);return{height:e.scope.getStringUnitWidth("3",{font:n,fontSize:parseFloat(r),charSpace:0})*parseFloat(r)*1.5,width:i}},cX={fields:[],xForms:[],acroFormDictionaryRoot:null,printedOut:!1,internal:null,isInitialized:!1},uX=function(t,e){var r={type:"reference",object:t};e.internal.getPageInfo(t.page).pageContext.annotations.find(function(n){return n.type===r.type&&n.object===r.object})===void 0&&e.internal.getPageInfo(t.page).pageContext.annotations.push(r)},fX=function(t,e){for(var r in t)if(t.hasOwnProperty(r)){var n=r,i=t[r];e.internal.newObjectDeferredBegin(i.objId,!0),Sn(i)==="object"&&typeof i.putStream=="function"&&i.putStream(),delete t[n]}},hX=function(t,e){if(e.scope=t,t.internal!==void 0&&(t.internal.acroformPlugin===void 0||t.internal.acroformPlugin.isInitialized===!1)){if(Sl.FieldNum=0,t.internal.acroformPlugin=JSON.parse(JSON.stringify(cX)),t.internal.acroformPlugin.acroFormDictionaryRoot)throw new Error("Exception while creating AcroformDictionary");c5=t.internal.scaleFactor,t.internal.acroformPlugin.acroFormDictionaryRoot=new Gk,t.internal.acroformPlugin.acroFormDictionaryRoot.scope=t,t.internal.acroformPlugin.acroFormDictionaryRoot._eventID=t.internal.events.subscribe("postPutResources",function(){(function(r){r.internal.events.unsubscribe(r.internal.acroformPlugin.acroFormDictionaryRoot._eventID),delete r.internal.acroformPlugin.acroFormDictionaryRoot._eventID,r.internal.acroformPlugin.printedOut=!0})(t)}),t.internal.events.subscribe("buildDocument",function(){(function(r){r.internal.acroformPlugin.acroFormDictionaryRoot.objId=void 0;var n=r.internal.acroformPlugin.acroFormDictionaryRoot.Fields;for(var i in n)if(n.hasOwnProperty(i)){var a=n[i];a.objId=void 0,a.hasAnnotation&&uX(a,r)}})(t)}),t.internal.events.subscribe("putCatalog",function(){(function(r){if(r.internal.acroformPlugin.acroFormDictionaryRoot===void 0)throw new Error("putCatalogCallback: Root missing.");r.internal.write("/AcroForm "+r.internal.acroformPlugin.acroFormDictionaryRoot.objId+" 0 R")})(t)}),t.internal.events.subscribe("postPutPages",function(r){(function(n,i){var a=!n;for(var o in n||(i.internal.newObjectDeferredBegin(i.internal.acroformPlugin.acroFormDictionaryRoot.objId,!0),i.internal.acroformPlugin.acroFormDictionaryRoot.putStream()),n=n||i.internal.acroformPlugin.acroFormDictionaryRoot.Kids)if(n.hasOwnProperty(o)){var c=n[o],u=[],h=c.Rect;if(c.Rect&&(c.Rect=oX(c.Rect,i)),i.internal.newObjectDeferredBegin(c.objId,!0),c.DA=Xt.createDefaultAppearanceStream(c),Sn(c)==="object"&&typeof c.getKeyValueListForStream=="function"&&(u=c.getKeyValueListForStream()),c.Rect=h,c.hasAppearanceStream&&!c.appearanceStreamContent){var d=lX(c);u.push({key:"AP",value:"<</N "+d+">>"}),i.internal.acroformPlugin.xForms.push(d)}if(c.appearanceStreamContent){var g="";for(var x in c.appearanceStreamContent)if(c.appearanceStreamContent.hasOwnProperty(x)){var _=c.appearanceStreamContent[x];if(g+="/"+x+" ",g+="<<",Object.keys(_).length>=1||Array.isArray(_)){for(var o in _)if(_.hasOwnProperty(o)){var b=_[o];typeof b=="function"&&(b=b.call(i,c)),g+="/"+o+" "+b+" ",i.internal.acroformPlugin.xForms.indexOf(b)>=0||i.internal.acroformPlugin.xForms.push(b)}}else typeof(b=_)=="function"&&(b=b.call(i,c)),g+="/"+o+" "+b,i.internal.acroformPlugin.xForms.indexOf(b)>=0||i.internal.acroformPlugin.xForms.push(b);g+=">>"}u.push({key:"AP",value:`<<
`+g+">>"})}i.internal.putStream({additionalKeyValues:u,objectId:c.objId}),i.internal.out("endobj")}a&&fX(i.internal.acroformPlugin.xForms,i)})(r,t)}),t.internal.acroformPlugin.isInitialized=!0}},zk=ci.__acroform__.arrayToPdfArray=function(t,e,r){var n=function(o){return o};if(Array.isArray(t)){for(var i="[",a=0;a<t.length;a++)switch(a!==0&&(i+=" "),Sn(t[a])){case"boolean":case"number":case"object":i+=t[a].toString();break;case"string":t[a].substr(0,1)!=="/"?(e!==void 0&&r&&(n=r.internal.getEncryptor(e)),i+="("+Vh(n(t[a].toString()))+")"):i+=t[a].toString()}return i+="]"}throw new Error("Invalid argument passed to jsPDF.__acroform__.arrayToPdfArray")},p_=function(t,e,r){var n=function(i){return i};return e!==void 0&&r&&(n=r.internal.getEncryptor(e)),(t=t||"").toString(),t="("+Vh(n(t))+")"},lc=function(){this._objId=void 0,this._scope=void 0,Object.defineProperty(this,"objId",{get:function(){if(this._objId===void 0){if(this.scope===void 0)return;this._objId=this.scope.internal.newObjectDeferred()}return this._objId},set:function(t){this._objId=t}}),Object.defineProperty(this,"scope",{value:this._scope,writable:!0})};lc.prototype.toString=function(){return this.objId+" 0 R"},lc.prototype.putStream=function(){var t=this.getKeyValueListForStream();this.scope.internal.putStream({data:this.stream,additionalKeyValues:t,objectId:this.objId}),this.scope.internal.out("endobj")},lc.prototype.getKeyValueListForStream=function(){var t=[],e=Object.getOwnPropertyNames(this).filter(function(a){return a!="content"&&a!="appearanceStreamContent"&&a!="scope"&&a!="objId"&&a.substring(0,1)!="_"});for(var r in e)if(Object.getOwnPropertyDescriptor(this,e[r]).configurable===!1){var n=e[r],i=this[n];i&&(Array.isArray(i)?t.push({key:n,value:zk(i,this.objId,this.scope)}):i instanceof lc?(i.scope=this.scope,t.push({key:n,value:i.objId+" 0 R"})):typeof i!="function"&&t.push({key:n,value:i}))}return t};var Hk=function(){lc.call(this),Object.defineProperty(this,"Type",{value:"/XObject",configurable:!1,writable:!0}),Object.defineProperty(this,"Subtype",{value:"/Form",configurable:!1,writable:!0}),Object.defineProperty(this,"FormType",{value:1,configurable:!1,writable:!0});var t,e=[];Object.defineProperty(this,"BBox",{configurable:!1,get:function(){return e},set:function(r){e=r}}),Object.defineProperty(this,"Resources",{value:"2 0 R",configurable:!1,writable:!0}),Object.defineProperty(this,"stream",{enumerable:!1,configurable:!0,set:function(r){t=r.trim()},get:function(){return t||null}})};Fs(Hk,lc);var Gk=function(){lc.call(this);var t,e=[];Object.defineProperty(this,"Kids",{enumerable:!1,configurable:!0,get:function(){return e.length>0?e:void 0}}),Object.defineProperty(this,"Fields",{enumerable:!1,configurable:!1,get:function(){return e}}),Object.defineProperty(this,"DA",{enumerable:!1,configurable:!1,get:function(){if(t){var r=function(n){return n};return this.scope&&(r=this.scope.internal.getEncryptor(this.objId)),"("+Vh(r(t))+")"}},set:function(r){t=r}})};Fs(Gk,lc);var Sl=function t(){lc.call(this);var e=4;Object.defineProperty(this,"F",{enumerable:!1,configurable:!1,get:function(){return e},set:function(O){if(isNaN(O))throw new Error('Invalid value "'+O+'" for attribute F supplied.');e=O}}),Object.defineProperty(this,"showWhenPrinted",{enumerable:!0,configurable:!0,get:function(){return!!bi(e,3)},set:function(O){O?this.F=Si(e,3):this.F=Ai(e,3)}});var r=0;Object.defineProperty(this,"Ff",{enumerable:!1,configurable:!1,get:function(){return r},set:function(O){if(isNaN(O))throw new Error('Invalid value "'+O+'" for attribute Ff supplied.');r=O}});var n=[];Object.defineProperty(this,"Rect",{enumerable:!1,configurable:!1,get:function(){if(n.length!==0)return n},set:function(O){n=O!==void 0?O:[]}}),Object.defineProperty(this,"x",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[0])?0:n[0]},set:function(O){n[0]=O}}),Object.defineProperty(this,"y",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[1])?0:n[1]},set:function(O){n[1]=O}}),Object.defineProperty(this,"width",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[2])?0:n[2]},set:function(O){n[2]=O}}),Object.defineProperty(this,"height",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[3])?0:n[3]},set:function(O){n[3]=O}});var i="";Object.defineProperty(this,"FT",{enumerable:!0,configurable:!1,get:function(){return i},set:function(O){switch(O){case"/Btn":case"/Tx":case"/Ch":case"/Sig":i=O;break;default:throw new Error('Invalid value "'+O+'" for attribute FT supplied.')}}});var a=null;Object.defineProperty(this,"T",{enumerable:!0,configurable:!1,get:function(){if(!a||a.length<1){if(this instanceof Vg)return;a="FieldObject"+t.FieldNum++}var O=function(M){return M};return this.scope&&(O=this.scope.internal.getEncryptor(this.objId)),"("+Vh(O(a))+")"},set:function(O){a=O.toString()}}),Object.defineProperty(this,"fieldName",{configurable:!0,enumerable:!0,get:function(){return a},set:function(O){a=O}});var o="helvetica";Object.defineProperty(this,"fontName",{enumerable:!0,configurable:!0,get:function(){return o},set:function(O){o=O}});var c="normal";Object.defineProperty(this,"fontStyle",{enumerable:!0,configurable:!0,get:function(){return c},set:function(O){c=O}});var u=0;Object.defineProperty(this,"fontSize",{enumerable:!0,configurable:!0,get:function(){return u},set:function(O){u=O}});var h=void 0;Object.defineProperty(this,"maxFontSize",{enumerable:!0,configurable:!0,get:function(){return h===void 0?50/c5:h},set:function(O){h=O}});var d="black";Object.defineProperty(this,"color",{enumerable:!0,configurable:!0,get:function(){return d},set:function(O){d=O}});var g="/F1 0 Tf 0 g";Object.defineProperty(this,"DA",{enumerable:!0,configurable:!1,get:function(){if(!(!g||this instanceof Vg||this instanceof vh))return p_(g,this.objId,this.scope)},set:function(O){O=O.toString(),g=O}});var x=null;Object.defineProperty(this,"DV",{enumerable:!1,configurable:!1,get:function(){if(x)return this instanceof ha?x:p_(x,this.objId,this.scope)},set:function(O){O=O.toString(),x=this instanceof ha?O:O.substr(0,1)==="("?y0(O.substr(1,O.length-2)):y0(O)}}),Object.defineProperty(this,"defaultValue",{enumerable:!0,configurable:!0,get:function(){return this instanceof ha?y0(x.substr(1,x.length-1)):x},set:function(O){O=O.toString(),x=this instanceof ha?"/"+O:O}});var _=null;Object.defineProperty(this,"_V",{enumerable:!1,configurable:!1,get:function(){if(_)return _},set:function(O){this.V=O}}),Object.defineProperty(this,"V",{enumerable:!1,configurable:!1,get:function(){if(_)return this instanceof ha?_:p_(_,this.objId,this.scope)},set:function(O){O=O.toString(),_=this instanceof ha?O:O.substr(0,1)==="("?y0(O.substr(1,O.length-2)):y0(O)}}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,get:function(){return this instanceof ha?y0(_.substr(1,_.length-1)):_},set:function(O){O=O.toString(),_=this instanceof ha?"/"+O:O}}),Object.defineProperty(this,"hasAnnotation",{enumerable:!0,configurable:!0,get:function(){return this.Rect}}),Object.defineProperty(this,"Type",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Annot":null}}),Object.defineProperty(this,"Subtype",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Widget":null}});var b,E=!1;Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return E},set:function(O){O=!!O,E=O}}),Object.defineProperty(this,"page",{enumerable:!0,configurable:!0,get:function(){if(b)return b},set:function(O){b=O}}),Object.defineProperty(this,"readOnly",{enumerable:!0,configurable:!0,get:function(){return!!bi(this.Ff,1)},set:function(O){O?this.Ff=Si(this.Ff,1):this.Ff=Ai(this.Ff,1)}}),Object.defineProperty(this,"required",{enumerable:!0,configurable:!0,get:function(){return!!bi(this.Ff,2)},set:function(O){O?this.Ff=Si(this.Ff,2):this.Ff=Ai(this.Ff,2)}}),Object.defineProperty(this,"noExport",{enumerable:!0,configurable:!0,get:function(){return!!bi(this.Ff,3)},set:function(O){O?this.Ff=Si(this.Ff,3):this.Ff=Ai(this.Ff,3)}});var A=null;Object.defineProperty(this,"Q",{enumerable:!0,configurable:!1,get:function(){if(A!==null)return A},set:function(O){if([0,1,2].indexOf(O)===-1)throw new Error('Invalid value "'+O+'" for attribute Q supplied.');A=O}}),Object.defineProperty(this,"textAlign",{get:function(){var O;switch(A){case 0:default:O="left";break;case 1:O="center";break;case 2:O="right"}return O},configurable:!0,enumerable:!0,set:function(O){switch(O){case"right":case 2:A=2;break;case"center":case 1:A=1;break;case"left":case 0:default:A=0}}})};Fs(Sl,lc);var V0=function(){Sl.call(this),this.FT="/Ch",this.V="()",this.fontName="zapfdingbats";var t=0;Object.defineProperty(this,"TI",{enumerable:!0,configurable:!1,get:function(){return t},set:function(r){t=r}}),Object.defineProperty(this,"topIndex",{enumerable:!0,configurable:!0,get:function(){return t},set:function(r){t=r}});var e=[];Object.defineProperty(this,"Opt",{enumerable:!0,configurable:!1,get:function(){return zk(e,this.objId,this.scope)},set:function(r){var n,i;i=[],typeof(n=r)=="string"&&(i=function(a,o,c){c||(c=1);for(var u,h=[];u=o.exec(a);)h.push(u[c]);return h}(n,/\((.*?)\)/g)),e=i}}),this.getOptions=function(){return e},this.setOptions=function(r){e=r,this.sort&&e.sort()},this.addOption=function(r){r=(r=r||"").toString(),e.push(r),this.sort&&e.sort()},this.removeOption=function(r,n){for(n=n||!1,r=(r=r||"").toString();e.indexOf(r)!==-1&&(e.splice(e.indexOf(r),1),n!==!1););},Object.defineProperty(this,"combo",{enumerable:!0,configurable:!0,get:function(){return!!bi(this.Ff,18)},set:function(r){r?this.Ff=Si(this.Ff,18):this.Ff=Ai(this.Ff,18)}}),Object.defineProperty(this,"edit",{enumerable:!0,configurable:!0,get:function(){return!!bi(this.Ff,19)},set:function(r){this.combo===!0&&(r?this.Ff=Si(this.Ff,19):this.Ff=Ai(this.Ff,19))}}),Object.defineProperty(this,"sort",{enumerable:!0,configurable:!0,get:function(){return!!bi(this.Ff,20)},set:function(r){r?(this.Ff=Si(this.Ff,20),e.sort()):this.Ff=Ai(this.Ff,20)}}),Object.defineProperty(this,"multiSelect",{enumerable:!0,configurable:!0,get:function(){return!!bi(this.Ff,22)},set:function(r){r?this.Ff=Si(this.Ff,22):this.Ff=Ai(this.Ff,22)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!bi(this.Ff,23)},set:function(r){r?this.Ff=Si(this.Ff,23):this.Ff=Ai(this.Ff,23)}}),Object.defineProperty(this,"commitOnSelChange",{enumerable:!0,configurable:!0,get:function(){return!!bi(this.Ff,27)},set:function(r){r?this.Ff=Si(this.Ff,27):this.Ff=Ai(this.Ff,27)}}),this.hasAppearanceStream=!1};Fs(V0,Sl);var q0=function(){V0.call(this),this.fontName="helvetica",this.combo=!1};Fs(q0,V0);var z0=function(){q0.call(this),this.combo=!0};Fs(z0,q0);var Zm=function(){z0.call(this),this.edit=!0};Fs(Zm,z0);var ha=function(){Sl.call(this),this.FT="/Btn",Object.defineProperty(this,"noToggleToOff",{enumerable:!0,configurable:!0,get:function(){return!!bi(this.Ff,15)},set:function(r){r?this.Ff=Si(this.Ff,15):this.Ff=Ai(this.Ff,15)}}),Object.defineProperty(this,"radio",{enumerable:!0,configurable:!0,get:function(){return!!bi(this.Ff,16)},set:function(r){r?this.Ff=Si(this.Ff,16):this.Ff=Ai(this.Ff,16)}}),Object.defineProperty(this,"pushButton",{enumerable:!0,configurable:!0,get:function(){return!!bi(this.Ff,17)},set:function(r){r?this.Ff=Si(this.Ff,17):this.Ff=Ai(this.Ff,17)}}),Object.defineProperty(this,"radioIsUnison",{enumerable:!0,configurable:!0,get:function(){return!!bi(this.Ff,26)},set:function(r){r?this.Ff=Si(this.Ff,26):this.Ff=Ai(this.Ff,26)}});var t,e={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var r=function(a){return a};if(this.scope&&(r=this.scope.internal.getEncryptor(this.objId)),Object.keys(e).length!==0){var n,i=[];for(n in i.push("<<"),e)i.push("/"+n+" ("+Vh(r(e[n]))+")");return i.push(">>"),i.join(`
`)}},set:function(r){Sn(r)==="object"&&(e=r)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return e.CA||""},set:function(r){typeof r=="string"&&(e.CA=r)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return t},set:function(r){t=r}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return t.substr(1,t.length-1)},set:function(r){t="/"+r}})};Fs(ha,Sl);var eg=function(){ha.call(this),this.pushButton=!0};Fs(eg,ha);var H0=function(){ha.call(this),this.radio=!0,this.pushButton=!1;var t=[];Object.defineProperty(this,"Kids",{enumerable:!0,configurable:!1,get:function(){return t},set:function(e){t=e!==void 0?e:[]}})};Fs(H0,ha);var Vg=function(){var t,e;Sl.call(this),Object.defineProperty(this,"Parent",{enumerable:!1,configurable:!1,get:function(){return t},set:function(i){t=i}}),Object.defineProperty(this,"optionName",{enumerable:!1,configurable:!0,get:function(){return e},set:function(i){e=i}});var r,n={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var i=function(c){return c};this.scope&&(i=this.scope.internal.getEncryptor(this.objId));var a,o=[];for(a in o.push("<<"),n)o.push("/"+a+" ("+Vh(i(n[a]))+")");return o.push(">>"),o.join(`
`)},set:function(i){Sn(i)==="object"&&(n=i)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return n.CA||""},set:function(i){typeof i=="string"&&(n.CA=i)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return r},set:function(i){r=i}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return r.substr(1,r.length-1)},set:function(i){r="/"+i}}),this.caption="l",this.appearanceState="Off",this._AppearanceType=Xt.RadioButton.Circle,this.appearanceStreamContent=this._AppearanceType.createAppearanceStream(this.optionName)};Fs(Vg,Sl),H0.prototype.setAppearance=function(t){if(!("createAppearanceStream"in t)||!("getCA"in t))throw new Error("Couldn't assign Appearance to RadioButton. Appearance was Invalid!");for(var e in this.Kids)if(this.Kids.hasOwnProperty(e)){var r=this.Kids[e];r.appearanceStreamContent=t.createAppearanceStream(r.optionName),r.caption=t.getCA()}},H0.prototype.createOption=function(t){var e=new Vg;return e.Parent=this,e.optionName=t,this.Kids.push(e),dX.call(this.scope,e),e};var tg=function(){ha.call(this),this.fontName="zapfdingbats",this.caption="3",this.appearanceState="On",this.value="On",this.textAlign="center",this.appearanceStreamContent=Xt.CheckBox.createAppearanceStream()};Fs(tg,ha);var vh=function(){Sl.call(this),this.FT="/Tx",Object.defineProperty(this,"multiline",{enumerable:!0,configurable:!0,get:function(){return!!bi(this.Ff,13)},set:function(e){e?this.Ff=Si(this.Ff,13):this.Ff=Ai(this.Ff,13)}}),Object.defineProperty(this,"fileSelect",{enumerable:!0,configurable:!0,get:function(){return!!bi(this.Ff,21)},set:function(e){e?this.Ff=Si(this.Ff,21):this.Ff=Ai(this.Ff,21)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!bi(this.Ff,23)},set:function(e){e?this.Ff=Si(this.Ff,23):this.Ff=Ai(this.Ff,23)}}),Object.defineProperty(this,"doNotScroll",{enumerable:!0,configurable:!0,get:function(){return!!bi(this.Ff,24)},set:function(e){e?this.Ff=Si(this.Ff,24):this.Ff=Ai(this.Ff,24)}}),Object.defineProperty(this,"comb",{enumerable:!0,configurable:!0,get:function(){return!!bi(this.Ff,25)},set:function(e){e?this.Ff=Si(this.Ff,25):this.Ff=Ai(this.Ff,25)}}),Object.defineProperty(this,"richText",{enumerable:!0,configurable:!0,get:function(){return!!bi(this.Ff,26)},set:function(e){e?this.Ff=Si(this.Ff,26):this.Ff=Ai(this.Ff,26)}});var t=null;Object.defineProperty(this,"MaxLen",{enumerable:!0,configurable:!1,get:function(){return t},set:function(e){t=e}}),Object.defineProperty(this,"maxLength",{enumerable:!0,configurable:!0,get:function(){return t},set:function(e){Number.isInteger(e)&&(t=e)}}),Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return this.V||this.DV}})};Fs(vh,Sl);var rg=function(){vh.call(this),Object.defineProperty(this,"password",{enumerable:!0,configurable:!0,get:function(){return!!bi(this.Ff,14)},set:function(t){t?this.Ff=Si(this.Ff,14):this.Ff=Ai(this.Ff,14)}}),this.password=!0};Fs(rg,vh);var Xt={CheckBox:{createAppearanceStream:function(){return{N:{On:Xt.CheckBox.YesNormal},D:{On:Xt.CheckBox.YesPushDown,Off:Xt.CheckBox.OffPushDown}}},YesPushDown:function(t){var e=ac(t);e.scope=t.scope;var r=[],n=t.scope.internal.getFont(t.fontName,t.fontStyle).id,i=t.scope.__private__.encodeColorString(t.color),a=gx(t,t.caption);return r.push("0.749023 g"),r.push("0 0 "+_r(Xt.internal.getWidth(t))+" "+_r(Xt.internal.getHeight(t))+" re"),r.push("f"),r.push("BMC"),r.push("q"),r.push("0 0 1 rg"),r.push("/"+n+" "+_r(a.fontSize)+" Tf "+i),r.push("BT"),r.push(a.text),r.push("ET"),r.push("Q"),r.push("EMC"),e.stream=r.join(`
`),e},YesNormal:function(t){var e=ac(t);e.scope=t.scope;var r=t.scope.internal.getFont(t.fontName,t.fontStyle).id,n=t.scope.__private__.encodeColorString(t.color),i=[],a=Xt.internal.getHeight(t),o=Xt.internal.getWidth(t),c=gx(t,t.caption);return i.push("1 g"),i.push("0 0 "+_r(o)+" "+_r(a)+" re"),i.push("f"),i.push("q"),i.push("0 0 1 rg"),i.push("0 0 "+_r(o-1)+" "+_r(a-1)+" re"),i.push("W"),i.push("n"),i.push("0 g"),i.push("BT"),i.push("/"+r+" "+_r(c.fontSize)+" Tf "+n),i.push(c.text),i.push("ET"),i.push("Q"),e.stream=i.join(`
`),e},OffPushDown:function(t){var e=ac(t);e.scope=t.scope;var r=[];return r.push("0.749023 g"),r.push("0 0 "+_r(Xt.internal.getWidth(t))+" "+_r(Xt.internal.getHeight(t))+" re"),r.push("f"),e.stream=r.join(`
`),e}},RadioButton:{Circle:{createAppearanceStream:function(t){var e={D:{Off:Xt.RadioButton.Circle.OffPushDown},N:{}};return e.N[t]=Xt.RadioButton.Circle.YesNormal,e.D[t]=Xt.RadioButton.Circle.YesPushDown,e},getCA:function(){return"l"},YesNormal:function(t){var e=ac(t);e.scope=t.scope;var r=[],n=Xt.internal.getWidth(t)<=Xt.internal.getHeight(t)?Xt.internal.getWidth(t)/4:Xt.internal.getHeight(t)/4;n=Number((.9*n).toFixed(5));var i=Xt.internal.Bezier_C,a=Number((n*i).toFixed(5));return r.push("q"),r.push("1 0 0 1 "+Qu(Xt.internal.getWidth(t)/2)+" "+Qu(Xt.internal.getHeight(t)/2)+" cm"),r.push(n+" 0 m"),r.push(n+" "+a+" "+a+" "+n+" 0 "+n+" c"),r.push("-"+a+" "+n+" -"+n+" "+a+" -"+n+" 0 c"),r.push("-"+n+" -"+a+" -"+a+" -"+n+" 0 -"+n+" c"),r.push(a+" -"+n+" "+n+" -"+a+" "+n+" 0 c"),r.push("f"),r.push("Q"),e.stream=r.join(`
`),e},YesPushDown:function(t){var e=ac(t);e.scope=t.scope;var r=[],n=Xt.internal.getWidth(t)<=Xt.internal.getHeight(t)?Xt.internal.getWidth(t)/4:Xt.internal.getHeight(t)/4;n=Number((.9*n).toFixed(5));var i=Number((2*n).toFixed(5)),a=Number((i*Xt.internal.Bezier_C).toFixed(5)),o=Number((n*Xt.internal.Bezier_C).toFixed(5));return r.push("0.749023 g"),r.push("q"),r.push("1 0 0 1 "+Qu(Xt.internal.getWidth(t)/2)+" "+Qu(Xt.internal.getHeight(t)/2)+" cm"),r.push(i+" 0 m"),r.push(i+" "+a+" "+a+" "+i+" 0 "+i+" c"),r.push("-"+a+" "+i+" -"+i+" "+a+" -"+i+" 0 c"),r.push("-"+i+" -"+a+" -"+a+" -"+i+" 0 -"+i+" c"),r.push(a+" -"+i+" "+i+" -"+a+" "+i+" 0 c"),r.push("f"),r.push("Q"),r.push("0 g"),r.push("q"),r.push("1 0 0 1 "+Qu(Xt.internal.getWidth(t)/2)+" "+Qu(Xt.internal.getHeight(t)/2)+" cm"),r.push(n+" 0 m"),r.push(n+" "+o+" "+o+" "+n+" 0 "+n+" c"),r.push("-"+o+" "+n+" -"+n+" "+o+" -"+n+" 0 c"),r.push("-"+n+" -"+o+" -"+o+" -"+n+" 0 -"+n+" c"),r.push(o+" -"+n+" "+n+" -"+o+" "+n+" 0 c"),r.push("f"),r.push("Q"),e.stream=r.join(`
`),e},OffPushDown:function(t){var e=ac(t);e.scope=t.scope;var r=[],n=Xt.internal.getWidth(t)<=Xt.internal.getHeight(t)?Xt.internal.getWidth(t)/4:Xt.internal.getHeight(t)/4;n=Number((.9*n).toFixed(5));var i=Number((2*n).toFixed(5)),a=Number((i*Xt.internal.Bezier_C).toFixed(5));return r.push("0.749023 g"),r.push("q"),r.push("1 0 0 1 "+Qu(Xt.internal.getWidth(t)/2)+" "+Qu(Xt.internal.getHeight(t)/2)+" cm"),r.push(i+" 0 m"),r.push(i+" "+a+" "+a+" "+i+" 0 "+i+" c"),r.push("-"+a+" "+i+" -"+i+" "+a+" -"+i+" 0 c"),r.push("-"+i+" -"+a+" -"+a+" -"+i+" 0 -"+i+" c"),r.push(a+" -"+i+" "+i+" -"+a+" "+i+" 0 c"),r.push("f"),r.push("Q"),e.stream=r.join(`
`),e}},Cross:{createAppearanceStream:function(t){var e={D:{Off:Xt.RadioButton.Cross.OffPushDown},N:{}};return e.N[t]=Xt.RadioButton.Cross.YesNormal,e.D[t]=Xt.RadioButton.Cross.YesPushDown,e},getCA:function(){return"8"},YesNormal:function(t){var e=ac(t);e.scope=t.scope;var r=[],n=Xt.internal.calculateCross(t);return r.push("q"),r.push("1 1 "+_r(Xt.internal.getWidth(t)-2)+" "+_r(Xt.internal.getHeight(t)-2)+" re"),r.push("W"),r.push("n"),r.push(_r(n.x1.x)+" "+_r(n.x1.y)+" m"),r.push(_r(n.x2.x)+" "+_r(n.x2.y)+" l"),r.push(_r(n.x4.x)+" "+_r(n.x4.y)+" m"),r.push(_r(n.x3.x)+" "+_r(n.x3.y)+" l"),r.push("s"),r.push("Q"),e.stream=r.join(`
`),e},YesPushDown:function(t){var e=ac(t);e.scope=t.scope;var r=Xt.internal.calculateCross(t),n=[];return n.push("0.749023 g"),n.push("0 0 "+_r(Xt.internal.getWidth(t))+" "+_r(Xt.internal.getHeight(t))+" re"),n.push("f"),n.push("q"),n.push("1 1 "+_r(Xt.internal.getWidth(t)-2)+" "+_r(Xt.internal.getHeight(t)-2)+" re"),n.push("W"),n.push("n"),n.push(_r(r.x1.x)+" "+_r(r.x1.y)+" m"),n.push(_r(r.x2.x)+" "+_r(r.x2.y)+" l"),n.push(_r(r.x4.x)+" "+_r(r.x4.y)+" m"),n.push(_r(r.x3.x)+" "+_r(r.x3.y)+" l"),n.push("s"),n.push("Q"),e.stream=n.join(`
`),e},OffPushDown:function(t){var e=ac(t);e.scope=t.scope;var r=[];return r.push("0.749023 g"),r.push("0 0 "+_r(Xt.internal.getWidth(t))+" "+_r(Xt.internal.getHeight(t))+" re"),r.push("f"),e.stream=r.join(`
`),e}}},createDefaultAppearanceStream:function(t){var e=t.scope.internal.getFont(t.fontName,t.fontStyle).id,r=t.scope.__private__.encodeColorString(t.color);return"/"+e+" "+t.fontSize+" Tf "+r}};Xt.internal={Bezier_C:.551915024494,calculateCross:function(t){var e=Xt.internal.getWidth(t),r=Xt.internal.getHeight(t),n=Math.min(e,r);return{x1:{x:(e-n)/2,y:(r-n)/2+n},x2:{x:(e-n)/2+n,y:(r-n)/2},x3:{x:(e-n)/2,y:(r-n)/2},x4:{x:(e-n)/2+n,y:(r-n)/2+n}}}},Xt.internal.getWidth=function(t){var e=0;return Sn(t)==="object"&&(e=xb(t.Rect[2])),e},Xt.internal.getHeight=function(t){var e=0;return Sn(t)==="object"&&(e=xb(t.Rect[3])),e};var dX=ci.addField=function(t){if(hX(this,t),!(t instanceof Sl))throw new Error("Invalid argument passed to jsPDF.addField.");var e;return(e=t).scope.internal.acroformPlugin.printedOut&&(e.scope.internal.acroformPlugin.printedOut=!1,e.scope.internal.acroformPlugin.acroFormDictionaryRoot=null),e.scope.internal.acroformPlugin.acroFormDictionaryRoot.Fields.push(e),t.page=t.scope.internal.getCurrentPageInfo().pageNumber,this};ci.AcroFormChoiceField=V0,ci.AcroFormListBox=q0,ci.AcroFormComboBox=z0,ci.AcroFormEditBox=Zm,ci.AcroFormButton=ha,ci.AcroFormPushButton=eg,ci.AcroFormRadioButton=H0,ci.AcroFormCheckBox=tg,ci.AcroFormTextField=vh,ci.AcroFormPasswordField=rg,ci.AcroFormAppearance=Xt,ci.AcroForm={ChoiceField:V0,ListBox:q0,ComboBox:z0,EditBox:Zm,Button:ha,PushButton:eg,RadioButton:H0,CheckBox:tg,TextField:vh,PasswordField:rg,Appearance:Xt},ar.AcroForm={ChoiceField:V0,ListBox:q0,ComboBox:z0,EditBox:Zm,Button:ha,PushButton:eg,RadioButton:H0,CheckBox:tg,TextField:vh,PasswordField:rg,Appearance:Xt};ar.AcroForm;function Wk(t){return t.reduce(function(e,r,n){return e[r]=n,e},{})}(function(t){t.__addimage__={};var e="UNKNOWN",r={PNG:[[137,80,78,71]],TIFF:[[77,77,0,42],[73,73,42,0]],JPEG:[[255,216,255,224,void 0,void 0,74,70,73,70,0],[255,216,255,225,void 0,void 0,69,120,105,102,0,0],[255,216,255,219],[255,216,255,238]],JPEG2000:[[0,0,0,12,106,80,32,32]],GIF87a:[[71,73,70,56,55,97]],GIF89a:[[71,73,70,56,57,97]],WEBP:[[82,73,70,70,void 0,void 0,void 0,void 0,87,69,66,80]],BMP:[[66,77],[66,65],[67,73],[67,80],[73,67],[80,84]]},n=t.__addimage__.getImageFileTypeByImageData=function(I,C){var R,se,ne,J,de,oe=e;if((C=C||e)==="RGBA"||I.data!==void 0&&I.data instanceof Uint8ClampedArray&&"height"in I&&"width"in I)return"RGBA";if(he(I))for(de in r)for(ne=r[de],R=0;R<ne.length;R+=1){for(J=!0,se=0;se<ne[R].length;se+=1)if(ne[R][se]!==void 0&&ne[R][se]!==I[se]){J=!1;break}if(J===!0){oe=de;break}}else for(de in r)for(ne=r[de],R=0;R<ne.length;R+=1){for(J=!0,se=0;se<ne[R].length;se+=1)if(ne[R][se]!==void 0&&ne[R][se]!==I.charCodeAt(se)){J=!1;break}if(J===!0){oe=de;break}}return oe===e&&C!==e&&(oe=C),oe},i=function I(C){for(var R=this.internal.write,se=this.internal.putStream,ne=(0,this.internal.getFilters)();ne.indexOf("FlateEncode")!==-1;)ne.splice(ne.indexOf("FlateEncode"),1);C.objectId=this.internal.newObject();var J=[];if(J.push({key:"Type",value:"/XObject"}),J.push({key:"Subtype",value:"/Image"}),J.push({key:"Width",value:C.width}),J.push({key:"Height",value:C.height}),C.colorSpace===A.INDEXED?J.push({key:"ColorSpace",value:"[/Indexed /DeviceRGB "+(C.palette.length/3-1)+" "+("sMask"in C&&C.sMask!==void 0?C.objectId+2:C.objectId+1)+" 0 R]"}):(J.push({key:"ColorSpace",value:"/"+C.colorSpace}),C.colorSpace===A.DEVICE_CMYK&&J.push({key:"Decode",value:"[1 0 1 0 1 0 1 0]"})),J.push({key:"BitsPerComponent",value:C.bitsPerComponent}),"decodeParameters"in C&&C.decodeParameters!==void 0&&J.push({key:"DecodeParms",value:"<<"+C.decodeParameters+">>"}),"transparency"in C&&Array.isArray(C.transparency)){for(var de="",oe=0,Z=C.transparency.length;oe<Z;oe++)de+=C.transparency[oe]+" "+C.transparency[oe]+" ";J.push({key:"Mask",value:"["+de+"]"})}C.sMask!==void 0&&J.push({key:"SMask",value:C.objectId+1+" 0 R"});var X=C.filter!==void 0?["/"+C.filter]:void 0;if(se({data:C.data,additionalKeyValues:J,alreadyAppliedFilters:X,objectId:C.objectId}),R("endobj"),"sMask"in C&&C.sMask!==void 0){var xe="/Predictor "+C.predictor+" /Colors 1 /BitsPerComponent "+C.bitsPerComponent+" /Columns "+C.width,L={width:C.width,height:C.height,colorSpace:"DeviceGray",bitsPerComponent:C.bitsPerComponent,decodeParameters:xe,data:C.sMask};"filter"in C&&(L.filter=C.filter),I.call(this,L)}if(C.colorSpace===A.INDEXED){var j=this.internal.newObject();se({data:k(new Uint8Array(C.palette)),objectId:j}),R("endobj")}},a=function(){var I=this.internal.collections.addImage_images;for(var C in I)i.call(this,I[C])},o=function(){var I,C=this.internal.collections.addImage_images,R=this.internal.write;for(var se in C)R("/I"+(I=C[se]).index,I.objectId,"0","R")},c=function(){this.internal.collections.addImage_images||(this.internal.collections.addImage_images={},this.internal.events.subscribe("putResources",a),this.internal.events.subscribe("putXobjectDict",o))},u=function(){var I=this.internal.collections.addImage_images;return c.call(this),I},h=function(){return Object.keys(this.internal.collections.addImage_images).length},d=function(I){return typeof t["process"+I.toUpperCase()]=="function"},g=function(I){return Sn(I)==="object"&&I.nodeType===1},x=function(I,C){if(I.nodeName==="IMG"&&I.hasAttribute("src")){var R=""+I.getAttribute("src");if(R.indexOf("data:image/")===0)return A1(unescape(R).split("base64,").pop());var se=t.loadFile(R,!0);if(se!==void 0)return se}if(I.nodeName==="CANVAS"){if(I.width===0||I.height===0)throw new Error("Given canvas must have data. Canvas width: "+I.width+", height: "+I.height);var ne;switch(C){case"PNG":ne="image/png";break;case"WEBP":ne="image/webp";break;case"JPEG":case"JPG":default:ne="image/jpeg"}return A1(I.toDataURL(ne,1).split("base64,").pop())}},_=function(I){var C=this.internal.collections.addImage_images;if(C){for(var R in C)if(I===C[R].alias)return C[R]}},b=function(I,C,R){return I||C||(I=-96,C=-96),I<0&&(I=-1*R.width*72/I/this.internal.scaleFactor),C<0&&(C=-1*R.height*72/C/this.internal.scaleFactor),I===0&&(I=C*R.width/R.height),C===0&&(C=I*R.height/R.width),[I,C]},E=function(I,C,R,se,ne,J){var de=b.call(this,R,se,ne),oe=this.internal.getCoordinateString,Z=this.internal.getVerticalCoordinateString,X=u.call(this);if(R=de[0],se=de[1],X[ne.index]=ne,J){J*=Math.PI/180;var xe=Math.cos(J),L=Math.sin(J),j=function(G){return G.toFixed(4)},z=[j(xe),j(L),j(-1*L),j(xe),0,0,"cm"]}this.internal.write("q"),J?(this.internal.write([1,"0","0",1,oe(I),Z(C+se),"cm"].join(" ")),this.internal.write(z.join(" ")),this.internal.write([oe(R),"0","0",oe(se),"0","0","cm"].join(" "))):this.internal.write([oe(R),"0","0",oe(se),oe(I),Z(C+se),"cm"].join(" ")),this.isAdvancedAPI()&&this.internal.write([1,0,0,-1,0,0,"cm"].join(" ")),this.internal.write("/I"+ne.index+" Do"),this.internal.write("Q")},A=t.color_spaces={DEVICE_RGB:"DeviceRGB",DEVICE_GRAY:"DeviceGray",DEVICE_CMYK:"DeviceCMYK",CAL_GREY:"CalGray",CAL_RGB:"CalRGB",LAB:"Lab",ICC_BASED:"ICCBased",INDEXED:"Indexed",PATTERN:"Pattern",SEPARATION:"Separation",DEVICE_N:"DeviceN"};t.decode={DCT_DECODE:"DCTDecode",FLATE_DECODE:"FlateDecode",LZW_DECODE:"LZWDecode",JPX_DECODE:"JPXDecode",JBIG2_DECODE:"JBIG2Decode",ASCII85_DECODE:"ASCII85Decode",ASCII_HEX_DECODE:"ASCIIHexDecode",RUN_LENGTH_DECODE:"RunLengthDecode",CCITT_FAX_DECODE:"CCITTFaxDecode"};var O=t.image_compression={NONE:"NONE",FAST:"FAST",MEDIUM:"MEDIUM",SLOW:"SLOW"},M=t.__addimage__.sHashCode=function(I){var C,R,se=0;if(typeof I=="string")for(R=I.length,C=0;C<R;C++)se=(se<<5)-se+I.charCodeAt(C),se|=0;else if(he(I))for(R=I.byteLength/2,C=0;C<R;C++)se=(se<<5)-se+I[C],se|=0;return se},B=t.__addimage__.validateStringAsBase64=function(I){(I=I||"").toString().trim();var C=!0;return I.length===0&&(C=!1),I.length%4!=0&&(C=!1),/^[A-Za-z0-9+/]+$/.test(I.substr(0,I.length-2))===!1&&(C=!1),/^[A-Za-z0-9/][A-Za-z0-9+/]|[A-Za-z0-9+/]=|==$/.test(I.substr(-2))===!1&&(C=!1),C},Q=t.__addimage__.extractImageFromDataUrl=function(I){if(I==null||!(I=I.trim()).startsWith("data:"))return null;var C=I.indexOf(",");return C<0?null:I.substring(0,C).trim().endsWith("base64")?I.substring(C+1):null},ee=t.__addimage__.supportsArrayBuffer=function(){return typeof ArrayBuffer<"u"&&typeof Uint8Array<"u"};t.__addimage__.isArrayBuffer=function(I){return ee()&&I instanceof ArrayBuffer};var he=t.__addimage__.isArrayBufferView=function(I){return ee()&&typeof Uint32Array<"u"&&(I instanceof Int8Array||I instanceof Uint8Array||typeof Uint8ClampedArray<"u"&&I instanceof Uint8ClampedArray||I instanceof Int16Array||I instanceof Uint16Array||I instanceof Int32Array||I instanceof Uint32Array||I instanceof Float32Array||I instanceof Float64Array)},F=t.__addimage__.binaryStringToUint8Array=function(I){for(var C=I.length,R=new Uint8Array(C),se=0;se<C;se++)R[se]=I.charCodeAt(se);return R},k=t.__addimage__.arrayBufferToBinaryString=function(I){for(var C="",R=he(I)?I:new Uint8Array(I),se=0;se<R.length;se+=8192)C+=String.fromCharCode.apply(null,R.subarray(se,se+8192));return C};t.addImage=function(){var I,C,R,se,ne,J,de,oe,Z;if(typeof arguments[1]=="number"?(C=e,R=arguments[1],se=arguments[2],ne=arguments[3],J=arguments[4],de=arguments[5],oe=arguments[6],Z=arguments[7]):(C=arguments[1],R=arguments[2],se=arguments[3],ne=arguments[4],J=arguments[5],de=arguments[6],oe=arguments[7],Z=arguments[8]),Sn(I=arguments[0])==="object"&&!g(I)&&"imageData"in I){var X=I;I=X.imageData,C=X.format||C||e,R=X.x||R||0,se=X.y||se||0,ne=X.w||X.width||ne,J=X.h||X.height||J,de=X.alias||de,oe=X.compression||oe,Z=X.rotation||X.angle||Z}var xe=this.internal.getFilters();if(oe===void 0&&xe.indexOf("FlateEncode")!==-1&&(oe="SLOW"),isNaN(R)||isNaN(se))throw new Error("Invalid coordinates passed to jsPDF.addImage");c.call(this);var L=S.call(this,I,C,de,oe);return E.call(this,R,se,ne,J,L,Z),this};var S=function(I,C,R,se){var ne,J,de;if(typeof I=="string"&&n(I)===e){I=unescape(I);var oe=U(I,!1);(oe!==""||(oe=t.loadFile(I,!0))!==void 0)&&(I=oe)}if(g(I)&&(I=x(I,C)),C=n(I,C),!d(C))throw new Error("addImage does not support files of type '"+C+"', please ensure that a plugin for '"+C+"' support is added.");if(((de=R)==null||de.length===0)&&(R=function(Z){return typeof Z=="string"||he(Z)?M(Z):he(Z.data)?M(Z.data):null}(I)),(ne=_.call(this,R))||(ee()&&(I instanceof Uint8Array||C==="RGBA"||(J=I,I=F(I))),ne=this["process"+C.toUpperCase()](I,h.call(this),R,function(Z){return Z&&typeof Z=="string"&&(Z=Z.toUpperCase()),Z in t.image_compression?Z:O.NONE}(se),J)),!ne)throw new Error("An unknown error occurred whilst processing the image.");return ne},U=t.__addimage__.convertBase64ToBinaryString=function(I,C){C=typeof C!="boolean"||C;var R,se="";if(typeof I=="string"){var ne;R=(ne=Q(I))!==null&&ne!==void 0?ne:I;try{se=A1(R)}catch(J){if(C)throw B(R)?new Error("atob-Error in jsPDF.convertBase64ToBinaryString "+J.message):new Error("Supplied Data is not a valid base64-String jsPDF.convertBase64ToBinaryString ")}}return se};t.getImageProperties=function(I){var C,R,se="";if(g(I)&&(I=x(I)),typeof I=="string"&&n(I)===e&&((se=U(I,!1))===""&&(se=t.loadFile(I)||""),I=se),R=n(I),!d(R))throw new Error("addImage does not support files of type '"+R+"', please ensure that a plugin for '"+R+"' support is added.");if(!ee()||I instanceof Uint8Array||(I=F(I)),!(C=this["process"+R.toUpperCase()](I)))throw new Error("An unknown error occurred whilst processing the image");return C.fileType=R,C}})(ar.API),function(t){var e=function(r){if(r!==void 0&&r!="")return!0};ar.API.events.push(["addPage",function(r){this.internal.getPageInfo(r.pageNumber).pageContext.annotations=[]}]),t.events.push(["putPage",function(r){for(var n,i,a,o=this.internal.getCoordinateString,c=this.internal.getVerticalCoordinateString,u=this.internal.getPageInfoByObjId(r.objId),h=r.pageContext.annotations,d=!1,g=0;g<h.length&&!d;g++)switch((n=h[g]).type){case"link":(e(n.options.url)||e(n.options.pageNumber))&&(d=!0);break;case"reference":case"text":case"freetext":d=!0}if(d!=0){this.internal.write("/Annots [");for(var x=0;x<h.length;x++){n=h[x];var _=this.internal.pdfEscape,b=this.internal.getEncryptor(r.objId);switch(n.type){case"reference":this.internal.write(" "+n.object.objId+" 0 R ");break;case"text":var E=this.internal.newAdditionalObject(),A=this.internal.newAdditionalObject(),O=this.internal.getEncryptor(E.objId),M=n.title||"Note";a="<</Type /Annot /Subtype /Text "+(i="/Rect ["+o(n.bounds.x)+" "+c(n.bounds.y+n.bounds.h)+" "+o(n.bounds.x+n.bounds.w)+" "+c(n.bounds.y)+"] ")+"/Contents ("+_(O(n.contents))+")",a+=" /Popup "+A.objId+" 0 R",a+=" /P "+u.objId+" 0 R",a+=" /T ("+_(O(M))+") >>",E.content=a;var B=E.objId+" 0 R";a="<</Type /Annot /Subtype /Popup "+(i="/Rect ["+o(n.bounds.x+30)+" "+c(n.bounds.y+n.bounds.h)+" "+o(n.bounds.x+n.bounds.w+30)+" "+c(n.bounds.y)+"] ")+" /Parent "+B,n.open&&(a+=" /Open true"),a+=" >>",A.content=a,this.internal.write(E.objId,"0 R",A.objId,"0 R");break;case"freetext":i="/Rect ["+o(n.bounds.x)+" "+c(n.bounds.y)+" "+o(n.bounds.x+n.bounds.w)+" "+c(n.bounds.y+n.bounds.h)+"] ";var Q=n.color||"#000000";a="<</Type /Annot /Subtype /FreeText "+i+"/Contents ("+_(b(n.contents))+")",a+=" /DS(font: Helvetica,sans-serif 12.0pt; text-align:left; color:#"+Q+")",a+=" /Border [0 0 0]",a+=" >>",this.internal.write(a);break;case"link":if(n.options.name){var ee=this.annotations._nameMap[n.options.name];n.options.pageNumber=ee.page,n.options.top=ee.y}else n.options.top||(n.options.top=0);if(i="/Rect ["+n.finalBounds.x+" "+n.finalBounds.y+" "+n.finalBounds.w+" "+n.finalBounds.h+"] ",a="",n.options.url)a="<</Type /Annot /Subtype /Link "+i+"/Border [0 0 0] /A <</S /URI /URI ("+_(b(n.options.url))+") >>";else if(n.options.pageNumber)switch(a="<</Type /Annot /Subtype /Link "+i+"/Border [0 0 0] /Dest ["+this.internal.getPageInfo(n.options.pageNumber).objId+" 0 R",n.options.magFactor=n.options.magFactor||"XYZ",n.options.magFactor){case"Fit":a+=" /Fit]";break;case"FitH":a+=" /FitH "+n.options.top+"]";break;case"FitV":n.options.left=n.options.left||0,a+=" /FitV "+n.options.left+"]";break;case"XYZ":default:var he=c(n.options.top);n.options.left=n.options.left||0,n.options.zoom===void 0&&(n.options.zoom=0),a+=" /XYZ "+n.options.left+" "+he+" "+n.options.zoom+"]"}a!=""&&(a+=" >>",this.internal.write(a))}}this.internal.write("]")}}]),t.createAnnotation=function(r){var n=this.internal.getCurrentPageInfo();switch(r.type){case"link":this.link(r.bounds.x,r.bounds.y,r.bounds.w,r.bounds.h,r);break;case"text":case"freetext":n.pageContext.annotations.push(r)}},t.link=function(r,n,i,a,o){var c=this.internal.getCurrentPageInfo(),u=this.internal.getCoordinateString,h=this.internal.getVerticalCoordinateString;c.pageContext.annotations.push({finalBounds:{x:u(r),y:h(n),w:u(r+i),h:h(n+a)},options:o,type:"link"})},t.textWithLink=function(r,n,i,a){var o,c,u=this.getTextWidth(r),h=this.internal.getLineHeight()/this.internal.scaleFactor;if(a.maxWidth!==void 0){c=a.maxWidth;var d=this.splitTextToSize(r,c).length;o=Math.ceil(h*d)}else c=u,o=h;return this.text(r,n,i,a),i+=.2*h,a.align==="center"&&(n-=u/2),a.align==="right"&&(n-=u),this.link(n,i-h,c,o,a),u},t.getTextWidth=function(r){var n=this.internal.getFontSize();return this.getStringUnitWidth(r)*n/this.internal.scaleFactor}}(ar.API),function(t){var e={1569:[65152],1570:[65153,65154],1571:[65155,65156],1572:[65157,65158],1573:[65159,65160],1574:[65161,65162,65163,65164],1575:[65165,65166],1576:[65167,65168,65169,65170],1577:[65171,65172],1578:[65173,65174,65175,65176],1579:[65177,65178,65179,65180],1580:[65181,65182,65183,65184],1581:[65185,65186,65187,65188],1582:[65189,65190,65191,65192],1583:[65193,65194],1584:[65195,65196],1585:[65197,65198],1586:[65199,65200],1587:[65201,65202,65203,65204],1588:[65205,65206,65207,65208],1589:[65209,65210,65211,65212],1590:[65213,65214,65215,65216],1591:[65217,65218,65219,65220],1592:[65221,65222,65223,65224],1593:[65225,65226,65227,65228],1594:[65229,65230,65231,65232],1601:[65233,65234,65235,65236],1602:[65237,65238,65239,65240],1603:[65241,65242,65243,65244],1604:[65245,65246,65247,65248],1605:[65249,65250,65251,65252],1606:[65253,65254,65255,65256],1607:[65257,65258,65259,65260],1608:[65261,65262],1609:[65263,65264,64488,64489],1610:[65265,65266,65267,65268],1649:[64336,64337],1655:[64477],1657:[64358,64359,64360,64361],1658:[64350,64351,64352,64353],1659:[64338,64339,64340,64341],1662:[64342,64343,64344,64345],1663:[64354,64355,64356,64357],1664:[64346,64347,64348,64349],1667:[64374,64375,64376,64377],1668:[64370,64371,64372,64373],1670:[64378,64379,64380,64381],1671:[64382,64383,64384,64385],1672:[64392,64393],1676:[64388,64389],1677:[64386,64387],1678:[64390,64391],1681:[64396,64397],1688:[64394,64395],1700:[64362,64363,64364,64365],1702:[64366,64367,64368,64369],1705:[64398,64399,64400,64401],1709:[64467,64468,64469,64470],1711:[64402,64403,64404,64405],1713:[64410,64411,64412,64413],1715:[64406,64407,64408,64409],1722:[64414,64415],1723:[64416,64417,64418,64419],1726:[64426,64427,64428,64429],1728:[64420,64421],1729:[64422,64423,64424,64425],1733:[64480,64481],1734:[64473,64474],1735:[64471,64472],1736:[64475,64476],1737:[64482,64483],1739:[64478,64479],1740:[64508,64509,64510,64511],1744:[64484,64485,64486,64487],1746:[64430,64431],1747:[64432,64433]},r={65247:{65154:65269,65156:65271,65160:65273,65166:65275},65248:{65154:65270,65156:65272,65160:65274,65166:65276},65165:{65247:{65248:{65258:65010}}},1617:{1612:64606,1613:64607,1614:64608,1615:64609,1616:64610}},n={1612:64606,1613:64607,1614:64608,1615:64609,1616:64610},i=[1570,1571,1573,1575];t.__arabicParser__={};var a=t.__arabicParser__.isInArabicSubstitutionA=function(E){return e[E.charCodeAt(0)]!==void 0},o=t.__arabicParser__.isArabicLetter=function(E){return typeof E=="string"&&/^[\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\uFB50-\uFDFF\uFE70-\uFEFF]+$/.test(E)},c=t.__arabicParser__.isArabicEndLetter=function(E){return o(E)&&a(E)&&e[E.charCodeAt(0)].length<=2},u=t.__arabicParser__.isArabicAlfLetter=function(E){return o(E)&&i.indexOf(E.charCodeAt(0))>=0};t.__arabicParser__.arabicLetterHasIsolatedForm=function(E){return o(E)&&a(E)&&e[E.charCodeAt(0)].length>=1};var h=t.__arabicParser__.arabicLetterHasFinalForm=function(E){return o(E)&&a(E)&&e[E.charCodeAt(0)].length>=2};t.__arabicParser__.arabicLetterHasInitialForm=function(E){return o(E)&&a(E)&&e[E.charCodeAt(0)].length>=3};var d=t.__arabicParser__.arabicLetterHasMedialForm=function(E){return o(E)&&a(E)&&e[E.charCodeAt(0)].length==4},g=t.__arabicParser__.resolveLigatures=function(E){var A=0,O=r,M="",B=0;for(A=0;A<E.length;A+=1)O[E.charCodeAt(A)]!==void 0?(B++,typeof(O=O[E.charCodeAt(A)])=="number"&&(M+=String.fromCharCode(O),O=r,B=0),A===E.length-1&&(O=r,M+=E.charAt(A-(B-1)),A-=B-1,B=0)):(O=r,M+=E.charAt(A-B),A-=B,B=0);return M};t.__arabicParser__.isArabicDiacritic=function(E){return E!==void 0&&n[E.charCodeAt(0)]!==void 0};var x=t.__arabicParser__.getCorrectForm=function(E,A,O){return o(E)?a(E)===!1?-1:!h(E)||!o(A)&&!o(O)||!o(O)&&c(A)||c(E)&&!o(A)||c(E)&&u(A)||c(E)&&c(A)?0:d(E)&&o(A)&&!c(A)&&o(O)&&h(O)?3:c(E)||!o(O)?1:2:-1},_=function(E){var A=0,O=0,M=0,B="",Q="",ee="",he=(E=E||"").split("\\s+"),F=[];for(A=0;A<he.length;A+=1){for(F.push(""),O=0;O<he[A].length;O+=1)B=he[A][O],Q=he[A][O-1],ee=he[A][O+1],o(B)?(M=x(B,Q,ee),F[A]+=M!==-1?String.fromCharCode(e[B.charCodeAt(0)][M]):B):F[A]+=B;F[A]=g(F[A])}return F.join(" ")},b=t.__arabicParser__.processArabic=t.processArabic=function(){var E,A=typeof arguments[0]=="string"?arguments[0]:arguments[0].text,O=[];if(Array.isArray(A)){var M=0;for(O=[],M=0;M<A.length;M+=1)Array.isArray(A[M])?O.push([_(A[M][0]),A[M][1],A[M][2]]):O.push([_(A[M])]);E=O}else E=_(A);return typeof arguments[0]=="string"?E:(arguments[0].text=E,arguments[0])};t.events.push(["preProcessText",b])}(ar.API),ar.API.autoPrint=function(t){var e;switch((t=t||{}).variant=t.variant||"non-conform",t.variant){case"javascript":this.addJS("print({});");break;case"non-conform":default:this.internal.events.subscribe("postPutResources",function(){e=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /Named"),this.internal.out("/Type /Action"),this.internal.out("/N /Print"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){this.internal.out("/OpenAction "+e+" 0 R")})}return this},function(t){var e=function(){var r=void 0;Object.defineProperty(this,"pdf",{get:function(){return r},set:function(c){r=c}});var n=150;Object.defineProperty(this,"width",{get:function(){return n},set:function(c){n=isNaN(c)||Number.isInteger(c)===!1||c<0?150:c,this.getContext("2d").pageWrapXEnabled&&(this.getContext("2d").pageWrapX=n+1)}});var i=300;Object.defineProperty(this,"height",{get:function(){return i},set:function(c){i=isNaN(c)||Number.isInteger(c)===!1||c<0?300:c,this.getContext("2d").pageWrapYEnabled&&(this.getContext("2d").pageWrapY=i+1)}});var a=[];Object.defineProperty(this,"childNodes",{get:function(){return a},set:function(c){a=c}});var o={};Object.defineProperty(this,"style",{get:function(){return o},set:function(c){o=c}}),Object.defineProperty(this,"parentNode",{})};e.prototype.getContext=function(r,n){var i;if((r=r||"2d")!=="2d")return null;for(i in n)this.pdf.context2d.hasOwnProperty(i)&&(this.pdf.context2d[i]=n[i]);return this.pdf.context2d._canvas=this,this.pdf.context2d},e.prototype.toDataURL=function(){throw new Error("toDataURL is not implemented.")},t.events.push(["initialized",function(){this.canvas=new e,this.canvas.pdf=this}])}(ar.API),function(t){var e={left:0,top:0,bottom:0,right:0},r=!1,n=function(){this.internal.__cell__===void 0&&(this.internal.__cell__={},this.internal.__cell__.padding=3,this.internal.__cell__.headerFunction=void 0,this.internal.__cell__.margins=Object.assign({},e),this.internal.__cell__.margins.width=this.getPageWidth(),i.call(this))},i=function(){this.internal.__cell__.lastCell=new a,this.internal.__cell__.pages=1},a=function(){var u=arguments[0];Object.defineProperty(this,"x",{enumerable:!0,get:function(){return u},set:function(E){u=E}});var h=arguments[1];Object.defineProperty(this,"y",{enumerable:!0,get:function(){return h},set:function(E){h=E}});var d=arguments[2];Object.defineProperty(this,"width",{enumerable:!0,get:function(){return d},set:function(E){d=E}});var g=arguments[3];Object.defineProperty(this,"height",{enumerable:!0,get:function(){return g},set:function(E){g=E}});var x=arguments[4];Object.defineProperty(this,"text",{enumerable:!0,get:function(){return x},set:function(E){x=E}});var _=arguments[5];Object.defineProperty(this,"lineNumber",{enumerable:!0,get:function(){return _},set:function(E){_=E}});var b=arguments[6];return Object.defineProperty(this,"align",{enumerable:!0,get:function(){return b},set:function(E){b=E}}),this};a.prototype.clone=function(){return new a(this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align)},a.prototype.toArray=function(){return[this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align]},t.setHeaderFunction=function(u){return n.call(this),this.internal.__cell__.headerFunction=typeof u=="function"?u:void 0,this},t.getTextDimensions=function(u,h){n.call(this);var d=(h=h||{}).fontSize||this.getFontSize(),g=h.font||this.getFont(),x=h.scaleFactor||this.internal.scaleFactor,_=0,b=0,E=0,A=this;if(!Array.isArray(u)&&typeof u!="string"){if(typeof u!="number")throw new Error("getTextDimensions expects text-parameter to be of type String or type Number or an Array of Strings.");u=String(u)}var O=h.maxWidth;O>0?typeof u=="string"?u=this.splitTextToSize(u,O):Object.prototype.toString.call(u)==="[object Array]"&&(u=u.reduce(function(B,Q){return B.concat(A.splitTextToSize(Q,O))},[])):u=Array.isArray(u)?u:[u];for(var M=0;M<u.length;M++)_<(E=this.getStringUnitWidth(u[M],{font:g})*d)&&(_=E);return _!==0&&(b=u.length),{w:_/=x,h:Math.max((b*d*this.getLineHeightFactor()-d*(this.getLineHeightFactor()-1))/x,0)}},t.cellAddPage=function(){n.call(this),this.addPage();var u=this.internal.__cell__.margins||e;return this.internal.__cell__.lastCell=new a(u.left,u.top,void 0,void 0),this.internal.__cell__.pages+=1,this};var o=t.cell=function(){var u;u=arguments[0]instanceof a?arguments[0]:new a(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5]),n.call(this);var h=this.internal.__cell__.lastCell,d=this.internal.__cell__.padding,g=this.internal.__cell__.margins||e,x=this.internal.__cell__.tableHeaderRow,_=this.internal.__cell__.printHeaders;return h.lineNumber!==void 0&&(h.lineNumber===u.lineNumber?(u.x=(h.x||0)+(h.width||0),u.y=h.y||0):h.y+h.height+u.height+g.bottom>this.getPageHeight()?(this.cellAddPage(),u.y=g.top,_&&x&&(this.printHeaderRow(u.lineNumber,!0),u.y+=x[0].height)):u.y=h.y+h.height||u.y),u.text[0]!==void 0&&(this.rect(u.x,u.y,u.width,u.height,r===!0?"FD":void 0),u.align==="right"?this.text(u.text,u.x+u.width-d,u.y+d,{align:"right",baseline:"top"}):u.align==="center"?this.text(u.text,u.x+u.width/2,u.y+d,{align:"center",baseline:"top",maxWidth:u.width-d-d}):this.text(u.text,u.x+d,u.y+d,{align:"left",baseline:"top",maxWidth:u.width-d-d})),this.internal.__cell__.lastCell=u,this};t.table=function(u,h,d,g,x){if(n.call(this),!d)throw new Error("No data for PDF table.");var _,b,E,A,O=[],M=[],B=[],Q={},ee={},he=[],F=[],k=(x=x||{}).autoSize||!1,S=x.printHeaders!==!1,U=x.css&&x.css["font-size"]!==void 0?16*x.css["font-size"]:x.fontSize||12,I=x.margins||Object.assign({width:this.getPageWidth()},e),C=typeof x.padding=="number"?x.padding:3,R=x.headerBackgroundColor||"#c8c8c8",se=x.headerTextColor||"#000";if(i.call(this),this.internal.__cell__.printHeaders=S,this.internal.__cell__.margins=I,this.internal.__cell__.table_font_size=U,this.internal.__cell__.padding=C,this.internal.__cell__.headerBackgroundColor=R,this.internal.__cell__.headerTextColor=se,this.setFontSize(U),g==null)M=O=Object.keys(d[0]),B=O.map(function(){return"left"});else if(Array.isArray(g)&&Sn(g[0])==="object")for(O=g.map(function(X){return X.name}),M=g.map(function(X){return X.prompt||X.name||""}),B=g.map(function(X){return X.align||"left"}),_=0;_<g.length;_+=1)ee[g[_].name]=g[_].width*(19.049976/25.4);else Array.isArray(g)&&typeof g[0]=="string"&&(M=O=g,B=O.map(function(){return"left"}));if(k||Array.isArray(g)&&typeof g[0]=="string")for(_=0;_<O.length;_+=1){for(Q[A=O[_]]=d.map(function(X){return X[A]}),this.setFont(void 0,"bold"),he.push(this.getTextDimensions(M[_],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w),b=Q[A],this.setFont(void 0,"normal"),E=0;E<b.length;E+=1)he.push(this.getTextDimensions(b[E],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w);ee[A]=Math.max.apply(null,he)+C+C,he=[]}if(S){var ne={};for(_=0;_<O.length;_+=1)ne[O[_]]={},ne[O[_]].text=M[_],ne[O[_]].align=B[_];var J=c.call(this,ne,ee);F=O.map(function(X){return new a(u,h,ee[X],J,ne[X].text,void 0,ne[X].align)}),this.setTableHeaderRow(F),this.printHeaderRow(1,!1)}var de=g.reduce(function(X,xe){return X[xe.name]=xe.align,X},{});for(_=0;_<d.length;_+=1){"rowStart"in x&&x.rowStart instanceof Function&&x.rowStart({row:_,data:d[_]},this);var oe=c.call(this,d[_],ee);for(E=0;E<O.length;E+=1){var Z=d[_][O[E]];"cellStart"in x&&x.cellStart instanceof Function&&x.cellStart({row:_,col:E,data:Z},this),o.call(this,new a(u,h,ee[O[E]],oe,Z,_+2,de[O[E]]))}}return this.internal.__cell__.table_x=u,this.internal.__cell__.table_y=h,this};var c=function(u,h){var d=this.internal.__cell__.padding,g=this.internal.__cell__.table_font_size,x=this.internal.scaleFactor;return Object.keys(u).map(function(_){var b=u[_];return this.splitTextToSize(b.hasOwnProperty("text")?b.text:b,h[_]-d-d)},this).map(function(_){return this.getLineHeightFactor()*_.length*g/x+d+d},this).reduce(function(_,b){return Math.max(_,b)},0)};t.setTableHeaderRow=function(u){n.call(this),this.internal.__cell__.tableHeaderRow=u},t.printHeaderRow=function(u,h){if(n.call(this),!this.internal.__cell__.tableHeaderRow)throw new Error("Property tableHeaderRow does not exist.");var d;if(r=!0,typeof this.internal.__cell__.headerFunction=="function"){var g=this.internal.__cell__.headerFunction(this,this.internal.__cell__.pages);this.internal.__cell__.lastCell=new a(g[0],g[1],g[2],g[3],void 0,-1)}this.setFont(void 0,"bold");for(var x=[],_=0;_<this.internal.__cell__.tableHeaderRow.length;_+=1){d=this.internal.__cell__.tableHeaderRow[_].clone(),h&&(d.y=this.internal.__cell__.margins.top||0,x.push(d)),d.lineNumber=u;var b=this.getTextColor();this.setTextColor(this.internal.__cell__.headerTextColor),this.setFillColor(this.internal.__cell__.headerBackgroundColor),o.call(this,d),this.setTextColor(b)}x.length>0&&this.setTableHeaderRow(x),this.setFont(void 0,"normal"),r=!1}}(ar.API);var Xk={italic:["italic","oblique","normal"],oblique:["oblique","italic","normal"],normal:["normal","oblique","italic"]},Yk=["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded"],vx=Wk(Yk),Kk=[100,200,300,400,500,600,700,800,900],pX=Wk(Kk);function _x(t){var e=t.family.replace(/"|'/g,"").toLowerCase(),r=function(a){return Xk[a=a||"normal"]?a:"normal"}(t.style),n=function(a){if(!a)return 400;if(typeof a=="number")return a>=100&&a<=900&&a%100==0?a:400;if(/^\d00$/.test(a))return parseInt(a);switch(a){case"bold":return 700;case"normal":default:return 400}}(t.weight),i=function(a){return typeof vx[a=a||"normal"]=="number"?a:"normal"}(t.stretch);return{family:e,style:r,weight:n,stretch:i,src:t.src||[],ref:t.ref||{name:e,style:[i,r,n].join(" ")}}}function yb(t,e,r,n){var i;for(i=r;i>=0&&i<e.length;i+=n)if(t[e[i]])return t[e[i]];for(i=r;i>=0&&i<e.length;i-=n)if(t[e[i]])return t[e[i]]}var mX={"sans-serif":"helvetica",fixed:"courier",monospace:"courier",terminal:"courier",cursive:"times",fantasy:"times",serif:"times"},wb={caption:"times",icon:"times",menu:"times","message-box":"times","small-caption":"times","status-bar":"times"};function Eb(t){return[t.stretch,t.style,t.weight,t.family].join(" ")}function gX(t,e,r){for(var n=(r=r||{}).defaultFontFamily||"times",i=Object.assign({},mX,r.genericFontFamilies||{}),a=null,o=null,c=0;c<e.length;++c)if(i[(a=_x(e[c])).family]&&(a.family=i[a.family]),t.hasOwnProperty(a.family)){o=t[a.family];break}if(!(o=o||t[n]))throw new Error("Could not find a font-family for the rule '"+Eb(a)+"' and default family '"+n+"'.");if(o=function(u,h){if(h[u])return h[u];var d=vx[u],g=d<=vx.normal?-1:1,x=yb(h,Yk,d,g);if(!x)throw new Error("Could not find a matching font-stretch value for "+u);return x}(a.stretch,o),o=function(u,h){if(h[u])return h[u];for(var d=Xk[u],g=0;g<d.length;++g)if(h[d[g]])return h[d[g]];throw new Error("Could not find a matching font-style for "+u)}(a.style,o),!(o=function(u,h){if(h[u])return h[u];if(u===400&&h[500])return h[500];if(u===500&&h[400])return h[400];var d=pX[u],g=yb(h,Kk,d,u<400?-1:1);if(!g)throw new Error("Could not find a matching font-weight for value "+u);return g}(a.weight,o)))throw new Error("Failed to resolve a font for the rule '"+Eb(a)+"'.");return o}function bb(t){return t.trimLeft()}function vX(t,e){for(var r=0;r<t.length;){if(t.charAt(r)===e)return[t.substring(0,r),t.substring(r+1)];r+=1}return null}function _X(t){var e=t.match(/^(-[a-z_]|[a-z_])[a-z0-9_-]*/i);return e===null?null:[e[0],t.substring(e[0].length)]}var Mm,Sb,Ab,m_=["times"];(function(t){var e,r,n,i,a,o,c,u,h,d=function(L){return L=L||{},this.isStrokeTransparent=L.isStrokeTransparent||!1,this.strokeOpacity=L.strokeOpacity||1,this.strokeStyle=L.strokeStyle||"#000000",this.fillStyle=L.fillStyle||"#000000",this.isFillTransparent=L.isFillTransparent||!1,this.fillOpacity=L.fillOpacity||1,this.font=L.font||"10px sans-serif",this.textBaseline=L.textBaseline||"alphabetic",this.textAlign=L.textAlign||"left",this.lineWidth=L.lineWidth||1,this.lineJoin=L.lineJoin||"miter",this.lineCap=L.lineCap||"butt",this.path=L.path||[],this.transform=L.transform!==void 0?L.transform.clone():new u,this.globalCompositeOperation=L.globalCompositeOperation||"normal",this.globalAlpha=L.globalAlpha||1,this.clip_path=L.clip_path||[],this.currentPoint=L.currentPoint||new o,this.miterLimit=L.miterLimit||10,this.lastPoint=L.lastPoint||new o,this.lineDashOffset=L.lineDashOffset||0,this.lineDash=L.lineDash||[],this.margin=L.margin||[0,0,0,0],this.prevPageLastElemOffset=L.prevPageLastElemOffset||0,this.ignoreClearRect=typeof L.ignoreClearRect!="boolean"||L.ignoreClearRect,this};t.events.push(["initialized",function(){this.context2d=new g(this),e=this.internal.f2,r=this.internal.getCoordinateString,n=this.internal.getVerticalCoordinateString,i=this.internal.getHorizontalCoordinate,a=this.internal.getVerticalCoordinate,o=this.internal.Point,c=this.internal.Rectangle,u=this.internal.Matrix,h=new d}]);var g=function(L){Object.defineProperty(this,"canvas",{get:function(){return{parentNode:!1,style:!1}}});var j=L;Object.defineProperty(this,"pdf",{get:function(){return j}});var z=!1;Object.defineProperty(this,"pageWrapXEnabled",{get:function(){return z},set:function(Pe){z=!!Pe}});var G=!1;Object.defineProperty(this,"pageWrapYEnabled",{get:function(){return G},set:function(Pe){G=!!Pe}});var ae=0;Object.defineProperty(this,"posX",{get:function(){return ae},set:function(Pe){isNaN(Pe)||(ae=Pe)}});var Ae=0;Object.defineProperty(this,"posY",{get:function(){return Ae},set:function(Pe){isNaN(Pe)||(Ae=Pe)}}),Object.defineProperty(this,"margin",{get:function(){return h.margin},set:function(Pe){var ge;typeof Pe=="number"?ge=[Pe,Pe,Pe,Pe]:((ge=new Array(4))[0]=Pe[0],ge[1]=Pe.length>=2?Pe[1]:ge[0],ge[2]=Pe.length>=3?Pe[2]:ge[0],ge[3]=Pe.length>=4?Pe[3]:ge[1]),h.margin=ge}});var _e=!1;Object.defineProperty(this,"autoPaging",{get:function(){return _e},set:function(Pe){_e=Pe}});var Ee=0;Object.defineProperty(this,"lastBreak",{get:function(){return Ee},set:function(Pe){Ee=Pe}});var Ce=[];Object.defineProperty(this,"pageBreaks",{get:function(){return Ce},set:function(Pe){Ce=Pe}}),Object.defineProperty(this,"ctx",{get:function(){return h},set:function(Pe){Pe instanceof d&&(h=Pe)}}),Object.defineProperty(this,"path",{get:function(){return h.path},set:function(Pe){h.path=Pe}});var Oe=[];Object.defineProperty(this,"ctxStack",{get:function(){return Oe},set:function(Pe){Oe=Pe}}),Object.defineProperty(this,"fillStyle",{get:function(){return this.ctx.fillStyle},set:function(Pe){var ge;ge=x(Pe),this.ctx.fillStyle=ge.style,this.ctx.isFillTransparent=ge.a===0,this.ctx.fillOpacity=ge.a,this.pdf.setFillColor(ge.r,ge.g,ge.b,{a:ge.a}),this.pdf.setTextColor(ge.r,ge.g,ge.b,{a:ge.a})}}),Object.defineProperty(this,"strokeStyle",{get:function(){return this.ctx.strokeStyle},set:function(Pe){var ge=x(Pe);this.ctx.strokeStyle=ge.style,this.ctx.isStrokeTransparent=ge.a===0,this.ctx.strokeOpacity=ge.a,ge.a===0?this.pdf.setDrawColor(255,255,255):(ge.a,this.pdf.setDrawColor(ge.r,ge.g,ge.b))}}),Object.defineProperty(this,"lineCap",{get:function(){return this.ctx.lineCap},set:function(Pe){["butt","round","square"].indexOf(Pe)!==-1&&(this.ctx.lineCap=Pe,this.pdf.setLineCap(Pe))}}),Object.defineProperty(this,"lineWidth",{get:function(){return this.ctx.lineWidth},set:function(Pe){isNaN(Pe)||(this.ctx.lineWidth=Pe,this.pdf.setLineWidth(Pe))}}),Object.defineProperty(this,"lineJoin",{get:function(){return this.ctx.lineJoin},set:function(Pe){["bevel","round","miter"].indexOf(Pe)!==-1&&(this.ctx.lineJoin=Pe,this.pdf.setLineJoin(Pe))}}),Object.defineProperty(this,"miterLimit",{get:function(){return this.ctx.miterLimit},set:function(Pe){isNaN(Pe)||(this.ctx.miterLimit=Pe,this.pdf.setMiterLimit(Pe))}}),Object.defineProperty(this,"textBaseline",{get:function(){return this.ctx.textBaseline},set:function(Pe){this.ctx.textBaseline=Pe}}),Object.defineProperty(this,"textAlign",{get:function(){return this.ctx.textAlign},set:function(Pe){["right","end","center","left","start"].indexOf(Pe)!==-1&&(this.ctx.textAlign=Pe)}});var fe=null;function rt(Pe,ge){if(fe===null){var Je=function(nt){var et=[];return Object.keys(nt).forEach(function(vt){nt[vt].forEach(function(Et){var bt=null;switch(Et){case"bold":bt={family:vt,weight:"bold"};break;case"italic":bt={family:vt,style:"italic"};break;case"bolditalic":bt={family:vt,weight:"bold",style:"italic"};break;case"":case"normal":bt={family:vt}}bt!==null&&(bt.ref={name:vt,style:Et},et.push(bt))})}),et}(Pe.getFontList());fe=function(nt){for(var et={},vt=0;vt<nt.length;++vt){var Et=_x(nt[vt]),bt=Et.family,Mt=Et.stretch,Dt=Et.style,qt=Et.weight;et[bt]=et[bt]||{},et[bt][Mt]=et[bt][Mt]||{},et[bt][Mt][Dt]=et[bt][Mt][Dt]||{},et[bt][Mt][Dt][qt]=Et}return et}(Je.concat(ge))}return fe}var ot=null;Object.defineProperty(this,"fontFaces",{get:function(){return ot},set:function(Pe){fe=null,ot=Pe}}),Object.defineProperty(this,"font",{get:function(){return this.ctx.font},set:function(Pe){var ge;if(this.ctx.font=Pe,(ge=/^\s*(?=(?:(?:[-a-z]+\s*){0,2}(italic|oblique))?)(?=(?:(?:[-a-z]+\s*){0,2}(small-caps))?)(?=(?:(?:[-a-z]+\s*){0,2}(bold(?:er)?|lighter|[1-9]00))?)(?:(?:normal|\1|\2|\3)\s*){0,3}((?:xx?-)?(?:small|large)|medium|smaller|larger|[.\d]+(?:\%|in|[cem]m|ex|p[ctx]))(?:\s*\/\s*(normal|[.\d]+(?:\%|in|[cem]m|ex|p[ctx])))?\s*([-_,\"\'\sa-z]+?)\s*$/i.exec(Pe))!==null){var Je=ge[1];ge[2];var nt=ge[3],et=ge[4];ge[5];var vt=ge[6],Et=/^([.\d]+)((?:%|in|[cem]m|ex|p[ctx]))$/i.exec(et)[2];et=Math.floor(Et==="px"?parseFloat(et)*this.pdf.internal.scaleFactor:Et==="em"?parseFloat(et)*this.pdf.getFontSize():parseFloat(et)*this.pdf.internal.scaleFactor),this.pdf.setFontSize(et);var bt=function(Pt){var Nt,_t,or=[],Gt=Pt.trim();if(Gt==="")return m_;if(Gt in wb)return[wb[Gt]];for(;Gt!=="";){switch(_t=null,Nt=(Gt=bb(Gt)).charAt(0)){case'"':case"'":_t=vX(Gt.substring(1),Nt);break;default:_t=_X(Gt)}if(_t===null||(or.push(_t[0]),(Gt=bb(_t[1]))!==""&&Gt.charAt(0)!==","))return m_;Gt=Gt.replace(/^,/,"")}return or}(vt);if(this.fontFaces){var Mt=gX(rt(this.pdf,this.fontFaces),bt.map(function(Pt){return{family:Pt,stretch:"normal",weight:nt,style:Je}}));this.pdf.setFont(Mt.ref.name,Mt.ref.style)}else{var Dt="";(nt==="bold"||parseInt(nt,10)>=700||Je==="bold")&&(Dt="bold"),Je==="italic"&&(Dt+="italic"),Dt.length===0&&(Dt="normal");for(var qt="",Tt={arial:"Helvetica",Arial:"Helvetica",verdana:"Helvetica",Verdana:"Helvetica",helvetica:"Helvetica",Helvetica:"Helvetica","sans-serif":"Helvetica",fixed:"Courier",monospace:"Courier",terminal:"Courier",cursive:"Times",fantasy:"Times",serif:"Times"},kt=0;kt<bt.length;kt++){if(this.pdf.internal.getFont(bt[kt],Dt,{noFallback:!0,disableWarning:!0})!==void 0){qt=bt[kt];break}if(Dt==="bolditalic"&&this.pdf.internal.getFont(bt[kt],"bold",{noFallback:!0,disableWarning:!0})!==void 0)qt=bt[kt],Dt="bold";else if(this.pdf.internal.getFont(bt[kt],"normal",{noFallback:!0,disableWarning:!0})!==void 0){qt=bt[kt],Dt="normal";break}}if(qt===""){for(var zt=0;zt<bt.length;zt++)if(Tt[bt[zt]]){qt=Tt[bt[zt]];break}}qt=qt===""?"Times":qt,this.pdf.setFont(qt,Dt)}}}}),Object.defineProperty(this,"globalCompositeOperation",{get:function(){return this.ctx.globalCompositeOperation},set:function(Pe){this.ctx.globalCompositeOperation=Pe}}),Object.defineProperty(this,"globalAlpha",{get:function(){return this.ctx.globalAlpha},set:function(Pe){this.ctx.globalAlpha=Pe}}),Object.defineProperty(this,"lineDashOffset",{get:function(){return this.ctx.lineDashOffset},set:function(Pe){this.ctx.lineDashOffset=Pe,xe.call(this)}}),Object.defineProperty(this,"lineDash",{get:function(){return this.ctx.lineDash},set:function(Pe){this.ctx.lineDash=Pe,xe.call(this)}}),Object.defineProperty(this,"ignoreClearRect",{get:function(){return this.ctx.ignoreClearRect},set:function(Pe){this.ctx.ignoreClearRect=!!Pe}})};g.prototype.setLineDash=function(L){this.lineDash=L},g.prototype.getLineDash=function(){return this.lineDash.length%2?this.lineDash.concat(this.lineDash):this.lineDash.slice()},g.prototype.fill=function(){Q.call(this,"fill",!1)},g.prototype.stroke=function(){Q.call(this,"stroke",!1)},g.prototype.beginPath=function(){this.path=[{type:"begin"}]},g.prototype.moveTo=function(L,j){if(isNaN(L)||isNaN(j))throw Ln.error("jsPDF.context2d.moveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.moveTo");var z=this.ctx.transform.applyToPoint(new o(L,j));this.path.push({type:"mt",x:z.x,y:z.y}),this.ctx.lastPoint=new o(L,j)},g.prototype.closePath=function(){var L=new o(0,0),j=0;for(j=this.path.length-1;j!==-1;j--)if(this.path[j].type==="begin"&&Sn(this.path[j+1])==="object"&&typeof this.path[j+1].x=="number"){L=new o(this.path[j+1].x,this.path[j+1].y);break}this.path.push({type:"close"}),this.ctx.lastPoint=new o(L.x,L.y)},g.prototype.lineTo=function(L,j){if(isNaN(L)||isNaN(j))throw Ln.error("jsPDF.context2d.lineTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.lineTo");var z=this.ctx.transform.applyToPoint(new o(L,j));this.path.push({type:"lt",x:z.x,y:z.y}),this.ctx.lastPoint=new o(z.x,z.y)},g.prototype.clip=function(){this.ctx.clip_path=JSON.parse(JSON.stringify(this.path)),Q.call(this,null,!0)},g.prototype.quadraticCurveTo=function(L,j,z,G){if(isNaN(z)||isNaN(G)||isNaN(L)||isNaN(j))throw Ln.error("jsPDF.context2d.quadraticCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.quadraticCurveTo");var ae=this.ctx.transform.applyToPoint(new o(z,G)),Ae=this.ctx.transform.applyToPoint(new o(L,j));this.path.push({type:"qct",x1:Ae.x,y1:Ae.y,x:ae.x,y:ae.y}),this.ctx.lastPoint=new o(ae.x,ae.y)},g.prototype.bezierCurveTo=function(L,j,z,G,ae,Ae){if(isNaN(ae)||isNaN(Ae)||isNaN(L)||isNaN(j)||isNaN(z)||isNaN(G))throw Ln.error("jsPDF.context2d.bezierCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.bezierCurveTo");var _e=this.ctx.transform.applyToPoint(new o(ae,Ae)),Ee=this.ctx.transform.applyToPoint(new o(L,j)),Ce=this.ctx.transform.applyToPoint(new o(z,G));this.path.push({type:"bct",x1:Ee.x,y1:Ee.y,x2:Ce.x,y2:Ce.y,x:_e.x,y:_e.y}),this.ctx.lastPoint=new o(_e.x,_e.y)},g.prototype.arc=function(L,j,z,G,ae,Ae){if(isNaN(L)||isNaN(j)||isNaN(z)||isNaN(G)||isNaN(ae))throw Ln.error("jsPDF.context2d.arc: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.arc");if(Ae=!!Ae,!this.ctx.transform.isIdentity){var _e=this.ctx.transform.applyToPoint(new o(L,j));L=_e.x,j=_e.y;var Ee=this.ctx.transform.applyToPoint(new o(0,z)),Ce=this.ctx.transform.applyToPoint(new o(0,0));z=Math.sqrt(Math.pow(Ee.x-Ce.x,2)+Math.pow(Ee.y-Ce.y,2))}Math.abs(ae-G)>=2*Math.PI&&(G=0,ae=2*Math.PI),this.path.push({type:"arc",x:L,y:j,radius:z,startAngle:G,endAngle:ae,counterclockwise:Ae})},g.prototype.arcTo=function(L,j,z,G,ae){throw new Error("arcTo not implemented.")},g.prototype.rect=function(L,j,z,G){if(isNaN(L)||isNaN(j)||isNaN(z)||isNaN(G))throw Ln.error("jsPDF.context2d.rect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rect");this.moveTo(L,j),this.lineTo(L+z,j),this.lineTo(L+z,j+G),this.lineTo(L,j+G),this.lineTo(L,j),this.lineTo(L+z,j),this.lineTo(L,j)},g.prototype.fillRect=function(L,j,z,G){if(isNaN(L)||isNaN(j)||isNaN(z)||isNaN(G))throw Ln.error("jsPDF.context2d.fillRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillRect");if(!_.call(this)){var ae={};this.lineCap!=="butt"&&(ae.lineCap=this.lineCap,this.lineCap="butt"),this.lineJoin!=="miter"&&(ae.lineJoin=this.lineJoin,this.lineJoin="miter"),this.beginPath(),this.rect(L,j,z,G),this.fill(),ae.hasOwnProperty("lineCap")&&(this.lineCap=ae.lineCap),ae.hasOwnProperty("lineJoin")&&(this.lineJoin=ae.lineJoin)}},g.prototype.strokeRect=function(L,j,z,G){if(isNaN(L)||isNaN(j)||isNaN(z)||isNaN(G))throw Ln.error("jsPDF.context2d.strokeRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeRect");b.call(this)||(this.beginPath(),this.rect(L,j,z,G),this.stroke())},g.prototype.clearRect=function(L,j,z,G){if(isNaN(L)||isNaN(j)||isNaN(z)||isNaN(G))throw Ln.error("jsPDF.context2d.clearRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.clearRect");this.ignoreClearRect||(this.fillStyle="#ffffff",this.fillRect(L,j,z,G))},g.prototype.save=function(L){L=typeof L!="boolean"||L;for(var j=this.pdf.internal.getCurrentPageInfo().pageNumber,z=0;z<this.pdf.internal.getNumberOfPages();z++)this.pdf.setPage(z+1),this.pdf.internal.out("q");if(this.pdf.setPage(j),L){this.ctx.fontSize=this.pdf.internal.getFontSize();var G=new d(this.ctx);this.ctxStack.push(this.ctx),this.ctx=G}},g.prototype.restore=function(L){L=typeof L!="boolean"||L;for(var j=this.pdf.internal.getCurrentPageInfo().pageNumber,z=0;z<this.pdf.internal.getNumberOfPages();z++)this.pdf.setPage(z+1),this.pdf.internal.out("Q");this.pdf.setPage(j),L&&this.ctxStack.length!==0&&(this.ctx=this.ctxStack.pop(),this.fillStyle=this.ctx.fillStyle,this.strokeStyle=this.ctx.strokeStyle,this.font=this.ctx.font,this.lineCap=this.ctx.lineCap,this.lineWidth=this.ctx.lineWidth,this.lineJoin=this.ctx.lineJoin,this.lineDash=this.ctx.lineDash,this.lineDashOffset=this.ctx.lineDashOffset)},g.prototype.toDataURL=function(){throw new Error("toDataUrl not implemented.")};var x=function(L){var j,z,G,ae;if(L.isCanvasGradient===!0&&(L=L.getColor()),!L)return{r:0,g:0,b:0,a:0,style:L};if(/transparent|rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*0+\s*\)/.test(L))j=0,z=0,G=0,ae=0;else{var Ae=/rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/.exec(L);if(Ae!==null)j=parseInt(Ae[1]),z=parseInt(Ae[2]),G=parseInt(Ae[3]),ae=1;else if((Ae=/rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*([\d.]+)\s*\)/.exec(L))!==null)j=parseInt(Ae[1]),z=parseInt(Ae[2]),G=parseInt(Ae[3]),ae=parseFloat(Ae[4]);else{if(ae=1,typeof L=="string"&&L.charAt(0)!=="#"){var _e=new Uk(L);L=_e.ok?_e.toHex():"#000000"}L.length===4?(j=L.substring(1,2),j+=j,z=L.substring(2,3),z+=z,G=L.substring(3,4),G+=G):(j=L.substring(1,3),z=L.substring(3,5),G=L.substring(5,7)),j=parseInt(j,16),z=parseInt(z,16),G=parseInt(G,16)}}return{r:j,g:z,b:G,a:ae,style:L}},_=function(){return this.ctx.isFillTransparent||this.globalAlpha==0},b=function(){return!!(this.ctx.isStrokeTransparent||this.globalAlpha==0)};g.prototype.fillText=function(L,j,z,G){if(isNaN(j)||isNaN(z)||typeof L!="string")throw Ln.error("jsPDF.context2d.fillText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillText");if(G=isNaN(G)?void 0:G,!_.call(this)){var ae=oe(this.ctx.transform.rotation),Ae=this.ctx.transform.scaleX;C.call(this,{text:L,x:j,y:z,scale:Ae,angle:ae,align:this.textAlign,maxWidth:G})}},g.prototype.strokeText=function(L,j,z,G){if(isNaN(j)||isNaN(z)||typeof L!="string")throw Ln.error("jsPDF.context2d.strokeText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeText");if(!b.call(this)){G=isNaN(G)?void 0:G;var ae=oe(this.ctx.transform.rotation),Ae=this.ctx.transform.scaleX;C.call(this,{text:L,x:j,y:z,scale:Ae,renderingMode:"stroke",angle:ae,align:this.textAlign,maxWidth:G})}},g.prototype.measureText=function(L){if(typeof L!="string")throw Ln.error("jsPDF.context2d.measureText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.measureText");var j=this.pdf,z=this.pdf.internal.scaleFactor,G=j.internal.getFontSize(),ae=j.getStringUnitWidth(L)*G/j.internal.scaleFactor,Ae=function(_e){var Ee=(_e=_e||{}).width||0;return Object.defineProperty(this,"width",{get:function(){return Ee}}),this};return new Ae({width:ae*=Math.round(96*z/72*1e4)/1e4})},g.prototype.scale=function(L,j){if(isNaN(L)||isNaN(j))throw Ln.error("jsPDF.context2d.scale: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.scale");var z=new u(L,0,0,j,0,0);this.ctx.transform=this.ctx.transform.multiply(z)},g.prototype.rotate=function(L){if(isNaN(L))throw Ln.error("jsPDF.context2d.rotate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rotate");var j=new u(Math.cos(L),Math.sin(L),-Math.sin(L),Math.cos(L),0,0);this.ctx.transform=this.ctx.transform.multiply(j)},g.prototype.translate=function(L,j){if(isNaN(L)||isNaN(j))throw Ln.error("jsPDF.context2d.translate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.translate");var z=new u(1,0,0,1,L,j);this.ctx.transform=this.ctx.transform.multiply(z)},g.prototype.transform=function(L,j,z,G,ae,Ae){if(isNaN(L)||isNaN(j)||isNaN(z)||isNaN(G)||isNaN(ae)||isNaN(Ae))throw Ln.error("jsPDF.context2d.transform: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.transform");var _e=new u(L,j,z,G,ae,Ae);this.ctx.transform=this.ctx.transform.multiply(_e)},g.prototype.setTransform=function(L,j,z,G,ae,Ae){L=isNaN(L)?1:L,j=isNaN(j)?0:j,z=isNaN(z)?0:z,G=isNaN(G)?1:G,ae=isNaN(ae)?0:ae,Ae=isNaN(Ae)?0:Ae,this.ctx.transform=new u(L,j,z,G,ae,Ae)};var E=function(){return this.margin[0]>0||this.margin[1]>0||this.margin[2]>0||this.margin[3]>0};g.prototype.drawImage=function(L,j,z,G,ae,Ae,_e,Ee,Ce){var Oe=this.pdf.getImageProperties(L),fe=1,rt=1,ot=1,Pe=1;G!==void 0&&Ee!==void 0&&(ot=Ee/G,Pe=Ce/ae,fe=Oe.width/G*Ee/G,rt=Oe.height/ae*Ce/ae),Ae===void 0&&(Ae=j,_e=z,j=0,z=0),G!==void 0&&Ee===void 0&&(Ee=G,Ce=ae),G===void 0&&Ee===void 0&&(Ee=Oe.width,Ce=Oe.height);for(var ge,Je=this.ctx.transform.decompose(),nt=oe(Je.rotate.shx),et=new u,vt=(et=(et=(et=et.multiply(Je.translate)).multiply(Je.skew)).multiply(Je.scale)).applyToRectangle(new c(Ae-j*ot,_e-z*Pe,G*fe,ae*rt)),Et=A.call(this,vt),bt=[],Mt=0;Mt<Et.length;Mt+=1)bt.indexOf(Et[Mt])===-1&&bt.push(Et[Mt]);if(B(bt),this.autoPaging)for(var Dt=bt[0],qt=bt[bt.length-1],Tt=Dt;Tt<qt+1;Tt++){this.pdf.setPage(Tt);var kt=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],zt=Tt===1?this.posY+this.margin[0]:this.margin[0],Pt=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],Nt=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],_t=Tt===1?0:Pt+(Tt-2)*Nt;if(this.ctx.clip_path.length!==0){var or=this.path;ge=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=M(ge,this.posX+this.margin[3],-_t+zt+this.ctx.prevPageLastElemOffset),ee.call(this,"fill",!0),this.path=or}var Gt=JSON.parse(JSON.stringify(vt));Gt=M([Gt],this.posX+this.margin[3],-_t+zt+this.ctx.prevPageLastElemOffset)[0];var zr=(Tt>Dt||Tt<qt)&&E.call(this);zr&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],kt,Nt,null).clip().discardPath()),this.pdf.addImage(L,"JPEG",Gt.x,Gt.y,Gt.w,Gt.h,null,null,nt),zr&&this.pdf.restoreGraphicsState()}else this.pdf.addImage(L,"JPEG",vt.x,vt.y,vt.w,vt.h,null,null,nt)};var A=function(L,j,z){var G=[];j=j||this.pdf.internal.pageSize.width,z=z||this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2];var ae=this.posY+this.ctx.prevPageLastElemOffset;switch(L.type){default:case"mt":case"lt":G.push(Math.floor((L.y+ae)/z)+1);break;case"arc":G.push(Math.floor((L.y+ae-L.radius)/z)+1),G.push(Math.floor((L.y+ae+L.radius)/z)+1);break;case"qct":var Ae=Z(this.ctx.lastPoint.x,this.ctx.lastPoint.y,L.x1,L.y1,L.x,L.y);G.push(Math.floor((Ae.y+ae)/z)+1),G.push(Math.floor((Ae.y+Ae.h+ae)/z)+1);break;case"bct":var _e=X(this.ctx.lastPoint.x,this.ctx.lastPoint.y,L.x1,L.y1,L.x2,L.y2,L.x,L.y);G.push(Math.floor((_e.y+ae)/z)+1),G.push(Math.floor((_e.y+_e.h+ae)/z)+1);break;case"rect":G.push(Math.floor((L.y+ae)/z)+1),G.push(Math.floor((L.y+L.h+ae)/z)+1)}for(var Ee=0;Ee<G.length;Ee+=1)for(;this.pdf.internal.getNumberOfPages()<G[Ee];)O.call(this);return G},O=function(){var L=this.fillStyle,j=this.strokeStyle,z=this.font,G=this.lineCap,ae=this.lineWidth,Ae=this.lineJoin;this.pdf.addPage(),this.fillStyle=L,this.strokeStyle=j,this.font=z,this.lineCap=G,this.lineWidth=ae,this.lineJoin=Ae},M=function(L,j,z){for(var G=0;G<L.length;G++)switch(L[G].type){case"bct":L[G].x2+=j,L[G].y2+=z;case"qct":L[G].x1+=j,L[G].y1+=z;case"mt":case"lt":case"arc":default:L[G].x+=j,L[G].y+=z}return L},B=function(L){return L.sort(function(j,z){return j-z})},Q=function(L,j){for(var z,G,ae=this.fillStyle,Ae=this.strokeStyle,_e=this.lineCap,Ee=this.lineWidth,Ce=Math.abs(Ee*this.ctx.transform.scaleX),Oe=this.lineJoin,fe=JSON.parse(JSON.stringify(this.path)),rt=JSON.parse(JSON.stringify(this.path)),ot=[],Pe=0;Pe<rt.length;Pe++)if(rt[Pe].x!==void 0)for(var ge=A.call(this,rt[Pe]),Je=0;Je<ge.length;Je+=1)ot.indexOf(ge[Je])===-1&&ot.push(ge[Je]);for(var nt=0;nt<ot.length;nt++)for(;this.pdf.internal.getNumberOfPages()<ot[nt];)O.call(this);if(B(ot),this.autoPaging)for(var et=ot[0],vt=ot[ot.length-1],Et=et;Et<vt+1;Et++){this.pdf.setPage(Et),this.fillStyle=ae,this.strokeStyle=Ae,this.lineCap=_e,this.lineWidth=Ce,this.lineJoin=Oe;var bt=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],Mt=Et===1?this.posY+this.margin[0]:this.margin[0],Dt=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],qt=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],Tt=Et===1?0:Dt+(Et-2)*qt;if(this.ctx.clip_path.length!==0){var kt=this.path;z=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=M(z,this.posX+this.margin[3],-Tt+Mt+this.ctx.prevPageLastElemOffset),ee.call(this,L,!0),this.path=kt}if(G=JSON.parse(JSON.stringify(fe)),this.path=M(G,this.posX+this.margin[3],-Tt+Mt+this.ctx.prevPageLastElemOffset),j===!1||Et===0){var zt=(Et>et||Et<vt)&&E.call(this);zt&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],bt,qt,null).clip().discardPath()),ee.call(this,L,j),zt&&this.pdf.restoreGraphicsState()}this.lineWidth=Ee}else this.lineWidth=Ce,ee.call(this,L,j),this.lineWidth=Ee;this.path=fe},ee=function(L,j){if((L!=="stroke"||j||!b.call(this))&&(L==="stroke"||j||!_.call(this))){for(var z,G,ae=[],Ae=this.path,_e=0;_e<Ae.length;_e++){var Ee=Ae[_e];switch(Ee.type){case"begin":ae.push({begin:!0});break;case"close":ae.push({close:!0});break;case"mt":ae.push({start:Ee,deltas:[],abs:[]});break;case"lt":var Ce=ae.length;if(Ae[_e-1]&&!isNaN(Ae[_e-1].x)&&(z=[Ee.x-Ae[_e-1].x,Ee.y-Ae[_e-1].y],Ce>0)){for(;Ce>=0;Ce--)if(ae[Ce-1].close!==!0&&ae[Ce-1].begin!==!0){ae[Ce-1].deltas.push(z),ae[Ce-1].abs.push(Ee);break}}break;case"bct":z=[Ee.x1-Ae[_e-1].x,Ee.y1-Ae[_e-1].y,Ee.x2-Ae[_e-1].x,Ee.y2-Ae[_e-1].y,Ee.x-Ae[_e-1].x,Ee.y-Ae[_e-1].y],ae[ae.length-1].deltas.push(z);break;case"qct":var Oe=Ae[_e-1].x+2/3*(Ee.x1-Ae[_e-1].x),fe=Ae[_e-1].y+2/3*(Ee.y1-Ae[_e-1].y),rt=Ee.x+2/3*(Ee.x1-Ee.x),ot=Ee.y+2/3*(Ee.y1-Ee.y),Pe=Ee.x,ge=Ee.y;z=[Oe-Ae[_e-1].x,fe-Ae[_e-1].y,rt-Ae[_e-1].x,ot-Ae[_e-1].y,Pe-Ae[_e-1].x,ge-Ae[_e-1].y],ae[ae.length-1].deltas.push(z);break;case"arc":ae.push({deltas:[],abs:[],arc:!0}),Array.isArray(ae[ae.length-1].abs)&&ae[ae.length-1].abs.push(Ee)}}G=j?null:L==="stroke"?"stroke":"fill";for(var Je=!1,nt=0;nt<ae.length;nt++)if(ae[nt].arc)for(var et=ae[nt].abs,vt=0;vt<et.length;vt++){var Et=et[vt];Et.type==="arc"?k.call(this,Et.x,Et.y,Et.radius,Et.startAngle,Et.endAngle,Et.counterclockwise,void 0,j,!Je):R.call(this,Et.x,Et.y),Je=!0}else if(ae[nt].close===!0)this.pdf.internal.out("h"),Je=!1;else if(ae[nt].begin!==!0){var bt=ae[nt].start.x,Mt=ae[nt].start.y;se.call(this,ae[nt].deltas,bt,Mt),Je=!0}G&&S.call(this,G),j&&U.call(this)}},he=function(L){var j=this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor,z=j*(this.pdf.internal.getLineHeightFactor()-1);switch(this.ctx.textBaseline){case"bottom":return L-z;case"top":return L+j-z;case"hanging":return L+j-2*z;case"middle":return L+j/2-z;case"ideographic":return L;case"alphabetic":default:return L}},F=function(L){return L+this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor*(this.pdf.internal.getLineHeightFactor()-1)};g.prototype.createLinearGradient=function(){var L=function(){};return L.colorStops=[],L.addColorStop=function(j,z){this.colorStops.push([j,z])},L.getColor=function(){return this.colorStops.length===0?"#000000":this.colorStops[0][1]},L.isCanvasGradient=!0,L},g.prototype.createPattern=function(){return this.createLinearGradient()},g.prototype.createRadialGradient=function(){return this.createLinearGradient()};var k=function(L,j,z,G,ae,Ae,_e,Ee,Ce){for(var Oe=J.call(this,z,G,ae,Ae),fe=0;fe<Oe.length;fe++){var rt=Oe[fe];fe===0&&(Ce?I.call(this,rt.x1+L,rt.y1+j):R.call(this,rt.x1+L,rt.y1+j)),ne.call(this,L,j,rt.x2,rt.y2,rt.x3,rt.y3,rt.x4,rt.y4)}Ee?U.call(this):S.call(this,_e)},S=function(L){switch(L){case"stroke":this.pdf.internal.out("S");break;case"fill":this.pdf.internal.out("f")}},U=function(){this.pdf.clip(),this.pdf.discardPath()},I=function(L,j){this.pdf.internal.out(r(L)+" "+n(j)+" m")},C=function(L){var j;switch(L.align){case"right":case"end":j="right";break;case"center":j="center";break;case"left":case"start":default:j="left"}var z=this.pdf.getTextDimensions(L.text),G=he.call(this,L.y),ae=F.call(this,G)-z.h,Ae=this.ctx.transform.applyToPoint(new o(L.x,G)),_e=this.ctx.transform.decompose(),Ee=new u;Ee=(Ee=(Ee=Ee.multiply(_e.translate)).multiply(_e.skew)).multiply(_e.scale);for(var Ce,Oe,fe,rt=this.ctx.transform.applyToRectangle(new c(L.x,G,z.w,z.h)),ot=Ee.applyToRectangle(new c(L.x,ae,z.w,z.h)),Pe=A.call(this,ot),ge=[],Je=0;Je<Pe.length;Je+=1)ge.indexOf(Pe[Je])===-1&&ge.push(Pe[Je]);if(B(ge),this.autoPaging)for(var nt=ge[0],et=ge[ge.length-1],vt=nt;vt<et+1;vt++){this.pdf.setPage(vt);var Et=vt===1?this.posY+this.margin[0]:this.margin[0],bt=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],Mt=this.pdf.internal.pageSize.height-this.margin[2],Dt=Mt-this.margin[0],qt=this.pdf.internal.pageSize.width-this.margin[1],Tt=qt-this.margin[3],kt=vt===1?0:bt+(vt-2)*Dt;if(this.ctx.clip_path.length!==0){var zt=this.path;Ce=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=M(Ce,this.posX+this.margin[3],-1*kt+Et),ee.call(this,"fill",!0),this.path=zt}var Pt=M([JSON.parse(JSON.stringify(ot))],this.posX+this.margin[3],-kt+Et+this.ctx.prevPageLastElemOffset)[0];L.scale>=.01&&(Oe=this.pdf.internal.getFontSize(),this.pdf.setFontSize(Oe*L.scale),fe=this.lineWidth,this.lineWidth=fe*L.scale);var Nt=this.autoPaging!=="text";if(Nt||Pt.y+Pt.h<=Mt){if(Nt||Pt.y>=Et&&Pt.x<=qt){var _t=Nt?L.text:this.pdf.splitTextToSize(L.text,L.maxWidth||qt-Pt.x)[0],or=M([JSON.parse(JSON.stringify(rt))],this.posX+this.margin[3],-kt+Et+this.ctx.prevPageLastElemOffset)[0],Gt=Nt&&(vt>nt||vt<et)&&E.call(this);Gt&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Tt,Dt,null).clip().discardPath()),this.pdf.text(_t,or.x,or.y,{angle:L.angle,align:j,renderingMode:L.renderingMode}),Gt&&this.pdf.restoreGraphicsState()}}else Pt.y<Mt&&(this.ctx.prevPageLastElemOffset+=Mt-Pt.y);L.scale>=.01&&(this.pdf.setFontSize(Oe),this.lineWidth=fe)}else L.scale>=.01&&(Oe=this.pdf.internal.getFontSize(),this.pdf.setFontSize(Oe*L.scale),fe=this.lineWidth,this.lineWidth=fe*L.scale),this.pdf.text(L.text,Ae.x+this.posX,Ae.y+this.posY,{angle:L.angle,align:j,renderingMode:L.renderingMode,maxWidth:L.maxWidth}),L.scale>=.01&&(this.pdf.setFontSize(Oe),this.lineWidth=fe)},R=function(L,j,z,G){z=z||0,G=G||0,this.pdf.internal.out(r(L+z)+" "+n(j+G)+" l")},se=function(L,j,z){return this.pdf.lines(L,j,z,null,null)},ne=function(L,j,z,G,ae,Ae,_e,Ee){this.pdf.internal.out([e(i(z+L)),e(a(G+j)),e(i(ae+L)),e(a(Ae+j)),e(i(_e+L)),e(a(Ee+j)),"c"].join(" "))},J=function(L,j,z,G){for(var ae=2*Math.PI,Ae=Math.PI/2;j>z;)j-=ae;var _e=Math.abs(z-j);_e<ae&&G&&(_e=ae-_e);for(var Ee=[],Ce=G?-1:1,Oe=j;_e>1e-5;){var fe=Oe+Ce*Math.min(_e,Ae);Ee.push(de.call(this,L,Oe,fe)),_e-=Math.abs(fe-Oe),Oe=fe}return Ee},de=function(L,j,z){var G=(z-j)/2,ae=L*Math.cos(G),Ae=L*Math.sin(G),_e=ae,Ee=-Ae,Ce=_e*_e+Ee*Ee,Oe=Ce+_e*ae+Ee*Ae,fe=4/3*(Math.sqrt(2*Ce*Oe)-Oe)/(_e*Ae-Ee*ae),rt=_e-fe*Ee,ot=Ee+fe*_e,Pe=rt,ge=-ot,Je=G+j,nt=Math.cos(Je),et=Math.sin(Je);return{x1:L*Math.cos(j),y1:L*Math.sin(j),x2:rt*nt-ot*et,y2:rt*et+ot*nt,x3:Pe*nt-ge*et,y3:Pe*et+ge*nt,x4:L*Math.cos(z),y4:L*Math.sin(z)}},oe=function(L){return 180*L/Math.PI},Z=function(L,j,z,G,ae,Ae){var _e=L+.5*(z-L),Ee=j+.5*(G-j),Ce=ae+.5*(z-ae),Oe=Ae+.5*(G-Ae),fe=Math.min(L,ae,_e,Ce),rt=Math.max(L,ae,_e,Ce),ot=Math.min(j,Ae,Ee,Oe),Pe=Math.max(j,Ae,Ee,Oe);return new c(fe,ot,rt-fe,Pe-ot)},X=function(L,j,z,G,ae,Ae,_e,Ee){var Ce,Oe,fe,rt,ot,Pe,ge,Je,nt,et,vt,Et,bt,Mt,Dt=z-L,qt=G-j,Tt=ae-z,kt=Ae-G,zt=_e-ae,Pt=Ee-Ae;for(Oe=0;Oe<41;Oe++)nt=(ge=(fe=L+(Ce=Oe/40)*Dt)+Ce*((ot=z+Ce*Tt)-fe))+Ce*(ot+Ce*(ae+Ce*zt-ot)-ge),et=(Je=(rt=j+Ce*qt)+Ce*((Pe=G+Ce*kt)-rt))+Ce*(Pe+Ce*(Ae+Ce*Pt-Pe)-Je),Oe==0?(vt=nt,Et=et,bt=nt,Mt=et):(vt=Math.min(vt,nt),Et=Math.min(Et,et),bt=Math.max(bt,nt),Mt=Math.max(Mt,et));return new c(Math.round(vt),Math.round(Et),Math.round(bt-vt),Math.round(Mt-Et))},xe=function(){if(this.prevLineDash||this.ctx.lineDash.length||this.ctx.lineDashOffset){var L,j,z=(L=this.ctx.lineDash,j=this.ctx.lineDashOffset,JSON.stringify({lineDash:L,lineDashOffset:j}));this.prevLineDash!==z&&(this.pdf.setLineDash(this.ctx.lineDash,this.ctx.lineDashOffset),this.prevLineDash=z)}}})(ar.API),function(t){var e=function(a){var o,c,u,h,d,g,x,_,b,E;for(c=[],u=0,h=(a+=o="\0\0\0\0".slice(a.length%4||4)).length;h>u;u+=4)(d=(a.charCodeAt(u)<<24)+(a.charCodeAt(u+1)<<16)+(a.charCodeAt(u+2)<<8)+a.charCodeAt(u+3))!==0?(g=(d=((d=((d=((d=(d-(E=d%85))/85)-(b=d%85))/85)-(_=d%85))/85)-(x=d%85))/85)%85,c.push(g+33,x+33,_+33,b+33,E+33)):c.push(122);return function(A,O){for(var M=O;M>0;M--)A.pop()}(c,o.length),String.fromCharCode.apply(String,c)+"~>"},r=function(a){var o,c,u,h,d,g=String,x="length",_=255,b="charCodeAt",E="slice",A="replace";for(a[E](-2),a=a[E](0,-2)[A](/\s/g,"")[A]("z","!!!!!"),u=[],h=0,d=(a+=o="uuuuu"[E](a[x]%5||5))[x];d>h;h+=5)c=52200625*(a[b](h)-33)+614125*(a[b](h+1)-33)+7225*(a[b](h+2)-33)+85*(a[b](h+3)-33)+(a[b](h+4)-33),u.push(_&c>>24,_&c>>16,_&c>>8,_&c);return function(O,M){for(var B=M;B>0;B--)O.pop()}(u,o[x]),g.fromCharCode.apply(g,u)},n=function(a){var o=new RegExp(/^([0-9A-Fa-f]{2})+$/);if((a=a.replace(/\s/g,"")).indexOf(">")!==-1&&(a=a.substr(0,a.indexOf(">"))),a.length%2&&(a+="0"),o.test(a)===!1)return"";for(var c="",u=0;u<a.length;u+=2)c+=String.fromCharCode("0x"+(a[u]+a[u+1]));return c},i=function(a){for(var o=new Uint8Array(a.length),c=a.length;c--;)o[c]=a.charCodeAt(c);return a=(o=hx(o)).reduce(function(u,h){return u+String.fromCharCode(h)},"")};t.processDataByFilters=function(a,o){var c=0,u=a||"",h=[];for(typeof(o=o||[])=="string"&&(o=[o]),c=0;c<o.length;c+=1)switch(o[c]){case"ASCII85Decode":case"/ASCII85Decode":u=r(u),h.push("/ASCII85Encode");break;case"ASCII85Encode":case"/ASCII85Encode":u=e(u),h.push("/ASCII85Decode");break;case"ASCIIHexDecode":case"/ASCIIHexDecode":u=n(u),h.push("/ASCIIHexEncode");break;case"ASCIIHexEncode":case"/ASCIIHexEncode":u=u.split("").map(function(d){return("0"+d.charCodeAt().toString(16)).slice(-2)}).join("")+">",h.push("/ASCIIHexDecode");break;case"FlateEncode":case"/FlateEncode":u=i(u),h.push("/FlateDecode");break;default:throw new Error('The filter: "'+o[c]+'" is not implemented')}return{data:u,reverseChain:h.reverse().join(" ")}}}(ar.API),function(t){t.loadFile=function(e,r,n){return function(i,a,o){a=a!==!1,o=typeof o=="function"?o:function(){};var c=void 0;try{c=function(u,h,d){var g=new XMLHttpRequest,x=0,_=function(b){var E=b.length,A=[],O=String.fromCharCode;for(x=0;x<E;x+=1)A.push(O(255&b.charCodeAt(x)));return A.join("")};if(g.open("GET",u,!h),g.overrideMimeType("text/plain; charset=x-user-defined"),h===!1&&(g.onload=function(){g.status===200?d(_(this.responseText)):d(void 0)}),g.send(null),h&&g.status===200)return _(g.responseText)}(i,a,o)}catch{}return c}(e,r,n)},t.loadImageFile=t.loadFile}(ar.API),function(t){function e(){return(cr.html2canvas?Promise.resolve(cr.html2canvas):ox(()=>import("./html2canvas.esm-BfxBtG_O.js"),[])).catch(function(o){return Promise.reject(new Error("Could not load html2canvas: "+o))}).then(function(o){return o.default?o.default:o})}function r(){return(cr.DOMPurify?Promise.resolve(cr.DOMPurify):ox(()=>import("./purify.es-CQJ0hv7W.js"),[])).catch(function(o){return Promise.reject(new Error("Could not load dompurify: "+o))}).then(function(o){return o.default?o.default:o})}var n=function(o){var c=Sn(o);return c==="undefined"?"undefined":c==="string"||o instanceof String?"string":c==="number"||o instanceof Number?"number":c==="function"||o instanceof Function?"function":o&&o.constructor===Array?"array":o&&o.nodeType===1?"element":c==="object"?"object":"unknown"},i=function(o,c){var u=document.createElement(o);for(var h in c.className&&(u.className=c.className),c.innerHTML&&c.dompurify&&(u.innerHTML=c.dompurify.sanitize(c.innerHTML)),c.style)u.style[h]=c.style[h];return u},a=function o(c){var u=Object.assign(o.convert(Promise.resolve()),JSON.parse(JSON.stringify(o.template))),h=o.convert(Promise.resolve(),u);return h=(h=h.setProgress(1,o,1,[o])).set(c)};(a.prototype=Object.create(Promise.prototype)).constructor=a,a.convert=function(o,c){return o.__proto__=c||a.prototype,o},a.template={prop:{src:null,container:null,overlay:null,canvas:null,img:null,pdf:null,pageSize:null,callback:function(){}},progress:{val:0,state:null,n:0,stack:[]},opt:{filename:"file.pdf",margin:[0,0,0,0],enableLinks:!0,x:0,y:0,html2canvas:{},jsPDF:{},backgroundColor:"transparent"}},a.prototype.from=function(o,c){return this.then(function(){switch(c=c||function(u){switch(n(u)){case"string":return"string";case"element":return u.nodeName.toLowerCase()==="canvas"?"canvas":"element";default:return"unknown"}}(o)){case"string":return this.then(r).then(function(u){return this.set({src:i("div",{innerHTML:o,dompurify:u})})});case"element":return this.set({src:o});case"canvas":return this.set({canvas:o});case"img":return this.set({img:o});default:return this.error("Unknown source type.")}})},a.prototype.to=function(o){switch(o){case"container":return this.toContainer();case"canvas":return this.toCanvas();case"img":return this.toImg();case"pdf":return this.toPdf();default:return this.error("Invalid target.")}},a.prototype.toContainer=function(){return this.thenList([function(){return this.prop.src||this.error("Cannot duplicate - no source HTML.")},function(){return this.prop.pageSize||this.setPageSize()}]).then(function(){var o={position:"relative",display:"inline-block",width:(typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?Math.max(this.prop.src.clientWidth,this.prop.src.scrollWidth,this.prop.src.offsetWidth):this.opt.windowWidth)+"px",left:0,right:0,top:0,margin:"auto",backgroundColor:this.opt.backgroundColor},c=function u(h,d){for(var g=h.nodeType===3?document.createTextNode(h.nodeValue):h.cloneNode(!1),x=h.firstChild;x;x=x.nextSibling)d!==!0&&x.nodeType===1&&x.nodeName==="SCRIPT"||g.appendChild(u(x,d));return h.nodeType===1&&(h.nodeName==="CANVAS"?(g.width=h.width,g.height=h.height,g.getContext("2d").drawImage(h,0,0)):h.nodeName!=="TEXTAREA"&&h.nodeName!=="SELECT"||(g.value=h.value),g.addEventListener("load",function(){g.scrollTop=h.scrollTop,g.scrollLeft=h.scrollLeft},!0)),g}(this.prop.src,this.opt.html2canvas.javascriptEnabled);c.tagName==="BODY"&&(o.height=Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight)+"px"),this.prop.overlay=i("div",{className:"html2pdf__overlay",style:{position:"fixed",overflow:"hidden",zIndex:1e3,left:"-100000px",right:0,bottom:0,top:0}}),this.prop.container=i("div",{className:"html2pdf__container",style:o}),this.prop.container.appendChild(c),this.prop.container.firstChild.appendChild(i("div",{style:{clear:"both",border:"0 none transparent",margin:0,padding:0,height:0}})),this.prop.container.style.float="none",this.prop.overlay.appendChild(this.prop.container),document.body.appendChild(this.prop.overlay),this.prop.container.firstChild.style.position="relative",this.prop.container.height=Math.max(this.prop.container.firstChild.clientHeight,this.prop.container.firstChild.scrollHeight,this.prop.container.firstChild.offsetHeight)+"px"})},a.prototype.toCanvas=function(){var o=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(o).then(e).then(function(c){var u=Object.assign({},this.opt.html2canvas);return delete u.onrendered,c(this.prop.container,u)}).then(function(c){(this.opt.html2canvas.onrendered||function(){})(c),this.prop.canvas=c,document.body.removeChild(this.prop.overlay)})},a.prototype.toContext2d=function(){var o=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(o).then(e).then(function(c){var u=this.opt.jsPDF,h=this.opt.fontFaces,d=typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?1:this.opt.width/this.opt.windowWidth,g=Object.assign({async:!0,allowTaint:!0,scale:d,scrollX:this.opt.scrollX||0,scrollY:this.opt.scrollY||0,backgroundColor:"#ffffff",imageTimeout:15e3,logging:!0,proxy:null,removeContainer:!0,foreignObjectRendering:!1,useCORS:!1},this.opt.html2canvas);if(delete g.onrendered,u.context2d.autoPaging=this.opt.autoPaging===void 0||this.opt.autoPaging,u.context2d.posX=this.opt.x,u.context2d.posY=this.opt.y,u.context2d.margin=this.opt.margin,u.context2d.fontFaces=h,h)for(var x=0;x<h.length;++x){var _=h[x],b=_.src.find(function(E){return E.format==="truetype"});b&&u.addFont(b.url,_.ref.name,_.ref.style)}return g.windowHeight=g.windowHeight||0,g.windowHeight=g.windowHeight==0?Math.max(this.prop.container.clientHeight,this.prop.container.scrollHeight,this.prop.container.offsetHeight):g.windowHeight,u.context2d.save(!0),c(this.prop.container,g)}).then(function(c){this.opt.jsPDF.context2d.restore(!0),(this.opt.html2canvas.onrendered||function(){})(c),this.prop.canvas=c,document.body.removeChild(this.prop.overlay)})},a.prototype.toImg=function(){return this.thenList([function(){return this.prop.canvas||this.toCanvas()}]).then(function(){var o=this.prop.canvas.toDataURL("image/"+this.opt.image.type,this.opt.image.quality);this.prop.img=document.createElement("img"),this.prop.img.src=o})},a.prototype.toPdf=function(){return this.thenList([function(){return this.toContext2d()}]).then(function(){this.prop.pdf=this.prop.pdf||this.opt.jsPDF})},a.prototype.output=function(o,c,u){return(u=u||"pdf").toLowerCase()==="img"||u.toLowerCase()==="image"?this.outputImg(o,c):this.outputPdf(o,c)},a.prototype.outputPdf=function(o,c){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){return this.prop.pdf.output(o,c)})},a.prototype.outputImg=function(o){return this.thenList([function(){return this.prop.img||this.toImg()}]).then(function(){switch(o){case void 0:case"img":return this.prop.img;case"datauristring":case"dataurlstring":return this.prop.img.src;case"datauri":case"dataurl":return document.location.href=this.prop.img.src;default:throw'Image output type "'+o+'" is not supported.'}})},a.prototype.save=function(o){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).set(o?{filename:o}:null).then(function(){this.prop.pdf.save(this.opt.filename)})},a.prototype.doCallback=function(){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){this.prop.callback(this.prop.pdf)})},a.prototype.set=function(o){if(n(o)!=="object")return this;var c=Object.keys(o||{}).map(function(u){if(u in a.template.prop)return function(){this.prop[u]=o[u]};switch(u){case"margin":return this.setMargin.bind(this,o.margin);case"jsPDF":return function(){return this.opt.jsPDF=o.jsPDF,this.setPageSize()};case"pageSize":return this.setPageSize.bind(this,o.pageSize);default:return function(){this.opt[u]=o[u]}}},this);return this.then(function(){return this.thenList(c)})},a.prototype.get=function(o,c){return this.then(function(){var u=o in a.template.prop?this.prop[o]:this.opt[o];return c?c(u):u})},a.prototype.setMargin=function(o){return this.then(function(){switch(n(o)){case"number":o=[o,o,o,o];case"array":if(o.length===2&&(o=[o[0],o[1],o[0],o[1]]),o.length===4)break;default:return this.error("Invalid margin array.")}this.opt.margin=o}).then(this.setPageSize)},a.prototype.setPageSize=function(o){function c(u,h){return Math.floor(u*h/72*96)}return this.then(function(){(o=o||ar.getPageSize(this.opt.jsPDF)).hasOwnProperty("inner")||(o.inner={width:o.width-this.opt.margin[1]-this.opt.margin[3],height:o.height-this.opt.margin[0]-this.opt.margin[2]},o.inner.px={width:c(o.inner.width,o.k),height:c(o.inner.height,o.k)},o.inner.ratio=o.inner.height/o.inner.width),this.prop.pageSize=o})},a.prototype.setProgress=function(o,c,u,h){return o!=null&&(this.progress.val=o),c!=null&&(this.progress.state=c),u!=null&&(this.progress.n=u),h!=null&&(this.progress.stack=h),this.progress.ratio=this.progress.val/this.progress.state,this},a.prototype.updateProgress=function(o,c,u,h){return this.setProgress(o?this.progress.val+o:null,c||null,u?this.progress.n+u:null,h?this.progress.stack.concat(h):null)},a.prototype.then=function(o,c){var u=this;return this.thenCore(o,c,function(h,d){return u.updateProgress(null,null,1,[h]),Promise.prototype.then.call(this,function(g){return u.updateProgress(null,h),g}).then(h,d).then(function(g){return u.updateProgress(1),g})})},a.prototype.thenCore=function(o,c,u){u=u||Promise.prototype.then,o&&(o=o.bind(this)),c&&(c=c.bind(this));var h=Promise.toString().indexOf("[native code]")!==-1&&Promise.name==="Promise"?this:a.convert(Object.assign({},this),Promise.prototype),d=u.call(h,o,c);return a.convert(d,this.__proto__)},a.prototype.thenExternal=function(o,c){return Promise.prototype.then.call(this,o,c)},a.prototype.thenList=function(o){var c=this;return o.forEach(function(u){c=c.thenCore(u)}),c},a.prototype.catch=function(o){o&&(o=o.bind(this));var c=Promise.prototype.catch.call(this,o);return a.convert(c,this)},a.prototype.catchExternal=function(o){return Promise.prototype.catch.call(this,o)},a.prototype.error=function(o){return this.then(function(){throw new Error(o)})},a.prototype.using=a.prototype.set,a.prototype.saveAs=a.prototype.save,a.prototype.export=a.prototype.output,a.prototype.run=a.prototype.then,ar.getPageSize=function(o,c,u){if(Sn(o)==="object"){var h=o;o=h.orientation,c=h.unit||c,u=h.format||u}c=c||"mm",u=u||"a4",o=(""+(o||"P")).toLowerCase();var d,g=(""+u).toLowerCase(),x={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};switch(c){case"pt":d=1;break;case"mm":d=72/25.4;break;case"cm":d=72/2.54;break;case"in":d=72;break;case"px":d=.75;break;case"pc":case"em":d=12;break;case"ex":d=6;break;default:throw"Invalid unit: "+c}var _,b=0,E=0;if(x.hasOwnProperty(g))b=x[g][1]/d,E=x[g][0]/d;else try{b=u[1],E=u[0]}catch{throw new Error("Invalid format: "+u)}if(o==="p"||o==="portrait")o="p",E>b&&(_=E,E=b,b=_);else{if(o!=="l"&&o!=="landscape")throw"Invalid orientation: "+o;o="l",b>E&&(_=E,E=b,b=_)}return{width:E,height:b,unit:c,k:d,orientation:o}},t.html=function(o,c){(c=c||{}).callback=c.callback||function(){},c.html2canvas=c.html2canvas||{},c.html2canvas.canvas=c.html2canvas.canvas||this.canvas,c.jsPDF=c.jsPDF||this,c.fontFaces=c.fontFaces?c.fontFaces.map(_x):null;var u=new a(c);return c.worker?u:u.from(o).doCallback()}}(ar.API),ar.API.addJS=function(t){return Ab=t,this.internal.events.subscribe("postPutResources",function(){Mm=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/Names [(EmbeddedJS) "+(Mm+1)+" 0 R]"),this.internal.out(">>"),this.internal.out("endobj"),Sb=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /JavaScript"),this.internal.out("/JS ("+Ab+")"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){Mm!==void 0&&Sb!==void 0&&this.internal.out("/Names <</JavaScript "+Mm+" 0 R>>")}),this},function(t){var e;t.events.push(["postPutResources",function(){var r=this,n=/^(\d+) 0 obj$/;if(this.outline.root.children.length>0)for(var i=r.outline.render().split(/\r\n/),a=0;a<i.length;a++){var o=i[a],c=n.exec(o);if(c!=null){var u=c[1];r.internal.newObjectDeferredBegin(u,!1)}r.internal.write(o)}if(this.outline.createNamedDestinations){var h=this.internal.pages.length,d=[];for(a=0;a<h;a++){var g=r.internal.newObject();d.push(g);var x=r.internal.getPageInfo(a+1);r.internal.write("<< /D["+x.objId+" 0 R /XYZ null null null]>> endobj")}var _=r.internal.newObject();for(r.internal.write("<< /Names [ "),a=0;a<d.length;a++)r.internal.write("(page_"+(a+1)+")"+d[a]+" 0 R");r.internal.write(" ] >>","endobj"),e=r.internal.newObject(),r.internal.write("<< /Dests "+_+" 0 R"),r.internal.write(">>","endobj")}}]),t.events.push(["putCatalog",function(){this.outline.root.children.length>0&&(this.internal.write("/Outlines",this.outline.makeRef(this.outline.root)),this.outline.createNamedDestinations&&this.internal.write("/Names "+e+" 0 R"))}]),t.events.push(["initialized",function(){var r=this;r.outline={createNamedDestinations:!1,root:{children:[]}},r.outline.add=function(n,i,a){var o={title:i,options:a,children:[]};return n==null&&(n=this.root),n.children.push(o),o},r.outline.render=function(){return this.ctx={},this.ctx.val="",this.ctx.pdf=r,this.genIds_r(this.root),this.renderRoot(this.root),this.renderItems(this.root),this.ctx.val},r.outline.genIds_r=function(n){n.id=r.internal.newObjectDeferred();for(var i=0;i<n.children.length;i++)this.genIds_r(n.children[i])},r.outline.renderRoot=function(n){this.objStart(n),this.line("/Type /Outlines"),n.children.length>0&&(this.line("/First "+this.makeRef(n.children[0])),this.line("/Last "+this.makeRef(n.children[n.children.length-1]))),this.line("/Count "+this.count_r({count:0},n)),this.objEnd()},r.outline.renderItems=function(n){for(var i=this.ctx.pdf.internal.getVerticalCoordinateString,a=0;a<n.children.length;a++){var o=n.children[a];this.objStart(o),this.line("/Title "+this.makeString(o.title)),this.line("/Parent "+this.makeRef(n)),a>0&&this.line("/Prev "+this.makeRef(n.children[a-1])),a<n.children.length-1&&this.line("/Next "+this.makeRef(n.children[a+1])),o.children.length>0&&(this.line("/First "+this.makeRef(o.children[0])),this.line("/Last "+this.makeRef(o.children[o.children.length-1])));var c=this.count=this.count_r({count:0},o);if(c>0&&this.line("/Count "+c),o.options&&o.options.pageNumber){var u=r.internal.getPageInfo(o.options.pageNumber);this.line("/Dest ["+u.objId+" 0 R /XYZ 0 "+i(0)+" 0]")}this.objEnd()}for(var h=0;h<n.children.length;h++)this.renderItems(n.children[h])},r.outline.line=function(n){this.ctx.val+=n+`\r
`},r.outline.makeRef=function(n){return n.id+" 0 R"},r.outline.makeString=function(n){return"("+r.internal.pdfEscape(n)+")"},r.outline.objStart=function(n){this.ctx.val+=`\r
`+n.id+` 0 obj\r
<<\r
`},r.outline.objEnd=function(){this.ctx.val+=`>> \r
endobj\r
`},r.outline.count_r=function(n,i){for(var a=0;a<i.children.length;a++)n.count++,this.count_r(n,i.children[a]);return n.count}}])}(ar.API),function(t){var e=[192,193,194,195,196,197,198,199];t.processJPEG=function(r,n,i,a,o,c){var u,h=this.decode.DCT_DECODE,d=null;if(typeof r=="string"||this.__addimage__.isArrayBuffer(r)||this.__addimage__.isArrayBufferView(r)){switch(r=o||r,r=this.__addimage__.isArrayBuffer(r)?new Uint8Array(r):r,(u=function(g){for(var x,_=256*g.charCodeAt(4)+g.charCodeAt(5),b=g.length,E={width:0,height:0,numcomponents:1},A=4;A<b;A+=2){if(A+=_,e.indexOf(g.charCodeAt(A+1))!==-1){x=256*g.charCodeAt(A+5)+g.charCodeAt(A+6),E={width:256*g.charCodeAt(A+7)+g.charCodeAt(A+8),height:x,numcomponents:g.charCodeAt(A+9)};break}_=256*g.charCodeAt(A+2)+g.charCodeAt(A+3)}return E}(r=this.__addimage__.isArrayBufferView(r)?this.__addimage__.arrayBufferToBinaryString(r):r)).numcomponents){case 1:c=this.color_spaces.DEVICE_GRAY;break;case 4:c=this.color_spaces.DEVICE_CMYK;break;case 3:c=this.color_spaces.DEVICE_RGB}d={data:r,width:u.width,height:u.height,colorSpace:c,bitsPerComponent:8,filter:h,index:n,alias:i}}return d}}(ar.API);var w0,Bm,Tb,kb,Nb,xX=function(){var t,e,r;function n(a){var o,c,u,h,d,g,x,_,b,E,A,O,M,B;for(this.data=a,this.pos=8,this.palette=[],this.imgData=[],this.transparency={},this.animation=null,this.text={},g=null;;){switch(o=this.readUInt32(),b=(function(){var Q,ee;for(ee=[],Q=0;Q<4;++Q)ee.push(String.fromCharCode(this.data[this.pos++]));return ee}).call(this).join("")){case"IHDR":this.width=this.readUInt32(),this.height=this.readUInt32(),this.bits=this.data[this.pos++],this.colorType=this.data[this.pos++],this.compressionMethod=this.data[this.pos++],this.filterMethod=this.data[this.pos++],this.interlaceMethod=this.data[this.pos++];break;case"acTL":this.animation={numFrames:this.readUInt32(),numPlays:this.readUInt32()||1/0,frames:[]};break;case"PLTE":this.palette=this.read(o);break;case"fcTL":g&&this.animation.frames.push(g),this.pos+=4,g={width:this.readUInt32(),height:this.readUInt32(),xOffset:this.readUInt32(),yOffset:this.readUInt32()},d=this.readUInt16(),h=this.readUInt16()||100,g.delay=1e3*d/h,g.disposeOp=this.data[this.pos++],g.blendOp=this.data[this.pos++],g.data=[];break;case"IDAT":case"fdAT":for(b==="fdAT"&&(this.pos+=4,o-=4),a=g?.data||this.imgData,O=0;0<=o?O<o:O>o;0<=o?++O:--O)a.push(this.data[this.pos++]);break;case"tRNS":switch(this.transparency={},this.colorType){case 3:if(u=this.palette.length/3,this.transparency.indexed=this.read(o),this.transparency.indexed.length>u)throw new Error("More transparent colors than palette size");if((E=u-this.transparency.indexed.length)>0)for(M=0;0<=E?M<E:M>E;0<=E?++M:--M)this.transparency.indexed.push(255);break;case 0:this.transparency.grayscale=this.read(o)[0];break;case 2:this.transparency.rgb=this.read(o)}break;case"tEXt":x=(A=this.read(o)).indexOf(0),_=String.fromCharCode.apply(String,A.slice(0,x)),this.text[_]=String.fromCharCode.apply(String,A.slice(x+1));break;case"IEND":return g&&this.animation.frames.push(g),this.colors=(function(){switch(this.colorType){case 0:case 3:case 4:return 1;case 2:case 6:return 3}}).call(this),this.hasAlphaChannel=(B=this.colorType)===4||B===6,c=this.colors+(this.hasAlphaChannel?1:0),this.pixelBitlength=this.bits*c,this.colorSpace=(function(){switch(this.colors){case 1:return"DeviceGray";case 3:return"DeviceRGB"}}).call(this),void(this.imgData=new Uint8Array(this.imgData));default:this.pos+=o}if(this.pos+=4,this.pos>this.data.length)throw new Error("Incomplete or corrupt PNG file")}}n.prototype.read=function(a){var o,c;for(c=[],o=0;0<=a?o<a:o>a;0<=a?++o:--o)c.push(this.data[this.pos++]);return c},n.prototype.readUInt32=function(){return this.data[this.pos++]<<24|this.data[this.pos++]<<16|this.data[this.pos++]<<8|this.data[this.pos++]},n.prototype.readUInt16=function(){return this.data[this.pos++]<<8|this.data[this.pos++]},n.prototype.decodePixels=function(a){var o=this.pixelBitlength/8,c=new Uint8Array(this.width*this.height*o),u=0,h=this;if(a==null&&(a=this.imgData),a.length===0)return new Uint8Array(0);function d(g,x,_,b){var E,A,O,M,B,Q,ee,he,F,k,S,U,I,C,R,se,ne,J,de,oe,Z,X=Math.ceil((h.width-g)/_),xe=Math.ceil((h.height-x)/b),L=h.width==X&&h.height==xe;for(C=o*X,U=L?c:new Uint8Array(C*xe),Q=a.length,I=0,A=0;I<xe&&u<Q;){switch(a[u++]){case 0:for(M=ne=0;ne<C;M=ne+=1)U[A++]=a[u++];break;case 1:for(M=J=0;J<C;M=J+=1)E=a[u++],B=M<o?0:U[A-o],U[A++]=(E+B)%256;break;case 2:for(M=de=0;de<C;M=de+=1)E=a[u++],O=(M-M%o)/o,R=I&&U[(I-1)*C+O*o+M%o],U[A++]=(R+E)%256;break;case 3:for(M=oe=0;oe<C;M=oe+=1)E=a[u++],O=(M-M%o)/o,B=M<o?0:U[A-o],R=I&&U[(I-1)*C+O*o+M%o],U[A++]=(E+Math.floor((B+R)/2))%256;break;case 4:for(M=Z=0;Z<C;M=Z+=1)E=a[u++],O=(M-M%o)/o,B=M<o?0:U[A-o],I===0?R=se=0:(R=U[(I-1)*C+O*o+M%o],se=O&&U[(I-1)*C+(O-1)*o+M%o]),ee=B+R-se,he=Math.abs(ee-B),k=Math.abs(ee-R),S=Math.abs(ee-se),F=he<=k&&he<=S?B:k<=S?R:se,U[A++]=(E+F)%256;break;default:throw new Error("Invalid filter algorithm: "+a[u-1])}if(!L){var j=((x+I*b)*h.width+g)*o,z=I*C;for(M=0;M<X;M+=1){for(var G=0;G<o;G+=1)c[j++]=U[z++];j+=(_-1)*o}}I++}}return a=QW(a),h.interlaceMethod==1?(d(0,0,8,8),d(4,0,8,8),d(0,4,4,8),d(2,0,4,4),d(0,2,2,4),d(1,0,2,2),d(0,1,1,2)):d(0,0,1,1),c},n.prototype.decodePalette=function(){var a,o,c,u,h,d,g,x,_;for(c=this.palette,d=this.transparency.indexed||[],h=new Uint8Array((d.length||0)+c.length),u=0,a=0,o=g=0,x=c.length;g<x;o=g+=3)h[u++]=c[o],h[u++]=c[o+1],h[u++]=c[o+2],h[u++]=(_=d[a++])!=null?_:255;return h},n.prototype.copyToImageData=function(a,o){var c,u,h,d,g,x,_,b,E,A,O;if(u=this.colors,E=null,c=this.hasAlphaChannel,this.palette.length&&(E=(O=this._decodedPalette)!=null?O:this._decodedPalette=this.decodePalette(),u=4,c=!0),b=(h=a.data||a).length,g=E||o,d=x=0,u===1)for(;d<b;)_=E?4*o[d/4]:x,A=g[_++],h[d++]=A,h[d++]=A,h[d++]=A,h[d++]=c?g[_++]:255,x=_;else for(;d<b;)_=E?4*o[d/4]:x,h[d++]=g[_++],h[d++]=g[_++],h[d++]=g[_++],h[d++]=c?g[_++]:255,x=_},n.prototype.decode=function(){var a;return a=new Uint8Array(this.width*this.height*4),this.copyToImageData(a,this.decodePixels()),a};var i=function(){if(Object.prototype.toString.call(cr)==="[object Window]"){try{e=cr.document.createElement("canvas"),r=e.getContext("2d")}catch{return!1}return!0}return!1};return i(),t=function(a){var o;if(i()===!0)return r.width=a.width,r.height=a.height,r.clearRect(0,0,a.width,a.height),r.putImageData(a,0,0),(o=new Image).src=e.toDataURL(),o;throw new Error("This method requires a Browser with Canvas-capability.")},n.prototype.decodeFrames=function(a){var o,c,u,h,d,g,x,_;if(this.animation){for(_=[],c=d=0,g=(x=this.animation.frames).length;d<g;c=++d)o=x[c],u=a.createImageData(o.width,o.height),h=this.decodePixels(new Uint8Array(o.data)),this.copyToImageData(u,h),o.imageData=u,_.push(o.image=t(u));return _}},n.prototype.renderFrame=function(a,o){var c,u,h;return c=(u=this.animation.frames)[o],h=u[o-1],o===0&&a.clearRect(0,0,this.width,this.height),h?.disposeOp===1?a.clearRect(h.xOffset,h.yOffset,h.width,h.height):h?.disposeOp===2&&a.putImageData(h.imageData,h.xOffset,h.yOffset),c.blendOp===0&&a.clearRect(c.xOffset,c.yOffset,c.width,c.height),a.drawImage(c.image,c.xOffset,c.yOffset)},n.prototype.animate=function(a){var o,c,u,h,d,g,x=this;return c=0,g=this.animation,h=g.numFrames,u=g.frames,d=g.numPlays,(o=function(){var _,b;if(_=c++%h,b=u[_],x.renderFrame(a,_),h>1&&c/h<d)return x.animation._timeout=setTimeout(o,b.delay)})()},n.prototype.stopAnimation=function(){var a;return clearTimeout((a=this.animation)!=null?a._timeout:void 0)},n.prototype.render=function(a){var o,c;return a._png&&a._png.stopAnimation(),a._png=this,a.width=this.width,a.height=this.height,o=a.getContext("2d"),this.animation?(this.decodeFrames(o),this.animate(o)):(c=o.createImageData(this.width,this.height),this.copyToImageData(c,this.decodePixels()),o.putImageData(c,0,0))},n}();/**
 * @license
 *
 * Copyright (c) 2014 James Robb, https://github.com/jamesbrobb
 *
 * Permission is hereby granted, free of charge, to any person obtaining
 * a copy of this software and associated documentation files (the
 * "Software"), to deal in the Software without restriction, including
 * without limitation the rights to use, copy, modify, merge, publish,
 * distribute, sublicense, and/or sell copies of the Software, and to
 * permit persons to whom the Software is furnished to do so, subject to
 * the following conditions:
 *
 * The above copyright notice and this permission notice shall be
 * included in all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
 * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
 * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
 * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
 * LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
 * OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
 * WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
 * ====================================================================
 *//**
 * @license
 * (c) Dean McNamee <dean@gmail.com>, 2013.
 *
 * https://github.com/deanm/omggif
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to
 * deal in the Software without restriction, including without limitation the
 * rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
 * sell copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
 * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS
 * IN THE SOFTWARE.
 *
 * omggif is a JavaScript implementation of a GIF 89a encoder and decoder,
 * including animation and compression.  It does not rely on any specific
 * underlying system, so should run in the browser, Node, or Plask.
 */function yX(t){var e=0;if(t[e++]!==71||t[e++]!==73||t[e++]!==70||t[e++]!==56||(t[e++]+1&253)!=56||t[e++]!==97)throw new Error("Invalid GIF 87a/89a header.");var r=t[e++]|t[e++]<<8,n=t[e++]|t[e++]<<8,i=t[e++],a=i>>7,o=1<<(7&i)+1;t[e++],t[e++];var c=null,u=null;a&&(c=e,u=o,e+=3*o);var h=!0,d=[],g=0,x=null,_=0,b=null;for(this.width=r,this.height=n;h&&e<t.length;)switch(t[e++]){case 33:switch(t[e++]){case 255:if(t[e]!==11||t[e+1]==78&&t[e+2]==69&&t[e+3]==84&&t[e+4]==83&&t[e+5]==67&&t[e+6]==65&&t[e+7]==80&&t[e+8]==69&&t[e+9]==50&&t[e+10]==46&&t[e+11]==48&&t[e+12]==3&&t[e+13]==1&&t[e+16]==0)e+=14,b=t[e++]|t[e++]<<8,e++;else for(e+=12;;){if(!((I=t[e++])>=0))throw Error("Invalid block size");if(I===0)break;e+=I}break;case 249:if(t[e++]!==4||t[e+4]!==0)throw new Error("Invalid graphics extension block.");var E=t[e++];g=t[e++]|t[e++]<<8,x=t[e++],(1&E)==0&&(x=null),_=E>>2&7,e++;break;case 254:for(;;){if(!((I=t[e++])>=0))throw Error("Invalid block size");if(I===0)break;e+=I}break;default:throw new Error("Unknown graphic control label: 0x"+t[e-1].toString(16))}break;case 44:var A=t[e++]|t[e++]<<8,O=t[e++]|t[e++]<<8,M=t[e++]|t[e++]<<8,B=t[e++]|t[e++]<<8,Q=t[e++],ee=Q>>6&1,he=1<<(7&Q)+1,F=c,k=u,S=!1;Q>>7&&(S=!0,F=e,k=he,e+=3*he);var U=e;for(e++;;){var I;if(!((I=t[e++])>=0))throw Error("Invalid block size");if(I===0)break;e+=I}d.push({x:A,y:O,width:M,height:B,has_local_palette:S,palette_offset:F,palette_size:k,data_offset:U,data_length:e-U,transparent_index:x,interlaced:!!ee,delay:g,disposal:_});break;case 59:h=!1;break;default:throw new Error("Unknown gif block: 0x"+t[e-1].toString(16))}this.numFrames=function(){return d.length},this.loopCount=function(){return b},this.frameInfo=function(C){if(C<0||C>=d.length)throw new Error("Frame index out of range.");return d[C]},this.decodeAndBlitFrameBGRA=function(C,R){var se=this.frameInfo(C),ne=se.width*se.height,J=new Uint8Array(ne);Cb(t,se.data_offset,J,ne);var de=se.palette_offset,oe=se.transparent_index;oe===null&&(oe=256);var Z=se.width,X=r-Z,xe=Z,L=4*(se.y*r+se.x),j=4*((se.y+se.height)*r+se.x),z=L,G=4*X;se.interlaced===!0&&(G+=4*r*7);for(var ae=8,Ae=0,_e=J.length;Ae<_e;++Ae){var Ee=J[Ae];if(xe===0&&(xe=Z,(z+=G)>=j&&(G=4*X+4*r*(ae-1),z=L+(Z+X)*(ae<<1),ae>>=1)),Ee===oe)z+=4;else{var Ce=t[de+3*Ee],Oe=t[de+3*Ee+1],fe=t[de+3*Ee+2];R[z++]=fe,R[z++]=Oe,R[z++]=Ce,R[z++]=255}--xe}},this.decodeAndBlitFrameRGBA=function(C,R){var se=this.frameInfo(C),ne=se.width*se.height,J=new Uint8Array(ne);Cb(t,se.data_offset,J,ne);var de=se.palette_offset,oe=se.transparent_index;oe===null&&(oe=256);var Z=se.width,X=r-Z,xe=Z,L=4*(se.y*r+se.x),j=4*((se.y+se.height)*r+se.x),z=L,G=4*X;se.interlaced===!0&&(G+=4*r*7);for(var ae=8,Ae=0,_e=J.length;Ae<_e;++Ae){var Ee=J[Ae];if(xe===0&&(xe=Z,(z+=G)>=j&&(G=4*X+4*r*(ae-1),z=L+(Z+X)*(ae<<1),ae>>=1)),Ee===oe)z+=4;else{var Ce=t[de+3*Ee],Oe=t[de+3*Ee+1],fe=t[de+3*Ee+2];R[z++]=Ce,R[z++]=Oe,R[z++]=fe,R[z++]=255}--xe}}}function Cb(t,e,r,n){for(var i=t[e++],a=1<<i,o=a+1,c=o+1,u=i+1,h=(1<<u)-1,d=0,g=0,x=0,_=t[e++],b=new Int32Array(4096),E=null;;){for(;d<16&&_!==0;)g|=t[e++]<<d,d+=8,_===1?_=t[e++]:--_;if(d<u)break;var A=g&h;if(g>>=u,d-=u,A!==a){if(A===o)break;for(var O=A<c?A:E,M=0,B=O;B>a;)B=b[B]>>8,++M;var Q=B;if(x+M+(O!==A?1:0)>n)return void Ln.log("Warning, gif stream longer than expected.");r[x++]=Q;var ee=x+=M;for(O!==A&&(r[x++]=Q),B=O;M--;)B=b[B],r[--ee]=255&B,B>>=8;E!==null&&c<4096&&(b[c++]=E<<8|Q,c>=h+1&&u<12&&(++u,h=h<<1|1)),E=A}else c=o+1,h=(1<<(u=i+1))-1,E=null}return x!==n&&Ln.log("Warning, gif stream shorter than expected."),r}/**
 * @license
  Copyright (c) 2008, Adobe Systems Incorporated
  All rights reserved.

  Redistribution and use in source and binary forms, with or without 
  modification, are permitted provided that the following conditions are
  met:

  * Redistributions of source code must retain the above copyright notice, 
    this list of conditions and the following disclaimer.
  
  * Redistributions in binary form must reproduce the above copyright
    notice, this list of conditions and the following disclaimer in the 
    documentation and/or other materials provided with the distribution.
  
  * Neither the name of Adobe Systems Incorporated nor the names of its 
    contributors may be used to endorse or promote products derived from 
    this software without specific prior written permission.

  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS
  IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO,
  THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
  PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR 
  CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
  EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
  PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
  PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
  SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
*/function g_(t){var e,r,n,i,a,o=Math.floor,c=new Array(64),u=new Array(64),h=new Array(64),d=new Array(64),g=new Array(65535),x=new Array(65535),_=new Array(64),b=new Array(64),E=[],A=0,O=7,M=new Array(64),B=new Array(64),Q=new Array(64),ee=new Array(256),he=new Array(2048),F=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],k=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],S=[0,1,2,3,4,5,6,7,8,9,10,11],U=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],I=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],C=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],R=[0,1,2,3,4,5,6,7,8,9,10,11],se=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],ne=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];function J(L,j){for(var z=0,G=0,ae=new Array,Ae=1;Ae<=16;Ae++){for(var _e=1;_e<=L[Ae];_e++)ae[j[G]]=[],ae[j[G]][0]=z,ae[j[G]][1]=Ae,G++,z++;z*=2}return ae}function de(L){for(var j=L[0],z=L[1]-1;z>=0;)j&1<<z&&(A|=1<<O),z--,--O<0&&(A==255?(oe(255),oe(0)):oe(A),O=7,A=0)}function oe(L){E.push(L)}function Z(L){oe(L>>8&255),oe(255&L)}function X(L,j,z,G,ae){for(var Ae,_e=ae[0],Ee=ae[240],Ce=function(et,vt){var Et,bt,Mt,Dt,qt,Tt,kt,zt,Pt,Nt,_t=0;for(Pt=0;Pt<8;++Pt){Et=et[_t],bt=et[_t+1],Mt=et[_t+2],Dt=et[_t+3],qt=et[_t+4],Tt=et[_t+5],kt=et[_t+6];var or=Et+(zt=et[_t+7]),Gt=Et-zt,zr=bt+kt,yr=bt-kt,Qr=Mt+Tt,Ii=Mt-Tt,Tr=Dt+qt,Ra=Dt-qt,hn=or+Tr,Yn=or-Tr,di=zr+Qr,Jr=zr-Qr;et[_t]=hn+di,et[_t+4]=hn-di;var Kt=.707106781*(Jr+Yn);et[_t+2]=Yn+Kt,et[_t+6]=Yn-Kt;var Dr=.382683433*((hn=Ra+Ii)-(Jr=yr+Gt)),ea=.5411961*hn+Dr,Dn=1.306562965*Jr+Dr,pi=.707106781*(di=Ii+yr),ga=Gt+pi,jt=Gt-pi;et[_t+5]=jt+ea,et[_t+3]=jt-ea,et[_t+1]=ga+Dn,et[_t+7]=ga-Dn,_t+=8}for(_t=0,Pt=0;Pt<8;++Pt){Et=et[_t],bt=et[_t+8],Mt=et[_t+16],Dt=et[_t+24],qt=et[_t+32],Tt=et[_t+40],kt=et[_t+48];var Zr=Et+(zt=et[_t+56]),Hr=Et-zt,gn=bt+kt,In=bt-kt,Fn=Mt+Tt,te=Mt-Tt,be=Dt+qt,me=Dt-qt,ve=Zr+be,we=Zr-be,Se=gn+Fn,Ve=gn-Fn;et[_t]=ve+Se,et[_t+32]=ve-Se;var $e=.707106781*(Ve+we);et[_t+16]=we+$e,et[_t+48]=we-$e;var Me=.382683433*((ve=me+te)-(Ve=In+Hr)),He=.5411961*ve+Me,Ye=1.306562965*Ve+Me,pt=.707106781*(Se=te+In),At=Hr+pt,Bt=Hr-pt;et[_t+40]=Bt+He,et[_t+24]=Bt-He,et[_t+8]=At+Ye,et[_t+56]=At-Ye,_t++}for(Pt=0;Pt<64;++Pt)Nt=et[Pt]*vt[Pt],_[Pt]=Nt>0?Nt+.5|0:Nt-.5|0;return _}(L,j),Oe=0;Oe<64;++Oe)b[F[Oe]]=Ce[Oe];var fe=b[0]-z;z=b[0],fe==0?de(G[0]):(de(G[x[Ae=32767+fe]]),de(g[Ae]));for(var rt=63;rt>0&&b[rt]==0;)rt--;if(rt==0)return de(_e),z;for(var ot,Pe=1;Pe<=rt;){for(var ge=Pe;b[Pe]==0&&Pe<=rt;)++Pe;var Je=Pe-ge;if(Je>=16){ot=Je>>4;for(var nt=1;nt<=ot;++nt)de(Ee);Je&=15}Ae=32767+b[Pe],de(ae[(Je<<4)+x[Ae]]),de(g[Ae]),Pe++}return rt!=63&&de(_e),z}function xe(L){L=Math.min(Math.max(L,1),100),a!=L&&(function(j){for(var z=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],G=0;G<64;G++){var ae=o((z[G]*j+50)/100);ae=Math.min(Math.max(ae,1),255),c[F[G]]=ae}for(var Ae=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99],_e=0;_e<64;_e++){var Ee=o((Ae[_e]*j+50)/100);Ee=Math.min(Math.max(Ee,1),255),u[F[_e]]=Ee}for(var Ce=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379],Oe=0,fe=0;fe<8;fe++)for(var rt=0;rt<8;rt++)h[Oe]=1/(c[F[Oe]]*Ce[fe]*Ce[rt]*8),d[Oe]=1/(u[F[Oe]]*Ce[fe]*Ce[rt]*8),Oe++}(L<50?Math.floor(5e3/L):Math.floor(200-2*L)),a=L)}this.encode=function(L,j){j&&xe(j),E=new Array,A=0,O=7,Z(65496),Z(65504),Z(16),oe(74),oe(70),oe(73),oe(70),oe(0),oe(1),oe(1),oe(0),Z(1),Z(1),oe(0),oe(0),function(){Z(65499),Z(132),oe(0);for(var bt=0;bt<64;bt++)oe(c[bt]);oe(1);for(var Mt=0;Mt<64;Mt++)oe(u[Mt])}(),function(bt,Mt){Z(65472),Z(17),oe(8),Z(Mt),Z(bt),oe(3),oe(1),oe(17),oe(0),oe(2),oe(17),oe(1),oe(3),oe(17),oe(1)}(L.width,L.height),function(){Z(65476),Z(418),oe(0);for(var bt=0;bt<16;bt++)oe(k[bt+1]);for(var Mt=0;Mt<=11;Mt++)oe(S[Mt]);oe(16);for(var Dt=0;Dt<16;Dt++)oe(U[Dt+1]);for(var qt=0;qt<=161;qt++)oe(I[qt]);oe(1);for(var Tt=0;Tt<16;Tt++)oe(C[Tt+1]);for(var kt=0;kt<=11;kt++)oe(R[kt]);oe(17);for(var zt=0;zt<16;zt++)oe(se[zt+1]);for(var Pt=0;Pt<=161;Pt++)oe(ne[Pt])}(),Z(65498),Z(12),oe(3),oe(1),oe(0),oe(2),oe(17),oe(3),oe(17),oe(0),oe(63),oe(0);var z=0,G=0,ae=0;A=0,O=7,this.encode.displayName="_encode_";for(var Ae,_e,Ee,Ce,Oe,fe,rt,ot,Pe,ge=L.data,Je=L.width,nt=L.height,et=4*Je,vt=0;vt<nt;){for(Ae=0;Ae<et;){for(Oe=et*vt+Ae,rt=-1,ot=0,Pe=0;Pe<64;Pe++)fe=Oe+(ot=Pe>>3)*et+(rt=4*(7&Pe)),vt+ot>=nt&&(fe-=et*(vt+1+ot-nt)),Ae+rt>=et&&(fe-=Ae+rt-et+4),_e=ge[fe++],Ee=ge[fe++],Ce=ge[fe++],M[Pe]=(he[_e]+he[Ee+256>>0]+he[Ce+512>>0]>>16)-128,B[Pe]=(he[_e+768>>0]+he[Ee+1024>>0]+he[Ce+1280>>0]>>16)-128,Q[Pe]=(he[_e+1280>>0]+he[Ee+1536>>0]+he[Ce+1792>>0]>>16)-128;z=X(M,h,z,e,n),G=X(B,d,G,r,i),ae=X(Q,d,ae,r,i),Ae+=32}vt+=8}if(O>=0){var Et=[];Et[1]=O+1,Et[0]=(1<<O+1)-1,de(Et)}return Z(65497),new Uint8Array(E)},t=t||50,function(){for(var L=String.fromCharCode,j=0;j<256;j++)ee[j]=L(j)}(),e=J(k,S),r=J(C,R),n=J(U,I),i=J(se,ne),function(){for(var L=1,j=2,z=1;z<=15;z++){for(var G=L;G<j;G++)x[32767+G]=z,g[32767+G]=[],g[32767+G][1]=z,g[32767+G][0]=G;for(var ae=-(j-1);ae<=-L;ae++)x[32767+ae]=z,g[32767+ae]=[],g[32767+ae][1]=z,g[32767+ae][0]=j-1+ae;L<<=1,j<<=1}}(),function(){for(var L=0;L<256;L++)he[L]=19595*L,he[L+256>>0]=38470*L,he[L+512>>0]=7471*L+32768,he[L+768>>0]=-11059*L,he[L+1024>>0]=-21709*L,he[L+1280>>0]=32768*L+8421375,he[L+1536>>0]=-27439*L,he[L+1792>>0]=-5329*L}(),xe(t)}/**
 * @license
 * Copyright (c) 2017 Aras Abbasi
 *
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 */function pl(t,e){if(this.pos=0,this.buffer=t,this.datav=new DataView(t.buffer),this.is_with_alpha=!!e,this.bottom_up=!0,this.flag=String.fromCharCode(this.buffer[0])+String.fromCharCode(this.buffer[1]),this.pos+=2,["BM","BA","CI","CP","IC","PT"].indexOf(this.flag)===-1)throw new Error("Invalid BMP File");this.parseHeader(),this.parseBGR()}function Ib(t){function e(k){if(!k)throw Error("assert :P")}function r(k,S,U){for(var I=0;4>I;I++)if(k[S+I]!=U.charCodeAt(I))return!0;return!1}function n(k,S,U,I,C){for(var R=0;R<C;R++)k[S+R]=U[I+R]}function i(k,S,U,I){for(var C=0;C<I;C++)k[S+C]=U}function a(k){return new Int32Array(k)}function o(k,S){for(var U=[],I=0;I<k;I++)U.push(new S);return U}function c(k,S){var U=[];return function I(C,R,se){for(var ne=se[R],J=0;J<ne&&(C.push(se.length>R+1?[]:new S),!(se.length<R+1));J++)I(C[J],R+1,se)}(U,0,k),U}var u=function(){var k=this;function S(m,w){for(var D=1<<w-1>>>0;m&D;)D>>>=1;return D?(m&D-1)+D:m}function U(m,w,D,V,Y){e(!(V%D));do m[w+(V-=D)]=Y;while(0<V)}function I(m,w,D,V,Y){if(e(2328>=Y),512>=Y)var re=a(512);else if((re=a(Y))==null)return 0;return function(ie,le,pe,ye,Ie,Ge){var qe,je,ft=le,Ze=1<<pe,Re=a(16),De=a(16);for(e(Ie!=0),e(ye!=null),e(ie!=null),e(0<pe),je=0;je<Ie;++je){if(15<ye[je])return 0;++Re[ye[je]]}if(Re[0]==Ie)return 0;for(De[1]=0,qe=1;15>qe;++qe){if(Re[qe]>1<<qe)return 0;De[qe+1]=De[qe]+Re[qe]}for(je=0;je<Ie;++je)qe=ye[je],0<ye[je]&&(Ge[De[qe]++]=je);if(De[15]==1)return(ye=new C).g=0,ye.value=Ge[0],U(ie,ft,1,Ze,ye),Ze;var at,ht=-1,ct=Ze-1,Ut=0,Lt=1,Yt=1,Ot=1<<pe;for(je=0,qe=1,Ie=2;qe<=pe;++qe,Ie<<=1){if(Lt+=Yt<<=1,0>(Yt-=Re[qe]))return 0;for(;0<Re[qe];--Re[qe])(ye=new C).g=qe,ye.value=Ge[je++],U(ie,ft+Ut,Ie,Ot,ye),Ut=S(Ut,qe)}for(qe=pe+1,Ie=2;15>=qe;++qe,Ie<<=1){if(Lt+=Yt<<=1,0>(Yt-=Re[qe]))return 0;for(;0<Re[qe];--Re[qe]){if(ye=new C,(Ut&ct)!=ht){for(ft+=Ot,at=1<<(ht=qe)-pe;15>ht&&!(0>=(at-=Re[ht]));)++ht,at<<=1;Ze+=Ot=1<<(at=ht-pe),ie[le+(ht=Ut&ct)].g=at+pe,ie[le+ht].value=ft-le-ht}ye.g=qe-pe,ye.value=Ge[je++],U(ie,ft+(Ut>>pe),Ie,Ot,ye),Ut=S(Ut,qe)}}return Lt!=2*De[15]-1?0:Ze}(m,w,D,V,Y,re)}function C(){this.value=this.g=0}function R(){this.value=this.g=0}function se(){this.G=o(5,C),this.H=a(5),this.jc=this.Qb=this.qb=this.nd=0,this.pd=o(mi,R)}function ne(m,w,D,V){e(m!=null),e(w!=null),e(2147483648>V),m.Ca=254,m.I=0,m.b=-8,m.Ka=0,m.oa=w,m.pa=D,m.Jd=w,m.Yc=D+V,m.Zc=4<=V?D+V-4+1:D,Ae(m)}function J(m,w){for(var D=0;0<w--;)D|=Ee(m,128)<<w;return D}function de(m,w){var D=J(m,w);return _e(m)?-D:D}function oe(m,w,D,V){var Y,re=0;for(e(m!=null),e(w!=null),e(4294967288>V),m.Sb=V,m.Ra=0,m.u=0,m.h=0,4<V&&(V=4),Y=0;Y<V;++Y)re+=w[D+Y]<<8*Y;m.Ra=re,m.bb=V,m.oa=w,m.pa=D}function Z(m){for(;8<=m.u&&m.bb<m.Sb;)m.Ra>>>=8,m.Ra+=m.oa[m.pa+m.bb]<<Nc-8>>>0,++m.bb,m.u-=8;z(m)&&(m.h=1,m.u=0)}function X(m,w){if(e(0<=w),!m.h&&w<=kc){var D=j(m)&Fl[w];return m.u+=w,Z(m),D}return m.h=1,m.u=0}function xe(){this.b=this.Ca=this.I=0,this.oa=[],this.pa=0,this.Jd=[],this.Yc=0,this.Zc=[],this.Ka=0}function L(){this.Ra=0,this.oa=[],this.h=this.u=this.bb=this.Sb=this.pa=0}function j(m){return m.Ra>>>(m.u&Nc-1)>>>0}function z(m){return e(m.bb<=m.Sb),m.h||m.bb==m.Sb&&m.u>Nc}function G(m,w){m.u=w,m.h=z(m)}function ae(m){m.u>=yu&&(e(m.u>=yu),Z(m))}function Ae(m){e(m!=null&&m.oa!=null),m.pa<m.Zc?(m.I=(m.oa[m.pa++]|m.I<<8)>>>0,m.b+=8):(e(m!=null&&m.oa!=null),m.pa<m.Yc?(m.b+=8,m.I=m.oa[m.pa++]|m.I<<8):m.Ka?m.b=0:(m.I<<=8,m.b+=8,m.Ka=1))}function _e(m){return J(m,1)}function Ee(m,w){var D=m.Ca;0>m.b&&Ae(m);var V=m.b,Y=D*w>>>8,re=(m.I>>>V>Y)+0;for(re?(D-=Y,m.I-=Y+1<<V>>>0):D=Y+1,V=D,Y=0;256<=V;)Y+=8,V>>=8;return V=7^Y+Ma[V],m.b-=V,m.Ca=(D<<V)-1,re}function Ce(m,w,D){m[w+0]=D>>24&255,m[w+1]=D>>16&255,m[w+2]=D>>8&255,m[w+3]=D>>0&255}function Oe(m,w){return m[w+0]<<0|m[w+1]<<8}function fe(m,w){return Oe(m,w)|m[w+2]<<16}function rt(m,w){return Oe(m,w)|Oe(m,w+2)<<16}function ot(m,w){var D=1<<w;return e(m!=null),e(0<w),m.X=a(D),m.X==null?0:(m.Mb=32-w,m.Xa=w,1)}function Pe(m,w){e(m!=null),e(w!=null),e(m.Xa==w.Xa),n(w.X,0,m.X,0,1<<w.Xa)}function ge(){this.X=[],this.Xa=this.Mb=0}function Je(m,w,D,V){e(D!=null),e(V!=null);var Y=D[0],re=V[0];return Y==0&&(Y=(m*re+w/2)/w),re==0&&(re=(w*Y+m/2)/m),0>=Y||0>=re?0:(D[0]=Y,V[0]=re,1)}function nt(m,w){return m+(1<<w)-1>>>w}function et(m,w){return((4278255360&m)+(4278255360&w)>>>0&4278255360)+((16711935&m)+(16711935&w)>>>0&16711935)>>>0}function vt(m,w){k[w]=function(D,V,Y,re,ie,le,pe){var ye;for(ye=0;ye<ie;++ye){var Ie=k[m](le[pe+ye-1],Y,re+ye);le[pe+ye]=et(D[V+ye],Ie)}}}function Et(){this.ud=this.hd=this.jd=0}function bt(m,w){return((4278124286&(m^w))>>>1)+(m&w)>>>0}function Mt(m){return 0<=m&&256>m?m:0>m?0:255<m?255:void 0}function Dt(m,w){return Mt(m+(m-w+.5>>1))}function qt(m,w,D){return Math.abs(w-D)-Math.abs(m-D)}function Tt(m,w,D,V,Y,re,ie){for(V=re[ie-1],D=0;D<Y;++D)re[ie+D]=V=et(m[w+D],V)}function kt(m,w,D,V,Y){var re;for(re=0;re<D;++re){var ie=m[w+re],le=ie>>8&255,pe=16711935&(pe=(pe=16711935&ie)+((le<<16)+le));V[Y+re]=(4278255360&ie)+pe>>>0}}function zt(m,w){w.jd=m>>0&255,w.hd=m>>8&255,w.ud=m>>16&255}function Pt(m,w,D,V,Y,re){var ie;for(ie=0;ie<V;++ie){var le=w[D+ie],pe=le>>>8,ye=le,Ie=255&(Ie=(Ie=le>>>16)+((m.jd<<24>>24)*(pe<<24>>24)>>>5));ye=255&(ye=(ye=ye+((m.hd<<24>>24)*(pe<<24>>24)>>>5))+((m.ud<<24>>24)*(Ie<<24>>24)>>>5)),Y[re+ie]=(4278255360&le)+(Ie<<16)+ye}}function Nt(m,w,D,V,Y){k[w]=function(re,ie,le,pe,ye,Ie,Ge,qe,je){for(pe=Ge;pe<qe;++pe)for(Ge=0;Ge<je;++Ge)ye[Ie++]=Y(le[V(re[ie++])])},k[m]=function(re,ie,le,pe,ye,Ie,Ge){var qe=8>>re.b,je=re.Ea,ft=re.K[0],Ze=re.w;if(8>qe)for(re=(1<<re.b)-1,Ze=(1<<qe)-1;ie<le;++ie){var Re,De=0;for(Re=0;Re<je;++Re)Re&re||(De=V(pe[ye++])),Ie[Ge++]=Y(ft[De&Ze]),De>>=qe}else k["VP8LMapColor"+D](pe,ye,ft,Ze,Ie,Ge,ie,le,je)}}function _t(m,w,D,V,Y){for(D=w+D;w<D;){var re=m[w++];V[Y++]=re>>16&255,V[Y++]=re>>8&255,V[Y++]=re>>0&255}}function or(m,w,D,V,Y){for(D=w+D;w<D;){var re=m[w++];V[Y++]=re>>16&255,V[Y++]=re>>8&255,V[Y++]=re>>0&255,V[Y++]=re>>24&255}}function Gt(m,w,D,V,Y){for(D=w+D;w<D;){var re=(ie=m[w++])>>16&240|ie>>12&15,ie=ie>>0&240|ie>>28&15;V[Y++]=re,V[Y++]=ie}}function zr(m,w,D,V,Y){for(D=w+D;w<D;){var re=(ie=m[w++])>>16&248|ie>>13&7,ie=ie>>5&224|ie>>3&31;V[Y++]=re,V[Y++]=ie}}function yr(m,w,D,V,Y){for(D=w+D;w<D;){var re=m[w++];V[Y++]=re>>0&255,V[Y++]=re>>8&255,V[Y++]=re>>16&255}}function Qr(m,w,D,V,Y,re){if(re==0)for(D=w+D;w<D;)Ce(V,((re=m[w++])[0]>>24|re[1]>>8&65280|re[2]<<8&16711680|re[3]<<24)>>>0),Y+=32;else n(V,Y,m,w,D)}function Ii(m,w){k[w][0]=k[m+"0"],k[w][1]=k[m+"1"],k[w][2]=k[m+"2"],k[w][3]=k[m+"3"],k[w][4]=k[m+"4"],k[w][5]=k[m+"5"],k[w][6]=k[m+"6"],k[w][7]=k[m+"7"],k[w][8]=k[m+"8"],k[w][9]=k[m+"9"],k[w][10]=k[m+"10"],k[w][11]=k[m+"11"],k[w][12]=k[m+"12"],k[w][13]=k[m+"13"],k[w][14]=k[m+"0"],k[w][15]=k[m+"0"]}function Tr(m){return m==jf||m==Hl||m==el||m==Su}function Ra(){this.eb=[],this.size=this.A=this.fb=0}function hn(){this.y=[],this.f=[],this.ea=[],this.F=[],this.Tc=this.Ed=this.Cd=this.Fd=this.lb=this.Db=this.Ab=this.fa=this.J=this.W=this.N=this.O=0}function Yn(){this.Rd=this.height=this.width=this.S=0,this.f={},this.f.RGBA=new Ra,this.f.kb=new hn,this.sd=null}function di(){this.width=[0],this.height=[0],this.Pd=[0],this.Qd=[0],this.format=[0]}function Jr(){this.Id=this.fd=this.Md=this.hb=this.ib=this.da=this.bd=this.cd=this.j=this.v=this.Da=this.Sd=this.ob=0}function Kt(m){return alert("todo:WebPSamplerProcessPlane"),m.T}function Dr(m,w){var D=m.T,V=w.ba.f.RGBA,Y=V.eb,re=V.fb+m.ka*V.A,ie=Oi[w.ba.S],le=m.y,pe=m.O,ye=m.f,Ie=m.N,Ge=m.ea,qe=m.W,je=w.cc,ft=w.dc,Ze=w.Mc,Re=w.Nc,De=m.ka,at=m.ka+m.T,ht=m.U,ct=ht+1>>1;for(De==0?ie(le,pe,null,null,ye,Ie,Ge,qe,ye,Ie,Ge,qe,Y,re,null,null,ht):(ie(w.ec,w.fc,le,pe,je,ft,Ze,Re,ye,Ie,Ge,qe,Y,re-V.A,Y,re,ht),++D);De+2<at;De+=2)je=ye,ft=Ie,Ze=Ge,Re=qe,Ie+=m.Rc,qe+=m.Rc,re+=2*V.A,ie(le,(pe+=2*m.fa)-m.fa,le,pe,je,ft,Ze,Re,ye,Ie,Ge,qe,Y,re-V.A,Y,re,ht);return pe+=m.fa,m.j+at<m.o?(n(w.ec,w.fc,le,pe,ht),n(w.cc,w.dc,ye,Ie,ct),n(w.Mc,w.Nc,Ge,qe,ct),D--):1&at||ie(le,pe,null,null,ye,Ie,Ge,qe,ye,Ie,Ge,qe,Y,re+V.A,null,null,ht),D}function ea(m,w,D){var V=m.F,Y=[m.J];if(V!=null){var re=m.U,ie=w.ba.S,le=ie==Dc||ie==el;w=w.ba.f.RGBA;var pe=[0],ye=m.ka;pe[0]=m.T,m.Kb&&(ye==0?--pe[0]:(--ye,Y[0]-=m.width),m.j+m.ka+m.T==m.o&&(pe[0]=m.o-m.j-ye));var Ie=w.eb;ye=w.fb+ye*w.A,m=Ir(V,Y[0],m.width,re,pe,Ie,ye+(le?0:3),w.A),e(D==pe),m&&Tr(ie)&&os(Ie,ye,le,re,pe,w.A)}return 0}function Dn(m){var w=m.ma,D=w.ba.S,V=11>D,Y=D==bu||D==Bf||D==Dc||D==Zo||D==12||Tr(D);if(w.memory=null,w.Ib=null,w.Jb=null,w.Nd=null,!Dl(w.Oa,m,Y?11:12))return 0;if(Y&&Tr(D)&&yt(),m.da)alert("todo:use_scaling");else{if(V){if(w.Ib=Kt,m.Kb){if(D=m.U+1>>1,w.memory=a(m.U+2*D),w.memory==null)return 0;w.ec=w.memory,w.fc=0,w.cc=w.ec,w.dc=w.fc+m.U,w.Mc=w.cc,w.Nc=w.dc+D,w.Ib=Dr,yt()}}else alert("todo:EmitYUV");Y&&(w.Jb=ea,V&&Be())}if(V&&!Sp){for(m=0;256>m;++m)T2[m]=89858*(m-128)+vi>>To,qf[m]=-22014*(m-128)+vi,md[m]=-45773*(m-128),_i[m]=113618*(m-128)+vi>>To;for(m=Xl;m<Kh;++m)w=76283*(m-16)+vi>>To,zf[m-Xl]=an(w,255),gd[m-Xl]=an(w+8>>4,15);Sp=1}return 1}function pi(m){var w=m.ma,D=m.U,V=m.T;return e(!(1&m.ka)),0>=D||0>=V?0:(D=w.Ib(m,w),w.Jb!=null&&w.Jb(m,w,D),w.Dc+=D,1)}function ga(m){m.ma.memory=null}function jt(m,w,D,V){return X(m,8)!=47?0:(w[0]=X(m,14)+1,D[0]=X(m,14)+1,V[0]=X(m,1),X(m,3)!=0?0:!m.h)}function Zr(m,w){if(4>m)return m+1;var D=m-2>>1;return(2+(1&m)<<D)+X(w,D)+1}function Hr(m,w){return 120<w?w-120:1<=(D=((D=rl[w-1])>>4)*m+(8-(15&D)))?D:1;var D}function gn(m,w,D){var V=j(D),Y=m[w+=255&V].g-8;return 0<Y&&(G(D,D.u+8),V=j(D),w+=m[w].value,w+=V&(1<<Y)-1),G(D,D.u+m[w].g),m[w].value}function In(m,w,D){return D.g+=m.g,D.value+=m.value<<w>>>0,e(8>=D.g),m.g}function Fn(m,w,D){var V=m.xc;return e((w=V==0?0:m.vc[m.md*(D>>V)+(w>>V)])<m.Wb),m.Ya[w]}function te(m,w,D,V){var Y=m.ab,re=m.c*w,ie=m.C;w=ie+w;var le=D,pe=V;for(V=m.Ta,D=m.Ua;0<Y--;){var ye=m.gc[Y],Ie=ie,Ge=w,qe=le,je=pe,ft=(pe=V,le=D,ye.Ea);switch(e(Ie<Ge),e(Ge<=ye.nc),ye.hc){case 2:qh(qe,je,(Ge-Ie)*ft,pe,le);break;case 0:var Ze=Ie,Re=Ge,De=pe,at=le,ht=(Ot=ye).Ea;Ze==0&&(dd(qe,je,null,null,1,De,at),Tt(qe,je+1,0,0,ht-1,De,at+1),je+=ht,at+=ht,++Ze);for(var ct=1<<Ot.b,Ut=ct-1,Lt=nt(ht,Ot.b),Yt=Ot.K,Ot=Ot.w+(Ze>>Ot.b)*Lt;Ze<Re;){var Xr=Yt,sn=Ot,Ar=1;for(Pf(qe,je,De,at-ht,1,De,at);Ar<ht;){var Er=(Ar&~Ut)+ct;Er>ht&&(Er=ht),(0,$o[Xr[sn++]>>8&15])(qe,je+ +Ar,De,at+Ar-ht,Er-Ar,De,at+Ar),Ar=Er}je+=ht,at+=ht,++Ze&Ut||(Ot+=Lt)}Ge!=ye.nc&&n(pe,le-ft,pe,le+(Ge-Ie-1)*ft,ft);break;case 1:for(ft=qe,Re=je,ht=(qe=ye.Ea)-(at=qe&~(De=(je=1<<ye.b)-1)),Ze=nt(qe,ye.b),ct=ye.K,ye=ye.w+(Ie>>ye.b)*Ze;Ie<Ge;){for(Ut=ct,Lt=ye,Yt=new Et,Ot=Re+at,Xr=Re+qe;Re<Ot;)zt(Ut[Lt++],Yt),Pl(Yt,ft,Re,je,pe,le),Re+=je,le+=je;Re<Xr&&(zt(Ut[Lt++],Yt),Pl(Yt,ft,Re,ht,pe,le),Re+=ht,le+=ht),++Ie&De||(ye+=Ze)}break;case 3:if(qe==pe&&je==le&&0<ye.b){for(Re=pe,qe=ft=le+(Ge-Ie)*ft-(at=(Ge-Ie)*nt(ye.Ea,ye.b)),je=pe,De=le,Ze=[],at=(ht=at)-1;0<=at;--at)Ze[at]=je[De+at];for(at=ht-1;0<=at;--at)Re[qe+at]=Ze[at];Es(ye,Ie,Ge,pe,ft,pe,le)}else Es(ye,Ie,Ge,qe,je,pe,le)}le=V,pe=D}pe!=D&&n(V,D,le,pe,re)}function be(m,w){var D=m.V,V=m.Ba+m.c*m.C,Y=w-m.C;if(e(w<=m.l.o),e(16>=Y),0<Y){var re=m.l,ie=m.Ta,le=m.Ua,pe=re.width;if(te(m,Y,D,V),Y=le=[le],e((D=m.C)<(V=w)),e(re.v<re.va),V>re.o&&(V=re.o),D<re.j){var ye=re.j-D;D=re.j,Y[0]+=ye*pe}if(D>=V?D=0:(Y[0]+=4*re.v,re.ka=D-re.j,re.U=re.va-re.v,re.T=V-D,D=1),D){if(le=le[0],11>(D=m.ca).S){var Ie=D.f.RGBA,Ge=(V=D.S,Y=re.U,re=re.T,ye=Ie.eb,Ie.A),qe=re;for(Ie=Ie.fb+m.Ma*Ie.A;0<qe--;){var je=ie,ft=le,Ze=Y,Re=ye,De=Ie;switch(V){case sa:xa(je,ft,Ze,Re,De);break;case bu:Ki(je,ft,Ze,Re,De);break;case jf:Ki(je,ft,Ze,Re,De),os(Re,De,0,Ze,1,0);break;case Eo:qs(je,ft,Ze,Re,De);break;case Bf:Qr(je,ft,Ze,Re,De,1);break;case Hl:Qr(je,ft,Ze,Re,De,1),os(Re,De,0,Ze,1,0);break;case Dc:Qr(je,ft,Ze,Re,De,0);break;case el:Qr(je,ft,Ze,Re,De,0),os(Re,De,1,Ze,1,0);break;case Zo:Ml(je,ft,Ze,Re,De);break;case Su:Ml(je,ft,Ze,Re,De),Cr(Re,De,Ze,1,0);break;case Hh:Ba(je,ft,Ze,Re,De);break;default:e(0)}le+=pe,Ie+=Ge}m.Ma+=re}else alert("todo:EmitRescaledRowsYUVA");e(m.Ma<=D.height)}}m.C=w,e(m.C<=m.i)}function me(m){var w;if(0<m.ua)return 0;for(w=0;w<m.Wb;++w){var D=m.Ya[w].G,V=m.Ya[w].H;if(0<D[1][V[1]+0].g||0<D[2][V[2]+0].g||0<D[3][V[3]+0].g)return 0}return 1}function ve(m,w,D,V,Y,re){if(m.Z!=0){var ie=m.qd,le=m.rd;for(e(So[m.Z]!=null);w<D;++w)So[m.Z](ie,le,V,Y,V,Y,re),ie=V,le=Y,Y+=re;m.qd=ie,m.rd=le}}function we(m,w){var D=m.l.ma,V=D.Z==0||D.Z==1?m.l.j:m.C;if(V=m.C<V?V:m.C,e(w<=m.l.o),w>V){var Y=m.l.width,re=D.ca,ie=D.tb+Y*V,le=m.V,pe=m.Ba+m.c*V,ye=m.gc;e(m.ab==1),e(ye[0].hc==3),Ol(ye[0],V,w,le,pe,re,ie),ve(D,V,w,re,ie,Y)}m.C=m.Ma=w}function Se(m,w,D,V,Y,re,ie){var le=m.$/V,pe=m.$%V,ye=m.m,Ie=m.s,Ge=D+m.$,qe=Ge;Y=D+V*Y;var je=D+V*re,ft=280+Ie.ua,Ze=m.Pb?le:16777216,Re=0<Ie.ua?Ie.Wa:null,De=Ie.wc,at=Ge<je?Fn(Ie,pe,le):null;e(m.C<re),e(je<=Y);var ht=!1;e:for(;;){for(;ht||Ge<je;){var ct=0;if(le>=Ze){var Ut=Ge-D;e((Ze=m).Pb),Ze.wd=Ze.m,Ze.xd=Ut,0<Ze.s.ua&&Pe(Ze.s.Wa,Ze.s.vb),Ze=le+wp}if(pe&De||(at=Fn(Ie,pe,le)),e(at!=null),at.Qb&&(w[Ge]=at.qb,ht=!0),!ht)if(ae(ye),at.jc){ct=ye,Ut=w;var Lt=Ge,Yt=at.pd[j(ct)&mi-1];e(at.jc),256>Yt.g?(G(ct,ct.u+Yt.g),Ut[Lt]=Yt.value,ct=0):(G(ct,ct.u+Yt.g-256),e(256<=Yt.value),ct=Yt.value),ct==0&&(ht=!0)}else ct=gn(at.G[0],at.H[0],ye);if(ye.h)break;if(ht||256>ct){if(!ht)if(at.nd)w[Ge]=(at.qb|ct<<8)>>>0;else{if(ae(ye),ht=gn(at.G[1],at.H[1],ye),ae(ye),Ut=gn(at.G[2],at.H[2],ye),Lt=gn(at.G[3],at.H[3],ye),ye.h)break;w[Ge]=(Lt<<24|ht<<16|ct<<8|Ut)>>>0}if(ht=!1,++Ge,++pe>=V&&(pe=0,++le,ie!=null&&le<=re&&!(le%16)&&ie(m,le),Re!=null))for(;qe<Ge;)ct=w[qe++],Re.X[(506832829*ct&4294967295)>>>Re.Mb]=ct}else if(280>ct){if(ct=Zr(ct-256,ye),Ut=gn(at.G[4],at.H[4],ye),ae(ye),Ut=Hr(V,Ut=Zr(Ut,ye)),ye.h)break;if(Ge-D<Ut||Y-Ge<ct)break e;for(Lt=0;Lt<ct;++Lt)w[Ge+Lt]=w[Ge+Lt-Ut];for(Ge+=ct,pe+=ct;pe>=V;)pe-=V,++le,ie!=null&&le<=re&&!(le%16)&&ie(m,le);if(e(Ge<=Y),pe&De&&(at=Fn(Ie,pe,le)),Re!=null)for(;qe<Ge;)ct=w[qe++],Re.X[(506832829*ct&4294967295)>>>Re.Mb]=ct}else{if(!(ct<ft))break e;for(ht=ct-280,e(Re!=null);qe<Ge;)ct=w[qe++],Re.X[(506832829*ct&4294967295)>>>Re.Mb]=ct;ct=Ge,e(!(ht>>>(Ut=Re).Xa)),w[ct]=Ut.X[ht],ht=!0}ht||e(ye.h==z(ye))}if(m.Pb&&ye.h&&Ge<Y)e(m.m.h),m.a=5,m.m=m.wd,m.$=m.xd,0<m.s.ua&&Pe(m.s.vb,m.s.Wa);else{if(ye.h)break e;ie?.(m,le>re?re:le),m.a=0,m.$=Ge-D}return 1}return m.a=3,0}function Ve(m){e(m!=null),m.vc=null,m.yc=null,m.Ya=null;var w=m.Wa;w!=null&&(w.X=null),m.vb=null,e(m!=null)}function $e(){var m=new _u;return m==null?null:(m.a=0,m.xb=Au,Ii("Predictor","VP8LPredictors"),Ii("Predictor","VP8LPredictors_C"),Ii("PredictorAdd","VP8LPredictorsAdd"),Ii("PredictorAdd","VP8LPredictorsAdd_C"),qh=kt,Pl=Pt,xa=_t,Ki=or,Ml=Gt,Ba=zr,qs=yr,k.VP8LMapColor32b=Di,k.VP8LMapColor8b=Mf,m)}function Me(m,w,D,V,Y){var re=1,ie=[m],le=[w],pe=V.m,ye=V.s,Ie=null,Ge=0;e:for(;;){if(D)for(;re&&X(pe,1);){var qe=ie,je=le,ft=V,Ze=1,Re=ft.m,De=ft.gc[ft.ab],at=X(Re,2);if(ft.Oc&1<<at)re=0;else{switch(ft.Oc|=1<<at,De.hc=at,De.Ea=qe[0],De.nc=je[0],De.K=[null],++ft.ab,e(4>=ft.ab),at){case 0:case 1:De.b=X(Re,3)+2,Ze=Me(nt(De.Ea,De.b),nt(De.nc,De.b),0,ft,De.K),De.K=De.K[0];break;case 3:var ht,ct=X(Re,8)+1,Ut=16<ct?0:4<ct?1:2<ct?2:3;if(qe[0]=nt(De.Ea,Ut),De.b=Ut,ht=Ze=Me(ct,1,0,ft,De.K)){var Lt,Yt=ct,Ot=De,Xr=1<<(8>>Ot.b),sn=a(Xr);if(sn==null)ht=0;else{var Ar=Ot.K[0],Er=Ot.w;for(sn[0]=Ot.K[0][0],Lt=1;Lt<1*Yt;++Lt)sn[Lt]=et(Ar[Er+Lt],sn[Lt-1]);for(;Lt<4*Xr;++Lt)sn[Lt]=0;Ot.K[0]=null,Ot.K[0]=sn,ht=1}}Ze=ht;break;case 2:break;default:e(0)}re=Ze}}if(ie=ie[0],le=le[0],re&&X(pe,1)&&!(re=1<=(Ge=X(pe,4))&&11>=Ge)){V.a=3;break e}var pn;if(pn=re)t:{var on,gr,_n,Zt=V,lr=ie,Wr=le,Yr=Ge,Pi=D,xi=Zt.m,Qn=Zt.s,Jn=[null],si=1,Ts=0,ln=Oc[Yr];r:for(;;){if(Pi&&X(xi,1)){var oi=X(xi,3)+2,Gs=nt(lr,oi),Yl=nt(Wr,oi),Bc=Gs*Yl;if(!Me(Gs,Yl,0,Zt,Jn))break r;for(Jn=Jn[0],Qn.xc=oi,on=0;on<Bc;++on){var Kl=Jn[on]>>8&65535;Jn[on]=Kl,Kl>=si&&(si=Kl+1)}}if(xi.h)break r;for(gr=0;5>gr;++gr){var On=ls[gr];!gr&&0<Yr&&(On+=1<<Yr),Ts<On&&(Ts=On)}var Hf=o(si*ln,C),$h=si,wa=o($h,se);if(wa==null)var Bn=null;else e(65536>=$h),Bn=wa;var jc=a(Ts);if(Bn==null||jc==null||Hf==null){Zt.a=1;break r}var $l=Hf;for(on=_n=0;on<si;++on){var Ua=Bn[on],Ql=Ua.G,Va=Ua.H,Gf=0,ku=1,Qh=0;for(gr=0;5>gr;++gr){On=ls[gr],Ql[gr]=$l,Va[gr]=_n,!gr&&0<Yr&&(On+=1<<Yr);i:{var Wf,Jh=On,Xf=Zt,Nu=jc,kp=$l,Np=_n,Yf=0,sl=Xf.m,N2=X(sl,1);if(i(Nu,0,0,Jh),N2){var Cp=X(sl,1)+1,Ip=X(sl,1),vd=X(sl,Ip==0?1:8);Nu[vd]=1,Cp==2&&(Nu[vd=X(sl,8)]=1);var Cu=1}else{var _d=a(19),xd=X(sl,4)+4;if(19<xd){Xf.a=3;var Kf=0;break i}for(Wf=0;Wf<xd;++Wf)_d[tl[Wf]]=X(sl,3);var Zh=void 0,Iu=void 0,Rp=Xf,Lp=_d,ol=Jh,$f=Nu,e0=0,Ws=Rp.m,Ru=8,yd=o(128,C);n:for(;I(yd,0,7,Lp,19);){if(X(Ws,1)){var Dp=2+2*X(Ws,3);if((Zh=2+X(Ws,Dp))>ol)break n}else Zh=ol;for(Iu=0;Iu<ol&&Zh--;){ae(Ws);var wd=yd[0+(127&j(Ws))];G(Ws,Ws.u+wd.g);var Uc=wd.value;if(16>Uc)$f[Iu++]=Uc,Uc!=0&&(Ru=Uc);else{var Fp=Uc==16,Ed=Uc-16,bd=As[Ed],Sd=X(Ws,Gh[Ed])+bd;if(Iu+Sd>ol)break n;for(var Op=Fp?Ru:0;0<Sd--;)$f[Iu++]=Op}}e0=1;break n}e0||(Rp.a=3),Cu=e0}(Cu=Cu&&!sl.h)&&(Yf=I(kp,Np,8,Nu,Jh)),Cu&&Yf!=0?Kf=Yf:(Xf.a=3,Kf=0)}if(Kf==0)break r;if(ku&&Fc[gr]==1&&(ku=$l[_n].g==0),Gf+=$l[_n].g,_n+=Kf,3>=gr){var Vc,t0=jc[0];for(Vc=1;Vc<On;++Vc)jc[Vc]>t0&&(t0=jc[Vc]);Qh+=t0}}if(Ua.nd=ku,Ua.Qb=0,ku&&(Ua.qb=(Ql[3][Va[3]+0].value<<24|Ql[1][Va[1]+0].value<<16|Ql[2][Va[2]+0].value)>>>0,Gf==0&&256>Ql[0][Va[0]+0].value&&(Ua.Qb=1,Ua.qb+=Ql[0][Va[0]+0].value<<8)),Ua.jc=!Ua.Qb&&6>Qh,Ua.jc){var Qf,ll=Ua;for(Qf=0;Qf<mi;++Qf){var ko=Qf,cl=ll.pd[ko],Jf=ll.G[0][ll.H[0]+ko];256<=Jf.value?(cl.g=Jf.g+256,cl.value=Jf.value):(cl.g=0,cl.value=0,ko>>=In(Jf,8,cl),ko>>=In(ll.G[1][ll.H[1]+ko],16,cl),ko>>=In(ll.G[2][ll.H[2]+ko],0,cl),In(ll.G[3][ll.H[3]+ko],24,cl))}}}Qn.vc=Jn,Qn.Wb=si,Qn.Ya=Bn,Qn.yc=Hf,pn=1;break t}pn=0}if(!(re=pn)){V.a=3;break e}if(0<Ge){if(ye.ua=1<<Ge,!ot(ye.Wa,Ge)){V.a=1,re=0;break e}}else ye.ua=0;var Zf=V,Ad=ie,Pp=le,Td=Zf.s,kd=Td.xc;if(Zf.c=Ad,Zf.i=Pp,Td.md=nt(Ad,kd),Td.wc=kd==0?-1:(1<<kd)-1,D){V.xb=bp;break e}if((Ie=a(ie*le))==null){V.a=1,re=0;break e}re=(re=Se(V,Ie,0,ie,le,le,null))&&!pe.h;break e}return re?(Y!=null?Y[0]=Ie:(e(Ie==null),e(D)),V.$=0,D||Ve(ye)):Ve(ye),re}function He(m,w){var D=m.c*m.i,V=D+w+16*w;return e(m.c<=w),m.V=a(V),m.V==null?(m.Ta=null,m.Ua=0,m.a=1,0):(m.Ta=m.V,m.Ua=m.Ba+D+w,1)}function Ye(m,w){var D=m.C,V=w-D,Y=m.V,re=m.Ba+m.c*D;for(e(w<=m.l.o);0<V;){var ie=16<V?16:V,le=m.l.ma,pe=m.l.width,ye=pe*ie,Ie=le.ca,Ge=le.tb+pe*D,qe=m.Ta,je=m.Ua;te(m,ie,Y,re),Tn(qe,je,Ie,Ge,ye),ve(le,D,D+ie,Ie,Ge,pe),V-=ie,Y+=ie*m.c,D+=ie}e(D==w),m.C=m.Ma=w}function pt(){this.ub=this.yd=this.td=this.Rb=0}function At(){this.Kd=this.Ld=this.Ud=this.Td=this.i=this.c=0}function Bt(){this.Fb=this.Bb=this.Cb=0,this.Zb=a(4),this.Lb=a(4)}function St(){this.Yb=function(){var m=[];return function w(D,V,Y){for(var re=Y[V],ie=0;ie<re&&(D.push(Y.length>V+1?[]:0),!(Y.length<V+1));ie++)w(D[ie],V+1,Y)}(m,0,[3,11]),m}()}function Rt(){this.jb=a(3),this.Wc=c([4,8],St),this.Xc=c([4,17],St)}function er(){this.Pc=this.wb=this.Tb=this.zd=0,this.vd=new a(4),this.od=new a(4)}function kr(){this.ld=this.La=this.dd=this.tc=0}function Nr(){this.Na=this.la=0}function Fr(){this.Sc=[0,0],this.Eb=[0,0],this.Qc=[0,0],this.ia=this.lc=0}function Hi(){this.ad=a(384),this.Za=0,this.Ob=a(16),this.$b=this.Ad=this.ia=this.Gc=this.Hc=this.Dd=0}function ds(){this.uc=this.M=this.Nb=0,this.wa=Array(new kr),this.Y=0,this.ya=Array(new Hi),this.aa=0,this.l=new va}function Ri(){this.y=a(16),this.f=a(8),this.ea=a(8)}function ta(){this.cb=this.a=0,this.sc="",this.m=new xe,this.Od=new pt,this.Kc=new At,this.ed=new er,this.Qa=new Bt,this.Ic=this.$c=this.Aa=0,this.D=new ds,this.Xb=this.Va=this.Hb=this.zb=this.yb=this.Ub=this.za=0,this.Jc=o(8,xe),this.ia=0,this.pb=o(4,Fr),this.Pa=new Rt,this.Bd=this.kc=0,this.Ac=[],this.Bc=0,this.zc=[0,0,0,0],this.Gd=Array(new Ri),this.Hd=0,this.rb=Array(new Nr),this.sb=0,this.wa=Array(new kr),this.Y=0,this.oc=[],this.pc=0,this.sa=[],this.ta=0,this.qa=[],this.ra=0,this.Ha=[],this.B=this.R=this.Ia=0,this.Ec=[],this.M=this.ja=this.Vb=this.Fc=0,this.ya=Array(new Hi),this.L=this.aa=0,this.gd=c([4,2],kr),this.ga=null,this.Fa=[],this.Cc=this.qc=this.P=0,this.Gb=[],this.Uc=0,this.mb=[],this.nb=0,this.rc=[],this.Ga=this.Vc=0}function va(){this.T=this.U=this.ka=this.height=this.width=0,this.y=[],this.f=[],this.ea=[],this.Rc=this.fa=this.W=this.N=this.O=0,this.ma="void",this.put="VP8IoPutHook",this.ac="VP8IoSetupHook",this.bc="VP8IoTeardownHook",this.ha=this.Kb=0,this.data=[],this.hb=this.ib=this.da=this.o=this.j=this.va=this.v=this.Da=this.ob=this.w=0,this.F=[],this.J=0}function Gi(){var m=new ta;return m!=null&&(m.a=0,m.sc="OK",m.cb=0,m.Xb=0,gi||(gi=pu)),m}function An(m,w,D){return m.a==0&&(m.a=w,m.sc=D,m.cb=0),0}function Li(m,w,D){return 3<=D&&m[w+0]==157&&m[w+1]==1&&m[w+2]==42}function Tl(m,w){if(m==null)return 0;if(m.a=0,m.sc="OK",w==null)return An(m,2,"null VP8Io passed to VP8GetHeaders()");var D=w.data,V=w.w,Y=w.ha;if(4>Y)return An(m,7,"Truncated header.");var re=D[V+0]|D[V+1]<<8|D[V+2]<<16,ie=m.Od;if(ie.Rb=!(1&re),ie.td=re>>1&7,ie.yd=re>>4&1,ie.ub=re>>5,3<ie.td)return An(m,3,"Incorrect keyframe parameters.");if(!ie.yd)return An(m,4,"Frame not displayable.");V+=3,Y-=3;var le=m.Kc;if(ie.Rb){if(7>Y)return An(m,7,"cannot parse picture header");if(!Li(D,V,Y))return An(m,3,"Bad code word");le.c=16383&(D[V+4]<<8|D[V+3]),le.Td=D[V+4]>>6,le.i=16383&(D[V+6]<<8|D[V+5]),le.Ud=D[V+6]>>6,V+=7,Y-=7,m.za=le.c+15>>4,m.Ub=le.i+15>>4,w.width=le.c,w.height=le.i,w.Da=0,w.j=0,w.v=0,w.va=w.width,w.o=w.height,w.da=0,w.ib=w.width,w.hb=w.height,w.U=w.width,w.T=w.height,i((re=m.Pa).jb,0,255,re.jb.length),e((re=m.Qa)!=null),re.Cb=0,re.Bb=0,re.Fb=1,i(re.Zb,0,0,re.Zb.length),i(re.Lb,0,0,re.Lb)}if(ie.ub>Y)return An(m,7,"bad partition length");ne(re=m.m,D,V,ie.ub),V+=ie.ub,Y-=ie.ub,ie.Rb&&(le.Ld=_e(re),le.Kd=_e(re)),le=m.Qa;var pe,ye=m.Pa;if(e(re!=null),e(le!=null),le.Cb=_e(re),le.Cb){if(le.Bb=_e(re),_e(re)){for(le.Fb=_e(re),pe=0;4>pe;++pe)le.Zb[pe]=_e(re)?de(re,7):0;for(pe=0;4>pe;++pe)le.Lb[pe]=_e(re)?de(re,6):0}if(le.Bb)for(pe=0;3>pe;++pe)ye.jb[pe]=_e(re)?J(re,8):255}else le.Bb=0;if(re.Ka)return An(m,3,"cannot parse segment header");if((le=m.ed).zd=_e(re),le.Tb=J(re,6),le.wb=J(re,3),le.Pc=_e(re),le.Pc&&_e(re)){for(ye=0;4>ye;++ye)_e(re)&&(le.vd[ye]=de(re,6));for(ye=0;4>ye;++ye)_e(re)&&(le.od[ye]=de(re,6))}if(m.L=le.Tb==0?0:le.zd?1:2,re.Ka)return An(m,3,"cannot parse filter header");var Ie=Y;if(Y=pe=V,V=pe+Ie,le=Ie,m.Xb=(1<<J(m.m,2))-1,Ie<3*(ye=m.Xb))D=7;else{for(pe+=3*ye,le-=3*ye,Ie=0;Ie<ye;++Ie){var Ge=D[Y+0]|D[Y+1]<<8|D[Y+2]<<16;Ge>le&&(Ge=le),ne(m.Jc[+Ie],D,pe,Ge),pe+=Ge,le-=Ge,Y+=3}ne(m.Jc[+ye],D,pe,le),D=pe<V?0:5}if(D!=0)return An(m,D,"cannot parse partitions");for(D=J(pe=m.m,7),Y=_e(pe)?de(pe,4):0,V=_e(pe)?de(pe,4):0,le=_e(pe)?de(pe,4):0,ye=_e(pe)?de(pe,4):0,pe=_e(pe)?de(pe,4):0,Ie=m.Qa,Ge=0;4>Ge;++Ge){if(Ie.Cb){var qe=Ie.Zb[Ge];Ie.Fb||(qe+=D)}else{if(0<Ge){m.pb[Ge]=m.pb[0];continue}qe=D}var je=m.pb[Ge];je.Sc[0]=Uf[an(qe+Y,127)],je.Sc[1]=Vf[an(qe+0,127)],je.Eb[0]=2*Uf[an(qe+V,127)],je.Eb[1]=101581*Vf[an(qe+le,127)]>>16,8>je.Eb[1]&&(je.Eb[1]=8),je.Qc[0]=Uf[an(qe+ye,117)],je.Qc[1]=Vf[an(qe+pe,127)],je.lc=qe+pe}if(!ie.Rb)return An(m,4,"Not a key frame.");for(_e(re),ie=m.Pa,D=0;4>D;++D){for(Y=0;8>Y;++Y)for(V=0;3>V;++V)for(le=0;11>le;++le)ye=Ee(re,Pc[D][Y][V][le])?J(re,8):bo[D][Y][V][le],ie.Wc[D][Y].Yb[V][le]=ye;for(Y=0;17>Y;++Y)ie.Xc[D][Y]=ie.Wc[D][Ep[Y]]}return m.kc=_e(re),m.kc&&(m.Bd=J(re,8)),m.cb=1}function pu(m,w,D,V,Y,re,ie){var le=w[Y].Yb[D];for(D=0;16>Y;++Y){if(!Ee(m,le[D+0]))return Y;for(;!Ee(m,le[D+1]);)if(le=w[++Y].Yb[0],D=0,Y==16)return 16;var pe=w[Y+1].Yb;if(Ee(m,le[D+2])){var ye=m,Ie=0;if(Ee(ye,(qe=le)[(Ge=D)+3]))if(Ee(ye,qe[Ge+6])){for(le=0,Ge=2*(Ie=Ee(ye,qe[Ge+8]))+(qe=Ee(ye,qe[Ge+9+Ie])),Ie=0,qe=Wn[Ge];qe[le];++le)Ie+=Ie+Ee(ye,qe[le]);Ie+=3+(8<<Ge)}else Ee(ye,qe[Ge+7])?(Ie=7+2*Ee(ye,165),Ie+=Ee(ye,145)):Ie=5+Ee(ye,159);else Ie=Ee(ye,qe[Ge+4])?3+Ee(ye,qe[Ge+5]):2;le=pe[2]}else Ie=1,le=pe[1];pe=ie+en[Y],0>(ye=m).b&&Ae(ye);var Ge,qe=ye.b,je=(Ge=ye.Ca>>1)-(ye.I>>qe)>>31;--ye.b,ye.Ca+=je,ye.Ca|=1,ye.I-=(Ge+1&je)<<qe,re[pe]=((Ie^je)-je)*V[(0<Y)+0]}return 16}function oo(m){var w=m.rb[m.sb-1];w.la=0,w.Na=0,i(m.zc,0,0,m.zc.length),m.ja=0}function yc(m,w){if(m==null)return 0;if(w==null)return An(m,2,"NULL VP8Io parameter in VP8Decode().");if(!m.cb&&!Tl(m,w))return 0;if(e(m.cb),w.ac==null||w.ac(w)){w.ob&&(m.L=0);var D=al[m.L];if(m.L==2?(m.yb=0,m.zb=0):(m.yb=w.v-D>>4,m.zb=w.j-D>>4,0>m.yb&&(m.yb=0),0>m.zb&&(m.zb=0)),m.Va=w.o+15+D>>4,m.Hb=w.va+15+D>>4,m.Hb>m.za&&(m.Hb=m.za),m.Va>m.Ub&&(m.Va=m.Ub),0<m.L){var V=m.ed;for(D=0;4>D;++D){var Y;if(m.Qa.Cb){var re=m.Qa.Lb[D];m.Qa.Fb||(re+=V.Tb)}else re=V.Tb;for(Y=0;1>=Y;++Y){var ie=m.gd[D][Y],le=re;if(V.Pc&&(le+=V.vd[0],Y&&(le+=V.od[0])),0<(le=0>le?0:63<le?63:le)){var pe=le;0<V.wb&&(pe=4<V.wb?pe>>2:pe>>1)>9-V.wb&&(pe=9-V.wb),1>pe&&(pe=1),ie.dd=pe,ie.tc=2*le+pe,ie.ld=40<=le?2:15<=le?1:0}else ie.tc=0;ie.La=Y}}}D=0}else An(m,6,"Frame setup failed"),D=m.a;if(D=D==0){if(D){m.$c=0,0<m.Aa||(m.Ic=Ap);e:{D=m.Ic,V=4*(pe=m.za);var ye=32*pe,Ie=pe+1,Ge=0<m.L?pe*(0<m.Aa?2:1):0,qe=(m.Aa==2?2:1)*pe;if((ie=V+832+(Y=3*(16*D+al[m.L])/2*ye)+(re=m.Fa!=null&&0<m.Fa.length?m.Kc.c*m.Kc.i:0))!=ie)D=0;else{if(ie>m.Vb){if(m.Vb=0,m.Ec=a(ie),m.Fc=0,m.Ec==null){D=An(m,1,"no memory during frame initialization.");break e}m.Vb=ie}ie=m.Ec,le=m.Fc,m.Ac=ie,m.Bc=le,le+=V,m.Gd=o(ye,Ri),m.Hd=0,m.rb=o(Ie+1,Nr),m.sb=1,m.wa=Ge?o(Ge,kr):null,m.Y=0,m.D.Nb=0,m.D.wa=m.wa,m.D.Y=m.Y,0<m.Aa&&(m.D.Y+=pe),e(!0),m.oc=ie,m.pc=le,le+=832,m.ya=o(qe,Hi),m.aa=0,m.D.ya=m.ya,m.D.aa=m.aa,m.Aa==2&&(m.D.aa+=pe),m.R=16*pe,m.B=8*pe,pe=(ye=al[m.L])*m.R,ye=ye/2*m.B,m.sa=ie,m.ta=le+pe,m.qa=m.sa,m.ra=m.ta+16*D*m.R+ye,m.Ha=m.qa,m.Ia=m.ra+8*D*m.B+ye,m.$c=0,le+=Y,m.mb=re?ie:null,m.nb=re?le:null,e(le+re<=m.Fc+m.Vb),oo(m),i(m.Ac,m.Bc,0,V),D=1}}if(D){if(w.ka=0,w.y=m.sa,w.O=m.ta,w.f=m.qa,w.N=m.ra,w.ea=m.Ha,w.Vd=m.Ia,w.fa=m.R,w.Rc=m.B,w.F=null,w.J=0,!Jo){for(D=-255;255>=D;++D)$n[255+D]=0>D?-D:D;for(D=-1020;1020>=D;++D)bs[1020+D]=-128>D?-128:127<D?127:D;for(D=-112;112>=D;++D)ql[112+D]=-16>D?-16:15<D?15:D;for(D=-255;510>=D;++D)zl[255+D]=0>D?0:255<D?255:D;Jo=1}yo=La,zs=co,Hs=ps,ai=nn,ja=uo,Hn=lo,Cc=mo,wo=Us,wu=Il,Bl=Ac,jl=Cl,Ul=Go,Ic=Wo,Eu=go,Vl=ss,Qo=ia,Rc=ii,Gn=vu,ya[0]=ra,ya[1]=mu,ya[2]=vs,ya[3]=gu,ya[4]=Da,ya[5]=_s,ya[6]=_a,ya[7]=Fa,ya[8]=js,ya[9]=fo,nl[0]=ms,nl[1]=Ec,nl[2]=Ps,nl[3]=Nl,nl[4]=vn,nl[5]=Bs,nl[6]=gs,cs[0]=xs,cs[1]=wc,cs[2]=bc,cs[3]=Oa,cs[4]=Or,cs[5]=ni,cs[6]=ho,D=1}else D=0}D&&(D=function(je,ft){for(je.M=0;je.M<je.Va;++je.M){var Ze,Re=je.Jc[je.M&je.Xb],De=je.m,at=je;for(Ze=0;Ze<at.za;++Ze){var ht=De,ct=at,Ut=ct.Ac,Lt=ct.Bc+4*Ze,Yt=ct.zc,Ot=ct.ya[ct.aa+Ze];if(ct.Qa.Bb?Ot.$b=Ee(ht,ct.Pa.jb[0])?2+Ee(ht,ct.Pa.jb[2]):Ee(ht,ct.Pa.jb[1]):Ot.$b=0,ct.kc&&(Ot.Ad=Ee(ht,ct.Bd)),Ot.Za=!Ee(ht,145)+0,Ot.Za){var Xr=Ot.Ob,sn=0;for(ct=0;4>ct;++ct){var Ar,Er=Yt[0+ct];for(Ar=0;4>Ar;++Ar){Er=pd[Ut[Lt+Ar]][Er];for(var pn=Gl[Ee(ht,Er[0])];0<pn;)pn=Gl[2*pn+Ee(ht,Er[pn])];Er=-pn,Ut[Lt+Ar]=Er}n(Xr,sn,Ut,Lt,4),sn+=4,Yt[0+ct]=Er}}else Er=Ee(ht,156)?Ee(ht,128)?1:3:Ee(ht,163)?2:0,Ot.Ob[0]=Er,i(Ut,Lt,Er,4),i(Yt,0,Er,4);Ot.Dd=Ee(ht,142)?Ee(ht,114)?Ee(ht,183)?1:3:2:0}if(at.m.Ka)return An(je,7,"Premature end-of-partition0 encountered.");for(;je.ja<je.za;++je.ja){if(at=Re,ht=(De=je).rb[De.sb-1],Ut=De.rb[De.sb+De.ja],Ze=De.ya[De.aa+De.ja],Lt=De.kc?Ze.Ad:0)ht.la=Ut.la=0,Ze.Za||(ht.Na=Ut.Na=0),Ze.Hc=0,Ze.Gc=0,Ze.ia=0;else{var on,gr;if(ht=Ut,Ut=at,Lt=De.Pa.Xc,Yt=De.ya[De.aa+De.ja],Ot=De.pb[Yt.$b],ct=Yt.ad,Xr=0,sn=De.rb[De.sb-1],Er=Ar=0,i(ct,Xr,0,384),Yt.Za)var _n=0,Zt=Lt[3];else{pn=a(16);var lr=ht.Na+sn.Na;if(lr=gi(Ut,Lt[1],lr,Ot.Eb,0,pn,0),ht.Na=sn.Na=(0<lr)+0,1<lr)yo(pn,0,ct,Xr);else{var Wr=pn[0]+3>>3;for(pn=0;256>pn;pn+=16)ct[Xr+pn]=Wr}_n=1,Zt=Lt[0]}var Yr=15&ht.la,Pi=15&sn.la;for(pn=0;4>pn;++pn){var xi=1&Pi;for(Wr=gr=0;4>Wr;++Wr)Yr=Yr>>1|(xi=(lr=gi(Ut,Zt,lr=xi+(1&Yr),Ot.Sc,_n,ct,Xr))>_n)<<7,gr=gr<<2|(3<lr?3:1<lr?2:ct[Xr+0]!=0),Xr+=16;Yr>>=4,Pi=Pi>>1|xi<<7,Ar=(Ar<<8|gr)>>>0}for(Zt=Yr,_n=Pi>>4,on=0;4>on;on+=2){for(gr=0,Yr=ht.la>>4+on,Pi=sn.la>>4+on,pn=0;2>pn;++pn){for(xi=1&Pi,Wr=0;2>Wr;++Wr)lr=xi+(1&Yr),Yr=Yr>>1|(xi=0<(lr=gi(Ut,Lt[2],lr,Ot.Qc,0,ct,Xr)))<<3,gr=gr<<2|(3<lr?3:1<lr?2:ct[Xr+0]!=0),Xr+=16;Yr>>=2,Pi=Pi>>1|xi<<5}Er|=gr<<4*on,Zt|=Yr<<4<<on,_n|=(240&Pi)<<on}ht.la=Zt,sn.la=_n,Yt.Hc=Ar,Yt.Gc=Er,Yt.ia=43690&Er?0:Ot.ia,Lt=!(Ar|Er)}if(0<De.L&&(De.wa[De.Y+De.ja]=De.gd[Ze.$b][Ze.Za],De.wa[De.Y+De.ja].La|=!Lt),at.Ka)return An(je,7,"Premature end-of-file encountered.")}if(oo(je),De=ft,at=1,Ze=(Re=je).D,ht=0<Re.L&&Re.M>=Re.zb&&Re.M<=Re.Va,Re.Aa==0)e:{if(Ze.M=Re.M,Ze.uc=ht,Pa(Re,Ze),at=1,Ze=(gr=Re.D).Nb,ht=(Er=al[Re.L])*Re.R,Ut=Er/2*Re.B,pn=16*Ze*Re.R,Wr=8*Ze*Re.B,Lt=Re.sa,Yt=Re.ta-ht+pn,Ot=Re.qa,ct=Re.ra-Ut+Wr,Xr=Re.Ha,sn=Re.Ia-Ut+Wr,Pi=(Yr=gr.M)==0,Ar=Yr>=Re.Va-1,Re.Aa==2&&Pa(Re,gr),gr.uc)for(xi=(lr=Re).D.M,e(lr.D.uc),gr=lr.yb;gr<lr.Hb;++gr){_n=gr,Zt=xi;var Qn=(Jn=(On=lr).D).Nb;on=On.R;var Jn=Jn.wa[Jn.Y+_n],si=On.sa,Ts=On.ta+16*Qn*on+16*_n,ln=Jn.dd,oi=Jn.tc;if(oi!=0)if(e(3<=oi),On.L==1)0<_n&&Qo(si,Ts,on,oi+4),Jn.La&&Gn(si,Ts,on,oi),0<Zt&&Vl(si,Ts,on,oi+4),Jn.La&&Rc(si,Ts,on,oi);else{var Gs=On.B,Yl=On.qa,Bc=On.ra+8*Qn*Gs+8*_n,Kl=On.Ha,On=On.Ia+8*Qn*Gs+8*_n;Qn=Jn.ld,0<_n&&(wo(si,Ts,on,oi+4,ln,Qn),Bl(Yl,Bc,Kl,On,Gs,oi+4,ln,Qn)),Jn.La&&(Ul(si,Ts,on,oi,ln,Qn),Eu(Yl,Bc,Kl,On,Gs,oi,ln,Qn)),0<Zt&&(Cc(si,Ts,on,oi+4,ln,Qn),wu(Yl,Bc,Kl,On,Gs,oi+4,ln,Qn)),Jn.La&&(jl(si,Ts,on,oi,ln,Qn),Ic(Yl,Bc,Kl,On,Gs,oi,ln,Qn))}}if(Re.ia&&alert("todo:DitherRow"),De.put!=null){if(gr=16*Yr,Yr=16*(Yr+1),Pi?(De.y=Re.sa,De.O=Re.ta+pn,De.f=Re.qa,De.N=Re.ra+Wr,De.ea=Re.Ha,De.W=Re.Ia+Wr):(gr-=Er,De.y=Lt,De.O=Yt,De.f=Ot,De.N=ct,De.ea=Xr,De.W=sn),Ar||(Yr-=Er),Yr>De.o&&(Yr=De.o),De.F=null,De.J=null,Re.Fa!=null&&0<Re.Fa.length&&gr<Yr&&(De.J=Ll(Re,De,gr,Yr-gr),De.F=Re.mb,De.F==null&&De.F.length==0)){at=An(Re,3,"Could not decode alpha data.");break e}gr<De.j&&(Er=De.j-gr,gr=De.j,e(!(1&Er)),De.O+=Re.R*Er,De.N+=Re.B*(Er>>1),De.W+=Re.B*(Er>>1),De.F!=null&&(De.J+=De.width*Er)),gr<Yr&&(De.O+=De.v,De.N+=De.v>>1,De.W+=De.v>>1,De.F!=null&&(De.J+=De.v),De.ka=gr-De.j,De.U=De.va-De.v,De.T=Yr-gr,at=De.put(De))}Ze+1!=Re.Ic||Ar||(n(Re.sa,Re.ta-ht,Lt,Yt+16*Re.R,ht),n(Re.qa,Re.ra-Ut,Ot,ct+8*Re.B,Ut),n(Re.Ha,Re.Ia-Ut,Xr,sn+8*Re.B,Ut))}if(!at)return An(je,6,"Output aborted.")}return 1}(m,w)),w.bc!=null&&w.bc(w),D&=1}return D?(m.cb=0,D):0}function Wi(m,w,D,V,Y){Y=m[w+D+32*V]+(Y>>3),m[w+D+32*V]=-256&Y?0>Y?0:255:Y}function kl(m,w,D,V,Y,re){Wi(m,w,0,D,V+Y),Wi(m,w,1,D,V+re),Wi(m,w,2,D,V-re),Wi(m,w,3,D,V-Y)}function Gr(m){return(20091*m>>16)+m}function Xi(m,w,D,V){var Y,re=0,ie=a(16);for(Y=0;4>Y;++Y){var le=m[w+0]+m[w+8],pe=m[w+0]-m[w+8],ye=(35468*m[w+4]>>16)-Gr(m[w+12]),Ie=Gr(m[w+4])+(35468*m[w+12]>>16);ie[re+0]=le+Ie,ie[re+1]=pe+ye,ie[re+2]=pe-ye,ie[re+3]=le-Ie,re+=4,w++}for(Y=re=0;4>Y;++Y)le=(m=ie[re+0]+4)+ie[re+8],pe=m-ie[re+8],ye=(35468*ie[re+4]>>16)-Gr(ie[re+12]),Wi(D,V,0,0,le+(Ie=Gr(ie[re+4])+(35468*ie[re+12]>>16))),Wi(D,V,1,0,pe+ye),Wi(D,V,2,0,pe-ye),Wi(D,V,3,0,le-Ie),re++,V+=32}function lo(m,w,D,V){var Y=m[w+0]+4,re=35468*m[w+4]>>16,ie=Gr(m[w+4]),le=35468*m[w+1]>>16;kl(D,V,0,Y+ie,m=Gr(m[w+1]),le),kl(D,V,1,Y+re,m,le),kl(D,V,2,Y-re,m,le),kl(D,V,3,Y-ie,m,le)}function co(m,w,D,V,Y){Xi(m,w,D,V),Y&&Xi(m,w+16,D,V+4)}function ps(m,w,D,V){zs(m,w+0,D,V,1),zs(m,w+32,D,V+128,1)}function nn(m,w,D,V){var Y;for(m=m[w+0]+4,Y=0;4>Y;++Y)for(w=0;4>w;++w)Wi(D,V,w,Y,m)}function uo(m,w,D,V){m[w+0]&&ai(m,w+0,D,V),m[w+16]&&ai(m,w+16,D,V+4),m[w+32]&&ai(m,w+32,D,V+128),m[w+48]&&ai(m,w+48,D,V+128+4)}function La(m,w,D,V){var Y,re=a(16);for(Y=0;4>Y;++Y){var ie=m[w+0+Y]+m[w+12+Y],le=m[w+4+Y]+m[w+8+Y],pe=m[w+4+Y]-m[w+8+Y],ye=m[w+0+Y]-m[w+12+Y];re[0+Y]=ie+le,re[8+Y]=ie-le,re[4+Y]=ye+pe,re[12+Y]=ye-pe}for(Y=0;4>Y;++Y)ie=(m=re[0+4*Y]+3)+re[3+4*Y],le=re[1+4*Y]+re[2+4*Y],pe=re[1+4*Y]-re[2+4*Y],ye=m-re[3+4*Y],D[V+0]=ie+le>>3,D[V+16]=ye+pe>>3,D[V+32]=ie-le>>3,D[V+48]=ye-pe>>3,V+=64}function Os(m,w,D){var V,Y=w-32,re=Fi,ie=255-m[Y-1];for(V=0;V<D;++V){var le,pe=re,ye=ie+m[w-1];for(le=0;le<D;++le)m[w+le]=pe[ye+m[Y+le]];w+=32}}function mu(m,w){Os(m,w,4)}function wc(m,w){Os(m,w,8)}function Ec(m,w){Os(m,w,16)}function Ps(m,w){var D;for(D=0;16>D;++D)n(m,w+32*D,m,w-32,16)}function Nl(m,w){var D;for(D=16;0<D;--D)i(m,w,m[w-1],16),w+=32}function Ms(m,w,D){var V;for(V=0;16>V;++V)i(w,D+32*V,m,16)}function ms(m,w){var D,V=16;for(D=0;16>D;++D)V+=m[w-1+32*D]+m[w+D-32];Ms(V>>5,m,w)}function vn(m,w){var D,V=8;for(D=0;16>D;++D)V+=m[w-1+32*D];Ms(V>>4,m,w)}function Bs(m,w){var D,V=8;for(D=0;16>D;++D)V+=m[w+D-32];Ms(V>>4,m,w)}function gs(m,w){Ms(128,m,w)}function tr(m,w,D){return m+2*w+D+2>>2}function vs(m,w){var D,V=w-32;for(V=new Uint8Array([tr(m[V-1],m[V+0],m[V+1]),tr(m[V+0],m[V+1],m[V+2]),tr(m[V+1],m[V+2],m[V+3]),tr(m[V+2],m[V+3],m[V+4])]),D=0;4>D;++D)n(m,w+32*D,V,0,V.length)}function gu(m,w){var D=m[w-1],V=m[w-1+32],Y=m[w-1+64],re=m[w-1+96];Ce(m,w+0,16843009*tr(m[w-1-32],D,V)),Ce(m,w+32,16843009*tr(D,V,Y)),Ce(m,w+64,16843009*tr(V,Y,re)),Ce(m,w+96,16843009*tr(Y,re,re))}function ra(m,w){var D,V=4;for(D=0;4>D;++D)V+=m[w+D-32]+m[w-1+32*D];for(V>>=3,D=0;4>D;++D)i(m,w+32*D,V,4)}function Da(m,w){var D=m[w-1+0],V=m[w-1+32],Y=m[w-1+64],re=m[w-1-32],ie=m[w+0-32],le=m[w+1-32],pe=m[w+2-32],ye=m[w+3-32];m[w+0+96]=tr(V,Y,m[w-1+96]),m[w+1+96]=m[w+0+64]=tr(D,V,Y),m[w+2+96]=m[w+1+64]=m[w+0+32]=tr(re,D,V),m[w+3+96]=m[w+2+64]=m[w+1+32]=m[w+0+0]=tr(ie,re,D),m[w+3+64]=m[w+2+32]=m[w+1+0]=tr(le,ie,re),m[w+3+32]=m[w+2+0]=tr(pe,le,ie),m[w+3+0]=tr(ye,pe,le)}function _a(m,w){var D=m[w+1-32],V=m[w+2-32],Y=m[w+3-32],re=m[w+4-32],ie=m[w+5-32],le=m[w+6-32],pe=m[w+7-32];m[w+0+0]=tr(m[w+0-32],D,V),m[w+1+0]=m[w+0+32]=tr(D,V,Y),m[w+2+0]=m[w+1+32]=m[w+0+64]=tr(V,Y,re),m[w+3+0]=m[w+2+32]=m[w+1+64]=m[w+0+96]=tr(Y,re,ie),m[w+3+32]=m[w+2+64]=m[w+1+96]=tr(re,ie,le),m[w+3+64]=m[w+2+96]=tr(ie,le,pe),m[w+3+96]=tr(le,pe,pe)}function _s(m,w){var D=m[w-1+0],V=m[w-1+32],Y=m[w-1+64],re=m[w-1-32],ie=m[w+0-32],le=m[w+1-32],pe=m[w+2-32],ye=m[w+3-32];m[w+0+0]=m[w+1+64]=re+ie+1>>1,m[w+1+0]=m[w+2+64]=ie+le+1>>1,m[w+2+0]=m[w+3+64]=le+pe+1>>1,m[w+3+0]=pe+ye+1>>1,m[w+0+96]=tr(Y,V,D),m[w+0+64]=tr(V,D,re),m[w+0+32]=m[w+1+96]=tr(D,re,ie),m[w+1+32]=m[w+2+96]=tr(re,ie,le),m[w+2+32]=m[w+3+96]=tr(ie,le,pe),m[w+3+32]=tr(le,pe,ye)}function Fa(m,w){var D=m[w+0-32],V=m[w+1-32],Y=m[w+2-32],re=m[w+3-32],ie=m[w+4-32],le=m[w+5-32],pe=m[w+6-32],ye=m[w+7-32];m[w+0+0]=D+V+1>>1,m[w+1+0]=m[w+0+64]=V+Y+1>>1,m[w+2+0]=m[w+1+64]=Y+re+1>>1,m[w+3+0]=m[w+2+64]=re+ie+1>>1,m[w+0+32]=tr(D,V,Y),m[w+1+32]=m[w+0+96]=tr(V,Y,re),m[w+2+32]=m[w+1+96]=tr(Y,re,ie),m[w+3+32]=m[w+2+96]=tr(re,ie,le),m[w+3+64]=tr(ie,le,pe),m[w+3+96]=tr(le,pe,ye)}function fo(m,w){var D=m[w-1+0],V=m[w-1+32],Y=m[w-1+64],re=m[w-1+96];m[w+0+0]=D+V+1>>1,m[w+2+0]=m[w+0+32]=V+Y+1>>1,m[w+2+32]=m[w+0+64]=Y+re+1>>1,m[w+1+0]=tr(D,V,Y),m[w+3+0]=m[w+1+32]=tr(V,Y,re),m[w+3+32]=m[w+1+64]=tr(Y,re,re),m[w+3+64]=m[w+2+64]=m[w+0+96]=m[w+1+96]=m[w+2+96]=m[w+3+96]=re}function js(m,w){var D=m[w-1+0],V=m[w-1+32],Y=m[w-1+64],re=m[w-1+96],ie=m[w-1-32],le=m[w+0-32],pe=m[w+1-32],ye=m[w+2-32];m[w+0+0]=m[w+2+32]=D+ie+1>>1,m[w+0+32]=m[w+2+64]=V+D+1>>1,m[w+0+64]=m[w+2+96]=Y+V+1>>1,m[w+0+96]=re+Y+1>>1,m[w+3+0]=tr(le,pe,ye),m[w+2+0]=tr(ie,le,pe),m[w+1+0]=m[w+3+32]=tr(D,ie,le),m[w+1+32]=m[w+3+64]=tr(V,D,ie),m[w+1+64]=m[w+3+96]=tr(Y,V,D),m[w+1+96]=tr(re,Y,V)}function bc(m,w){var D;for(D=0;8>D;++D)n(m,w+32*D,m,w-32,8)}function Oa(m,w){var D;for(D=0;8>D;++D)i(m,w,m[w-1],8),w+=32}function na(m,w,D){var V;for(V=0;8>V;++V)i(w,D+32*V,m,8)}function xs(m,w){var D,V=8;for(D=0;8>D;++D)V+=m[w+D-32]+m[w-1+32*D];na(V>>4,m,w)}function ni(m,w){var D,V=4;for(D=0;8>D;++D)V+=m[w+D-32];na(V>>3,m,w)}function Or(m,w){var D,V=4;for(D=0;8>D;++D)V+=m[w-1+32*D];na(V>>3,m,w)}function ho(m,w){na(128,m,w)}function ys(m,w,D){var V=m[w-D],Y=m[w+0],re=3*(Y-V)+zh[1020+m[w-2*D]-m[w+D]],ie=Lc[112+(re+4>>3)];m[w-D]=Fi[255+V+Lc[112+(re+3>>3)]],m[w+0]=Fi[255+Y-ie]}function Sc(m,w,D,V){var Y=m[w+0],re=m[w+D];return Ss[255+m[w-2*D]-m[w-D]]>V||Ss[255+re-Y]>V}function zo(m,w,D,V){return 4*Ss[255+m[w-D]-m[w+0]]+Ss[255+m[w-2*D]-m[w+D]]<=V}function Ho(m,w,D,V,Y){var re=m[w-3*D],ie=m[w-2*D],le=m[w-D],pe=m[w+0],ye=m[w+D],Ie=m[w+2*D],Ge=m[w+3*D];return 4*Ss[255+le-pe]+Ss[255+ie-ye]>V?0:Ss[255+m[w-4*D]-re]<=Y&&Ss[255+re-ie]<=Y&&Ss[255+ie-le]<=Y&&Ss[255+Ge-Ie]<=Y&&Ss[255+Ie-ye]<=Y&&Ss[255+ye-pe]<=Y}function ss(m,w,D,V){var Y=2*V+1;for(V=0;16>V;++V)zo(m,w+V,D,Y)&&ys(m,w+V,D)}function ia(m,w,D,V){var Y=2*V+1;for(V=0;16>V;++V)zo(m,w+V*D,1,Y)&&ys(m,w+V*D,1)}function ii(m,w,D,V){var Y;for(Y=3;0<Y;--Y)ss(m,w+=4*D,D,V)}function vu(m,w,D,V){var Y;for(Y=3;0<Y;--Y)ia(m,w+=4,D,V)}function po(m,w,D,V,Y,re,ie,le){for(re=2*re+1;0<Y--;){if(Ho(m,w,D,re,ie))if(Sc(m,w,D,le))ys(m,w,D);else{var pe=m,ye=w,Ie=D,Ge=pe[ye-2*Ie],qe=pe[ye-Ie],je=pe[ye+0],ft=pe[ye+Ie],Ze=pe[ye+2*Ie],Re=27*(at=zh[1020+3*(je-qe)+zh[1020+Ge-ft]])+63>>7,De=18*at+63>>7,at=9*at+63>>7;pe[ye-3*Ie]=Fi[255+pe[ye-3*Ie]+at],pe[ye-2*Ie]=Fi[255+Ge+De],pe[ye-Ie]=Fi[255+qe+Re],pe[ye+0]=Fi[255+je-Re],pe[ye+Ie]=Fi[255+ft-De],pe[ye+2*Ie]=Fi[255+Ze-at]}w+=V}}function Yi(m,w,D,V,Y,re,ie,le){for(re=2*re+1;0<Y--;){if(Ho(m,w,D,re,ie))if(Sc(m,w,D,le))ys(m,w,D);else{var pe=m,ye=w,Ie=D,Ge=pe[ye-Ie],qe=pe[ye+0],je=pe[ye+Ie],ft=Lc[112+((Ze=3*(qe-Ge))+4>>3)],Ze=Lc[112+(Ze+3>>3)],Re=ft+1>>1;pe[ye-2*Ie]=Fi[255+pe[ye-2*Ie]+Re],pe[ye-Ie]=Fi[255+Ge+Ze],pe[ye+0]=Fi[255+qe-ft],pe[ye+Ie]=Fi[255+je-Re]}w+=V}}function mo(m,w,D,V,Y,re){po(m,w,D,1,16,V,Y,re)}function Us(m,w,D,V,Y,re){po(m,w,1,D,16,V,Y,re)}function Cl(m,w,D,V,Y,re){var ie;for(ie=3;0<ie;--ie)Yi(m,w+=4*D,D,1,16,V,Y,re)}function Go(m,w,D,V,Y,re){var ie;for(ie=3;0<ie;--ie)Yi(m,w+=4,1,D,16,V,Y,re)}function Il(m,w,D,V,Y,re,ie,le){po(m,w,Y,1,8,re,ie,le),po(D,V,Y,1,8,re,ie,le)}function Ac(m,w,D,V,Y,re,ie,le){po(m,w,1,Y,8,re,ie,le),po(D,V,1,Y,8,re,ie,le)}function Wo(m,w,D,V,Y,re,ie,le){Yi(m,w+4*Y,Y,1,8,re,ie,le),Yi(D,V+4*Y,Y,1,8,re,ie,le)}function go(m,w,D,V,Y,re,ie,le){Yi(m,w+4,1,Y,8,re,ie,le),Yi(D,V+4,1,Y,8,re,ie,le)}function Xo(){this.ba=new Yn,this.ec=[],this.cc=[],this.Mc=[],this.Dc=this.Nc=this.dc=this.fc=0,this.Oa=new Jr,this.memory=0,this.Ib="OutputFunc",this.Jb="OutputAlphaFunc",this.Nd="OutputRowFunc"}function Rl(){this.data=[],this.offset=this.kd=this.ha=this.w=0,this.na=[],this.xa=this.gb=this.Ja=this.Sa=this.P=0}function Yo(){this.nc=this.Ea=this.b=this.hc=0,this.K=[],this.w=0}function vo(){this.ua=0,this.Wa=new ge,this.vb=new ge,this.md=this.xc=this.wc=0,this.vc=[],this.Wb=0,this.Ya=new se,this.yc=new C}function _u(){this.xb=this.a=0,this.l=new va,this.ca=new Yn,this.V=[],this.Ba=0,this.Ta=[],this.Ua=0,this.m=new L,this.Pb=0,this.wd=new L,this.Ma=this.$=this.C=this.i=this.c=this.xd=0,this.s=new vo,this.ab=0,this.gc=o(4,Yo),this.Oc=0}function Vs(){this.Lc=this.Z=this.$a=this.i=this.c=0,this.l=new va,this.ic=0,this.ca=[],this.tb=0,this.qd=null,this.rd=0}function _o(m,w,D,V,Y,re,ie){for(m=m==null?0:m[w+0],w=0;w<ie;++w)Y[re+w]=m+D[V+w]&255,m=Y[re+w]}function Ko(m,w,D,V,Y,re,ie){var le;if(m==null)_o(null,null,D,V,Y,re,ie);else for(le=0;le<ie;++le)Y[re+le]=m[w+le]+D[V+le]&255}function aa(m,w,D,V,Y,re,ie){if(m==null)_o(null,null,D,V,Y,re,ie);else{var le,pe=m[w+0],ye=pe,Ie=pe;for(le=0;le<ie;++le)ye=Ie+(pe=m[w+le])-ye,Ie=D[V+le]+(-256&ye?0>ye?0:255:ye)&255,ye=pe,Y[re+le]=Ie}}function Ll(m,w,D,V){var Y=w.width,re=w.o;if(e(m!=null&&w!=null),0>D||0>=V||D+V>re)return null;if(!m.Cc){if(m.ga==null){var ie;if(m.ga=new Vs,(ie=m.ga==null)||(ie=w.width*w.o,e(m.Gb.length==0),m.Gb=a(ie),m.Uc=0,m.Gb==null?ie=0:(m.mb=m.Gb,m.nb=m.Uc,m.rc=null,ie=1),ie=!ie),!ie){ie=m.ga;var le=m.Fa,pe=m.P,ye=m.qc,Ie=m.mb,Ge=m.nb,qe=pe+1,je=ye-1,ft=ie.l;if(e(le!=null&&Ie!=null&&w!=null),So[0]=null,So[1]=_o,So[2]=Ko,So[3]=aa,ie.ca=Ie,ie.tb=Ge,ie.c=w.width,ie.i=w.height,e(0<ie.c&&0<ie.i),1>=ye)w=0;else if(ie.$a=le[pe+0]>>0&3,ie.Z=le[pe+0]>>2&3,ie.Lc=le[pe+0]>>4&3,pe=le[pe+0]>>6&3,0>ie.$a||1<ie.$a||4<=ie.Z||1<ie.Lc||pe)w=0;else if(ft.put=pi,ft.ac=Dn,ft.bc=ga,ft.ma=ie,ft.width=w.width,ft.height=w.height,ft.Da=w.Da,ft.v=w.v,ft.va=w.va,ft.j=w.j,ft.o=w.o,ie.$a)e:{e(ie.$a==1),w=$e();t:for(;;){if(w==null){w=0;break e}if(e(ie!=null),ie.mc=w,w.c=ie.c,w.i=ie.i,w.l=ie.l,w.l.ma=ie,w.l.width=ie.c,w.l.height=ie.i,w.a=0,oe(w.m,le,qe,je),!Me(ie.c,ie.i,1,w,null)||(w.ab==1&&w.gc[0].hc==3&&me(w.s)?(ie.ic=1,le=w.c*w.i,w.Ta=null,w.Ua=0,w.V=a(le),w.Ba=0,w.V==null?(w.a=1,w=0):w=1):(ie.ic=0,w=He(w,ie.c)),!w))break t;w=1;break e}ie.mc=null,w=0}else w=je>=ie.c*ie.i;ie=!w}if(ie)return null;m.ga.Lc!=1?m.Ga=0:V=re-D}e(m.ga!=null),e(D+V<=re);e:{if(w=(le=m.ga).c,re=le.l.o,le.$a==0){if(qe=m.rc,je=m.Vc,ft=m.Fa,pe=m.P+1+D*w,ye=m.mb,Ie=m.nb+D*w,e(pe<=m.P+m.qc),le.Z!=0)for(e(So[le.Z]!=null),ie=0;ie<V;++ie)So[le.Z](qe,je,ft,pe,ye,Ie,w),qe=ye,je=Ie,Ie+=w,pe+=w;else for(ie=0;ie<V;++ie)n(ye,Ie,ft,pe,w),qe=ye,je=Ie,Ie+=w,pe+=w;m.rc=qe,m.Vc=je}else{if(e(le.mc!=null),w=D+V,e((ie=le.mc)!=null),e(w<=ie.i),ie.C>=w)w=1;else if(le.ic||Be(),le.ic){le=ie.V,qe=ie.Ba,je=ie.c;var Ze=ie.i,Re=(ft=1,pe=ie.$/je,ye=ie.$%je,Ie=ie.m,Ge=ie.s,ie.$),De=je*Ze,at=je*w,ht=Ge.wc,ct=Re<at?Fn(Ge,ye,pe):null;e(Re<=De),e(w<=Ze),e(me(Ge));t:for(;;){for(;!Ie.h&&Re<at;){if(ye&ht||(ct=Fn(Ge,ye,pe)),e(ct!=null),ae(Ie),256>(Ze=gn(ct.G[0],ct.H[0],Ie)))le[qe+Re]=Ze,++Re,++ye>=je&&(ye=0,++pe<=w&&!(pe%16)&&we(ie,pe));else{if(!(280>Ze)){ft=0;break t}Ze=Zr(Ze-256,Ie);var Ut,Lt=gn(ct.G[4],ct.H[4],Ie);if(ae(Ie),!(Re>=(Lt=Hr(je,Lt=Zr(Lt,Ie)))&&De-Re>=Ze)){ft=0;break t}for(Ut=0;Ut<Ze;++Ut)le[qe+Re+Ut]=le[qe+Re+Ut-Lt];for(Re+=Ze,ye+=Ze;ye>=je;)ye-=je,++pe<=w&&!(pe%16)&&we(ie,pe);Re<at&&ye&ht&&(ct=Fn(Ge,ye,pe))}e(Ie.h==z(Ie))}we(ie,pe>w?w:pe);break t}!ft||Ie.h&&Re<De?(ft=0,ie.a=Ie.h?5:3):ie.$=Re,w=ft}else w=Se(ie,ie.V,ie.Ba,ie.c,ie.i,w,Ye);if(!w){V=0;break e}}D+V>=re&&(m.Cc=1),V=1}if(!V)return null;if(m.Cc&&((V=m.ga)!=null&&(V.mc=null),m.ga=null,0<m.Ga))return alert("todo:WebPDequantizeLevels"),null}return m.nb+D*Y}function N(m,w,D,V,Y,re){for(;0<Y--;){var ie,le=m,pe=w+(D?1:0),ye=m,Ie=w+(D?0:3);for(ie=0;ie<V;++ie){var Ge=ye[Ie+4*ie];Ge!=255&&(Ge*=32897,le[pe+4*ie+0]=le[pe+4*ie+0]*Ge>>23,le[pe+4*ie+1]=le[pe+4*ie+1]*Ge>>23,le[pe+4*ie+2]=le[pe+4*ie+2]*Ge>>23)}w+=re}}function K(m,w,D,V,Y){for(;0<V--;){var re;for(re=0;re<D;++re){var ie=m[w+2*re+0],le=15&(ye=m[w+2*re+1]),pe=4369*le,ye=(240&ye|ye>>4)*pe>>16;m[w+2*re+0]=(240&ie|ie>>4)*pe>>16&240|(15&ie|ie<<4)*pe>>16>>4&15,m[w+2*re+1]=240&ye|le}w+=Y}}function Te(m,w,D,V,Y,re,ie,le){var pe,ye,Ie=255;for(ye=0;ye<Y;++ye){for(pe=0;pe<V;++pe){var Ge=m[w+pe];re[ie+4*pe]=Ge,Ie&=Ge}w+=D,ie+=le}return Ie!=255}function Ne(m,w,D,V,Y){var re;for(re=0;re<Y;++re)D[V+re]=m[w+re]>>8}function Be(){os=N,Cr=K,Ir=Te,Tn=Ne}function tt(m,w,D){k[m]=function(V,Y,re,ie,le,pe,ye,Ie,Ge,qe,je,ft,Ze,Re,De,at,ht){var ct,Ut=ht-1>>1,Lt=le[pe+0]|ye[Ie+0]<<16,Yt=Ge[qe+0]|je[ft+0]<<16;e(V!=null);var Ot=3*Lt+Yt+131074>>2;for(w(V[Y+0],255&Ot,Ot>>16,Ze,Re),re!=null&&(Ot=3*Yt+Lt+131074>>2,w(re[ie+0],255&Ot,Ot>>16,De,at)),ct=1;ct<=Ut;++ct){var Xr=le[pe+ct]|ye[Ie+ct]<<16,sn=Ge[qe+ct]|je[ft+ct]<<16,Ar=Lt+Xr+Yt+sn+524296,Er=Ar+2*(Xr+Yt)>>3;Ot=Er+Lt>>1,Lt=(Ar=Ar+2*(Lt+sn)>>3)+Xr>>1,w(V[Y+2*ct-1],255&Ot,Ot>>16,Ze,Re+(2*ct-1)*D),w(V[Y+2*ct-0],255&Lt,Lt>>16,Ze,Re+(2*ct-0)*D),re!=null&&(Ot=Ar+Yt>>1,Lt=Er+sn>>1,w(re[ie+2*ct-1],255&Ot,Ot>>16,De,at+(2*ct-1)*D),w(re[ie+2*ct+0],255&Lt,Lt>>16,De,at+(2*ct+0)*D)),Lt=Xr,Yt=sn}1&ht||(Ot=3*Lt+Yt+131074>>2,w(V[Y+ht-1],255&Ot,Ot>>16,Ze,Re+(ht-1)*D),re!=null&&(Ot=3*Yt+Lt+131074>>2,w(re[ie+ht-1],255&Ot,Ot>>16,De,at+(ht-1)*D)))}}function yt(){Oi[sa]=il,Oi[bu]=Ao,Oi[Eo]=Wl,Oi[Bf]=Wh,Oi[Dc]=Xh,Oi[Zo]=Tu,Oi[Hh]=Yh,Oi[jf]=Ao,Oi[Hl]=Wh,Oi[el]=Xh,Oi[Su]=Tu}function Ft(m){return m&-16384?0>m?0:255:m>>A2}function v(m,w){return Ft((19077*m>>8)+(26149*w>>8)-14234)}function P(m,w,D){return Ft((19077*m>>8)-(6419*w>>8)-(13320*D>>8)+8708)}function q(m,w){return Ft((19077*m>>8)+(33050*w>>8)-17685)}function ce(m,w,D,V,Y){V[Y+0]=v(m,D),V[Y+1]=P(m,w,D),V[Y+2]=q(m,w)}function Fe(m,w,D,V,Y){V[Y+0]=q(m,w),V[Y+1]=P(m,w,D),V[Y+2]=v(m,D)}function We(m,w,D,V,Y){var re=P(m,w,D);w=re<<3&224|q(m,w)>>3,V[Y+0]=248&v(m,D)|re>>5,V[Y+1]=w}function wt(m,w,D,V,Y){var re=240&q(m,w)|15;V[Y+0]=240&v(m,D)|P(m,w,D)>>4,V[Y+1]=re}function rr(m,w,D,V,Y){V[Y+0]=255,ce(m,w,D,V,Y+1)}function Pr(m,w,D,V,Y){Fe(m,w,D,V,Y),V[Y+3]=255}function mr(m,w,D,V,Y){ce(m,w,D,V,Y),V[Y+3]=255}function an(m,w){return 0>m?0:m>w?w:m}function dn(m,w,D){k[m]=function(V,Y,re,ie,le,pe,ye,Ie,Ge){for(var qe=Ie+(-2&Ge)*D;Ie!=qe;)w(V[Y+0],re[ie+0],le[pe+0],ye,Ie),w(V[Y+1],re[ie+0],le[pe+0],ye,Ie+D),Y+=2,++ie,++pe,Ie+=2*D;1&Ge&&w(V[Y+0],re[ie+0],le[pe+0],ye,Ie)}}function ws(m,w,D){return D==0?m==0?w==0?6:5:w==0?4:0:D}function Kn(m,w,D,V,Y){switch(m>>>30){case 3:zs(w,D,V,Y,0);break;case 2:Hn(w,D,V,Y);break;case 1:ai(w,D,V,Y)}}function Pa(m,w){var D,V,Y=w.M,re=w.Nb,ie=m.oc,le=m.pc+40,pe=m.oc,ye=m.pc+584,Ie=m.oc,Ge=m.pc+600;for(D=0;16>D;++D)ie[le+32*D-1]=129;for(D=0;8>D;++D)pe[ye+32*D-1]=129,Ie[Ge+32*D-1]=129;for(0<Y?ie[le-1-32]=pe[ye-1-32]=Ie[Ge-1-32]=129:(i(ie,le-32-1,127,21),i(pe,ye-32-1,127,9),i(Ie,Ge-32-1,127,9)),V=0;V<m.za;++V){var qe=w.ya[w.aa+V];if(0<V){for(D=-1;16>D;++D)n(ie,le+32*D-4,ie,le+32*D+12,4);for(D=-1;8>D;++D)n(pe,ye+32*D-4,pe,ye+32*D+4,4),n(Ie,Ge+32*D-4,Ie,Ge+32*D+4,4)}var je=m.Gd,ft=m.Hd+V,Ze=qe.ad,Re=qe.Hc;if(0<Y&&(n(ie,le-32,je[ft].y,0,16),n(pe,ye-32,je[ft].f,0,8),n(Ie,Ge-32,je[ft].ea,0,8)),qe.Za){var De=ie,at=le-32+16;for(0<Y&&(V>=m.za-1?i(De,at,je[ft].y[15],4):n(De,at,je[ft+1].y,0,4)),D=0;4>D;D++)De[at+128+D]=De[at+256+D]=De[at+384+D]=De[at+0+D];for(D=0;16>D;++D,Re<<=2)De=ie,at=le+Mc[D],ya[qe.Ob[D]](De,at),Kn(Re,Ze,16*+D,De,at)}else if(De=ws(V,Y,qe.Ob[0]),nl[De](ie,le),Re!=0)for(D=0;16>D;++D,Re<<=2)Kn(Re,Ze,16*+D,ie,le+Mc[D]);for(D=qe.Gc,De=ws(V,Y,qe.Dd),cs[De](pe,ye),cs[De](Ie,Ge),Re=Ze,De=pe,at=ye,255&(qe=D>>0)&&(170&qe?Hs(Re,256,De,at):ja(Re,256,De,at)),qe=Ie,Re=Ge,255&(D>>=8)&&(170&D?Hs(Ze,320,qe,Re):ja(Ze,320,qe,Re)),Y<m.Ub-1&&(n(je[ft].y,0,ie,le+480,16),n(je[ft].f,0,pe,ye+224,8),n(je[ft].ea,0,Ie,Ge+224,8)),D=8*re*m.B,je=m.sa,ft=m.ta+16*V+16*re*m.R,Ze=m.qa,qe=m.ra+8*V+D,Re=m.Ha,De=m.Ia+8*V+D,D=0;16>D;++D)n(je,ft+D*m.R,ie,le+32*D,16);for(D=0;8>D;++D)n(Ze,qe+D*m.B,pe,ye+32*D,8),n(Re,De+D*m.B,Ie,Ge+32*D,8)}}function xo(m,w,D,V,Y,re,ie,le,pe){var ye=[0],Ie=[0],Ge=0,qe=pe!=null?pe.kd:0,je=pe??new Rl;if(m==null||12>D)return 7;je.data=m,je.w=w,je.ha=D,w=[w],D=[D],je.gb=[je.gb];e:{var ft=w,Ze=D,Re=je.gb;if(e(m!=null),e(Ze!=null),e(Re!=null),Re[0]=0,12<=Ze[0]&&!r(m,ft[0],"RIFF")){if(r(m,ft[0]+8,"WEBP")){Re=3;break e}var De=rt(m,ft[0]+4);if(12>De||4294967286<De){Re=3;break e}if(qe&&De>Ze[0]-8){Re=7;break e}Re[0]=De,ft[0]+=12,Ze[0]-=12}Re=0}if(Re!=0)return Re;for(De=0<je.gb[0],D=D[0];;){e:{var at=m;Ze=w,Re=D;var ht=ye,ct=Ie,Ut=ft=[0];if((Ot=Ge=[Ge])[0]=0,8>Re[0])Re=7;else{if(!r(at,Ze[0],"VP8X")){if(rt(at,Ze[0]+4)!=10){Re=3;break e}if(18>Re[0]){Re=7;break e}var Lt=rt(at,Ze[0]+8),Yt=1+fe(at,Ze[0]+12);if(2147483648<=Yt*(at=1+fe(at,Ze[0]+15))){Re=3;break e}Ut!=null&&(Ut[0]=Lt),ht!=null&&(ht[0]=Yt),ct!=null&&(ct[0]=at),Ze[0]+=18,Re[0]-=18,Ot[0]=1}Re=0}}if(Ge=Ge[0],ft=ft[0],Re!=0)return Re;if(Ze=!!(2&ft),!De&&Ge)return 3;if(re!=null&&(re[0]=!!(16&ft)),ie!=null&&(ie[0]=Ze),le!=null&&(le[0]=0),ie=ye[0],ft=Ie[0],Ge&&Ze&&pe==null){Re=0;break}if(4>D){Re=7;break}if(De&&Ge||!De&&!Ge&&!r(m,w[0],"ALPH")){D=[D],je.na=[je.na],je.P=[je.P],je.Sa=[je.Sa];e:{Lt=m,Re=w,De=D;var Ot=je.gb;ht=je.na,ct=je.P,Ut=je.Sa,Yt=22,e(Lt!=null),e(De!=null),at=Re[0];var Xr=De[0];for(e(ht!=null),e(Ut!=null),ht[0]=null,ct[0]=null,Ut[0]=0;;){if(Re[0]=at,De[0]=Xr,8>Xr){Re=7;break e}var sn=rt(Lt,at+4);if(4294967286<sn){Re=3;break e}var Ar=8+sn+1&-2;if(Yt+=Ar,0<Ot&&Yt>Ot){Re=3;break e}if(!r(Lt,at,"VP8 ")||!r(Lt,at,"VP8L")){Re=0;break e}if(Xr[0]<Ar){Re=7;break e}r(Lt,at,"ALPH")||(ht[0]=Lt,ct[0]=at+8,Ut[0]=sn),at+=Ar,Xr-=Ar}}if(D=D[0],je.na=je.na[0],je.P=je.P[0],je.Sa=je.Sa[0],Re!=0)break}D=[D],je.Ja=[je.Ja],je.xa=[je.xa];e:if(Ot=m,Re=w,De=D,ht=je.gb[0],ct=je.Ja,Ut=je.xa,Lt=Re[0],at=!r(Ot,Lt,"VP8 "),Yt=!r(Ot,Lt,"VP8L"),e(Ot!=null),e(De!=null),e(ct!=null),e(Ut!=null),8>De[0])Re=7;else{if(at||Yt){if(Ot=rt(Ot,Lt+4),12<=ht&&Ot>ht-12){Re=3;break e}if(qe&&Ot>De[0]-8){Re=7;break e}ct[0]=Ot,Re[0]+=8,De[0]-=8,Ut[0]=Yt}else Ut[0]=5<=De[0]&&Ot[Lt+0]==47&&!(Ot[Lt+4]>>5),ct[0]=De[0];Re=0}if(D=D[0],je.Ja=je.Ja[0],je.xa=je.xa[0],w=w[0],Re!=0)break;if(4294967286<je.Ja)return 3;if(le==null||Ze||(le[0]=je.xa?2:1),ie=[ie],ft=[ft],je.xa){if(5>D){Re=7;break}le=ie,qe=ft,Ze=re,m==null||5>D?m=0:5<=D&&m[w+0]==47&&!(m[w+4]>>5)?(De=[0],Ot=[0],ht=[0],oe(ct=new L,m,w,D),jt(ct,De,Ot,ht)?(le!=null&&(le[0]=De[0]),qe!=null&&(qe[0]=Ot[0]),Ze!=null&&(Ze[0]=ht[0]),m=1):m=0):m=0}else{if(10>D){Re=7;break}le=ft,m==null||10>D||!Li(m,w+3,D-3)?m=0:(qe=m[w+0]|m[w+1]<<8|m[w+2]<<16,Ze=16383&(m[w+7]<<8|m[w+6]),m=16383&(m[w+9]<<8|m[w+8]),1&qe||3<(qe>>1&7)||!(qe>>4&1)||qe>>5>=je.Ja||!Ze||!m?m=0:(ie&&(ie[0]=Ze),le&&(le[0]=m),m=1))}if(!m||(ie=ie[0],ft=ft[0],Ge&&(ye[0]!=ie||Ie[0]!=ft)))return 3;pe!=null&&(pe[0]=je,pe.offset=w-pe.w,e(4294967286>w-pe.w),e(pe.offset==pe.ha-D));break}return Re==0||Re==7&&Ge&&pe==null?(re!=null&&(re[0]|=je.na!=null&&0<je.na.length),V!=null&&(V[0]=ie),Y!=null&&(Y[0]=ft),0):Re}function Dl(m,w,D){var V=w.width,Y=w.height,re=0,ie=0,le=V,pe=Y;if(w.Da=m!=null&&0<m.Da,w.Da&&(le=m.cd,pe=m.bd,re=m.v,ie=m.j,11>D||(re&=-2,ie&=-2),0>re||0>ie||0>=le||0>=pe||re+le>V||ie+pe>Y))return 0;if(w.v=re,w.j=ie,w.va=re+le,w.o=ie+pe,w.U=le,w.T=pe,w.da=m!=null&&0<m.da,w.da){if(!Je(le,pe,D=[m.ib],re=[m.hb]))return 0;w.ib=D[0],w.hb=re[0]}return w.ob=m!=null&&m.ob,w.Kb=m==null||!m.Sd,w.da&&(w.ob=w.ib<3*V/4&&w.hb<3*Y/4,w.Kb=0),1}function xu(m){if(m==null)return 2;if(11>m.S){var w=m.f.RGBA;w.fb+=(m.height-1)*w.A,w.A=-w.A}else w=m.f.kb,m=m.height,w.O+=(m-1)*w.fa,w.fa=-w.fa,w.N+=(m-1>>1)*w.Ab,w.Ab=-w.Ab,w.W+=(m-1>>1)*w.Db,w.Db=-w.Db,w.F!=null&&(w.J+=(m-1)*w.lb,w.lb=-w.lb);return 0}function Tc(m,w,D,V){if(V==null||0>=m||0>=w)return 2;if(D!=null){if(D.Da){var Y=D.cd,re=D.bd,ie=-2&D.v,le=-2&D.j;if(0>ie||0>le||0>=Y||0>=re||ie+Y>m||le+re>w)return 2;m=Y,w=re}if(D.da){if(!Je(m,w,Y=[D.ib],re=[D.hb]))return 2;m=Y[0],w=re[0]}}V.width=m,V.height=w;e:{var pe=V.width,ye=V.height;if(m=V.S,0>=pe||0>=ye||!(m>=sa&&13>m))m=2;else{if(0>=V.Rd&&V.sd==null){ie=re=Y=w=0;var Ie=(le=pe*Tp[m])*ye;if(11>m||(re=(ye+1)/2*(w=(pe+1)/2),m==12&&(ie=(Y=pe)*ye)),(ye=a(Ie+2*re+ie))==null){m=1;break e}V.sd=ye,11>m?((pe=V.f.RGBA).eb=ye,pe.fb=0,pe.A=le,pe.size=Ie):((pe=V.f.kb).y=ye,pe.O=0,pe.fa=le,pe.Fd=Ie,pe.f=ye,pe.N=0+Ie,pe.Ab=w,pe.Cd=re,pe.ea=ye,pe.W=0+Ie+re,pe.Db=w,pe.Ed=re,m==12&&(pe.F=ye,pe.J=0+Ie+2*re),pe.Tc=ie,pe.lb=Y)}if(w=1,Y=V.S,re=V.width,ie=V.height,Y>=sa&&13>Y)if(11>Y)m=V.f.RGBA,w&=(le=Math.abs(m.A))*(ie-1)+re<=m.size,w&=le>=re*Tp[Y],w&=m.eb!=null;else{m=V.f.kb,le=(re+1)/2,Ie=(ie+1)/2,pe=Math.abs(m.fa),ye=Math.abs(m.Ab);var Ge=Math.abs(m.Db),qe=Math.abs(m.lb),je=qe*(ie-1)+re;w&=pe*(ie-1)+re<=m.Fd,w&=ye*(Ie-1)+le<=m.Cd,w=(w&=Ge*(Ie-1)+le<=m.Ed)&pe>=re&ye>=le&Ge>=le,w&=m.y!=null,w&=m.f!=null,w&=m.ea!=null,Y==12&&(w&=qe>=re,w&=je<=m.Tc,w&=m.F!=null)}else w=0;m=w?0:2}}return m!=0||D!=null&&D.fd&&(m=xu(V)),m}var mi=64,Fl=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535,131071,262143,524287,1048575,2097151,4194303,8388607,16777215],kc=24,Nc=32,yu=8,Ma=[0,0,1,1,2,2,2,2,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7];vt("Predictor0","PredictorAdd0"),k.Predictor0=function(){return 4278190080},k.Predictor1=function(m){return m},k.Predictor2=function(m,w,D){return w[D+0]},k.Predictor3=function(m,w,D){return w[D+1]},k.Predictor4=function(m,w,D){return w[D-1]},k.Predictor5=function(m,w,D){return bt(bt(m,w[D+1]),w[D+0])},k.Predictor6=function(m,w,D){return bt(m,w[D-1])},k.Predictor7=function(m,w,D){return bt(m,w[D+0])},k.Predictor8=function(m,w,D){return bt(w[D-1],w[D+0])},k.Predictor9=function(m,w,D){return bt(w[D+0],w[D+1])},k.Predictor10=function(m,w,D){return bt(bt(m,w[D-1]),bt(w[D+0],w[D+1]))},k.Predictor11=function(m,w,D){var V=w[D+0];return 0>=qt(V>>24&255,m>>24&255,(w=w[D-1])>>24&255)+qt(V>>16&255,m>>16&255,w>>16&255)+qt(V>>8&255,m>>8&255,w>>8&255)+qt(255&V,255&m,255&w)?V:m},k.Predictor12=function(m,w,D){var V=w[D+0];return(Mt((m>>24&255)+(V>>24&255)-((w=w[D-1])>>24&255))<<24|Mt((m>>16&255)+(V>>16&255)-(w>>16&255))<<16|Mt((m>>8&255)+(V>>8&255)-(w>>8&255))<<8|Mt((255&m)+(255&V)-(255&w)))>>>0},k.Predictor13=function(m,w,D){var V=w[D-1];return(Dt((m=bt(m,w[D+0]))>>24&255,V>>24&255)<<24|Dt(m>>16&255,V>>16&255)<<16|Dt(m>>8&255,V>>8&255)<<8|Dt(m>>0&255,V>>0&255))>>>0};var dd=k.PredictorAdd0;k.PredictorAdd1=Tt,vt("Predictor2","PredictorAdd2"),vt("Predictor3","PredictorAdd3"),vt("Predictor4","PredictorAdd4"),vt("Predictor5","PredictorAdd5"),vt("Predictor6","PredictorAdd6"),vt("Predictor7","PredictorAdd7"),vt("Predictor8","PredictorAdd8"),vt("Predictor9","PredictorAdd9"),vt("Predictor10","PredictorAdd10"),vt("Predictor11","PredictorAdd11"),vt("Predictor12","PredictorAdd12"),vt("Predictor13","PredictorAdd13");var Pf=k.PredictorAdd2;Nt("ColorIndexInverseTransform","MapARGB","32b",function(m){return m>>8&255},function(m){return m}),Nt("VP8LColorIndexInverseTransformAlpha","MapAlpha","8b",function(m){return m},function(m){return m>>8&255});var qh,Es=k.ColorIndexInverseTransform,Di=k.MapARGB,Ol=k.VP8LColorIndexInverseTransformAlpha,Mf=k.MapAlpha,$o=k.VP8LPredictorsAdd=[];$o.length=16,(k.VP8LPredictors=[]).length=16,(k.VP8LPredictorsAdd_C=[]).length=16,(k.VP8LPredictors_C=[]).length=16;var Pl,xa,Ki,Ml,Ba,qs,yo,zs,Hn,Hs,ai,ja,Cc,wo,wu,Bl,jl,Ul,Ic,Eu,Vl,Qo,Rc,Gn,os,Cr,Ir,Tn,$n=a(511),bs=a(2041),ql=a(225),zl=a(767),Jo=0,zh=bs,Lc=ql,Fi=zl,Ss=$n,sa=0,bu=1,Eo=2,Bf=3,Dc=4,Zo=5,Hh=6,jf=7,Hl=8,el=9,Su=10,Gh=[2,3,7],As=[3,3,11],ls=[280,256,256,256,40],Fc=[0,1,1,1,0],tl=[17,18,0,1,2,3,4,5,16,6,7,8,9,10,11,12,13,14,15],rl=[24,7,23,25,40,6,39,41,22,26,38,42,56,5,55,57,21,27,54,58,37,43,72,4,71,73,20,28,53,59,70,74,36,44,88,69,75,52,60,3,87,89,19,29,86,90,35,45,68,76,85,91,51,61,104,2,103,105,18,30,102,106,34,46,84,92,67,77,101,107,50,62,120,1,119,121,83,93,17,31,100,108,66,78,118,122,33,47,117,123,49,63,99,109,82,94,0,116,124,65,79,16,32,98,110,48,115,125,81,95,64,114,126,97,111,80,113,127,96,112],Oc=[2954,2956,2958,2962,2970,2986,3018,3082,3212,3468,3980,5004],wp=8,Uf=[4,5,6,7,8,9,10,10,11,12,13,14,15,16,17,17,18,19,20,20,21,21,22,22,23,23,24,25,25,26,27,28,29,30,31,32,33,34,35,36,37,37,38,39,40,41,42,43,44,45,46,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,76,77,78,79,80,81,82,83,84,85,86,87,88,89,91,93,95,96,98,100,101,102,104,106,108,110,112,114,116,118,122,124,126,128,130,132,134,136,138,140,143,145,148,151,154,157],Vf=[4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,60,62,64,66,68,70,72,74,76,78,80,82,84,86,88,90,92,94,96,98,100,102,104,106,108,110,112,114,116,119,122,125,128,131,134,137,140,143,146,149,152,155,158,161,164,167,170,173,177,181,185,189,193,197,201,205,209,213,217,221,225,229,234,239,245,249,254,259,264,269,274,279,284],gi=null,Wn=[[173,148,140,0],[176,155,140,135,0],[180,157,141,134,130,0],[254,254,243,230,196,177,153,140,133,130,129,0]],en=[0,1,4,8,5,2,3,6,9,12,13,10,7,11,14,15],Gl=[-0,1,-1,2,-2,3,4,6,-3,5,-4,-5,-6,7,-7,8,-8,-9],bo=[[[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]],[[253,136,254,255,228,219,128,128,128,128,128],[189,129,242,255,227,213,255,219,128,128,128],[106,126,227,252,214,209,255,255,128,128,128]],[[1,98,248,255,236,226,255,255,128,128,128],[181,133,238,254,221,234,255,154,128,128,128],[78,134,202,247,198,180,255,219,128,128,128]],[[1,185,249,255,243,255,128,128,128,128,128],[184,150,247,255,236,224,128,128,128,128,128],[77,110,216,255,236,230,128,128,128,128,128]],[[1,101,251,255,241,255,128,128,128,128,128],[170,139,241,252,236,209,255,255,128,128,128],[37,116,196,243,228,255,255,255,128,128,128]],[[1,204,254,255,245,255,128,128,128,128,128],[207,160,250,255,238,128,128,128,128,128,128],[102,103,231,255,211,171,128,128,128,128,128]],[[1,152,252,255,240,255,128,128,128,128,128],[177,135,243,255,234,225,128,128,128,128,128],[80,129,211,255,194,224,128,128,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[246,1,255,128,128,128,128,128,128,128,128],[255,128,128,128,128,128,128,128,128,128,128]]],[[[198,35,237,223,193,187,162,160,145,155,62],[131,45,198,221,172,176,220,157,252,221,1],[68,47,146,208,149,167,221,162,255,223,128]],[[1,149,241,255,221,224,255,255,128,128,128],[184,141,234,253,222,220,255,199,128,128,128],[81,99,181,242,176,190,249,202,255,255,128]],[[1,129,232,253,214,197,242,196,255,255,128],[99,121,210,250,201,198,255,202,128,128,128],[23,91,163,242,170,187,247,210,255,255,128]],[[1,200,246,255,234,255,128,128,128,128,128],[109,178,241,255,231,245,255,255,128,128,128],[44,130,201,253,205,192,255,255,128,128,128]],[[1,132,239,251,219,209,255,165,128,128,128],[94,136,225,251,218,190,255,255,128,128,128],[22,100,174,245,186,161,255,199,128,128,128]],[[1,182,249,255,232,235,128,128,128,128,128],[124,143,241,255,227,234,128,128,128,128,128],[35,77,181,251,193,211,255,205,128,128,128]],[[1,157,247,255,236,231,255,255,128,128,128],[121,141,235,255,225,227,255,255,128,128,128],[45,99,188,251,195,217,255,224,128,128,128]],[[1,1,251,255,213,255,128,128,128,128,128],[203,1,248,255,255,128,128,128,128,128,128],[137,1,177,255,224,255,128,128,128,128,128]]],[[[253,9,248,251,207,208,255,192,128,128,128],[175,13,224,243,193,185,249,198,255,255,128],[73,17,171,221,161,179,236,167,255,234,128]],[[1,95,247,253,212,183,255,255,128,128,128],[239,90,244,250,211,209,255,255,128,128,128],[155,77,195,248,188,195,255,255,128,128,128]],[[1,24,239,251,218,219,255,205,128,128,128],[201,51,219,255,196,186,128,128,128,128,128],[69,46,190,239,201,218,255,228,128,128,128]],[[1,191,251,255,255,128,128,128,128,128,128],[223,165,249,255,213,255,128,128,128,128,128],[141,124,248,255,255,128,128,128,128,128,128]],[[1,16,248,255,255,128,128,128,128,128,128],[190,36,230,255,236,255,128,128,128,128,128],[149,1,255,128,128,128,128,128,128,128,128]],[[1,226,255,128,128,128,128,128,128,128,128],[247,192,255,128,128,128,128,128,128,128,128],[240,128,255,128,128,128,128,128,128,128,128]],[[1,134,252,255,255,128,128,128,128,128,128],[213,62,250,255,255,128,128,128,128,128,128],[55,93,255,128,128,128,128,128,128,128,128]],[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]]],[[[202,24,213,235,186,191,220,160,240,175,255],[126,38,182,232,169,184,228,174,255,187,128],[61,46,138,219,151,178,240,170,255,216,128]],[[1,112,230,250,199,191,247,159,255,255,128],[166,109,228,252,211,215,255,174,128,128,128],[39,77,162,232,172,180,245,178,255,255,128]],[[1,52,220,246,198,199,249,220,255,255,128],[124,74,191,243,183,193,250,221,255,255,128],[24,71,130,219,154,170,243,182,255,255,128]],[[1,182,225,249,219,240,255,224,128,128,128],[149,150,226,252,216,205,255,171,128,128,128],[28,108,170,242,183,194,254,223,255,255,128]],[[1,81,230,252,204,203,255,192,128,128,128],[123,102,209,247,188,196,255,233,128,128,128],[20,95,153,243,164,173,255,203,128,128,128]],[[1,222,248,255,216,213,128,128,128,128,128],[168,175,246,252,235,205,255,255,128,128,128],[47,116,215,255,211,212,255,255,128,128,128]],[[1,121,236,253,212,214,255,255,128,128,128],[141,84,213,252,201,202,255,219,128,128,128],[42,80,160,240,162,185,255,205,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[244,1,255,128,128,128,128,128,128,128,128],[238,1,255,128,128,128,128,128,128,128,128]]]],pd=[[[231,120,48,89,115,113,120,152,112],[152,179,64,126,170,118,46,70,95],[175,69,143,80,85,82,72,155,103],[56,58,10,171,218,189,17,13,152],[114,26,17,163,44,195,21,10,173],[121,24,80,195,26,62,44,64,85],[144,71,10,38,171,213,144,34,26],[170,46,55,19,136,160,33,206,71],[63,20,8,114,114,208,12,9,226],[81,40,11,96,182,84,29,16,36]],[[134,183,89,137,98,101,106,165,148],[72,187,100,130,157,111,32,75,80],[66,102,167,99,74,62,40,234,128],[41,53,9,178,241,141,26,8,107],[74,43,26,146,73,166,49,23,157],[65,38,105,160,51,52,31,115,128],[104,79,12,27,217,255,87,17,7],[87,68,71,44,114,51,15,186,23],[47,41,14,110,182,183,21,17,194],[66,45,25,102,197,189,23,18,22]],[[88,88,147,150,42,46,45,196,205],[43,97,183,117,85,38,35,179,61],[39,53,200,87,26,21,43,232,171],[56,34,51,104,114,102,29,93,77],[39,28,85,171,58,165,90,98,64],[34,22,116,206,23,34,43,166,73],[107,54,32,26,51,1,81,43,31],[68,25,106,22,64,171,36,225,114],[34,19,21,102,132,188,16,76,124],[62,18,78,95,85,57,50,48,51]],[[193,101,35,159,215,111,89,46,111],[60,148,31,172,219,228,21,18,111],[112,113,77,85,179,255,38,120,114],[40,42,1,196,245,209,10,25,109],[88,43,29,140,166,213,37,43,154],[61,63,30,155,67,45,68,1,209],[100,80,8,43,154,1,51,26,71],[142,78,78,16,255,128,34,197,171],[41,40,5,102,211,183,4,1,221],[51,50,17,168,209,192,23,25,82]],[[138,31,36,171,27,166,38,44,229],[67,87,58,169,82,115,26,59,179],[63,59,90,180,59,166,93,73,154],[40,40,21,116,143,209,34,39,175],[47,15,16,183,34,223,49,45,183],[46,17,33,183,6,98,15,32,183],[57,46,22,24,128,1,54,17,37],[65,32,73,115,28,128,23,128,205],[40,3,9,115,51,192,18,6,223],[87,37,9,115,59,77,64,21,47]],[[104,55,44,218,9,54,53,130,226],[64,90,70,205,40,41,23,26,57],[54,57,112,184,5,41,38,166,213],[30,34,26,133,152,116,10,32,134],[39,19,53,221,26,114,32,73,255],[31,9,65,234,2,15,1,118,73],[75,32,12,51,192,255,160,43,51],[88,31,35,67,102,85,55,186,85],[56,21,23,111,59,205,45,37,192],[55,38,70,124,73,102,1,34,98]],[[125,98,42,88,104,85,117,175,82],[95,84,53,89,128,100,113,101,45],[75,79,123,47,51,128,81,171,1],[57,17,5,71,102,57,53,41,49],[38,33,13,121,57,73,26,1,85],[41,10,67,138,77,110,90,47,114],[115,21,2,10,102,255,166,23,6],[101,29,16,10,85,128,101,196,26],[57,18,10,102,102,213,34,20,43],[117,20,15,36,163,128,68,1,26]],[[102,61,71,37,34,53,31,243,192],[69,60,71,38,73,119,28,222,37],[68,45,128,34,1,47,11,245,171],[62,17,19,70,146,85,55,62,70],[37,43,37,154,100,163,85,160,1],[63,9,92,136,28,64,32,201,85],[75,15,9,9,64,255,184,119,16],[86,6,28,5,64,255,25,248,1],[56,8,17,132,137,255,55,116,128],[58,15,20,82,135,57,26,121,40]],[[164,50,31,137,154,133,25,35,218],[51,103,44,131,131,123,31,6,158],[86,40,64,135,148,224,45,183,128],[22,26,17,131,240,154,14,1,209],[45,16,21,91,64,222,7,1,197],[56,21,39,155,60,138,23,102,213],[83,12,13,54,192,255,68,47,28],[85,26,85,85,128,128,32,146,171],[18,11,7,63,144,171,4,4,246],[35,27,10,146,174,171,12,26,128]],[[190,80,35,99,180,80,126,54,45],[85,126,47,87,176,51,41,20,32],[101,75,128,139,118,146,116,128,85],[56,41,15,176,236,85,37,9,62],[71,30,17,119,118,255,17,18,138],[101,38,60,138,55,70,43,26,142],[146,36,19,30,171,255,97,27,20],[138,45,61,62,219,1,81,188,64],[32,41,20,117,151,142,20,21,163],[112,19,12,61,195,128,48,4,24]]],Pc=[[[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[176,246,255,255,255,255,255,255,255,255,255],[223,241,252,255,255,255,255,255,255,255,255],[249,253,253,255,255,255,255,255,255,255,255]],[[255,244,252,255,255,255,255,255,255,255,255],[234,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255]],[[255,246,254,255,255,255,255,255,255,255,255],[239,253,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[251,255,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[251,254,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,254,253,255,254,255,255,255,255,255,255],[250,255,254,255,254,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[217,255,255,255,255,255,255,255,255,255,255],[225,252,241,253,255,255,254,255,255,255,255],[234,250,241,250,253,255,253,254,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[223,254,254,255,255,255,255,255,255,255,255],[238,253,254,254,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[249,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,255,255,255,255,255,255,255,255,255],[247,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[252,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[186,251,250,255,255,255,255,255,255,255,255],[234,251,244,254,255,255,255,255,255,255,255],[251,251,243,253,254,255,254,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[236,253,254,255,255,255,255,255,255,255,255],[251,253,253,254,254,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[254,254,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[254,254,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[248,255,255,255,255,255,255,255,255,255,255],[250,254,252,254,255,255,255,255,255,255,255],[248,254,249,253,255,255,255,255,255,255,255]],[[255,253,253,255,255,255,255,255,255,255,255],[246,253,253,255,255,255,255,255,255,255,255],[252,254,251,254,254,255,255,255,255,255,255]],[[255,254,252,255,255,255,255,255,255,255,255],[248,254,253,255,255,255,255,255,255,255,255],[253,255,254,254,255,255,255,255,255,255,255]],[[255,251,254,255,255,255,255,255,255,255,255],[245,251,254,255,255,255,255,255,255,255,255],[253,253,254,255,255,255,255,255,255,255,255]],[[255,251,253,255,255,255,255,255,255,255,255],[252,253,254,255,255,255,255,255,255,255,255],[255,254,255,255,255,255,255,255,255,255,255]],[[255,252,255,255,255,255,255,255,255,255,255],[249,255,254,255,255,255,255,255,255,255,255],[255,255,254,255,255,255,255,255,255,255,255]],[[255,255,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]]],Ep=[0,1,2,3,6,4,5,6,6,6,6,6,6,6,6,7,0],nl=[],ya=[],cs=[],bp=1,Au=2,So=[],Oi=[];tt("UpsampleRgbLinePair",ce,3),tt("UpsampleBgrLinePair",Fe,3),tt("UpsampleRgbaLinePair",mr,4),tt("UpsampleBgraLinePair",Pr,4),tt("UpsampleArgbLinePair",rr,4),tt("UpsampleRgba4444LinePair",wt,2),tt("UpsampleRgb565LinePair",We,2);var il=k.UpsampleRgbLinePair,Wl=k.UpsampleBgrLinePair,Ao=k.UpsampleRgbaLinePair,Wh=k.UpsampleBgraLinePair,Xh=k.UpsampleArgbLinePair,Tu=k.UpsampleRgba4444LinePair,Yh=k.UpsampleRgb565LinePair,To=16,vi=1<<To-1,Xl=-227,Kh=482,A2=6,Sp=0,T2=a(256),_i=a(256),md=a(256),qf=a(256),zf=a(Kh-Xl),gd=a(Kh-Xl);dn("YuvToRgbRow",ce,3),dn("YuvToBgrRow",Fe,3),dn("YuvToRgbaRow",mr,4),dn("YuvToBgraRow",Pr,4),dn("YuvToArgbRow",rr,4),dn("YuvToRgba4444Row",wt,2),dn("YuvToRgb565Row",We,2);var Mc=[0,4,8,12,128,132,136,140,256,260,264,268,384,388,392,396],al=[0,2,8],k2=[8,7,6,4,4,2,2,2,1,1,1,1],Ap=1;this.WebPDecodeRGBA=function(m,w,D,V,Y){var re=bu,ie=new Xo,le=new Yn;ie.ba=le,le.S=re,le.width=[le.width],le.height=[le.height];var pe=le.width,ye=le.height,Ie=new di;if(Ie==null||m==null)var Ge=2;else e(Ie!=null),Ge=xo(m,w,D,Ie.width,Ie.height,Ie.Pd,Ie.Qd,Ie.format,null);if(Ge!=0?pe=0:(pe!=null&&(pe[0]=Ie.width[0]),ye!=null&&(ye[0]=Ie.height[0]),pe=1),pe){le.width=le.width[0],le.height=le.height[0],V!=null&&(V[0]=le.width),Y!=null&&(Y[0]=le.height);e:{if(V=new va,(Y=new Rl).data=m,Y.w=w,Y.ha=D,Y.kd=1,w=[0],e(Y!=null),((m=xo(Y.data,Y.w,Y.ha,null,null,null,w,null,Y))==0||m==7)&&w[0]&&(m=4),(w=m)==0){if(e(ie!=null),V.data=Y.data,V.w=Y.w+Y.offset,V.ha=Y.ha-Y.offset,V.put=pi,V.ac=Dn,V.bc=ga,V.ma=ie,Y.xa){if((m=$e())==null){ie=1;break e}if(function(qe,je){var ft=[0],Ze=[0],Re=[0];t:for(;;){if(qe==null)return 0;if(je==null)return qe.a=2,0;if(qe.l=je,qe.a=0,oe(qe.m,je.data,je.w,je.ha),!jt(qe.m,ft,Ze,Re)){qe.a=3;break t}if(qe.xb=Au,je.width=ft[0],je.height=Ze[0],!Me(ft[0],Ze[0],1,qe,null))break t;return 1}return e(qe.a!=0),0}(m,V)){if(V=(w=Tc(V.width,V.height,ie.Oa,ie.ba))==0){t:{V=m;r:for(;;){if(V==null){V=0;break t}if(e(V.s.yc!=null),e(V.s.Ya!=null),e(0<V.s.Wb),e((D=V.l)!=null),e((Y=D.ma)!=null),V.xb!=0){if(V.ca=Y.ba,V.tb=Y.tb,e(V.ca!=null),!Dl(Y.Oa,D,Bf)){V.a=2;break r}if(!He(V,D.width)||D.da)break r;if((D.da||Tr(V.ca.S))&&Be(),11>V.ca.S||(alert("todo:WebPInitConvertARGBToYUV"),V.ca.f.kb.F!=null&&Be()),V.Pb&&0<V.s.ua&&V.s.vb.X==null&&!ot(V.s.vb,V.s.Wa.Xa)){V.a=1;break r}V.xb=0}if(!Se(V,V.V,V.Ba,V.c,V.i,D.o,be))break r;Y.Dc=V.Ma,V=1;break t}e(V.a!=0),V=0}V=!V}V&&(w=m.a)}else w=m.a}else{if((m=new Gi)==null){ie=1;break e}if(m.Fa=Y.na,m.P=Y.P,m.qc=Y.Sa,Tl(m,V)){if((w=Tc(V.width,V.height,ie.Oa,ie.ba))==0){if(m.Aa=0,D=ie.Oa,e((Y=m)!=null),D!=null){if(0<(pe=0>(pe=D.Md)?0:100<pe?255:255*pe/100)){for(ye=Ie=0;4>ye;++ye)12>(Ge=Y.pb[ye]).lc&&(Ge.ia=pe*k2[0>Ge.lc?0:Ge.lc]>>3),Ie|=Ge.ia;Ie&&(alert("todo:VP8InitRandom"),Y.ia=1)}Y.Ga=D.Id,100<Y.Ga?Y.Ga=100:0>Y.Ga&&(Y.Ga=0)}yc(m,V)||(w=m.a)}}else w=m.a}w==0&&ie.Oa!=null&&ie.Oa.fd&&(w=xu(ie.ba))}ie=w}re=ie!=0?null:11>re?le.f.RGBA.eb:le.f.kb.y}else re=null;return re};var Tp=[3,4,3,4,4,2,2,4,4,4,2,1,1]};function h(k,S){for(var U="",I=0;I<4;I++)U+=String.fromCharCode(k[S++]);return U}function d(k,S){return(k[S+0]<<0|k[S+1]<<8|k[S+2]<<16)>>>0}function g(k,S){return(k[S+0]<<0|k[S+1]<<8|k[S+2]<<16|k[S+3]<<24)>>>0}new u;var x=[0],_=[0],b=[],E=new u,A=t,O=function(k,S){var U={},I=0,C=!1,R=0,se=0;if(U.frames=[],!function(j,z,G,ae){for(var Ae=0;Ae<ae;Ae++)if(j[z+Ae]!=G.charCodeAt(Ae))return!0;return!1}(k,S,"RIFF",4)){for(g(k,S+=4),S+=8;S<k.length;){var ne=h(k,S),J=g(k,S+=4);S+=4;var de=J+(1&J);switch(ne){case"VP8 ":case"VP8L":U.frames[I]===void 0&&(U.frames[I]={}),(X=U.frames[I]).src_off=C?se:S-8,X.src_size=R+J+8,I++,C&&(C=!1,R=0,se=0);break;case"VP8X":(X=U.header={}).feature_flags=k[S];var oe=S+4;X.canvas_width=1+d(k,oe),oe+=3,X.canvas_height=1+d(k,oe),oe+=3;break;case"ALPH":C=!0,R=de+8,se=S-8;break;case"ANIM":(X=U.header).bgcolor=g(k,S),oe=S+4,X.loop_count=(xe=k)[(L=oe)+0]<<0|xe[L+1]<<8,oe+=2;break;case"ANMF":var Z,X;(X=U.frames[I]={}).offset_x=2*d(k,S),S+=3,X.offset_y=2*d(k,S),S+=3,X.width=1+d(k,S),S+=3,X.height=1+d(k,S),S+=3,X.duration=d(k,S),S+=3,Z=k[S++],X.dispose=1&Z,X.blend=Z>>1&1}ne!="ANMF"&&(S+=de)}var xe,L;return U}}(A,0);O.response=A,O.rgbaoutput=!0,O.dataurl=!1;var M=O.header?O.header:null,B=O.frames?O.frames:null;if(M){M.loop_counter=M.loop_count,x=[M.canvas_height],_=[M.canvas_width];for(var Q=0;Q<B.length&&B[Q].blend!=0;Q++);}var ee=B[0],he=E.WebPDecodeRGBA(A,ee.src_off,ee.src_size,_,x);ee.rgba=he,ee.imgwidth=_[0],ee.imgheight=x[0];for(var F=0;F<_[0]*x[0]*4;F++)b[F]=he[F];return this.width=_,this.height=x,this.data=b,this}(function(t){var e=function(){return typeof hx=="function"},r=function(x,_,b,E){var A=4,O=o;switch(E){case t.image_compression.FAST:A=1,O=a;break;case t.image_compression.MEDIUM:A=6,O=c;break;case t.image_compression.SLOW:A=9,O=u}x=n(x,_,b,O);var M=hx(x,{level:A});return t.__addimage__.arrayBufferToBinaryString(M)},n=function(x,_,b,E){for(var A,O,M,B=x.length/_,Q=new Uint8Array(x.length+B),ee=d(),he=0;he<B;he+=1){if(M=he*_,A=x.subarray(M,M+_),E)Q.set(E(A,b,O),M+he);else{for(var F,k=ee.length,S=[];F<k;F+=1)S[F]=ee[F](A,b,O);var U=g(S.concat());Q.set(S[U],M+he)}O=A}return Q},i=function(x){var _=Array.apply([],x);return _.unshift(0),_},a=function(x,_){var b,E=[],A=x.length;E[0]=1;for(var O=0;O<A;O+=1)b=x[O-_]||0,E[O+1]=x[O]-b+256&255;return E},o=function(x,_,b){var E,A=[],O=x.length;A[0]=2;for(var M=0;M<O;M+=1)E=b&&b[M]||0,A[M+1]=x[M]-E+256&255;return A},c=function(x,_,b){var E,A,O=[],M=x.length;O[0]=3;for(var B=0;B<M;B+=1)E=x[B-_]||0,A=b&&b[B]||0,O[B+1]=x[B]+256-(E+A>>>1)&255;return O},u=function(x,_,b){var E,A,O,M,B=[],Q=x.length;B[0]=4;for(var ee=0;ee<Q;ee+=1)E=x[ee-_]||0,A=b&&b[ee]||0,O=b&&b[ee-_]||0,M=h(E,A,O),B[ee+1]=x[ee]-M+256&255;return B},h=function(x,_,b){if(x===_&&_===b)return x;var E=Math.abs(_-b),A=Math.abs(x-b),O=Math.abs(x+_-b-b);return E<=A&&E<=O?x:A<=O?_:b},d=function(){return[i,a,o,c,u]},g=function(x){var _=x.map(function(b){return b.reduce(function(E,A){return E+Math.abs(A)},0)});return _.indexOf(Math.min.apply(null,_))};t.processPNG=function(x,_,b,E){var A,O,M,B,Q,ee,he,F,k,S,U,I,C,R,se,ne=this.decode.FLATE_DECODE,J="";if(this.__addimage__.isArrayBuffer(x)&&(x=new Uint8Array(x)),this.__addimage__.isArrayBufferView(x)){if(x=(M=new xX(x)).imgData,O=M.bits,A=M.colorSpace,Q=M.colors,[4,6].indexOf(M.colorType)!==-1){if(M.bits===8){k=(F=M.pixelBitlength==32?new Uint32Array(M.decodePixels().buffer):M.pixelBitlength==16?new Uint16Array(M.decodePixels().buffer):new Uint8Array(M.decodePixels().buffer)).length,U=new Uint8Array(k*M.colors),S=new Uint8Array(k);var de,oe=M.pixelBitlength-M.bits;for(R=0,se=0;R<k;R++){for(C=F[R],de=0;de<oe;)U[se++]=C>>>de&255,de+=M.bits;S[R]=C>>>de&255}}if(M.bits===16){k=(F=new Uint32Array(M.decodePixels().buffer)).length,U=new Uint8Array(k*(32/M.pixelBitlength)*M.colors),S=new Uint8Array(k*(32/M.pixelBitlength)),I=M.colors>1,R=0,se=0;for(var Z=0;R<k;)C=F[R++],U[se++]=C>>>0&255,I&&(U[se++]=C>>>16&255,C=F[R++],U[se++]=C>>>0&255),S[Z++]=C>>>16&255;O=8}E!==t.image_compression.NONE&&e()?(x=r(U,M.width*M.colors,M.colors,E),he=r(S,M.width,1,E)):(x=U,he=S,ne=void 0)}if(M.colorType===3&&(A=this.color_spaces.INDEXED,ee=M.palette,M.transparency.indexed)){var X=M.transparency.indexed,xe=0;for(R=0,k=X.length;R<k;++R)xe+=X[R];if((xe/=255)===k-1&&X.indexOf(0)!==-1)B=[X.indexOf(0)];else if(xe!==k){for(F=M.decodePixels(),S=new Uint8Array(F.length),R=0,k=F.length;R<k;R++)S[R]=X[F[R]];he=r(S,M.width,1)}}var L=function(j){var z;switch(j){case t.image_compression.FAST:z=11;break;case t.image_compression.MEDIUM:z=13;break;case t.image_compression.SLOW:z=14;break;default:z=12}return z}(E);return ne===this.decode.FLATE_DECODE&&(J="/Predictor "+L+" "),J+="/Colors "+Q+" /BitsPerComponent "+O+" /Columns "+M.width,(this.__addimage__.isArrayBuffer(x)||this.__addimage__.isArrayBufferView(x))&&(x=this.__addimage__.arrayBufferToBinaryString(x)),(he&&this.__addimage__.isArrayBuffer(he)||this.__addimage__.isArrayBufferView(he))&&(he=this.__addimage__.arrayBufferToBinaryString(he)),{alias:b,data:x,index:_,filter:ne,decodeParameters:J,transparency:B,palette:ee,sMask:he,predictor:L,width:M.width,height:M.height,bitsPerComponent:O,colorSpace:A}}}})(ar.API),function(t){t.processGIF89A=function(e,r,n,i){var a=new yX(e),o=a.width,c=a.height,u=[];a.decodeAndBlitFrameRGBA(0,u);var h={data:u,width:o,height:c},d=new g_(100).encode(h,100);return t.processJPEG.call(this,d,r,n,i)},t.processGIF87A=t.processGIF89A}(ar.API),pl.prototype.parseHeader=function(){if(this.fileSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.reserved=this.datav.getUint32(this.pos,!0),this.pos+=4,this.offset=this.datav.getUint32(this.pos,!0),this.pos+=4,this.headerSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.width=this.datav.getUint32(this.pos,!0),this.pos+=4,this.height=this.datav.getInt32(this.pos,!0),this.pos+=4,this.planes=this.datav.getUint16(this.pos,!0),this.pos+=2,this.bitPP=this.datav.getUint16(this.pos,!0),this.pos+=2,this.compress=this.datav.getUint32(this.pos,!0),this.pos+=4,this.rawSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.hr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.vr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.colors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.importantColors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.bitPP===16&&this.is_with_alpha&&(this.bitPP=15),this.bitPP<15){var t=this.colors===0?1<<this.bitPP:this.colors;this.palette=new Array(t);for(var e=0;e<t;e++){var r=this.datav.getUint8(this.pos++,!0),n=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0);this.palette[e]={red:i,green:n,blue:r,quad:a}}}this.height<0&&(this.height*=-1,this.bottom_up=!1)},pl.prototype.parseBGR=function(){this.pos=this.offset;try{var t="bit"+this.bitPP,e=this.width*this.height*4;this.data=new Uint8Array(e),this[t]()}catch(r){Ln.log("bit decode error:"+r)}},pl.prototype.bit1=function(){var t,e=Math.ceil(this.width/8),r=e%4;for(t=this.height-1;t>=0;t--){for(var n=this.bottom_up?t:this.height-1-t,i=0;i<e;i++)for(var a=this.datav.getUint8(this.pos++,!0),o=n*this.width*4+8*i*4,c=0;c<8&&8*i+c<this.width;c++){var u=this.palette[a>>7-c&1];this.data[o+4*c]=u.blue,this.data[o+4*c+1]=u.green,this.data[o+4*c+2]=u.red,this.data[o+4*c+3]=255}r!==0&&(this.pos+=4-r)}},pl.prototype.bit4=function(){for(var t=Math.ceil(this.width/2),e=t%4,r=this.height-1;r>=0;r--){for(var n=this.bottom_up?r:this.height-1-r,i=0;i<t;i++){var a=this.datav.getUint8(this.pos++,!0),o=n*this.width*4+2*i*4,c=a>>4,u=15&a,h=this.palette[c];if(this.data[o]=h.blue,this.data[o+1]=h.green,this.data[o+2]=h.red,this.data[o+3]=255,2*i+1>=this.width)break;h=this.palette[u],this.data[o+4]=h.blue,this.data[o+4+1]=h.green,this.data[o+4+2]=h.red,this.data[o+4+3]=255}e!==0&&(this.pos+=4-e)}},pl.prototype.bit8=function(){for(var t=this.width%4,e=this.height-1;e>=0;e--){for(var r=this.bottom_up?e:this.height-1-e,n=0;n<this.width;n++){var i=this.datav.getUint8(this.pos++,!0),a=r*this.width*4+4*n;if(i<this.palette.length){var o=this.palette[i];this.data[a]=o.red,this.data[a+1]=o.green,this.data[a+2]=o.blue,this.data[a+3]=255}else this.data[a]=255,this.data[a+1]=255,this.data[a+2]=255,this.data[a+3]=255}t!==0&&(this.pos+=4-t)}},pl.prototype.bit15=function(){for(var t=this.width%3,e=parseInt("11111",2),r=this.height-1;r>=0;r--){for(var n=this.bottom_up?r:this.height-1-r,i=0;i<this.width;i++){var a=this.datav.getUint16(this.pos,!0);this.pos+=2;var o=(a&e)/e*255|0,c=(a>>5&e)/e*255|0,u=(a>>10&e)/e*255|0,h=a>>15?255:0,d=n*this.width*4+4*i;this.data[d]=u,this.data[d+1]=c,this.data[d+2]=o,this.data[d+3]=h}this.pos+=t}},pl.prototype.bit16=function(){for(var t=this.width%3,e=parseInt("11111",2),r=parseInt("111111",2),n=this.height-1;n>=0;n--){for(var i=this.bottom_up?n:this.height-1-n,a=0;a<this.width;a++){var o=this.datav.getUint16(this.pos,!0);this.pos+=2;var c=(o&e)/e*255|0,u=(o>>5&r)/r*255|0,h=(o>>11)/e*255|0,d=i*this.width*4+4*a;this.data[d]=h,this.data[d+1]=u,this.data[d+2]=c,this.data[d+3]=255}this.pos+=t}},pl.prototype.bit24=function(){for(var t=this.height-1;t>=0;t--){for(var e=this.bottom_up?t:this.height-1-t,r=0;r<this.width;r++){var n=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0),o=e*this.width*4+4*r;this.data[o]=a,this.data[o+1]=i,this.data[o+2]=n,this.data[o+3]=255}this.pos+=this.width%4}},pl.prototype.bit32=function(){for(var t=this.height-1;t>=0;t--)for(var e=this.bottom_up?t:this.height-1-t,r=0;r<this.width;r++){var n=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0),o=this.datav.getUint8(this.pos++,!0),c=e*this.width*4+4*r;this.data[c]=a,this.data[c+1]=i,this.data[c+2]=n,this.data[c+3]=o}},pl.prototype.getData=function(){return this.data},function(t){t.processBMP=function(e,r,n,i){var a=new pl(e,!1),o=a.width,c=a.height,u={data:a.getData(),width:o,height:c},h=new g_(100).encode(u,100);return t.processJPEG.call(this,h,r,n,i)}}(ar.API),Ib.prototype.getData=function(){return this.data},function(t){t.processWEBP=function(e,r,n,i){var a=new Ib(e),o=a.width,c=a.height,u={data:a.getData(),width:o,height:c},h=new g_(100).encode(u,100);return t.processJPEG.call(this,h,r,n,i)}}(ar.API),ar.API.processRGBA=function(t,e,r){for(var n=t.data,i=n.length,a=new Uint8Array(i/4*3),o=new Uint8Array(i/4),c=0,u=0,h=0;h<i;h+=4){var d=n[h],g=n[h+1],x=n[h+2],_=n[h+3];a[c++]=d,a[c++]=g,a[c++]=x,o[u++]=_}var b=this.__addimage__.arrayBufferToBinaryString(a);return{alpha:this.__addimage__.arrayBufferToBinaryString(o),data:b,index:e,alias:r,colorSpace:"DeviceRGB",bitsPerComponent:8,width:t.width,height:t.height}},ar.API.setLanguage=function(t){return this.internal.languageSettings===void 0&&(this.internal.languageSettings={},this.internal.languageSettings.isSubscribed=!1),{af:"Afrikaans",sq:"Albanian",ar:"Arabic (Standard)","ar-DZ":"Arabic (Algeria)","ar-BH":"Arabic (Bahrain)","ar-EG":"Arabic (Egypt)","ar-IQ":"Arabic (Iraq)","ar-JO":"Arabic (Jordan)","ar-KW":"Arabic (Kuwait)","ar-LB":"Arabic (Lebanon)","ar-LY":"Arabic (Libya)","ar-MA":"Arabic (Morocco)","ar-OM":"Arabic (Oman)","ar-QA":"Arabic (Qatar)","ar-SA":"Arabic (Saudi Arabia)","ar-SY":"Arabic (Syria)","ar-TN":"Arabic (Tunisia)","ar-AE":"Arabic (U.A.E.)","ar-YE":"Arabic (Yemen)",an:"Aragonese",hy:"Armenian",as:"Assamese",ast:"Asturian",az:"Azerbaijani",eu:"Basque",be:"Belarusian",bn:"Bengali",bs:"Bosnian",br:"Breton",bg:"Bulgarian",my:"Burmese",ca:"Catalan",ch:"Chamorro",ce:"Chechen",zh:"Chinese","zh-HK":"Chinese (Hong Kong)","zh-CN":"Chinese (PRC)","zh-SG":"Chinese (Singapore)","zh-TW":"Chinese (Taiwan)",cv:"Chuvash",co:"Corsican",cr:"Cree",hr:"Croatian",cs:"Czech",da:"Danish",nl:"Dutch (Standard)","nl-BE":"Dutch (Belgian)",en:"English","en-AU":"English (Australia)","en-BZ":"English (Belize)","en-CA":"English (Canada)","en-IE":"English (Ireland)","en-JM":"English (Jamaica)","en-NZ":"English (New Zealand)","en-PH":"English (Philippines)","en-ZA":"English (South Africa)","en-TT":"English (Trinidad & Tobago)","en-GB":"English (United Kingdom)","en-US":"English (United States)","en-ZW":"English (Zimbabwe)",eo:"Esperanto",et:"Estonian",fo:"Faeroese",fj:"Fijian",fi:"Finnish",fr:"French (Standard)","fr-BE":"French (Belgium)","fr-CA":"French (Canada)","fr-FR":"French (France)","fr-LU":"French (Luxembourg)","fr-MC":"French (Monaco)","fr-CH":"French (Switzerland)",fy:"Frisian",fur:"Friulian",gd:"Gaelic (Scots)","gd-IE":"Gaelic (Irish)",gl:"Galacian",ka:"Georgian",de:"German (Standard)","de-AT":"German (Austria)","de-DE":"German (Germany)","de-LI":"German (Liechtenstein)","de-LU":"German (Luxembourg)","de-CH":"German (Switzerland)",el:"Greek",gu:"Gujurati",ht:"Haitian",he:"Hebrew",hi:"Hindi",hu:"Hungarian",is:"Icelandic",id:"Indonesian",iu:"Inuktitut",ga:"Irish",it:"Italian (Standard)","it-CH":"Italian (Switzerland)",ja:"Japanese",kn:"Kannada",ks:"Kashmiri",kk:"Kazakh",km:"Khmer",ky:"Kirghiz",tlh:"Klingon",ko:"Korean","ko-KP":"Korean (North Korea)","ko-KR":"Korean (South Korea)",la:"Latin",lv:"Latvian",lt:"Lithuanian",lb:"Luxembourgish",mk:"North Macedonia",ms:"Malay",ml:"Malayalam",mt:"Maltese",mi:"Maori",mr:"Marathi",mo:"Moldavian",nv:"Navajo",ng:"Ndonga",ne:"Nepali",no:"Norwegian",nb:"Norwegian (Bokmal)",nn:"Norwegian (Nynorsk)",oc:"Occitan",or:"Oriya",om:"Oromo",fa:"Persian","fa-IR":"Persian/Iran",pl:"Polish",pt:"Portuguese","pt-BR":"Portuguese (Brazil)",pa:"Punjabi","pa-IN":"Punjabi (India)","pa-PK":"Punjabi (Pakistan)",qu:"Quechua",rm:"Rhaeto-Romanic",ro:"Romanian","ro-MO":"Romanian (Moldavia)",ru:"Russian","ru-MO":"Russian (Moldavia)",sz:"Sami (Lappish)",sg:"Sango",sa:"Sanskrit",sc:"Sardinian",sd:"Sindhi",si:"Singhalese",sr:"Serbian",sk:"Slovak",sl:"Slovenian",so:"Somani",sb:"Sorbian",es:"Spanish","es-AR":"Spanish (Argentina)","es-BO":"Spanish (Bolivia)","es-CL":"Spanish (Chile)","es-CO":"Spanish (Colombia)","es-CR":"Spanish (Costa Rica)","es-DO":"Spanish (Dominican Republic)","es-EC":"Spanish (Ecuador)","es-SV":"Spanish (El Salvador)","es-GT":"Spanish (Guatemala)","es-HN":"Spanish (Honduras)","es-MX":"Spanish (Mexico)","es-NI":"Spanish (Nicaragua)","es-PA":"Spanish (Panama)","es-PY":"Spanish (Paraguay)","es-PE":"Spanish (Peru)","es-PR":"Spanish (Puerto Rico)","es-ES":"Spanish (Spain)","es-UY":"Spanish (Uruguay)","es-VE":"Spanish (Venezuela)",sx:"Sutu",sw:"Swahili",sv:"Swedish","sv-FI":"Swedish (Finland)","sv-SV":"Swedish (Sweden)",ta:"Tamil",tt:"Tatar",te:"Teluga",th:"Thai",tig:"Tigre",ts:"Tsonga",tn:"Tswana",tr:"Turkish",tk:"Turkmen",uk:"Ukrainian",hsb:"Upper Sorbian",ur:"Urdu",ve:"Venda",vi:"Vietnamese",vo:"Volapuk",wa:"Walloon",cy:"Welsh",xh:"Xhosa",ji:"Yiddish",zu:"Zulu"}[t]!==void 0&&(this.internal.languageSettings.languageCode=t,this.internal.languageSettings.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){this.internal.write("/Lang ("+this.internal.languageSettings.languageCode+")")}),this.internal.languageSettings.isSubscribed=!0)),this},w0=ar.API,Bm=w0.getCharWidthsArray=function(t,e){var r,n,i=(e=e||{}).font||this.internal.getFont(),a=e.fontSize||this.internal.getFontSize(),o=e.charSpace||this.internal.getCharSpace(),c=e.widths?e.widths:i.metadata.Unicode.widths,u=c.fof?c.fof:1,h=e.kerning?e.kerning:i.metadata.Unicode.kerning,d=h.fof?h.fof:1,g=e.doKerning!==!1,x=0,_=t.length,b=0,E=c[0]||u,A=[];for(r=0;r<_;r++)n=t.charCodeAt(r),typeof i.metadata.widthOfString=="function"?A.push((i.metadata.widthOfGlyph(i.metadata.characterToGlyph(n))+o*(1e3/a)||0)/1e3):(x=g&&Sn(h[n])==="object"&&!isNaN(parseInt(h[n][b],10))?h[n][b]/d:0,A.push((c[n]||E)/u+x)),b=n;return A},Tb=w0.getStringUnitWidth=function(t,e){var r=(e=e||{}).fontSize||this.internal.getFontSize(),n=e.font||this.internal.getFont(),i=e.charSpace||this.internal.getCharSpace();return w0.processArabic&&(t=w0.processArabic(t)),typeof n.metadata.widthOfString=="function"?n.metadata.widthOfString(t,r,i)/r:Bm.apply(this,arguments).reduce(function(a,o){return a+o},0)},kb=function(t,e,r,n){for(var i=[],a=0,o=t.length,c=0;a!==o&&c+e[a]<r;)c+=e[a],a++;i.push(t.slice(0,a));var u=a;for(c=0;a!==o;)c+e[a]>n&&(i.push(t.slice(u,a)),c=0,u=a),c+=e[a],a++;return u!==a&&i.push(t.slice(u,a)),i},Nb=function(t,e,r){r||(r={});var n,i,a,o,c,u,h,d=[],g=[d],x=r.textIndent||0,_=0,b=0,E=t.split(" "),A=Bm.apply(this,[" ",r])[0];if(u=r.lineIndent===-1?E[0].length+2:r.lineIndent||0){var O=Array(u).join(" "),M=[];E.map(function(Q){(Q=Q.split(/\s*\n/)).length>1?M=M.concat(Q.map(function(ee,he){return(he&&ee.length?`
`:"")+ee})):M.push(Q[0])}),E=M,u=Tb.apply(this,[O,r])}for(a=0,o=E.length;a<o;a++){var B=0;if(n=E[a],u&&n[0]==`
`&&(n=n.substr(1),B=1),x+_+(b=(i=Bm.apply(this,[n,r])).reduce(function(Q,ee){return Q+ee},0))>e||B){if(b>e){for(c=kb.apply(this,[n,i,e-(x+_),e]),d.push(c.shift()),d=[c.pop()];c.length;)g.push([c.shift()]);b=i.slice(n.length-(d[0]?d[0].length:0)).reduce(function(Q,ee){return Q+ee},0)}else d=[n];g.push(d),x=b+u,_=A}else d.push(n),x+=_+b,_=A}return h=u?function(Q,ee){return(ee?O:"")+Q.join(" ")}:function(Q){return Q.join(" ")},g.map(h)},w0.splitTextToSize=function(t,e,r){var n,i=(r=r||{}).fontSize||this.internal.getFontSize(),a=(function(d){if(d.widths&&d.kerning)return{widths:d.widths,kerning:d.kerning};var g=this.internal.getFont(d.fontName,d.fontStyle);return g.metadata.Unicode?{widths:g.metadata.Unicode.widths||{0:1},kerning:g.metadata.Unicode.kerning||{}}:{font:g.metadata,fontSize:this.internal.getFontSize(),charSpace:this.internal.getCharSpace()}}).call(this,r);n=Array.isArray(t)?t:String(t).split(/\r?\n/);var o=1*this.internal.scaleFactor*e/i;a.textIndent=r.textIndent?1*r.textIndent*this.internal.scaleFactor/i:0,a.lineIndent=r.lineIndent;var c,u,h=[];for(c=0,u=n.length;c<u;c++)h=h.concat(Nb.apply(this,[n[c],o,a]));return h},function(t){t.__fontmetrics__=t.__fontmetrics__||{};for(var e="klmnopqrstuvwxyz",r={},n={},i=0;i<e.length;i++)r[e[i]]="0123456789abcdef"[i],n["0123456789abcdef"[i]]=e[i];var a=function(g){return"0x"+parseInt(g,10).toString(16)},o=t.__fontmetrics__.compress=function(g){var x,_,b,E,A=["{"];for(var O in g){if(x=g[O],isNaN(parseInt(O,10))?_="'"+O+"'":(O=parseInt(O,10),_=(_=a(O).slice(2)).slice(0,-1)+n[_.slice(-1)]),typeof x=="number")x<0?(b=a(x).slice(3),E="-"):(b=a(x).slice(2),E=""),b=E+b.slice(0,-1)+n[b.slice(-1)];else{if(Sn(x)!=="object")throw new Error("Don't know what to do with value type "+Sn(x)+".");b=o(x)}A.push(_+b)}return A.push("}"),A.join("")},c=t.__fontmetrics__.uncompress=function(g){if(typeof g!="string")throw new Error("Invalid argument passed to uncompress.");for(var x,_,b,E,A={},O=1,M=A,B=[],Q="",ee="",he=g.length-1,F=1;F<he;F+=1)(E=g[F])=="'"?x?(b=x.join(""),x=void 0):x=[]:x?x.push(E):E=="{"?(B.push([M,b]),M={},b=void 0):E=="}"?((_=B.pop())[0][_[1]]=M,b=void 0,M=_[0]):E=="-"?O=-1:b===void 0?r.hasOwnProperty(E)?(Q+=r[E],b=parseInt(Q,16)*O,O=1,Q=""):Q+=E:r.hasOwnProperty(E)?(ee+=r[E],M[b]=parseInt(ee,16)*O,O=1,b=void 0,ee=""):ee+=E;return A},u={codePages:["WinAnsiEncoding"],WinAnsiEncoding:c("{19m8n201n9q201o9r201s9l201t9m201u8m201w9n201x9o201y8o202k8q202l8r202m9p202q8p20aw8k203k8t203t8v203u9v2cq8s212m9t15m8w15n9w2dw9s16k8u16l9u17s9z17x8y17y9y}")},h={Unicode:{Courier:u,"Courier-Bold":u,"Courier-BoldOblique":u,"Courier-Oblique":u,Helvetica:u,"Helvetica-Bold":u,"Helvetica-BoldOblique":u,"Helvetica-Oblique":u,"Times-Roman":u,"Times-Bold":u,"Times-BoldItalic":u,"Times-Italic":u}},d={Unicode:{"Courier-Oblique":c("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-BoldItalic":c("{'widths'{k3o2q4ycx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2r202m2n2n3m2o3m2p5n202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5n4l4m4m4m4n4m4o4s4p4m4q4m4r4s4s4y4t2r4u3m4v4m4w3x4x5t4y4s4z4s5k3x5l4s5m4m5n3r5o3x5p4s5q4m5r5t5s4m5t3x5u3x5v2l5w1w5x2l5y3t5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q2l6r3m6s3r6t1w6u1w6v3m6w1w6x4y6y3r6z3m7k3m7l3m7m2r7n2r7o1w7p3r7q2w7r4m7s3m7t2w7u2r7v2n7w1q7x2n7y3t202l3mcl4mal2ram3man3mao3map3mar3mas2lat4uau1uav3maw3way4uaz2lbk2sbl3t'fof'6obo2lbp3tbq3mbr1tbs2lbu1ybv3mbz3mck4m202k3mcm4mcn4mco4mcp4mcq5ycr4mcs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz2w203k6o212m6o2dw2l2cq2l3t3m3u2l17s3x19m3m}'kerning'{cl{4qu5kt5qt5rs17ss5ts}201s{201ss}201t{cks4lscmscnscoscpscls2wu2yu201ts}201x{2wu2yu}2k{201ts}2w{4qx5kx5ou5qx5rs17su5tu}2x{17su5tu5ou}2y{4qx5kx5ou5qx5rs17ss5ts}'fof'-6ofn{17sw5tw5ou5qw5rs}7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qs}3v{17su5tu5os5qs}7p{17su5tu}ck{4qu5kt5qt5rs17ss5ts}4l{4qu5kt5qt5rs17ss5ts}cm{4qu5kt5qt5rs17ss5ts}cn{4qu5kt5qt5rs17ss5ts}co{4qu5kt5qt5rs17ss5ts}cp{4qu5kt5qt5rs17ss5ts}6l{4qu5ou5qw5rt17su5tu}5q{ckuclucmucnucoucpu4lu}5r{ckuclucmucnucoucpu4lu}7q{cksclscmscnscoscps4ls}6p{4qu5ou5qw5rt17sw5tw}ek{4qu5ou5qw5rt17su5tu}el{4qu5ou5qw5rt17su5tu}em{4qu5ou5qw5rt17su5tu}en{4qu5ou5qw5rt17su5tu}eo{4qu5ou5qw5rt17su5tu}ep{4qu5ou5qw5rt17su5tu}es{17ss5ts5qs4qu}et{4qu5ou5qw5rt17sw5tw}eu{4qu5ou5qw5rt17ss5ts}ev{17ss5ts5qs4qu}6z{17sw5tw5ou5qw5rs}fm{17sw5tw5ou5qw5rs}7n{201ts}fo{17sw5tw5ou5qw5rs}fp{17sw5tw5ou5qw5rs}fq{17sw5tw5ou5qw5rs}7r{cksclscmscnscoscps4ls}fs{17sw5tw5ou5qw5rs}ft{17su5tu}fu{17su5tu}fv{17su5tu}fw{17su5tu}fz{cksclscmscnscoscps4ls}}}"),"Helvetica-Bold":c("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),Courier:c("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-BoldOblique":c("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Bold":c("{'widths'{k3q2q5ncx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2l202m2n2n3m2o3m2p6o202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5x4l4s4m4m4n4s4o4s4p4m4q3x4r4y4s4y4t2r4u3m4v4y4w4m4x5y4y4s4z4y5k3x5l4y5m4s5n3r5o4m5p4s5q4s5r6o5s4s5t4s5u4m5v2l5w1w5x2l5y3u5z3m6k2l6l3m6m3r6n2w6o3r6p2w6q2l6r3m6s3r6t1w6u2l6v3r6w1w6x5n6y3r6z3m7k3r7l3r7m2w7n2r7o2l7p3r7q3m7r4s7s3m7t3m7u2w7v2r7w1q7x2r7y3o202l3mcl4sal2lam3man3mao3map3mar3mas2lat4uau1yav3maw3tay4uaz2lbk2sbl3t'fof'6obo2lbp3rbr1tbs2lbu2lbv3mbz3mck4s202k3mcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3rek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3m3u2l17s4s19m3m}'kerning'{cl{4qt5ks5ot5qy5rw17sv5tv}201t{cks4lscmscnscoscpscls4wv}2k{201ts}2w{4qu5ku7mu5os5qx5ru17su5tu}2x{17su5tu5ou5qs}2y{4qv5kv7mu5ot5qz5ru17su5tu}'fof'-6o7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qu}3v{17su5tu5os5qu}fu{17su5tu5ou5qu}7p{17su5tu5ou5qu}ck{4qt5ks5ot5qy5rw17sv5tv}4l{4qt5ks5ot5qy5rw17sv5tv}cm{4qt5ks5ot5qy5rw17sv5tv}cn{4qt5ks5ot5qy5rw17sv5tv}co{4qt5ks5ot5qy5rw17sv5tv}cp{4qt5ks5ot5qy5rw17sv5tv}6l{17st5tt5ou5qu}17s{ckuclucmucnucoucpu4lu4wu}5o{ckuclucmucnucoucpu4lu4wu}5q{ckzclzcmzcnzcozcpz4lz4wu}5r{ckxclxcmxcnxcoxcpx4lx4wu}5t{ckuclucmucnucoucpu4lu4wu}7q{ckuclucmucnucoucpu4lu}6p{17sw5tw5ou5qu}ek{17st5tt5qu}el{17st5tt5ou5qu}em{17st5tt5qu}en{17st5tt5qu}eo{17st5tt5qu}ep{17st5tt5ou5qu}es{17ss5ts5qu}et{17sw5tw5ou5qu}eu{17sw5tw5ou5qu}ev{17ss5ts5qu}6z{17sw5tw5ou5qu5rs}fm{17sw5tw5ou5qu5rs}fn{17sw5tw5ou5qu5rs}fo{17sw5tw5ou5qu5rs}fp{17sw5tw5ou5qu5rs}fq{17sw5tw5ou5qu5rs}7r{cktcltcmtcntcotcpt4lt5os}fs{17sw5tw5ou5qu5rs}ft{17su5tu5ou5qu}7m{5os}fv{17su5tu5ou5qu}fw{17su5tu5ou5qu}fz{cksclscmscnscoscps4ls}}}"),Symbol:c("{'widths'{k3uaw4r19m3m2k1t2l2l202m2y2n3m2p5n202q6o3k3m2s2l2t2l2v3r2w1t3m3m2y1t2z1wbk2sbl3r'fof'6o3n3m3o3m3p3m3q3m3r3m3s3m3t3m3u1w3v1w3w3r3x3r3y3r3z2wbp3t3l3m5v2l5x2l5z3m2q4yfr3r7v3k7w1o7x3k}'kerning'{'fof'-6o}}"),Helvetica:c("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}"),"Helvetica-BoldOblique":c("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),ZapfDingbats:c("{'widths'{k4u2k1w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-Bold":c("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Italic":c("{'widths'{k3n2q4ycx2l201n3m201o5t201s2l201t2l201u2l201w3r201x3r201y3r2k1t2l2l202m2n2n3m2o3m2p5n202q5t2r1p2s2l2t2l2u3m2v4n2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w4n3x4n3y4n3z3m4k5w4l3x4m3x4n4m4o4s4p3x4q3x4r4s4s4s4t2l4u2w4v4m4w3r4x5n4y4m4z4s5k3x5l4s5m3x5n3m5o3r5p4s5q3x5r5n5s3x5t3r5u3r5v2r5w1w5x2r5y2u5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q1w6r3m6s3m6t1w6u1w6v2w6w1w6x4s6y3m6z3m7k3m7l3m7m2r7n2r7o1w7p3m7q2w7r4m7s2w7t2w7u2r7v2s7w1v7x2s7y3q202l3mcl3xal2ram3man3mao3map3mar3mas2lat4wau1vav3maw4nay4waz2lbk2sbl4n'fof'6obo2lbp3mbq3obr1tbs2lbu1zbv3mbz3mck3x202k3mcm3xcn3xco3xcp3xcq5tcr4mcs3xct3xcu3xcv3xcw2l2m2ucy2lcz2ldl4mdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr4nfs3mft3mfu3mfv3mfw3mfz2w203k6o212m6m2dw2l2cq2l3t3m3u2l17s3r19m3m}'kerning'{cl{5kt4qw}201s{201sw}201t{201tw2wy2yy6q-t}201x{2wy2yy}2k{201tw}2w{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}2x{17ss5ts5os}2y{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}'fof'-6o6t{17ss5ts5qs}7t{5os}3v{5qs}7p{17su5tu5qs}ck{5kt4qw}4l{5kt4qw}cm{5kt4qw}cn{5kt4qw}co{5kt4qw}cp{5kt4qw}6l{4qs5ks5ou5qw5ru17su5tu}17s{2ks}5q{ckvclvcmvcnvcovcpv4lv}5r{ckuclucmucnucoucpu4lu}5t{2ks}6p{4qs5ks5ou5qw5ru17su5tu}ek{4qs5ks5ou5qw5ru17su5tu}el{4qs5ks5ou5qw5ru17su5tu}em{4qs5ks5ou5qw5ru17su5tu}en{4qs5ks5ou5qw5ru17su5tu}eo{4qs5ks5ou5qw5ru17su5tu}ep{4qs5ks5ou5qw5ru17su5tu}es{5ks5qs4qs}et{4qs5ks5ou5qw5ru17su5tu}eu{4qs5ks5qw5ru17su5tu}ev{5ks5qs4qs}ex{17ss5ts5qs}6z{4qv5ks5ou5qw5ru17su5tu}fm{4qv5ks5ou5qw5ru17su5tu}fn{4qv5ks5ou5qw5ru17su5tu}fo{4qv5ks5ou5qw5ru17su5tu}fp{4qv5ks5ou5qw5ru17su5tu}fq{4qv5ks5ou5qw5ru17su5tu}7r{5os}fs{4qv5ks5ou5qw5ru17su5tu}ft{17su5tu5qs}fu{17su5tu5qs}fv{17su5tu5qs}fw{17su5tu5qs}}}"),"Times-Roman":c("{'widths'{k3n2q4ycx2l201n3m201o6o201s2l201t2l201u2l201w2w201x2w201y2w2k1t2l2l202m2n2n3m2o3m2p5n202q6o2r1m2s2l2t2l2u3m2v3s2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v1w3w3s3x3s3y3s3z2w4k5w4l4s4m4m4n4m4o4s4p3x4q3r4r4s4s4s4t2l4u2r4v4s4w3x4x5t4y4s4z4s5k3r5l4s5m4m5n3r5o3x5p4s5q4s5r5y5s4s5t4s5u3x5v2l5w1w5x2l5y2z5z3m6k2l6l2w6m3m6n2w6o3m6p2w6q2l6r3m6s3m6t1w6u1w6v3m6w1w6x4y6y3m6z3m7k3m7l3m7m2l7n2r7o1w7p3m7q3m7r4s7s3m7t3m7u2w7v3k7w1o7x3k7y3q202l3mcl4sal2lam3man3mao3map3mar3mas2lat4wau1vav3maw3say4waz2lbk2sbl3s'fof'6obo2lbp3mbq2xbr1tbs2lbu1zbv3mbz2wck4s202k3mcm4scn4sco4scp4scq5tcr4mcs3xct3xcu3xcv3xcw2l2m2tcy2lcz2ldl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek2wel2wem2wen2weo2wep2weq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr3sfs3mft3mfu3mfv3mfw3mfz3m203k6o212m6m2dw2l2cq2l3t3m3u1w17s4s19m3m}'kerning'{cl{4qs5ku17sw5ou5qy5rw201ss5tw201ws}201s{201ss}201t{ckw4lwcmwcnwcowcpwclw4wu201ts}2k{201ts}2w{4qs5kw5os5qx5ru17sx5tx}2x{17sw5tw5ou5qu}2y{4qs5kw5os5qx5ru17sx5tx}'fof'-6o7t{ckuclucmucnucoucpu4lu5os5rs}3u{17su5tu5qs}3v{17su5tu5qs}7p{17sw5tw5qs}ck{4qs5ku17sw5ou5qy5rw201ss5tw201ws}4l{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cm{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cn{4qs5ku17sw5ou5qy5rw201ss5tw201ws}co{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cp{4qs5ku17sw5ou5qy5rw201ss5tw201ws}6l{17su5tu5os5qw5rs}17s{2ktclvcmvcnvcovcpv4lv4wuckv}5o{ckwclwcmwcnwcowcpw4lw4wu}5q{ckyclycmycnycoycpy4ly4wu5ms}5r{cktcltcmtcntcotcpt4lt4ws}5t{2ktclvcmvcnvcovcpv4lv4wuckv}7q{cksclscmscnscoscps4ls}6p{17su5tu5qw5rs}ek{5qs5rs}el{17su5tu5os5qw5rs}em{17su5tu5os5qs5rs}en{17su5qs5rs}eo{5qs5rs}ep{17su5tu5os5qw5rs}es{5qs}et{17su5tu5qw5rs}eu{17su5tu5qs5rs}ev{5qs}6z{17sv5tv5os5qx5rs}fm{5os5qt5rs}fn{17sv5tv5os5qx5rs}fo{17sv5tv5os5qx5rs}fp{5os5qt5rs}fq{5os5qt5rs}7r{ckuclucmucnucoucpu4lu5os}fs{17sv5tv5os5qx5rs}ft{17ss5ts5qs}fu{17sw5tw5qs}fv{17sw5tw5qs}fw{17ss5ts5qs}fz{ckuclucmucnucoucpu4lu5os5rs}}}"),"Helvetica-Oblique":c("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}")}};t.events.push(["addFont",function(g){var x=g.font,_=d.Unicode[x.postScriptName];_&&(x.metadata.Unicode={},x.metadata.Unicode.widths=_.widths,x.metadata.Unicode.kerning=_.kerning);var b=h.Unicode[x.postScriptName];b&&(x.metadata.Unicode.encoding=b,x.encoding=b.codePages[0])}])}(ar.API),function(t){var e=function(r){for(var n=r.length,i=new Uint8Array(n),a=0;a<n;a++)i[a]=r.charCodeAt(a);return i};t.API.events.push(["addFont",function(r){var n=void 0,i=r.font,a=r.instance;if(!i.isStandardFont){if(a===void 0)throw new Error("Font does not exist in vFS, import fonts or remove declaration doc.addFont('"+i.postScriptName+"').");if(typeof(n=a.existsFileInVFS(i.postScriptName)===!1?a.loadFile(i.postScriptName):a.getFileFromVFS(i.postScriptName))!="string")throw new Error("Font is not stored as string-data in vFS, import fonts or remove declaration doc.addFont('"+i.postScriptName+"').");(function(o,c){c=/^\x00\x01\x00\x00/.test(c)?e(c):e(A1(c)),o.metadata=t.API.TTFFont.open(c),o.metadata.Unicode=o.metadata.Unicode||{encoding:{},kerning:{},widths:[]},o.metadata.glyIdsUsed=[0]})(i,n)}}])}(ar),function(t){function e(){return(cr.canvg?Promise.resolve(cr.canvg):ox(()=>import("./index.es-CpbvW_xO.js"),[])).catch(function(r){return Promise.reject(new Error("Could not load canvg: "+r))}).then(function(r){return r.default?r.default:r})}ar.API.addSvgAsImage=function(r,n,i,a,o,c,u,h){if(isNaN(n)||isNaN(i))throw Ln.error("jsPDF.addSvgAsImage: Invalid coordinates",arguments),new Error("Invalid coordinates passed to jsPDF.addSvgAsImage");if(isNaN(a)||isNaN(o))throw Ln.error("jsPDF.addSvgAsImage: Invalid measurements",arguments),new Error("Invalid measurements (width and/or height) passed to jsPDF.addSvgAsImage");var d=document.createElement("canvas");d.width=a,d.height=o;var g=d.getContext("2d");g.fillStyle="#fff",g.fillRect(0,0,d.width,d.height);var x={ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0},_=this;return e().then(function(b){return b.fromString(g,r,x)},function(){return Promise.reject(new Error("Could not load canvg."))}).then(function(b){return b.render(x)}).then(function(){_.addImage(d.toDataURL("image/jpeg",1),n,i,a,o,u,h)})}}(),ar.API.putTotalPages=function(t){var e,r=0;parseInt(this.internal.getFont().id.substr(1),10)<15?(e=new RegExp(t,"g"),r=this.internal.getNumberOfPages()):(e=new RegExp(this.pdfEscape16(t,this.internal.getFont()),"g"),r=this.pdfEscape16(this.internal.getNumberOfPages()+"",this.internal.getFont()));for(var n=1;n<=this.internal.getNumberOfPages();n++)for(var i=0;i<this.internal.pages[n].length;i++)this.internal.pages[n][i]=this.internal.pages[n][i].replace(e,r);return this},ar.API.viewerPreferences=function(t,e){var r;t=t||{},e=e||!1;var n,i,a,o={HideToolbar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideMenubar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideWindowUI:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},FitWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},CenterWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},DisplayDocTitle:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.4},NonFullScreenPageMode:{defaultValue:"UseNone",value:"UseNone",type:"name",explicitSet:!1,valueSet:["UseNone","UseOutlines","UseThumbs","UseOC"],pdfVersion:1.3},Direction:{defaultValue:"L2R",value:"L2R",type:"name",explicitSet:!1,valueSet:["L2R","R2L"],pdfVersion:1.3},ViewArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},ViewClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintScaling:{defaultValue:"AppDefault",value:"AppDefault",type:"name",explicitSet:!1,valueSet:["AppDefault","None"],pdfVersion:1.6},Duplex:{defaultValue:"",value:"none",type:"name",explicitSet:!1,valueSet:["Simplex","DuplexFlipShortEdge","DuplexFlipLongEdge","none"],pdfVersion:1.7},PickTrayByPDFSize:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.7},PrintPageRange:{defaultValue:"",value:"",type:"array",explicitSet:!1,valueSet:null,pdfVersion:1.7},NumCopies:{defaultValue:1,value:1,type:"integer",explicitSet:!1,valueSet:null,pdfVersion:1.7}},c=Object.keys(o),u=[],h=0,d=0,g=0;function x(b,E){var A,O=!1;for(A=0;A<b.length;A+=1)b[A]===E&&(O=!0);return O}if(this.internal.viewerpreferences===void 0&&(this.internal.viewerpreferences={},this.internal.viewerpreferences.configuration=JSON.parse(JSON.stringify(o)),this.internal.viewerpreferences.isSubscribed=!1),r=this.internal.viewerpreferences.configuration,t==="reset"||e===!0){var _=c.length;for(g=0;g<_;g+=1)r[c[g]].value=r[c[g]].defaultValue,r[c[g]].explicitSet=!1}if(Sn(t)==="object"){for(i in t)if(a=t[i],x(c,i)&&a!==void 0){if(r[i].type==="boolean"&&typeof a=="boolean")r[i].value=a;else if(r[i].type==="name"&&x(r[i].valueSet,a))r[i].value=a;else if(r[i].type==="integer"&&Number.isInteger(a))r[i].value=a;else if(r[i].type==="array"){for(h=0;h<a.length;h+=1)if(n=!0,a[h].length===1&&typeof a[h][0]=="number")u.push(String(a[h]-1));else if(a[h].length>1){for(d=0;d<a[h].length;d+=1)typeof a[h][d]!="number"&&(n=!1);n===!0&&u.push([a[h][0]-1,a[h][1]-1].join(" "))}r[i].value="["+u.join(" ")+"]"}else r[i].value=r[i].defaultValue;r[i].explicitSet=!0}}return this.internal.viewerpreferences.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){var b,E=[];for(b in r)r[b].explicitSet===!0&&(r[b].type==="name"?E.push("/"+b+" /"+r[b].value):E.push("/"+b+" "+r[b].value));E.length!==0&&this.internal.write(`/ViewerPreferences
<<
`+E.join(`
`)+`
>>`)}),this.internal.viewerpreferences.isSubscribed=!0),this.internal.viewerpreferences.configuration=r,this},function(t){var e=function(){var n='<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"><rdf:Description rdf:about="" xmlns:jspdf="'+this.internal.__metadata__.namespaceuri+'"><jspdf:metadata>',i=unescape(encodeURIComponent('<x:xmpmeta xmlns:x="adobe:ns:meta/">')),a=unescape(encodeURIComponent(n)),o=unescape(encodeURIComponent(this.internal.__metadata__.metadata)),c=unescape(encodeURIComponent("</jspdf:metadata></rdf:Description></rdf:RDF>")),u=unescape(encodeURIComponent("</x:xmpmeta>")),h=a.length+o.length+c.length+i.length+u.length;this.internal.__metadata__.metadata_object_number=this.internal.newObject(),this.internal.write("<< /Type /Metadata /Subtype /XML /Length "+h+" >>"),this.internal.write("stream"),this.internal.write(i+a+o+c+u),this.internal.write("endstream"),this.internal.write("endobj")},r=function(){this.internal.__metadata__.metadata_object_number&&this.internal.write("/Metadata "+this.internal.__metadata__.metadata_object_number+" 0 R")};t.addMetadata=function(n,i){return this.internal.__metadata__===void 0&&(this.internal.__metadata__={metadata:n,namespaceuri:i||"http://jspdf.default.namespaceuri/"},this.internal.events.subscribe("putCatalog",r),this.internal.events.subscribe("postPutResources",e)),this}}(ar.API),function(t){var e=t.API,r=e.pdfEscape16=function(a,o){for(var c,u=o.metadata.Unicode.widths,h=["","0","00","000","0000"],d=[""],g=0,x=a.length;g<x;++g){if(c=o.metadata.characterToGlyph(a.charCodeAt(g)),o.metadata.glyIdsUsed.push(c),o.metadata.toUnicode[c]=a.charCodeAt(g),u.indexOf(c)==-1&&(u.push(c),u.push([parseInt(o.metadata.widthOfGlyph(c),10)])),c=="0")return d.join("");c=c.toString(16),d.push(h[4-c.length],c)}return d.join("")},n=function(a){var o,c,u,h,d,g,x;for(d=`/CIDInit /ProcSet findresource begin
12 dict begin
begincmap
/CIDSystemInfo <<
  /Registry (Adobe)
  /Ordering (UCS)
  /Supplement 0
>> def
/CMapName /Adobe-Identity-UCS def
/CMapType 2 def
1 begincodespacerange
<0000><ffff>
endcodespacerange`,u=[],g=0,x=(c=Object.keys(a).sort(function(_,b){return _-b})).length;g<x;g++)o=c[g],u.length>=100&&(d+=`
`+u.length+` beginbfchar
`+u.join(`
`)+`
endbfchar`,u=[]),a[o]!==void 0&&a[o]!==null&&typeof a[o].toString=="function"&&(h=("0000"+a[o].toString(16)).slice(-4),o=("0000"+(+o).toString(16)).slice(-4),u.push("<"+o+"><"+h+">"));return u.length&&(d+=`
`+u.length+` beginbfchar
`+u.join(`
`)+`
endbfchar
`),d+=`endcmap
CMapName currentdict /CMap defineresource pop
end
end`};e.events.push(["putFont",function(a){(function(o){var c=o.font,u=o.out,h=o.newObject,d=o.putStream;if(c.metadata instanceof t.API.TTFFont&&c.encoding==="Identity-H"){for(var g=c.metadata.Unicode.widths,x=c.metadata.subset.encode(c.metadata.glyIdsUsed,1),_="",b=0;b<x.length;b++)_+=String.fromCharCode(x[b]);var E=h();d({data:_,addLength1:!0,objectId:E}),u("endobj");var A=h();d({data:n(c.metadata.toUnicode),addLength1:!0,objectId:A}),u("endobj");var O=h();u("<<"),u("/Type /FontDescriptor"),u("/FontName /"+N0(c.fontName)),u("/FontFile2 "+E+" 0 R"),u("/FontBBox "+t.API.PDFObject.convert(c.metadata.bbox)),u("/Flags "+c.metadata.flags),u("/StemV "+c.metadata.stemV),u("/ItalicAngle "+c.metadata.italicAngle),u("/Ascent "+c.metadata.ascender),u("/Descent "+c.metadata.decender),u("/CapHeight "+c.metadata.capHeight),u(">>"),u("endobj");var M=h();u("<<"),u("/Type /Font"),u("/BaseFont /"+N0(c.fontName)),u("/FontDescriptor "+O+" 0 R"),u("/W "+t.API.PDFObject.convert(g)),u("/CIDToGIDMap /Identity"),u("/DW 1000"),u("/Subtype /CIDFontType2"),u("/CIDSystemInfo"),u("<<"),u("/Supplement 0"),u("/Registry (Adobe)"),u("/Ordering ("+c.encoding+")"),u(">>"),u(">>"),u("endobj"),c.objectNumber=h(),u("<<"),u("/Type /Font"),u("/Subtype /Type0"),u("/ToUnicode "+A+" 0 R"),u("/BaseFont /"+N0(c.fontName)),u("/Encoding /"+c.encoding),u("/DescendantFonts ["+M+" 0 R]"),u(">>"),u("endobj"),c.isAlreadyPutted=!0}})(a)}]),e.events.push(["putFont",function(a){(function(o){var c=o.font,u=o.out,h=o.newObject,d=o.putStream;if(c.metadata instanceof t.API.TTFFont&&c.encoding==="WinAnsiEncoding"){for(var g=c.metadata.rawData,x="",_=0;_<g.length;_++)x+=String.fromCharCode(g[_]);var b=h();d({data:x,addLength1:!0,objectId:b}),u("endobj");var E=h();d({data:n(c.metadata.toUnicode),addLength1:!0,objectId:E}),u("endobj");var A=h();u("<<"),u("/Descent "+c.metadata.decender),u("/CapHeight "+c.metadata.capHeight),u("/StemV "+c.metadata.stemV),u("/Type /FontDescriptor"),u("/FontFile2 "+b+" 0 R"),u("/Flags 96"),u("/FontBBox "+t.API.PDFObject.convert(c.metadata.bbox)),u("/FontName /"+N0(c.fontName)),u("/ItalicAngle "+c.metadata.italicAngle),u("/Ascent "+c.metadata.ascender),u(">>"),u("endobj"),c.objectNumber=h();for(var O=0;O<c.metadata.hmtx.widths.length;O++)c.metadata.hmtx.widths[O]=parseInt(c.metadata.hmtx.widths[O]*(1e3/c.metadata.head.unitsPerEm));u("<</Subtype/TrueType/Type/Font/ToUnicode "+E+" 0 R/BaseFont/"+N0(c.fontName)+"/FontDescriptor "+A+" 0 R/Encoding/"+c.encoding+" /FirstChar 29 /LastChar 255 /Widths "+t.API.PDFObject.convert(c.metadata.hmtx.widths)+">>"),u("endobj"),c.isAlreadyPutted=!0}})(a)}]);var i=function(a){var o,c=a.text||"",u=a.x,h=a.y,d=a.options||{},g=a.mutex||{},x=g.pdfEscape,_=g.activeFontKey,b=g.fonts,E=_,A="",O=0,M="",B=b[E].encoding;if(b[E].encoding!=="Identity-H")return{text:c,x:u,y:h,options:d,mutex:g};for(M=c,E=_,Array.isArray(c)&&(M=c[0]),O=0;O<M.length;O+=1)b[E].metadata.hasOwnProperty("cmap")&&(o=b[E].metadata.cmap.unicode.codeMap[M[O].charCodeAt(0)]),o||M[O].charCodeAt(0)<256&&b[E].metadata.hasOwnProperty("Unicode")?A+=M[O]:A+="";var Q="";return parseInt(E.slice(1))<14||B==="WinAnsiEncoding"?Q=x(A,E).split("").map(function(ee){return ee.charCodeAt(0).toString(16)}).join(""):B==="Identity-H"&&(Q=r(A,b[E])),g.isHex=!0,{text:Q,x:u,y:h,options:d,mutex:g}};e.events.push(["postProcessText",function(a){var o=a.text||"",c=[],u={text:o,x:a.x,y:a.y,options:a.options,mutex:a.mutex};if(Array.isArray(o)){var h=0;for(h=0;h<o.length;h+=1)Array.isArray(o[h])&&o[h].length===3?c.push([i(Object.assign({},u,{text:o[h][0]})).text,o[h][1],o[h][2]]):c.push(i(Object.assign({},u,{text:o[h]})).text);a.text=c}else a.text=i(Object.assign({},u,{text:o})).text}])}(ar),function(t){var e=function(){return this.internal.vFS===void 0&&(this.internal.vFS={}),!0};t.existsFileInVFS=function(r){return e.call(this),this.internal.vFS[r]!==void 0},t.addFileToVFS=function(r,n){return e.call(this),this.internal.vFS[r]=n,this},t.getFileFromVFS=function(r){return e.call(this),this.internal.vFS[r]!==void 0?this.internal.vFS[r]:null}}(ar.API),function(t){t.__bidiEngine__=t.prototype.__bidiEngine__=function(n){var i,a,o,c,u,h,d,g=e,x=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],_=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],b={L:0,R:1,EN:2,AN:3,N:4,B:5,S:6},E={0:0,5:1,6:2,7:3,32:4,251:5,254:6,255:7},A=["(",")","(","<",">","<","[","]","[","{","}","{","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],O=new RegExp(/^([1-4|9]|1[0-9]|2[0-9]|3[0168]|4[04589]|5[012]|7[78]|159|16[0-9]|17[0-2]|21[569]|22[03489]|250)$/),M=!1,B=0;this.__bidiEngine__={};var Q=function(I){var C=I.charCodeAt(),R=C>>8,se=E[R];return se!==void 0?g[256*se+(255&C)]:R===252||R===253?"AL":O.test(R)?"L":R===8?"R":"N"},ee=function(I){for(var C,R=0;R<I.length;R++){if((C=Q(I.charAt(R)))==="L")return!1;if(C==="R")return!0}return!1},he=function(I,C,R,se){var ne,J,de,oe,Z=C[se];switch(Z){case"L":case"R":M=!1;break;case"N":case"AN":break;case"EN":M&&(Z="AN");break;case"AL":M=!0,Z="R";break;case"WS":Z="N";break;case"CS":se<1||se+1>=C.length||(ne=R[se-1])!=="EN"&&ne!=="AN"||(J=C[se+1])!=="EN"&&J!=="AN"?Z="N":M&&(J="AN"),Z=J===ne?J:"N";break;case"ES":Z=(ne=se>0?R[se-1]:"B")==="EN"&&se+1<C.length&&C[se+1]==="EN"?"EN":"N";break;case"ET":if(se>0&&R[se-1]==="EN"){Z="EN";break}if(M){Z="N";break}for(de=se+1,oe=C.length;de<oe&&C[de]==="ET";)de++;Z=de<oe&&C[de]==="EN"?"EN":"N";break;case"NSM":if(o&&!c){for(oe=C.length,de=se+1;de<oe&&C[de]==="NSM";)de++;if(de<oe){var X=I[se],xe=X>=1425&&X<=2303||X===64286;if(ne=C[de],xe&&(ne==="R"||ne==="AL")){Z="R";break}}}Z=se<1||(ne=C[se-1])==="B"?"N":R[se-1];break;case"B":M=!1,i=!0,Z=B;break;case"S":a=!0,Z="N";break;case"LRE":case"RLE":case"LRO":case"RLO":case"PDF":M=!1;break;case"BN":Z="N"}return Z},F=function(I,C,R){var se=I.split("");return R&&k(se,R,{hiLevel:B}),se.reverse(),C&&C.reverse(),se.join("")},k=function(I,C,R){var se,ne,J,de,oe,Z=-1,X=I.length,xe=0,L=[],j=B?_:x,z=[];for(M=!1,i=!1,a=!1,ne=0;ne<X;ne++)z[ne]=Q(I[ne]);for(J=0;J<X;J++){if(oe=xe,L[J]=he(I,z,L,J),se=240&(xe=j[oe][b[L[J]]]),xe&=15,C[J]=de=j[xe][5],se>0)if(se===16){for(ne=Z;ne<J;ne++)C[ne]=1;Z=-1}else Z=-1;if(j[xe][6])Z===-1&&(Z=J);else if(Z>-1){for(ne=Z;ne<J;ne++)C[ne]=de;Z=-1}z[J]==="B"&&(C[J]=0),R.hiLevel|=de}a&&function(G,ae,Ae){for(var _e=0;_e<Ae;_e++)if(G[_e]==="S"){ae[_e]=B;for(var Ee=_e-1;Ee>=0&&G[Ee]==="WS";Ee--)ae[Ee]=B}}(z,C,X)},S=function(I,C,R,se,ne){if(!(ne.hiLevel<I)){if(I===1&&B===1&&!i)return C.reverse(),void(R&&R.reverse());for(var J,de,oe,Z,X=C.length,xe=0;xe<X;){if(se[xe]>=I){for(oe=xe+1;oe<X&&se[oe]>=I;)oe++;for(Z=xe,de=oe-1;Z<de;Z++,de--)J=C[Z],C[Z]=C[de],C[de]=J,R&&(J=R[Z],R[Z]=R[de],R[de]=J);xe=oe}xe++}}},U=function(I,C,R){var se=I.split(""),ne={hiLevel:B};return R||(R=[]),k(se,R,ne),function(J,de,oe){if(oe.hiLevel!==0&&d)for(var Z,X=0;X<J.length;X++)de[X]===1&&(Z=A.indexOf(J[X]))>=0&&(J[X]=A[Z+1])}(se,R,ne),S(2,se,C,R,ne),S(1,se,C,R,ne),se.join("")};return this.__bidiEngine__.doBidiReorder=function(I,C,R){if(function(ne,J){if(J)for(var de=0;de<ne.length;de++)J[de]=de;c===void 0&&(c=ee(ne)),h===void 0&&(h=ee(ne))}(I,C),o||!u||h)if(o&&u&&c^h)B=c?1:0,I=F(I,C,R);else if(!o&&u&&h)B=c?1:0,I=U(I,C,R),I=F(I,C);else if(!o||c||u||h){if(o&&!u&&c^h)I=F(I,C),c?(B=0,I=U(I,C,R)):(B=1,I=U(I,C,R),I=F(I,C));else if(o&&c&&!u&&h)B=1,I=U(I,C,R),I=F(I,C);else if(!o&&!u&&c^h){var se=d;c?(B=1,I=U(I,C,R),B=0,d=!1,I=U(I,C,R),d=se):(B=0,I=U(I,C,R),I=F(I,C),B=1,d=!1,I=U(I,C,R),d=se,I=F(I,C))}}else B=0,I=U(I,C,R);else B=c?1:0,I=U(I,C,R);return I},this.__bidiEngine__.setOptions=function(I){I&&(o=I.isInputVisual,u=I.isOutputVisual,c=I.isInputRtl,h=I.isOutputRtl,d=I.isSymmetricSwapping)},this.__bidiEngine__.setOptions(n),this.__bidiEngine__};var e=["BN","BN","BN","BN","BN","BN","BN","BN","BN","S","B","S","WS","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","B","B","B","S","WS","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","BN","BN","BN","BN","BN","BN","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","CS","N","ET","ET","ET","ET","N","N","N","N","L","N","N","BN","N","N","ET","ET","EN","EN","N","L","N","N","N","EN","L","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","N","N","N","N","N","ET","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","NSM","R","NSM","NSM","R","NSM","NSM","R","NSM","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","N","N","N","N","N","R","R","R","R","R","N","N","N","N","N","N","N","N","N","N","N","AN","AN","AN","AN","AN","AN","N","N","AL","ET","ET","AL","CS","AL","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","AN","AN","AN","AN","AN","AN","AN","AN","AN","ET","AN","AN","AL","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","N","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","NSM","NSM","N","NSM","NSM","NSM","NSM","AL","AL","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","R","N","N","N","N","R","N","N","N","N","N","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","BN","BN","BN","L","R","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","B","LRE","RLE","PDF","LRO","RLO","CS","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","BN","BN","BN","BN","BN","N","LRI","RLI","FSI","PDI","BN","BN","BN","BN","BN","BN","EN","L","N","N","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","L","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","N","N","N","N","N","R","NSM","R","R","R","R","R","R","R","R","R","R","ES","R","R","R","R","R","R","R","R","R","R","R","R","R","N","R","R","R","R","R","N","R","N","R","R","N","R","R","N","R","R","R","R","R","R","R","R","R","R","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","CS","N","N","CS","N","N","N","N","N","N","N","N","N","ET","N","N","ES","ES","N","N","N","N","N","ET","ET","N","N","N","N","N","AL","AL","AL","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","BN","N","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","N","N","N","ET","ET","N","N","N","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N"],r=new t.__bidiEngine__({isInputVisual:!0});t.API.events.push(["postProcessText",function(n){var i=n.text;n.x,n.y;var a=n.options||{};n.mutex,a.lang;var o=[];if(a.isInputVisual=typeof a.isInputVisual!="boolean"||a.isInputVisual,r.setOptions(a),Object.prototype.toString.call(i)==="[object Array]"){var c=0;for(o=[],c=0;c<i.length;c+=1)Object.prototype.toString.call(i[c])==="[object Array]"?o.push([r.doBidiReorder(i[c][0]),i[c][1],i[c][2]]):o.push([r.doBidiReorder(i[c])]);n.text=o}else n.text=r.doBidiReorder(i);r.setOptions({isInputVisual:!0})}])}(ar),ar.API.TTFFont=function(){function t(e){var r;if(this.rawData=e,r=this.contents=new Tf(e),this.contents.pos=4,r.readString(4)==="ttcf")throw new Error("TTCF not supported.");r.pos=0,this.parse(),this.subset=new OX(this),this.registerTTF()}return t.open=function(e){return new t(e)},t.prototype.parse=function(){return this.directory=new wX(this.contents),this.head=new bX(this),this.name=new NX(this),this.cmap=new $k(this),this.toUnicode={},this.hhea=new SX(this),this.maxp=new CX(this),this.hmtx=new IX(this),this.post=new TX(this),this.os2=new AX(this),this.loca=new FX(this),this.glyf=new RX(this),this.ascender=this.os2.exists&&this.os2.ascender||this.hhea.ascender,this.decender=this.os2.exists&&this.os2.decender||this.hhea.decender,this.lineGap=this.os2.exists&&this.os2.lineGap||this.hhea.lineGap,this.bbox=[this.head.xMin,this.head.yMin,this.head.xMax,this.head.yMax]},t.prototype.registerTTF=function(){var e,r,n,i,a;if(this.scaleFactor=1e3/this.head.unitsPerEm,this.bbox=(function(){var o,c,u,h;for(h=[],o=0,c=(u=this.bbox).length;o<c;o++)e=u[o],h.push(Math.round(e*this.scaleFactor));return h}).call(this),this.stemV=0,this.post.exists?(n=255&(i=this.post.italic_angle),(32768&(r=i>>16))!=0&&(r=-(1+(65535^r))),this.italicAngle=+(r+"."+n)):this.italicAngle=0,this.ascender=Math.round(this.ascender*this.scaleFactor),this.decender=Math.round(this.decender*this.scaleFactor),this.lineGap=Math.round(this.lineGap*this.scaleFactor),this.capHeight=this.os2.exists&&this.os2.capHeight||this.ascender,this.xHeight=this.os2.exists&&this.os2.xHeight||0,this.familyClass=(this.os2.exists&&this.os2.familyClass||0)>>8,this.isSerif=(a=this.familyClass)===1||a===2||a===3||a===4||a===5||a===7,this.isScript=this.familyClass===10,this.flags=0,this.post.isFixedPitch&&(this.flags|=1),this.isSerif&&(this.flags|=2),this.isScript&&(this.flags|=8),this.italicAngle!==0&&(this.flags|=64),this.flags|=32,!this.cmap.unicode)throw new Error("No unicode cmap for font")},t.prototype.characterToGlyph=function(e){var r;return((r=this.cmap.unicode)!=null?r.codeMap[e]:void 0)||0},t.prototype.widthOfGlyph=function(e){var r;return r=1e3/this.head.unitsPerEm,this.hmtx.forGlyph(e).advance*r},t.prototype.widthOfString=function(e,r,n){var i,a,o,c;for(o=0,a=0,c=(e=""+e).length;0<=c?a<c:a>c;a=0<=c?++a:--a)i=e.charCodeAt(a),o+=this.widthOfGlyph(this.characterToGlyph(i))+n*(1e3/r)||0;return o*(r/1e3)},t.prototype.lineHeight=function(e,r){var n;return r==null&&(r=!1),n=r?this.lineGap:0,(this.ascender+n-this.decender)/1e3*e},t}();var Al,Tf=function(){function t(e){this.data=e??[],this.pos=0,this.length=this.data.length}return t.prototype.readByte=function(){return this.data[this.pos++]},t.prototype.writeByte=function(e){return this.data[this.pos++]=e},t.prototype.readUInt32=function(){return 16777216*this.readByte()+(this.readByte()<<16)+(this.readByte()<<8)+this.readByte()},t.prototype.writeUInt32=function(e){return this.writeByte(e>>>24&255),this.writeByte(e>>16&255),this.writeByte(e>>8&255),this.writeByte(255&e)},t.prototype.readInt32=function(){var e;return(e=this.readUInt32())>=2147483648?e-4294967296:e},t.prototype.writeInt32=function(e){return e<0&&(e+=4294967296),this.writeUInt32(e)},t.prototype.readUInt16=function(){return this.readByte()<<8|this.readByte()},t.prototype.writeUInt16=function(e){return this.writeByte(e>>8&255),this.writeByte(255&e)},t.prototype.readInt16=function(){var e;return(e=this.readUInt16())>=32768?e-65536:e},t.prototype.writeInt16=function(e){return e<0&&(e+=65536),this.writeUInt16(e)},t.prototype.readString=function(e){var r,n;for(n=[],r=0;0<=e?r<e:r>e;r=0<=e?++r:--r)n[r]=String.fromCharCode(this.readByte());return n.join("")},t.prototype.writeString=function(e){var r,n,i;for(i=[],r=0,n=e.length;0<=n?r<n:r>n;r=0<=n?++r:--r)i.push(this.writeByte(e.charCodeAt(r)));return i},t.prototype.readShort=function(){return this.readInt16()},t.prototype.writeShort=function(e){return this.writeInt16(e)},t.prototype.readLongLong=function(){var e,r,n,i,a,o,c,u;return e=this.readByte(),r=this.readByte(),n=this.readByte(),i=this.readByte(),a=this.readByte(),o=this.readByte(),c=this.readByte(),u=this.readByte(),128&e?-1*(72057594037927940*(255^e)+281474976710656*(255^r)+1099511627776*(255^n)+4294967296*(255^i)+16777216*(255^a)+65536*(255^o)+256*(255^c)+(255^u)+1):72057594037927940*e+281474976710656*r+1099511627776*n+4294967296*i+16777216*a+65536*o+256*c+u},t.prototype.writeLongLong=function(e){var r,n;return r=Math.floor(e/4294967296),n=4294967295&e,this.writeByte(r>>24&255),this.writeByte(r>>16&255),this.writeByte(r>>8&255),this.writeByte(255&r),this.writeByte(n>>24&255),this.writeByte(n>>16&255),this.writeByte(n>>8&255),this.writeByte(255&n)},t.prototype.readInt=function(){return this.readInt32()},t.prototype.writeInt=function(e){return this.writeInt32(e)},t.prototype.read=function(e){var r,n;for(r=[],n=0;0<=e?n<e:n>e;n=0<=e?++n:--n)r.push(this.readByte());return r},t.prototype.write=function(e){var r,n,i,a;for(a=[],n=0,i=e.length;n<i;n++)r=e[n],a.push(this.writeByte(r));return a},t}(),wX=function(){var t;function e(r){var n,i,a;for(this.scalarType=r.readInt(),this.tableCount=r.readShort(),this.searchRange=r.readShort(),this.entrySelector=r.readShort(),this.rangeShift=r.readShort(),this.tables={},i=0,a=this.tableCount;0<=a?i<a:i>a;i=0<=a?++i:--i)n={tag:r.readString(4),checksum:r.readInt(),offset:r.readInt(),length:r.readInt()},this.tables[n.tag]=n}return e.prototype.encode=function(r){var n,i,a,o,c,u,h,d,g,x,_,b,E;for(E in _=Object.keys(r).length,u=Math.log(2),g=16*Math.floor(Math.log(_)/u),o=Math.floor(g/u),d=16*_-g,(i=new Tf).writeInt(this.scalarType),i.writeShort(_),i.writeShort(g),i.writeShort(o),i.writeShort(d),a=16*_,h=i.pos+a,c=null,b=[],r)for(x=r[E],i.writeString(E),i.writeInt(t(x)),i.writeInt(h),i.writeInt(x.length),b=b.concat(x),E==="head"&&(c=h),h+=x.length;h%4;)b.push(0),h++;return i.write(b),n=2981146554-t(i.data),i.pos=c+8,i.writeUInt32(n),i.data},t=function(r){var n,i,a,o;for(r=Qk.call(r);r.length%4;)r.push(0);for(a=new Tf(r),i=0,n=0,o=r.length;n<o;n=n+=4)i+=a.readUInt32();return 4294967295&i},e}(),EX={}.hasOwnProperty,xc=function(t,e){for(var r in e)EX.call(e,r)&&(t[r]=e[r]);function n(){this.constructor=t}return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};Al=function(){function t(e){var r;this.file=e,r=this.file.directory.tables[this.tag],this.exists=!!r,r&&(this.offset=r.offset,this.length=r.length,this.parse(this.file.contents))}return t.prototype.parse=function(){},t.prototype.encode=function(){},t.prototype.raw=function(){return this.exists?(this.file.contents.pos=this.offset,this.file.contents.read(this.length)):null},t}();var bX=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return xc(e,Al),e.prototype.tag="head",e.prototype.parse=function(r){return r.pos=this.offset,this.version=r.readInt(),this.revision=r.readInt(),this.checkSumAdjustment=r.readInt(),this.magicNumber=r.readInt(),this.flags=r.readShort(),this.unitsPerEm=r.readShort(),this.created=r.readLongLong(),this.modified=r.readLongLong(),this.xMin=r.readShort(),this.yMin=r.readShort(),this.xMax=r.readShort(),this.yMax=r.readShort(),this.macStyle=r.readShort(),this.lowestRecPPEM=r.readShort(),this.fontDirectionHint=r.readShort(),this.indexToLocFormat=r.readShort(),this.glyphDataFormat=r.readShort()},e.prototype.encode=function(r){var n;return(n=new Tf).writeInt(this.version),n.writeInt(this.revision),n.writeInt(this.checkSumAdjustment),n.writeInt(this.magicNumber),n.writeShort(this.flags),n.writeShort(this.unitsPerEm),n.writeLongLong(this.created),n.writeLongLong(this.modified),n.writeShort(this.xMin),n.writeShort(this.yMin),n.writeShort(this.xMax),n.writeShort(this.yMax),n.writeShort(this.macStyle),n.writeShort(this.lowestRecPPEM),n.writeShort(this.fontDirectionHint),n.writeShort(r),n.writeShort(this.glyphDataFormat),n.data},e}(),Rb=function(){function t(e,r){var n,i,a,o,c,u,h,d,g,x,_,b,E,A,O,M,B;switch(this.platformID=e.readUInt16(),this.encodingID=e.readShort(),this.offset=r+e.readInt(),g=e.pos,e.pos=this.offset,this.format=e.readUInt16(),this.length=e.readUInt16(),this.language=e.readUInt16(),this.isUnicode=this.platformID===3&&this.encodingID===1&&this.format===4||this.platformID===0&&this.format===4,this.codeMap={},this.format){case 0:for(u=0;u<256;++u)this.codeMap[u]=e.readByte();break;case 4:for(_=e.readUInt16(),x=_/2,e.pos+=6,a=function(){var Q,ee;for(ee=[],u=Q=0;0<=x?Q<x:Q>x;u=0<=x?++Q:--Q)ee.push(e.readUInt16());return ee}(),e.pos+=2,E=function(){var Q,ee;for(ee=[],u=Q=0;0<=x?Q<x:Q>x;u=0<=x?++Q:--Q)ee.push(e.readUInt16());return ee}(),h=function(){var Q,ee;for(ee=[],u=Q=0;0<=x?Q<x:Q>x;u=0<=x?++Q:--Q)ee.push(e.readUInt16());return ee}(),d=function(){var Q,ee;for(ee=[],u=Q=0;0<=x?Q<x:Q>x;u=0<=x?++Q:--Q)ee.push(e.readUInt16());return ee}(),i=(this.length-e.pos+this.offset)/2,c=function(){var Q,ee;for(ee=[],u=Q=0;0<=i?Q<i:Q>i;u=0<=i?++Q:--Q)ee.push(e.readUInt16());return ee}(),u=O=0,B=a.length;O<B;u=++O)for(A=a[u],n=M=b=E[u];b<=A?M<=A:M>=A;n=b<=A?++M:--M)d[u]===0?o=n+h[u]:(o=c[d[u]/2+(n-b)-(x-u)]||0)!==0&&(o+=h[u]),this.codeMap[n]=65535&o}e.pos=g}return t.encode=function(e,r){var n,i,a,o,c,u,h,d,g,x,_,b,E,A,O,M,B,Q,ee,he,F,k,S,U,I,C,R,se,ne,J,de,oe,Z,X,xe,L,j,z,G,ae,Ae,_e,Ee,Ce,Oe,fe;switch(se=new Tf,o=Object.keys(e).sort(function(rt,ot){return rt-ot}),r){case"macroman":for(E=0,A=function(){var rt=[];for(b=0;b<256;++b)rt.push(0);return rt}(),M={0:0},a={},ne=0,Z=o.length;ne<Z;ne++)M[Ee=e[i=o[ne]]]==null&&(M[Ee]=++E),a[i]={old:e[i],new:M[e[i]]},A[i]=M[e[i]];return se.writeUInt16(1),se.writeUInt16(0),se.writeUInt32(12),se.writeUInt16(0),se.writeUInt16(262),se.writeUInt16(0),se.write(A),{charMap:a,subtable:se.data,maxGlyphID:E+1};case"unicode":for(C=[],g=[],B=0,M={},n={},O=h=null,J=0,X=o.length;J<X;J++)M[ee=e[i=o[J]]]==null&&(M[ee]=++B),n[i]={old:ee,new:M[ee]},c=M[ee]-i,O!=null&&c===h||(O&&g.push(O),C.push(i),h=c),O=i;for(O&&g.push(O),g.push(65535),C.push(65535),U=2*(S=C.length),k=2*Math.pow(Math.log(S)/Math.LN2,2),x=Math.log(k/2)/Math.LN2,F=2*S-k,u=[],he=[],_=[],b=de=0,xe=C.length;de<xe;b=++de){if(I=C[b],d=g[b],I===65535){u.push(0),he.push(0);break}if(I-(R=n[I].new)>=32768)for(u.push(0),he.push(2*(_.length+S-b)),i=oe=I;I<=d?oe<=d:oe>=d;i=I<=d?++oe:--oe)_.push(n[i].new);else u.push(R-I),he.push(0)}for(se.writeUInt16(3),se.writeUInt16(1),se.writeUInt32(12),se.writeUInt16(4),se.writeUInt16(16+8*S+2*_.length),se.writeUInt16(0),se.writeUInt16(U),se.writeUInt16(k),se.writeUInt16(x),se.writeUInt16(F),Ae=0,L=g.length;Ae<L;Ae++)i=g[Ae],se.writeUInt16(i);for(se.writeUInt16(0),_e=0,j=C.length;_e<j;_e++)i=C[_e],se.writeUInt16(i);for(Ce=0,z=u.length;Ce<z;Ce++)c=u[Ce],se.writeUInt16(c);for(Oe=0,G=he.length;Oe<G;Oe++)Q=he[Oe],se.writeUInt16(Q);for(fe=0,ae=_.length;fe<ae;fe++)E=_[fe],se.writeUInt16(E);return{charMap:n,subtable:se.data,maxGlyphID:B+1}}},t}(),$k=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return xc(e,Al),e.prototype.tag="cmap",e.prototype.parse=function(r){var n,i,a;for(r.pos=this.offset,this.version=r.readUInt16(),a=r.readUInt16(),this.tables=[],this.unicode=null,i=0;0<=a?i<a:i>a;i=0<=a?++i:--i)n=new Rb(r,this.offset),this.tables.push(n),n.isUnicode&&this.unicode==null&&(this.unicode=n);return!0},e.encode=function(r,n){var i,a;return n==null&&(n="macroman"),i=Rb.encode(r,n),(a=new Tf).writeUInt16(0),a.writeUInt16(1),i.table=a.data.concat(i.subtable),i},e}(),SX=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return xc(e,Al),e.prototype.tag="hhea",e.prototype.parse=function(r){return r.pos=this.offset,this.version=r.readInt(),this.ascender=r.readShort(),this.decender=r.readShort(),this.lineGap=r.readShort(),this.advanceWidthMax=r.readShort(),this.minLeftSideBearing=r.readShort(),this.minRightSideBearing=r.readShort(),this.xMaxExtent=r.readShort(),this.caretSlopeRise=r.readShort(),this.caretSlopeRun=r.readShort(),this.caretOffset=r.readShort(),r.pos+=8,this.metricDataFormat=r.readShort(),this.numberOfMetrics=r.readUInt16()},e}(),AX=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return xc(e,Al),e.prototype.tag="OS/2",e.prototype.parse=function(r){if(r.pos=this.offset,this.version=r.readUInt16(),this.averageCharWidth=r.readShort(),this.weightClass=r.readUInt16(),this.widthClass=r.readUInt16(),this.type=r.readShort(),this.ySubscriptXSize=r.readShort(),this.ySubscriptYSize=r.readShort(),this.ySubscriptXOffset=r.readShort(),this.ySubscriptYOffset=r.readShort(),this.ySuperscriptXSize=r.readShort(),this.ySuperscriptYSize=r.readShort(),this.ySuperscriptXOffset=r.readShort(),this.ySuperscriptYOffset=r.readShort(),this.yStrikeoutSize=r.readShort(),this.yStrikeoutPosition=r.readShort(),this.familyClass=r.readShort(),this.panose=function(){var n,i;for(i=[],n=0;n<10;++n)i.push(r.readByte());return i}(),this.charRange=function(){var n,i;for(i=[],n=0;n<4;++n)i.push(r.readInt());return i}(),this.vendorID=r.readString(4),this.selection=r.readShort(),this.firstCharIndex=r.readShort(),this.lastCharIndex=r.readShort(),this.version>0&&(this.ascent=r.readShort(),this.descent=r.readShort(),this.lineGap=r.readShort(),this.winAscent=r.readShort(),this.winDescent=r.readShort(),this.codePageRange=function(){var n,i;for(i=[],n=0;n<2;n=++n)i.push(r.readInt());return i}(),this.version>1))return this.xHeight=r.readShort(),this.capHeight=r.readShort(),this.defaultChar=r.readShort(),this.breakChar=r.readShort(),this.maxContext=r.readShort()},e}(),TX=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return xc(e,Al),e.prototype.tag="post",e.prototype.parse=function(r){var n,i,a;switch(r.pos=this.offset,this.format=r.readInt(),this.italicAngle=r.readInt(),this.underlinePosition=r.readShort(),this.underlineThickness=r.readShort(),this.isFixedPitch=r.readInt(),this.minMemType42=r.readInt(),this.maxMemType42=r.readInt(),this.minMemType1=r.readInt(),this.maxMemType1=r.readInt(),this.format){case 65536:break;case 131072:var o;for(i=r.readUInt16(),this.glyphNameIndex=[],o=0;0<=i?o<i:o>i;o=0<=i?++o:--o)this.glyphNameIndex.push(r.readUInt16());for(this.names=[],a=[];r.pos<this.offset+this.length;)n=r.readByte(),a.push(this.names.push(r.readString(n)));return a;case 151552:return i=r.readUInt16(),this.offsets=r.read(i);case 196608:break;case 262144:return this.map=(function(){var c,u,h;for(h=[],o=c=0,u=this.file.maxp.numGlyphs;0<=u?c<u:c>u;o=0<=u?++c:--c)h.push(r.readUInt32());return h}).call(this)}},e}(),kX=function(t,e){this.raw=t,this.length=t.length,this.platformID=e.platformID,this.encodingID=e.encodingID,this.languageID=e.languageID},NX=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return xc(e,Al),e.prototype.tag="name",e.prototype.parse=function(r){var n,i,a,o,c,u,h,d,g,x,_;for(r.pos=this.offset,r.readShort(),n=r.readShort(),u=r.readShort(),i=[],o=0;0<=n?o<n:o>n;o=0<=n?++o:--o)i.push({platformID:r.readShort(),encodingID:r.readShort(),languageID:r.readShort(),nameID:r.readShort(),length:r.readShort(),offset:this.offset+u+r.readShort()});for(h={},o=g=0,x=i.length;g<x;o=++g)a=i[o],r.pos=a.offset,d=r.readString(a.length),c=new kX(d,a),h[_=a.nameID]==null&&(h[_]=[]),h[a.nameID].push(c);this.strings=h,this.copyright=h[0],this.fontFamily=h[1],this.fontSubfamily=h[2],this.uniqueSubfamily=h[3],this.fontName=h[4],this.version=h[5];try{this.postscriptName=h[6][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}catch{this.postscriptName=h[4][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}return this.trademark=h[7],this.manufacturer=h[8],this.designer=h[9],this.description=h[10],this.vendorUrl=h[11],this.designerUrl=h[12],this.license=h[13],this.licenseUrl=h[14],this.preferredFamily=h[15],this.preferredSubfamily=h[17],this.compatibleFull=h[18],this.sampleText=h[19]},e}(),CX=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return xc(e,Al),e.prototype.tag="maxp",e.prototype.parse=function(r){return r.pos=this.offset,this.version=r.readInt(),this.numGlyphs=r.readUInt16(),this.maxPoints=r.readUInt16(),this.maxContours=r.readUInt16(),this.maxCompositePoints=r.readUInt16(),this.maxComponentContours=r.readUInt16(),this.maxZones=r.readUInt16(),this.maxTwilightPoints=r.readUInt16(),this.maxStorage=r.readUInt16(),this.maxFunctionDefs=r.readUInt16(),this.maxInstructionDefs=r.readUInt16(),this.maxStackElements=r.readUInt16(),this.maxSizeOfInstructions=r.readUInt16(),this.maxComponentElements=r.readUInt16(),this.maxComponentDepth=r.readUInt16()},e}(),IX=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return xc(e,Al),e.prototype.tag="hmtx",e.prototype.parse=function(r){var n,i,a,o,c,u,h;for(r.pos=this.offset,this.metrics=[],n=0,u=this.file.hhea.numberOfMetrics;0<=u?n<u:n>u;n=0<=u?++n:--n)this.metrics.push({advance:r.readUInt16(),lsb:r.readInt16()});for(a=this.file.maxp.numGlyphs-this.file.hhea.numberOfMetrics,this.leftSideBearings=function(){var d,g;for(g=[],n=d=0;0<=a?d<a:d>a;n=0<=a?++d:--d)g.push(r.readInt16());return g}(),this.widths=(function(){var d,g,x,_;for(_=[],d=0,g=(x=this.metrics).length;d<g;d++)o=x[d],_.push(o.advance);return _}).call(this),i=this.widths[this.widths.length-1],h=[],n=c=0;0<=a?c<a:c>a;n=0<=a?++c:--c)h.push(this.widths.push(i));return h},e.prototype.forGlyph=function(r){return r in this.metrics?this.metrics[r]:{advance:this.metrics[this.metrics.length-1].advance,lsb:this.leftSideBearings[r-this.metrics.length]}},e}(),Qk=[].slice,RX=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return xc(e,Al),e.prototype.tag="glyf",e.prototype.parse=function(){return this.cache={}},e.prototype.glyphFor=function(r){var n,i,a,o,c,u,h,d,g,x;return r in this.cache?this.cache[r]:(o=this.file.loca,n=this.file.contents,i=o.indexOf(r),(a=o.lengthOf(r))===0?this.cache[r]=null:(n.pos=this.offset+i,c=(u=new Tf(n.read(a))).readShort(),d=u.readShort(),x=u.readShort(),h=u.readShort(),g=u.readShort(),this.cache[r]=c===-1?new DX(u,d,x,h,g):new LX(u,c,d,x,h,g),this.cache[r]))},e.prototype.encode=function(r,n,i){var a,o,c,u,h;for(c=[],o=[],u=0,h=n.length;u<h;u++)a=r[n[u]],o.push(c.length),a&&(c=c.concat(a.encode(i)));return o.push(c.length),{table:c,offsets:o}},e}(),LX=function(){function t(e,r,n,i,a,o){this.raw=e,this.numberOfContours=r,this.xMin=n,this.yMin=i,this.xMax=a,this.yMax=o,this.compound=!1}return t.prototype.encode=function(){return this.raw.data},t}(),DX=function(){function t(e,r,n,i,a){var o,c;for(this.raw=e,this.xMin=r,this.yMin=n,this.xMax=i,this.yMax=a,this.compound=!0,this.glyphIDs=[],this.glyphOffsets=[],o=this.raw;c=o.readShort(),this.glyphOffsets.push(o.pos),this.glyphIDs.push(o.readUInt16()),32&c;)o.pos+=1&c?4:2,128&c?o.pos+=8:64&c?o.pos+=4:8&c&&(o.pos+=2)}return t.prototype.encode=function(){var e,r,n;for(r=new Tf(Qk.call(this.raw.data)),e=0,n=this.glyphIDs.length;e<n;++e)r.pos=this.glyphOffsets[e];return r.data},t}(),FX=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return xc(e,Al),e.prototype.tag="loca",e.prototype.parse=function(r){var n,i;return r.pos=this.offset,n=this.file.head.indexToLocFormat,this.offsets=n===0?(function(){var a,o;for(o=[],i=0,a=this.length;i<a;i+=2)o.push(2*r.readUInt16());return o}).call(this):(function(){var a,o;for(o=[],i=0,a=this.length;i<a;i+=4)o.push(r.readUInt32());return o}).call(this)},e.prototype.indexOf=function(r){return this.offsets[r]},e.prototype.lengthOf=function(r){return this.offsets[r+1]-this.offsets[r]},e.prototype.encode=function(r,n){for(var i=new Uint32Array(this.offsets.length),a=0,o=0,c=0;c<i.length;++c)if(i[c]=a,o<n.length&&n[o]==c){++o,i[c]=a;var u=this.offsets[c],h=this.offsets[c+1]-u;h>0&&(a+=h)}for(var d=new Array(4*i.length),g=0;g<i.length;++g)d[4*g+3]=255&i[g],d[4*g+2]=(65280&i[g])>>8,d[4*g+1]=(16711680&i[g])>>16,d[4*g]=(4278190080&i[g])>>24;return d},e}(),OX=function(){function t(e){this.font=e,this.subset={},this.unicodes={},this.next=33}return t.prototype.generateCmap=function(){var e,r,n,i,a;for(r in i=this.font.cmap.tables[0].codeMap,e={},a=this.subset)n=a[r],e[r]=i[n];return e},t.prototype.glyphsFor=function(e){var r,n,i,a,o,c,u;for(i={},o=0,c=e.length;o<c;o++)i[a=e[o]]=this.font.glyf.glyphFor(a);for(a in r=[],i)(n=i[a])!=null&&n.compound&&r.push.apply(r,n.glyphIDs);if(r.length>0)for(a in u=this.glyphsFor(r))n=u[a],i[a]=n;return i},t.prototype.encode=function(e,r){var n,i,a,o,c,u,h,d,g,x,_,b,E,A,O;for(i in n=$k.encode(this.generateCmap(),"unicode"),o=this.glyphsFor(e),_={0:0},O=n.charMap)_[(u=O[i]).old]=u.new;for(b in x=n.maxGlyphID,o)b in _||(_[b]=x++);return d=function(M){var B,Q;for(B in Q={},M)Q[M[B]]=B;return Q}(_),g=Object.keys(d).sort(function(M,B){return M-B}),E=function(){var M,B,Q;for(Q=[],M=0,B=g.length;M<B;M++)c=g[M],Q.push(d[c]);return Q}(),a=this.font.glyf.encode(o,E,_),h=this.font.loca.encode(a.offsets,E),A={cmap:this.font.cmap.raw(),glyf:a.table,loca:h,hmtx:this.font.hmtx.raw(),hhea:this.font.hhea.raw(),maxp:this.font.maxp.raw(),post:this.font.post.raw(),name:this.font.name.raw(),head:this.font.head.encode(r)},this.font.os2.exists&&(A["OS/2"]=this.font.os2.raw()),this.font.directory.encode(A)},t}();ar.API.PDFObject=function(){var t;function e(){}return t=function(r,n){return(Array(n+1).join("0")+r).slice(-n)},e.convert=function(r){var n,i,a,o;if(Array.isArray(r))return"["+function(){var c,u,h;for(h=[],c=0,u=r.length;c<u;c++)n=r[c],h.push(e.convert(n));return h}().join(" ")+"]";if(typeof r=="string")return"/"+r;if(r?.isString)return"("+r+")";if(r instanceof Date)return"(D:"+t(r.getUTCFullYear(),4)+t(r.getUTCMonth(),2)+t(r.getUTCDate(),2)+t(r.getUTCHours(),2)+t(r.getUTCMinutes(),2)+t(r.getUTCSeconds(),2)+"Z)";if({}.toString.call(r)==="[object Object]"){for(i in a=["<<"],r)o=r[i],a.push("/"+i+" "+e.convert(o));return a.push(">>"),a.join(`
`)}return""+r},e}();const PX=()=>{const[t,e]=lt.useState([]),[r,n]=lt.useState([]),[i,a]=lt.useState([]),[o,c]=lt.useState([]),[u,h]=lt.useState(!0),[d,g]=lt.useState(""),[x,_]=lt.useState(""),[b,E]=lt.useState("pdf");lt.useEffect(()=>{A()},[]);const A=async()=>{try{console.log("Export: Chargement des donnes...");const U=(await io(Vi(fn,"eleves"))).docs.map(de=>({id:de.id,...de.data()}));e(U),console.log("Export: lves chargs:",U.length);const C=(await io(Vi(fn,"classes"))).docs.map(de=>({id:de.id,...de.data()}));n(C),console.log("Export: Classes charges:",C.length),console.log('Export: Chargement des priodes depuis "periodesStage"...');const se=(await io(Vi(fn,"periodesStage"))).docs.map(de=>({id:de.id,...de.data()}));a(se),console.log("Export: Priodes charges:",se.length,se);const J=(await io(Vi(fn,"evaluations"))).docs.map(de=>({id:de.id,...de.data(),dateEvaluation:de.data().dateEvaluation?.toDate()||new Date}));c(J),console.log("Export: valuations charges:",J.length)}catch(S){console.error("Erreur lors du chargement des donnes:",S)}finally{h(!1)}},O=S=>{if(!S)return"";try{return new Date(S).toLocaleDateString("fr-FR")}catch(U){return console.error("Erreur de formatage de date:",U),S}},M=S=>{switch(S){case"non_evaluee":return"";case"non_acquise":return"1";case"en_cours":return"2";case"partiellement_acquise":return"3";case"acquise":return"4";default:return""}},B=S=>{switch(S){case"non_evaluee":return"#c8c8c8";case"non_acquise":return"#ff4444";case"en_cours":return"#ff8800";case"partiellement_acquise":return"#ffaa00";case"acquise":return"#00aa44";default:return"#c8c8c8"}},Q=S=>{switch(S){case"non_evaluee":return"Non value";case"non_acquise":return"Non acquise";case"en_cours":return"En cours";case"partiellement_acquise":return"Partiellement acquise";case"acquise":return"Acquise";default:return"Non value"}},ee=(S,U,I,C)=>{switch(C){case"non_evaluee":S.setFillColor(200,200,200);break;case"non_acquise":S.setFillColor(255,68,68);break;case"en_cours":S.setFillColor(255,136,0);break;case"partiellement_acquise":S.setFillColor(255,170,0);break;case"acquise":S.setFillColor(0,170,68);break;default:S.setFillColor(200,200,200)}S.rect(U,I-4/2,4,4,"F")},he=()=>{if(!d||!x)return;const S=t.find(oe=>oe.id===d),U=r.find(oe=>oe.id===S?.classeId),I=i.find(oe=>oe.id===x),C=o.find(oe=>oe.eleveId===d&&oe.periodeId===x);if(!S||!I)return;const R=new ar,se=R.internal.pageSize.width;let ne=20;R.setFontSize(12),R.setFont("helvetica","bold"),R.text("Document de suivi et d'valuation :",15,ne),ne+=6,R.text("Situations de travail spcifies et ralises en milieu professionnel",15,ne),ne+=15,R.setFontSize(16);const J=`PFMP N ${I.nom}`;R.text(J,(se-R.getTextWidth(J))/2,ne),ne+=10,R.setFontSize(10),R.setFont("helvetica","normal");const de=`Du ${O(I.dateDebut)} au ${O(I.dateFin)}`;if(R.text(de,se-15-R.getTextWidth(de),ne),ne+=15,R.setFontSize(12),R.setFont("helvetica","bold"),R.text("NOM, PRNOM DU CANDIDAT",15,ne),ne+=8,R.setFontSize(14),R.text(`${S.nom.toUpperCase()}${S.prenom}`,15,ne),ne+=10,R.setFontSize(10),R.text(`Classe: ${U?.nom||"Non assigne"}`,15,ne),ne+=10,C&&(C.nomEntreprise||C.domaineActivite)?(R.setFontSize(12),R.setFont("helvetica","bold"),R.text("ENTREPRISE D'ACCUEIL",15,ne),ne+=8,R.setFontSize(10),R.setFont("helvetica","normal"),C.nomEntreprise&&(R.text(`Nom: ${C.nomEntreprise}`,15,ne),ne+=5),C.domaineActivite&&(R.text(`Domaine d'activit: ${C.domaineActivite}`,15,ne),ne+=5),ne+=10):ne+=15,R.setFontSize(12),R.setFont("helvetica","bold"),R.text("VALUATION DES COMPTENCES ACQUISES EN PFMP :",15,ne),ne+=10,R.setFontSize(8),R.setFont("helvetica","normal"),R.text("Critres d'valuation : 1-Non acquise, 2-En cours, 3-Partiellement acquise, 4-Acquise",15,ne),ne+=5,R.setFontSize(7),R.text("Lgende :",15,ne),ne+=3,ee(R,15,ne,"non_evaluee"),R.text("Non value",23,ne),ee(R,55,ne,"non_acquise"),R.text("Non acquise",63,ne),ee(R,95,ne,"en_cours"),R.text("En cours",103,ne),ee(R,125,ne,"partiellement_acquise"),R.text("Partiellement acquise",133,ne),ee(R,175,ne,"acquise"),R.text("Acquise",183,ne),ne+=8,C){R.setFontSize(10),R.setFont("helvetica","bold"),R.text("CC1 - S'informer sur l'intervention",15,ne),ne+=5,R.setFont("helvetica","normal");const Z=`Collecter les donnes [${M(C.competences.cc1_collecter_donnees.niveau)}]`;R.text(Z,20,ne),ee(R,170,ne,C.competences.cc1_collecter_donnees.niveau),ne+=8,R.setFont("helvetica","bold"),R.text("CC2 - Organiser la ralisation",15,ne),ne+=5,R.setFont("helvetica","normal");const xe=`Ordonner les donnes [${M(C.competences.cc2_ordonner_donnees.niveau)}]`;R.text(xe,20,ne),ee(R,170,ne,C.competences.cc2_ordonner_donnees.niveau),ne+=4;const j=`Reprer les contraintes [${M(C.competences.cc2_reperer_contraintes.niveau)}]`;R.text(j,20,ne),ee(R,170,ne,C.competences.cc2_reperer_contraintes.niveau),ne+=8,R.setFont("helvetica","bold"),R.text("CC3 - Analyser et exploiter les donnes",15,ne),ne+=5,R.setFont("helvetica","normal");const G=`Identifier les lments [${M(C.competences.cc3_identifier_elements.niveau)}]`;R.text(G,20,ne),ee(R,170,ne,C.competences.cc3_identifier_elements.niveau),ne+=4;const Ae=`Identifier les grandeurs physiques [${M(C.competences.cc3_identifier_grandeurs.niveau)}]`;R.text(Ae,20,ne),ee(R,170,ne,C.competences.cc3_identifier_grandeurs.niveau),ne+=4;const Ee=`Reprsenter l'installation [${M(C.competences.cc3_representer_installation.niveau)}]`;R.text(Ee,20,ne),ee(R,170,ne,C.competences.cc3_representer_installation.niveau),ne+=8,R.setFont("helvetica","bold"),R.text("CC4 - Raliser une installation",15,ne),ne+=5,R.setFont("helvetica","normal");const Oe=`Implanter, cbler [${M(C.competences.cc4_implanter_cabler.niveau)}]`;R.text(Oe,20,ne),ee(R,170,ne,C.competences.cc4_implanter_cabler.niveau),ne+=4;const rt=`Raliser l'installation [${M(C.competences.cc4_realiser_installation.niveau)}]`;R.text(rt,20,ne),ee(R,170,ne,C.competences.cc4_realiser_installation.niveau),ne+=4;const Pe=`Oprer dans une attitude coresponsable [${M(C.competences.cc4_operer_attitude.niveau)}]`;R.text(Pe,20,ne),ee(R,170,ne,C.competences.cc4_operer_attitude.niveau),ne+=8,R.setFont("helvetica","bold"),R.text("CC7 - tablir un pr-diagnostic (MAINTENANCE)",15,ne),ne+=5,R.setFont("helvetica","normal");const Je=`Contrler les donnes [${M(C.competences.cc7_controler_donnees.niveau)}]`;R.text(Je,20,ne),ee(R,170,ne,C.competences.cc7_controler_donnees.niveau),ne+=4;const et=`Constater les dfaillances [${M(C.competences.cc7_constater_defaillance.niveau)}]`;R.text(et,20,ne),ee(R,170,ne,C.competences.cc7_constater_defaillance.niveau),ne+=4;const Et=`Lister les hypothses [${M(C.competences.cc7_lister_hypotheses.niveau)}]`;R.text(Et,20,ne),ee(R,170,ne,C.competences.cc7_lister_hypotheses.niveau),ne+=8,R.setFont("helvetica","bold"),R.text("CC8 - Renseigner les documents (COMMUNICATION)",15,ne),ne+=5,R.setFont("helvetica","normal");const Mt=`Complter les documents [${M(C.competences.cc8_completer_documents.niveau)}]`;R.text(Mt,20,ne),ee(R,170,ne,C.competences.cc8_completer_documents.niveau),ne+=4;const qt=`Expliquer l'avancement [${M(C.competences.cc8_expliquer_avancement.niveau)}]`;R.text(qt,20,ne),ee(R,170,ne,C.competences.cc8_expliquer_avancement.niveau),ne+=4;const kt=`Rdiger un compte rendu [${M(C.competences.cc8_rediger_compte_rendu.niveau)}]`;R.text(kt,20,ne),ee(R,170,ne,C.competences.cc8_rediger_compte_rendu.niveau),ne+=8,R.setFont("helvetica","bold"),R.text("CC9 - Communiquer avec le client et/ou l'usager",15,ne),ne+=5,R.setFont("helvetica","normal");const Pt=`Interprter les informations [${M(C.competences.cc9_interpreter_informations.niveau)}]`;R.text(Pt,20,ne),ee(R,170,ne,C.competences.cc9_interpreter_informations.niveau),ne+=4;const _t=`Expliquer le fonctionnement [${M(C.competences.cc9_expliquer_fonctionnement.niveau)}]`;R.text(_t,20,ne),ee(R,170,ne,C.competences.cc9_expliquer_fonctionnement.niveau),ne+=4;const Gt=`Informer sur les consignes [${M(C.competences.cc9_informer_consignes.niveau)}]`;if(R.text(Gt,20,ne),ee(R,170,ne,C.competences.cc9_informer_consignes.niveau),ne+=12,C.commentaireGeneral||C.recommandations){if(R.setFont("helvetica","bold"),R.text("OBSERVATIONS :",15,ne),ne+=8,R.setFont("helvetica","normal"),C.commentaireGeneral){const zr=R.splitTextToSize(C.commentaireGeneral,se-30);R.text(zr,15,ne),ne+=zr.length*5+5}if(C.recommandations){R.setFont("helvetica","bold"),R.text("RECOMMANDATIONS :",15,ne),ne+=5,R.setFont("helvetica","normal");const zr=R.splitTextToSize(C.recommandations,se-30);R.text(zr,15,ne)}}}ne=R.internal.pageSize.height-40,R.setFontSize(10),R.setFont("helvetica","normal"),R.text("Date et signature du tuteur en entreprise:",15,ne),ne+=20,R.text("Date et signature de l'enseignant:",se-100,ne-20),R.save(`PFMP_${S.nom}_${S.prenom}_${I.nom}.pdf`)},F=()=>{if(!d||!x)return;const S=t.find(J=>J.id===d),U=r.find(J=>J.id===S?.classeId),I=i.find(J=>J.id===x),C=o.find(J=>J.eleveId===d&&J.periodeId===x);if(!S||!I)return;const R=[];if(R.push(["PFMP - valuation des comptences"]),R.push([""]),R.push(["lve:",`${S.nom} ${S.prenom}`]),R.push(["Classe:",U?.nom||"Non assigne"]),R.push(["Priode:",I.nom]),R.push(["Du:",O(I.dateDebut)]),R.push(["Au:",O(I.dateFin)]),R.push([""]),C&&(C.nomEntreprise||C.domaineActivite)&&(R.push(["ENTREPRISE D'ACCUEIL"]),C.nomEntreprise&&R.push(["Nom:",C.nomEntreprise]),C.domaineActivite&&R.push(["Domaine d'activit:",C.domaineActivite]),R.push([""])),R.push(["Comptence","Sous-comptence","Niveau"]),C){const J=C.competences;R.push(["CC1 - S'informer","Collecter les donnes",M(J.cc1_collecter_donnees.niveau)]),R.push(["CC2 - Organiser","Ordonner les donnes",M(J.cc2_ordonner_donnees.niveau)]),R.push(["","Reprer les contraintes",M(J.cc2_reperer_contraintes.niveau)]),R.push(["CC3 - Analyser","Identifier les lments",M(J.cc3_identifier_elements.niveau)]),R.push(["","Identifier les grandeurs",M(J.cc3_identifier_grandeurs.niveau)]),R.push(["","Reprsenter l'installation",M(J.cc3_representer_installation.niveau)]),R.push(["CC4 - Raliser","Implanter, cbler",M(J.cc4_implanter_cabler.niveau)]),R.push(["","Raliser l'installation",M(J.cc4_realiser_installation.niveau)]),R.push(["","Attitude coresponsable",M(J.cc4_operer_attitude.niveau)]),R.push(["CC7 - Maintenance","Contrler les donnes",M(J.cc7_controler_donnees.niveau)]),R.push(["","Constater les dfaillances",M(J.cc7_constater_defaillance.niveau)]),R.push(["","Lister les hypothses",M(J.cc7_lister_hypotheses.niveau)]),R.push(["CC8 - Communication","Complter les documents",M(J.cc8_completer_documents.niveau)]),R.push(["","Expliquer l'avancement",M(J.cc8_expliquer_avancement.niveau)]),R.push(["","Rdiger compte rendu",M(J.cc8_rediger_compte_rendu.niveau)]),R.push(["CC9 - Client/Usager","Interprter les informations",M(J.cc9_interpreter_informations.niveau)]),R.push(["","Expliquer le fonctionnement",M(J.cc9_expliquer_fonctionnement.niveau)]),R.push(["","Informer sur les consignes",M(J.cc9_informer_consignes.niveau)]),R.push([""]),R.push(["Commentaire gnral:",C.commentaireGeneral]),R.push(["Recommandations:",C.recommandations])}const se=Qm.aoa_to_sheet(R),ne=Qm.book_new();Qm.book_append_sheet(ne,se,"valuation PFMP"),gW(ne,`PFMP_${S.nom}_${S.prenom}_${I.nom}.xlsx`)},k=()=>{b==="pdf"?he():F()};return u?H.jsx("div",{className:"loading",children:"Chargement..."}):H.jsxs("div",{className:"export-rapports",children:[H.jsx("h2",{children:"Export des rapports PFMP"}),H.jsxs("div",{className:"export-form",children:[H.jsxs("div",{className:"form-group",children:[H.jsx("label",{htmlFor:"eleve-select",children:"Slectionner un lve:"}),H.jsxs("select",{id:"eleve-select",value:d,onChange:S=>g(S.target.value),children:[H.jsx("option",{value:"",children:"-- Choisir un lve --"}),t.map(S=>H.jsxs("option",{value:S.id,children:[S.nom," ",S.prenom]},S.id))]})]}),H.jsxs("div",{className:"form-group",children:[H.jsx("label",{htmlFor:"periode-select",children:"Slectionner une priode:"}),H.jsxs("select",{id:"periode-select",value:x,onChange:S=>_(S.target.value),children:[H.jsx("option",{value:"",children:"-- Choisir une priode --"}),i.map(S=>H.jsxs("option",{value:S.id,children:[S.nom," (",O(S.dateDebut)," - ",O(S.dateFin),")"]},S.id))]})]}),H.jsxs("div",{className:"form-group",children:[H.jsx("label",{children:"Format d'export:"}),H.jsxs("div",{className:"radio-group",children:[H.jsxs("label",{className:"radio-option",children:[H.jsx("input",{type:"radio",value:"pdf",checked:b==="pdf",onChange:S=>E(S.target.value)}),H.jsx("span",{className:"radio-label",children:"PDF (Format officiel PFMP)"})]}),H.jsxs("label",{className:"radio-option",children:[H.jsx("input",{type:"radio",value:"excel",checked:b==="excel",onChange:S=>E(S.target.value)}),H.jsx("span",{className:"radio-label",children:"Excel (Donnes dtailles)"})]})]})]}),H.jsxs("button",{onClick:k,disabled:!d||!x,className:"export-button",children:["Exporter en ",b.toUpperCase()]})]}),!d||!x?H.jsx("div",{className:"info-message",children:"Veuillez slectionner un lve et une priode pour activer l'export."}):H.jsxs("div",{className:"preview-info",children:[H.jsx("h3",{children:"Aperu de l'export:"}),H.jsxs("p",{children:["lve: ",t.find(S=>S.id===d)?.nom," ",t.find(S=>S.id===d)?.prenom]}),H.jsxs("p",{children:["Priode: ",i.find(S=>S.id===x)?.nom]}),H.jsxs("p",{children:["Format: ",b==="pdf"?"PDF - Format officiel PFMP":"Excel - Donnes dtailles"]}),(()=>{const S=o.find(U=>U.eleveId===d&&U.periodeId===x);return S?H.jsxs("div",{className:"competences-preview",children:[H.jsx("h4",{children:"Tableau des comptences values:"}),H.jsxs("div",{className:"legende",children:[H.jsx("h5",{children:"Lgende :"}),H.jsxs("div",{className:"legende-items",children:[H.jsxs("div",{className:"legende-item",children:[H.jsx("div",{className:"color-square",style:{backgroundColor:B("non_evaluee")}}),H.jsx("span",{children:"Non value"})]}),H.jsxs("div",{className:"legende-item",children:[H.jsx("div",{className:"color-square",style:{backgroundColor:B("non_acquise")}}),H.jsx("span",{children:"Non acquise"})]}),H.jsxs("div",{className:"legende-item",children:[H.jsx("div",{className:"color-square",style:{backgroundColor:B("en_cours")}}),H.jsx("span",{children:"En cours"})]}),H.jsxs("div",{className:"legende-item",children:[H.jsx("div",{className:"color-square",style:{backgroundColor:B("partiellement_acquise")}}),H.jsx("span",{children:"Partiellement acquise"})]}),H.jsxs("div",{className:"legende-item",children:[H.jsx("div",{className:"color-square",style:{backgroundColor:B("acquise")}}),H.jsx("span",{children:"Acquise"})]})]})]}),H.jsxs("table",{className:"competences-table",children:[H.jsx("thead",{children:H.jsxs("tr",{children:[H.jsx("th",{children:"Comptence"}),H.jsx("th",{children:"Sous-comptence"}),H.jsx("th",{children:"Niveau"}),H.jsx("th",{children:"valuation"})]})}),H.jsxs("tbody",{children:[H.jsxs("tr",{children:[H.jsx("td",{rowSpan:1,children:"CC1 - S'informer sur l'intervention"}),H.jsx("td",{children:"Collecter les donnes"}),H.jsx("td",{children:H.jsx("div",{className:"color-square",style:{backgroundColor:B(S.competences.cc1_collecter_donnees.niveau)}})}),H.jsx("td",{children:Q(S.competences.cc1_collecter_donnees.niveau)})]}),H.jsxs("tr",{children:[H.jsx("td",{rowSpan:2,children:"CC2 - Organiser la ralisation"}),H.jsx("td",{children:"Ordonner les donnes"}),H.jsx("td",{children:H.jsx("div",{className:"color-square",style:{backgroundColor:B(S.competences.cc2_ordonner_donnees.niveau)}})}),H.jsx("td",{children:Q(S.competences.cc2_ordonner_donnees.niveau)})]}),H.jsxs("tr",{children:[H.jsx("td",{children:"Reprer les contraintes"}),H.jsx("td",{children:H.jsx("div",{className:"color-square",style:{backgroundColor:B(S.competences.cc2_reperer_contraintes.niveau)}})}),H.jsx("td",{children:Q(S.competences.cc2_reperer_contraintes.niveau)})]}),H.jsxs("tr",{children:[H.jsx("td",{rowSpan:3,children:"CC3 - Analyser et exploiter les donnes"}),H.jsx("td",{children:"Identifier les lments"}),H.jsx("td",{children:H.jsx("div",{className:"color-square",style:{backgroundColor:B(S.competences.cc3_identifier_elements.niveau)}})}),H.jsx("td",{children:Q(S.competences.cc3_identifier_elements.niveau)})]}),H.jsxs("tr",{children:[H.jsx("td",{children:"Identifier les grandeurs physiques"}),H.jsx("td",{children:H.jsx("div",{className:"color-square",style:{backgroundColor:B(S.competences.cc3_identifier_grandeurs.niveau)}})}),H.jsx("td",{children:Q(S.competences.cc3_identifier_grandeurs.niveau)})]}),H.jsxs("tr",{children:[H.jsx("td",{children:"Reprsenter l'installation"}),H.jsx("td",{children:H.jsx("div",{className:"color-square",style:{backgroundColor:B(S.competences.cc3_representer_installation.niveau)}})}),H.jsx("td",{children:Q(S.competences.cc3_representer_installation.niveau)})]}),H.jsxs("tr",{children:[H.jsx("td",{rowSpan:3,children:"CC4 - Raliser une installation"}),H.jsx("td",{children:"Implanter, cbler"}),H.jsx("td",{children:H.jsx("div",{className:"color-square",style:{backgroundColor:B(S.competences.cc4_implanter_cabler.niveau)}})}),H.jsx("td",{children:Q(S.competences.cc4_implanter_cabler.niveau)})]}),H.jsxs("tr",{children:[H.jsx("td",{children:"Raliser l'installation"}),H.jsx("td",{children:H.jsx("div",{className:"color-square",style:{backgroundColor:B(S.competences.cc4_realiser_installation.niveau)}})}),H.jsx("td",{children:Q(S.competences.cc4_realiser_installation.niveau)})]}),H.jsxs("tr",{children:[H.jsx("td",{children:"Oprer dans une attitude coresponsable"}),H.jsx("td",{children:H.jsx("div",{className:"color-square",style:{backgroundColor:B(S.competences.cc4_operer_attitude.niveau)}})}),H.jsx("td",{children:Q(S.competences.cc4_operer_attitude.niveau)})]}),H.jsxs("tr",{children:[H.jsx("td",{rowSpan:3,children:"CC7 - tablir un pr-diagnostic (MAINTENANCE)"}),H.jsx("td",{children:"Contrler les donnes"}),H.jsx("td",{children:H.jsx("div",{className:"color-square",style:{backgroundColor:B(S.competences.cc7_controler_donnees.niveau)}})}),H.jsx("td",{children:Q(S.competences.cc7_controler_donnees.niveau)})]}),H.jsxs("tr",{children:[H.jsx("td",{children:"Constater les dfaillances"}),H.jsx("td",{children:H.jsx("div",{className:"color-square",style:{backgroundColor:B(S.competences.cc7_constater_defaillance.niveau)}})}),H.jsx("td",{children:Q(S.competences.cc7_constater_defaillance.niveau)})]}),H.jsxs("tr",{children:[H.jsx("td",{children:"Lister les hypothses"}),H.jsx("td",{children:H.jsx("div",{className:"color-square",style:{backgroundColor:B(S.competences.cc7_lister_hypotheses.niveau)}})}),H.jsx("td",{children:Q(S.competences.cc7_lister_hypotheses.niveau)})]}),H.jsxs("tr",{children:[H.jsx("td",{rowSpan:3,children:"CC8 - Communiquer avec le client/usager"}),H.jsx("td",{children:"Complter les documents"}),H.jsx("td",{children:H.jsx("div",{className:"color-square",style:{backgroundColor:B(S.competences.cc8_completer_documents.niveau)}})}),H.jsx("td",{children:Q(S.competences.cc8_completer_documents.niveau)})]}),H.jsxs("tr",{children:[H.jsx("td",{children:"Expliquer l'avancement"}),H.jsx("td",{children:H.jsx("div",{className:"color-square",style:{backgroundColor:B(S.competences.cc8_expliquer_avancement.niveau)}})}),H.jsx("td",{children:Q(S.competences.cc8_expliquer_avancement.niveau)})]}),H.jsxs("tr",{children:[H.jsx("td",{children:"Rdiger compte rendu"}),H.jsx("td",{children:H.jsx("div",{className:"color-square",style:{backgroundColor:B(S.competences.cc8_rediger_compte_rendu.niveau)}})}),H.jsx("td",{children:Q(S.competences.cc8_rediger_compte_rendu.niveau)})]}),H.jsxs("tr",{children:[H.jsx("td",{rowSpan:3,children:"CC9 - Relation client/usager"}),H.jsx("td",{children:"Interprter les informations"}),H.jsx("td",{children:H.jsx("div",{className:"color-square",style:{backgroundColor:B(S.competences.cc9_interpreter_informations.niveau)}})}),H.jsx("td",{children:Q(S.competences.cc9_interpreter_informations.niveau)})]}),H.jsxs("tr",{children:[H.jsx("td",{children:"Expliquer le fonctionnement"}),H.jsx("td",{children:H.jsx("div",{className:"color-square",style:{backgroundColor:B(S.competences.cc9_expliquer_fonctionnement.niveau)}})}),H.jsx("td",{children:Q(S.competences.cc9_expliquer_fonctionnement.niveau)})]}),H.jsxs("tr",{children:[H.jsx("td",{children:"Informer sur les consignes"}),H.jsx("td",{children:H.jsx("div",{className:"color-square",style:{backgroundColor:B(S.competences.cc9_informer_consignes.niveau)}})}),H.jsx("td",{children:Q(S.competences.cc9_informer_consignes.niveau)})]})]})]})]}):H.jsx("p",{className:"no-evaluation",children:"Aucune valuation trouve pour cette combinaison lve/priode."})})()]})]})};class MX{collectionName="users";async getUserById(e){try{const r=await gT(no(fn,this.collectionName,e));if(r.exists()){const n=r.data();return{...n,id:r.id,createdAt:n.createdAt instanceof Date?n.createdAt:new Date(n.createdAt)}}return null}catch(r){throw console.error("Erreur lors de la rcupration de l'utilisateur:",r),r}}async getAllUsers(){try{return(await io(Vi(fn,this.collectionName))).docs.map(r=>({...r.data(),id:r.id,createdAt:r.data().createdAt instanceof Date?r.data().createdAt:new Date(r.data().createdAt)}))}catch(e){throw console.error("Erreur lors de la rcupration des utilisateurs:",e),e}}async createUser(e){try{return(await hh(Vi(fn,this.collectionName),{...e,createdAt:new Date})).id}catch(r){throw console.error("Erreur lors de la cration de l'utilisateur:",r),r}}async createUserWithAuth(e){try{const n=(await XR($m,e.email,e.password)).user,i={nom:e.nom,prenom:e.prenom,email:e.email,role:e.role,createdAt:new Date};return await _T(no(fn,this.collectionName,n.uid),i),console.log(" Utilisateur cr avec succs:",n.uid),n.uid}catch(r){throw console.error(" Erreur lors de la cration de l'utilisateur avec auth:",r),r}}async updateUser(e,r){try{await u2(no(fn,this.collectionName,e),{...r,updatedAt:new Date})}catch(n){throw console.error("Erreur lors de la mise  jour de l'utilisateur:",n),n}}async deleteUser(e){try{await Tg(no(fn,this.collectionName,e)),console.log(" Utilisateur supprim de Firestore:",e)}catch(r){throw console.error("Erreur lors de la suppression de l'utilisateur:",r),r}}async getUsersByRole(e){try{const r=_y(Vi(fn,this.collectionName),Ag("role","==",e));return(await io(r)).docs.map(i=>({...i.data(),id:i.id,createdAt:i.data().createdAt instanceof Date?i.data().createdAt:new Date(i.data().createdAt)}))}catch(r){throw console.error("Erreur lors de la rcupration des utilisateurs par rle:",r),r}}}const jm=new MX,BX=()=>{const[t,e]=lt.useState([]),[r,n]=lt.useState(!0),[i,a]=lt.useState(!1),[o,c]=lt.useState(null),[u,h]=lt.useState({nom:"",prenom:"",email:"",password:"",role:"professeur"}),[d,g]=lt.useState(""),[x,_]=lt.useState("tous");lt.useEffect(()=>{b()},[]);const b=async()=>{try{n(!0);const F=await jm.getAllUsers();e(F)}catch(F){console.error("Erreur lors du chargement des utilisateurs:",F),alert("Erreur lors du chargement des utilisateurs")}finally{n(!1)}},E=async F=>{if(F.preventDefault(),!u.nom||!u.prenom||!u.email){alert("Veuillez remplir tous les champs obligatoires");return}if(!o&&(!u.password||u.password.length<6)){alert("Le mot de passe doit contenir au moins 6 caractres");return}try{if(o){const k={nom:u.nom,prenom:u.prenom,email:u.email,role:u.role};await jm.updateUser(o.id,k),e(t.map(S=>S.id===o.id?{...S,...k}:S))}else{const S={id:await jm.createUserWithAuth({nom:u.nom,prenom:u.prenom,email:u.email,password:u.password,role:u.role}),nom:u.nom,prenom:u.prenom,email:u.email,role:u.role,createdAt:new Date};e([...t,S])}M(),a(!1)}catch(k){console.error("Erreur lors de la sauvegarde:",k),alert("Erreur lors de la sauvegarde de l'utilisateur")}},A=F=>{c(F),h({nom:F.nom,prenom:F.prenom,email:F.email,password:"",role:F.role}),a(!0)},O=async F=>{if(window.confirm(`tes-vous sr de vouloir supprimer l'utilisateur ${F.nom} ${F.prenom} ?`))try{await jm.deleteUser(F.id),e(t.filter(k=>k.id!==F.id))}catch(k){console.error("Erreur lors de la suppression:",k),alert("Erreur lors de la suppression de l'utilisateur")}},M=()=>{h({nom:"",prenom:"",email:"",password:"",role:"professeur"}),c(null)},B=()=>{a(!1),M()},Q=t.filter(F=>{const k=F.nom.toLowerCase().includes(d.toLowerCase())||F.prenom.toLowerCase().includes(d.toLowerCase())||F.email.toLowerCase().includes(d.toLowerCase()),S=x==="tous"||F.role===x;return k&&S}),ee=F=>F==="admin"?"Admin":"Professeur",he=F=>F==="admin"?"role-admin":"role-professeur";return r?H.jsx("div",{className:"loading",children:"Chargement des utilisateurs..."}):H.jsxs("div",{className:"gestion-utilisateurs",children:[H.jsxs("div",{className:"header",children:[H.jsx("h2",{children:"Gestion des utilisateurs"}),H.jsx("button",{className:"btn-primary",onClick:()=>a(!0),children:"+ Nouvel utilisateur"})]}),H.jsxs("div",{className:"filters",children:[H.jsx("div",{className:"search-container",children:H.jsx("input",{type:"text",placeholder:"Rechercher un utilisateur...",value:d,onChange:F=>g(F.target.value),className:"search-input"})}),H.jsx("div",{className:"filter-container",children:H.jsxs("select",{value:x,onChange:F=>_(F.target.value),className:"filter-select",children:[H.jsx("option",{value:"tous",children:"Tous les rles"}),H.jsx("option",{value:"admin",children:"Administrateurs"}),H.jsx("option",{value:"professeur",children:"Professeurs"})]})})]}),H.jsxs("div",{className:"stats",children:[H.jsxs("div",{className:"stat-card",children:[H.jsx("h3",{children:t.length}),H.jsx("p",{children:"Total utilisateurs"})]}),H.jsxs("div",{className:"stat-card",children:[H.jsx("h3",{children:t.filter(F=>F.role==="admin").length}),H.jsx("p",{children:"Administrateurs"})]}),H.jsxs("div",{className:"stat-card",children:[H.jsx("h3",{children:t.filter(F=>F.role==="professeur").length}),H.jsx("p",{children:"Professeurs"})]})]}),H.jsxs("div",{className:"users-table-container",children:[H.jsxs("table",{className:"users-table",children:[H.jsx("thead",{children:H.jsxs("tr",{children:[H.jsx("th",{children:"Nom"}),H.jsx("th",{children:"Prnom"}),H.jsx("th",{children:"Email"}),H.jsx("th",{children:"Rle"}),H.jsx("th",{children:"Date de cration"}),H.jsx("th",{children:"Actions"})]})}),H.jsx("tbody",{children:Q.map(F=>H.jsxs("tr",{children:[H.jsx("td",{className:"user-nom",children:F.nom}),H.jsx("td",{className:"user-prenom",children:F.prenom}),H.jsx("td",{className:"user-email",children:F.email}),H.jsx("td",{children:H.jsx("span",{className:`role-badge ${he(F.role)}`,children:ee(F.role)})}),H.jsx("td",{className:"user-date",children:F.createdAt.toLocaleDateString("fr-FR")}),H.jsxs("td",{className:"actions",children:[H.jsx("button",{className:"btn-edit",onClick:()=>A(F),title:"Modifier",children:""}),H.jsx("button",{className:"btn-delete",onClick:()=>O(F),title:"Supprimer",children:""})]})]},F.id))})]}),Q.length===0&&H.jsx("div",{className:"no-users",children:H.jsx("p",{children:"Aucun utilisateur trouv"})})]}),i&&H.jsx("div",{className:"modal-overlay",children:H.jsxs("div",{className:"modal",children:[H.jsxs("div",{className:"modal-header",children:[H.jsx("h3",{children:o?"Modifier l'utilisateur":"Nouvel utilisateur"}),H.jsx("button",{className:"btn-close",onClick:B,children:""})]}),H.jsxs("form",{onSubmit:E,className:"modal-form",children:[H.jsxs("div",{className:"form-row",children:[H.jsxs("div",{className:"form-group",children:[H.jsx("label",{htmlFor:"nom",children:"Nom *"}),H.jsx("input",{type:"text",id:"nom",value:u.nom,onChange:F=>h({...u,nom:F.target.value}),required:!0})]}),H.jsxs("div",{className:"form-group",children:[H.jsx("label",{htmlFor:"prenom",children:"Prnom *"}),H.jsx("input",{type:"text",id:"prenom",value:u.prenom,onChange:F=>h({...u,prenom:F.target.value}),required:!0})]})]}),H.jsxs("div",{className:"form-group",children:[H.jsx("label",{htmlFor:"email",children:"Email *"}),H.jsx("input",{type:"email",id:"email",value:u.email,onChange:F=>h({...u,email:F.target.value}),required:!0})]}),!o&&H.jsxs("div",{className:"form-group",children:[H.jsx("label",{htmlFor:"password",children:"Mot de passe *"}),H.jsx("input",{type:"password",id:"password",value:u.password,onChange:F=>h({...u,password:F.target.value}),placeholder:"Minimum 6 caractres",required:!0,minLength:6}),H.jsx("small",{className:"form-help",children:"Le mot de passe doit contenir au moins 6 caractres"})]}),H.jsxs("div",{className:"form-group",children:[H.jsx("label",{htmlFor:"role",children:"Rle"}),H.jsxs("select",{id:"role",value:u.role,onChange:F=>h({...u,role:F.target.value}),children:[H.jsx("option",{value:"professeur",children:"Professeur"}),H.jsx("option",{value:"admin",children:"Administrateur"})]})]}),H.jsxs("div",{className:"modal-actions",children:[H.jsx("button",{type:"button",onClick:B,className:"btn-cancel",children:"Annuler"}),H.jsx("button",{type:"submit",className:"btn-save",children:o?"Modifier":"Crer"})]})]})]})})]})},jX=()=>{const{currentUser:t}=hp(),e=[{label:"Grer les classes",description:"Crez, modifiez et supprimez les classes",link:"/classes",show:t?.role==="admin",icon:""},{label:"Grer les stages",description:"Dfinissez les priodes de stage (PFMP1, PFMP2...)",link:"/periodes-stage",show:t?.role==="admin",icon:""},{label:"valuer un lve",description:"Remplissez une fiche d'valuation",link:"/evaluations",show:!0,icon:""},{label:"Exporter rapports",description:"Tlchargez les rapports de suivi",link:"/rapports",show:!0,icon:""},{label:"Gestion des comptes",description:"Grez les comptes utilisateurs",link:"/comptes",show:t?.role==="admin",icon:""}];return H.jsx("div",{className:"app home-landing dark",children:H.jsxs("main",{className:"main",style:{minHeight:"100vh"},children:[H.jsx("h1",{style:{textAlign:"center",fontSize:"3rem",fontWeight:800,marginBottom:"1rem"},children:"Grez vos stages et valuations avec IA"}),H.jsx("p",{style:{textAlign:"center",fontSize:"1.3rem",marginBottom:"2.5rem",color:"#bbb"},children:"Plateforme moderne pour la gestion des stages, des lves et des valuations"}),H.jsx("div",{className:"tiles-grid",children:e.filter(r=>r.show).map(r=>H.jsxs(ih,{to:r.link,className:"tile-card",children:[H.jsx("div",{className:"tile-icon",children:r.icon}),H.jsx("div",{className:"tile-title",children:r.label}),H.jsx("div",{className:"tile-desc",children:r.description})]},r.label))}),t&&H.jsxs("p",{style:{textAlign:"center",marginTop:"2rem",color:"#888"},children:["Connect en tant que : ",t.prenom," ",t.nom," (",t.role,")"]})]})})},v_=({children:t})=>{const{currentUser:e,loading:r}=hp();return r?H.jsx("div",{className:"loading",children:"Chargement..."}):e?H.jsx(H.Fragment,{children:t}):H.jsx(ig,{to:"/login"})},__=({children:t})=>{const{currentUser:e,loading:r}=hp();return r?H.jsx("div",{className:"loading",children:"Chargement..."}):e?e.role!=="admin"?H.jsx(ig,{to:"/"}):H.jsx(H.Fragment,{children:t}):H.jsx(ig,{to:"/login"})},UX=()=>H.jsx(cC,{children:H.jsxs("div",{className:"app dark",children:[H.jsx(SO,{}),H.jsxs(rC,{children:[H.jsx($c,{path:"/login",element:H.jsx(AO,{})}),H.jsx($c,{path:"/",element:H.jsx(v_,{children:H.jsx(jX,{})})}),H.jsx($c,{path:"/classes",element:H.jsx(__,{children:H.jsx(RW,{})})}),H.jsx($c,{path:"/periodes-stage",element:H.jsx(__,{children:H.jsx(OW,{})})}),H.jsx($c,{path:"/evaluations",element:H.jsx(v_,{children:H.jsx(PW,{})})}),H.jsx($c,{path:"/rapports",element:H.jsx(v_,{children:H.jsx(PX,{})})}),H.jsx($c,{path:"/comptes",element:H.jsx(__,{children:H.jsx(BX,{})})}),H.jsx($c,{path:"*",element:H.jsx(ig,{to:"/"})})]})]})});function VX(){return H.jsx(bO,{children:H.jsx(UX,{})})}fN.createRoot(document.getElementById("root")).render(H.jsx(Lb.StrictMode,{children:H.jsx(VX,{})}));export{Sn as _,qX as c,xx as g};
