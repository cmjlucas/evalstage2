function gR(t,e){for(var r=0;r<e.length;r++){const n=e[r];if(typeof n!="string"&&!Array.isArray(n)){for(const i in n)if(i!=="default"&&!(i in t)){const o=Object.getOwnPropertyDescriptor(n,i);o&&Object.defineProperty(t,i,o.get?o:{enumerable:!0,get:()=>n[i]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const c of o.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&n(c)}).observe(document,{childList:!0,subtree:!0});function r(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerPolicy&&(o.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?o.credentials="include":i.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function n(i){if(i.ep)return;i.ep=!0;const o=r(i);fetch(i.href,o)}})();function Gg(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var Im={exports:{}},Tu={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Sy;function vR(){if(Sy)return Tu;Sy=1;var t=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function r(n,i,o){var c=null;if(o!==void 0&&(c=""+o),i.key!==void 0&&(c=""+i.key),"key"in i){o={};for(var u in i)u!=="key"&&(o[u]=i[u])}else o=i;return i=o.ref,{$$typeof:t,type:n,key:c,ref:i!==void 0?i:null,props:o}}return Tu.Fragment=e,Tu.jsx=r,Tu.jsxs=r,Tu}var Cy;function _R(){return Cy||(Cy=1,Im.exports=vR()),Im.exports}var K=_R(),Dm={exports:{}},ft={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ry;function xR(){if(Ry)return ft;Ry=1;var t=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),i=Symbol.for("react.profiler"),o=Symbol.for("react.consumer"),c=Symbol.for("react.context"),u=Symbol.for("react.forward_ref"),h=Symbol.for("react.suspense"),d=Symbol.for("react.memo"),g=Symbol.for("react.lazy"),_=Symbol.iterator;function x(G){return G===null||typeof G!="object"?null:(G=_&&G[_]||G["@@iterator"],typeof G=="function"?G:null)}var A={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},S=Object.assign,R={};function w(G,se,M){this.props=G,this.context=se,this.refs=R,this.updater=M||A}w.prototype.isReactComponent={},w.prototype.setState=function(G,se){if(typeof G!="object"&&typeof G!="function"&&G!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,G,se,"setState")},w.prototype.forceUpdate=function(G){this.updater.enqueueForceUpdate(this,G,"forceUpdate")};function B(){}B.prototype=w.prototype;function H(G,se,M){this.props=G,this.context=se,this.refs=R,this.updater=M||A}var N=H.prototype=new B;N.constructor=H,S(N,w.prototype),N.isPureReactComponent=!0;var J=Array.isArray,re={H:null,A:null,T:null,S:null,V:null},ne=Object.prototype.hasOwnProperty;function C(G,se,M,z,Q,Z){return M=Z.ref,{$$typeof:t,type:G,key:se,ref:M!==void 0?M:null,props:Z}}function T(G,se){return C(G.type,se,void 0,void 0,void 0,G.props)}function E(G){return typeof G=="object"&&G!==null&&G.$$typeof===t}function D(G){var se={"=":"=0",":":"=2"};return"$"+G.replace(/[=:]/g,function(M){return se[M]})}var b=/\/+/g;function O(G,se){return typeof G=="object"&&G!==null&&G.key!=null?D(""+G.key):se.toString(36)}function F(){}function Fe(G){switch(G.status){case"fulfilled":return G.value;case"rejected":throw G.reason;default:switch(typeof G.status=="string"?G.then(F,F):(G.status="pending",G.then(function(se){G.status==="pending"&&(G.status="fulfilled",G.value=se)},function(se){G.status==="pending"&&(G.status="rejected",G.reason=se)})),G.status){case"fulfilled":return G.value;case"rejected":throw G.reason}}throw G}function Ce(G,se,M,z,Q){var Z=typeof G;(Z==="undefined"||Z==="boolean")&&(G=null);var ue=!1;if(G===null)ue=!0;else switch(Z){case"bigint":case"string":case"number":ue=!0;break;case"object":switch(G.$$typeof){case t:case e:ue=!0;break;case g:return ue=G._init,Ce(ue(G._payload),se,M,z,Q)}}if(ue)return Q=Q(G),ue=z===""?"."+O(G,0):z,J(Q)?(M="",ue!=null&&(M=ue.replace(b,"$&/")+"/"),Ce(Q,se,M,"",function(we){return we})):Q!=null&&(E(Q)&&(Q=T(Q,M+(Q.key==null||G&&G.key===Q.key?"":(""+Q.key).replace(b,"$&/")+"/")+ue)),se.push(Q)),1;ue=0;var De=z===""?".":z+":";if(J(G))for(var Ee=0;Ee<G.length;Ee++)z=G[Ee],Z=De+O(z,Ee),ue+=Ce(z,se,M,Z,Q);else if(Ee=x(G),typeof Ee=="function")for(G=Ee.call(G),Ee=0;!(z=G.next()).done;)z=z.value,Z=De+O(z,Ee++),ue+=Ce(z,se,M,Z,Q);else if(Z==="object"){if(typeof G.then=="function")return Ce(Fe(G),se,M,z,Q);throw se=String(G),Error("Objects are not valid as a React child (found: "+(se==="[object Object]"?"object with keys {"+Object.keys(G).join(", ")+"}":se)+"). If you meant to render a collection of children, use an array instead.")}return ue}function ae(G,se,M){if(G==null)return G;var z=[],Q=0;return Ce(G,z,"","",function(Z){return se.call(M,Z,Q++)}),z}function oe(G){if(G._status===-1){var se=G._result;se=se(),se.then(function(M){(G._status===0||G._status===-1)&&(G._status=1,G._result=M)},function(M){(G._status===0||G._status===-1)&&(G._status=2,G._result=M)}),G._status===-1&&(G._status=0,G._result=se)}if(G._status===1)return G._result.default;throw G._result}var Oe=typeof reportError=="function"?reportError:function(G){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var se=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof G=="object"&&G!==null&&typeof G.message=="string"?String(G.message):String(G),error:G});if(!window.dispatchEvent(se))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",G);return}console.error(G)};function te(){}return ft.Children={map:ae,forEach:function(G,se,M){ae(G,function(){se.apply(this,arguments)},M)},count:function(G){var se=0;return ae(G,function(){se++}),se},toArray:function(G){return ae(G,function(se){return se})||[]},only:function(G){if(!E(G))throw Error("React.Children.only expected to receive a single React element child.");return G}},ft.Component=w,ft.Fragment=r,ft.Profiler=i,ft.PureComponent=H,ft.StrictMode=n,ft.Suspense=h,ft.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=re,ft.__COMPILER_RUNTIME={__proto__:null,c:function(G){return re.H.useMemoCache(G)}},ft.cache=function(G){return function(){return G.apply(null,arguments)}},ft.cloneElement=function(G,se,M){if(G==null)throw Error("The argument must be a React element, but you passed "+G+".");var z=S({},G.props),Q=G.key,Z=void 0;if(se!=null)for(ue in se.ref!==void 0&&(Z=void 0),se.key!==void 0&&(Q=""+se.key),se)!ne.call(se,ue)||ue==="key"||ue==="__self"||ue==="__source"||ue==="ref"&&se.ref===void 0||(z[ue]=se[ue]);var ue=arguments.length-2;if(ue===1)z.children=M;else if(1<ue){for(var De=Array(ue),Ee=0;Ee<ue;Ee++)De[Ee]=arguments[Ee+2];z.children=De}return C(G.type,Q,void 0,void 0,Z,z)},ft.createContext=function(G){return G={$$typeof:c,_currentValue:G,_currentValue2:G,_threadCount:0,Provider:null,Consumer:null},G.Provider=G,G.Consumer={$$typeof:o,_context:G},G},ft.createElement=function(G,se,M){var z,Q={},Z=null;if(se!=null)for(z in se.key!==void 0&&(Z=""+se.key),se)ne.call(se,z)&&z!=="key"&&z!=="__self"&&z!=="__source"&&(Q[z]=se[z]);var ue=arguments.length-2;if(ue===1)Q.children=M;else if(1<ue){for(var De=Array(ue),Ee=0;Ee<ue;Ee++)De[Ee]=arguments[Ee+2];Q.children=De}if(G&&G.defaultProps)for(z in ue=G.defaultProps,ue)Q[z]===void 0&&(Q[z]=ue[z]);return C(G,Z,void 0,void 0,null,Q)},ft.createRef=function(){return{current:null}},ft.forwardRef=function(G){return{$$typeof:u,render:G}},ft.isValidElement=E,ft.lazy=function(G){return{$$typeof:g,_payload:{_status:-1,_result:G},_init:oe}},ft.memo=function(G,se){return{$$typeof:d,type:G,compare:se===void 0?null:se}},ft.startTransition=function(G){var se=re.T,M={};re.T=M;try{var z=G(),Q=re.S;Q!==null&&Q(M,z),typeof z=="object"&&z!==null&&typeof z.then=="function"&&z.then(te,Oe)}catch(Z){Oe(Z)}finally{re.T=se}},ft.unstable_useCacheRefresh=function(){return re.H.useCacheRefresh()},ft.use=function(G){return re.H.use(G)},ft.useActionState=function(G,se,M){return re.H.useActionState(G,se,M)},ft.useCallback=function(G,se){return re.H.useCallback(G,se)},ft.useContext=function(G){return re.H.useContext(G)},ft.useDebugValue=function(){},ft.useDeferredValue=function(G,se){return re.H.useDeferredValue(G,se)},ft.useEffect=function(G,se,M){var z=re.H;if(typeof M=="function")throw Error("useEffect CRUD overload is not enabled in this build of React.");return z.useEffect(G,se)},ft.useId=function(){return re.H.useId()},ft.useImperativeHandle=function(G,se,M){return re.H.useImperativeHandle(G,se,M)},ft.useInsertionEffect=function(G,se){return re.H.useInsertionEffect(G,se)},ft.useLayoutEffect=function(G,se){return re.H.useLayoutEffect(G,se)},ft.useMemo=function(G,se){return re.H.useMemo(G,se)},ft.useOptimistic=function(G,se){return re.H.useOptimistic(G,se)},ft.useReducer=function(G,se,M){return re.H.useReducer(G,se,M)},ft.useRef=function(G){return re.H.useRef(G)},ft.useState=function(G){return re.H.useState(G)},ft.useSyncExternalStore=function(G,se,M){return re.H.useSyncExternalStore(G,se,M)},ft.useTransition=function(){return re.H.useTransition()},ft.version="19.1.0",ft}var ky;function qg(){return ky||(ky=1,Dm.exports=xR()),Dm.exports}var Ie=qg();const A2=Gg(Ie),yR=gR({__proto__:null,default:A2},[Ie]);var Om={exports:{}},Au={},Nm={exports:{}},Fm={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var by;function ER(){return by||(by=1,function(t){function e(ae,oe){var Oe=ae.length;ae.push(oe);e:for(;0<Oe;){var te=Oe-1>>>1,G=ae[te];if(0<i(G,oe))ae[te]=oe,ae[Oe]=G,Oe=te;else break e}}function r(ae){return ae.length===0?null:ae[0]}function n(ae){if(ae.length===0)return null;var oe=ae[0],Oe=ae.pop();if(Oe!==oe){ae[0]=Oe;e:for(var te=0,G=ae.length,se=G>>>1;te<se;){var M=2*(te+1)-1,z=ae[M],Q=M+1,Z=ae[Q];if(0>i(z,Oe))Q<G&&0>i(Z,z)?(ae[te]=Z,ae[Q]=Oe,te=Q):(ae[te]=z,ae[M]=Oe,te=M);else if(Q<G&&0>i(Z,Oe))ae[te]=Z,ae[Q]=Oe,te=Q;else break e}}return oe}function i(ae,oe){var Oe=ae.sortIndex-oe.sortIndex;return Oe!==0?Oe:ae.id-oe.id}if(t.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var o=performance;t.unstable_now=function(){return o.now()}}else{var c=Date,u=c.now();t.unstable_now=function(){return c.now()-u}}var h=[],d=[],g=1,_=null,x=3,A=!1,S=!1,R=!1,w=!1,B=typeof setTimeout=="function"?setTimeout:null,H=typeof clearTimeout=="function"?clearTimeout:null,N=typeof setImmediate<"u"?setImmediate:null;function J(ae){for(var oe=r(d);oe!==null;){if(oe.callback===null)n(d);else if(oe.startTime<=ae)n(d),oe.sortIndex=oe.expirationTime,e(h,oe);else break;oe=r(d)}}function re(ae){if(R=!1,J(ae),!S)if(r(h)!==null)S=!0,ne||(ne=!0,O());else{var oe=r(d);oe!==null&&Ce(re,oe.startTime-ae)}}var ne=!1,C=-1,T=5,E=-1;function D(){return w?!0:!(t.unstable_now()-E<T)}function b(){if(w=!1,ne){var ae=t.unstable_now();E=ae;var oe=!0;try{e:{S=!1,R&&(R=!1,H(C),C=-1),A=!0;var Oe=x;try{t:{for(J(ae),_=r(h);_!==null&&!(_.expirationTime>ae&&D());){var te=_.callback;if(typeof te=="function"){_.callback=null,x=_.priorityLevel;var G=te(_.expirationTime<=ae);if(ae=t.unstable_now(),typeof G=="function"){_.callback=G,J(ae),oe=!0;break t}_===r(h)&&n(h),J(ae)}else n(h);_=r(h)}if(_!==null)oe=!0;else{var se=r(d);se!==null&&Ce(re,se.startTime-ae),oe=!1}}break e}finally{_=null,x=Oe,A=!1}oe=void 0}}finally{oe?O():ne=!1}}}var O;if(typeof N=="function")O=function(){N(b)};else if(typeof MessageChannel<"u"){var F=new MessageChannel,Fe=F.port2;F.port1.onmessage=b,O=function(){Fe.postMessage(null)}}else O=function(){B(b,0)};function Ce(ae,oe){C=B(function(){ae(t.unstable_now())},oe)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(ae){ae.callback=null},t.unstable_forceFrameRate=function(ae){0>ae||125<ae?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):T=0<ae?Math.floor(1e3/ae):5},t.unstable_getCurrentPriorityLevel=function(){return x},t.unstable_next=function(ae){switch(x){case 1:case 2:case 3:var oe=3;break;default:oe=x}var Oe=x;x=oe;try{return ae()}finally{x=Oe}},t.unstable_requestPaint=function(){w=!0},t.unstable_runWithPriority=function(ae,oe){switch(ae){case 1:case 2:case 3:case 4:case 5:break;default:ae=3}var Oe=x;x=ae;try{return oe()}finally{x=Oe}},t.unstable_scheduleCallback=function(ae,oe,Oe){var te=t.unstable_now();switch(typeof Oe=="object"&&Oe!==null?(Oe=Oe.delay,Oe=typeof Oe=="number"&&0<Oe?te+Oe:te):Oe=te,ae){case 1:var G=-1;break;case 2:G=250;break;case 5:G=1073741823;break;case 4:G=1e4;break;default:G=5e3}return G=Oe+G,ae={id:g++,callback:oe,priorityLevel:ae,startTime:Oe,expirationTime:G,sortIndex:-1},Oe>te?(ae.sortIndex=Oe,e(d,ae),r(h)===null&&ae===r(d)&&(R?(H(C),C=-1):R=!0,Ce(re,Oe-te))):(ae.sortIndex=G,e(h,ae),S||A||(S=!0,ne||(ne=!0,O()))),ae},t.unstable_shouldYield=D,t.unstable_wrapCallback=function(ae){var oe=x;return function(){var Oe=x;x=oe;try{return ae.apply(this,arguments)}finally{x=Oe}}}}(Fm)),Fm}var Iy;function TR(){return Iy||(Iy=1,Nm.exports=ER()),Nm.exports}var Pm={exports:{}},an={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Dy;function AR(){if(Dy)return an;Dy=1;var t=qg();function e(h){var d="https://react.dev/errors/"+h;if(1<arguments.length){d+="?args[]="+encodeURIComponent(arguments[1]);for(var g=2;g<arguments.length;g++)d+="&args[]="+encodeURIComponent(arguments[g])}return"Minified React error #"+h+"; visit "+d+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function r(){}var n={d:{f:r,r:function(){throw Error(e(522))},D:r,C:r,L:r,m:r,X:r,S:r,M:r},p:0,findDOMNode:null},i=Symbol.for("react.portal");function o(h,d,g){var _=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:i,key:_==null?null:""+_,children:h,containerInfo:d,implementation:g}}var c=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function u(h,d){if(h==="font")return"";if(typeof d=="string")return d==="use-credentials"?d:""}return an.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=n,an.createPortal=function(h,d){var g=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!d||d.nodeType!==1&&d.nodeType!==9&&d.nodeType!==11)throw Error(e(299));return o(h,d,null,g)},an.flushSync=function(h){var d=c.T,g=n.p;try{if(c.T=null,n.p=2,h)return h()}finally{c.T=d,n.p=g,n.d.f()}},an.preconnect=function(h,d){typeof h=="string"&&(d?(d=d.crossOrigin,d=typeof d=="string"?d==="use-credentials"?d:"":void 0):d=null,n.d.C(h,d))},an.prefetchDNS=function(h){typeof h=="string"&&n.d.D(h)},an.preinit=function(h,d){if(typeof h=="string"&&d&&typeof d.as=="string"){var g=d.as,_=u(g,d.crossOrigin),x=typeof d.integrity=="string"?d.integrity:void 0,A=typeof d.fetchPriority=="string"?d.fetchPriority:void 0;g==="style"?n.d.S(h,typeof d.precedence=="string"?d.precedence:void 0,{crossOrigin:_,integrity:x,fetchPriority:A}):g==="script"&&n.d.X(h,{crossOrigin:_,integrity:x,fetchPriority:A,nonce:typeof d.nonce=="string"?d.nonce:void 0})}},an.preinitModule=function(h,d){if(typeof h=="string")if(typeof d=="object"&&d!==null){if(d.as==null||d.as==="script"){var g=u(d.as,d.crossOrigin);n.d.M(h,{crossOrigin:g,integrity:typeof d.integrity=="string"?d.integrity:void 0,nonce:typeof d.nonce=="string"?d.nonce:void 0})}}else d==null&&n.d.M(h)},an.preload=function(h,d){if(typeof h=="string"&&typeof d=="object"&&d!==null&&typeof d.as=="string"){var g=d.as,_=u(g,d.crossOrigin);n.d.L(h,g,{crossOrigin:_,integrity:typeof d.integrity=="string"?d.integrity:void 0,nonce:typeof d.nonce=="string"?d.nonce:void 0,type:typeof d.type=="string"?d.type:void 0,fetchPriority:typeof d.fetchPriority=="string"?d.fetchPriority:void 0,referrerPolicy:typeof d.referrerPolicy=="string"?d.referrerPolicy:void 0,imageSrcSet:typeof d.imageSrcSet=="string"?d.imageSrcSet:void 0,imageSizes:typeof d.imageSizes=="string"?d.imageSizes:void 0,media:typeof d.media=="string"?d.media:void 0})}},an.preloadModule=function(h,d){if(typeof h=="string")if(d){var g=u(d.as,d.crossOrigin);n.d.m(h,{as:typeof d.as=="string"&&d.as!=="script"?d.as:void 0,crossOrigin:g,integrity:typeof d.integrity=="string"?d.integrity:void 0})}else n.d.m(h)},an.requestFormReset=function(h){n.d.r(h)},an.unstable_batchedUpdates=function(h,d){return h(d)},an.useFormState=function(h,d,g){return c.H.useFormState(h,d,g)},an.useFormStatus=function(){return c.H.useHostTransitionStatus()},an.version="19.1.0",an}var Oy;function w2(){if(Oy)return Pm.exports;Oy=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}return t(),Pm.exports=AR(),Pm.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ny;function wR(){if(Ny)return Au;Ny=1;var t=TR(),e=qg(),r=w2();function n(a){var s="https://react.dev/errors/"+a;if(1<arguments.length){s+="?args[]="+encodeURIComponent(arguments[1]);for(var l=2;l<arguments.length;l++)s+="&args[]="+encodeURIComponent(arguments[l])}return"Minified React error #"+a+"; visit "+s+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function i(a){return!(!a||a.nodeType!==1&&a.nodeType!==9&&a.nodeType!==11)}function o(a){var s=a,l=a;if(a.alternate)for(;s.return;)s=s.return;else{a=s;do s=a,(s.flags&4098)!==0&&(l=s.return),a=s.return;while(a)}return s.tag===3?l:null}function c(a){if(a.tag===13){var s=a.memoizedState;if(s===null&&(a=a.alternate,a!==null&&(s=a.memoizedState)),s!==null)return s.dehydrated}return null}function u(a){if(o(a)!==a)throw Error(n(188))}function h(a){var s=a.alternate;if(!s){if(s=o(a),s===null)throw Error(n(188));return s!==a?null:a}for(var l=a,f=s;;){var m=l.return;if(m===null)break;var v=m.alternate;if(v===null){if(f=m.return,f!==null){l=f;continue}break}if(m.child===v.child){for(v=m.child;v;){if(v===l)return u(m),a;if(v===f)return u(m),s;v=v.sibling}throw Error(n(188))}if(l.return!==f.return)l=m,f=v;else{for(var I=!1,L=m.child;L;){if(L===l){I=!0,l=m,f=v;break}if(L===f){I=!0,f=m,l=v;break}L=L.sibling}if(!I){for(L=v.child;L;){if(L===l){I=!0,l=v,f=m;break}if(L===f){I=!0,f=v,l=m;break}L=L.sibling}if(!I)throw Error(n(189))}}if(l.alternate!==f)throw Error(n(190))}if(l.tag!==3)throw Error(n(188));return l.stateNode.current===l?a:s}function d(a){var s=a.tag;if(s===5||s===26||s===27||s===6)return a;for(a=a.child;a!==null;){if(s=d(a),s!==null)return s;a=a.sibling}return null}var g=Object.assign,_=Symbol.for("react.element"),x=Symbol.for("react.transitional.element"),A=Symbol.for("react.portal"),S=Symbol.for("react.fragment"),R=Symbol.for("react.strict_mode"),w=Symbol.for("react.profiler"),B=Symbol.for("react.provider"),H=Symbol.for("react.consumer"),N=Symbol.for("react.context"),J=Symbol.for("react.forward_ref"),re=Symbol.for("react.suspense"),ne=Symbol.for("react.suspense_list"),C=Symbol.for("react.memo"),T=Symbol.for("react.lazy"),E=Symbol.for("react.activity"),D=Symbol.for("react.memo_cache_sentinel"),b=Symbol.iterator;function O(a){return a===null||typeof a!="object"?null:(a=b&&a[b]||a["@@iterator"],typeof a=="function"?a:null)}var F=Symbol.for("react.client.reference");function Fe(a){if(a==null)return null;if(typeof a=="function")return a.$$typeof===F?null:a.displayName||a.name||null;if(typeof a=="string")return a;switch(a){case S:return"Fragment";case w:return"Profiler";case R:return"StrictMode";case re:return"Suspense";case ne:return"SuspenseList";case E:return"Activity"}if(typeof a=="object")switch(a.$$typeof){case A:return"Portal";case N:return(a.displayName||"Context")+".Provider";case H:return(a._context.displayName||"Context")+".Consumer";case J:var s=a.render;return a=a.displayName,a||(a=s.displayName||s.name||"",a=a!==""?"ForwardRef("+a+")":"ForwardRef"),a;case C:return s=a.displayName||null,s!==null?s:Fe(a.type)||"Memo";case T:s=a._payload,a=a._init;try{return Fe(a(s))}catch{}}return null}var Ce=Array.isArray,ae=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,oe=r.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Oe={pending:!1,data:null,method:null,action:null},te=[],G=-1;function se(a){return{current:a}}function M(a){0>G||(a.current=te[G],te[G]=null,G--)}function z(a,s){G++,te[G]=a.current,a.current=s}var Q=se(null),Z=se(null),ue=se(null),De=se(null);function Ee(a,s){switch(z(ue,s),z(Z,a),z(Q,null),s.nodeType){case 9:case 11:a=(a=s.documentElement)&&(a=a.namespaceURI)?Jx(a):0;break;default:if(a=s.tagName,s=s.namespaceURI)s=Jx(s),a=ey(s,a);else switch(a){case"svg":a=1;break;case"math":a=2;break;default:a=0}}M(Q),z(Q,a)}function we(){M(Q),M(Z),M(ue)}function Te(a){a.memoizedState!==null&&z(De,a);var s=Q.current,l=ey(s,a.type);s!==l&&(z(Z,a),z(Q,l))}function Ue(a){Z.current===a&&(M(Q),M(Z)),De.current===a&&(M(De),vu._currentValue=Oe)}var X=Object.prototype.hasOwnProperty,nt=t.unstable_scheduleCallback,qe=t.unstable_cancelCallback,We=t.unstable_shouldYield,Be=t.unstable_requestPaint,Pe=t.unstable_now,Ye=t.unstable_getCurrentPriorityLevel,ut=t.unstable_ImmediatePriority,_t=t.unstable_UserBlockingPriority,rr=t.unstable_NormalPriority,yr=t.unstable_LowPriority,fr=t.unstable_IdlePriority,Et=t.log,er=t.unstable_setDisableYieldValue,Ze=null,Je=null;function dt(a){if(typeof Et=="function"&&er(a),Je&&typeof Je.setStrictMode=="function")try{Je.setStrictMode(Ze,a)}catch{}}var Lt=Math.clz32?Math.clz32:Vt,ot=Math.log,Ft=Math.LN2;function Vt(a){return a>>>=0,a===0?32:31-(ot(a)/Ft|0)|0}var Ot=256,Lr=4194304;function Cn(a){var s=a&42;if(s!==0)return s;switch(a&-a){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return a&4194048;case 4194304:case 8388608:case 16777216:case 33554432:return a&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return a}}function Gi(a,s,l){var f=a.pendingLanes;if(f===0)return 0;var m=0,v=a.suspendedLanes,I=a.pingedLanes;a=a.warmLanes;var L=f&134217727;return L!==0?(f=L&~v,f!==0?m=Cn(f):(I&=L,I!==0?m=Cn(I):l||(l=L&~a,l!==0&&(m=Cn(l))))):(L=f&~v,L!==0?m=Cn(L):I!==0?m=Cn(I):l||(l=f&~a,l!==0&&(m=Cn(l)))),m===0?0:s!==0&&s!==m&&(s&v)===0&&(v=m&-m,l=s&-s,v>=l||v===32&&(l&4194048)!==0)?s:m}function li(a,s){return(a.pendingLanes&~(a.suspendedLanes&~a.pingedLanes)&s)===0}function qi(a,s){switch(a){case 1:case 2:case 4:case 8:case 64:return s+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return s+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Ki(){var a=Ot;return Ot<<=1,(Ot&4194048)===0&&(Ot=256),a}function Wi(){var a=Lr;return Lr<<=1,(Lr&62914560)===0&&(Lr=4194304),a}function _a(a){for(var s=[],l=0;31>l;l++)s.push(a);return s}function xa(a,s){a.pendingLanes|=s,s!==268435456&&(a.suspendedLanes=0,a.pingedLanes=0,a.warmLanes=0)}function Fa(a,s,l,f,m,v){var I=a.pendingLanes;a.pendingLanes=l,a.suspendedLanes=0,a.pingedLanes=0,a.warmLanes=0,a.expiredLanes&=l,a.entangledLanes&=l,a.errorRecoveryDisabledLanes&=l,a.shellSuspendCounter=0;var L=a.entanglements,ee=a.expirationTimes,pe=a.hiddenUpdates;for(l=I&~l;0<l;){var Ae=31-Lt(l),ke=1<<Ae;L[Ae]=0,ee[Ae]=-1;var ve=pe[Ae];if(ve!==null)for(pe[Ae]=null,Ae=0;Ae<ve.length;Ae++){var _e=ve[Ae];_e!==null&&(_e.lane&=-536870913)}l&=~ke}f!==0&&Qn(a,f,0),v!==0&&m===0&&a.tag!==0&&(a.suspendedLanes|=v&~(I&~s))}function Qn(a,s,l){a.pendingLanes|=s,a.suspendedLanes&=~s;var f=31-Lt(s);a.entangledLanes|=s,a.entanglements[f]=a.entanglements[f]|1073741824|l&4194090}function Js(a,s){var l=a.entangledLanes|=s;for(a=a.entanglements;l;){var f=31-Lt(l),m=1<<f;m&s|a[f]&s&&(a[f]|=s),l&=~m}}function Pa(a){switch(a){case 2:a=1;break;case 8:a=4;break;case 32:a=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:a=128;break;case 268435456:a=134217728;break;default:a=0}return a}function Xi(a){return a&=-a,2<a?8<a?(a&134217727)!==0?32:268435456:8:2}function Ma(){var a=oe.p;return a!==0?a:(a=window.event,a===void 0?32:xy(a.type))}function al(a,s){var l=oe.p;try{return oe.p=a,s()}finally{oe.p=l}}var $t=Math.random().toString(36).slice(2),hr="__reactFiber$"+$t,nr="__reactProps$"+$t,Rn="__reactContainer$"+$t,eo="__reactEvents$"+$t,wc="__reactListeners$"+$t,P="__reactHandles$"+$t,W="__reactResources$"+$t,U="__reactMarker$"+$t;function j(a){delete a[hr],delete a[nr],delete a[eo],delete a[wc],delete a[P]}function q(a){var s=a[hr];if(s)return s;for(var l=a.parentNode;l;){if(s=l[Rn]||l[hr]){if(l=s.alternate,s.child!==null||l!==null&&l.child!==null)for(a=ay(a);a!==null;){if(l=a[hr])return l;a=ay(a)}return s}a=l,l=a.parentNode}return null}function Y(a){if(a=a[hr]||a[Rn]){var s=a.tag;if(s===5||s===6||s===13||s===26||s===27||s===3)return a}return null}function de(a){var s=a.tag;if(s===5||s===26||s===27||s===6)return a.stateNode;throw Error(n(33))}function xe(a){var s=a[W];return s||(s=a[W]={hoistableStyles:new Map,hoistableScripts:new Map}),s}function ce(a){a[U]=!0}var me=new Set,ge={};function Ne(a,s){Le(a,s),Le(a+"Capture",s)}function Le(a,s){for(ge[a]=s,a=0;a<s.length;a++)me.add(s[a])}var ze=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Me={},je={};function at(a){return X.call(je,a)?!0:X.call(Me,a)?!1:ze.test(a)?je[a]=!0:(Me[a]=!0,!1)}function Pt(a,s,l){if(at(s))if(l===null)a.removeAttribute(s);else{switch(typeof l){case"undefined":case"function":case"symbol":a.removeAttribute(s);return;case"boolean":var f=s.toLowerCase().slice(0,5);if(f!=="data-"&&f!=="aria-"){a.removeAttribute(s);return}}a.setAttribute(s,""+l)}}function St(a,s,l){if(l===null)a.removeAttribute(s);else{switch(typeof l){case"undefined":case"function":case"symbol":case"boolean":a.removeAttribute(s);return}a.setAttribute(s,""+l)}}function Ct(a,s,l,f){if(f===null)a.removeAttribute(l);else{switch(typeof f){case"undefined":case"function":case"symbol":case"boolean":a.removeAttribute(l);return}a.setAttributeNS(s,l,""+f)}}var Mn,La;function vn(a){if(Mn===void 0)try{throw Error()}catch(l){var s=l.stack.trim().match(/\n( *(at )?)/);Mn=s&&s[1]||"",La=-1<l.stack.indexOf(`
    at`)?" (<anonymous>)":-1<l.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Mn+a+La}var kn=!1;function Va(a,s){if(!a||kn)return"";kn=!0;var l=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var f={DetermineComponentFrameRoot:function(){try{if(s){var ke=function(){throw Error()};if(Object.defineProperty(ke.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(ke,[])}catch(_e){var ve=_e}Reflect.construct(a,[],ke)}else{try{ke.call()}catch(_e){ve=_e}a.call(ke.prototype)}}else{try{throw Error()}catch(_e){ve=_e}(ke=a())&&typeof ke.catch=="function"&&ke.catch(function(){})}}catch(_e){if(_e&&ve&&typeof _e.stack=="string")return[_e.stack,ve.stack]}return[null,null]}};f.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var m=Object.getOwnPropertyDescriptor(f.DetermineComponentFrameRoot,"name");m&&m.configurable&&Object.defineProperty(f.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var v=f.DetermineComponentFrameRoot(),I=v[0],L=v[1];if(I&&L){var ee=I.split(`
`),pe=L.split(`
`);for(m=f=0;f<ee.length&&!ee[f].includes("DetermineComponentFrameRoot");)f++;for(;m<pe.length&&!pe[m].includes("DetermineComponentFrameRoot");)m++;if(f===ee.length||m===pe.length)for(f=ee.length-1,m=pe.length-1;1<=f&&0<=m&&ee[f]!==pe[m];)m--;for(;1<=f&&0<=m;f--,m--)if(ee[f]!==pe[m]){if(f!==1||m!==1)do if(f--,m--,0>m||ee[f]!==pe[m]){var Ae=`
`+ee[f].replace(" at new "," at ");return a.displayName&&Ae.includes("<anonymous>")&&(Ae=Ae.replace("<anonymous>",a.displayName)),Ae}while(1<=f&&0<=m);break}}}finally{kn=!1,Error.prepareStackTrace=l}return(l=a?a.displayName||a.name:"")?vn(l):""}function _n(a){switch(a.tag){case 26:case 27:case 5:return vn(a.type);case 16:return vn("Lazy");case 13:return vn("Suspense");case 19:return vn("SuspenseList");case 0:case 15:return Va(a.type,!1);case 11:return Va(a.type.render,!1);case 1:return Va(a.type,!0);case 31:return vn("Activity");default:return""}}function il(a){try{var s="";do s+=_n(a),a=a.return;while(a);return s}catch(l){return`
Error generating stack: `+l.message+`
`+l.stack}}function xn(a){switch(typeof a){case"bigint":case"boolean":case"number":case"string":case"undefined":return a;case"object":return a;default:return""}}function Sc(a){var s=a.type;return(a=a.nodeName)&&a.toLowerCase()==="input"&&(s==="checkbox"||s==="radio")}function Fd(a){var s=Sc(a)?"checked":"value",l=Object.getOwnPropertyDescriptor(a.constructor.prototype,s),f=""+a[s];if(!a.hasOwnProperty(s)&&typeof l<"u"&&typeof l.get=="function"&&typeof l.set=="function"){var m=l.get,v=l.set;return Object.defineProperty(a,s,{configurable:!0,get:function(){return m.call(this)},set:function(I){f=""+I,v.call(this,I)}}),Object.defineProperty(a,s,{enumerable:l.enumerable}),{getValue:function(){return f},setValue:function(I){f=""+I},stopTracking:function(){a._valueTracker=null,delete a[s]}}}}function sl(a){a._valueTracker||(a._valueTracker=Fd(a))}function Cc(a){if(!a)return!1;var s=a._valueTracker;if(!s)return!0;var l=s.getValue(),f="";return a&&(f=Sc(a)?a.checked?"true":"false":a.value),a=f,a!==l?(s.setValue(a),!0):!1}function to(a){if(a=a||(typeof document<"u"?document:void 0),typeof a>"u")return null;try{return a.activeElement||a.body}catch{return a.body}}var Pd=/[\n"\\]/g;function Er(a){return a.replace(Pd,function(s){return"\\"+s.charCodeAt(0).toString(16)+" "})}function Ln(a,s,l,f,m,v,I,L){a.name="",I!=null&&typeof I!="function"&&typeof I!="symbol"&&typeof I!="boolean"?a.type=I:a.removeAttribute("type"),s!=null?I==="number"?(s===0&&a.value===""||a.value!=s)&&(a.value=""+xn(s)):a.value!==""+xn(s)&&(a.value=""+xn(s)):I!=="submit"&&I!=="reset"||a.removeAttribute("value"),s!=null?Yi(a,I,xn(s)):l!=null?Yi(a,I,xn(l)):f!=null&&a.removeAttribute("value"),m==null&&v!=null&&(a.defaultChecked=!!v),m!=null&&(a.checked=m&&typeof m!="function"&&typeof m!="symbol"),L!=null&&typeof L!="function"&&typeof L!="symbol"&&typeof L!="boolean"?a.name=""+xn(L):a.removeAttribute("name")}function ro(a,s,l,f,m,v,I,L){if(v!=null&&typeof v!="function"&&typeof v!="symbol"&&typeof v!="boolean"&&(a.type=v),s!=null||l!=null){if(!(v!=="submit"&&v!=="reset"||s!=null))return;l=l!=null?""+xn(l):"",s=s!=null?""+xn(s):l,L||s===a.value||(a.value=s),a.defaultValue=s}f=f??m,f=typeof f!="function"&&typeof f!="symbol"&&!!f,a.checked=L?a.checked:!!f,a.defaultChecked=!!f,I!=null&&typeof I!="function"&&typeof I!="symbol"&&typeof I!="boolean"&&(a.name=I)}function Yi(a,s,l){s==="number"&&to(a.ownerDocument)===a||a.defaultValue===""+l||(a.defaultValue=""+l)}function ci(a,s,l,f){if(a=a.options,s){s={};for(var m=0;m<l.length;m++)s["$"+l[m]]=!0;for(l=0;l<a.length;l++)m=s.hasOwnProperty("$"+a[l].value),a[l].selected!==m&&(a[l].selected=m),m&&f&&(a[l].defaultSelected=!0)}else{for(l=""+xn(l),s=null,m=0;m<a.length;m++){if(a[m].value===l){a[m].selected=!0,f&&(a[m].defaultSelected=!0);return}s!==null||a[m].disabled||(s=a[m])}s!==null&&(s.selected=!0)}}function qt(a,s,l){if(s!=null&&(s=""+xn(s),s!==a.value&&(a.value=s),l==null)){a.defaultValue!==s&&(a.defaultValue=s);return}a.defaultValue=l!=null?""+xn(l):""}function no(a,s,l,f){if(s==null){if(f!=null){if(l!=null)throw Error(n(92));if(Ce(f)){if(1<f.length)throw Error(n(93));f=f[0]}l=f}l==null&&(l=""),s=l}l=xn(s),a.defaultValue=l,f=a.textContent,f===l&&f!==""&&f!==null&&(a.value=f)}function Zn(a,s){if(s){var l=a.firstChild;if(l&&l===a.lastChild&&l.nodeType===3){l.nodeValue=s;return}}a.textContent=s}var ao=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Vf(a,s,l){var f=s.indexOf("--")===0;l==null||typeof l=="boolean"||l===""?f?a.setProperty(s,""):s==="float"?a.cssFloat="":a[s]="":f?a.setProperty(s,l):typeof l!="number"||l===0||ao.has(s)?s==="float"?a.cssFloat=l:a[s]=(""+l).trim():a[s]=l+"px"}function Rc(a,s,l){if(s!=null&&typeof s!="object")throw Error(n(62));if(a=a.style,l!=null){for(var f in l)!l.hasOwnProperty(f)||s!=null&&s.hasOwnProperty(f)||(f.indexOf("--")===0?a.setProperty(f,""):f==="float"?a.cssFloat="":a[f]="");for(var m in s)f=s[m],s.hasOwnProperty(m)&&l[m]!==f&&Vf(a,m,f)}else for(var v in s)s.hasOwnProperty(v)&&Vf(a,v,s[v])}function kc(a){if(a.indexOf("-")===-1)return!1;switch(a){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Md=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Ld=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function ol(a){return Ld.test(""+a)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":a}var ui=null;function Jn(a){return a=a.target||a.srcElement||window,a.correspondingUseElement&&(a=a.correspondingUseElement),a.nodeType===3?a.parentNode:a}var fi=null,hi=null;function bc(a){var s=Y(a);if(s&&(a=s.stateNode)){var l=a[nr]||null;e:switch(a=s.stateNode,s.type){case"input":if(Ln(a,l.value,l.defaultValue,l.defaultValue,l.checked,l.defaultChecked,l.type,l.name),s=l.name,l.type==="radio"&&s!=null){for(l=a;l.parentNode;)l=l.parentNode;for(l=l.querySelectorAll('input[name="'+Er(""+s)+'"][type="radio"]'),s=0;s<l.length;s++){var f=l[s];if(f!==a&&f.form===a.form){var m=f[nr]||null;if(!m)throw Error(n(90));Ln(f,m.value,m.defaultValue,m.defaultValue,m.checked,m.defaultChecked,m.type,m.name)}}for(s=0;s<l.length;s++)f=l[s],f.form===a.form&&Cc(f)}break e;case"textarea":qt(a,l.value,l.defaultValue);break e;case"select":s=l.value,s!=null&&ci(a,!!l.multiple,s,!1)}}}var Ua=!1;function Uf(a,s,l){if(Ua)return a(s,l);Ua=!0;try{var f=a(s);return f}finally{if(Ua=!1,(fi!==null||hi!==null)&&(Oh(),fi&&(s=fi,a=hi,hi=fi=null,bc(s),a)))for(s=0;s<a.length;s++)bc(a[s])}}function io(a,s){var l=a.stateNode;if(l===null)return null;var f=l[nr]||null;if(f===null)return null;l=f[s];e:switch(s){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(f=!f.disabled)||(a=a.type,f=!(a==="button"||a==="input"||a==="select"||a==="textarea")),a=!f;break e;default:a=!1}if(a)return null;if(l&&typeof l!="function")throw Error(n(231,s,typeof l));return l}var ya=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),ea=!1;if(ya)try{var so={};Object.defineProperty(so,"passive",{get:function(){ea=!0}}),window.addEventListener("test",so,so),window.removeEventListener("test",so,so)}catch{ea=!1}var Ba=null,$i=null,di=null;function Ic(){if(di)return di;var a,s=$i,l=s.length,f,m="value"in Ba?Ba.value:Ba.textContent,v=m.length;for(a=0;a<l&&s[a]===m[a];a++);var I=l-a;for(f=1;f<=I&&s[l-f]===m[v-f];f++);return di=m.slice(a,1<f?1-f:void 0)}function ja(a){var s=a.keyCode;return"charCode"in a?(a=a.charCode,a===0&&s===13&&(a=13)):a=s,a===10&&(a=13),32<=a||a===13?a:0}function za(){return!0}function Dc(){return!1}function Vr(a){function s(l,f,m,v,I){this._reactName=l,this._targetInst=m,this.type=f,this.nativeEvent=v,this.target=I,this.currentTarget=null;for(var L in a)a.hasOwnProperty(L)&&(l=a[L],this[L]=l?l(v):v[L]);return this.isDefaultPrevented=(v.defaultPrevented!=null?v.defaultPrevented:v.returnValue===!1)?za:Dc,this.isPropagationStopped=Dc,this}return g(s.prototype,{preventDefault:function(){this.defaultPrevented=!0;var l=this.nativeEvent;l&&(l.preventDefault?l.preventDefault():typeof l.returnValue!="unknown"&&(l.returnValue=!1),this.isDefaultPrevented=za)},stopPropagation:function(){var l=this.nativeEvent;l&&(l.stopPropagation?l.stopPropagation():typeof l.cancelBubble!="unknown"&&(l.cancelBubble=!0),this.isPropagationStopped=za)},persist:function(){},isPersistent:za}),s}var Bt={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(a){return a.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},ll=Vr(Bt),oo=g({},Bt,{view:0,detail:0}),Bf=Vr(oo),cl,ul,Ha,lo=g({},oo,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:fo,button:0,buttons:0,relatedTarget:function(a){return a.relatedTarget===void 0?a.fromElement===a.srcElement?a.toElement:a.fromElement:a.relatedTarget},movementX:function(a){return"movementX"in a?a.movementX:(a!==Ha&&(Ha&&a.type==="mousemove"?(cl=a.screenX-Ha.screenX,ul=a.screenY-Ha.screenY):ul=cl=0,Ha=a),cl)},movementY:function(a){return"movementY"in a?a.movementY:ul}}),ta=Vr(lo),jf=g({},lo,{dataTransfer:0}),Vd=Vr(jf),co=g({},oo,{relatedTarget:0}),fl=Vr(co),Oc=g({},Bt,{animationName:0,elapsedTime:0,pseudoElement:0}),hl=Vr(Oc),zf=g({},Bt,{clipboardData:function(a){return"clipboardData"in a?a.clipboardData:window.clipboardData}}),dl=Vr(zf),Ud=g({},Bt,{data:0}),Nc=Vr(Ud),uo={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Hf={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Gf={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Fc(a){var s=this.nativeEvent;return s.getModifierState?s.getModifierState(a):(a=Gf[a])?!!s[a]:!1}function fo(){return Fc}var qf=g({},oo,{key:function(a){if(a.key){var s=uo[a.key]||a.key;if(s!=="Unidentified")return s}return a.type==="keypress"?(a=ja(a),a===13?"Enter":String.fromCharCode(a)):a.type==="keydown"||a.type==="keyup"?Hf[a.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:fo,charCode:function(a){return a.type==="keypress"?ja(a):0},keyCode:function(a){return a.type==="keydown"||a.type==="keyup"?a.keyCode:0},which:function(a){return a.type==="keypress"?ja(a):a.type==="keydown"||a.type==="keyup"?a.keyCode:0}}),pl=Vr(qf),Kf=g({},lo,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Pc=Vr(Kf),pi=g({},oo,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:fo}),Wf=Vr(pi),Xf=g({},Bt,{propertyName:0,elapsedTime:0,pseudoElement:0}),Yf=Vr(Xf),$f=g({},lo,{deltaX:function(a){return"deltaX"in a?a.deltaX:"wheelDeltaX"in a?-a.wheelDeltaX:0},deltaY:function(a){return"deltaY"in a?a.deltaY:"wheelDeltaY"in a?-a.wheelDeltaY:"wheelDelta"in a?-a.wheelDelta:0},deltaZ:0,deltaMode:0}),ml=Vr($f),yn=g({},Bt,{newState:0,oldState:0}),Qf=Vr(yn),Zf=[9,13,27,32],Ga=ya&&"CompositionEvent"in window,p=null;ya&&"documentMode"in document&&(p=document.documentMode);var y=ya&&"TextEvent"in window&&!p,k=ya&&(!Ga||p&&8<p&&11>=p),V=" ",fe=!1;function ye(a,s){switch(a){case"keyup":return Zf.indexOf(s.keyCode)!==-1;case"keydown":return s.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Ve(a){return a=a.detail,typeof a=="object"&&"data"in a?a.data:null}var Rt=!1;function Ir(a,s){switch(a){case"compositionend":return Ve(s);case"keypress":return s.which!==32?null:(fe=!0,V);case"textInput":return a=s.data,a===V&&fe?null:a;default:return null}}function kt(a,s){if(Rt)return a==="compositionend"||!Ga&&ye(a,s)?(a=Ic(),di=$i=Ba=null,Rt=!1,a):null;switch(a){case"paste":return null;case"keypress":if(!(s.ctrlKey||s.altKey||s.metaKey)||s.ctrlKey&&s.altKey){if(s.char&&1<s.char.length)return s.char;if(s.which)return String.fromCharCode(s.which)}return null;case"compositionend":return k&&s.locale!=="ko"?null:s.data;default:return null}}var Ur={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Dr(a){var s=a&&a.nodeName&&a.nodeName.toLowerCase();return s==="input"?!!Ur[a.type]:s==="textarea"}function mi(a,s,l,f){fi?hi?hi.push(f):hi=[f]:fi=f,s=Vh(s,"onChange"),0<s.length&&(l=new ll("onChange","change",null,l,f),a.push({event:l,listeners:s}))}var Wr=null,qa=null;function Mc(a){Xx(a,0)}function Jf(a){var s=de(a);if(Cc(s))return a}function mv(a,s){if(a==="change")return s}var gv=!1;if(ya){var Bd;if(ya){var jd="oninput"in document;if(!jd){var vv=document.createElement("div");vv.setAttribute("oninput","return;"),jd=typeof vv.oninput=="function"}Bd=jd}else Bd=!1;gv=Bd&&(!document.documentMode||9<document.documentMode)}function _v(){Wr&&(Wr.detachEvent("onpropertychange",xv),qa=Wr=null)}function xv(a){if(a.propertyName==="value"&&Jf(qa)){var s=[];mi(s,qa,a,Jn(a)),Uf(Mc,s)}}function K4(a,s,l){a==="focusin"?(_v(),Wr=s,qa=l,Wr.attachEvent("onpropertychange",xv)):a==="focusout"&&_v()}function W4(a){if(a==="selectionchange"||a==="keyup"||a==="keydown")return Jf(qa)}function X4(a,s){if(a==="click")return Jf(s)}function Y4(a,s){if(a==="input"||a==="change")return Jf(s)}function $4(a,s){return a===s&&(a!==0||1/a===1/s)||a!==a&&s!==s}var Vn=typeof Object.is=="function"?Object.is:$4;function Lc(a,s){if(Vn(a,s))return!0;if(typeof a!="object"||a===null||typeof s!="object"||s===null)return!1;var l=Object.keys(a),f=Object.keys(s);if(l.length!==f.length)return!1;for(f=0;f<l.length;f++){var m=l[f];if(!X.call(s,m)||!Vn(a[m],s[m]))return!1}return!0}function yv(a){for(;a&&a.firstChild;)a=a.firstChild;return a}function Ev(a,s){var l=yv(a);a=0;for(var f;l;){if(l.nodeType===3){if(f=a+l.textContent.length,a<=s&&f>=s)return{node:l,offset:s-a};a=f}e:{for(;l;){if(l.nextSibling){l=l.nextSibling;break e}l=l.parentNode}l=void 0}l=yv(l)}}function Tv(a,s){return a&&s?a===s?!0:a&&a.nodeType===3?!1:s&&s.nodeType===3?Tv(a,s.parentNode):"contains"in a?a.contains(s):a.compareDocumentPosition?!!(a.compareDocumentPosition(s)&16):!1:!1}function Av(a){a=a!=null&&a.ownerDocument!=null&&a.ownerDocument.defaultView!=null?a.ownerDocument.defaultView:window;for(var s=to(a.document);s instanceof a.HTMLIFrameElement;){try{var l=typeof s.contentWindow.location.href=="string"}catch{l=!1}if(l)a=s.contentWindow;else break;s=to(a.document)}return s}function zd(a){var s=a&&a.nodeName&&a.nodeName.toLowerCase();return s&&(s==="input"&&(a.type==="text"||a.type==="search"||a.type==="tel"||a.type==="url"||a.type==="password")||s==="textarea"||a.contentEditable==="true")}var Q4=ya&&"documentMode"in document&&11>=document.documentMode,gl=null,Hd=null,Vc=null,Gd=!1;function wv(a,s,l){var f=l.window===l?l.document:l.nodeType===9?l:l.ownerDocument;Gd||gl==null||gl!==to(f)||(f=gl,"selectionStart"in f&&zd(f)?f={start:f.selectionStart,end:f.selectionEnd}:(f=(f.ownerDocument&&f.ownerDocument.defaultView||window).getSelection(),f={anchorNode:f.anchorNode,anchorOffset:f.anchorOffset,focusNode:f.focusNode,focusOffset:f.focusOffset}),Vc&&Lc(Vc,f)||(Vc=f,f=Vh(Hd,"onSelect"),0<f.length&&(s=new ll("onSelect","select",null,s,l),a.push({event:s,listeners:f}),s.target=gl)))}function ho(a,s){var l={};return l[a.toLowerCase()]=s.toLowerCase(),l["Webkit"+a]="webkit"+s,l["Moz"+a]="moz"+s,l}var vl={animationend:ho("Animation","AnimationEnd"),animationiteration:ho("Animation","AnimationIteration"),animationstart:ho("Animation","AnimationStart"),transitionrun:ho("Transition","TransitionRun"),transitionstart:ho("Transition","TransitionStart"),transitioncancel:ho("Transition","TransitionCancel"),transitionend:ho("Transition","TransitionEnd")},qd={},Sv={};ya&&(Sv=document.createElement("div").style,"AnimationEvent"in window||(delete vl.animationend.animation,delete vl.animationiteration.animation,delete vl.animationstart.animation),"TransitionEvent"in window||delete vl.transitionend.transition);function po(a){if(qd[a])return qd[a];if(!vl[a])return a;var s=vl[a],l;for(l in s)if(s.hasOwnProperty(l)&&l in Sv)return qd[a]=s[l];return a}var Cv=po("animationend"),Rv=po("animationiteration"),kv=po("animationstart"),Z4=po("transitionrun"),J4=po("transitionstart"),eC=po("transitioncancel"),bv=po("transitionend"),Iv=new Map,Kd="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Kd.push("scrollEnd");function Ea(a,s){Iv.set(a,s),Ne(s,[a])}var Dv=new WeakMap;function ra(a,s){if(typeof a=="object"&&a!==null){var l=Dv.get(a);return l!==void 0?l:(s={value:a,source:s,stack:il(s)},Dv.set(a,s),s)}return{value:a,source:s,stack:il(s)}}var na=[],_l=0,Wd=0;function eh(){for(var a=_l,s=Wd=_l=0;s<a;){var l=na[s];na[s++]=null;var f=na[s];na[s++]=null;var m=na[s];na[s++]=null;var v=na[s];if(na[s++]=null,f!==null&&m!==null){var I=f.pending;I===null?m.next=m:(m.next=I.next,I.next=m),f.pending=m}v!==0&&Ov(l,m,v)}}function th(a,s,l,f){na[_l++]=a,na[_l++]=s,na[_l++]=l,na[_l++]=f,Wd|=f,a.lanes|=f,a=a.alternate,a!==null&&(a.lanes|=f)}function Xd(a,s,l,f){return th(a,s,l,f),rh(a)}function xl(a,s){return th(a,null,null,s),rh(a)}function Ov(a,s,l){a.lanes|=l;var f=a.alternate;f!==null&&(f.lanes|=l);for(var m=!1,v=a.return;v!==null;)v.childLanes|=l,f=v.alternate,f!==null&&(f.childLanes|=l),v.tag===22&&(a=v.stateNode,a===null||a._visibility&1||(m=!0)),a=v,v=v.return;return a.tag===3?(v=a.stateNode,m&&s!==null&&(m=31-Lt(l),a=v.hiddenUpdates,f=a[m],f===null?a[m]=[s]:f.push(s),s.lane=l|536870912),v):null}function rh(a){if(50<cu)throw cu=0,em=null,Error(n(185));for(var s=a.return;s!==null;)a=s,s=a.return;return a.tag===3?a.stateNode:null}var yl={};function tC(a,s,l,f){this.tag=a,this.key=l,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=s,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=f,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Un(a,s,l,f){return new tC(a,s,l,f)}function Yd(a){return a=a.prototype,!(!a||!a.isReactComponent)}function gi(a,s){var l=a.alternate;return l===null?(l=Un(a.tag,s,a.key,a.mode),l.elementType=a.elementType,l.type=a.type,l.stateNode=a.stateNode,l.alternate=a,a.alternate=l):(l.pendingProps=s,l.type=a.type,l.flags=0,l.subtreeFlags=0,l.deletions=null),l.flags=a.flags&65011712,l.childLanes=a.childLanes,l.lanes=a.lanes,l.child=a.child,l.memoizedProps=a.memoizedProps,l.memoizedState=a.memoizedState,l.updateQueue=a.updateQueue,s=a.dependencies,l.dependencies=s===null?null:{lanes:s.lanes,firstContext:s.firstContext},l.sibling=a.sibling,l.index=a.index,l.ref=a.ref,l.refCleanup=a.refCleanup,l}function Nv(a,s){a.flags&=65011714;var l=a.alternate;return l===null?(a.childLanes=0,a.lanes=s,a.child=null,a.subtreeFlags=0,a.memoizedProps=null,a.memoizedState=null,a.updateQueue=null,a.dependencies=null,a.stateNode=null):(a.childLanes=l.childLanes,a.lanes=l.lanes,a.child=l.child,a.subtreeFlags=0,a.deletions=null,a.memoizedProps=l.memoizedProps,a.memoizedState=l.memoizedState,a.updateQueue=l.updateQueue,a.type=l.type,s=l.dependencies,a.dependencies=s===null?null:{lanes:s.lanes,firstContext:s.firstContext}),a}function nh(a,s,l,f,m,v){var I=0;if(f=a,typeof a=="function")Yd(a)&&(I=1);else if(typeof a=="string")I=nR(a,l,Q.current)?26:a==="html"||a==="head"||a==="body"?27:5;else e:switch(a){case E:return a=Un(31,l,s,m),a.elementType=E,a.lanes=v,a;case S:return mo(l.children,m,v,s);case R:I=8,m|=24;break;case w:return a=Un(12,l,s,m|2),a.elementType=w,a.lanes=v,a;case re:return a=Un(13,l,s,m),a.elementType=re,a.lanes=v,a;case ne:return a=Un(19,l,s,m),a.elementType=ne,a.lanes=v,a;default:if(typeof a=="object"&&a!==null)switch(a.$$typeof){case B:case N:I=10;break e;case H:I=9;break e;case J:I=11;break e;case C:I=14;break e;case T:I=16,f=null;break e}I=29,l=Error(n(130,a===null?"null":typeof a,"")),f=null}return s=Un(I,l,s,m),s.elementType=a,s.type=f,s.lanes=v,s}function mo(a,s,l,f){return a=Un(7,a,f,s),a.lanes=l,a}function $d(a,s,l){return a=Un(6,a,null,s),a.lanes=l,a}function Qd(a,s,l){return s=Un(4,a.children!==null?a.children:[],a.key,s),s.lanes=l,s.stateNode={containerInfo:a.containerInfo,pendingChildren:null,implementation:a.implementation},s}var El=[],Tl=0,ah=null,ih=0,aa=[],ia=0,go=null,vi=1,_i="";function vo(a,s){El[Tl++]=ih,El[Tl++]=ah,ah=a,ih=s}function Fv(a,s,l){aa[ia++]=vi,aa[ia++]=_i,aa[ia++]=go,go=a;var f=vi;a=_i;var m=32-Lt(f)-1;f&=~(1<<m),l+=1;var v=32-Lt(s)+m;if(30<v){var I=m-m%5;v=(f&(1<<I)-1).toString(32),f>>=I,m-=I,vi=1<<32-Lt(s)+m|l<<m|f,_i=v+a}else vi=1<<v|l<<m|f,_i=a}function Zd(a){a.return!==null&&(vo(a,1),Fv(a,1,0))}function Jd(a){for(;a===ah;)ah=El[--Tl],El[Tl]=null,ih=El[--Tl],El[Tl]=null;for(;a===go;)go=aa[--ia],aa[ia]=null,_i=aa[--ia],aa[ia]=null,vi=aa[--ia],aa[ia]=null}var En=null,lr=null,Ut=!1,_o=null,Ka=!1,ep=Error(n(519));function xo(a){var s=Error(n(418,""));throw jc(ra(s,a)),ep}function Pv(a){var s=a.stateNode,l=a.type,f=a.memoizedProps;switch(s[hr]=a,s[nr]=f,l){case"dialog":yt("cancel",s),yt("close",s);break;case"iframe":case"object":case"embed":yt("load",s);break;case"video":case"audio":for(l=0;l<fu.length;l++)yt(fu[l],s);break;case"source":yt("error",s);break;case"img":case"image":case"link":yt("error",s),yt("load",s);break;case"details":yt("toggle",s);break;case"input":yt("invalid",s),ro(s,f.value,f.defaultValue,f.checked,f.defaultChecked,f.type,f.name,!0),sl(s);break;case"select":yt("invalid",s);break;case"textarea":yt("invalid",s),no(s,f.value,f.defaultValue,f.children),sl(s)}l=f.children,typeof l!="string"&&typeof l!="number"&&typeof l!="bigint"||s.textContent===""+l||f.suppressHydrationWarning===!0||Zx(s.textContent,l)?(f.popover!=null&&(yt("beforetoggle",s),yt("toggle",s)),f.onScroll!=null&&yt("scroll",s),f.onScrollEnd!=null&&yt("scrollend",s),f.onClick!=null&&(s.onclick=Uh),s=!0):s=!1,s||xo(a)}function Mv(a){for(En=a.return;En;)switch(En.tag){case 5:case 13:Ka=!1;return;case 27:case 3:Ka=!0;return;default:En=En.return}}function Uc(a){if(a!==En)return!1;if(!Ut)return Mv(a),Ut=!0,!1;var s=a.tag,l;if((l=s!==3&&s!==27)&&((l=s===5)&&(l=a.type,l=!(l!=="form"&&l!=="button")||gm(a.type,a.memoizedProps)),l=!l),l&&lr&&xo(a),Mv(a),s===13){if(a=a.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(n(317));e:{for(a=a.nextSibling,s=0;a;){if(a.nodeType===8)if(l=a.data,l==="/$"){if(s===0){lr=Aa(a.nextSibling);break e}s--}else l!=="$"&&l!=="$!"&&l!=="$?"||s++;a=a.nextSibling}lr=null}}else s===27?(s=lr,hs(a.type)?(a=ym,ym=null,lr=a):lr=s):lr=En?Aa(a.stateNode.nextSibling):null;return!0}function Bc(){lr=En=null,Ut=!1}function Lv(){var a=_o;return a!==null&&(Dn===null?Dn=a:Dn.push.apply(Dn,a),_o=null),a}function jc(a){_o===null?_o=[a]:_o.push(a)}var tp=se(null),yo=null,xi=null;function Qi(a,s,l){z(tp,s._currentValue),s._currentValue=l}function yi(a){a._currentValue=tp.current,M(tp)}function rp(a,s,l){for(;a!==null;){var f=a.alternate;if((a.childLanes&s)!==s?(a.childLanes|=s,f!==null&&(f.childLanes|=s)):f!==null&&(f.childLanes&s)!==s&&(f.childLanes|=s),a===l)break;a=a.return}}function np(a,s,l,f){var m=a.child;for(m!==null&&(m.return=a);m!==null;){var v=m.dependencies;if(v!==null){var I=m.child;v=v.firstContext;e:for(;v!==null;){var L=v;v=m;for(var ee=0;ee<s.length;ee++)if(L.context===s[ee]){v.lanes|=l,L=v.alternate,L!==null&&(L.lanes|=l),rp(v.return,l,a),f||(I=null);break e}v=L.next}}else if(m.tag===18){if(I=m.return,I===null)throw Error(n(341));I.lanes|=l,v=I.alternate,v!==null&&(v.lanes|=l),rp(I,l,a),I=null}else I=m.child;if(I!==null)I.return=m;else for(I=m;I!==null;){if(I===a){I=null;break}if(m=I.sibling,m!==null){m.return=I.return,I=m;break}I=I.return}m=I}}function zc(a,s,l,f){a=null;for(var m=s,v=!1;m!==null;){if(!v){if((m.flags&524288)!==0)v=!0;else if((m.flags&262144)!==0)break}if(m.tag===10){var I=m.alternate;if(I===null)throw Error(n(387));if(I=I.memoizedProps,I!==null){var L=m.type;Vn(m.pendingProps.value,I.value)||(a!==null?a.push(L):a=[L])}}else if(m===De.current){if(I=m.alternate,I===null)throw Error(n(387));I.memoizedState.memoizedState!==m.memoizedState.memoizedState&&(a!==null?a.push(vu):a=[vu])}m=m.return}a!==null&&np(s,a,l,f),s.flags|=262144}function sh(a){for(a=a.firstContext;a!==null;){if(!Vn(a.context._currentValue,a.memoizedValue))return!0;a=a.next}return!1}function Eo(a){yo=a,xi=null,a=a.dependencies,a!==null&&(a.firstContext=null)}function nn(a){return Vv(yo,a)}function oh(a,s){return yo===null&&Eo(a),Vv(a,s)}function Vv(a,s){var l=s._currentValue;if(s={context:s,memoizedValue:l,next:null},xi===null){if(a===null)throw Error(n(308));xi=s,a.dependencies={lanes:0,firstContext:s},a.flags|=524288}else xi=xi.next=s;return l}var rC=typeof AbortController<"u"?AbortController:function(){var a=[],s=this.signal={aborted:!1,addEventListener:function(l,f){a.push(f)}};this.abort=function(){s.aborted=!0,a.forEach(function(l){return l()})}},nC=t.unstable_scheduleCallback,aC=t.unstable_NormalPriority,Or={$$typeof:N,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function ap(){return{controller:new rC,data:new Map,refCount:0}}function Hc(a){a.refCount--,a.refCount===0&&nC(aC,function(){a.controller.abort()})}var Gc=null,ip=0,Al=0,wl=null;function iC(a,s){if(Gc===null){var l=Gc=[];ip=0,Al=om(),wl={status:"pending",value:void 0,then:function(f){l.push(f)}}}return ip++,s.then(Uv,Uv),s}function Uv(){if(--ip===0&&Gc!==null){wl!==null&&(wl.status="fulfilled");var a=Gc;Gc=null,Al=0,wl=null;for(var s=0;s<a.length;s++)(0,a[s])()}}function sC(a,s){var l=[],f={status:"pending",value:null,reason:null,then:function(m){l.push(m)}};return a.then(function(){f.status="fulfilled",f.value=s;for(var m=0;m<l.length;m++)(0,l[m])(s)},function(m){for(f.status="rejected",f.reason=m,m=0;m<l.length;m++)(0,l[m])(void 0)}),f}var Bv=ae.S;ae.S=function(a,s){typeof s=="object"&&s!==null&&typeof s.then=="function"&&iC(a,s),Bv!==null&&Bv(a,s)};var To=se(null);function sp(){var a=To.current;return a!==null?a:Qt.pooledCache}function lh(a,s){s===null?z(To,To.current):z(To,s.pool)}function jv(){var a=sp();return a===null?null:{parent:Or._currentValue,pool:a}}var qc=Error(n(460)),zv=Error(n(474)),ch=Error(n(542)),op={then:function(){}};function Hv(a){return a=a.status,a==="fulfilled"||a==="rejected"}function uh(){}function Gv(a,s,l){switch(l=a[l],l===void 0?a.push(s):l!==s&&(s.then(uh,uh),s=l),s.status){case"fulfilled":return s.value;case"rejected":throw a=s.reason,Kv(a),a;default:if(typeof s.status=="string")s.then(uh,uh);else{if(a=Qt,a!==null&&100<a.shellSuspendCounter)throw Error(n(482));a=s,a.status="pending",a.then(function(f){if(s.status==="pending"){var m=s;m.status="fulfilled",m.value=f}},function(f){if(s.status==="pending"){var m=s;m.status="rejected",m.reason=f}})}switch(s.status){case"fulfilled":return s.value;case"rejected":throw a=s.reason,Kv(a),a}throw Kc=s,qc}}var Kc=null;function qv(){if(Kc===null)throw Error(n(459));var a=Kc;return Kc=null,a}function Kv(a){if(a===qc||a===ch)throw Error(n(483))}var Zi=!1;function lp(a){a.updateQueue={baseState:a.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function cp(a,s){a=a.updateQueue,s.updateQueue===a&&(s.updateQueue={baseState:a.baseState,firstBaseUpdate:a.firstBaseUpdate,lastBaseUpdate:a.lastBaseUpdate,shared:a.shared,callbacks:null})}function Ji(a){return{lane:a,tag:0,payload:null,callback:null,next:null}}function es(a,s,l){var f=a.updateQueue;if(f===null)return null;if(f=f.shared,(zt&2)!==0){var m=f.pending;return m===null?s.next=s:(s.next=m.next,m.next=s),f.pending=s,s=rh(a),Ov(a,null,l),s}return th(a,f,s,l),rh(a)}function Wc(a,s,l){if(s=s.updateQueue,s!==null&&(s=s.shared,(l&4194048)!==0)){var f=s.lanes;f&=a.pendingLanes,l|=f,s.lanes=l,Js(a,l)}}function up(a,s){var l=a.updateQueue,f=a.alternate;if(f!==null&&(f=f.updateQueue,l===f)){var m=null,v=null;if(l=l.firstBaseUpdate,l!==null){do{var I={lane:l.lane,tag:l.tag,payload:l.payload,callback:null,next:null};v===null?m=v=I:v=v.next=I,l=l.next}while(l!==null);v===null?m=v=s:v=v.next=s}else m=v=s;l={baseState:f.baseState,firstBaseUpdate:m,lastBaseUpdate:v,shared:f.shared,callbacks:f.callbacks},a.updateQueue=l;return}a=l.lastBaseUpdate,a===null?l.firstBaseUpdate=s:a.next=s,l.lastBaseUpdate=s}var fp=!1;function Xc(){if(fp){var a=wl;if(a!==null)throw a}}function Yc(a,s,l,f){fp=!1;var m=a.updateQueue;Zi=!1;var v=m.firstBaseUpdate,I=m.lastBaseUpdate,L=m.shared.pending;if(L!==null){m.shared.pending=null;var ee=L,pe=ee.next;ee.next=null,I===null?v=pe:I.next=pe,I=ee;var Ae=a.alternate;Ae!==null&&(Ae=Ae.updateQueue,L=Ae.lastBaseUpdate,L!==I&&(L===null?Ae.firstBaseUpdate=pe:L.next=pe,Ae.lastBaseUpdate=ee))}if(v!==null){var ke=m.baseState;I=0,Ae=pe=ee=null,L=v;do{var ve=L.lane&-536870913,_e=ve!==L.lane;if(_e?(bt&ve)===ve:(f&ve)===ve){ve!==0&&ve===Al&&(fp=!0),Ae!==null&&(Ae=Ae.next={lane:0,tag:L.tag,payload:L.payload,callback:null,next:null});e:{var it=a,Qe=L;ve=s;var Xt=l;switch(Qe.tag){case 1:if(it=Qe.payload,typeof it=="function"){ke=it.call(Xt,ke,ve);break e}ke=it;break e;case 3:it.flags=it.flags&-65537|128;case 0:if(it=Qe.payload,ve=typeof it=="function"?it.call(Xt,ke,ve):it,ve==null)break e;ke=g({},ke,ve);break e;case 2:Zi=!0}}ve=L.callback,ve!==null&&(a.flags|=64,_e&&(a.flags|=8192),_e=m.callbacks,_e===null?m.callbacks=[ve]:_e.push(ve))}else _e={lane:ve,tag:L.tag,payload:L.payload,callback:L.callback,next:null},Ae===null?(pe=Ae=_e,ee=ke):Ae=Ae.next=_e,I|=ve;if(L=L.next,L===null){if(L=m.shared.pending,L===null)break;_e=L,L=_e.next,_e.next=null,m.lastBaseUpdate=_e,m.shared.pending=null}}while(!0);Ae===null&&(ee=ke),m.baseState=ee,m.firstBaseUpdate=pe,m.lastBaseUpdate=Ae,v===null&&(m.shared.lanes=0),ls|=I,a.lanes=I,a.memoizedState=ke}}function Wv(a,s){if(typeof a!="function")throw Error(n(191,a));a.call(s)}function Xv(a,s){var l=a.callbacks;if(l!==null)for(a.callbacks=null,a=0;a<l.length;a++)Wv(l[a],s)}var Sl=se(null),fh=se(0);function Yv(a,s){a=Ri,z(fh,a),z(Sl,s),Ri=a|s.baseLanes}function hp(){z(fh,Ri),z(Sl,Sl.current)}function dp(){Ri=fh.current,M(Sl),M(fh)}var ts=0,pt=null,Kt=null,Tr=null,hh=!1,Cl=!1,Ao=!1,dh=0,$c=0,Rl=null,oC=0;function dr(){throw Error(n(321))}function pp(a,s){if(s===null)return!1;for(var l=0;l<s.length&&l<a.length;l++)if(!Vn(a[l],s[l]))return!1;return!0}function mp(a,s,l,f,m,v){return ts=v,pt=s,s.memoizedState=null,s.updateQueue=null,s.lanes=0,ae.H=a===null||a.memoizedState===null?O_:N_,Ao=!1,v=l(f,m),Ao=!1,Cl&&(v=Qv(s,l,f,m)),$v(a),v}function $v(a){ae.H=xh;var s=Kt!==null&&Kt.next!==null;if(ts=0,Tr=Kt=pt=null,hh=!1,$c=0,Rl=null,s)throw Error(n(300));a===null||Br||(a=a.dependencies,a!==null&&sh(a)&&(Br=!0))}function Qv(a,s,l,f){pt=a;var m=0;do{if(Cl&&(Rl=null),$c=0,Cl=!1,25<=m)throw Error(n(301));if(m+=1,Tr=Kt=null,a.updateQueue!=null){var v=a.updateQueue;v.lastEffect=null,v.events=null,v.stores=null,v.memoCache!=null&&(v.memoCache.index=0)}ae.H=pC,v=s(l,f)}while(Cl);return v}function lC(){var a=ae.H,s=a.useState()[0];return s=typeof s.then=="function"?Qc(s):s,a=a.useState()[0],(Kt!==null?Kt.memoizedState:null)!==a&&(pt.flags|=1024),s}function gp(){var a=dh!==0;return dh=0,a}function vp(a,s,l){s.updateQueue=a.updateQueue,s.flags&=-2053,a.lanes&=~l}function _p(a){if(hh){for(a=a.memoizedState;a!==null;){var s=a.queue;s!==null&&(s.pending=null),a=a.next}hh=!1}ts=0,Tr=Kt=pt=null,Cl=!1,$c=dh=0,Rl=null}function bn(){var a={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Tr===null?pt.memoizedState=Tr=a:Tr=Tr.next=a,Tr}function Ar(){if(Kt===null){var a=pt.alternate;a=a!==null?a.memoizedState:null}else a=Kt.next;var s=Tr===null?pt.memoizedState:Tr.next;if(s!==null)Tr=s,Kt=a;else{if(a===null)throw pt.alternate===null?Error(n(467)):Error(n(310));Kt=a,a={memoizedState:Kt.memoizedState,baseState:Kt.baseState,baseQueue:Kt.baseQueue,queue:Kt.queue,next:null},Tr===null?pt.memoizedState=Tr=a:Tr=Tr.next=a}return Tr}function xp(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Qc(a){var s=$c;return $c+=1,Rl===null&&(Rl=[]),a=Gv(Rl,a,s),s=pt,(Tr===null?s.memoizedState:Tr.next)===null&&(s=s.alternate,ae.H=s===null||s.memoizedState===null?O_:N_),a}function ph(a){if(a!==null&&typeof a=="object"){if(typeof a.then=="function")return Qc(a);if(a.$$typeof===N)return nn(a)}throw Error(n(438,String(a)))}function yp(a){var s=null,l=pt.updateQueue;if(l!==null&&(s=l.memoCache),s==null){var f=pt.alternate;f!==null&&(f=f.updateQueue,f!==null&&(f=f.memoCache,f!=null&&(s={data:f.data.map(function(m){return m.slice()}),index:0})))}if(s==null&&(s={data:[],index:0}),l===null&&(l=xp(),pt.updateQueue=l),l.memoCache=s,l=s.data[s.index],l===void 0)for(l=s.data[s.index]=Array(a),f=0;f<a;f++)l[f]=D;return s.index++,l}function Ei(a,s){return typeof s=="function"?s(a):s}function mh(a){var s=Ar();return Ep(s,Kt,a)}function Ep(a,s,l){var f=a.queue;if(f===null)throw Error(n(311));f.lastRenderedReducer=l;var m=a.baseQueue,v=f.pending;if(v!==null){if(m!==null){var I=m.next;m.next=v.next,v.next=I}s.baseQueue=m=v,f.pending=null}if(v=a.baseState,m===null)a.memoizedState=v;else{s=m.next;var L=I=null,ee=null,pe=s,Ae=!1;do{var ke=pe.lane&-536870913;if(ke!==pe.lane?(bt&ke)===ke:(ts&ke)===ke){var ve=pe.revertLane;if(ve===0)ee!==null&&(ee=ee.next={lane:0,revertLane:0,action:pe.action,hasEagerState:pe.hasEagerState,eagerState:pe.eagerState,next:null}),ke===Al&&(Ae=!0);else if((ts&ve)===ve){pe=pe.next,ve===Al&&(Ae=!0);continue}else ke={lane:0,revertLane:pe.revertLane,action:pe.action,hasEagerState:pe.hasEagerState,eagerState:pe.eagerState,next:null},ee===null?(L=ee=ke,I=v):ee=ee.next=ke,pt.lanes|=ve,ls|=ve;ke=pe.action,Ao&&l(v,ke),v=pe.hasEagerState?pe.eagerState:l(v,ke)}else ve={lane:ke,revertLane:pe.revertLane,action:pe.action,hasEagerState:pe.hasEagerState,eagerState:pe.eagerState,next:null},ee===null?(L=ee=ve,I=v):ee=ee.next=ve,pt.lanes|=ke,ls|=ke;pe=pe.next}while(pe!==null&&pe!==s);if(ee===null?I=v:ee.next=L,!Vn(v,a.memoizedState)&&(Br=!0,Ae&&(l=wl,l!==null)))throw l;a.memoizedState=v,a.baseState=I,a.baseQueue=ee,f.lastRenderedState=v}return m===null&&(f.lanes=0),[a.memoizedState,f.dispatch]}function Tp(a){var s=Ar(),l=s.queue;if(l===null)throw Error(n(311));l.lastRenderedReducer=a;var f=l.dispatch,m=l.pending,v=s.memoizedState;if(m!==null){l.pending=null;var I=m=m.next;do v=a(v,I.action),I=I.next;while(I!==m);Vn(v,s.memoizedState)||(Br=!0),s.memoizedState=v,s.baseQueue===null&&(s.baseState=v),l.lastRenderedState=v}return[v,f]}function Zv(a,s,l){var f=pt,m=Ar(),v=Ut;if(v){if(l===void 0)throw Error(n(407));l=l()}else l=s();var I=!Vn((Kt||m).memoizedState,l);I&&(m.memoizedState=l,Br=!0),m=m.queue;var L=t_.bind(null,f,m,a);if(Zc(2048,8,L,[a]),m.getSnapshot!==s||I||Tr!==null&&Tr.memoizedState.tag&1){if(f.flags|=2048,kl(9,gh(),e_.bind(null,f,m,l,s),null),Qt===null)throw Error(n(349));v||(ts&124)!==0||Jv(f,s,l)}return l}function Jv(a,s,l){a.flags|=16384,a={getSnapshot:s,value:l},s=pt.updateQueue,s===null?(s=xp(),pt.updateQueue=s,s.stores=[a]):(l=s.stores,l===null?s.stores=[a]:l.push(a))}function e_(a,s,l,f){s.value=l,s.getSnapshot=f,r_(s)&&n_(a)}function t_(a,s,l){return l(function(){r_(s)&&n_(a)})}function r_(a){var s=a.getSnapshot;a=a.value;try{var l=s();return!Vn(a,l)}catch{return!0}}function n_(a){var s=xl(a,2);s!==null&&Gn(s,a,2)}function Ap(a){var s=bn();if(typeof a=="function"){var l=a;if(a=l(),Ao){dt(!0);try{l()}finally{dt(!1)}}}return s.memoizedState=s.baseState=a,s.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ei,lastRenderedState:a},s}function a_(a,s,l,f){return a.baseState=l,Ep(a,Kt,typeof f=="function"?f:Ei)}function cC(a,s,l,f,m){if(_h(a))throw Error(n(485));if(a=s.action,a!==null){var v={payload:m,action:a,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(I){v.listeners.push(I)}};ae.T!==null?l(!0):v.isTransition=!1,f(v),l=s.pending,l===null?(v.next=s.pending=v,i_(s,v)):(v.next=l.next,s.pending=l.next=v)}}function i_(a,s){var l=s.action,f=s.payload,m=a.state;if(s.isTransition){var v=ae.T,I={};ae.T=I;try{var L=l(m,f),ee=ae.S;ee!==null&&ee(I,L),s_(a,s,L)}catch(pe){wp(a,s,pe)}finally{ae.T=v}}else try{v=l(m,f),s_(a,s,v)}catch(pe){wp(a,s,pe)}}function s_(a,s,l){l!==null&&typeof l=="object"&&typeof l.then=="function"?l.then(function(f){o_(a,s,f)},function(f){return wp(a,s,f)}):o_(a,s,l)}function o_(a,s,l){s.status="fulfilled",s.value=l,l_(s),a.state=l,s=a.pending,s!==null&&(l=s.next,l===s?a.pending=null:(l=l.next,s.next=l,i_(a,l)))}function wp(a,s,l){var f=a.pending;if(a.pending=null,f!==null){f=f.next;do s.status="rejected",s.reason=l,l_(s),s=s.next;while(s!==f)}a.action=null}function l_(a){a=a.listeners;for(var s=0;s<a.length;s++)(0,a[s])()}function c_(a,s){return s}function u_(a,s){if(Ut){var l=Qt.formState;if(l!==null){e:{var f=pt;if(Ut){if(lr){t:{for(var m=lr,v=Ka;m.nodeType!==8;){if(!v){m=null;break t}if(m=Aa(m.nextSibling),m===null){m=null;break t}}v=m.data,m=v==="F!"||v==="F"?m:null}if(m){lr=Aa(m.nextSibling),f=m.data==="F!";break e}}xo(f)}f=!1}f&&(s=l[0])}}return l=bn(),l.memoizedState=l.baseState=s,f={pending:null,lanes:0,dispatch:null,lastRenderedReducer:c_,lastRenderedState:s},l.queue=f,l=b_.bind(null,pt,f),f.dispatch=l,f=Ap(!1),v=bp.bind(null,pt,!1,f.queue),f=bn(),m={state:s,dispatch:null,action:a,pending:null},f.queue=m,l=cC.bind(null,pt,m,v,l),m.dispatch=l,f.memoizedState=a,[s,l,!1]}function f_(a){var s=Ar();return h_(s,Kt,a)}function h_(a,s,l){if(s=Ep(a,s,c_)[0],a=mh(Ei)[0],typeof s=="object"&&s!==null&&typeof s.then=="function")try{var f=Qc(s)}catch(I){throw I===qc?ch:I}else f=s;s=Ar();var m=s.queue,v=m.dispatch;return l!==s.memoizedState&&(pt.flags|=2048,kl(9,gh(),uC.bind(null,m,l),null)),[f,v,a]}function uC(a,s){a.action=s}function d_(a){var s=Ar(),l=Kt;if(l!==null)return h_(s,l,a);Ar(),s=s.memoizedState,l=Ar();var f=l.queue.dispatch;return l.memoizedState=a,[s,f,!1]}function kl(a,s,l,f){return a={tag:a,create:l,deps:f,inst:s,next:null},s=pt.updateQueue,s===null&&(s=xp(),pt.updateQueue=s),l=s.lastEffect,l===null?s.lastEffect=a.next=a:(f=l.next,l.next=a,a.next=f,s.lastEffect=a),a}function gh(){return{destroy:void 0,resource:void 0}}function p_(){return Ar().memoizedState}function vh(a,s,l,f){var m=bn();f=f===void 0?null:f,pt.flags|=a,m.memoizedState=kl(1|s,gh(),l,f)}function Zc(a,s,l,f){var m=Ar();f=f===void 0?null:f;var v=m.memoizedState.inst;Kt!==null&&f!==null&&pp(f,Kt.memoizedState.deps)?m.memoizedState=kl(s,v,l,f):(pt.flags|=a,m.memoizedState=kl(1|s,v,l,f))}function m_(a,s){vh(8390656,8,a,s)}function g_(a,s){Zc(2048,8,a,s)}function v_(a,s){return Zc(4,2,a,s)}function __(a,s){return Zc(4,4,a,s)}function x_(a,s){if(typeof s=="function"){a=a();var l=s(a);return function(){typeof l=="function"?l():s(null)}}if(s!=null)return a=a(),s.current=a,function(){s.current=null}}function y_(a,s,l){l=l!=null?l.concat([a]):null,Zc(4,4,x_.bind(null,s,a),l)}function Sp(){}function E_(a,s){var l=Ar();s=s===void 0?null:s;var f=l.memoizedState;return s!==null&&pp(s,f[1])?f[0]:(l.memoizedState=[a,s],a)}function T_(a,s){var l=Ar();s=s===void 0?null:s;var f=l.memoizedState;if(s!==null&&pp(s,f[1]))return f[0];if(f=a(),Ao){dt(!0);try{a()}finally{dt(!1)}}return l.memoizedState=[f,s],f}function Cp(a,s,l){return l===void 0||(ts&1073741824)!==0?a.memoizedState=s:(a.memoizedState=l,a=Sx(),pt.lanes|=a,ls|=a,l)}function A_(a,s,l,f){return Vn(l,s)?l:Sl.current!==null?(a=Cp(a,l,f),Vn(a,s)||(Br=!0),a):(ts&42)===0?(Br=!0,a.memoizedState=l):(a=Sx(),pt.lanes|=a,ls|=a,s)}function w_(a,s,l,f,m){var v=oe.p;oe.p=v!==0&&8>v?v:8;var I=ae.T,L={};ae.T=L,bp(a,!1,s,l);try{var ee=m(),pe=ae.S;if(pe!==null&&pe(L,ee),ee!==null&&typeof ee=="object"&&typeof ee.then=="function"){var Ae=sC(ee,f);Jc(a,s,Ae,Hn(a))}else Jc(a,s,f,Hn(a))}catch(ke){Jc(a,s,{then:function(){},status:"rejected",reason:ke},Hn())}finally{oe.p=v,ae.T=I}}function fC(){}function Rp(a,s,l,f){if(a.tag!==5)throw Error(n(476));var m=S_(a).queue;w_(a,m,s,Oe,l===null?fC:function(){return C_(a),l(f)})}function S_(a){var s=a.memoizedState;if(s!==null)return s;s={memoizedState:Oe,baseState:Oe,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ei,lastRenderedState:Oe},next:null};var l={};return s.next={memoizedState:l,baseState:l,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ei,lastRenderedState:l},next:null},a.memoizedState=s,a=a.alternate,a!==null&&(a.memoizedState=s),s}function C_(a){var s=S_(a).next.queue;Jc(a,s,{},Hn())}function kp(){return nn(vu)}function R_(){return Ar().memoizedState}function k_(){return Ar().memoizedState}function hC(a){for(var s=a.return;s!==null;){switch(s.tag){case 24:case 3:var l=Hn();a=Ji(l);var f=es(s,a,l);f!==null&&(Gn(f,s,l),Wc(f,s,l)),s={cache:ap()},a.payload=s;return}s=s.return}}function dC(a,s,l){var f=Hn();l={lane:f,revertLane:0,action:l,hasEagerState:!1,eagerState:null,next:null},_h(a)?I_(s,l):(l=Xd(a,s,l,f),l!==null&&(Gn(l,a,f),D_(l,s,f)))}function b_(a,s,l){var f=Hn();Jc(a,s,l,f)}function Jc(a,s,l,f){var m={lane:f,revertLane:0,action:l,hasEagerState:!1,eagerState:null,next:null};if(_h(a))I_(s,m);else{var v=a.alternate;if(a.lanes===0&&(v===null||v.lanes===0)&&(v=s.lastRenderedReducer,v!==null))try{var I=s.lastRenderedState,L=v(I,l);if(m.hasEagerState=!0,m.eagerState=L,Vn(L,I))return th(a,s,m,0),Qt===null&&eh(),!1}catch{}finally{}if(l=Xd(a,s,m,f),l!==null)return Gn(l,a,f),D_(l,s,f),!0}return!1}function bp(a,s,l,f){if(f={lane:2,revertLane:om(),action:f,hasEagerState:!1,eagerState:null,next:null},_h(a)){if(s)throw Error(n(479))}else s=Xd(a,l,f,2),s!==null&&Gn(s,a,2)}function _h(a){var s=a.alternate;return a===pt||s!==null&&s===pt}function I_(a,s){Cl=hh=!0;var l=a.pending;l===null?s.next=s:(s.next=l.next,l.next=s),a.pending=s}function D_(a,s,l){if((l&4194048)!==0){var f=s.lanes;f&=a.pendingLanes,l|=f,s.lanes=l,Js(a,l)}}var xh={readContext:nn,use:ph,useCallback:dr,useContext:dr,useEffect:dr,useImperativeHandle:dr,useLayoutEffect:dr,useInsertionEffect:dr,useMemo:dr,useReducer:dr,useRef:dr,useState:dr,useDebugValue:dr,useDeferredValue:dr,useTransition:dr,useSyncExternalStore:dr,useId:dr,useHostTransitionStatus:dr,useFormState:dr,useActionState:dr,useOptimistic:dr,useMemoCache:dr,useCacheRefresh:dr},O_={readContext:nn,use:ph,useCallback:function(a,s){return bn().memoizedState=[a,s===void 0?null:s],a},useContext:nn,useEffect:m_,useImperativeHandle:function(a,s,l){l=l!=null?l.concat([a]):null,vh(4194308,4,x_.bind(null,s,a),l)},useLayoutEffect:function(a,s){return vh(4194308,4,a,s)},useInsertionEffect:function(a,s){vh(4,2,a,s)},useMemo:function(a,s){var l=bn();s=s===void 0?null:s;var f=a();if(Ao){dt(!0);try{a()}finally{dt(!1)}}return l.memoizedState=[f,s],f},useReducer:function(a,s,l){var f=bn();if(l!==void 0){var m=l(s);if(Ao){dt(!0);try{l(s)}finally{dt(!1)}}}else m=s;return f.memoizedState=f.baseState=m,a={pending:null,lanes:0,dispatch:null,lastRenderedReducer:a,lastRenderedState:m},f.queue=a,a=a.dispatch=dC.bind(null,pt,a),[f.memoizedState,a]},useRef:function(a){var s=bn();return a={current:a},s.memoizedState=a},useState:function(a){a=Ap(a);var s=a.queue,l=b_.bind(null,pt,s);return s.dispatch=l,[a.memoizedState,l]},useDebugValue:Sp,useDeferredValue:function(a,s){var l=bn();return Cp(l,a,s)},useTransition:function(){var a=Ap(!1);return a=w_.bind(null,pt,a.queue,!0,!1),bn().memoizedState=a,[!1,a]},useSyncExternalStore:function(a,s,l){var f=pt,m=bn();if(Ut){if(l===void 0)throw Error(n(407));l=l()}else{if(l=s(),Qt===null)throw Error(n(349));(bt&124)!==0||Jv(f,s,l)}m.memoizedState=l;var v={value:l,getSnapshot:s};return m.queue=v,m_(t_.bind(null,f,v,a),[a]),f.flags|=2048,kl(9,gh(),e_.bind(null,f,v,l,s),null),l},useId:function(){var a=bn(),s=Qt.identifierPrefix;if(Ut){var l=_i,f=vi;l=(f&~(1<<32-Lt(f)-1)).toString(32)+l,s="«"+s+"R"+l,l=dh++,0<l&&(s+="H"+l.toString(32)),s+="»"}else l=oC++,s="«"+s+"r"+l.toString(32)+"»";return a.memoizedState=s},useHostTransitionStatus:kp,useFormState:u_,useActionState:u_,useOptimistic:function(a){var s=bn();s.memoizedState=s.baseState=a;var l={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return s.queue=l,s=bp.bind(null,pt,!0,l),l.dispatch=s,[a,s]},useMemoCache:yp,useCacheRefresh:function(){return bn().memoizedState=hC.bind(null,pt)}},N_={readContext:nn,use:ph,useCallback:E_,useContext:nn,useEffect:g_,useImperativeHandle:y_,useInsertionEffect:v_,useLayoutEffect:__,useMemo:T_,useReducer:mh,useRef:p_,useState:function(){return mh(Ei)},useDebugValue:Sp,useDeferredValue:function(a,s){var l=Ar();return A_(l,Kt.memoizedState,a,s)},useTransition:function(){var a=mh(Ei)[0],s=Ar().memoizedState;return[typeof a=="boolean"?a:Qc(a),s]},useSyncExternalStore:Zv,useId:R_,useHostTransitionStatus:kp,useFormState:f_,useActionState:f_,useOptimistic:function(a,s){var l=Ar();return a_(l,Kt,a,s)},useMemoCache:yp,useCacheRefresh:k_},pC={readContext:nn,use:ph,useCallback:E_,useContext:nn,useEffect:g_,useImperativeHandle:y_,useInsertionEffect:v_,useLayoutEffect:__,useMemo:T_,useReducer:Tp,useRef:p_,useState:function(){return Tp(Ei)},useDebugValue:Sp,useDeferredValue:function(a,s){var l=Ar();return Kt===null?Cp(l,a,s):A_(l,Kt.memoizedState,a,s)},useTransition:function(){var a=Tp(Ei)[0],s=Ar().memoizedState;return[typeof a=="boolean"?a:Qc(a),s]},useSyncExternalStore:Zv,useId:R_,useHostTransitionStatus:kp,useFormState:d_,useActionState:d_,useOptimistic:function(a,s){var l=Ar();return Kt!==null?a_(l,Kt,a,s):(l.baseState=a,[a,l.queue.dispatch])},useMemoCache:yp,useCacheRefresh:k_},bl=null,eu=0;function yh(a){var s=eu;return eu+=1,bl===null&&(bl=[]),Gv(bl,a,s)}function tu(a,s){s=s.props.ref,a.ref=s!==void 0?s:null}function Eh(a,s){throw s.$$typeof===_?Error(n(525)):(a=Object.prototype.toString.call(s),Error(n(31,a==="[object Object]"?"object with keys {"+Object.keys(s).join(", ")+"}":a)))}function F_(a){var s=a._init;return s(a._payload)}function P_(a){function s(le,ie){if(a){var he=le.deletions;he===null?(le.deletions=[ie],le.flags|=16):he.push(ie)}}function l(le,ie){if(!a)return null;for(;ie!==null;)s(le,ie),ie=ie.sibling;return null}function f(le){for(var ie=new Map;le!==null;)le.key!==null?ie.set(le.key,le):ie.set(le.index,le),le=le.sibling;return ie}function m(le,ie){return le=gi(le,ie),le.index=0,le.sibling=null,le}function v(le,ie,he){return le.index=he,a?(he=le.alternate,he!==null?(he=he.index,he<ie?(le.flags|=67108866,ie):he):(le.flags|=67108866,ie)):(le.flags|=1048576,ie)}function I(le){return a&&le.alternate===null&&(le.flags|=67108866),le}function L(le,ie,he,Se){return ie===null||ie.tag!==6?(ie=$d(he,le.mode,Se),ie.return=le,ie):(ie=m(ie,he),ie.return=le,ie)}function ee(le,ie,he,Se){var Ke=he.type;return Ke===S?Ae(le,ie,he.props.children,Se,he.key):ie!==null&&(ie.elementType===Ke||typeof Ke=="object"&&Ke!==null&&Ke.$$typeof===T&&F_(Ke)===ie.type)?(ie=m(ie,he.props),tu(ie,he),ie.return=le,ie):(ie=nh(he.type,he.key,he.props,null,le.mode,Se),tu(ie,he),ie.return=le,ie)}function pe(le,ie,he,Se){return ie===null||ie.tag!==4||ie.stateNode.containerInfo!==he.containerInfo||ie.stateNode.implementation!==he.implementation?(ie=Qd(he,le.mode,Se),ie.return=le,ie):(ie=m(ie,he.children||[]),ie.return=le,ie)}function Ae(le,ie,he,Se,Ke){return ie===null||ie.tag!==7?(ie=mo(he,le.mode,Se,Ke),ie.return=le,ie):(ie=m(ie,he),ie.return=le,ie)}function ke(le,ie,he){if(typeof ie=="string"&&ie!==""||typeof ie=="number"||typeof ie=="bigint")return ie=$d(""+ie,le.mode,he),ie.return=le,ie;if(typeof ie=="object"&&ie!==null){switch(ie.$$typeof){case x:return he=nh(ie.type,ie.key,ie.props,null,le.mode,he),tu(he,ie),he.return=le,he;case A:return ie=Qd(ie,le.mode,he),ie.return=le,ie;case T:var Se=ie._init;return ie=Se(ie._payload),ke(le,ie,he)}if(Ce(ie)||O(ie))return ie=mo(ie,le.mode,he,null),ie.return=le,ie;if(typeof ie.then=="function")return ke(le,yh(ie),he);if(ie.$$typeof===N)return ke(le,oh(le,ie),he);Eh(le,ie)}return null}function ve(le,ie,he,Se){var Ke=ie!==null?ie.key:null;if(typeof he=="string"&&he!==""||typeof he=="number"||typeof he=="bigint")return Ke!==null?null:L(le,ie,""+he,Se);if(typeof he=="object"&&he!==null){switch(he.$$typeof){case x:return he.key===Ke?ee(le,ie,he,Se):null;case A:return he.key===Ke?pe(le,ie,he,Se):null;case T:return Ke=he._init,he=Ke(he._payload),ve(le,ie,he,Se)}if(Ce(he)||O(he))return Ke!==null?null:Ae(le,ie,he,Se,null);if(typeof he.then=="function")return ve(le,ie,yh(he),Se);if(he.$$typeof===N)return ve(le,ie,oh(le,he),Se);Eh(le,he)}return null}function _e(le,ie,he,Se,Ke){if(typeof Se=="string"&&Se!==""||typeof Se=="number"||typeof Se=="bigint")return le=le.get(he)||null,L(ie,le,""+Se,Ke);if(typeof Se=="object"&&Se!==null){switch(Se.$$typeof){case x:return le=le.get(Se.key===null?he:Se.key)||null,ee(ie,le,Se,Ke);case A:return le=le.get(Se.key===null?he:Se.key)||null,pe(ie,le,Se,Ke);case T:var gt=Se._init;return Se=gt(Se._payload),_e(le,ie,he,Se,Ke)}if(Ce(Se)||O(Se))return le=le.get(he)||null,Ae(ie,le,Se,Ke,null);if(typeof Se.then=="function")return _e(le,ie,he,yh(Se),Ke);if(Se.$$typeof===N)return _e(le,ie,he,oh(ie,Se),Ke);Eh(ie,Se)}return null}function it(le,ie,he,Se){for(var Ke=null,gt=null,Xe=ie,et=ie=0,zr=null;Xe!==null&&et<he.length;et++){Xe.index>et?(zr=Xe,Xe=null):zr=Xe.sibling;var Mt=ve(le,Xe,he[et],Se);if(Mt===null){Xe===null&&(Xe=zr);break}a&&Xe&&Mt.alternate===null&&s(le,Xe),ie=v(Mt,ie,et),gt===null?Ke=Mt:gt.sibling=Mt,gt=Mt,Xe=zr}if(et===he.length)return l(le,Xe),Ut&&vo(le,et),Ke;if(Xe===null){for(;et<he.length;et++)Xe=ke(le,he[et],Se),Xe!==null&&(ie=v(Xe,ie,et),gt===null?Ke=Xe:gt.sibling=Xe,gt=Xe);return Ut&&vo(le,et),Ke}for(Xe=f(Xe);et<he.length;et++)zr=_e(Xe,le,et,he[et],Se),zr!==null&&(a&&zr.alternate!==null&&Xe.delete(zr.key===null?et:zr.key),ie=v(zr,ie,et),gt===null?Ke=zr:gt.sibling=zr,gt=zr);return a&&Xe.forEach(function(vs){return s(le,vs)}),Ut&&vo(le,et),Ke}function Qe(le,ie,he,Se){if(he==null)throw Error(n(151));for(var Ke=null,gt=null,Xe=ie,et=ie=0,zr=null,Mt=he.next();Xe!==null&&!Mt.done;et++,Mt=he.next()){Xe.index>et?(zr=Xe,Xe=null):zr=Xe.sibling;var vs=ve(le,Xe,Mt.value,Se);if(vs===null){Xe===null&&(Xe=zr);break}a&&Xe&&vs.alternate===null&&s(le,Xe),ie=v(vs,ie,et),gt===null?Ke=vs:gt.sibling=vs,gt=vs,Xe=zr}if(Mt.done)return l(le,Xe),Ut&&vo(le,et),Ke;if(Xe===null){for(;!Mt.done;et++,Mt=he.next())Mt=ke(le,Mt.value,Se),Mt!==null&&(ie=v(Mt,ie,et),gt===null?Ke=Mt:gt.sibling=Mt,gt=Mt);return Ut&&vo(le,et),Ke}for(Xe=f(Xe);!Mt.done;et++,Mt=he.next())Mt=_e(Xe,le,et,Mt.value,Se),Mt!==null&&(a&&Mt.alternate!==null&&Xe.delete(Mt.key===null?et:Mt.key),ie=v(Mt,ie,et),gt===null?Ke=Mt:gt.sibling=Mt,gt=Mt);return a&&Xe.forEach(function(mR){return s(le,mR)}),Ut&&vo(le,et),Ke}function Xt(le,ie,he,Se){if(typeof he=="object"&&he!==null&&he.type===S&&he.key===null&&(he=he.props.children),typeof he=="object"&&he!==null){switch(he.$$typeof){case x:e:{for(var Ke=he.key;ie!==null;){if(ie.key===Ke){if(Ke=he.type,Ke===S){if(ie.tag===7){l(le,ie.sibling),Se=m(ie,he.props.children),Se.return=le,le=Se;break e}}else if(ie.elementType===Ke||typeof Ke=="object"&&Ke!==null&&Ke.$$typeof===T&&F_(Ke)===ie.type){l(le,ie.sibling),Se=m(ie,he.props),tu(Se,he),Se.return=le,le=Se;break e}l(le,ie);break}else s(le,ie);ie=ie.sibling}he.type===S?(Se=mo(he.props.children,le.mode,Se,he.key),Se.return=le,le=Se):(Se=nh(he.type,he.key,he.props,null,le.mode,Se),tu(Se,he),Se.return=le,le=Se)}return I(le);case A:e:{for(Ke=he.key;ie!==null;){if(ie.key===Ke)if(ie.tag===4&&ie.stateNode.containerInfo===he.containerInfo&&ie.stateNode.implementation===he.implementation){l(le,ie.sibling),Se=m(ie,he.children||[]),Se.return=le,le=Se;break e}else{l(le,ie);break}else s(le,ie);ie=ie.sibling}Se=Qd(he,le.mode,Se),Se.return=le,le=Se}return I(le);case T:return Ke=he._init,he=Ke(he._payload),Xt(le,ie,he,Se)}if(Ce(he))return it(le,ie,he,Se);if(O(he)){if(Ke=O(he),typeof Ke!="function")throw Error(n(150));return he=Ke.call(he),Qe(le,ie,he,Se)}if(typeof he.then=="function")return Xt(le,ie,yh(he),Se);if(he.$$typeof===N)return Xt(le,ie,oh(le,he),Se);Eh(le,he)}return typeof he=="string"&&he!==""||typeof he=="number"||typeof he=="bigint"?(he=""+he,ie!==null&&ie.tag===6?(l(le,ie.sibling),Se=m(ie,he),Se.return=le,le=Se):(l(le,ie),Se=$d(he,le.mode,Se),Se.return=le,le=Se),I(le)):l(le,ie)}return function(le,ie,he,Se){try{eu=0;var Ke=Xt(le,ie,he,Se);return bl=null,Ke}catch(Xe){if(Xe===qc||Xe===ch)throw Xe;var gt=Un(29,Xe,null,le.mode);return gt.lanes=Se,gt.return=le,gt}finally{}}}var Il=P_(!0),M_=P_(!1),sa=se(null),Wa=null;function rs(a){var s=a.alternate;z(Nr,Nr.current&1),z(sa,a),Wa===null&&(s===null||Sl.current!==null||s.memoizedState!==null)&&(Wa=a)}function L_(a){if(a.tag===22){if(z(Nr,Nr.current),z(sa,a),Wa===null){var s=a.alternate;s!==null&&s.memoizedState!==null&&(Wa=a)}}else ns()}function ns(){z(Nr,Nr.current),z(sa,sa.current)}function Ti(a){M(sa),Wa===a&&(Wa=null),M(Nr)}var Nr=se(0);function Th(a){for(var s=a;s!==null;){if(s.tag===13){var l=s.memoizedState;if(l!==null&&(l=l.dehydrated,l===null||l.data==="$?"||xm(l)))return s}else if(s.tag===19&&s.memoizedProps.revealOrder!==void 0){if((s.flags&128)!==0)return s}else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===a)break;for(;s.sibling===null;){if(s.return===null||s.return===a)return null;s=s.return}s.sibling.return=s.return,s=s.sibling}return null}function Ip(a,s,l,f){s=a.memoizedState,l=l(f,s),l=l==null?s:g({},s,l),a.memoizedState=l,a.lanes===0&&(a.updateQueue.baseState=l)}var Dp={enqueueSetState:function(a,s,l){a=a._reactInternals;var f=Hn(),m=Ji(f);m.payload=s,l!=null&&(m.callback=l),s=es(a,m,f),s!==null&&(Gn(s,a,f),Wc(s,a,f))},enqueueReplaceState:function(a,s,l){a=a._reactInternals;var f=Hn(),m=Ji(f);m.tag=1,m.payload=s,l!=null&&(m.callback=l),s=es(a,m,f),s!==null&&(Gn(s,a,f),Wc(s,a,f))},enqueueForceUpdate:function(a,s){a=a._reactInternals;var l=Hn(),f=Ji(l);f.tag=2,s!=null&&(f.callback=s),s=es(a,f,l),s!==null&&(Gn(s,a,l),Wc(s,a,l))}};function V_(a,s,l,f,m,v,I){return a=a.stateNode,typeof a.shouldComponentUpdate=="function"?a.shouldComponentUpdate(f,v,I):s.prototype&&s.prototype.isPureReactComponent?!Lc(l,f)||!Lc(m,v):!0}function U_(a,s,l,f){a=s.state,typeof s.componentWillReceiveProps=="function"&&s.componentWillReceiveProps(l,f),typeof s.UNSAFE_componentWillReceiveProps=="function"&&s.UNSAFE_componentWillReceiveProps(l,f),s.state!==a&&Dp.enqueueReplaceState(s,s.state,null)}function wo(a,s){var l=s;if("ref"in s){l={};for(var f in s)f!=="ref"&&(l[f]=s[f])}if(a=a.defaultProps){l===s&&(l=g({},l));for(var m in a)l[m]===void 0&&(l[m]=a[m])}return l}var Ah=typeof reportError=="function"?reportError:function(a){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var s=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof a=="object"&&a!==null&&typeof a.message=="string"?String(a.message):String(a),error:a});if(!window.dispatchEvent(s))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",a);return}console.error(a)};function B_(a){Ah(a)}function j_(a){console.error(a)}function z_(a){Ah(a)}function wh(a,s){try{var l=a.onUncaughtError;l(s.value,{componentStack:s.stack})}catch(f){setTimeout(function(){throw f})}}function H_(a,s,l){try{var f=a.onCaughtError;f(l.value,{componentStack:l.stack,errorBoundary:s.tag===1?s.stateNode:null})}catch(m){setTimeout(function(){throw m})}}function Op(a,s,l){return l=Ji(l),l.tag=3,l.payload={element:null},l.callback=function(){wh(a,s)},l}function G_(a){return a=Ji(a),a.tag=3,a}function q_(a,s,l,f){var m=l.type.getDerivedStateFromError;if(typeof m=="function"){var v=f.value;a.payload=function(){return m(v)},a.callback=function(){H_(s,l,f)}}var I=l.stateNode;I!==null&&typeof I.componentDidCatch=="function"&&(a.callback=function(){H_(s,l,f),typeof m!="function"&&(cs===null?cs=new Set([this]):cs.add(this));var L=f.stack;this.componentDidCatch(f.value,{componentStack:L!==null?L:""})})}function mC(a,s,l,f,m){if(l.flags|=32768,f!==null&&typeof f=="object"&&typeof f.then=="function"){if(s=l.alternate,s!==null&&zc(s,l,m,!0),l=sa.current,l!==null){switch(l.tag){case 13:return Wa===null?rm():l.alternate===null&&cr===0&&(cr=3),l.flags&=-257,l.flags|=65536,l.lanes=m,f===op?l.flags|=16384:(s=l.updateQueue,s===null?l.updateQueue=new Set([f]):s.add(f),am(a,f,m)),!1;case 22:return l.flags|=65536,f===op?l.flags|=16384:(s=l.updateQueue,s===null?(s={transitions:null,markerInstances:null,retryQueue:new Set([f])},l.updateQueue=s):(l=s.retryQueue,l===null?s.retryQueue=new Set([f]):l.add(f)),am(a,f,m)),!1}throw Error(n(435,l.tag))}return am(a,f,m),rm(),!1}if(Ut)return s=sa.current,s!==null?((s.flags&65536)===0&&(s.flags|=256),s.flags|=65536,s.lanes=m,f!==ep&&(a=Error(n(422),{cause:f}),jc(ra(a,l)))):(f!==ep&&(s=Error(n(423),{cause:f}),jc(ra(s,l))),a=a.current.alternate,a.flags|=65536,m&=-m,a.lanes|=m,f=ra(f,l),m=Op(a.stateNode,f,m),up(a,m),cr!==4&&(cr=2)),!1;var v=Error(n(520),{cause:f});if(v=ra(v,l),lu===null?lu=[v]:lu.push(v),cr!==4&&(cr=2),s===null)return!0;f=ra(f,l),l=s;do{switch(l.tag){case 3:return l.flags|=65536,a=m&-m,l.lanes|=a,a=Op(l.stateNode,f,a),up(l,a),!1;case 1:if(s=l.type,v=l.stateNode,(l.flags&128)===0&&(typeof s.getDerivedStateFromError=="function"||v!==null&&typeof v.componentDidCatch=="function"&&(cs===null||!cs.has(v))))return l.flags|=65536,m&=-m,l.lanes|=m,m=G_(m),q_(m,a,l,f),up(l,m),!1}l=l.return}while(l!==null);return!1}var K_=Error(n(461)),Br=!1;function Xr(a,s,l,f){s.child=a===null?M_(s,null,l,f):Il(s,a.child,l,f)}function W_(a,s,l,f,m){l=l.render;var v=s.ref;if("ref"in f){var I={};for(var L in f)L!=="ref"&&(I[L]=f[L])}else I=f;return Eo(s),f=mp(a,s,l,I,v,m),L=gp(),a!==null&&!Br?(vp(a,s,m),Ai(a,s,m)):(Ut&&L&&Zd(s),s.flags|=1,Xr(a,s,f,m),s.child)}function X_(a,s,l,f,m){if(a===null){var v=l.type;return typeof v=="function"&&!Yd(v)&&v.defaultProps===void 0&&l.compare===null?(s.tag=15,s.type=v,Y_(a,s,v,f,m)):(a=nh(l.type,null,f,s,s.mode,m),a.ref=s.ref,a.return=s,s.child=a)}if(v=a.child,!Bp(a,m)){var I=v.memoizedProps;if(l=l.compare,l=l!==null?l:Lc,l(I,f)&&a.ref===s.ref)return Ai(a,s,m)}return s.flags|=1,a=gi(v,f),a.ref=s.ref,a.return=s,s.child=a}function Y_(a,s,l,f,m){if(a!==null){var v=a.memoizedProps;if(Lc(v,f)&&a.ref===s.ref)if(Br=!1,s.pendingProps=f=v,Bp(a,m))(a.flags&131072)!==0&&(Br=!0);else return s.lanes=a.lanes,Ai(a,s,m)}return Np(a,s,l,f,m)}function $_(a,s,l){var f=s.pendingProps,m=f.children,v=a!==null?a.memoizedState:null;if(f.mode==="hidden"){if((s.flags&128)!==0){if(f=v!==null?v.baseLanes|l:l,a!==null){for(m=s.child=a.child,v=0;m!==null;)v=v|m.lanes|m.childLanes,m=m.sibling;s.childLanes=v&~f}else s.childLanes=0,s.child=null;return Q_(a,s,f,l)}if((l&536870912)!==0)s.memoizedState={baseLanes:0,cachePool:null},a!==null&&lh(s,v!==null?v.cachePool:null),v!==null?Yv(s,v):hp(),L_(s);else return s.lanes=s.childLanes=536870912,Q_(a,s,v!==null?v.baseLanes|l:l,l)}else v!==null?(lh(s,v.cachePool),Yv(s,v),ns(),s.memoizedState=null):(a!==null&&lh(s,null),hp(),ns());return Xr(a,s,m,l),s.child}function Q_(a,s,l,f){var m=sp();return m=m===null?null:{parent:Or._currentValue,pool:m},s.memoizedState={baseLanes:l,cachePool:m},a!==null&&lh(s,null),hp(),L_(s),a!==null&&zc(a,s,f,!0),null}function Sh(a,s){var l=s.ref;if(l===null)a!==null&&a.ref!==null&&(s.flags|=4194816);else{if(typeof l!="function"&&typeof l!="object")throw Error(n(284));(a===null||a.ref!==l)&&(s.flags|=4194816)}}function Np(a,s,l,f,m){return Eo(s),l=mp(a,s,l,f,void 0,m),f=gp(),a!==null&&!Br?(vp(a,s,m),Ai(a,s,m)):(Ut&&f&&Zd(s),s.flags|=1,Xr(a,s,l,m),s.child)}function Z_(a,s,l,f,m,v){return Eo(s),s.updateQueue=null,l=Qv(s,f,l,m),$v(a),f=gp(),a!==null&&!Br?(vp(a,s,v),Ai(a,s,v)):(Ut&&f&&Zd(s),s.flags|=1,Xr(a,s,l,v),s.child)}function J_(a,s,l,f,m){if(Eo(s),s.stateNode===null){var v=yl,I=l.contextType;typeof I=="object"&&I!==null&&(v=nn(I)),v=new l(f,v),s.memoizedState=v.state!==null&&v.state!==void 0?v.state:null,v.updater=Dp,s.stateNode=v,v._reactInternals=s,v=s.stateNode,v.props=f,v.state=s.memoizedState,v.refs={},lp(s),I=l.contextType,v.context=typeof I=="object"&&I!==null?nn(I):yl,v.state=s.memoizedState,I=l.getDerivedStateFromProps,typeof I=="function"&&(Ip(s,l,I,f),v.state=s.memoizedState),typeof l.getDerivedStateFromProps=="function"||typeof v.getSnapshotBeforeUpdate=="function"||typeof v.UNSAFE_componentWillMount!="function"&&typeof v.componentWillMount!="function"||(I=v.state,typeof v.componentWillMount=="function"&&v.componentWillMount(),typeof v.UNSAFE_componentWillMount=="function"&&v.UNSAFE_componentWillMount(),I!==v.state&&Dp.enqueueReplaceState(v,v.state,null),Yc(s,f,v,m),Xc(),v.state=s.memoizedState),typeof v.componentDidMount=="function"&&(s.flags|=4194308),f=!0}else if(a===null){v=s.stateNode;var L=s.memoizedProps,ee=wo(l,L);v.props=ee;var pe=v.context,Ae=l.contextType;I=yl,typeof Ae=="object"&&Ae!==null&&(I=nn(Ae));var ke=l.getDerivedStateFromProps;Ae=typeof ke=="function"||typeof v.getSnapshotBeforeUpdate=="function",L=s.pendingProps!==L,Ae||typeof v.UNSAFE_componentWillReceiveProps!="function"&&typeof v.componentWillReceiveProps!="function"||(L||pe!==I)&&U_(s,v,f,I),Zi=!1;var ve=s.memoizedState;v.state=ve,Yc(s,f,v,m),Xc(),pe=s.memoizedState,L||ve!==pe||Zi?(typeof ke=="function"&&(Ip(s,l,ke,f),pe=s.memoizedState),(ee=Zi||V_(s,l,ee,f,ve,pe,I))?(Ae||typeof v.UNSAFE_componentWillMount!="function"&&typeof v.componentWillMount!="function"||(typeof v.componentWillMount=="function"&&v.componentWillMount(),typeof v.UNSAFE_componentWillMount=="function"&&v.UNSAFE_componentWillMount()),typeof v.componentDidMount=="function"&&(s.flags|=4194308)):(typeof v.componentDidMount=="function"&&(s.flags|=4194308),s.memoizedProps=f,s.memoizedState=pe),v.props=f,v.state=pe,v.context=I,f=ee):(typeof v.componentDidMount=="function"&&(s.flags|=4194308),f=!1)}else{v=s.stateNode,cp(a,s),I=s.memoizedProps,Ae=wo(l,I),v.props=Ae,ke=s.pendingProps,ve=v.context,pe=l.contextType,ee=yl,typeof pe=="object"&&pe!==null&&(ee=nn(pe)),L=l.getDerivedStateFromProps,(pe=typeof L=="function"||typeof v.getSnapshotBeforeUpdate=="function")||typeof v.UNSAFE_componentWillReceiveProps!="function"&&typeof v.componentWillReceiveProps!="function"||(I!==ke||ve!==ee)&&U_(s,v,f,ee),Zi=!1,ve=s.memoizedState,v.state=ve,Yc(s,f,v,m),Xc();var _e=s.memoizedState;I!==ke||ve!==_e||Zi||a!==null&&a.dependencies!==null&&sh(a.dependencies)?(typeof L=="function"&&(Ip(s,l,L,f),_e=s.memoizedState),(Ae=Zi||V_(s,l,Ae,f,ve,_e,ee)||a!==null&&a.dependencies!==null&&sh(a.dependencies))?(pe||typeof v.UNSAFE_componentWillUpdate!="function"&&typeof v.componentWillUpdate!="function"||(typeof v.componentWillUpdate=="function"&&v.componentWillUpdate(f,_e,ee),typeof v.UNSAFE_componentWillUpdate=="function"&&v.UNSAFE_componentWillUpdate(f,_e,ee)),typeof v.componentDidUpdate=="function"&&(s.flags|=4),typeof v.getSnapshotBeforeUpdate=="function"&&(s.flags|=1024)):(typeof v.componentDidUpdate!="function"||I===a.memoizedProps&&ve===a.memoizedState||(s.flags|=4),typeof v.getSnapshotBeforeUpdate!="function"||I===a.memoizedProps&&ve===a.memoizedState||(s.flags|=1024),s.memoizedProps=f,s.memoizedState=_e),v.props=f,v.state=_e,v.context=ee,f=Ae):(typeof v.componentDidUpdate!="function"||I===a.memoizedProps&&ve===a.memoizedState||(s.flags|=4),typeof v.getSnapshotBeforeUpdate!="function"||I===a.memoizedProps&&ve===a.memoizedState||(s.flags|=1024),f=!1)}return v=f,Sh(a,s),f=(s.flags&128)!==0,v||f?(v=s.stateNode,l=f&&typeof l.getDerivedStateFromError!="function"?null:v.render(),s.flags|=1,a!==null&&f?(s.child=Il(s,a.child,null,m),s.child=Il(s,null,l,m)):Xr(a,s,l,m),s.memoizedState=v.state,a=s.child):a=Ai(a,s,m),a}function ex(a,s,l,f){return Bc(),s.flags|=256,Xr(a,s,l,f),s.child}var Fp={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Pp(a){return{baseLanes:a,cachePool:jv()}}function Mp(a,s,l){return a=a!==null?a.childLanes&~l:0,s&&(a|=oa),a}function tx(a,s,l){var f=s.pendingProps,m=!1,v=(s.flags&128)!==0,I;if((I=v)||(I=a!==null&&a.memoizedState===null?!1:(Nr.current&2)!==0),I&&(m=!0,s.flags&=-129),I=(s.flags&32)!==0,s.flags&=-33,a===null){if(Ut){if(m?rs(s):ns(),Ut){var L=lr,ee;if(ee=L){e:{for(ee=L,L=Ka;ee.nodeType!==8;){if(!L){L=null;break e}if(ee=Aa(ee.nextSibling),ee===null){L=null;break e}}L=ee}L!==null?(s.memoizedState={dehydrated:L,treeContext:go!==null?{id:vi,overflow:_i}:null,retryLane:536870912,hydrationErrors:null},ee=Un(18,null,null,0),ee.stateNode=L,ee.return=s,s.child=ee,En=s,lr=null,ee=!0):ee=!1}ee||xo(s)}if(L=s.memoizedState,L!==null&&(L=L.dehydrated,L!==null))return xm(L)?s.lanes=32:s.lanes=536870912,null;Ti(s)}return L=f.children,f=f.fallback,m?(ns(),m=s.mode,L=Ch({mode:"hidden",children:L},m),f=mo(f,m,l,null),L.return=s,f.return=s,L.sibling=f,s.child=L,m=s.child,m.memoizedState=Pp(l),m.childLanes=Mp(a,I,l),s.memoizedState=Fp,f):(rs(s),Lp(s,L))}if(ee=a.memoizedState,ee!==null&&(L=ee.dehydrated,L!==null)){if(v)s.flags&256?(rs(s),s.flags&=-257,s=Vp(a,s,l)):s.memoizedState!==null?(ns(),s.child=a.child,s.flags|=128,s=null):(ns(),m=f.fallback,L=s.mode,f=Ch({mode:"visible",children:f.children},L),m=mo(m,L,l,null),m.flags|=2,f.return=s,m.return=s,f.sibling=m,s.child=f,Il(s,a.child,null,l),f=s.child,f.memoizedState=Pp(l),f.childLanes=Mp(a,I,l),s.memoizedState=Fp,s=m);else if(rs(s),xm(L)){if(I=L.nextSibling&&L.nextSibling.dataset,I)var pe=I.dgst;I=pe,f=Error(n(419)),f.stack="",f.digest=I,jc({value:f,source:null,stack:null}),s=Vp(a,s,l)}else if(Br||zc(a,s,l,!1),I=(l&a.childLanes)!==0,Br||I){if(I=Qt,I!==null&&(f=l&-l,f=(f&42)!==0?1:Pa(f),f=(f&(I.suspendedLanes|l))!==0?0:f,f!==0&&f!==ee.retryLane))throw ee.retryLane=f,xl(a,f),Gn(I,a,f),K_;L.data==="$?"||rm(),s=Vp(a,s,l)}else L.data==="$?"?(s.flags|=192,s.child=a.child,s=null):(a=ee.treeContext,lr=Aa(L.nextSibling),En=s,Ut=!0,_o=null,Ka=!1,a!==null&&(aa[ia++]=vi,aa[ia++]=_i,aa[ia++]=go,vi=a.id,_i=a.overflow,go=s),s=Lp(s,f.children),s.flags|=4096);return s}return m?(ns(),m=f.fallback,L=s.mode,ee=a.child,pe=ee.sibling,f=gi(ee,{mode:"hidden",children:f.children}),f.subtreeFlags=ee.subtreeFlags&65011712,pe!==null?m=gi(pe,m):(m=mo(m,L,l,null),m.flags|=2),m.return=s,f.return=s,f.sibling=m,s.child=f,f=m,m=s.child,L=a.child.memoizedState,L===null?L=Pp(l):(ee=L.cachePool,ee!==null?(pe=Or._currentValue,ee=ee.parent!==pe?{parent:pe,pool:pe}:ee):ee=jv(),L={baseLanes:L.baseLanes|l,cachePool:ee}),m.memoizedState=L,m.childLanes=Mp(a,I,l),s.memoizedState=Fp,f):(rs(s),l=a.child,a=l.sibling,l=gi(l,{mode:"visible",children:f.children}),l.return=s,l.sibling=null,a!==null&&(I=s.deletions,I===null?(s.deletions=[a],s.flags|=16):I.push(a)),s.child=l,s.memoizedState=null,l)}function Lp(a,s){return s=Ch({mode:"visible",children:s},a.mode),s.return=a,a.child=s}function Ch(a,s){return a=Un(22,a,null,s),a.lanes=0,a.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},a}function Vp(a,s,l){return Il(s,a.child,null,l),a=Lp(s,s.pendingProps.children),a.flags|=2,s.memoizedState=null,a}function rx(a,s,l){a.lanes|=s;var f=a.alternate;f!==null&&(f.lanes|=s),rp(a.return,s,l)}function Up(a,s,l,f,m){var v=a.memoizedState;v===null?a.memoizedState={isBackwards:s,rendering:null,renderingStartTime:0,last:f,tail:l,tailMode:m}:(v.isBackwards=s,v.rendering=null,v.renderingStartTime=0,v.last=f,v.tail=l,v.tailMode=m)}function nx(a,s,l){var f=s.pendingProps,m=f.revealOrder,v=f.tail;if(Xr(a,s,f.children,l),f=Nr.current,(f&2)!==0)f=f&1|2,s.flags|=128;else{if(a!==null&&(a.flags&128)!==0)e:for(a=s.child;a!==null;){if(a.tag===13)a.memoizedState!==null&&rx(a,l,s);else if(a.tag===19)rx(a,l,s);else if(a.child!==null){a.child.return=a,a=a.child;continue}if(a===s)break e;for(;a.sibling===null;){if(a.return===null||a.return===s)break e;a=a.return}a.sibling.return=a.return,a=a.sibling}f&=1}switch(z(Nr,f),m){case"forwards":for(l=s.child,m=null;l!==null;)a=l.alternate,a!==null&&Th(a)===null&&(m=l),l=l.sibling;l=m,l===null?(m=s.child,s.child=null):(m=l.sibling,l.sibling=null),Up(s,!1,m,l,v);break;case"backwards":for(l=null,m=s.child,s.child=null;m!==null;){if(a=m.alternate,a!==null&&Th(a)===null){s.child=m;break}a=m.sibling,m.sibling=l,l=m,m=a}Up(s,!0,l,null,v);break;case"together":Up(s,!1,null,null,void 0);break;default:s.memoizedState=null}return s.child}function Ai(a,s,l){if(a!==null&&(s.dependencies=a.dependencies),ls|=s.lanes,(l&s.childLanes)===0)if(a!==null){if(zc(a,s,l,!1),(l&s.childLanes)===0)return null}else return null;if(a!==null&&s.child!==a.child)throw Error(n(153));if(s.child!==null){for(a=s.child,l=gi(a,a.pendingProps),s.child=l,l.return=s;a.sibling!==null;)a=a.sibling,l=l.sibling=gi(a,a.pendingProps),l.return=s;l.sibling=null}return s.child}function Bp(a,s){return(a.lanes&s)!==0?!0:(a=a.dependencies,!!(a!==null&&sh(a)))}function gC(a,s,l){switch(s.tag){case 3:Ee(s,s.stateNode.containerInfo),Qi(s,Or,a.memoizedState.cache),Bc();break;case 27:case 5:Te(s);break;case 4:Ee(s,s.stateNode.containerInfo);break;case 10:Qi(s,s.type,s.memoizedProps.value);break;case 13:var f=s.memoizedState;if(f!==null)return f.dehydrated!==null?(rs(s),s.flags|=128,null):(l&s.child.childLanes)!==0?tx(a,s,l):(rs(s),a=Ai(a,s,l),a!==null?a.sibling:null);rs(s);break;case 19:var m=(a.flags&128)!==0;if(f=(l&s.childLanes)!==0,f||(zc(a,s,l,!1),f=(l&s.childLanes)!==0),m){if(f)return nx(a,s,l);s.flags|=128}if(m=s.memoizedState,m!==null&&(m.rendering=null,m.tail=null,m.lastEffect=null),z(Nr,Nr.current),f)break;return null;case 22:case 23:return s.lanes=0,$_(a,s,l);case 24:Qi(s,Or,a.memoizedState.cache)}return Ai(a,s,l)}function ax(a,s,l){if(a!==null)if(a.memoizedProps!==s.pendingProps)Br=!0;else{if(!Bp(a,l)&&(s.flags&128)===0)return Br=!1,gC(a,s,l);Br=(a.flags&131072)!==0}else Br=!1,Ut&&(s.flags&1048576)!==0&&Fv(s,ih,s.index);switch(s.lanes=0,s.tag){case 16:e:{a=s.pendingProps;var f=s.elementType,m=f._init;if(f=m(f._payload),s.type=f,typeof f=="function")Yd(f)?(a=wo(f,a),s.tag=1,s=J_(null,s,f,a,l)):(s.tag=0,s=Np(null,s,f,a,l));else{if(f!=null){if(m=f.$$typeof,m===J){s.tag=11,s=W_(null,s,f,a,l);break e}else if(m===C){s.tag=14,s=X_(null,s,f,a,l);break e}}throw s=Fe(f)||f,Error(n(306,s,""))}}return s;case 0:return Np(a,s,s.type,s.pendingProps,l);case 1:return f=s.type,m=wo(f,s.pendingProps),J_(a,s,f,m,l);case 3:e:{if(Ee(s,s.stateNode.containerInfo),a===null)throw Error(n(387));f=s.pendingProps;var v=s.memoizedState;m=v.element,cp(a,s),Yc(s,f,null,l);var I=s.memoizedState;if(f=I.cache,Qi(s,Or,f),f!==v.cache&&np(s,[Or],l,!0),Xc(),f=I.element,v.isDehydrated)if(v={element:f,isDehydrated:!1,cache:I.cache},s.updateQueue.baseState=v,s.memoizedState=v,s.flags&256){s=ex(a,s,f,l);break e}else if(f!==m){m=ra(Error(n(424)),s),jc(m),s=ex(a,s,f,l);break e}else{switch(a=s.stateNode.containerInfo,a.nodeType){case 9:a=a.body;break;default:a=a.nodeName==="HTML"?a.ownerDocument.body:a}for(lr=Aa(a.firstChild),En=s,Ut=!0,_o=null,Ka=!0,l=M_(s,null,f,l),s.child=l;l;)l.flags=l.flags&-3|4096,l=l.sibling}else{if(Bc(),f===m){s=Ai(a,s,l);break e}Xr(a,s,f,l)}s=s.child}return s;case 26:return Sh(a,s),a===null?(l=ly(s.type,null,s.pendingProps,null))?s.memoizedState=l:Ut||(l=s.type,a=s.pendingProps,f=Bh(ue.current).createElement(l),f[hr]=s,f[nr]=a,$r(f,l,a),ce(f),s.stateNode=f):s.memoizedState=ly(s.type,a.memoizedProps,s.pendingProps,a.memoizedState),null;case 27:return Te(s),a===null&&Ut&&(f=s.stateNode=iy(s.type,s.pendingProps,ue.current),En=s,Ka=!0,m=lr,hs(s.type)?(ym=m,lr=Aa(f.firstChild)):lr=m),Xr(a,s,s.pendingProps.children,l),Sh(a,s),a===null&&(s.flags|=4194304),s.child;case 5:return a===null&&Ut&&((m=f=lr)&&(f=GC(f,s.type,s.pendingProps,Ka),f!==null?(s.stateNode=f,En=s,lr=Aa(f.firstChild),Ka=!1,m=!0):m=!1),m||xo(s)),Te(s),m=s.type,v=s.pendingProps,I=a!==null?a.memoizedProps:null,f=v.children,gm(m,v)?f=null:I!==null&&gm(m,I)&&(s.flags|=32),s.memoizedState!==null&&(m=mp(a,s,lC,null,null,l),vu._currentValue=m),Sh(a,s),Xr(a,s,f,l),s.child;case 6:return a===null&&Ut&&((a=l=lr)&&(l=qC(l,s.pendingProps,Ka),l!==null?(s.stateNode=l,En=s,lr=null,a=!0):a=!1),a||xo(s)),null;case 13:return tx(a,s,l);case 4:return Ee(s,s.stateNode.containerInfo),f=s.pendingProps,a===null?s.child=Il(s,null,f,l):Xr(a,s,f,l),s.child;case 11:return W_(a,s,s.type,s.pendingProps,l);case 7:return Xr(a,s,s.pendingProps,l),s.child;case 8:return Xr(a,s,s.pendingProps.children,l),s.child;case 12:return Xr(a,s,s.pendingProps.children,l),s.child;case 10:return f=s.pendingProps,Qi(s,s.type,f.value),Xr(a,s,f.children,l),s.child;case 9:return m=s.type._context,f=s.pendingProps.children,Eo(s),m=nn(m),f=f(m),s.flags|=1,Xr(a,s,f,l),s.child;case 14:return X_(a,s,s.type,s.pendingProps,l);case 15:return Y_(a,s,s.type,s.pendingProps,l);case 19:return nx(a,s,l);case 31:return f=s.pendingProps,l=s.mode,f={mode:f.mode,children:f.children},a===null?(l=Ch(f,l),l.ref=s.ref,s.child=l,l.return=s,s=l):(l=gi(a.child,f),l.ref=s.ref,s.child=l,l.return=s,s=l),s;case 22:return $_(a,s,l);case 24:return Eo(s),f=nn(Or),a===null?(m=sp(),m===null&&(m=Qt,v=ap(),m.pooledCache=v,v.refCount++,v!==null&&(m.pooledCacheLanes|=l),m=v),s.memoizedState={parent:f,cache:m},lp(s),Qi(s,Or,m)):((a.lanes&l)!==0&&(cp(a,s),Yc(s,null,null,l),Xc()),m=a.memoizedState,v=s.memoizedState,m.parent!==f?(m={parent:f,cache:f},s.memoizedState=m,s.lanes===0&&(s.memoizedState=s.updateQueue.baseState=m),Qi(s,Or,f)):(f=v.cache,Qi(s,Or,f),f!==m.cache&&np(s,[Or],l,!0))),Xr(a,s,s.pendingProps.children,l),s.child;case 29:throw s.pendingProps}throw Error(n(156,s.tag))}function wi(a){a.flags|=4}function ix(a,s){if(s.type!=="stylesheet"||(s.state.loading&4)!==0)a.flags&=-16777217;else if(a.flags|=16777216,!dy(s)){if(s=sa.current,s!==null&&((bt&4194048)===bt?Wa!==null:(bt&62914560)!==bt&&(bt&536870912)===0||s!==Wa))throw Kc=op,zv;a.flags|=8192}}function Rh(a,s){s!==null&&(a.flags|=4),a.flags&16384&&(s=a.tag!==22?Wi():536870912,a.lanes|=s,Fl|=s)}function ru(a,s){if(!Ut)switch(a.tailMode){case"hidden":s=a.tail;for(var l=null;s!==null;)s.alternate!==null&&(l=s),s=s.sibling;l===null?a.tail=null:l.sibling=null;break;case"collapsed":l=a.tail;for(var f=null;l!==null;)l.alternate!==null&&(f=l),l=l.sibling;f===null?s||a.tail===null?a.tail=null:a.tail.sibling=null:f.sibling=null}}function sr(a){var s=a.alternate!==null&&a.alternate.child===a.child,l=0,f=0;if(s)for(var m=a.child;m!==null;)l|=m.lanes|m.childLanes,f|=m.subtreeFlags&65011712,f|=m.flags&65011712,m.return=a,m=m.sibling;else for(m=a.child;m!==null;)l|=m.lanes|m.childLanes,f|=m.subtreeFlags,f|=m.flags,m.return=a,m=m.sibling;return a.subtreeFlags|=f,a.childLanes=l,s}function vC(a,s,l){var f=s.pendingProps;switch(Jd(s),s.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return sr(s),null;case 1:return sr(s),null;case 3:return l=s.stateNode,f=null,a!==null&&(f=a.memoizedState.cache),s.memoizedState.cache!==f&&(s.flags|=2048),yi(Or),we(),l.pendingContext&&(l.context=l.pendingContext,l.pendingContext=null),(a===null||a.child===null)&&(Uc(s)?wi(s):a===null||a.memoizedState.isDehydrated&&(s.flags&256)===0||(s.flags|=1024,Lv())),sr(s),null;case 26:return l=s.memoizedState,a===null?(wi(s),l!==null?(sr(s),ix(s,l)):(sr(s),s.flags&=-16777217)):l?l!==a.memoizedState?(wi(s),sr(s),ix(s,l)):(sr(s),s.flags&=-16777217):(a.memoizedProps!==f&&wi(s),sr(s),s.flags&=-16777217),null;case 27:Ue(s),l=ue.current;var m=s.type;if(a!==null&&s.stateNode!=null)a.memoizedProps!==f&&wi(s);else{if(!f){if(s.stateNode===null)throw Error(n(166));return sr(s),null}a=Q.current,Uc(s)?Pv(s):(a=iy(m,f,l),s.stateNode=a,wi(s))}return sr(s),null;case 5:if(Ue(s),l=s.type,a!==null&&s.stateNode!=null)a.memoizedProps!==f&&wi(s);else{if(!f){if(s.stateNode===null)throw Error(n(166));return sr(s),null}if(a=Q.current,Uc(s))Pv(s);else{switch(m=Bh(ue.current),a){case 1:a=m.createElementNS("http://www.w3.org/2000/svg",l);break;case 2:a=m.createElementNS("http://www.w3.org/1998/Math/MathML",l);break;default:switch(l){case"svg":a=m.createElementNS("http://www.w3.org/2000/svg",l);break;case"math":a=m.createElementNS("http://www.w3.org/1998/Math/MathML",l);break;case"script":a=m.createElement("div"),a.innerHTML="<script><\/script>",a=a.removeChild(a.firstChild);break;case"select":a=typeof f.is=="string"?m.createElement("select",{is:f.is}):m.createElement("select"),f.multiple?a.multiple=!0:f.size&&(a.size=f.size);break;default:a=typeof f.is=="string"?m.createElement(l,{is:f.is}):m.createElement(l)}}a[hr]=s,a[nr]=f;e:for(m=s.child;m!==null;){if(m.tag===5||m.tag===6)a.appendChild(m.stateNode);else if(m.tag!==4&&m.tag!==27&&m.child!==null){m.child.return=m,m=m.child;continue}if(m===s)break e;for(;m.sibling===null;){if(m.return===null||m.return===s)break e;m=m.return}m.sibling.return=m.return,m=m.sibling}s.stateNode=a;e:switch($r(a,l,f),l){case"button":case"input":case"select":case"textarea":a=!!f.autoFocus;break e;case"img":a=!0;break e;default:a=!1}a&&wi(s)}}return sr(s),s.flags&=-16777217,null;case 6:if(a&&s.stateNode!=null)a.memoizedProps!==f&&wi(s);else{if(typeof f!="string"&&s.stateNode===null)throw Error(n(166));if(a=ue.current,Uc(s)){if(a=s.stateNode,l=s.memoizedProps,f=null,m=En,m!==null)switch(m.tag){case 27:case 5:f=m.memoizedProps}a[hr]=s,a=!!(a.nodeValue===l||f!==null&&f.suppressHydrationWarning===!0||Zx(a.nodeValue,l)),a||xo(s)}else a=Bh(a).createTextNode(f),a[hr]=s,s.stateNode=a}return sr(s),null;case 13:if(f=s.memoizedState,a===null||a.memoizedState!==null&&a.memoizedState.dehydrated!==null){if(m=Uc(s),f!==null&&f.dehydrated!==null){if(a===null){if(!m)throw Error(n(318));if(m=s.memoizedState,m=m!==null?m.dehydrated:null,!m)throw Error(n(317));m[hr]=s}else Bc(),(s.flags&128)===0&&(s.memoizedState=null),s.flags|=4;sr(s),m=!1}else m=Lv(),a!==null&&a.memoizedState!==null&&(a.memoizedState.hydrationErrors=m),m=!0;if(!m)return s.flags&256?(Ti(s),s):(Ti(s),null)}if(Ti(s),(s.flags&128)!==0)return s.lanes=l,s;if(l=f!==null,a=a!==null&&a.memoizedState!==null,l){f=s.child,m=null,f.alternate!==null&&f.alternate.memoizedState!==null&&f.alternate.memoizedState.cachePool!==null&&(m=f.alternate.memoizedState.cachePool.pool);var v=null;f.memoizedState!==null&&f.memoizedState.cachePool!==null&&(v=f.memoizedState.cachePool.pool),v!==m&&(f.flags|=2048)}return l!==a&&l&&(s.child.flags|=8192),Rh(s,s.updateQueue),sr(s),null;case 4:return we(),a===null&&fm(s.stateNode.containerInfo),sr(s),null;case 10:return yi(s.type),sr(s),null;case 19:if(M(Nr),m=s.memoizedState,m===null)return sr(s),null;if(f=(s.flags&128)!==0,v=m.rendering,v===null)if(f)ru(m,!1);else{if(cr!==0||a!==null&&(a.flags&128)!==0)for(a=s.child;a!==null;){if(v=Th(a),v!==null){for(s.flags|=128,ru(m,!1),a=v.updateQueue,s.updateQueue=a,Rh(s,a),s.subtreeFlags=0,a=l,l=s.child;l!==null;)Nv(l,a),l=l.sibling;return z(Nr,Nr.current&1|2),s.child}a=a.sibling}m.tail!==null&&Pe()>Ih&&(s.flags|=128,f=!0,ru(m,!1),s.lanes=4194304)}else{if(!f)if(a=Th(v),a!==null){if(s.flags|=128,f=!0,a=a.updateQueue,s.updateQueue=a,Rh(s,a),ru(m,!0),m.tail===null&&m.tailMode==="hidden"&&!v.alternate&&!Ut)return sr(s),null}else 2*Pe()-m.renderingStartTime>Ih&&l!==536870912&&(s.flags|=128,f=!0,ru(m,!1),s.lanes=4194304);m.isBackwards?(v.sibling=s.child,s.child=v):(a=m.last,a!==null?a.sibling=v:s.child=v,m.last=v)}return m.tail!==null?(s=m.tail,m.rendering=s,m.tail=s.sibling,m.renderingStartTime=Pe(),s.sibling=null,a=Nr.current,z(Nr,f?a&1|2:a&1),s):(sr(s),null);case 22:case 23:return Ti(s),dp(),f=s.memoizedState!==null,a!==null?a.memoizedState!==null!==f&&(s.flags|=8192):f&&(s.flags|=8192),f?(l&536870912)!==0&&(s.flags&128)===0&&(sr(s),s.subtreeFlags&6&&(s.flags|=8192)):sr(s),l=s.updateQueue,l!==null&&Rh(s,l.retryQueue),l=null,a!==null&&a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(l=a.memoizedState.cachePool.pool),f=null,s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(f=s.memoizedState.cachePool.pool),f!==l&&(s.flags|=2048),a!==null&&M(To),null;case 24:return l=null,a!==null&&(l=a.memoizedState.cache),s.memoizedState.cache!==l&&(s.flags|=2048),yi(Or),sr(s),null;case 25:return null;case 30:return null}throw Error(n(156,s.tag))}function _C(a,s){switch(Jd(s),s.tag){case 1:return a=s.flags,a&65536?(s.flags=a&-65537|128,s):null;case 3:return yi(Or),we(),a=s.flags,(a&65536)!==0&&(a&128)===0?(s.flags=a&-65537|128,s):null;case 26:case 27:case 5:return Ue(s),null;case 13:if(Ti(s),a=s.memoizedState,a!==null&&a.dehydrated!==null){if(s.alternate===null)throw Error(n(340));Bc()}return a=s.flags,a&65536?(s.flags=a&-65537|128,s):null;case 19:return M(Nr),null;case 4:return we(),null;case 10:return yi(s.type),null;case 22:case 23:return Ti(s),dp(),a!==null&&M(To),a=s.flags,a&65536?(s.flags=a&-65537|128,s):null;case 24:return yi(Or),null;case 25:return null;default:return null}}function sx(a,s){switch(Jd(s),s.tag){case 3:yi(Or),we();break;case 26:case 27:case 5:Ue(s);break;case 4:we();break;case 13:Ti(s);break;case 19:M(Nr);break;case 10:yi(s.type);break;case 22:case 23:Ti(s),dp(),a!==null&&M(To);break;case 24:yi(Or)}}function nu(a,s){try{var l=s.updateQueue,f=l!==null?l.lastEffect:null;if(f!==null){var m=f.next;l=m;do{if((l.tag&a)===a){f=void 0;var v=l.create,I=l.inst;f=v(),I.destroy=f}l=l.next}while(l!==m)}}catch(L){Yt(s,s.return,L)}}function as(a,s,l){try{var f=s.updateQueue,m=f!==null?f.lastEffect:null;if(m!==null){var v=m.next;f=v;do{if((f.tag&a)===a){var I=f.inst,L=I.destroy;if(L!==void 0){I.destroy=void 0,m=s;var ee=l,pe=L;try{pe()}catch(Ae){Yt(m,ee,Ae)}}}f=f.next}while(f!==v)}}catch(Ae){Yt(s,s.return,Ae)}}function ox(a){var s=a.updateQueue;if(s!==null){var l=a.stateNode;try{Xv(s,l)}catch(f){Yt(a,a.return,f)}}}function lx(a,s,l){l.props=wo(a.type,a.memoizedProps),l.state=a.memoizedState;try{l.componentWillUnmount()}catch(f){Yt(a,s,f)}}function au(a,s){try{var l=a.ref;if(l!==null){switch(a.tag){case 26:case 27:case 5:var f=a.stateNode;break;case 30:f=a.stateNode;break;default:f=a.stateNode}typeof l=="function"?a.refCleanup=l(f):l.current=f}}catch(m){Yt(a,s,m)}}function Xa(a,s){var l=a.ref,f=a.refCleanup;if(l!==null)if(typeof f=="function")try{f()}catch(m){Yt(a,s,m)}finally{a.refCleanup=null,a=a.alternate,a!=null&&(a.refCleanup=null)}else if(typeof l=="function")try{l(null)}catch(m){Yt(a,s,m)}else l.current=null}function cx(a){var s=a.type,l=a.memoizedProps,f=a.stateNode;try{e:switch(s){case"button":case"input":case"select":case"textarea":l.autoFocus&&f.focus();break e;case"img":l.src?f.src=l.src:l.srcSet&&(f.srcset=l.srcSet)}}catch(m){Yt(a,a.return,m)}}function jp(a,s,l){try{var f=a.stateNode;UC(f,a.type,l,s),f[nr]=s}catch(m){Yt(a,a.return,m)}}function ux(a){return a.tag===5||a.tag===3||a.tag===26||a.tag===27&&hs(a.type)||a.tag===4}function zp(a){e:for(;;){for(;a.sibling===null;){if(a.return===null||ux(a.return))return null;a=a.return}for(a.sibling.return=a.return,a=a.sibling;a.tag!==5&&a.tag!==6&&a.tag!==18;){if(a.tag===27&&hs(a.type)||a.flags&2||a.child===null||a.tag===4)continue e;a.child.return=a,a=a.child}if(!(a.flags&2))return a.stateNode}}function Hp(a,s,l){var f=a.tag;if(f===5||f===6)a=a.stateNode,s?(l.nodeType===9?l.body:l.nodeName==="HTML"?l.ownerDocument.body:l).insertBefore(a,s):(s=l.nodeType===9?l.body:l.nodeName==="HTML"?l.ownerDocument.body:l,s.appendChild(a),l=l._reactRootContainer,l!=null||s.onclick!==null||(s.onclick=Uh));else if(f!==4&&(f===27&&hs(a.type)&&(l=a.stateNode,s=null),a=a.child,a!==null))for(Hp(a,s,l),a=a.sibling;a!==null;)Hp(a,s,l),a=a.sibling}function kh(a,s,l){var f=a.tag;if(f===5||f===6)a=a.stateNode,s?l.insertBefore(a,s):l.appendChild(a);else if(f!==4&&(f===27&&hs(a.type)&&(l=a.stateNode),a=a.child,a!==null))for(kh(a,s,l),a=a.sibling;a!==null;)kh(a,s,l),a=a.sibling}function fx(a){var s=a.stateNode,l=a.memoizedProps;try{for(var f=a.type,m=s.attributes;m.length;)s.removeAttributeNode(m[0]);$r(s,f,l),s[hr]=a,s[nr]=l}catch(v){Yt(a,a.return,v)}}var Si=!1,pr=!1,Gp=!1,hx=typeof WeakSet=="function"?WeakSet:Set,jr=null;function xC(a,s){if(a=a.containerInfo,pm=Kh,a=Av(a),zd(a)){if("selectionStart"in a)var l={start:a.selectionStart,end:a.selectionEnd};else e:{l=(l=a.ownerDocument)&&l.defaultView||window;var f=l.getSelection&&l.getSelection();if(f&&f.rangeCount!==0){l=f.anchorNode;var m=f.anchorOffset,v=f.focusNode;f=f.focusOffset;try{l.nodeType,v.nodeType}catch{l=null;break e}var I=0,L=-1,ee=-1,pe=0,Ae=0,ke=a,ve=null;t:for(;;){for(var _e;ke!==l||m!==0&&ke.nodeType!==3||(L=I+m),ke!==v||f!==0&&ke.nodeType!==3||(ee=I+f),ke.nodeType===3&&(I+=ke.nodeValue.length),(_e=ke.firstChild)!==null;)ve=ke,ke=_e;for(;;){if(ke===a)break t;if(ve===l&&++pe===m&&(L=I),ve===v&&++Ae===f&&(ee=I),(_e=ke.nextSibling)!==null)break;ke=ve,ve=ke.parentNode}ke=_e}l=L===-1||ee===-1?null:{start:L,end:ee}}else l=null}l=l||{start:0,end:0}}else l=null;for(mm={focusedElem:a,selectionRange:l},Kh=!1,jr=s;jr!==null;)if(s=jr,a=s.child,(s.subtreeFlags&1024)!==0&&a!==null)a.return=s,jr=a;else for(;jr!==null;){switch(s=jr,v=s.alternate,a=s.flags,s.tag){case 0:break;case 11:case 15:break;case 1:if((a&1024)!==0&&v!==null){a=void 0,l=s,m=v.memoizedProps,v=v.memoizedState,f=l.stateNode;try{var it=wo(l.type,m,l.elementType===l.type);a=f.getSnapshotBeforeUpdate(it,v),f.__reactInternalSnapshotBeforeUpdate=a}catch(Qe){Yt(l,l.return,Qe)}}break;case 3:if((a&1024)!==0){if(a=s.stateNode.containerInfo,l=a.nodeType,l===9)_m(a);else if(l===1)switch(a.nodeName){case"HEAD":case"HTML":case"BODY":_m(a);break;default:a.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((a&1024)!==0)throw Error(n(163))}if(a=s.sibling,a!==null){a.return=s.return,jr=a;break}jr=s.return}}function dx(a,s,l){var f=l.flags;switch(l.tag){case 0:case 11:case 15:is(a,l),f&4&&nu(5,l);break;case 1:if(is(a,l),f&4)if(a=l.stateNode,s===null)try{a.componentDidMount()}catch(I){Yt(l,l.return,I)}else{var m=wo(l.type,s.memoizedProps);s=s.memoizedState;try{a.componentDidUpdate(m,s,a.__reactInternalSnapshotBeforeUpdate)}catch(I){Yt(l,l.return,I)}}f&64&&ox(l),f&512&&au(l,l.return);break;case 3:if(is(a,l),f&64&&(a=l.updateQueue,a!==null)){if(s=null,l.child!==null)switch(l.child.tag){case 27:case 5:s=l.child.stateNode;break;case 1:s=l.child.stateNode}try{Xv(a,s)}catch(I){Yt(l,l.return,I)}}break;case 27:s===null&&f&4&&fx(l);case 26:case 5:is(a,l),s===null&&f&4&&cx(l),f&512&&au(l,l.return);break;case 12:is(a,l);break;case 13:is(a,l),f&4&&gx(a,l),f&64&&(a=l.memoizedState,a!==null&&(a=a.dehydrated,a!==null&&(l=kC.bind(null,l),KC(a,l))));break;case 22:if(f=l.memoizedState!==null||Si,!f){s=s!==null&&s.memoizedState!==null||pr,m=Si;var v=pr;Si=f,(pr=s)&&!v?ss(a,l,(l.subtreeFlags&8772)!==0):is(a,l),Si=m,pr=v}break;case 30:break;default:is(a,l)}}function px(a){var s=a.alternate;s!==null&&(a.alternate=null,px(s)),a.child=null,a.deletions=null,a.sibling=null,a.tag===5&&(s=a.stateNode,s!==null&&j(s)),a.stateNode=null,a.return=null,a.dependencies=null,a.memoizedProps=null,a.memoizedState=null,a.pendingProps=null,a.stateNode=null,a.updateQueue=null}var ar=null,In=!1;function Ci(a,s,l){for(l=l.child;l!==null;)mx(a,s,l),l=l.sibling}function mx(a,s,l){if(Je&&typeof Je.onCommitFiberUnmount=="function")try{Je.onCommitFiberUnmount(Ze,l)}catch{}switch(l.tag){case 26:pr||Xa(l,s),Ci(a,s,l),l.memoizedState?l.memoizedState.count--:l.stateNode&&(l=l.stateNode,l.parentNode.removeChild(l));break;case 27:pr||Xa(l,s);var f=ar,m=In;hs(l.type)&&(ar=l.stateNode,In=!1),Ci(a,s,l),du(l.stateNode),ar=f,In=m;break;case 5:pr||Xa(l,s);case 6:if(f=ar,m=In,ar=null,Ci(a,s,l),ar=f,In=m,ar!==null)if(In)try{(ar.nodeType===9?ar.body:ar.nodeName==="HTML"?ar.ownerDocument.body:ar).removeChild(l.stateNode)}catch(v){Yt(l,s,v)}else try{ar.removeChild(l.stateNode)}catch(v){Yt(l,s,v)}break;case 18:ar!==null&&(In?(a=ar,ny(a.nodeType===9?a.body:a.nodeName==="HTML"?a.ownerDocument.body:a,l.stateNode),Eu(a)):ny(ar,l.stateNode));break;case 4:f=ar,m=In,ar=l.stateNode.containerInfo,In=!0,Ci(a,s,l),ar=f,In=m;break;case 0:case 11:case 14:case 15:pr||as(2,l,s),pr||as(4,l,s),Ci(a,s,l);break;case 1:pr||(Xa(l,s),f=l.stateNode,typeof f.componentWillUnmount=="function"&&lx(l,s,f)),Ci(a,s,l);break;case 21:Ci(a,s,l);break;case 22:pr=(f=pr)||l.memoizedState!==null,Ci(a,s,l),pr=f;break;default:Ci(a,s,l)}}function gx(a,s){if(s.memoizedState===null&&(a=s.alternate,a!==null&&(a=a.memoizedState,a!==null&&(a=a.dehydrated,a!==null))))try{Eu(a)}catch(l){Yt(s,s.return,l)}}function yC(a){switch(a.tag){case 13:case 19:var s=a.stateNode;return s===null&&(s=a.stateNode=new hx),s;case 22:return a=a.stateNode,s=a._retryCache,s===null&&(s=a._retryCache=new hx),s;default:throw Error(n(435,a.tag))}}function qp(a,s){var l=yC(a);s.forEach(function(f){var m=bC.bind(null,a,f);l.has(f)||(l.add(f),f.then(m,m))})}function Bn(a,s){var l=s.deletions;if(l!==null)for(var f=0;f<l.length;f++){var m=l[f],v=a,I=s,L=I;e:for(;L!==null;){switch(L.tag){case 27:if(hs(L.type)){ar=L.stateNode,In=!1;break e}break;case 5:ar=L.stateNode,In=!1;break e;case 3:case 4:ar=L.stateNode.containerInfo,In=!0;break e}L=L.return}if(ar===null)throw Error(n(160));mx(v,I,m),ar=null,In=!1,v=m.alternate,v!==null&&(v.return=null),m.return=null}if(s.subtreeFlags&13878)for(s=s.child;s!==null;)vx(s,a),s=s.sibling}var Ta=null;function vx(a,s){var l=a.alternate,f=a.flags;switch(a.tag){case 0:case 11:case 14:case 15:Bn(s,a),jn(a),f&4&&(as(3,a,a.return),nu(3,a),as(5,a,a.return));break;case 1:Bn(s,a),jn(a),f&512&&(pr||l===null||Xa(l,l.return)),f&64&&Si&&(a=a.updateQueue,a!==null&&(f=a.callbacks,f!==null&&(l=a.shared.hiddenCallbacks,a.shared.hiddenCallbacks=l===null?f:l.concat(f))));break;case 26:var m=Ta;if(Bn(s,a),jn(a),f&512&&(pr||l===null||Xa(l,l.return)),f&4){var v=l!==null?l.memoizedState:null;if(f=a.memoizedState,l===null)if(f===null)if(a.stateNode===null){e:{f=a.type,l=a.memoizedProps,m=m.ownerDocument||m;t:switch(f){case"title":v=m.getElementsByTagName("title")[0],(!v||v[U]||v[hr]||v.namespaceURI==="http://www.w3.org/2000/svg"||v.hasAttribute("itemprop"))&&(v=m.createElement(f),m.head.insertBefore(v,m.querySelector("head > title"))),$r(v,f,l),v[hr]=a,ce(v),f=v;break e;case"link":var I=fy("link","href",m).get(f+(l.href||""));if(I){for(var L=0;L<I.length;L++)if(v=I[L],v.getAttribute("href")===(l.href==null||l.href===""?null:l.href)&&v.getAttribute("rel")===(l.rel==null?null:l.rel)&&v.getAttribute("title")===(l.title==null?null:l.title)&&v.getAttribute("crossorigin")===(l.crossOrigin==null?null:l.crossOrigin)){I.splice(L,1);break t}}v=m.createElement(f),$r(v,f,l),m.head.appendChild(v);break;case"meta":if(I=fy("meta","content",m).get(f+(l.content||""))){for(L=0;L<I.length;L++)if(v=I[L],v.getAttribute("content")===(l.content==null?null:""+l.content)&&v.getAttribute("name")===(l.name==null?null:l.name)&&v.getAttribute("property")===(l.property==null?null:l.property)&&v.getAttribute("http-equiv")===(l.httpEquiv==null?null:l.httpEquiv)&&v.getAttribute("charset")===(l.charSet==null?null:l.charSet)){I.splice(L,1);break t}}v=m.createElement(f),$r(v,f,l),m.head.appendChild(v);break;default:throw Error(n(468,f))}v[hr]=a,ce(v),f=v}a.stateNode=f}else hy(m,a.type,a.stateNode);else a.stateNode=uy(m,f,a.memoizedProps);else v!==f?(v===null?l.stateNode!==null&&(l=l.stateNode,l.parentNode.removeChild(l)):v.count--,f===null?hy(m,a.type,a.stateNode):uy(m,f,a.memoizedProps)):f===null&&a.stateNode!==null&&jp(a,a.memoizedProps,l.memoizedProps)}break;case 27:Bn(s,a),jn(a),f&512&&(pr||l===null||Xa(l,l.return)),l!==null&&f&4&&jp(a,a.memoizedProps,l.memoizedProps);break;case 5:if(Bn(s,a),jn(a),f&512&&(pr||l===null||Xa(l,l.return)),a.flags&32){m=a.stateNode;try{Zn(m,"")}catch(_e){Yt(a,a.return,_e)}}f&4&&a.stateNode!=null&&(m=a.memoizedProps,jp(a,m,l!==null?l.memoizedProps:m)),f&1024&&(Gp=!0);break;case 6:if(Bn(s,a),jn(a),f&4){if(a.stateNode===null)throw Error(n(162));f=a.memoizedProps,l=a.stateNode;try{l.nodeValue=f}catch(_e){Yt(a,a.return,_e)}}break;case 3:if(Hh=null,m=Ta,Ta=jh(s.containerInfo),Bn(s,a),Ta=m,jn(a),f&4&&l!==null&&l.memoizedState.isDehydrated)try{Eu(s.containerInfo)}catch(_e){Yt(a,a.return,_e)}Gp&&(Gp=!1,_x(a));break;case 4:f=Ta,Ta=jh(a.stateNode.containerInfo),Bn(s,a),jn(a),Ta=f;break;case 12:Bn(s,a),jn(a);break;case 13:Bn(s,a),jn(a),a.child.flags&8192&&a.memoizedState!==null!=(l!==null&&l.memoizedState!==null)&&(Qp=Pe()),f&4&&(f=a.updateQueue,f!==null&&(a.updateQueue=null,qp(a,f)));break;case 22:m=a.memoizedState!==null;var ee=l!==null&&l.memoizedState!==null,pe=Si,Ae=pr;if(Si=pe||m,pr=Ae||ee,Bn(s,a),pr=Ae,Si=pe,jn(a),f&8192)e:for(s=a.stateNode,s._visibility=m?s._visibility&-2:s._visibility|1,m&&(l===null||ee||Si||pr||So(a)),l=null,s=a;;){if(s.tag===5||s.tag===26){if(l===null){ee=l=s;try{if(v=ee.stateNode,m)I=v.style,typeof I.setProperty=="function"?I.setProperty("display","none","important"):I.display="none";else{L=ee.stateNode;var ke=ee.memoizedProps.style,ve=ke!=null&&ke.hasOwnProperty("display")?ke.display:null;L.style.display=ve==null||typeof ve=="boolean"?"":(""+ve).trim()}}catch(_e){Yt(ee,ee.return,_e)}}}else if(s.tag===6){if(l===null){ee=s;try{ee.stateNode.nodeValue=m?"":ee.memoizedProps}catch(_e){Yt(ee,ee.return,_e)}}}else if((s.tag!==22&&s.tag!==23||s.memoizedState===null||s===a)&&s.child!==null){s.child.return=s,s=s.child;continue}if(s===a)break e;for(;s.sibling===null;){if(s.return===null||s.return===a)break e;l===s&&(l=null),s=s.return}l===s&&(l=null),s.sibling.return=s.return,s=s.sibling}f&4&&(f=a.updateQueue,f!==null&&(l=f.retryQueue,l!==null&&(f.retryQueue=null,qp(a,l))));break;case 19:Bn(s,a),jn(a),f&4&&(f=a.updateQueue,f!==null&&(a.updateQueue=null,qp(a,f)));break;case 30:break;case 21:break;default:Bn(s,a),jn(a)}}function jn(a){var s=a.flags;if(s&2){try{for(var l,f=a.return;f!==null;){if(ux(f)){l=f;break}f=f.return}if(l==null)throw Error(n(160));switch(l.tag){case 27:var m=l.stateNode,v=zp(a);kh(a,v,m);break;case 5:var I=l.stateNode;l.flags&32&&(Zn(I,""),l.flags&=-33);var L=zp(a);kh(a,L,I);break;case 3:case 4:var ee=l.stateNode.containerInfo,pe=zp(a);Hp(a,pe,ee);break;default:throw Error(n(161))}}catch(Ae){Yt(a,a.return,Ae)}a.flags&=-3}s&4096&&(a.flags&=-4097)}function _x(a){if(a.subtreeFlags&1024)for(a=a.child;a!==null;){var s=a;_x(s),s.tag===5&&s.flags&1024&&s.stateNode.reset(),a=a.sibling}}function is(a,s){if(s.subtreeFlags&8772)for(s=s.child;s!==null;)dx(a,s.alternate,s),s=s.sibling}function So(a){for(a=a.child;a!==null;){var s=a;switch(s.tag){case 0:case 11:case 14:case 15:as(4,s,s.return),So(s);break;case 1:Xa(s,s.return);var l=s.stateNode;typeof l.componentWillUnmount=="function"&&lx(s,s.return,l),So(s);break;case 27:du(s.stateNode);case 26:case 5:Xa(s,s.return),So(s);break;case 22:s.memoizedState===null&&So(s);break;case 30:So(s);break;default:So(s)}a=a.sibling}}function ss(a,s,l){for(l=l&&(s.subtreeFlags&8772)!==0,s=s.child;s!==null;){var f=s.alternate,m=a,v=s,I=v.flags;switch(v.tag){case 0:case 11:case 15:ss(m,v,l),nu(4,v);break;case 1:if(ss(m,v,l),f=v,m=f.stateNode,typeof m.componentDidMount=="function")try{m.componentDidMount()}catch(pe){Yt(f,f.return,pe)}if(f=v,m=f.updateQueue,m!==null){var L=f.stateNode;try{var ee=m.shared.hiddenCallbacks;if(ee!==null)for(m.shared.hiddenCallbacks=null,m=0;m<ee.length;m++)Wv(ee[m],L)}catch(pe){Yt(f,f.return,pe)}}l&&I&64&&ox(v),au(v,v.return);break;case 27:fx(v);case 26:case 5:ss(m,v,l),l&&f===null&&I&4&&cx(v),au(v,v.return);break;case 12:ss(m,v,l);break;case 13:ss(m,v,l),l&&I&4&&gx(m,v);break;case 22:v.memoizedState===null&&ss(m,v,l),au(v,v.return);break;case 30:break;default:ss(m,v,l)}s=s.sibling}}function Kp(a,s){var l=null;a!==null&&a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(l=a.memoizedState.cachePool.pool),a=null,s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(a=s.memoizedState.cachePool.pool),a!==l&&(a!=null&&a.refCount++,l!=null&&Hc(l))}function Wp(a,s){a=null,s.alternate!==null&&(a=s.alternate.memoizedState.cache),s=s.memoizedState.cache,s!==a&&(s.refCount++,a!=null&&Hc(a))}function Ya(a,s,l,f){if(s.subtreeFlags&10256)for(s=s.child;s!==null;)xx(a,s,l,f),s=s.sibling}function xx(a,s,l,f){var m=s.flags;switch(s.tag){case 0:case 11:case 15:Ya(a,s,l,f),m&2048&&nu(9,s);break;case 1:Ya(a,s,l,f);break;case 3:Ya(a,s,l,f),m&2048&&(a=null,s.alternate!==null&&(a=s.alternate.memoizedState.cache),s=s.memoizedState.cache,s!==a&&(s.refCount++,a!=null&&Hc(a)));break;case 12:if(m&2048){Ya(a,s,l,f),a=s.stateNode;try{var v=s.memoizedProps,I=v.id,L=v.onPostCommit;typeof L=="function"&&L(I,s.alternate===null?"mount":"update",a.passiveEffectDuration,-0)}catch(ee){Yt(s,s.return,ee)}}else Ya(a,s,l,f);break;case 13:Ya(a,s,l,f);break;case 23:break;case 22:v=s.stateNode,I=s.alternate,s.memoizedState!==null?v._visibility&2?Ya(a,s,l,f):iu(a,s):v._visibility&2?Ya(a,s,l,f):(v._visibility|=2,Dl(a,s,l,f,(s.subtreeFlags&10256)!==0)),m&2048&&Kp(I,s);break;case 24:Ya(a,s,l,f),m&2048&&Wp(s.alternate,s);break;default:Ya(a,s,l,f)}}function Dl(a,s,l,f,m){for(m=m&&(s.subtreeFlags&10256)!==0,s=s.child;s!==null;){var v=a,I=s,L=l,ee=f,pe=I.flags;switch(I.tag){case 0:case 11:case 15:Dl(v,I,L,ee,m),nu(8,I);break;case 23:break;case 22:var Ae=I.stateNode;I.memoizedState!==null?Ae._visibility&2?Dl(v,I,L,ee,m):iu(v,I):(Ae._visibility|=2,Dl(v,I,L,ee,m)),m&&pe&2048&&Kp(I.alternate,I);break;case 24:Dl(v,I,L,ee,m),m&&pe&2048&&Wp(I.alternate,I);break;default:Dl(v,I,L,ee,m)}s=s.sibling}}function iu(a,s){if(s.subtreeFlags&10256)for(s=s.child;s!==null;){var l=a,f=s,m=f.flags;switch(f.tag){case 22:iu(l,f),m&2048&&Kp(f.alternate,f);break;case 24:iu(l,f),m&2048&&Wp(f.alternate,f);break;default:iu(l,f)}s=s.sibling}}var su=8192;function Ol(a){if(a.subtreeFlags&su)for(a=a.child;a!==null;)yx(a),a=a.sibling}function yx(a){switch(a.tag){case 26:Ol(a),a.flags&su&&a.memoizedState!==null&&iR(Ta,a.memoizedState,a.memoizedProps);break;case 5:Ol(a);break;case 3:case 4:var s=Ta;Ta=jh(a.stateNode.containerInfo),Ol(a),Ta=s;break;case 22:a.memoizedState===null&&(s=a.alternate,s!==null&&s.memoizedState!==null?(s=su,su=16777216,Ol(a),su=s):Ol(a));break;default:Ol(a)}}function Ex(a){var s=a.alternate;if(s!==null&&(a=s.child,a!==null)){s.child=null;do s=a.sibling,a.sibling=null,a=s;while(a!==null)}}function ou(a){var s=a.deletions;if((a.flags&16)!==0){if(s!==null)for(var l=0;l<s.length;l++){var f=s[l];jr=f,Ax(f,a)}Ex(a)}if(a.subtreeFlags&10256)for(a=a.child;a!==null;)Tx(a),a=a.sibling}function Tx(a){switch(a.tag){case 0:case 11:case 15:ou(a),a.flags&2048&&as(9,a,a.return);break;case 3:ou(a);break;case 12:ou(a);break;case 22:var s=a.stateNode;a.memoizedState!==null&&s._visibility&2&&(a.return===null||a.return.tag!==13)?(s._visibility&=-3,bh(a)):ou(a);break;default:ou(a)}}function bh(a){var s=a.deletions;if((a.flags&16)!==0){if(s!==null)for(var l=0;l<s.length;l++){var f=s[l];jr=f,Ax(f,a)}Ex(a)}for(a=a.child;a!==null;){switch(s=a,s.tag){case 0:case 11:case 15:as(8,s,s.return),bh(s);break;case 22:l=s.stateNode,l._visibility&2&&(l._visibility&=-3,bh(s));break;default:bh(s)}a=a.sibling}}function Ax(a,s){for(;jr!==null;){var l=jr;switch(l.tag){case 0:case 11:case 15:as(8,l,s);break;case 23:case 22:if(l.memoizedState!==null&&l.memoizedState.cachePool!==null){var f=l.memoizedState.cachePool.pool;f!=null&&f.refCount++}break;case 24:Hc(l.memoizedState.cache)}if(f=l.child,f!==null)f.return=l,jr=f;else e:for(l=a;jr!==null;){f=jr;var m=f.sibling,v=f.return;if(px(f),f===l){jr=null;break e}if(m!==null){m.return=v,jr=m;break e}jr=v}}}var EC={getCacheForType:function(a){var s=nn(Or),l=s.data.get(a);return l===void 0&&(l=a(),s.data.set(a,l)),l}},TC=typeof WeakMap=="function"?WeakMap:Map,zt=0,Qt=null,xt=null,bt=0,Ht=0,zn=null,os=!1,Nl=!1,Xp=!1,Ri=0,cr=0,ls=0,Co=0,Yp=0,oa=0,Fl=0,lu=null,Dn=null,$p=!1,Qp=0,Ih=1/0,Dh=null,cs=null,Yr=0,us=null,Pl=null,Ml=0,Zp=0,Jp=null,wx=null,cu=0,em=null;function Hn(){if((zt&2)!==0&&bt!==0)return bt&-bt;if(ae.T!==null){var a=Al;return a!==0?a:om()}return Ma()}function Sx(){oa===0&&(oa=(bt&536870912)===0||Ut?Ki():536870912);var a=sa.current;return a!==null&&(a.flags|=32),oa}function Gn(a,s,l){(a===Qt&&(Ht===2||Ht===9)||a.cancelPendingCommit!==null)&&(Ll(a,0),fs(a,bt,oa,!1)),xa(a,l),((zt&2)===0||a!==Qt)&&(a===Qt&&((zt&2)===0&&(Co|=l),cr===4&&fs(a,bt,oa,!1)),$a(a))}function Cx(a,s,l){if((zt&6)!==0)throw Error(n(327));var f=!l&&(s&124)===0&&(s&a.expiredLanes)===0||li(a,s),m=f?SC(a,s):nm(a,s,!0),v=f;do{if(m===0){Nl&&!f&&fs(a,s,0,!1);break}else{if(l=a.current.alternate,v&&!AC(l)){m=nm(a,s,!1),v=!1;continue}if(m===2){if(v=s,a.errorRecoveryDisabledLanes&v)var I=0;else I=a.pendingLanes&-536870913,I=I!==0?I:I&536870912?536870912:0;if(I!==0){s=I;e:{var L=a;m=lu;var ee=L.current.memoizedState.isDehydrated;if(ee&&(Ll(L,I).flags|=256),I=nm(L,I,!1),I!==2){if(Xp&&!ee){L.errorRecoveryDisabledLanes|=v,Co|=v,m=4;break e}v=Dn,Dn=m,v!==null&&(Dn===null?Dn=v:Dn.push.apply(Dn,v))}m=I}if(v=!1,m!==2)continue}}if(m===1){Ll(a,0),fs(a,s,0,!0);break}e:{switch(f=a,v=m,v){case 0:case 1:throw Error(n(345));case 4:if((s&4194048)!==s)break;case 6:fs(f,s,oa,!os);break e;case 2:Dn=null;break;case 3:case 5:break;default:throw Error(n(329))}if((s&62914560)===s&&(m=Qp+300-Pe(),10<m)){if(fs(f,s,oa,!os),Gi(f,0,!0)!==0)break e;f.timeoutHandle=ty(Rx.bind(null,f,l,Dn,Dh,$p,s,oa,Co,Fl,os,v,2,-0,0),m);break e}Rx(f,l,Dn,Dh,$p,s,oa,Co,Fl,os,v,0,-0,0)}}break}while(!0);$a(a)}function Rx(a,s,l,f,m,v,I,L,ee,pe,Ae,ke,ve,_e){if(a.timeoutHandle=-1,ke=s.subtreeFlags,(ke&8192||(ke&16785408)===16785408)&&(gu={stylesheets:null,count:0,unsuspend:aR},yx(s),ke=sR(),ke!==null)){a.cancelPendingCommit=ke(Fx.bind(null,a,s,v,l,f,m,I,L,ee,Ae,1,ve,_e)),fs(a,v,I,!pe);return}Fx(a,s,v,l,f,m,I,L,ee)}function AC(a){for(var s=a;;){var l=s.tag;if((l===0||l===11||l===15)&&s.flags&16384&&(l=s.updateQueue,l!==null&&(l=l.stores,l!==null)))for(var f=0;f<l.length;f++){var m=l[f],v=m.getSnapshot;m=m.value;try{if(!Vn(v(),m))return!1}catch{return!1}}if(l=s.child,s.subtreeFlags&16384&&l!==null)l.return=s,s=l;else{if(s===a)break;for(;s.sibling===null;){if(s.return===null||s.return===a)return!0;s=s.return}s.sibling.return=s.return,s=s.sibling}}return!0}function fs(a,s,l,f){s&=~Yp,s&=~Co,a.suspendedLanes|=s,a.pingedLanes&=~s,f&&(a.warmLanes|=s),f=a.expirationTimes;for(var m=s;0<m;){var v=31-Lt(m),I=1<<v;f[v]=-1,m&=~I}l!==0&&Qn(a,l,s)}function Oh(){return(zt&6)===0?(uu(0),!1):!0}function tm(){if(xt!==null){if(Ht===0)var a=xt.return;else a=xt,xi=yo=null,_p(a),bl=null,eu=0,a=xt;for(;a!==null;)sx(a.alternate,a),a=a.return;xt=null}}function Ll(a,s){var l=a.timeoutHandle;l!==-1&&(a.timeoutHandle=-1,jC(l)),l=a.cancelPendingCommit,l!==null&&(a.cancelPendingCommit=null,l()),tm(),Qt=a,xt=l=gi(a.current,null),bt=s,Ht=0,zn=null,os=!1,Nl=li(a,s),Xp=!1,Fl=oa=Yp=Co=ls=cr=0,Dn=lu=null,$p=!1,(s&8)!==0&&(s|=s&32);var f=a.entangledLanes;if(f!==0)for(a=a.entanglements,f&=s;0<f;){var m=31-Lt(f),v=1<<m;s|=a[m],f&=~v}return Ri=s,eh(),l}function kx(a,s){pt=null,ae.H=xh,s===qc||s===ch?(s=qv(),Ht=3):s===zv?(s=qv(),Ht=4):Ht=s===K_?8:s!==null&&typeof s=="object"&&typeof s.then=="function"?6:1,zn=s,xt===null&&(cr=1,wh(a,ra(s,a.current)))}function bx(){var a=ae.H;return ae.H=xh,a===null?xh:a}function Ix(){var a=ae.A;return ae.A=EC,a}function rm(){cr=4,os||(bt&4194048)!==bt&&sa.current!==null||(Nl=!0),(ls&134217727)===0&&(Co&134217727)===0||Qt===null||fs(Qt,bt,oa,!1)}function nm(a,s,l){var f=zt;zt|=2;var m=bx(),v=Ix();(Qt!==a||bt!==s)&&(Dh=null,Ll(a,s)),s=!1;var I=cr;e:do try{if(Ht!==0&&xt!==null){var L=xt,ee=zn;switch(Ht){case 8:tm(),I=6;break e;case 3:case 2:case 9:case 6:sa.current===null&&(s=!0);var pe=Ht;if(Ht=0,zn=null,Vl(a,L,ee,pe),l&&Nl){I=0;break e}break;default:pe=Ht,Ht=0,zn=null,Vl(a,L,ee,pe)}}wC(),I=cr;break}catch(Ae){kx(a,Ae)}while(!0);return s&&a.shellSuspendCounter++,xi=yo=null,zt=f,ae.H=m,ae.A=v,xt===null&&(Qt=null,bt=0,eh()),I}function wC(){for(;xt!==null;)Dx(xt)}function SC(a,s){var l=zt;zt|=2;var f=bx(),m=Ix();Qt!==a||bt!==s?(Dh=null,Ih=Pe()+500,Ll(a,s)):Nl=li(a,s);e:do try{if(Ht!==0&&xt!==null){s=xt;var v=zn;t:switch(Ht){case 1:Ht=0,zn=null,Vl(a,s,v,1);break;case 2:case 9:if(Hv(v)){Ht=0,zn=null,Ox(s);break}s=function(){Ht!==2&&Ht!==9||Qt!==a||(Ht=7),$a(a)},v.then(s,s);break e;case 3:Ht=7;break e;case 4:Ht=5;break e;case 7:Hv(v)?(Ht=0,zn=null,Ox(s)):(Ht=0,zn=null,Vl(a,s,v,7));break;case 5:var I=null;switch(xt.tag){case 26:I=xt.memoizedState;case 5:case 27:var L=xt;if(!I||dy(I)){Ht=0,zn=null;var ee=L.sibling;if(ee!==null)xt=ee;else{var pe=L.return;pe!==null?(xt=pe,Nh(pe)):xt=null}break t}}Ht=0,zn=null,Vl(a,s,v,5);break;case 6:Ht=0,zn=null,Vl(a,s,v,6);break;case 8:tm(),cr=6;break e;default:throw Error(n(462))}}CC();break}catch(Ae){kx(a,Ae)}while(!0);return xi=yo=null,ae.H=f,ae.A=m,zt=l,xt!==null?0:(Qt=null,bt=0,eh(),cr)}function CC(){for(;xt!==null&&!We();)Dx(xt)}function Dx(a){var s=ax(a.alternate,a,Ri);a.memoizedProps=a.pendingProps,s===null?Nh(a):xt=s}function Ox(a){var s=a,l=s.alternate;switch(s.tag){case 15:case 0:s=Z_(l,s,s.pendingProps,s.type,void 0,bt);break;case 11:s=Z_(l,s,s.pendingProps,s.type.render,s.ref,bt);break;case 5:_p(s);default:sx(l,s),s=xt=Nv(s,Ri),s=ax(l,s,Ri)}a.memoizedProps=a.pendingProps,s===null?Nh(a):xt=s}function Vl(a,s,l,f){xi=yo=null,_p(s),bl=null,eu=0;var m=s.return;try{if(mC(a,m,s,l,bt)){cr=1,wh(a,ra(l,a.current)),xt=null;return}}catch(v){if(m!==null)throw xt=m,v;cr=1,wh(a,ra(l,a.current)),xt=null;return}s.flags&32768?(Ut||f===1?a=!0:Nl||(bt&536870912)!==0?a=!1:(os=a=!0,(f===2||f===9||f===3||f===6)&&(f=sa.current,f!==null&&f.tag===13&&(f.flags|=16384))),Nx(s,a)):Nh(s)}function Nh(a){var s=a;do{if((s.flags&32768)!==0){Nx(s,os);return}a=s.return;var l=vC(s.alternate,s,Ri);if(l!==null){xt=l;return}if(s=s.sibling,s!==null){xt=s;return}xt=s=a}while(s!==null);cr===0&&(cr=5)}function Nx(a,s){do{var l=_C(a.alternate,a);if(l!==null){l.flags&=32767,xt=l;return}if(l=a.return,l!==null&&(l.flags|=32768,l.subtreeFlags=0,l.deletions=null),!s&&(a=a.sibling,a!==null)){xt=a;return}xt=a=l}while(a!==null);cr=6,xt=null}function Fx(a,s,l,f,m,v,I,L,ee){a.cancelPendingCommit=null;do Fh();while(Yr!==0);if((zt&6)!==0)throw Error(n(327));if(s!==null){if(s===a.current)throw Error(n(177));if(v=s.lanes|s.childLanes,v|=Wd,Fa(a,l,v,I,L,ee),a===Qt&&(xt=Qt=null,bt=0),Pl=s,us=a,Ml=l,Zp=v,Jp=m,wx=f,(s.subtreeFlags&10256)!==0||(s.flags&10256)!==0?(a.callbackNode=null,a.callbackPriority=0,IC(rr,function(){return Ux(),null})):(a.callbackNode=null,a.callbackPriority=0),f=(s.flags&13878)!==0,(s.subtreeFlags&13878)!==0||f){f=ae.T,ae.T=null,m=oe.p,oe.p=2,I=zt,zt|=4;try{xC(a,s,l)}finally{zt=I,oe.p=m,ae.T=f}}Yr=1,Px(),Mx(),Lx()}}function Px(){if(Yr===1){Yr=0;var a=us,s=Pl,l=(s.flags&13878)!==0;if((s.subtreeFlags&13878)!==0||l){l=ae.T,ae.T=null;var f=oe.p;oe.p=2;var m=zt;zt|=4;try{vx(s,a);var v=mm,I=Av(a.containerInfo),L=v.focusedElem,ee=v.selectionRange;if(I!==L&&L&&L.ownerDocument&&Tv(L.ownerDocument.documentElement,L)){if(ee!==null&&zd(L)){var pe=ee.start,Ae=ee.end;if(Ae===void 0&&(Ae=pe),"selectionStart"in L)L.selectionStart=pe,L.selectionEnd=Math.min(Ae,L.value.length);else{var ke=L.ownerDocument||document,ve=ke&&ke.defaultView||window;if(ve.getSelection){var _e=ve.getSelection(),it=L.textContent.length,Qe=Math.min(ee.start,it),Xt=ee.end===void 0?Qe:Math.min(ee.end,it);!_e.extend&&Qe>Xt&&(I=Xt,Xt=Qe,Qe=I);var le=Ev(L,Qe),ie=Ev(L,Xt);if(le&&ie&&(_e.rangeCount!==1||_e.anchorNode!==le.node||_e.anchorOffset!==le.offset||_e.focusNode!==ie.node||_e.focusOffset!==ie.offset)){var he=ke.createRange();he.setStart(le.node,le.offset),_e.removeAllRanges(),Qe>Xt?(_e.addRange(he),_e.extend(ie.node,ie.offset)):(he.setEnd(ie.node,ie.offset),_e.addRange(he))}}}}for(ke=[],_e=L;_e=_e.parentNode;)_e.nodeType===1&&ke.push({element:_e,left:_e.scrollLeft,top:_e.scrollTop});for(typeof L.focus=="function"&&L.focus(),L=0;L<ke.length;L++){var Se=ke[L];Se.element.scrollLeft=Se.left,Se.element.scrollTop=Se.top}}Kh=!!pm,mm=pm=null}finally{zt=m,oe.p=f,ae.T=l}}a.current=s,Yr=2}}function Mx(){if(Yr===2){Yr=0;var a=us,s=Pl,l=(s.flags&8772)!==0;if((s.subtreeFlags&8772)!==0||l){l=ae.T,ae.T=null;var f=oe.p;oe.p=2;var m=zt;zt|=4;try{dx(a,s.alternate,s)}finally{zt=m,oe.p=f,ae.T=l}}Yr=3}}function Lx(){if(Yr===4||Yr===3){Yr=0,Be();var a=us,s=Pl,l=Ml,f=wx;(s.subtreeFlags&10256)!==0||(s.flags&10256)!==0?Yr=5:(Yr=0,Pl=us=null,Vx(a,a.pendingLanes));var m=a.pendingLanes;if(m===0&&(cs=null),Xi(l),s=s.stateNode,Je&&typeof Je.onCommitFiberRoot=="function")try{Je.onCommitFiberRoot(Ze,s,void 0,(s.current.flags&128)===128)}catch{}if(f!==null){s=ae.T,m=oe.p,oe.p=2,ae.T=null;try{for(var v=a.onRecoverableError,I=0;I<f.length;I++){var L=f[I];v(L.value,{componentStack:L.stack})}}finally{ae.T=s,oe.p=m}}(Ml&3)!==0&&Fh(),$a(a),m=a.pendingLanes,(l&4194090)!==0&&(m&42)!==0?a===em?cu++:(cu=0,em=a):cu=0,uu(0)}}function Vx(a,s){(a.pooledCacheLanes&=s)===0&&(s=a.pooledCache,s!=null&&(a.pooledCache=null,Hc(s)))}function Fh(a){return Px(),Mx(),Lx(),Ux()}function Ux(){if(Yr!==5)return!1;var a=us,s=Zp;Zp=0;var l=Xi(Ml),f=ae.T,m=oe.p;try{oe.p=32>l?32:l,ae.T=null,l=Jp,Jp=null;var v=us,I=Ml;if(Yr=0,Pl=us=null,Ml=0,(zt&6)!==0)throw Error(n(331));var L=zt;if(zt|=4,Tx(v.current),xx(v,v.current,I,l),zt=L,uu(0,!1),Je&&typeof Je.onPostCommitFiberRoot=="function")try{Je.onPostCommitFiberRoot(Ze,v)}catch{}return!0}finally{oe.p=m,ae.T=f,Vx(a,s)}}function Bx(a,s,l){s=ra(l,s),s=Op(a.stateNode,s,2),a=es(a,s,2),a!==null&&(xa(a,2),$a(a))}function Yt(a,s,l){if(a.tag===3)Bx(a,a,l);else for(;s!==null;){if(s.tag===3){Bx(s,a,l);break}else if(s.tag===1){var f=s.stateNode;if(typeof s.type.getDerivedStateFromError=="function"||typeof f.componentDidCatch=="function"&&(cs===null||!cs.has(f))){a=ra(l,a),l=G_(2),f=es(s,l,2),f!==null&&(q_(l,f,s,a),xa(f,2),$a(f));break}}s=s.return}}function am(a,s,l){var f=a.pingCache;if(f===null){f=a.pingCache=new TC;var m=new Set;f.set(s,m)}else m=f.get(s),m===void 0&&(m=new Set,f.set(s,m));m.has(l)||(Xp=!0,m.add(l),a=RC.bind(null,a,s,l),s.then(a,a))}function RC(a,s,l){var f=a.pingCache;f!==null&&f.delete(s),a.pingedLanes|=a.suspendedLanes&l,a.warmLanes&=~l,Qt===a&&(bt&l)===l&&(cr===4||cr===3&&(bt&62914560)===bt&&300>Pe()-Qp?(zt&2)===0&&Ll(a,0):Yp|=l,Fl===bt&&(Fl=0)),$a(a)}function jx(a,s){s===0&&(s=Wi()),a=xl(a,s),a!==null&&(xa(a,s),$a(a))}function kC(a){var s=a.memoizedState,l=0;s!==null&&(l=s.retryLane),jx(a,l)}function bC(a,s){var l=0;switch(a.tag){case 13:var f=a.stateNode,m=a.memoizedState;m!==null&&(l=m.retryLane);break;case 19:f=a.stateNode;break;case 22:f=a.stateNode._retryCache;break;default:throw Error(n(314))}f!==null&&f.delete(s),jx(a,l)}function IC(a,s){return nt(a,s)}var Ph=null,Ul=null,im=!1,Mh=!1,sm=!1,Ro=0;function $a(a){a!==Ul&&a.next===null&&(Ul===null?Ph=Ul=a:Ul=Ul.next=a),Mh=!0,im||(im=!0,OC())}function uu(a,s){if(!sm&&Mh){sm=!0;do for(var l=!1,f=Ph;f!==null;){if(a!==0){var m=f.pendingLanes;if(m===0)var v=0;else{var I=f.suspendedLanes,L=f.pingedLanes;v=(1<<31-Lt(42|a)+1)-1,v&=m&~(I&~L),v=v&201326741?v&201326741|1:v?v|2:0}v!==0&&(l=!0,qx(f,v))}else v=bt,v=Gi(f,f===Qt?v:0,f.cancelPendingCommit!==null||f.timeoutHandle!==-1),(v&3)===0||li(f,v)||(l=!0,qx(f,v));f=f.next}while(l);sm=!1}}function DC(){zx()}function zx(){Mh=im=!1;var a=0;Ro!==0&&(BC()&&(a=Ro),Ro=0);for(var s=Pe(),l=null,f=Ph;f!==null;){var m=f.next,v=Hx(f,s);v===0?(f.next=null,l===null?Ph=m:l.next=m,m===null&&(Ul=l)):(l=f,(a!==0||(v&3)!==0)&&(Mh=!0)),f=m}uu(a)}function Hx(a,s){for(var l=a.suspendedLanes,f=a.pingedLanes,m=a.expirationTimes,v=a.pendingLanes&-62914561;0<v;){var I=31-Lt(v),L=1<<I,ee=m[I];ee===-1?((L&l)===0||(L&f)!==0)&&(m[I]=qi(L,s)):ee<=s&&(a.expiredLanes|=L),v&=~L}if(s=Qt,l=bt,l=Gi(a,a===s?l:0,a.cancelPendingCommit!==null||a.timeoutHandle!==-1),f=a.callbackNode,l===0||a===s&&(Ht===2||Ht===9)||a.cancelPendingCommit!==null)return f!==null&&f!==null&&qe(f),a.callbackNode=null,a.callbackPriority=0;if((l&3)===0||li(a,l)){if(s=l&-l,s===a.callbackPriority)return s;switch(f!==null&&qe(f),Xi(l)){case 2:case 8:l=_t;break;case 32:l=rr;break;case 268435456:l=fr;break;default:l=rr}return f=Gx.bind(null,a),l=nt(l,f),a.callbackPriority=s,a.callbackNode=l,s}return f!==null&&f!==null&&qe(f),a.callbackPriority=2,a.callbackNode=null,2}function Gx(a,s){if(Yr!==0&&Yr!==5)return a.callbackNode=null,a.callbackPriority=0,null;var l=a.callbackNode;if(Fh()&&a.callbackNode!==l)return null;var f=bt;return f=Gi(a,a===Qt?f:0,a.cancelPendingCommit!==null||a.timeoutHandle!==-1),f===0?null:(Cx(a,f,s),Hx(a,Pe()),a.callbackNode!=null&&a.callbackNode===l?Gx.bind(null,a):null)}function qx(a,s){if(Fh())return null;Cx(a,s,!0)}function OC(){zC(function(){(zt&6)!==0?nt(ut,DC):zx()})}function om(){return Ro===0&&(Ro=Ki()),Ro}function Kx(a){return a==null||typeof a=="symbol"||typeof a=="boolean"?null:typeof a=="function"?a:ol(""+a)}function Wx(a,s){var l=s.ownerDocument.createElement("input");return l.name=s.name,l.value=s.value,a.id&&l.setAttribute("form",a.id),s.parentNode.insertBefore(l,s),a=new FormData(a),l.parentNode.removeChild(l),a}function NC(a,s,l,f,m){if(s==="submit"&&l&&l.stateNode===m){var v=Kx((m[nr]||null).action),I=f.submitter;I&&(s=(s=I[nr]||null)?Kx(s.formAction):I.getAttribute("formAction"),s!==null&&(v=s,I=null));var L=new ll("action","action",null,f,m);a.push({event:L,listeners:[{instance:null,listener:function(){if(f.defaultPrevented){if(Ro!==0){var ee=I?Wx(m,I):new FormData(m);Rp(l,{pending:!0,data:ee,method:m.method,action:v},null,ee)}}else typeof v=="function"&&(L.preventDefault(),ee=I?Wx(m,I):new FormData(m),Rp(l,{pending:!0,data:ee,method:m.method,action:v},v,ee))},currentTarget:m}]})}}for(var lm=0;lm<Kd.length;lm++){var cm=Kd[lm],FC=cm.toLowerCase(),PC=cm[0].toUpperCase()+cm.slice(1);Ea(FC,"on"+PC)}Ea(Cv,"onAnimationEnd"),Ea(Rv,"onAnimationIteration"),Ea(kv,"onAnimationStart"),Ea("dblclick","onDoubleClick"),Ea("focusin","onFocus"),Ea("focusout","onBlur"),Ea(Z4,"onTransitionRun"),Ea(J4,"onTransitionStart"),Ea(eC,"onTransitionCancel"),Ea(bv,"onTransitionEnd"),Le("onMouseEnter",["mouseout","mouseover"]),Le("onMouseLeave",["mouseout","mouseover"]),Le("onPointerEnter",["pointerout","pointerover"]),Le("onPointerLeave",["pointerout","pointerover"]),Ne("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Ne("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Ne("onBeforeInput",["compositionend","keypress","textInput","paste"]),Ne("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Ne("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Ne("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var fu="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),MC=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(fu));function Xx(a,s){s=(s&4)!==0;for(var l=0;l<a.length;l++){var f=a[l],m=f.event;f=f.listeners;e:{var v=void 0;if(s)for(var I=f.length-1;0<=I;I--){var L=f[I],ee=L.instance,pe=L.currentTarget;if(L=L.listener,ee!==v&&m.isPropagationStopped())break e;v=L,m.currentTarget=pe;try{v(m)}catch(Ae){Ah(Ae)}m.currentTarget=null,v=ee}else for(I=0;I<f.length;I++){if(L=f[I],ee=L.instance,pe=L.currentTarget,L=L.listener,ee!==v&&m.isPropagationStopped())break e;v=L,m.currentTarget=pe;try{v(m)}catch(Ae){Ah(Ae)}m.currentTarget=null,v=ee}}}}function yt(a,s){var l=s[eo];l===void 0&&(l=s[eo]=new Set);var f=a+"__bubble";l.has(f)||(Yx(s,a,2,!1),l.add(f))}function um(a,s,l){var f=0;s&&(f|=4),Yx(l,a,f,s)}var Lh="_reactListening"+Math.random().toString(36).slice(2);function fm(a){if(!a[Lh]){a[Lh]=!0,me.forEach(function(l){l!=="selectionchange"&&(MC.has(l)||um(l,!1,a),um(l,!0,a))});var s=a.nodeType===9?a:a.ownerDocument;s===null||s[Lh]||(s[Lh]=!0,um("selectionchange",!1,s))}}function Yx(a,s,l,f){switch(xy(s)){case 2:var m=cR;break;case 8:m=uR;break;default:m=Sm}l=m.bind(null,s,l,a),m=void 0,!ea||s!=="touchstart"&&s!=="touchmove"&&s!=="wheel"||(m=!0),f?m!==void 0?a.addEventListener(s,l,{capture:!0,passive:m}):a.addEventListener(s,l,!0):m!==void 0?a.addEventListener(s,l,{passive:m}):a.addEventListener(s,l,!1)}function hm(a,s,l,f,m){var v=f;if((s&1)===0&&(s&2)===0&&f!==null)e:for(;;){if(f===null)return;var I=f.tag;if(I===3||I===4){var L=f.stateNode.containerInfo;if(L===m)break;if(I===4)for(I=f.return;I!==null;){var ee=I.tag;if((ee===3||ee===4)&&I.stateNode.containerInfo===m)return;I=I.return}for(;L!==null;){if(I=q(L),I===null)return;if(ee=I.tag,ee===5||ee===6||ee===26||ee===27){f=v=I;continue e}L=L.parentNode}}f=f.return}Uf(function(){var pe=v,Ae=Jn(l),ke=[];e:{var ve=Iv.get(a);if(ve!==void 0){var _e=ll,it=a;switch(a){case"keypress":if(ja(l)===0)break e;case"keydown":case"keyup":_e=pl;break;case"focusin":it="focus",_e=fl;break;case"focusout":it="blur",_e=fl;break;case"beforeblur":case"afterblur":_e=fl;break;case"click":if(l.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":_e=ta;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":_e=Vd;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":_e=Wf;break;case Cv:case Rv:case kv:_e=hl;break;case bv:_e=Yf;break;case"scroll":case"scrollend":_e=Bf;break;case"wheel":_e=ml;break;case"copy":case"cut":case"paste":_e=dl;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":_e=Pc;break;case"toggle":case"beforetoggle":_e=Qf}var Qe=(s&4)!==0,Xt=!Qe&&(a==="scroll"||a==="scrollend"),le=Qe?ve!==null?ve+"Capture":null:ve;Qe=[];for(var ie=pe,he;ie!==null;){var Se=ie;if(he=Se.stateNode,Se=Se.tag,Se!==5&&Se!==26&&Se!==27||he===null||le===null||(Se=io(ie,le),Se!=null&&Qe.push(hu(ie,Se,he))),Xt)break;ie=ie.return}0<Qe.length&&(ve=new _e(ve,it,null,l,Ae),ke.push({event:ve,listeners:Qe}))}}if((s&7)===0){e:{if(ve=a==="mouseover"||a==="pointerover",_e=a==="mouseout"||a==="pointerout",ve&&l!==ui&&(it=l.relatedTarget||l.fromElement)&&(q(it)||it[Rn]))break e;if((_e||ve)&&(ve=Ae.window===Ae?Ae:(ve=Ae.ownerDocument)?ve.defaultView||ve.parentWindow:window,_e?(it=l.relatedTarget||l.toElement,_e=pe,it=it?q(it):null,it!==null&&(Xt=o(it),Qe=it.tag,it!==Xt||Qe!==5&&Qe!==27&&Qe!==6)&&(it=null)):(_e=null,it=pe),_e!==it)){if(Qe=ta,Se="onMouseLeave",le="onMouseEnter",ie="mouse",(a==="pointerout"||a==="pointerover")&&(Qe=Pc,Se="onPointerLeave",le="onPointerEnter",ie="pointer"),Xt=_e==null?ve:de(_e),he=it==null?ve:de(it),ve=new Qe(Se,ie+"leave",_e,l,Ae),ve.target=Xt,ve.relatedTarget=he,Se=null,q(Ae)===pe&&(Qe=new Qe(le,ie+"enter",it,l,Ae),Qe.target=he,Qe.relatedTarget=Xt,Se=Qe),Xt=Se,_e&&it)t:{for(Qe=_e,le=it,ie=0,he=Qe;he;he=Bl(he))ie++;for(he=0,Se=le;Se;Se=Bl(Se))he++;for(;0<ie-he;)Qe=Bl(Qe),ie--;for(;0<he-ie;)le=Bl(le),he--;for(;ie--;){if(Qe===le||le!==null&&Qe===le.alternate)break t;Qe=Bl(Qe),le=Bl(le)}Qe=null}else Qe=null;_e!==null&&$x(ke,ve,_e,Qe,!1),it!==null&&Xt!==null&&$x(ke,Xt,it,Qe,!0)}}e:{if(ve=pe?de(pe):window,_e=ve.nodeName&&ve.nodeName.toLowerCase(),_e==="select"||_e==="input"&&ve.type==="file")var Ke=mv;else if(Dr(ve))if(gv)Ke=Y4;else{Ke=W4;var gt=K4}else _e=ve.nodeName,!_e||_e.toLowerCase()!=="input"||ve.type!=="checkbox"&&ve.type!=="radio"?pe&&kc(pe.elementType)&&(Ke=mv):Ke=X4;if(Ke&&(Ke=Ke(a,pe))){mi(ke,Ke,l,Ae);break e}gt&&gt(a,ve,pe),a==="focusout"&&pe&&ve.type==="number"&&pe.memoizedProps.value!=null&&Yi(ve,"number",ve.value)}switch(gt=pe?de(pe):window,a){case"focusin":(Dr(gt)||gt.contentEditable==="true")&&(gl=gt,Hd=pe,Vc=null);break;case"focusout":Vc=Hd=gl=null;break;case"mousedown":Gd=!0;break;case"contextmenu":case"mouseup":case"dragend":Gd=!1,wv(ke,l,Ae);break;case"selectionchange":if(Q4)break;case"keydown":case"keyup":wv(ke,l,Ae)}var Xe;if(Ga)e:{switch(a){case"compositionstart":var et="onCompositionStart";break e;case"compositionend":et="onCompositionEnd";break e;case"compositionupdate":et="onCompositionUpdate";break e}et=void 0}else Rt?ye(a,l)&&(et="onCompositionEnd"):a==="keydown"&&l.keyCode===229&&(et="onCompositionStart");et&&(k&&l.locale!=="ko"&&(Rt||et!=="onCompositionStart"?et==="onCompositionEnd"&&Rt&&(Xe=Ic()):(Ba=Ae,$i="value"in Ba?Ba.value:Ba.textContent,Rt=!0)),gt=Vh(pe,et),0<gt.length&&(et=new Nc(et,a,null,l,Ae),ke.push({event:et,listeners:gt}),Xe?et.data=Xe:(Xe=Ve(l),Xe!==null&&(et.data=Xe)))),(Xe=y?Ir(a,l):kt(a,l))&&(et=Vh(pe,"onBeforeInput"),0<et.length&&(gt=new Nc("onBeforeInput","beforeinput",null,l,Ae),ke.push({event:gt,listeners:et}),gt.data=Xe)),NC(ke,a,pe,l,Ae)}Xx(ke,s)})}function hu(a,s,l){return{instance:a,listener:s,currentTarget:l}}function Vh(a,s){for(var l=s+"Capture",f=[];a!==null;){var m=a,v=m.stateNode;if(m=m.tag,m!==5&&m!==26&&m!==27||v===null||(m=io(a,l),m!=null&&f.unshift(hu(a,m,v)),m=io(a,s),m!=null&&f.push(hu(a,m,v))),a.tag===3)return f;a=a.return}return[]}function Bl(a){if(a===null)return null;do a=a.return;while(a&&a.tag!==5&&a.tag!==27);return a||null}function $x(a,s,l,f,m){for(var v=s._reactName,I=[];l!==null&&l!==f;){var L=l,ee=L.alternate,pe=L.stateNode;if(L=L.tag,ee!==null&&ee===f)break;L!==5&&L!==26&&L!==27||pe===null||(ee=pe,m?(pe=io(l,v),pe!=null&&I.unshift(hu(l,pe,ee))):m||(pe=io(l,v),pe!=null&&I.push(hu(l,pe,ee)))),l=l.return}I.length!==0&&a.push({event:s,listeners:I})}var LC=/\r\n?/g,VC=/\u0000|\uFFFD/g;function Qx(a){return(typeof a=="string"?a:""+a).replace(LC,`
`).replace(VC,"")}function Zx(a,s){return s=Qx(s),Qx(a)===s}function Uh(){}function Wt(a,s,l,f,m,v){switch(l){case"children":typeof f=="string"?s==="body"||s==="textarea"&&f===""||Zn(a,f):(typeof f=="number"||typeof f=="bigint")&&s!=="body"&&Zn(a,""+f);break;case"className":St(a,"class",f);break;case"tabIndex":St(a,"tabindex",f);break;case"dir":case"role":case"viewBox":case"width":case"height":St(a,l,f);break;case"style":Rc(a,f,v);break;case"data":if(s!=="object"){St(a,"data",f);break}case"src":case"href":if(f===""&&(s!=="a"||l!=="href")){a.removeAttribute(l);break}if(f==null||typeof f=="function"||typeof f=="symbol"||typeof f=="boolean"){a.removeAttribute(l);break}f=ol(""+f),a.setAttribute(l,f);break;case"action":case"formAction":if(typeof f=="function"){a.setAttribute(l,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof v=="function"&&(l==="formAction"?(s!=="input"&&Wt(a,s,"name",m.name,m,null),Wt(a,s,"formEncType",m.formEncType,m,null),Wt(a,s,"formMethod",m.formMethod,m,null),Wt(a,s,"formTarget",m.formTarget,m,null)):(Wt(a,s,"encType",m.encType,m,null),Wt(a,s,"method",m.method,m,null),Wt(a,s,"target",m.target,m,null)));if(f==null||typeof f=="symbol"||typeof f=="boolean"){a.removeAttribute(l);break}f=ol(""+f),a.setAttribute(l,f);break;case"onClick":f!=null&&(a.onclick=Uh);break;case"onScroll":f!=null&&yt("scroll",a);break;case"onScrollEnd":f!=null&&yt("scrollend",a);break;case"dangerouslySetInnerHTML":if(f!=null){if(typeof f!="object"||!("__html"in f))throw Error(n(61));if(l=f.__html,l!=null){if(m.children!=null)throw Error(n(60));a.innerHTML=l}}break;case"multiple":a.multiple=f&&typeof f!="function"&&typeof f!="symbol";break;case"muted":a.muted=f&&typeof f!="function"&&typeof f!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(f==null||typeof f=="function"||typeof f=="boolean"||typeof f=="symbol"){a.removeAttribute("xlink:href");break}l=ol(""+f),a.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",l);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":f!=null&&typeof f!="function"&&typeof f!="symbol"?a.setAttribute(l,""+f):a.removeAttribute(l);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":f&&typeof f!="function"&&typeof f!="symbol"?a.setAttribute(l,""):a.removeAttribute(l);break;case"capture":case"download":f===!0?a.setAttribute(l,""):f!==!1&&f!=null&&typeof f!="function"&&typeof f!="symbol"?a.setAttribute(l,f):a.removeAttribute(l);break;case"cols":case"rows":case"size":case"span":f!=null&&typeof f!="function"&&typeof f!="symbol"&&!isNaN(f)&&1<=f?a.setAttribute(l,f):a.removeAttribute(l);break;case"rowSpan":case"start":f==null||typeof f=="function"||typeof f=="symbol"||isNaN(f)?a.removeAttribute(l):a.setAttribute(l,f);break;case"popover":yt("beforetoggle",a),yt("toggle",a),Pt(a,"popover",f);break;case"xlinkActuate":Ct(a,"http://www.w3.org/1999/xlink","xlink:actuate",f);break;case"xlinkArcrole":Ct(a,"http://www.w3.org/1999/xlink","xlink:arcrole",f);break;case"xlinkRole":Ct(a,"http://www.w3.org/1999/xlink","xlink:role",f);break;case"xlinkShow":Ct(a,"http://www.w3.org/1999/xlink","xlink:show",f);break;case"xlinkTitle":Ct(a,"http://www.w3.org/1999/xlink","xlink:title",f);break;case"xlinkType":Ct(a,"http://www.w3.org/1999/xlink","xlink:type",f);break;case"xmlBase":Ct(a,"http://www.w3.org/XML/1998/namespace","xml:base",f);break;case"xmlLang":Ct(a,"http://www.w3.org/XML/1998/namespace","xml:lang",f);break;case"xmlSpace":Ct(a,"http://www.w3.org/XML/1998/namespace","xml:space",f);break;case"is":Pt(a,"is",f);break;case"innerText":case"textContent":break;default:(!(2<l.length)||l[0]!=="o"&&l[0]!=="O"||l[1]!=="n"&&l[1]!=="N")&&(l=Md.get(l)||l,Pt(a,l,f))}}function dm(a,s,l,f,m,v){switch(l){case"style":Rc(a,f,v);break;case"dangerouslySetInnerHTML":if(f!=null){if(typeof f!="object"||!("__html"in f))throw Error(n(61));if(l=f.__html,l!=null){if(m.children!=null)throw Error(n(60));a.innerHTML=l}}break;case"children":typeof f=="string"?Zn(a,f):(typeof f=="number"||typeof f=="bigint")&&Zn(a,""+f);break;case"onScroll":f!=null&&yt("scroll",a);break;case"onScrollEnd":f!=null&&yt("scrollend",a);break;case"onClick":f!=null&&(a.onclick=Uh);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!ge.hasOwnProperty(l))e:{if(l[0]==="o"&&l[1]==="n"&&(m=l.endsWith("Capture"),s=l.slice(2,m?l.length-7:void 0),v=a[nr]||null,v=v!=null?v[l]:null,typeof v=="function"&&a.removeEventListener(s,v,m),typeof f=="function")){typeof v!="function"&&v!==null&&(l in a?a[l]=null:a.hasAttribute(l)&&a.removeAttribute(l)),a.addEventListener(s,f,m);break e}l in a?a[l]=f:f===!0?a.setAttribute(l,""):Pt(a,l,f)}}}function $r(a,s,l){switch(s){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":yt("error",a),yt("load",a);var f=!1,m=!1,v;for(v in l)if(l.hasOwnProperty(v)){var I=l[v];if(I!=null)switch(v){case"src":f=!0;break;case"srcSet":m=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(n(137,s));default:Wt(a,s,v,I,l,null)}}m&&Wt(a,s,"srcSet",l.srcSet,l,null),f&&Wt(a,s,"src",l.src,l,null);return;case"input":yt("invalid",a);var L=v=I=m=null,ee=null,pe=null;for(f in l)if(l.hasOwnProperty(f)){var Ae=l[f];if(Ae!=null)switch(f){case"name":m=Ae;break;case"type":I=Ae;break;case"checked":ee=Ae;break;case"defaultChecked":pe=Ae;break;case"value":v=Ae;break;case"defaultValue":L=Ae;break;case"children":case"dangerouslySetInnerHTML":if(Ae!=null)throw Error(n(137,s));break;default:Wt(a,s,f,Ae,l,null)}}ro(a,v,L,ee,pe,I,m,!1),sl(a);return;case"select":yt("invalid",a),f=I=v=null;for(m in l)if(l.hasOwnProperty(m)&&(L=l[m],L!=null))switch(m){case"value":v=L;break;case"defaultValue":I=L;break;case"multiple":f=L;default:Wt(a,s,m,L,l,null)}s=v,l=I,a.multiple=!!f,s!=null?ci(a,!!f,s,!1):l!=null&&ci(a,!!f,l,!0);return;case"textarea":yt("invalid",a),v=m=f=null;for(I in l)if(l.hasOwnProperty(I)&&(L=l[I],L!=null))switch(I){case"value":f=L;break;case"defaultValue":m=L;break;case"children":v=L;break;case"dangerouslySetInnerHTML":if(L!=null)throw Error(n(91));break;default:Wt(a,s,I,L,l,null)}no(a,f,m,v),sl(a);return;case"option":for(ee in l)if(l.hasOwnProperty(ee)&&(f=l[ee],f!=null))switch(ee){case"selected":a.selected=f&&typeof f!="function"&&typeof f!="symbol";break;default:Wt(a,s,ee,f,l,null)}return;case"dialog":yt("beforetoggle",a),yt("toggle",a),yt("cancel",a),yt("close",a);break;case"iframe":case"object":yt("load",a);break;case"video":case"audio":for(f=0;f<fu.length;f++)yt(fu[f],a);break;case"image":yt("error",a),yt("load",a);break;case"details":yt("toggle",a);break;case"embed":case"source":case"link":yt("error",a),yt("load",a);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(pe in l)if(l.hasOwnProperty(pe)&&(f=l[pe],f!=null))switch(pe){case"children":case"dangerouslySetInnerHTML":throw Error(n(137,s));default:Wt(a,s,pe,f,l,null)}return;default:if(kc(s)){for(Ae in l)l.hasOwnProperty(Ae)&&(f=l[Ae],f!==void 0&&dm(a,s,Ae,f,l,void 0));return}}for(L in l)l.hasOwnProperty(L)&&(f=l[L],f!=null&&Wt(a,s,L,f,l,null))}function UC(a,s,l,f){switch(s){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var m=null,v=null,I=null,L=null,ee=null,pe=null,Ae=null;for(_e in l){var ke=l[_e];if(l.hasOwnProperty(_e)&&ke!=null)switch(_e){case"checked":break;case"value":break;case"defaultValue":ee=ke;default:f.hasOwnProperty(_e)||Wt(a,s,_e,null,f,ke)}}for(var ve in f){var _e=f[ve];if(ke=l[ve],f.hasOwnProperty(ve)&&(_e!=null||ke!=null))switch(ve){case"type":v=_e;break;case"name":m=_e;break;case"checked":pe=_e;break;case"defaultChecked":Ae=_e;break;case"value":I=_e;break;case"defaultValue":L=_e;break;case"children":case"dangerouslySetInnerHTML":if(_e!=null)throw Error(n(137,s));break;default:_e!==ke&&Wt(a,s,ve,_e,f,ke)}}Ln(a,I,L,ee,pe,Ae,v,m);return;case"select":_e=I=L=ve=null;for(v in l)if(ee=l[v],l.hasOwnProperty(v)&&ee!=null)switch(v){case"value":break;case"multiple":_e=ee;default:f.hasOwnProperty(v)||Wt(a,s,v,null,f,ee)}for(m in f)if(v=f[m],ee=l[m],f.hasOwnProperty(m)&&(v!=null||ee!=null))switch(m){case"value":ve=v;break;case"defaultValue":L=v;break;case"multiple":I=v;default:v!==ee&&Wt(a,s,m,v,f,ee)}s=L,l=I,f=_e,ve!=null?ci(a,!!l,ve,!1):!!f!=!!l&&(s!=null?ci(a,!!l,s,!0):ci(a,!!l,l?[]:"",!1));return;case"textarea":_e=ve=null;for(L in l)if(m=l[L],l.hasOwnProperty(L)&&m!=null&&!f.hasOwnProperty(L))switch(L){case"value":break;case"children":break;default:Wt(a,s,L,null,f,m)}for(I in f)if(m=f[I],v=l[I],f.hasOwnProperty(I)&&(m!=null||v!=null))switch(I){case"value":ve=m;break;case"defaultValue":_e=m;break;case"children":break;case"dangerouslySetInnerHTML":if(m!=null)throw Error(n(91));break;default:m!==v&&Wt(a,s,I,m,f,v)}qt(a,ve,_e);return;case"option":for(var it in l)if(ve=l[it],l.hasOwnProperty(it)&&ve!=null&&!f.hasOwnProperty(it))switch(it){case"selected":a.selected=!1;break;default:Wt(a,s,it,null,f,ve)}for(ee in f)if(ve=f[ee],_e=l[ee],f.hasOwnProperty(ee)&&ve!==_e&&(ve!=null||_e!=null))switch(ee){case"selected":a.selected=ve&&typeof ve!="function"&&typeof ve!="symbol";break;default:Wt(a,s,ee,ve,f,_e)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Qe in l)ve=l[Qe],l.hasOwnProperty(Qe)&&ve!=null&&!f.hasOwnProperty(Qe)&&Wt(a,s,Qe,null,f,ve);for(pe in f)if(ve=f[pe],_e=l[pe],f.hasOwnProperty(pe)&&ve!==_e&&(ve!=null||_e!=null))switch(pe){case"children":case"dangerouslySetInnerHTML":if(ve!=null)throw Error(n(137,s));break;default:Wt(a,s,pe,ve,f,_e)}return;default:if(kc(s)){for(var Xt in l)ve=l[Xt],l.hasOwnProperty(Xt)&&ve!==void 0&&!f.hasOwnProperty(Xt)&&dm(a,s,Xt,void 0,f,ve);for(Ae in f)ve=f[Ae],_e=l[Ae],!f.hasOwnProperty(Ae)||ve===_e||ve===void 0&&_e===void 0||dm(a,s,Ae,ve,f,_e);return}}for(var le in l)ve=l[le],l.hasOwnProperty(le)&&ve!=null&&!f.hasOwnProperty(le)&&Wt(a,s,le,null,f,ve);for(ke in f)ve=f[ke],_e=l[ke],!f.hasOwnProperty(ke)||ve===_e||ve==null&&_e==null||Wt(a,s,ke,ve,f,_e)}var pm=null,mm=null;function Bh(a){return a.nodeType===9?a:a.ownerDocument}function Jx(a){switch(a){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function ey(a,s){if(a===0)switch(s){case"svg":return 1;case"math":return 2;default:return 0}return a===1&&s==="foreignObject"?0:a}function gm(a,s){return a==="textarea"||a==="noscript"||typeof s.children=="string"||typeof s.children=="number"||typeof s.children=="bigint"||typeof s.dangerouslySetInnerHTML=="object"&&s.dangerouslySetInnerHTML!==null&&s.dangerouslySetInnerHTML.__html!=null}var vm=null;function BC(){var a=window.event;return a&&a.type==="popstate"?a===vm?!1:(vm=a,!0):(vm=null,!1)}var ty=typeof setTimeout=="function"?setTimeout:void 0,jC=typeof clearTimeout=="function"?clearTimeout:void 0,ry=typeof Promise=="function"?Promise:void 0,zC=typeof queueMicrotask=="function"?queueMicrotask:typeof ry<"u"?function(a){return ry.resolve(null).then(a).catch(HC)}:ty;function HC(a){setTimeout(function(){throw a})}function hs(a){return a==="head"}function ny(a,s){var l=s,f=0,m=0;do{var v=l.nextSibling;if(a.removeChild(l),v&&v.nodeType===8)if(l=v.data,l==="/$"){if(0<f&&8>f){l=f;var I=a.ownerDocument;if(l&1&&du(I.documentElement),l&2&&du(I.body),l&4)for(l=I.head,du(l),I=l.firstChild;I;){var L=I.nextSibling,ee=I.nodeName;I[U]||ee==="SCRIPT"||ee==="STYLE"||ee==="LINK"&&I.rel.toLowerCase()==="stylesheet"||l.removeChild(I),I=L}}if(m===0){a.removeChild(v),Eu(s);return}m--}else l==="$"||l==="$?"||l==="$!"?m++:f=l.charCodeAt(0)-48;else f=0;l=v}while(l);Eu(s)}function _m(a){var s=a.firstChild;for(s&&s.nodeType===10&&(s=s.nextSibling);s;){var l=s;switch(s=s.nextSibling,l.nodeName){case"HTML":case"HEAD":case"BODY":_m(l),j(l);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(l.rel.toLowerCase()==="stylesheet")continue}a.removeChild(l)}}function GC(a,s,l,f){for(;a.nodeType===1;){var m=l;if(a.nodeName.toLowerCase()!==s.toLowerCase()){if(!f&&(a.nodeName!=="INPUT"||a.type!=="hidden"))break}else if(f){if(!a[U])switch(s){case"meta":if(!a.hasAttribute("itemprop"))break;return a;case"link":if(v=a.getAttribute("rel"),v==="stylesheet"&&a.hasAttribute("data-precedence"))break;if(v!==m.rel||a.getAttribute("href")!==(m.href==null||m.href===""?null:m.href)||a.getAttribute("crossorigin")!==(m.crossOrigin==null?null:m.crossOrigin)||a.getAttribute("title")!==(m.title==null?null:m.title))break;return a;case"style":if(a.hasAttribute("data-precedence"))break;return a;case"script":if(v=a.getAttribute("src"),(v!==(m.src==null?null:m.src)||a.getAttribute("type")!==(m.type==null?null:m.type)||a.getAttribute("crossorigin")!==(m.crossOrigin==null?null:m.crossOrigin))&&v&&a.hasAttribute("async")&&!a.hasAttribute("itemprop"))break;return a;default:return a}}else if(s==="input"&&a.type==="hidden"){var v=m.name==null?null:""+m.name;if(m.type==="hidden"&&a.getAttribute("name")===v)return a}else return a;if(a=Aa(a.nextSibling),a===null)break}return null}function qC(a,s,l){if(s==="")return null;for(;a.nodeType!==3;)if((a.nodeType!==1||a.nodeName!=="INPUT"||a.type!=="hidden")&&!l||(a=Aa(a.nextSibling),a===null))return null;return a}function xm(a){return a.data==="$!"||a.data==="$?"&&a.ownerDocument.readyState==="complete"}function KC(a,s){var l=a.ownerDocument;if(a.data!=="$?"||l.readyState==="complete")s();else{var f=function(){s(),l.removeEventListener("DOMContentLoaded",f)};l.addEventListener("DOMContentLoaded",f),a._reactRetry=f}}function Aa(a){for(;a!=null;a=a.nextSibling){var s=a.nodeType;if(s===1||s===3)break;if(s===8){if(s=a.data,s==="$"||s==="$!"||s==="$?"||s==="F!"||s==="F")break;if(s==="/$")return null}}return a}var ym=null;function ay(a){a=a.previousSibling;for(var s=0;a;){if(a.nodeType===8){var l=a.data;if(l==="$"||l==="$!"||l==="$?"){if(s===0)return a;s--}else l==="/$"&&s++}a=a.previousSibling}return null}function iy(a,s,l){switch(s=Bh(l),a){case"html":if(a=s.documentElement,!a)throw Error(n(452));return a;case"head":if(a=s.head,!a)throw Error(n(453));return a;case"body":if(a=s.body,!a)throw Error(n(454));return a;default:throw Error(n(451))}}function du(a){for(var s=a.attributes;s.length;)a.removeAttributeNode(s[0]);j(a)}var la=new Map,sy=new Set;function jh(a){return typeof a.getRootNode=="function"?a.getRootNode():a.nodeType===9?a:a.ownerDocument}var ki=oe.d;oe.d={f:WC,r:XC,D:YC,C:$C,L:QC,m:ZC,X:eR,S:JC,M:tR};function WC(){var a=ki.f(),s=Oh();return a||s}function XC(a){var s=Y(a);s!==null&&s.tag===5&&s.type==="form"?C_(s):ki.r(a)}var jl=typeof document>"u"?null:document;function oy(a,s,l){var f=jl;if(f&&typeof s=="string"&&s){var m=Er(s);m='link[rel="'+a+'"][href="'+m+'"]',typeof l=="string"&&(m+='[crossorigin="'+l+'"]'),sy.has(m)||(sy.add(m),a={rel:a,crossOrigin:l,href:s},f.querySelector(m)===null&&(s=f.createElement("link"),$r(s,"link",a),ce(s),f.head.appendChild(s)))}}function YC(a){ki.D(a),oy("dns-prefetch",a,null)}function $C(a,s){ki.C(a,s),oy("preconnect",a,s)}function QC(a,s,l){ki.L(a,s,l);var f=jl;if(f&&a&&s){var m='link[rel="preload"][as="'+Er(s)+'"]';s==="image"&&l&&l.imageSrcSet?(m+='[imagesrcset="'+Er(l.imageSrcSet)+'"]',typeof l.imageSizes=="string"&&(m+='[imagesizes="'+Er(l.imageSizes)+'"]')):m+='[href="'+Er(a)+'"]';var v=m;switch(s){case"style":v=zl(a);break;case"script":v=Hl(a)}la.has(v)||(a=g({rel:"preload",href:s==="image"&&l&&l.imageSrcSet?void 0:a,as:s},l),la.set(v,a),f.querySelector(m)!==null||s==="style"&&f.querySelector(pu(v))||s==="script"&&f.querySelector(mu(v))||(s=f.createElement("link"),$r(s,"link",a),ce(s),f.head.appendChild(s)))}}function ZC(a,s){ki.m(a,s);var l=jl;if(l&&a){var f=s&&typeof s.as=="string"?s.as:"script",m='link[rel="modulepreload"][as="'+Er(f)+'"][href="'+Er(a)+'"]',v=m;switch(f){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":v=Hl(a)}if(!la.has(v)&&(a=g({rel:"modulepreload",href:a},s),la.set(v,a),l.querySelector(m)===null)){switch(f){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(l.querySelector(mu(v)))return}f=l.createElement("link"),$r(f,"link",a),ce(f),l.head.appendChild(f)}}}function JC(a,s,l){ki.S(a,s,l);var f=jl;if(f&&a){var m=xe(f).hoistableStyles,v=zl(a);s=s||"default";var I=m.get(v);if(!I){var L={loading:0,preload:null};if(I=f.querySelector(pu(v)))L.loading=5;else{a=g({rel:"stylesheet",href:a,"data-precedence":s},l),(l=la.get(v))&&Em(a,l);var ee=I=f.createElement("link");ce(ee),$r(ee,"link",a),ee._p=new Promise(function(pe,Ae){ee.onload=pe,ee.onerror=Ae}),ee.addEventListener("load",function(){L.loading|=1}),ee.addEventListener("error",function(){L.loading|=2}),L.loading|=4,zh(I,s,f)}I={type:"stylesheet",instance:I,count:1,state:L},m.set(v,I)}}}function eR(a,s){ki.X(a,s);var l=jl;if(l&&a){var f=xe(l).hoistableScripts,m=Hl(a),v=f.get(m);v||(v=l.querySelector(mu(m)),v||(a=g({src:a,async:!0},s),(s=la.get(m))&&Tm(a,s),v=l.createElement("script"),ce(v),$r(v,"link",a),l.head.appendChild(v)),v={type:"script",instance:v,count:1,state:null},f.set(m,v))}}function tR(a,s){ki.M(a,s);var l=jl;if(l&&a){var f=xe(l).hoistableScripts,m=Hl(a),v=f.get(m);v||(v=l.querySelector(mu(m)),v||(a=g({src:a,async:!0,type:"module"},s),(s=la.get(m))&&Tm(a,s),v=l.createElement("script"),ce(v),$r(v,"link",a),l.head.appendChild(v)),v={type:"script",instance:v,count:1,state:null},f.set(m,v))}}function ly(a,s,l,f){var m=(m=ue.current)?jh(m):null;if(!m)throw Error(n(446));switch(a){case"meta":case"title":return null;case"style":return typeof l.precedence=="string"&&typeof l.href=="string"?(s=zl(l.href),l=xe(m).hoistableStyles,f=l.get(s),f||(f={type:"style",instance:null,count:0,state:null},l.set(s,f)),f):{type:"void",instance:null,count:0,state:null};case"link":if(l.rel==="stylesheet"&&typeof l.href=="string"&&typeof l.precedence=="string"){a=zl(l.href);var v=xe(m).hoistableStyles,I=v.get(a);if(I||(m=m.ownerDocument||m,I={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},v.set(a,I),(v=m.querySelector(pu(a)))&&!v._p&&(I.instance=v,I.state.loading=5),la.has(a)||(l={rel:"preload",as:"style",href:l.href,crossOrigin:l.crossOrigin,integrity:l.integrity,media:l.media,hrefLang:l.hrefLang,referrerPolicy:l.referrerPolicy},la.set(a,l),v||rR(m,a,l,I.state))),s&&f===null)throw Error(n(528,""));return I}if(s&&f!==null)throw Error(n(529,""));return null;case"script":return s=l.async,l=l.src,typeof l=="string"&&s&&typeof s!="function"&&typeof s!="symbol"?(s=Hl(l),l=xe(m).hoistableScripts,f=l.get(s),f||(f={type:"script",instance:null,count:0,state:null},l.set(s,f)),f):{type:"void",instance:null,count:0,state:null};default:throw Error(n(444,a))}}function zl(a){return'href="'+Er(a)+'"'}function pu(a){return'link[rel="stylesheet"]['+a+"]"}function cy(a){return g({},a,{"data-precedence":a.precedence,precedence:null})}function rR(a,s,l,f){a.querySelector('link[rel="preload"][as="style"]['+s+"]")?f.loading=1:(s=a.createElement("link"),f.preload=s,s.addEventListener("load",function(){return f.loading|=1}),s.addEventListener("error",function(){return f.loading|=2}),$r(s,"link",l),ce(s),a.head.appendChild(s))}function Hl(a){return'[src="'+Er(a)+'"]'}function mu(a){return"script[async]"+a}function uy(a,s,l){if(s.count++,s.instance===null)switch(s.type){case"style":var f=a.querySelector('style[data-href~="'+Er(l.href)+'"]');if(f)return s.instance=f,ce(f),f;var m=g({},l,{"data-href":l.href,"data-precedence":l.precedence,href:null,precedence:null});return f=(a.ownerDocument||a).createElement("style"),ce(f),$r(f,"style",m),zh(f,l.precedence,a),s.instance=f;case"stylesheet":m=zl(l.href);var v=a.querySelector(pu(m));if(v)return s.state.loading|=4,s.instance=v,ce(v),v;f=cy(l),(m=la.get(m))&&Em(f,m),v=(a.ownerDocument||a).createElement("link"),ce(v);var I=v;return I._p=new Promise(function(L,ee){I.onload=L,I.onerror=ee}),$r(v,"link",f),s.state.loading|=4,zh(v,l.precedence,a),s.instance=v;case"script":return v=Hl(l.src),(m=a.querySelector(mu(v)))?(s.instance=m,ce(m),m):(f=l,(m=la.get(v))&&(f=g({},l),Tm(f,m)),a=a.ownerDocument||a,m=a.createElement("script"),ce(m),$r(m,"link",f),a.head.appendChild(m),s.instance=m);case"void":return null;default:throw Error(n(443,s.type))}else s.type==="stylesheet"&&(s.state.loading&4)===0&&(f=s.instance,s.state.loading|=4,zh(f,l.precedence,a));return s.instance}function zh(a,s,l){for(var f=l.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),m=f.length?f[f.length-1]:null,v=m,I=0;I<f.length;I++){var L=f[I];if(L.dataset.precedence===s)v=L;else if(v!==m)break}v?v.parentNode.insertBefore(a,v.nextSibling):(s=l.nodeType===9?l.head:l,s.insertBefore(a,s.firstChild))}function Em(a,s){a.crossOrigin==null&&(a.crossOrigin=s.crossOrigin),a.referrerPolicy==null&&(a.referrerPolicy=s.referrerPolicy),a.title==null&&(a.title=s.title)}function Tm(a,s){a.crossOrigin==null&&(a.crossOrigin=s.crossOrigin),a.referrerPolicy==null&&(a.referrerPolicy=s.referrerPolicy),a.integrity==null&&(a.integrity=s.integrity)}var Hh=null;function fy(a,s,l){if(Hh===null){var f=new Map,m=Hh=new Map;m.set(l,f)}else m=Hh,f=m.get(l),f||(f=new Map,m.set(l,f));if(f.has(a))return f;for(f.set(a,null),l=l.getElementsByTagName(a),m=0;m<l.length;m++){var v=l[m];if(!(v[U]||v[hr]||a==="link"&&v.getAttribute("rel")==="stylesheet")&&v.namespaceURI!=="http://www.w3.org/2000/svg"){var I=v.getAttribute(s)||"";I=a+I;var L=f.get(I);L?L.push(v):f.set(I,[v])}}return f}function hy(a,s,l){a=a.ownerDocument||a,a.head.insertBefore(l,s==="title"?a.querySelector("head > title"):null)}function nR(a,s,l){if(l===1||s.itemProp!=null)return!1;switch(a){case"meta":case"title":return!0;case"style":if(typeof s.precedence!="string"||typeof s.href!="string"||s.href==="")break;return!0;case"link":if(typeof s.rel!="string"||typeof s.href!="string"||s.href===""||s.onLoad||s.onError)break;switch(s.rel){case"stylesheet":return a=s.disabled,typeof s.precedence=="string"&&a==null;default:return!0}case"script":if(s.async&&typeof s.async!="function"&&typeof s.async!="symbol"&&!s.onLoad&&!s.onError&&s.src&&typeof s.src=="string")return!0}return!1}function dy(a){return!(a.type==="stylesheet"&&(a.state.loading&3)===0)}var gu=null;function aR(){}function iR(a,s,l){if(gu===null)throw Error(n(475));var f=gu;if(s.type==="stylesheet"&&(typeof l.media!="string"||matchMedia(l.media).matches!==!1)&&(s.state.loading&4)===0){if(s.instance===null){var m=zl(l.href),v=a.querySelector(pu(m));if(v){a=v._p,a!==null&&typeof a=="object"&&typeof a.then=="function"&&(f.count++,f=Gh.bind(f),a.then(f,f)),s.state.loading|=4,s.instance=v,ce(v);return}v=a.ownerDocument||a,l=cy(l),(m=la.get(m))&&Em(l,m),v=v.createElement("link"),ce(v);var I=v;I._p=new Promise(function(L,ee){I.onload=L,I.onerror=ee}),$r(v,"link",l),s.instance=v}f.stylesheets===null&&(f.stylesheets=new Map),f.stylesheets.set(s,a),(a=s.state.preload)&&(s.state.loading&3)===0&&(f.count++,s=Gh.bind(f),a.addEventListener("load",s),a.addEventListener("error",s))}}function sR(){if(gu===null)throw Error(n(475));var a=gu;return a.stylesheets&&a.count===0&&Am(a,a.stylesheets),0<a.count?function(s){var l=setTimeout(function(){if(a.stylesheets&&Am(a,a.stylesheets),a.unsuspend){var f=a.unsuspend;a.unsuspend=null,f()}},6e4);return a.unsuspend=s,function(){a.unsuspend=null,clearTimeout(l)}}:null}function Gh(){if(this.count--,this.count===0){if(this.stylesheets)Am(this,this.stylesheets);else if(this.unsuspend){var a=this.unsuspend;this.unsuspend=null,a()}}}var qh=null;function Am(a,s){a.stylesheets=null,a.unsuspend!==null&&(a.count++,qh=new Map,s.forEach(oR,a),qh=null,Gh.call(a))}function oR(a,s){if(!(s.state.loading&4)){var l=qh.get(a);if(l)var f=l.get(null);else{l=new Map,qh.set(a,l);for(var m=a.querySelectorAll("link[data-precedence],style[data-precedence]"),v=0;v<m.length;v++){var I=m[v];(I.nodeName==="LINK"||I.getAttribute("media")!=="not all")&&(l.set(I.dataset.precedence,I),f=I)}f&&l.set(null,f)}m=s.instance,I=m.getAttribute("data-precedence"),v=l.get(I)||f,v===f&&l.set(null,m),l.set(I,m),this.count++,f=Gh.bind(this),m.addEventListener("load",f),m.addEventListener("error",f),v?v.parentNode.insertBefore(m,v.nextSibling):(a=a.nodeType===9?a.head:a,a.insertBefore(m,a.firstChild)),s.state.loading|=4}}var vu={$$typeof:N,Provider:null,Consumer:null,_currentValue:Oe,_currentValue2:Oe,_threadCount:0};function lR(a,s,l,f,m,v,I,L){this.tag=1,this.containerInfo=a,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=_a(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=_a(0),this.hiddenUpdates=_a(null),this.identifierPrefix=f,this.onUncaughtError=m,this.onCaughtError=v,this.onRecoverableError=I,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=L,this.incompleteTransitions=new Map}function py(a,s,l,f,m,v,I,L,ee,pe,Ae,ke){return a=new lR(a,s,l,I,L,ee,pe,ke),s=1,v===!0&&(s|=24),v=Un(3,null,null,s),a.current=v,v.stateNode=a,s=ap(),s.refCount++,a.pooledCache=s,s.refCount++,v.memoizedState={element:f,isDehydrated:l,cache:s},lp(v),a}function my(a){return a?(a=yl,a):yl}function gy(a,s,l,f,m,v){m=my(m),f.context===null?f.context=m:f.pendingContext=m,f=Ji(s),f.payload={element:l},v=v===void 0?null:v,v!==null&&(f.callback=v),l=es(a,f,s),l!==null&&(Gn(l,a,s),Wc(l,a,s))}function vy(a,s){if(a=a.memoizedState,a!==null&&a.dehydrated!==null){var l=a.retryLane;a.retryLane=l!==0&&l<s?l:s}}function wm(a,s){vy(a,s),(a=a.alternate)&&vy(a,s)}function _y(a){if(a.tag===13){var s=xl(a,67108864);s!==null&&Gn(s,a,67108864),wm(a,67108864)}}var Kh=!0;function cR(a,s,l,f){var m=ae.T;ae.T=null;var v=oe.p;try{oe.p=2,Sm(a,s,l,f)}finally{oe.p=v,ae.T=m}}function uR(a,s,l,f){var m=ae.T;ae.T=null;var v=oe.p;try{oe.p=8,Sm(a,s,l,f)}finally{oe.p=v,ae.T=m}}function Sm(a,s,l,f){if(Kh){var m=Cm(f);if(m===null)hm(a,s,f,Wh,l),yy(a,f);else if(hR(m,a,s,l,f))f.stopPropagation();else if(yy(a,f),s&4&&-1<fR.indexOf(a)){for(;m!==null;){var v=Y(m);if(v!==null)switch(v.tag){case 3:if(v=v.stateNode,v.current.memoizedState.isDehydrated){var I=Cn(v.pendingLanes);if(I!==0){var L=v;for(L.pendingLanes|=2,L.entangledLanes|=2;I;){var ee=1<<31-Lt(I);L.entanglements[1]|=ee,I&=~ee}$a(v),(zt&6)===0&&(Ih=Pe()+500,uu(0))}}break;case 13:L=xl(v,2),L!==null&&Gn(L,v,2),Oh(),wm(v,2)}if(v=Cm(f),v===null&&hm(a,s,f,Wh,l),v===m)break;m=v}m!==null&&f.stopPropagation()}else hm(a,s,f,null,l)}}function Cm(a){return a=Jn(a),Rm(a)}var Wh=null;function Rm(a){if(Wh=null,a=q(a),a!==null){var s=o(a);if(s===null)a=null;else{var l=s.tag;if(l===13){if(a=c(s),a!==null)return a;a=null}else if(l===3){if(s.stateNode.current.memoizedState.isDehydrated)return s.tag===3?s.stateNode.containerInfo:null;a=null}else s!==a&&(a=null)}}return Wh=a,null}function xy(a){switch(a){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Ye()){case ut:return 2;case _t:return 8;case rr:case yr:return 32;case fr:return 268435456;default:return 32}default:return 32}}var km=!1,ds=null,ps=null,ms=null,_u=new Map,xu=new Map,gs=[],fR="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function yy(a,s){switch(a){case"focusin":case"focusout":ds=null;break;case"dragenter":case"dragleave":ps=null;break;case"mouseover":case"mouseout":ms=null;break;case"pointerover":case"pointerout":_u.delete(s.pointerId);break;case"gotpointercapture":case"lostpointercapture":xu.delete(s.pointerId)}}function yu(a,s,l,f,m,v){return a===null||a.nativeEvent!==v?(a={blockedOn:s,domEventName:l,eventSystemFlags:f,nativeEvent:v,targetContainers:[m]},s!==null&&(s=Y(s),s!==null&&_y(s)),a):(a.eventSystemFlags|=f,s=a.targetContainers,m!==null&&s.indexOf(m)===-1&&s.push(m),a)}function hR(a,s,l,f,m){switch(s){case"focusin":return ds=yu(ds,a,s,l,f,m),!0;case"dragenter":return ps=yu(ps,a,s,l,f,m),!0;case"mouseover":return ms=yu(ms,a,s,l,f,m),!0;case"pointerover":var v=m.pointerId;return _u.set(v,yu(_u.get(v)||null,a,s,l,f,m)),!0;case"gotpointercapture":return v=m.pointerId,xu.set(v,yu(xu.get(v)||null,a,s,l,f,m)),!0}return!1}function Ey(a){var s=q(a.target);if(s!==null){var l=o(s);if(l!==null){if(s=l.tag,s===13){if(s=c(l),s!==null){a.blockedOn=s,al(a.priority,function(){if(l.tag===13){var f=Hn();f=Pa(f);var m=xl(l,f);m!==null&&Gn(m,l,f),wm(l,f)}});return}}else if(s===3&&l.stateNode.current.memoizedState.isDehydrated){a.blockedOn=l.tag===3?l.stateNode.containerInfo:null;return}}}a.blockedOn=null}function Xh(a){if(a.blockedOn!==null)return!1;for(var s=a.targetContainers;0<s.length;){var l=Cm(a.nativeEvent);if(l===null){l=a.nativeEvent;var f=new l.constructor(l.type,l);ui=f,l.target.dispatchEvent(f),ui=null}else return s=Y(l),s!==null&&_y(s),a.blockedOn=l,!1;s.shift()}return!0}function Ty(a,s,l){Xh(a)&&l.delete(s)}function dR(){km=!1,ds!==null&&Xh(ds)&&(ds=null),ps!==null&&Xh(ps)&&(ps=null),ms!==null&&Xh(ms)&&(ms=null),_u.forEach(Ty),xu.forEach(Ty)}function Yh(a,s){a.blockedOn===s&&(a.blockedOn=null,km||(km=!0,t.unstable_scheduleCallback(t.unstable_NormalPriority,dR)))}var $h=null;function Ay(a){$h!==a&&($h=a,t.unstable_scheduleCallback(t.unstable_NormalPriority,function(){$h===a&&($h=null);for(var s=0;s<a.length;s+=3){var l=a[s],f=a[s+1],m=a[s+2];if(typeof f!="function"){if(Rm(f||l)===null)continue;break}var v=Y(l);v!==null&&(a.splice(s,3),s-=3,Rp(v,{pending:!0,data:m,method:l.method,action:f},f,m))}}))}function Eu(a){function s(ee){return Yh(ee,a)}ds!==null&&Yh(ds,a),ps!==null&&Yh(ps,a),ms!==null&&Yh(ms,a),_u.forEach(s),xu.forEach(s);for(var l=0;l<gs.length;l++){var f=gs[l];f.blockedOn===a&&(f.blockedOn=null)}for(;0<gs.length&&(l=gs[0],l.blockedOn===null);)Ey(l),l.blockedOn===null&&gs.shift();if(l=(a.ownerDocument||a).$$reactFormReplay,l!=null)for(f=0;f<l.length;f+=3){var m=l[f],v=l[f+1],I=m[nr]||null;if(typeof v=="function")I||Ay(l);else if(I){var L=null;if(v&&v.hasAttribute("formAction")){if(m=v,I=v[nr]||null)L=I.formAction;else if(Rm(m)!==null)continue}else L=I.action;typeof L=="function"?l[f+1]=L:(l.splice(f,3),f-=3),Ay(l)}}}function bm(a){this._internalRoot=a}Qh.prototype.render=bm.prototype.render=function(a){var s=this._internalRoot;if(s===null)throw Error(n(409));var l=s.current,f=Hn();gy(l,f,a,s,null,null)},Qh.prototype.unmount=bm.prototype.unmount=function(){var a=this._internalRoot;if(a!==null){this._internalRoot=null;var s=a.containerInfo;gy(a.current,2,null,a,null,null),Oh(),s[Rn]=null}};function Qh(a){this._internalRoot=a}Qh.prototype.unstable_scheduleHydration=function(a){if(a){var s=Ma();a={blockedOn:null,target:a,priority:s};for(var l=0;l<gs.length&&s!==0&&s<gs[l].priority;l++);gs.splice(l,0,a),l===0&&Ey(a)}};var wy=e.version;if(wy!=="19.1.0")throw Error(n(527,wy,"19.1.0"));oe.findDOMNode=function(a){var s=a._reactInternals;if(s===void 0)throw typeof a.render=="function"?Error(n(188)):(a=Object.keys(a).join(","),Error(n(268,a)));return a=h(s),a=a!==null?d(a):null,a=a===null?null:a.stateNode,a};var pR={bundleType:0,version:"19.1.0",rendererPackageName:"react-dom",currentDispatcherRef:ae,reconcilerVersion:"19.1.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Zh=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Zh.isDisabled&&Zh.supportsFiber)try{Ze=Zh.inject(pR),Je=Zh}catch{}}return Au.createRoot=function(a,s){if(!i(a))throw Error(n(299));var l=!1,f="",m=B_,v=j_,I=z_,L=null;return s!=null&&(s.unstable_strictMode===!0&&(l=!0),s.identifierPrefix!==void 0&&(f=s.identifierPrefix),s.onUncaughtError!==void 0&&(m=s.onUncaughtError),s.onCaughtError!==void 0&&(v=s.onCaughtError),s.onRecoverableError!==void 0&&(I=s.onRecoverableError),s.unstable_transitionCallbacks!==void 0&&(L=s.unstable_transitionCallbacks)),s=py(a,1,!1,null,null,l,f,m,v,I,L,null),a[Rn]=s.current,fm(a),new bm(s)},Au.hydrateRoot=function(a,s,l){if(!i(a))throw Error(n(299));var f=!1,m="",v=B_,I=j_,L=z_,ee=null,pe=null;return l!=null&&(l.unstable_strictMode===!0&&(f=!0),l.identifierPrefix!==void 0&&(m=l.identifierPrefix),l.onUncaughtError!==void 0&&(v=l.onUncaughtError),l.onCaughtError!==void 0&&(I=l.onCaughtError),l.onRecoverableError!==void 0&&(L=l.onRecoverableError),l.unstable_transitionCallbacks!==void 0&&(ee=l.unstable_transitionCallbacks),l.formState!==void 0&&(pe=l.formState)),s=py(a,1,!0,s,l??null,f,m,v,I,L,ee,pe),s.context=my(null),l=s.current,f=Hn(),f=Pa(f),m=Ji(f),m.callback=null,es(l,m,f),l=f,s.current.lanes=l,xa(s,l),$a(s),a[Rn]=s.current,fm(a),new Qh(s)},Au.version="19.1.0",Au}var Fy;function SR(){if(Fy)return Om.exports;Fy=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}return t(),Om.exports=wR(),Om.exports}var CR=SR();const RR=Gg(CR);w2();/**
 * @remix-run/router v1.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Qu(){return Qu=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Qu.apply(this,arguments)}var Ss;(function(t){t.Pop="POP",t.Push="PUSH",t.Replace="REPLACE"})(Ss||(Ss={}));const Py="popstate";function kR(t){t===void 0&&(t={});function e(i,o){let{pathname:c="/",search:u="",hash:h=""}=qo(i.location.hash.substr(1));return!c.startsWith("/")&&!c.startsWith(".")&&(c="/"+c),ag("",{pathname:c,search:u,hash:h},o.state&&o.state.usr||null,o.state&&o.state.key||"default")}function r(i,o){let c=i.document.querySelector("base"),u="";if(c&&c.getAttribute("href")){let h=i.location.href,d=h.indexOf("#");u=d===-1?h:h.slice(0,d)}return u+"#"+(typeof o=="string"?o:C0(o))}function n(i,o){Kg(i.pathname.charAt(0)==="/","relative pathnames are not supported in hash history.push("+JSON.stringify(o)+")")}return IR(e,r,n,t)}function xr(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function Kg(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function bR(){return Math.random().toString(36).substr(2,8)}function My(t,e){return{usr:t.state,key:t.key,idx:e}}function ag(t,e,r,n){return r===void 0&&(r=null),Qu({pathname:typeof t=="string"?t:t.pathname,search:"",hash:""},typeof e=="string"?qo(e):e,{state:r,key:e&&e.key||n||bR()})}function C0(t){let{pathname:e="/",search:r="",hash:n=""}=t;return r&&r!=="?"&&(e+=r.charAt(0)==="?"?r:"?"+r),n&&n!=="#"&&(e+=n.charAt(0)==="#"?n:"#"+n),e}function qo(t){let e={};if(t){let r=t.indexOf("#");r>=0&&(e.hash=t.substr(r),t=t.substr(0,r));let n=t.indexOf("?");n>=0&&(e.search=t.substr(n),t=t.substr(0,n)),t&&(e.pathname=t)}return e}function IR(t,e,r,n){n===void 0&&(n={});let{window:i=document.defaultView,v5Compat:o=!1}=n,c=i.history,u=Ss.Pop,h=null,d=g();d==null&&(d=0,c.replaceState(Qu({},c.state,{idx:d}),""));function g(){return(c.state||{idx:null}).idx}function _(){u=Ss.Pop;let w=g(),B=w==null?null:w-d;d=w,h&&h({action:u,location:R.location,delta:B})}function x(w,B){u=Ss.Push;let H=ag(R.location,w,B);r&&r(H,w),d=g()+1;let N=My(H,d),J=R.createHref(H);try{c.pushState(N,"",J)}catch(re){if(re instanceof DOMException&&re.name==="DataCloneError")throw re;i.location.assign(J)}o&&h&&h({action:u,location:R.location,delta:1})}function A(w,B){u=Ss.Replace;let H=ag(R.location,w,B);r&&r(H,w),d=g();let N=My(H,d),J=R.createHref(H);c.replaceState(N,"",J),o&&h&&h({action:u,location:R.location,delta:0})}function S(w){let B=i.location.origin!=="null"?i.location.origin:i.location.href,H=typeof w=="string"?w:C0(w);return H=H.replace(/ $/,"%20"),xr(B,"No window.location.(origin|href) available to create URL for href: "+H),new URL(H,B)}let R={get action(){return u},get location(){return t(i,c)},listen(w){if(h)throw new Error("A history only accepts one active listener");return i.addEventListener(Py,_),h=w,()=>{i.removeEventListener(Py,_),h=null}},createHref(w){return e(i,w)},createURL:S,encodeLocation(w){let B=S(w);return{pathname:B.pathname,search:B.search,hash:B.hash}},push:x,replace:A,go(w){return c.go(w)}};return R}var Ly;(function(t){t.data="data",t.deferred="deferred",t.redirect="redirect",t.error="error"})(Ly||(Ly={}));function DR(t,e,r){return r===void 0&&(r="/"),OR(t,e,r)}function OR(t,e,r,n){let i=typeof e=="string"?qo(e):e,o=Wg(i.pathname||"/",r);if(o==null)return null;let c=S2(t);NR(c);let u=null;for(let h=0;u==null&&h<c.length;++h){let d=qR(o);u=zR(c[h],d)}return u}function S2(t,e,r,n){e===void 0&&(e=[]),r===void 0&&(r=[]),n===void 0&&(n="");let i=(o,c,u)=>{let h={relativePath:u===void 0?o.path||"":u,caseSensitive:o.caseSensitive===!0,childrenIndex:c,route:o};h.relativePath.startsWith("/")&&(xr(h.relativePath.startsWith(n),'Absolute route path "'+h.relativePath+'" nested under path '+('"'+n+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),h.relativePath=h.relativePath.slice(n.length));let d=bs([n,h.relativePath]),g=r.concat(h);o.children&&o.children.length>0&&(xr(o.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+d+'".')),S2(o.children,e,g,d)),!(o.path==null&&!o.index)&&e.push({path:d,score:BR(d,o.index),routesMeta:g})};return t.forEach((o,c)=>{var u;if(o.path===""||!((u=o.path)!=null&&u.includes("?")))i(o,c);else for(let h of C2(o.path))i(o,c,h)}),e}function C2(t){let e=t.split("/");if(e.length===0)return[];let[r,...n]=e,i=r.endsWith("?"),o=r.replace(/\?$/,"");if(n.length===0)return i?[o,""]:[o];let c=C2(n.join("/")),u=[];return u.push(...c.map(h=>h===""?o:[o,h].join("/"))),i&&u.push(...c),u.map(h=>t.startsWith("/")&&h===""?"/":h)}function NR(t){t.sort((e,r)=>e.score!==r.score?r.score-e.score:jR(e.routesMeta.map(n=>n.childrenIndex),r.routesMeta.map(n=>n.childrenIndex)))}const FR=/^:[\w-]+$/,PR=3,MR=2,LR=1,VR=10,UR=-2,Vy=t=>t==="*";function BR(t,e){let r=t.split("/"),n=r.length;return r.some(Vy)&&(n+=UR),e&&(n+=MR),r.filter(i=>!Vy(i)).reduce((i,o)=>i+(FR.test(o)?PR:o===""?LR:VR),n)}function jR(t,e){return t.length===e.length&&t.slice(0,-1).every((n,i)=>n===e[i])?t[t.length-1]-e[e.length-1]:0}function zR(t,e,r){let{routesMeta:n}=t,i={},o="/",c=[];for(let u=0;u<n.length;++u){let h=n[u],d=u===n.length-1,g=o==="/"?e:e.slice(o.length)||"/",_=HR({path:h.relativePath,caseSensitive:h.caseSensitive,end:d},g),x=h.route;if(!_)return null;Object.assign(i,_.params),c.push({params:i,pathname:bs([o,_.pathname]),pathnameBase:YR(bs([o,_.pathnameBase])),route:x}),_.pathnameBase!=="/"&&(o=bs([o,_.pathnameBase]))}return c}function HR(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[r,n]=GR(t.path,t.caseSensitive,t.end),i=e.match(r);if(!i)return null;let o=i[0],c=o.replace(/(.)\/+$/,"$1"),u=i.slice(1);return{params:n.reduce((d,g,_)=>{let{paramName:x,isOptional:A}=g;if(x==="*"){let R=u[_]||"";c=o.slice(0,o.length-R.length).replace(/(.)\/+$/,"$1")}const S=u[_];return A&&!S?d[x]=void 0:d[x]=(S||"").replace(/%2F/g,"/"),d},{}),pathname:o,pathnameBase:c,pattern:t}}function GR(t,e,r){e===void 0&&(e=!1),r===void 0&&(r=!0),Kg(t==="*"||!t.endsWith("*")||t.endsWith("/*"),'Route path "'+t+'" will be treated as if it were '+('"'+t.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+t.replace(/\*$/,"/*")+'".'));let n=[],i="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(c,u,h)=>(n.push({paramName:u,isOptional:h!=null}),h?"/?([^\\/]+)?":"/([^\\/]+)"));return t.endsWith("*")?(n.push({paramName:"*"}),i+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?i+="\\/*$":t!==""&&t!=="/"&&(i+="(?:(?=\\/|$))"),[new RegExp(i,e?void 0:"i"),n]}function qR(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return Kg(!1,'The URL path "'+t+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),t}}function Wg(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let r=e.endsWith("/")?e.length-1:e.length,n=t.charAt(r);return n&&n!=="/"?null:t.slice(r)||"/"}function KR(t,e){e===void 0&&(e="/");let{pathname:r,search:n="",hash:i=""}=typeof t=="string"?qo(t):t;return{pathname:r?r.startsWith("/")?r:WR(r,e):e,search:$R(n),hash:QR(i)}}function WR(t,e){let r=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(i=>{i===".."?r.length>1&&r.pop():i!=="."&&r.push(i)}),r.length>1?r.join("/"):"/"}function Mm(t,e,r,n){return"Cannot include a '"+t+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(n)+"].  Please separate it out to the ")+("`to."+r+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function XR(t){return t.filter((e,r)=>r===0||e.route.path&&e.route.path.length>0)}function Xg(t,e){let r=XR(t);return e?r.map((n,i)=>i===r.length-1?n.pathname:n.pathnameBase):r.map(n=>n.pathnameBase)}function Yg(t,e,r,n){n===void 0&&(n=!1);let i;typeof t=="string"?i=qo(t):(i=Qu({},t),xr(!i.pathname||!i.pathname.includes("?"),Mm("?","pathname","search",i)),xr(!i.pathname||!i.pathname.includes("#"),Mm("#","pathname","hash",i)),xr(!i.search||!i.search.includes("#"),Mm("#","search","hash",i)));let o=t===""||i.pathname==="",c=o?"/":i.pathname,u;if(c==null)u=r;else{let _=e.length-1;if(!n&&c.startsWith("..")){let x=c.split("/");for(;x[0]==="..";)x.shift(),_-=1;i.pathname=x.join("/")}u=_>=0?e[_]:"/"}let h=KR(i,u),d=c&&c!=="/"&&c.endsWith("/"),g=(o||c===".")&&r.endsWith("/");return!h.pathname.endsWith("/")&&(d||g)&&(h.pathname+="/"),h}const bs=t=>t.join("/").replace(/\/\/+/g,"/"),YR=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),$R=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,QR=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function ZR(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}const R2=["post","put","patch","delete"];new Set(R2);const JR=["get",...R2];new Set(JR);/**
 * React Router v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Zu(){return Zu=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Zu.apply(this,arguments)}const $g=Ie.createContext(null),ek=Ie.createContext(null),Xs=Ie.createContext(null),ad=Ie.createContext(null),Ys=Ie.createContext({outlet:null,matches:[],isDataRoute:!1}),k2=Ie.createContext(null);function tk(t,e){let{relative:r}=e===void 0?{}:e;pc()||xr(!1);let{basename:n,navigator:i}=Ie.useContext(Xs),{hash:o,pathname:c,search:u}=I2(t,{relative:r}),h=c;return n!=="/"&&(h=c==="/"?n:bs([n,c])),i.createHref({pathname:h,search:u,hash:o})}function pc(){return Ie.useContext(ad)!=null}function _f(){return pc()||xr(!1),Ie.useContext(ad).location}function b2(t){Ie.useContext(Xs).static||Ie.useLayoutEffect(t)}function Qg(){let{isDataRoute:t}=Ie.useContext(Ys);return t?pk():rk()}function rk(){pc()||xr(!1);let t=Ie.useContext($g),{basename:e,future:r,navigator:n}=Ie.useContext(Xs),{matches:i}=Ie.useContext(Ys),{pathname:o}=_f(),c=JSON.stringify(Xg(i,r.v7_relativeSplatPath)),u=Ie.useRef(!1);return b2(()=>{u.current=!0}),Ie.useCallback(function(d,g){if(g===void 0&&(g={}),!u.current)return;if(typeof d=="number"){n.go(d);return}let _=Yg(d,JSON.parse(c),o,g.relative==="path");t==null&&e!=="/"&&(_.pathname=_.pathname==="/"?e:bs([e,_.pathname])),(g.replace?n.replace:n.push)(_,g.state,g)},[e,n,c,o,t])}function I2(t,e){let{relative:r}=e===void 0?{}:e,{future:n}=Ie.useContext(Xs),{matches:i}=Ie.useContext(Ys),{pathname:o}=_f(),c=JSON.stringify(Xg(i,n.v7_relativeSplatPath));return Ie.useMemo(()=>Yg(t,JSON.parse(c),o,r==="path"),[t,c,o,r])}function nk(t,e){return ak(t,e)}function ak(t,e,r,n){pc()||xr(!1);let{navigator:i}=Ie.useContext(Xs),{matches:o}=Ie.useContext(Ys),c=o[o.length-1],u=c?c.params:{};c&&c.pathname;let h=c?c.pathnameBase:"/";c&&c.route;let d=_f(),g;if(e){var _;let w=typeof e=="string"?qo(e):e;h==="/"||(_=w.pathname)!=null&&_.startsWith(h)||xr(!1),g=w}else g=d;let x=g.pathname||"/",A=x;if(h!=="/"){let w=h.replace(/^\//,"").split("/");A="/"+x.replace(/^\//,"").split("/").slice(w.length).join("/")}let S=DR(t,{pathname:A}),R=ck(S&&S.map(w=>Object.assign({},w,{params:Object.assign({},u,w.params),pathname:bs([h,i.encodeLocation?i.encodeLocation(w.pathname).pathname:w.pathname]),pathnameBase:w.pathnameBase==="/"?h:bs([h,i.encodeLocation?i.encodeLocation(w.pathnameBase).pathname:w.pathnameBase])})),o,r,n);return e&&R?Ie.createElement(ad.Provider,{value:{location:Zu({pathname:"/",search:"",hash:"",state:null,key:"default"},g),navigationType:Ss.Pop}},R):R}function ik(){let t=dk(),e=ZR(t)?t.status+" "+t.statusText:t instanceof Error?t.message:JSON.stringify(t),r=t instanceof Error?t.stack:null,i={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return Ie.createElement(Ie.Fragment,null,Ie.createElement("h2",null,"Unexpected Application Error!"),Ie.createElement("h3",{style:{fontStyle:"italic"}},e),r?Ie.createElement("pre",{style:i},r):null,null)}const sk=Ie.createElement(ik,null);class ok extends Ie.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,r){return r.location!==e.location||r.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:r.error,location:r.location,revalidation:e.revalidation||r.revalidation}}componentDidCatch(e,r){console.error("React Router caught the following error during render",e,r)}render(){return this.state.error!==void 0?Ie.createElement(Ys.Provider,{value:this.props.routeContext},Ie.createElement(k2.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function lk(t){let{routeContext:e,match:r,children:n}=t,i=Ie.useContext($g);return i&&i.static&&i.staticContext&&(r.route.errorElement||r.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=r.route.id),Ie.createElement(Ys.Provider,{value:e},n)}function ck(t,e,r,n){var i;if(e===void 0&&(e=[]),r===void 0&&(r=null),n===void 0&&(n=null),t==null){var o;if(!r)return null;if(r.errors)t=r.matches;else if((o=n)!=null&&o.v7_partialHydration&&e.length===0&&!r.initialized&&r.matches.length>0)t=r.matches;else return null}let c=t,u=(i=r)==null?void 0:i.errors;if(u!=null){let g=c.findIndex(_=>_.route.id&&u?.[_.route.id]!==void 0);g>=0||xr(!1),c=c.slice(0,Math.min(c.length,g+1))}let h=!1,d=-1;if(r&&n&&n.v7_partialHydration)for(let g=0;g<c.length;g++){let _=c[g];if((_.route.HydrateFallback||_.route.hydrateFallbackElement)&&(d=g),_.route.id){let{loaderData:x,errors:A}=r,S=_.route.loader&&x[_.route.id]===void 0&&(!A||A[_.route.id]===void 0);if(_.route.lazy||S){h=!0,d>=0?c=c.slice(0,d+1):c=[c[0]];break}}}return c.reduceRight((g,_,x)=>{let A,S=!1,R=null,w=null;r&&(A=u&&_.route.id?u[_.route.id]:void 0,R=_.route.errorElement||sk,h&&(d<0&&x===0?(mk("route-fallback"),S=!0,w=null):d===x&&(S=!0,w=_.route.hydrateFallbackElement||null)));let B=e.concat(c.slice(0,x+1)),H=()=>{let N;return A?N=R:S?N=w:_.route.Component?N=Ie.createElement(_.route.Component,null):_.route.element?N=_.route.element:N=g,Ie.createElement(lk,{match:_,routeContext:{outlet:g,matches:B,isDataRoute:r!=null},children:N})};return r&&(_.route.ErrorBoundary||_.route.errorElement||x===0)?Ie.createElement(ok,{location:r.location,revalidation:r.revalidation,component:R,error:A,children:H(),routeContext:{outlet:null,matches:B,isDataRoute:!0}}):H()},null)}var D2=function(t){return t.UseBlocker="useBlocker",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t}(D2||{}),O2=function(t){return t.UseBlocker="useBlocker",t.UseLoaderData="useLoaderData",t.UseActionData="useActionData",t.UseRouteError="useRouteError",t.UseNavigation="useNavigation",t.UseRouteLoaderData="useRouteLoaderData",t.UseMatches="useMatches",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t.UseRouteId="useRouteId",t}(O2||{});function uk(t){let e=Ie.useContext($g);return e||xr(!1),e}function fk(t){let e=Ie.useContext(ek);return e||xr(!1),e}function hk(t){let e=Ie.useContext(Ys);return e||xr(!1),e}function N2(t){let e=hk(),r=e.matches[e.matches.length-1];return r.route.id||xr(!1),r.route.id}function dk(){var t;let e=Ie.useContext(k2),r=fk(),n=N2();return e!==void 0?e:(t=r.errors)==null?void 0:t[n]}function pk(){let{router:t}=uk(D2.UseNavigateStable),e=N2(O2.UseNavigateStable),r=Ie.useRef(!1);return b2(()=>{r.current=!0}),Ie.useCallback(function(i,o){o===void 0&&(o={}),r.current&&(typeof i=="number"?t.navigate(i):t.navigate(i,Zu({fromRouteId:e},o)))},[t,e])}const Uy={};function mk(t,e,r){Uy[t]||(Uy[t]=!0)}function gk(t,e){t?.v7_startTransition,t?.v7_relativeSplatPath}function F2(t){let{to:e,replace:r,state:n,relative:i}=t;pc()||xr(!1);let{future:o,static:c}=Ie.useContext(Xs),{matches:u}=Ie.useContext(Ys),{pathname:h}=_f(),d=Qg(),g=Yg(e,Xg(u,o.v7_relativeSplatPath),h,i==="path"),_=JSON.stringify(g);return Ie.useEffect(()=>d(JSON.parse(_),{replace:r,state:n,relative:i}),[d,_,i,r,n]),null}function ys(t){xr(!1)}function vk(t){let{basename:e="/",children:r=null,location:n,navigationType:i=Ss.Pop,navigator:o,static:c=!1,future:u}=t;pc()&&xr(!1);let h=e.replace(/^\/*/,"/"),d=Ie.useMemo(()=>({basename:h,navigator:o,static:c,future:Zu({v7_relativeSplatPath:!1},u)}),[h,u,o,c]);typeof n=="string"&&(n=qo(n));let{pathname:g="/",search:_="",hash:x="",state:A=null,key:S="default"}=n,R=Ie.useMemo(()=>{let w=Wg(g,h);return w==null?null:{location:{pathname:w,search:_,hash:x,state:A,key:S},navigationType:i}},[h,g,_,x,A,S,i]);return R==null?null:Ie.createElement(Xs.Provider,{value:d},Ie.createElement(ad.Provider,{children:r,value:R}))}function _k(t){let{children:e,location:r}=t;return nk(ig(e),r)}new Promise(()=>{});function ig(t,e){e===void 0&&(e=[]);let r=[];return Ie.Children.forEach(t,(n,i)=>{if(!Ie.isValidElement(n))return;let o=[...e,i];if(n.type===Ie.Fragment){r.push.apply(r,ig(n.props.children,o));return}n.type!==ys&&xr(!1),!n.props.index||!n.props.children||xr(!1);let c={id:n.props.id||o.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,loader:n.props.loader,action:n.props.action,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(c.children=ig(n.props.children,o)),r.push(c)}),r}/**
 * React Router DOM v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function sg(){return sg=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},sg.apply(this,arguments)}function xk(t,e){if(t==null)return{};var r={},n=Object.keys(t),i,o;for(o=0;o<n.length;o++)i=n[o],!(e.indexOf(i)>=0)&&(r[i]=t[i]);return r}function yk(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function Ek(t,e){return t.button===0&&(!e||e==="_self")&&!yk(t)}const Tk=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],Ak="6";try{window.__reactRouterVersion=Ak}catch{}const wk="startTransition",By=yR[wk];function Sk(t){let{basename:e,children:r,future:n,window:i}=t,o=Ie.useRef();o.current==null&&(o.current=kR({window:i,v5Compat:!0}));let c=o.current,[u,h]=Ie.useState({action:c.action,location:c.location}),{v7_startTransition:d}=n||{},g=Ie.useCallback(_=>{d&&By?By(()=>h(_)):h(_)},[h,d]);return Ie.useLayoutEffect(()=>c.listen(g),[c,g]),Ie.useEffect(()=>gk(n),[n]),Ie.createElement(vk,{basename:e,children:r,location:u.location,navigationType:u.action,navigator:c,future:n})}const Ck=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",Rk=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,ko=Ie.forwardRef(function(e,r){let{onClick:n,relative:i,reloadDocument:o,replace:c,state:u,target:h,to:d,preventScrollReset:g,viewTransition:_}=e,x=xk(e,Tk),{basename:A}=Ie.useContext(Xs),S,R=!1;if(typeof d=="string"&&Rk.test(d)&&(S=d,Ck))try{let N=new URL(window.location.href),J=d.startsWith("//")?new URL(N.protocol+d):new URL(d),re=Wg(J.pathname,A);J.origin===N.origin&&re!=null?d=re+J.search+J.hash:R=!0}catch{}let w=tk(d,{relative:i}),B=kk(d,{replace:c,state:u,target:h,preventScrollReset:g,relative:i,viewTransition:_});function H(N){n&&n(N),N.defaultPrevented||B(N)}return Ie.createElement("a",sg({},x,{href:S||w,onClick:R||o?n:H,ref:r,target:h}))});var jy;(function(t){t.UseScrollRestoration="useScrollRestoration",t.UseSubmit="useSubmit",t.UseSubmitFetcher="useSubmitFetcher",t.UseFetcher="useFetcher",t.useViewTransitionState="useViewTransitionState"})(jy||(jy={}));var zy;(function(t){t.UseFetcher="useFetcher",t.UseFetchers="useFetchers",t.UseScrollRestoration="useScrollRestoration"})(zy||(zy={}));function kk(t,e){let{target:r,replace:n,state:i,preventScrollReset:o,relative:c,viewTransition:u}=e===void 0?{}:e,h=Qg(),d=_f(),g=I2(t,{relative:c});return Ie.useCallback(_=>{if(Ek(_,r)){_.preventDefault();let x=n!==void 0?n:C0(d)===C0(g);h(t,{replace:x,state:i,preventScrollReset:o,relative:c,viewTransition:u})}},[d,h,g,n,i,r,t,o,c,u])}const bk=()=>{};var Hy={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const P2=function(t){const e=[];let r=0;for(let n=0;n<t.length;n++){let i=t.charCodeAt(n);i<128?e[r++]=i:i<2048?(e[r++]=i>>6|192,e[r++]=i&63|128):(i&64512)===55296&&n+1<t.length&&(t.charCodeAt(n+1)&64512)===56320?(i=65536+((i&1023)<<10)+(t.charCodeAt(++n)&1023),e[r++]=i>>18|240,e[r++]=i>>12&63|128,e[r++]=i>>6&63|128,e[r++]=i&63|128):(e[r++]=i>>12|224,e[r++]=i>>6&63|128,e[r++]=i&63|128)}return e},Ik=function(t){const e=[];let r=0,n=0;for(;r<t.length;){const i=t[r++];if(i<128)e[n++]=String.fromCharCode(i);else if(i>191&&i<224){const o=t[r++];e[n++]=String.fromCharCode((i&31)<<6|o&63)}else if(i>239&&i<365){const o=t[r++],c=t[r++],u=t[r++],h=((i&7)<<18|(o&63)<<12|(c&63)<<6|u&63)-65536;e[n++]=String.fromCharCode(55296+(h>>10)),e[n++]=String.fromCharCode(56320+(h&1023))}else{const o=t[r++],c=t[r++];e[n++]=String.fromCharCode((i&15)<<12|(o&63)<<6|c&63)}}return e.join("")},M2={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const r=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,n=[];for(let i=0;i<t.length;i+=3){const o=t[i],c=i+1<t.length,u=c?t[i+1]:0,h=i+2<t.length,d=h?t[i+2]:0,g=o>>2,_=(o&3)<<4|u>>4;let x=(u&15)<<2|d>>6,A=d&63;h||(A=64,c||(x=64)),n.push(r[g],r[_],r[x],r[A])}return n.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(P2(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):Ik(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const r=e?this.charToByteMapWebSafe_:this.charToByteMap_,n=[];for(let i=0;i<t.length;){const o=r[t.charAt(i++)],u=i<t.length?r[t.charAt(i)]:0;++i;const d=i<t.length?r[t.charAt(i)]:64;++i;const _=i<t.length?r[t.charAt(i)]:64;if(++i,o==null||u==null||d==null||_==null)throw new Dk;const x=o<<2|u>>4;if(n.push(x),d!==64){const A=u<<4&240|d>>2;if(n.push(A),_!==64){const S=d<<6&192|_;n.push(S)}}}return n},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class Dk extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const Ok=function(t){const e=P2(t);return M2.encodeByteArray(e,!0)},R0=function(t){return Ok(t).replace(/\./g,"")},L2=function(t){try{return M2.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Nk(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fk=()=>Nk().__FIREBASE_DEFAULTS__,Pk=()=>{if(typeof process>"u"||typeof Hy>"u")return;const t=Hy.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},Mk=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&L2(t[1]);return e&&JSON.parse(e)},id=()=>{try{return bk()||Fk()||Pk()||Mk()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},V2=t=>{var e,r;return(r=(e=id())===null||e===void 0?void 0:e.emulatorHosts)===null||r===void 0?void 0:r[t]},Lk=t=>{const e=V2(t);if(!e)return;const r=e.lastIndexOf(":");if(r<=0||r+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const n=parseInt(e.substring(r+1),10);return e[0]==="["?[e.substring(1,r-1),n]:[e.substring(0,r),n]},U2=()=>{var t;return(t=id())===null||t===void 0?void 0:t.config},B2=t=>{var e;return(e=id())===null||e===void 0?void 0:e[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vk{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,r)=>{this.resolve=e,this.reject=r})}wrapCallback(e){return(r,n)=>{r?this.reject(r):this.resolve(n),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(r):e(r,n))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mc(t){try{return(t.startsWith("http://")||t.startsWith("https://")?new URL(t).hostname:t).endsWith(".cloudworkstations.dev")}catch{return!1}}async function j2(t){return(await fetch(t,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Uk(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const r={alg:"none",type:"JWT"},n=e||"demo-project",i=t.iat||0,o=t.sub||t.user_id;if(!o)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const c=Object.assign({iss:`https://securetoken.google.com/${n}`,aud:n,iat:i,exp:i+3600,auth_time:i,sub:o,user_id:o,firebase:{sign_in_provider:"custom",identities:{}}},t);return[R0(JSON.stringify(r)),R0(JSON.stringify(c)),""].join(".")}const Pu={};function Bk(){const t={prod:[],emulator:[]};for(const e of Object.keys(Pu))Pu[e]?t.emulator.push(e):t.prod.push(e);return t}function jk(t){let e=document.getElementById(t),r=!1;return e||(e=document.createElement("div"),e.setAttribute("id",t),r=!0),{created:r,element:e}}let Gy=!1;function z2(t,e){if(typeof window>"u"||typeof document>"u"||!mc(window.location.host)||Pu[t]===e||Pu[t]||Gy)return;Pu[t]=e;function r(x){return`__firebase__banner__${x}`}const n="__firebase__banner",o=Bk().prod.length>0;function c(){const x=document.getElementById(n);x&&x.remove()}function u(x){x.style.display="flex",x.style.background="#7faaf0",x.style.position="fixed",x.style.bottom="5px",x.style.left="5px",x.style.padding=".5em",x.style.borderRadius="5px",x.style.alignItems="center"}function h(x,A){x.setAttribute("width","24"),x.setAttribute("id",A),x.setAttribute("height","24"),x.setAttribute("viewBox","0 0 24 24"),x.setAttribute("fill","none"),x.style.marginLeft="-6px"}function d(){const x=document.createElement("span");return x.style.cursor="pointer",x.style.marginLeft="16px",x.style.fontSize="24px",x.innerHTML=" &times;",x.onclick=()=>{Gy=!0,c()},x}function g(x,A){x.setAttribute("id",A),x.innerText="Learn more",x.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",x.setAttribute("target","__blank"),x.style.paddingLeft="5px",x.style.textDecoration="underline"}function _(){const x=jk(n),A=r("text"),S=document.getElementById(A)||document.createElement("span"),R=r("learnmore"),w=document.getElementById(R)||document.createElement("a"),B=r("preprendIcon"),H=document.getElementById(B)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(x.created){const N=x.element;u(N),g(w,R);const J=d();h(H,B),N.append(H,S,w,J),document.body.appendChild(N)}o?(S.innerText="Preview backend disconnected.",H.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(H.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,S.innerText="Preview backend running in this workspace."),S.setAttribute("id",A)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",_):_()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pn(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function zk(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(pn())}function Hk(){var t;const e=(t=id())===null||t===void 0?void 0:t.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function Gk(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function qk(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function Kk(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function Wk(){const t=pn();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function Xk(){return!Hk()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function Yk(){try{return typeof indexedDB=="object"}catch{return!1}}function $k(){return new Promise((t,e)=>{try{let r=!0;const n="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(n);i.onsuccess=()=>{i.result.close(),r||self.indexedDB.deleteDatabase(n),t(!0)},i.onupgradeneeded=()=>{r=!1},i.onerror=()=>{var o;e(((o=i.error)===null||o===void 0?void 0:o.message)||"")}}catch(r){e(r)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qk="FirebaseError";class zi extends Error{constructor(e,r,n){super(r),this.code=e,this.customData=n,this.name=Qk,Object.setPrototypeOf(this,zi.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,xf.prototype.create)}}class xf{constructor(e,r,n){this.service=e,this.serviceName=r,this.errors=n}create(e,...r){const n=r[0]||{},i=`${this.service}/${e}`,o=this.errors[e],c=o?Zk(o,n):"Error",u=`${this.serviceName}: ${c} (${i}).`;return new zi(i,u,n)}}function Zk(t,e){return t.replace(Jk,(r,n)=>{const i=e[n];return i!=null?String(i):`<${n}?>`})}const Jk=/\{\$([^}]+)}/g;function eb(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function Lo(t,e){if(t===e)return!0;const r=Object.keys(t),n=Object.keys(e);for(const i of r){if(!n.includes(i))return!1;const o=t[i],c=e[i];if(qy(o)&&qy(c)){if(!Lo(o,c))return!1}else if(o!==c)return!1}for(const i of n)if(!r.includes(i))return!1;return!0}function qy(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yf(t){const e=[];for(const[r,n]of Object.entries(t))Array.isArray(n)?n.forEach(i=>{e.push(encodeURIComponent(r)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(r)+"="+encodeURIComponent(n));return e.length?"&"+e.join("&"):""}function Su(t){const e={};return t.replace(/^\?/,"").split("&").forEach(n=>{if(n){const[i,o]=n.split("=");e[decodeURIComponent(i)]=decodeURIComponent(o)}}),e}function Cu(t){const e=t.indexOf("?");if(!e)return"";const r=t.indexOf("#",e);return t.substring(e,r>0?r:void 0)}function tb(t,e){const r=new rb(t,e);return r.subscribe.bind(r)}class rb{constructor(e,r){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=r,this.task.then(()=>{e(this)}).catch(n=>{this.error(n)})}next(e){this.forEachObserver(r=>{r.next(e)})}error(e){this.forEachObserver(r=>{r.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,r,n){let i;if(e===void 0&&r===void 0&&n===void 0)throw new Error("Missing Observer.");nb(e,["next","error","complete"])?i=e:i={next:e,error:r,complete:n},i.next===void 0&&(i.next=Lm),i.error===void 0&&(i.error=Lm),i.complete===void 0&&(i.complete=Lm);const o=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),o}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let r=0;r<this.observers.length;r++)this.sendOne(r,e)}sendOne(e,r){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{r(this.observers[e])}catch(n){typeof console<"u"&&console.error&&console.error(n)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function nb(t,e){if(typeof t!="object"||t===null)return!1;for(const r of e)if(r in t&&typeof t[r]=="function")return!0;return!1}function Lm(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qr(t){return t&&t._delegate?t._delegate:t}class Vo{constructor(e,r,n){this.name=e,this.instanceFactory=r,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bo="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ab{constructor(e,r){this.name=e,this.container=r,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const r=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(r)){const n=new Vk;if(this.instancesDeferred.set(r,n),this.isInitialized(r)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:r});i&&n.resolve(i)}catch{}}return this.instancesDeferred.get(r).promise}getImmediate(e){var r;const n=this.normalizeInstanceIdentifier(e?.identifier),i=(r=e?.optional)!==null&&r!==void 0?r:!1;if(this.isInitialized(n)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:n})}catch(o){if(i)return null;throw o}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(sb(e))try{this.getOrInitializeService({instanceIdentifier:bo})}catch{}for(const[r,n]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(r);try{const o=this.getOrInitializeService({instanceIdentifier:i});n.resolve(o)}catch{}}}}clearInstance(e=bo){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(r=>"INTERNAL"in r).map(r=>r.INTERNAL.delete()),...e.filter(r=>"_delete"in r).map(r=>r._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=bo){return this.instances.has(e)}getOptions(e=bo){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:r={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:n,options:r});for(const[o,c]of this.instancesDeferred.entries()){const u=this.normalizeInstanceIdentifier(o);n===u&&c.resolve(i)}return i}onInit(e,r){var n;const i=this.normalizeInstanceIdentifier(r),o=(n=this.onInitCallbacks.get(i))!==null&&n!==void 0?n:new Set;o.add(e),this.onInitCallbacks.set(i,o);const c=this.instances.get(i);return c&&e(c,i),()=>{o.delete(e)}}invokeOnInitCallbacks(e,r){const n=this.onInitCallbacks.get(r);if(n)for(const i of n)try{i(e,r)}catch{}}getOrInitializeService({instanceIdentifier:e,options:r={}}){let n=this.instances.get(e);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:ib(e),options:r}),this.instances.set(e,n),this.instancesOptions.set(e,r),this.invokeOnInitCallbacks(n,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,n)}catch{}return n||null}normalizeInstanceIdentifier(e=bo){return this.component?this.component.multipleInstances?e:bo:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function ib(t){return t===bo?void 0:t}function sb(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ob{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const r=this.getProvider(e.name);if(r.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);r.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const r=new ab(e,this);return this.providers.set(e,r),r}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Tt;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(Tt||(Tt={}));const lb={debug:Tt.DEBUG,verbose:Tt.VERBOSE,info:Tt.INFO,warn:Tt.WARN,error:Tt.ERROR,silent:Tt.SILENT},cb=Tt.INFO,ub={[Tt.DEBUG]:"log",[Tt.VERBOSE]:"log",[Tt.INFO]:"info",[Tt.WARN]:"warn",[Tt.ERROR]:"error"},fb=(t,e,...r)=>{if(e<t.logLevel)return;const n=new Date().toISOString(),i=ub[e];if(i)console[i](`[${n}]  ${t.name}:`,...r);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Zg{constructor(e){this.name=e,this._logLevel=cb,this._logHandler=fb,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Tt))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?lb[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Tt.DEBUG,...e),this._logHandler(this,Tt.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Tt.VERBOSE,...e),this._logHandler(this,Tt.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Tt.INFO,...e),this._logHandler(this,Tt.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Tt.WARN,...e),this._logHandler(this,Tt.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Tt.ERROR,...e),this._logHandler(this,Tt.ERROR,...e)}}const hb=(t,e)=>e.some(r=>t instanceof r);let Ky,Wy;function db(){return Ky||(Ky=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function pb(){return Wy||(Wy=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const H2=new WeakMap,og=new WeakMap,G2=new WeakMap,Vm=new WeakMap,Jg=new WeakMap;function mb(t){const e=new Promise((r,n)=>{const i=()=>{t.removeEventListener("success",o),t.removeEventListener("error",c)},o=()=>{r(Is(t.result)),i()},c=()=>{n(t.error),i()};t.addEventListener("success",o),t.addEventListener("error",c)});return e.then(r=>{r instanceof IDBCursor&&H2.set(r,t)}).catch(()=>{}),Jg.set(e,t),e}function gb(t){if(og.has(t))return;const e=new Promise((r,n)=>{const i=()=>{t.removeEventListener("complete",o),t.removeEventListener("error",c),t.removeEventListener("abort",c)},o=()=>{r(),i()},c=()=>{n(t.error||new DOMException("AbortError","AbortError")),i()};t.addEventListener("complete",o),t.addEventListener("error",c),t.addEventListener("abort",c)});og.set(t,e)}let lg={get(t,e,r){if(t instanceof IDBTransaction){if(e==="done")return og.get(t);if(e==="objectStoreNames")return t.objectStoreNames||G2.get(t);if(e==="store")return r.objectStoreNames[1]?void 0:r.objectStore(r.objectStoreNames[0])}return Is(t[e])},set(t,e,r){return t[e]=r,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function vb(t){lg=t(lg)}function _b(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...r){const n=t.call(Um(this),e,...r);return G2.set(n,e.sort?e.sort():[e]),Is(n)}:pb().includes(t)?function(...e){return t.apply(Um(this),e),Is(H2.get(this))}:function(...e){return Is(t.apply(Um(this),e))}}function xb(t){return typeof t=="function"?_b(t):(t instanceof IDBTransaction&&gb(t),hb(t,db())?new Proxy(t,lg):t)}function Is(t){if(t instanceof IDBRequest)return mb(t);if(Vm.has(t))return Vm.get(t);const e=xb(t);return e!==t&&(Vm.set(t,e),Jg.set(e,t)),e}const Um=t=>Jg.get(t);function yb(t,e,{blocked:r,upgrade:n,blocking:i,terminated:o}={}){const c=indexedDB.open(t,e),u=Is(c);return n&&c.addEventListener("upgradeneeded",h=>{n(Is(c.result),h.oldVersion,h.newVersion,Is(c.transaction),h)}),r&&c.addEventListener("blocked",h=>r(h.oldVersion,h.newVersion,h)),u.then(h=>{o&&h.addEventListener("close",()=>o()),i&&h.addEventListener("versionchange",d=>i(d.oldVersion,d.newVersion,d))}).catch(()=>{}),u}const Eb=["get","getKey","getAll","getAllKeys","count"],Tb=["put","add","delete","clear"],Bm=new Map;function Xy(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(Bm.get(e))return Bm.get(e);const r=e.replace(/FromIndex$/,""),n=e!==r,i=Tb.includes(r);if(!(r in(n?IDBIndex:IDBObjectStore).prototype)||!(i||Eb.includes(r)))return;const o=async function(c,...u){const h=this.transaction(c,i?"readwrite":"readonly");let d=h.store;return n&&(d=d.index(u.shift())),(await Promise.all([d[r](...u),i&&h.done]))[0]};return Bm.set(e,o),o}vb(t=>({...t,get:(e,r,n)=>Xy(e,r)||t.get(e,r,n),has:(e,r)=>!!Xy(e,r)||t.has(e,r)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ab{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(r=>{if(wb(r)){const n=r.getImmediate();return`${n.library}/${n.version}`}else return null}).filter(r=>r).join(" ")}}function wb(t){const e=t.getComponent();return e?.type==="VERSION"}const cg="@firebase/app",Yy="0.13.2";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vi=new Zg("@firebase/app"),Sb="@firebase/app-compat",Cb="@firebase/analytics-compat",Rb="@firebase/analytics",kb="@firebase/app-check-compat",bb="@firebase/app-check",Ib="@firebase/auth",Db="@firebase/auth-compat",Ob="@firebase/database",Nb="@firebase/data-connect",Fb="@firebase/database-compat",Pb="@firebase/functions",Mb="@firebase/functions-compat",Lb="@firebase/installations",Vb="@firebase/installations-compat",Ub="@firebase/messaging",Bb="@firebase/messaging-compat",jb="@firebase/performance",zb="@firebase/performance-compat",Hb="@firebase/remote-config",Gb="@firebase/remote-config-compat",qb="@firebase/storage",Kb="@firebase/storage-compat",Wb="@firebase/firestore",Xb="@firebase/ai",Yb="@firebase/firestore-compat",$b="firebase",Qb="11.10.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ug="[DEFAULT]",Zb={[cg]:"fire-core",[Sb]:"fire-core-compat",[Rb]:"fire-analytics",[Cb]:"fire-analytics-compat",[bb]:"fire-app-check",[kb]:"fire-app-check-compat",[Ib]:"fire-auth",[Db]:"fire-auth-compat",[Ob]:"fire-rtdb",[Nb]:"fire-data-connect",[Fb]:"fire-rtdb-compat",[Pb]:"fire-fn",[Mb]:"fire-fn-compat",[Lb]:"fire-iid",[Vb]:"fire-iid-compat",[Ub]:"fire-fcm",[Bb]:"fire-fcm-compat",[jb]:"fire-perf",[zb]:"fire-perf-compat",[Hb]:"fire-rc",[Gb]:"fire-rc-compat",[qb]:"fire-gcs",[Kb]:"fire-gcs-compat",[Wb]:"fire-fst",[Yb]:"fire-fst-compat",[Xb]:"fire-vertex","fire-js":"fire-js",[$b]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const k0=new Map,Jb=new Map,fg=new Map;function $y(t,e){try{t.container.addComponent(e)}catch(r){Vi.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,r)}}function ic(t){const e=t.name;if(fg.has(e))return Vi.debug(`There were multiple attempts to register component ${e}.`),!1;fg.set(e,t);for(const r of k0.values())$y(r,t);for(const r of Jb.values())$y(r,t);return!0}function e1(t,e){const r=t.container.getProvider("heartbeat").getImmediate({optional:!0});return r&&r.triggerHeartbeat(),t.container.getProvider(e)}function ha(t){return t==null?!1:t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eI={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Ds=new xf("app","Firebase",eI);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tI{constructor(e,r,n){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},r),this._name=r.name,this._automaticDataCollectionEnabled=r.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new Vo("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Ds.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gc=Qb;function q2(t,e={}){let r=t;typeof e!="object"&&(e={name:e});const n=Object.assign({name:ug,automaticDataCollectionEnabled:!0},e),i=n.name;if(typeof i!="string"||!i)throw Ds.create("bad-app-name",{appName:String(i)});if(r||(r=U2()),!r)throw Ds.create("no-options");const o=k0.get(i);if(o){if(Lo(r,o.options)&&Lo(n,o.config))return o;throw Ds.create("duplicate-app",{appName:i})}const c=new ob(i);for(const h of fg.values())c.addComponent(h);const u=new tI(r,n,c);return k0.set(i,u),u}function K2(t=ug){const e=k0.get(t);if(!e&&t===ug&&U2())return q2();if(!e)throw Ds.create("no-app",{appName:t});return e}function Os(t,e,r){var n;let i=(n=Zb[t])!==null&&n!==void 0?n:t;r&&(i+=`-${r}`);const o=i.match(/\s|\//),c=e.match(/\s|\//);if(o||c){const u=[`Unable to register library "${i}" with version "${e}":`];o&&u.push(`library name "${i}" contains illegal characters (whitespace or "/")`),o&&c&&u.push("and"),c&&u.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Vi.warn(u.join(" "));return}ic(new Vo(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rI="firebase-heartbeat-database",nI=1,Ju="firebase-heartbeat-store";let jm=null;function W2(){return jm||(jm=yb(rI,nI,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(Ju)}catch(r){console.warn(r)}}}}).catch(t=>{throw Ds.create("idb-open",{originalErrorMessage:t.message})})),jm}async function aI(t){try{const r=(await W2()).transaction(Ju),n=await r.objectStore(Ju).get(X2(t));return await r.done,n}catch(e){if(e instanceof zi)Vi.warn(e.message);else{const r=Ds.create("idb-get",{originalErrorMessage:e?.message});Vi.warn(r.message)}}}async function Qy(t,e){try{const n=(await W2()).transaction(Ju,"readwrite");await n.objectStore(Ju).put(e,X2(t)),await n.done}catch(r){if(r instanceof zi)Vi.warn(r.message);else{const n=Ds.create("idb-set",{originalErrorMessage:r?.message});Vi.warn(n.message)}}}function X2(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iI=1024,sI=30;class oI{constructor(e){this.container=e,this._heartbeatsCache=null;const r=this.container.getProvider("app").getImmediate();this._storage=new cI(r),this._heartbeatsCachePromise=this._storage.read().then(n=>(this._heartbeatsCache=n,n))}async triggerHeartbeat(){var e,r;try{const i=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),o=Zy();if(((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((r=this._heartbeatsCache)===null||r===void 0?void 0:r.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===o||this._heartbeatsCache.heartbeats.some(c=>c.date===o))return;if(this._heartbeatsCache.heartbeats.push({date:o,agent:i}),this._heartbeatsCache.heartbeats.length>sI){const c=uI(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(c,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(n){Vi.warn(n)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const r=Zy(),{heartbeatsToSend:n,unsentEntries:i}=lI(this._heartbeatsCache.heartbeats),o=R0(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=r,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),o}catch(r){return Vi.warn(r),""}}}function Zy(){return new Date().toISOString().substring(0,10)}function lI(t,e=iI){const r=[];let n=t.slice();for(const i of t){const o=r.find(c=>c.agent===i.agent);if(o){if(o.dates.push(i.date),Jy(r)>e){o.dates.pop();break}}else if(r.push({agent:i.agent,dates:[i.date]}),Jy(r)>e){r.pop();break}n=n.slice(1)}return{heartbeatsToSend:r,unsentEntries:n}}class cI{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return Yk()?$k().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const r=await aI(this.app);return r?.heartbeats?r:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var r;if(await this._canUseIndexedDBPromise){const i=await this.read();return Qy(this.app,{lastSentHeartbeatDate:(r=e.lastSentHeartbeatDate)!==null&&r!==void 0?r:i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var r;if(await this._canUseIndexedDBPromise){const i=await this.read();return Qy(this.app,{lastSentHeartbeatDate:(r=e.lastSentHeartbeatDate)!==null&&r!==void 0?r:i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return}}function Jy(t){return R0(JSON.stringify({version:2,heartbeats:t})).length}function uI(t){if(t.length===0)return-1;let e=0,r=t[0].date;for(let n=1;n<t.length;n++)t[n].date<r&&(r=t[n].date,e=n);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fI(t){ic(new Vo("platform-logger",e=>new Ab(e),"PRIVATE")),ic(new Vo("heartbeat",e=>new oI(e),"PRIVATE")),Os(cg,Yy,t),Os(cg,Yy,"esm2017"),Os("fire-js","")}fI("");function t1(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(t);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(t,n[i])&&(r[n[i]]=t[n[i]]);return r}function Y2(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const hI=Y2,$2=new xf("auth","Firebase",Y2());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const b0=new Zg("@firebase/auth");function dI(t,...e){b0.logLevel<=Tt.WARN&&b0.warn(`Auth (${gc}): ${t}`,...e)}function m0(t,...e){b0.logLevel<=Tt.ERROR&&b0.error(`Auth (${gc}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ma(t,...e){throw n1(t,...e)}function Da(t,...e){return n1(t,...e)}function r1(t,e,r){const n=Object.assign(Object.assign({},hI()),{[e]:r});return new xf("auth","Firebase",n).create(e,{appName:t.name})}function Ns(t){return r1(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function pI(t,e,r){const n=r;if(!(e instanceof n))throw n.name!==e.constructor.name&&ma(t,"argument-error"),r1(t,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function n1(t,...e){if(typeof t!="string"){const r=e[0],n=[...e.slice(1)];return n[0]&&(n[0].appName=t.name),t._errorFactory.create(r,...n)}return $2.create(t,...e)}function tt(t,e,...r){if(!t)throw n1(e,...r)}function Ii(t){const e="INTERNAL ASSERTION FAILED: "+t;throw m0(e),new Error(e)}function Ui(t,e){t||Ii(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hg(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.href)||""}function mI(){return eE()==="http:"||eE()==="https:"}function eE(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gI(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(mI()||qk()||"connection"in navigator)?navigator.onLine:!0}function vI(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ef{constructor(e,r){this.shortDelay=e,this.longDelay=r,Ui(r>e,"Short delay should be less than long delay!"),this.isMobile=zk()||Kk()}get(){return gI()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function a1(t,e){Ui(t.emulator,"Emulator should always be set here");const{url:r}=t.emulator;return e?`${r}${e.startsWith("/")?e.slice(1):e}`:r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Q2{static initialize(e,r,n){this.fetchImpl=e,r&&(this.headersImpl=r),n&&(this.responseImpl=n)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Ii("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Ii("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Ii("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _I={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xI=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],yI=new Ef(3e4,6e4);function Ko(t,e){return t.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:t.tenantId}):e}async function $s(t,e,r,n,i={}){return Z2(t,i,async()=>{let o={},c={};n&&(e==="GET"?c=n:o={body:JSON.stringify(n)});const u=yf(Object.assign({key:t.config.apiKey},c)).slice(1),h=await t._getAdditionalHeaders();h["Content-Type"]="application/json",t.languageCode&&(h["X-Firebase-Locale"]=t.languageCode);const d=Object.assign({method:e,headers:h},o);return Gk()||(d.referrerPolicy="no-referrer"),t.emulatorConfig&&mc(t.emulatorConfig.host)&&(d.credentials="include"),Q2.fetch()(await J2(t,t.config.apiHost,r,u),d)})}async function Z2(t,e,r){t._canInitEmulator=!1;const n=Object.assign(Object.assign({},_I),e);try{const i=new TI(t),o=await Promise.race([r(),i.promise]);i.clearNetworkTimeout();const c=await o.json();if("needConfirmation"in c)throw Jh(t,"account-exists-with-different-credential",c);if(o.ok&&!("errorMessage"in c))return c;{const u=o.ok?c.errorMessage:c.error.message,[h,d]=u.split(" : ");if(h==="FEDERATED_USER_ID_ALREADY_LINKED")throw Jh(t,"credential-already-in-use",c);if(h==="EMAIL_EXISTS")throw Jh(t,"email-already-in-use",c);if(h==="USER_DISABLED")throw Jh(t,"user-disabled",c);const g=n[h]||h.toLowerCase().replace(/[_\s]+/g,"-");if(d)throw r1(t,g,d);ma(t,g)}}catch(i){if(i instanceof zi)throw i;ma(t,"network-request-failed",{message:String(i)})}}async function sd(t,e,r,n,i={}){const o=await $s(t,e,r,n,i);return"mfaPendingCredential"in o&&ma(t,"multi-factor-auth-required",{_serverResponse:o}),o}async function J2(t,e,r,n){const i=`${e}${r}?${n}`,o=t,c=o.config.emulator?a1(t.config,i):`${t.config.apiScheme}://${i}`;return xI.includes(r)&&(await o._persistenceManagerAvailable,o._getPersistenceType()==="COOKIE")?o._getPersistence()._getFinalTarget(c).toString():c}function EI(t){switch(t){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class TI{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((r,n)=>{this.timer=setTimeout(()=>n(Da(this.auth,"network-request-failed")),yI.get())})}}function Jh(t,e,r){const n={appName:t.name};r.email&&(n.email=r.email),r.phoneNumber&&(n.phoneNumber=r.phoneNumber);const i=Da(t,e,n);return i.customData._tokenResponse=r,i}function tE(t){return t!==void 0&&t.enterprise!==void 0}class AI{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const r of this.recaptchaEnforcementState)if(r.provider&&r.provider===e)return EI(r.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function wI(t,e){return $s(t,"GET","/v2/recaptchaConfig",Ko(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function SI(t,e){return $s(t,"POST","/v1/accounts:delete",e)}async function I0(t,e){return $s(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Mu(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function CI(t,e=!1){const r=qr(t),n=await r.getIdToken(e),i=i1(n);tt(i&&i.exp&&i.auth_time&&i.iat,r.auth,"internal-error");const o=typeof i.firebase=="object"?i.firebase:void 0,c=o?.sign_in_provider;return{claims:i,token:n,authTime:Mu(zm(i.auth_time)),issuedAtTime:Mu(zm(i.iat)),expirationTime:Mu(zm(i.exp)),signInProvider:c||null,signInSecondFactor:o?.sign_in_second_factor||null}}function zm(t){return Number(t)*1e3}function i1(t){const[e,r,n]=t.split(".");if(e===void 0||r===void 0||n===void 0)return m0("JWT malformed, contained fewer than 3 sections"),null;try{const i=L2(r);return i?JSON.parse(i):(m0("Failed to decode base64 JWT payload"),null)}catch(i){return m0("Caught error parsing JWT payload as JSON",i?.toString()),null}}function rE(t){const e=i1(t);return tt(e,"internal-error"),tt(typeof e.exp<"u","internal-error"),tt(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ef(t,e,r=!1){if(r)return e;try{return await e}catch(n){throw n instanceof zi&&RI(n)&&t.auth.currentUser===t&&await t.auth.signOut(),n}}function RI({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kI{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var r;if(e){const n=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),n}else{this.errorBackoff=3e4;const i=((r=this.user.stsTokenManager.expirationTime)!==null&&r!==void 0?r:0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;const r=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},r)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dg{constructor(e,r){this.createdAt=e,this.lastLoginAt=r,this._initializeTime()}_initializeTime(){this.lastSignInTime=Mu(this.lastLoginAt),this.creationTime=Mu(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function D0(t){var e;const r=t.auth,n=await t.getIdToken(),i=await ef(t,I0(r,{idToken:n}));tt(i?.users.length,r,"internal-error");const o=i.users[0];t._notifyReloadListener(o);const c=!((e=o.providerUserInfo)===null||e===void 0)&&e.length?eA(o.providerUserInfo):[],u=II(t.providerData,c),h=t.isAnonymous,d=!(t.email&&o.passwordHash)&&!u?.length,g=h?d:!1,_={uid:o.localId,displayName:o.displayName||null,photoURL:o.photoUrl||null,email:o.email||null,emailVerified:o.emailVerified||!1,phoneNumber:o.phoneNumber||null,tenantId:o.tenantId||null,providerData:u,metadata:new dg(o.createdAt,o.lastLoginAt),isAnonymous:g};Object.assign(t,_)}async function bI(t){const e=qr(t);await D0(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function II(t,e){return[...t.filter(n=>!e.some(i=>i.providerId===n.providerId)),...e]}function eA(t){return t.map(e=>{var{providerId:r}=e,n=t1(e,["providerId"]);return{providerId:r,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function DI(t,e){const r=await Z2(t,{},async()=>{const n=yf({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:o}=t.config,c=await J2(t,i,"/v1/token",`key=${o}`),u=await t._getAdditionalHeaders();u["Content-Type"]="application/x-www-form-urlencoded";const h={method:"POST",headers:u,body:n};return t.emulatorConfig&&mc(t.emulatorConfig.host)&&(h.credentials="include"),Q2.fetch()(c,h)});return{accessToken:r.access_token,expiresIn:r.expires_in,refreshToken:r.refresh_token}}async function OI(t,e){return $s(t,"POST","/v2/accounts:revokeToken",Ko(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ql{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){tt(e.idToken,"internal-error"),tt(typeof e.idToken<"u","internal-error"),tt(typeof e.refreshToken<"u","internal-error");const r="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):rE(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,r)}updateFromIdToken(e){tt(e.length!==0,"internal-error");const r=rE(e);this.updateTokensAndExpiration(e,null,r)}async getToken(e,r=!1){return!r&&this.accessToken&&!this.isExpired?this.accessToken:(tt(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,r){const{accessToken:n,refreshToken:i,expiresIn:o}=await DI(e,r);this.updateTokensAndExpiration(n,i,Number(o))}updateTokensAndExpiration(e,r,n){this.refreshToken=r||null,this.accessToken=e||null,this.expirationTime=Date.now()+n*1e3}static fromJSON(e,r){const{refreshToken:n,accessToken:i,expirationTime:o}=r,c=new Ql;return n&&(tt(typeof n=="string","internal-error",{appName:e}),c.refreshToken=n),i&&(tt(typeof i=="string","internal-error",{appName:e}),c.accessToken=i),o&&(tt(typeof o=="number","internal-error",{appName:e}),c.expirationTime=o),c}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Ql,this.toJSON())}_performRefresh(){return Ii("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _s(t,e){tt(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class Ra{constructor(e){var{uid:r,auth:n,stsTokenManager:i}=e,o=t1(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new kI(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=r,this.auth=n,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=o.displayName||null,this.email=o.email||null,this.emailVerified=o.emailVerified||!1,this.phoneNumber=o.phoneNumber||null,this.photoURL=o.photoURL||null,this.isAnonymous=o.isAnonymous||!1,this.tenantId=o.tenantId||null,this.providerData=o.providerData?[...o.providerData]:[],this.metadata=new dg(o.createdAt||void 0,o.lastLoginAt||void 0)}async getIdToken(e){const r=await ef(this,this.stsTokenManager.getToken(this.auth,e));return tt(r,this.auth,"internal-error"),this.accessToken!==r&&(this.accessToken=r,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),r}getIdTokenResult(e){return CI(this,e)}reload(){return bI(this)}_assign(e){this!==e&&(tt(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(r=>Object.assign({},r)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const r=new Ra(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return r.metadata._copy(this.metadata),r}_onReload(e){tt(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,r=!1){let n=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),n=!0),r&&await D0(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(ha(this.auth.app))return Promise.reject(Ns(this.auth));const e=await this.getIdToken();return await ef(this,SI(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,r){var n,i,o,c,u,h,d,g;const _=(n=r.displayName)!==null&&n!==void 0?n:void 0,x=(i=r.email)!==null&&i!==void 0?i:void 0,A=(o=r.phoneNumber)!==null&&o!==void 0?o:void 0,S=(c=r.photoURL)!==null&&c!==void 0?c:void 0,R=(u=r.tenantId)!==null&&u!==void 0?u:void 0,w=(h=r._redirectEventId)!==null&&h!==void 0?h:void 0,B=(d=r.createdAt)!==null&&d!==void 0?d:void 0,H=(g=r.lastLoginAt)!==null&&g!==void 0?g:void 0,{uid:N,emailVerified:J,isAnonymous:re,providerData:ne,stsTokenManager:C}=r;tt(N&&C,e,"internal-error");const T=Ql.fromJSON(this.name,C);tt(typeof N=="string",e,"internal-error"),_s(_,e.name),_s(x,e.name),tt(typeof J=="boolean",e,"internal-error"),tt(typeof re=="boolean",e,"internal-error"),_s(A,e.name),_s(S,e.name),_s(R,e.name),_s(w,e.name),_s(B,e.name),_s(H,e.name);const E=new Ra({uid:N,auth:e,email:x,emailVerified:J,displayName:_,isAnonymous:re,photoURL:S,phoneNumber:A,tenantId:R,stsTokenManager:T,createdAt:B,lastLoginAt:H});return ne&&Array.isArray(ne)&&(E.providerData=ne.map(D=>Object.assign({},D))),w&&(E._redirectEventId=w),E}static async _fromIdTokenResponse(e,r,n=!1){const i=new Ql;i.updateFromServerResponse(r);const o=new Ra({uid:r.localId,auth:e,stsTokenManager:i,isAnonymous:n});return await D0(o),o}static async _fromGetAccountInfoResponse(e,r,n){const i=r.users[0];tt(i.localId!==void 0,"internal-error");const o=i.providerUserInfo!==void 0?eA(i.providerUserInfo):[],c=!(i.email&&i.passwordHash)&&!o?.length,u=new Ql;u.updateFromIdToken(n);const h=new Ra({uid:i.localId,auth:e,stsTokenManager:u,isAnonymous:c}),d={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:o,metadata:new dg(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!o?.length};return Object.assign(h,d),h}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nE=new Map;function Di(t){Ui(t instanceof Function,"Expected a class definition");let e=nE.get(t);return e?(Ui(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,nE.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tA{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,r){this.storage[e]=r}async _get(e){const r=this.storage[e];return r===void 0?null:r}async _remove(e){delete this.storage[e]}_addListener(e,r){}_removeListener(e,r){}}tA.type="NONE";const aE=tA;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function g0(t,e,r){return`firebase:${t}:${e}:${r}`}class Zl{constructor(e,r,n){this.persistence=e,this.auth=r,this.userKey=n;const{config:i,name:o}=this.auth;this.fullUserKey=g0(this.userKey,i.apiKey,o),this.fullPersistenceKey=g0("persistence",i.apiKey,o),this.boundEventHandler=r._onStorageEvent.bind(r),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const r=await I0(this.auth,{idToken:e}).catch(()=>{});return r?Ra._fromGetAccountInfoResponse(this.auth,r,e):null}return Ra._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const r=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,r)return this.setCurrentUser(r)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,r,n="authUser"){if(!r.length)return new Zl(Di(aE),e,n);const i=(await Promise.all(r.map(async d=>{if(await d._isAvailable())return d}))).filter(d=>d);let o=i[0]||Di(aE);const c=g0(n,e.config.apiKey,e.name);let u=null;for(const d of r)try{const g=await d._get(c);if(g){let _;if(typeof g=="string"){const x=await I0(e,{idToken:g}).catch(()=>{});if(!x)break;_=await Ra._fromGetAccountInfoResponse(e,x,g)}else _=Ra._fromJSON(e,g);d!==o&&(u=_),o=d;break}}catch{}const h=i.filter(d=>d._shouldAllowMigration);return!o._shouldAllowMigration||!h.length?new Zl(o,e,n):(o=h[0],u&&await o._set(c,u.toJSON()),await Promise.all(r.map(async d=>{if(d!==o)try{await d._remove(c)}catch{}})),new Zl(o,e,n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function iE(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(iA(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(rA(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(oA(e))return"Blackberry";if(lA(e))return"Webos";if(nA(e))return"Safari";if((e.includes("chrome/")||aA(e))&&!e.includes("edge/"))return"Chrome";if(sA(e))return"Android";{const r=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=t.match(r);if(n?.length===2)return n[1]}return"Other"}function rA(t=pn()){return/firefox\//i.test(t)}function nA(t=pn()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function aA(t=pn()){return/crios\//i.test(t)}function iA(t=pn()){return/iemobile/i.test(t)}function sA(t=pn()){return/android/i.test(t)}function oA(t=pn()){return/blackberry/i.test(t)}function lA(t=pn()){return/webos/i.test(t)}function s1(t=pn()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function NI(t=pn()){var e;return s1(t)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function FI(){return Wk()&&document.documentMode===10}function cA(t=pn()){return s1(t)||sA(t)||lA(t)||oA(t)||/windows phone/i.test(t)||iA(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uA(t,e=[]){let r;switch(t){case"Browser":r=iE(pn());break;case"Worker":r=`${iE(pn())}-${t}`;break;default:r=t}const n=e.length?e.join(","):"FirebaseCore-web";return`${r}/JsCore/${gc}/${n}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PI{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,r){const n=o=>new Promise((c,u)=>{try{const h=e(o);c(h)}catch(h){u(h)}});n.onAbort=r,this.queue.push(n);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const r=[];try{for(const n of this.queue)await n(e),n.onAbort&&r.push(n.onAbort)}catch(n){r.reverse();for(const i of r)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:n?.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function MI(t,e={}){return $s(t,"GET","/v2/passwordPolicy",Ko(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const LI=6;class VI{constructor(e){var r,n,i,o;const c=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(r=c.minPasswordLength)!==null&&r!==void 0?r:LI,c.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=c.maxPasswordLength),c.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=c.containsLowercaseCharacter),c.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=c.containsUppercaseCharacter),c.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=c.containsNumericCharacter),c.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=c.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(i=(n=e.allowedNonAlphanumericCharacters)===null||n===void 0?void 0:n.join(""))!==null&&i!==void 0?i:"",this.forceUpgradeOnSignin=(o=e.forceUpgradeOnSignin)!==null&&o!==void 0?o:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var r,n,i,o,c,u;const h={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,h),this.validatePasswordCharacterOptions(e,h),h.isValid&&(h.isValid=(r=h.meetsMinPasswordLength)!==null&&r!==void 0?r:!0),h.isValid&&(h.isValid=(n=h.meetsMaxPasswordLength)!==null&&n!==void 0?n:!0),h.isValid&&(h.isValid=(i=h.containsLowercaseLetter)!==null&&i!==void 0?i:!0),h.isValid&&(h.isValid=(o=h.containsUppercaseLetter)!==null&&o!==void 0?o:!0),h.isValid&&(h.isValid=(c=h.containsNumericCharacter)!==null&&c!==void 0?c:!0),h.isValid&&(h.isValid=(u=h.containsNonAlphanumericCharacter)!==null&&u!==void 0?u:!0),h}validatePasswordLengthOptions(e,r){const n=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;n&&(r.meetsMinPasswordLength=e.length>=n),i&&(r.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,r){this.updatePasswordCharacterOptionsStatuses(r,!1,!1,!1,!1);let n;for(let i=0;i<e.length;i++)n=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(r,n>="a"&&n<="z",n>="A"&&n<="Z",n>="0"&&n<="9",this.allowedNonAlphanumericCharacters.includes(n))}updatePasswordCharacterOptionsStatuses(e,r,n,i,o){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=r)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=n)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=o))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UI{constructor(e,r,n,i){this.app=e,this.heartbeatServiceProvider=r,this.appCheckServiceProvider=n,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new sE(this),this.idTokenSubscription=new sE(this),this.beforeStateQueue=new PI(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=$2,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion,this._persistenceManagerAvailable=new Promise(o=>this._resolvePersistenceManagerAvailable=o)}_initializeWithPersistence(e,r){return r&&(this._popupRedirectResolver=Di(r)),this._initializationPromise=this.queue(async()=>{var n,i,o;if(!this._deleted&&(this.persistenceManager=await Zl.create(this,e),(n=this._resolvePersistenceManagerAvailable)===null||n===void 0||n.call(this),!this._deleted)){if(!((i=this._popupRedirectResolver)===null||i===void 0)&&i._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(r),this.lastNotifiedUid=((o=this.currentUser)===null||o===void 0?void 0:o.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const r=await I0(this,{idToken:e}),n=await Ra._fromGetAccountInfoResponse(this,r,e);await this.directlySetCurrentUser(n)}catch(r){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",r),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var r;if(ha(this.app)){const c=this.app.settings.authIdToken;return c?new Promise(u=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(c).then(u,u))}):this.directlySetCurrentUser(null)}const n=await this.assertedPersistence.getCurrentUser();let i=n,o=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const c=(r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId,u=i?._redirectEventId,h=await this.tryRedirectSignIn(e);(!c||c===u)&&h?.user&&(i=h.user,o=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(o)try{await this.beforeStateQueue.runMiddleware(i)}catch(c){i=n,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(c))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return tt(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(e){let r=null;try{r=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return r}async reloadAndSetCurrentUserOrClear(e){try{await D0(e)}catch(r){if(r?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=vI()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(ha(this.app))return Promise.reject(Ns(this));const r=e?qr(e):null;return r&&tt(r.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(r&&r._clone(this))}async _updateCurrentUser(e,r=!1){if(!this._deleted)return e&&tt(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),r||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return ha(this.app)?Promise.reject(Ns(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return ha(this.app)?Promise.reject(Ns(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Di(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const r=this._getPasswordPolicyInternal();return r.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):r.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await MI(this),r=new VI(e);this.tenantId===null?this._projectPasswordPolicy=r:this._tenantPasswordPolicies[this.tenantId]=r}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new xf("auth","Firebase",e())}onAuthStateChanged(e,r,n){return this.registerStateListener(this.authStateSubscription,e,r,n)}beforeAuthStateChanged(e,r){return this.beforeStateQueue.pushCallback(e,r)}onIdTokenChanged(e,r,n){return this.registerStateListener(this.idTokenSubscription,e,r,n)}authStateReady(){return new Promise((e,r)=>{if(this.currentUser)e();else{const n=this.onAuthStateChanged(()=>{n(),e()},r)}})}async revokeAccessToken(e){if(this.currentUser){const r=await this.currentUser.getIdToken(),n={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:r};this.tenantId!=null&&(n.tenantId=this.tenantId),await OI(this,n)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,r){const n=await this.getOrInitRedirectPersistenceManager(r);return e===null?n.removeCurrentUser():n.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const r=e&&Di(e)||this._popupRedirectResolver;tt(r,this,"argument-error"),this.redirectPersistenceManager=await Zl.create(this,[Di(r._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var r,n;return this._isInitialized&&await this.queue(async()=>{}),((r=this._currentUser)===null||r===void 0?void 0:r._redirectEventId)===e?this._currentUser:((n=this.redirectUser)===null||n===void 0?void 0:n._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,r;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const n=(r=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&r!==void 0?r:null;this.lastNotifiedUid!==n&&(this.lastNotifiedUid=n,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,r,n,i){if(this._deleted)return()=>{};const o=typeof r=="function"?r:r.next.bind(r);let c=!1;const u=this._isInitialized?Promise.resolve():this._initializationPromise;if(tt(u,this,"internal-error"),u.then(()=>{c||o(this.currentUser)}),typeof r=="function"){const h=e.addObserver(r,n,i);return()=>{c=!0,h()}}else{const h=e.addObserver(r);return()=>{c=!0,h()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return tt(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=uA(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const r={"X-Client-Version":this.clientVersion};this.app.options.appId&&(r["X-Firebase-gmpid"]=this.app.options.appId);const n=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());n&&(r["X-Firebase-Client"]=n);const i=await this._getAppCheckToken();return i&&(r["X-Firebase-AppCheck"]=i),r}async _getAppCheckToken(){var e;if(ha(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const r=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return r?.error&&dI(`Error while retrieving App Check token: ${r.error}`),r?.token}}function Wo(t){return qr(t)}class sE{constructor(e){this.auth=e,this.observer=null,this.addObserver=tb(r=>this.observer=r)}get next(){return tt(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let od={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function BI(t){od=t}function fA(t){return od.loadJS(t)}function jI(){return od.recaptchaEnterpriseScript}function zI(){return od.gapiScript}function HI(t){return`__${t}${Math.floor(Math.random()*1e6)}`}class GI{constructor(){this.enterprise=new qI}ready(e){e()}execute(e,r){return Promise.resolve("token")}render(e,r){return""}}class qI{ready(e){e()}execute(e,r){return Promise.resolve("token")}render(e,r){return""}}const KI="recaptcha-enterprise",hA="NO_RECAPTCHA";class WI{constructor(e){this.type=KI,this.auth=Wo(e)}async verify(e="verify",r=!1){async function n(o){if(!r){if(o.tenantId==null&&o._agentRecaptchaConfig!=null)return o._agentRecaptchaConfig.siteKey;if(o.tenantId!=null&&o._tenantRecaptchaConfigs[o.tenantId]!==void 0)return o._tenantRecaptchaConfigs[o.tenantId].siteKey}return new Promise(async(c,u)=>{wI(o,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(h=>{if(h.recaptchaKey===void 0)u(new Error("recaptcha Enterprise site key undefined"));else{const d=new AI(h);return o.tenantId==null?o._agentRecaptchaConfig=d:o._tenantRecaptchaConfigs[o.tenantId]=d,c(d.siteKey)}}).catch(h=>{u(h)})})}function i(o,c,u){const h=window.grecaptcha;tE(h)?h.enterprise.ready(()=>{h.enterprise.execute(o,{action:e}).then(d=>{c(d)}).catch(()=>{c(hA)})}):u(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new GI().execute("siteKey",{action:"verify"}):new Promise((o,c)=>{n(this.auth).then(u=>{if(!r&&tE(window.grecaptcha))i(u,o,c);else{if(typeof window>"u"){c(new Error("RecaptchaVerifier is only supported in browser"));return}let h=jI();h.length!==0&&(h+=u),fA(h).then(()=>{i(u,o,c)}).catch(d=>{c(d)})}}).catch(u=>{c(u)})})}}async function oE(t,e,r,n=!1,i=!1){const o=new WI(t);let c;if(i)c=hA;else try{c=await o.verify(r)}catch{c=await o.verify(r,!0)}const u=Object.assign({},e);if(r==="mfaSmsEnrollment"||r==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in u){const h=u.phoneEnrollmentInfo.phoneNumber,d=u.phoneEnrollmentInfo.recaptchaToken;Object.assign(u,{phoneEnrollmentInfo:{phoneNumber:h,recaptchaToken:d,captchaResponse:c,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in u){const h=u.phoneSignInInfo.recaptchaToken;Object.assign(u,{phoneSignInInfo:{recaptchaToken:h,captchaResponse:c,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return u}return n?Object.assign(u,{captchaResp:c}):Object.assign(u,{captchaResponse:c}),Object.assign(u,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(u,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),u}async function lE(t,e,r,n,i){var o;if(!((o=t._getRecaptchaConfig())===null||o===void 0)&&o.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const c=await oE(t,e,r,r==="getOobCode");return n(t,c)}else return n(t,e).catch(async c=>{if(c.code==="auth/missing-recaptcha-token"){console.log(`${r} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const u=await oE(t,e,r,r==="getOobCode");return n(t,u)}else return Promise.reject(c)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function XI(t,e){const r=e1(t,"auth");if(r.isInitialized()){const i=r.getImmediate(),o=r.getOptions();if(Lo(o,e??{}))return i;ma(i,"already-initialized")}return r.initialize({options:e})}function YI(t,e){const r=e?.persistence||[],n=(Array.isArray(r)?r:[r]).map(Di);e?.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(n,e?.popupRedirectResolver)}function $I(t,e,r){const n=Wo(t);tt(/^https?:\/\//.test(e),n,"invalid-emulator-scheme");const i=!1,o=dA(e),{host:c,port:u}=QI(e),h=u===null?"":`:${u}`,d={url:`${o}//${c}${h}/`},g=Object.freeze({host:c,port:u,protocol:o.replace(":",""),options:Object.freeze({disableWarnings:i})});if(!n._canInitEmulator){tt(n.config.emulator&&n.emulatorConfig,n,"emulator-config-failed"),tt(Lo(d,n.config.emulator)&&Lo(g,n.emulatorConfig),n,"emulator-config-failed");return}n.config.emulator=d,n.emulatorConfig=g,n.settings.appVerificationDisabledForTesting=!0,mc(c)?(j2(`${o}//${c}${h}`),z2("Auth",!0)):ZI()}function dA(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function QI(t){const e=dA(t),r=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!r)return{host:"",port:null};const n=r[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(n);if(i){const o=i[1];return{host:o,port:cE(n.substr(o.length+1))}}else{const[o,c]=n.split(":");return{host:o,port:cE(c)}}}function cE(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function ZI(){function t(){const e=document.createElement("p"),r=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",r.position="fixed",r.width="100%",r.backgroundColor="#ffffff",r.border=".1em solid #000000",r.color="#b50000",r.bottom="0px",r.left="0px",r.margin="0px",r.zIndex="10000",r.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class o1{constructor(e,r){this.providerId=e,this.signInMethod=r}toJSON(){return Ii("not implemented")}_getIdTokenResponse(e){return Ii("not implemented")}_linkToIdToken(e,r){return Ii("not implemented")}_getReauthenticationResolver(e){return Ii("not implemented")}}async function JI(t,e){return $s(t,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function e3(t,e){return sd(t,"POST","/v1/accounts:signInWithPassword",Ko(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function t3(t,e){return sd(t,"POST","/v1/accounts:signInWithEmailLink",Ko(t,e))}async function r3(t,e){return sd(t,"POST","/v1/accounts:signInWithEmailLink",Ko(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tf extends o1{constructor(e,r,n,i=null){super("password",n),this._email=e,this._password=r,this._tenantId=i}static _fromEmailAndPassword(e,r){return new tf(e,r,"password")}static _fromEmailAndCode(e,r,n=null){return new tf(e,r,"emailLink",n)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const r=typeof e=="string"?JSON.parse(e):e;if(r?.email&&r?.password){if(r.signInMethod==="password")return this._fromEmailAndPassword(r.email,r.password);if(r.signInMethod==="emailLink")return this._fromEmailAndCode(r.email,r.password,r.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const r={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return lE(e,r,"signInWithPassword",e3);case"emailLink":return t3(e,{email:this._email,oobCode:this._password});default:ma(e,"internal-error")}}async _linkToIdToken(e,r){switch(this.signInMethod){case"password":const n={idToken:r,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return lE(e,n,"signUpPassword",JI);case"emailLink":return r3(e,{idToken:r,email:this._email,oobCode:this._password});default:ma(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Jl(t,e){return sd(t,"POST","/v1/accounts:signInWithIdp",Ko(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const n3="http://localhost";class Uo extends o1{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const r=new Uo(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(r.idToken=e.idToken),e.accessToken&&(r.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(r.nonce=e.nonce),e.pendingToken&&(r.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(r.accessToken=e.oauthToken,r.secret=e.oauthTokenSecret):ma("argument-error"),r}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const r=typeof e=="string"?JSON.parse(e):e,{providerId:n,signInMethod:i}=r,o=t1(r,["providerId","signInMethod"]);if(!n||!i)return null;const c=new Uo(n,i);return c.idToken=o.idToken||void 0,c.accessToken=o.accessToken||void 0,c.secret=o.secret,c.nonce=o.nonce,c.pendingToken=o.pendingToken||null,c}_getIdTokenResponse(e){const r=this.buildRequest();return Jl(e,r)}_linkToIdToken(e,r){const n=this.buildRequest();return n.idToken=r,Jl(e,n)}_getReauthenticationResolver(e){const r=this.buildRequest();return r.autoCreate=!1,Jl(e,r)}buildRequest(){const e={requestUri:n3,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const r={};this.idToken&&(r.id_token=this.idToken),this.accessToken&&(r.access_token=this.accessToken),this.secret&&(r.oauth_token_secret=this.secret),r.providerId=this.providerId,this.nonce&&!this.pendingToken&&(r.nonce=this.nonce),e.postBody=yf(r)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function a3(t){switch(t){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function i3(t){const e=Su(Cu(t)).link,r=e?Su(Cu(e)).deep_link_id:null,n=Su(Cu(t)).deep_link_id;return(n?Su(Cu(n)).link:null)||n||r||e||t}class l1{constructor(e){var r,n,i,o,c,u;const h=Su(Cu(e)),d=(r=h.apiKey)!==null&&r!==void 0?r:null,g=(n=h.oobCode)!==null&&n!==void 0?n:null,_=a3((i=h.mode)!==null&&i!==void 0?i:null);tt(d&&g&&_,"argument-error"),this.apiKey=d,this.operation=_,this.code=g,this.continueUrl=(o=h.continueUrl)!==null&&o!==void 0?o:null,this.languageCode=(c=h.lang)!==null&&c!==void 0?c:null,this.tenantId=(u=h.tenantId)!==null&&u!==void 0?u:null}static parseLink(e){const r=i3(e);try{return new l1(r)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vc{constructor(){this.providerId=vc.PROVIDER_ID}static credential(e,r){return tf._fromEmailAndPassword(e,r)}static credentialWithLink(e,r){const n=l1.parseLink(r);return tt(n,"argument-error"),tf._fromEmailAndCode(e,n.code,n.tenantId)}}vc.PROVIDER_ID="password";vc.EMAIL_PASSWORD_SIGN_IN_METHOD="password";vc.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class c1{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tf extends c1{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Es extends Tf{constructor(){super("facebook.com")}static credential(e){return Uo._fromParams({providerId:Es.PROVIDER_ID,signInMethod:Es.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Es.credentialFromTaggedObject(e)}static credentialFromError(e){return Es.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Es.credential(e.oauthAccessToken)}catch{return null}}}Es.FACEBOOK_SIGN_IN_METHOD="facebook.com";Es.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bi extends Tf{constructor(){super("google.com"),this.addScope("profile")}static credential(e,r){return Uo._fromParams({providerId:bi.PROVIDER_ID,signInMethod:bi.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:r})}static credentialFromResult(e){return bi.credentialFromTaggedObject(e)}static credentialFromError(e){return bi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:r,oauthAccessToken:n}=e;if(!r&&!n)return null;try{return bi.credential(r,n)}catch{return null}}}bi.GOOGLE_SIGN_IN_METHOD="google.com";bi.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ts extends Tf{constructor(){super("github.com")}static credential(e){return Uo._fromParams({providerId:Ts.PROVIDER_ID,signInMethod:Ts.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Ts.credentialFromTaggedObject(e)}static credentialFromError(e){return Ts.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Ts.credential(e.oauthAccessToken)}catch{return null}}}Ts.GITHUB_SIGN_IN_METHOD="github.com";Ts.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class As extends Tf{constructor(){super("twitter.com")}static credential(e,r){return Uo._fromParams({providerId:As.PROVIDER_ID,signInMethod:As.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:r})}static credentialFromResult(e){return As.credentialFromTaggedObject(e)}static credentialFromError(e){return As.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:r,oauthTokenSecret:n}=e;if(!r||!n)return null;try{return As.credential(r,n)}catch{return null}}}As.TWITTER_SIGN_IN_METHOD="twitter.com";As.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sc{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,r,n,i=!1){const o=await Ra._fromIdTokenResponse(e,n,i),c=uE(n);return new sc({user:o,providerId:c,_tokenResponse:n,operationType:r})}static async _forOperation(e,r,n){await e._updateTokensIfNecessary(n,!0);const i=uE(n);return new sc({user:e,providerId:i,_tokenResponse:n,operationType:r})}}function uE(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class O0 extends zi{constructor(e,r,n,i){var o;super(r.code,r.message),this.operationType=n,this.user=i,Object.setPrototypeOf(this,O0.prototype),this.customData={appName:e.name,tenantId:(o=e.tenantId)!==null&&o!==void 0?o:void 0,_serverResponse:r.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(e,r,n,i){return new O0(e,r,n,i)}}function pA(t,e,r,n){return(e==="reauthenticate"?r._getReauthenticationResolver(t):r._getIdTokenResponse(t)).catch(o=>{throw o.code==="auth/multi-factor-auth-required"?O0._fromErrorAndOperation(t,o,e,n):o})}async function s3(t,e,r=!1){const n=await ef(t,e._linkToIdToken(t.auth,await t.getIdToken()),r);return sc._forOperation(t,"link",n)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function o3(t,e,r=!1){const{auth:n}=t;if(ha(n.app))return Promise.reject(Ns(n));const i="reauthenticate";try{const o=await ef(t,pA(n,i,e,t),r);tt(o.idToken,n,"internal-error");const c=i1(o.idToken);tt(c,n,"internal-error");const{sub:u}=c;return tt(t.uid===u,n,"user-mismatch"),sc._forOperation(t,i,o)}catch(o){throw o?.code==="auth/user-not-found"&&ma(n,"user-mismatch"),o}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function mA(t,e,r=!1){if(ha(t.app))return Promise.reject(Ns(t));const n="signIn",i=await pA(t,n,e),o=await sc._fromIdTokenResponse(t,n,i);return r||await t._updateCurrentUser(o.user),o}async function l3(t,e){return mA(Wo(t),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function c3(t){const e=Wo(t);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}function u3(t,e,r){return ha(t.app)?Promise.reject(Ns(t)):l3(qr(t),vc.credential(e,r)).catch(async n=>{throw n.code==="auth/password-does-not-meet-requirements"&&c3(t),n})}function f3(t,e,r,n){return qr(t).onIdTokenChanged(e,r,n)}function h3(t,e,r){return qr(t).beforeAuthStateChanged(e,r)}function d3(t,e,r,n){return qr(t).onAuthStateChanged(e,r,n)}function p3(t){return qr(t).signOut()}const N0="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gA{constructor(e,r){this.storageRetriever=e,this.type=r}_isAvailable(){try{return this.storage?(this.storage.setItem(N0,"1"),this.storage.removeItem(N0),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,r){return this.storage.setItem(e,JSON.stringify(r)),Promise.resolve()}_get(e){const r=this.storage.getItem(e);return Promise.resolve(r?JSON.parse(r):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const m3=1e3,g3=10;class vA extends gA{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,r)=>this.onStorageEvent(e,r),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=cA(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const r of Object.keys(this.listeners)){const n=this.storage.getItem(r),i=this.localCache[r];n!==i&&e(r,i,n)}}onStorageEvent(e,r=!1){if(!e.key){this.forAllChangedKeys((c,u,h)=>{this.notifyListeners(c,h)});return}const n=e.key;r?this.detachListener():this.stopPolling();const i=()=>{const c=this.storage.getItem(n);!r&&this.localCache[n]===c||this.notifyListeners(n,c)},o=this.storage.getItem(n);FI()&&o!==e.newValue&&e.newValue!==e.oldValue?setTimeout(i,g3):i()}notifyListeners(e,r){this.localCache[e]=r;const n=this.listeners[e];if(n)for(const i of Array.from(n))i(r&&JSON.parse(r))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,r,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:r,newValue:n}),!0)})},m3)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,r){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,r){await super._set(e,r),this.localCache[e]=JSON.stringify(r)}async _get(e){const r=await super._get(e);return this.localCache[e]=JSON.stringify(r),r}async _remove(e){await super._remove(e),delete this.localCache[e]}}vA.type="LOCAL";const v3=vA;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _A extends gA{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,r){}_removeListener(e,r){}}_A.type="SESSION";const xA=_A;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _3(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(r){return{fulfilled:!1,reason:r}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ld{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const r=this.receivers.find(i=>i.isListeningto(e));if(r)return r;const n=new ld(e);return this.receivers.push(n),n}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const r=e,{eventId:n,eventType:i,data:o}=r.data,c=this.handlersMap[i];if(!c?.size)return;r.ports[0].postMessage({status:"ack",eventId:n,eventType:i});const u=Array.from(c).map(async d=>d(r.origin,o)),h=await _3(u);r.ports[0].postMessage({status:"done",eventId:n,eventType:i,response:h})}_subscribe(e,r){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(r)}_unsubscribe(e,r){this.handlersMap[e]&&r&&this.handlersMap[e].delete(r),(!r||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}ld.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function u1(t="",e=10){let r="";for(let n=0;n<e;n++)r+=Math.floor(Math.random()*10);return t+r}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class x3{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,r,n=50){const i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let o,c;return new Promise((u,h)=>{const d=u1("",20);i.port1.start();const g=setTimeout(()=>{h(new Error("unsupported_event"))},n);c={messageChannel:i,onMessage(_){const x=_;if(x.data.eventId===d)switch(x.data.status){case"ack":clearTimeout(g),o=setTimeout(()=>{h(new Error("timeout"))},3e3);break;case"done":clearTimeout(o),u(x.data.response);break;default:clearTimeout(g),clearTimeout(o),h(new Error("invalid_response"));break}}},this.handlers.add(c),i.port1.addEventListener("message",c.onMessage),this.target.postMessage({eventType:e,eventId:d,data:r},[i.port2])}).finally(()=>{c&&this.removeMessageHandler(c)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ei(){return window}function y3(t){ei().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yA(){return typeof ei().WorkerGlobalScope<"u"&&typeof ei().importScripts=="function"}async function E3(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function T3(){var t;return((t=navigator?.serviceWorker)===null||t===void 0?void 0:t.controller)||null}function A3(){return yA()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const EA="firebaseLocalStorageDb",w3=1,F0="firebaseLocalStorage",TA="fbase_key";class Af{constructor(e){this.request=e}toPromise(){return new Promise((e,r)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{r(this.request.error)})})}}function cd(t,e){return t.transaction([F0],e?"readwrite":"readonly").objectStore(F0)}function S3(){const t=indexedDB.deleteDatabase(EA);return new Af(t).toPromise()}function pg(){const t=indexedDB.open(EA,w3);return new Promise((e,r)=>{t.addEventListener("error",()=>{r(t.error)}),t.addEventListener("upgradeneeded",()=>{const n=t.result;try{n.createObjectStore(F0,{keyPath:TA})}catch(i){r(i)}}),t.addEventListener("success",async()=>{const n=t.result;n.objectStoreNames.contains(F0)?e(n):(n.close(),await S3(),e(await pg()))})})}async function fE(t,e,r){const n=cd(t,!0).put({[TA]:e,value:r});return new Af(n).toPromise()}async function C3(t,e){const r=cd(t,!1).get(e),n=await new Af(r).toPromise();return n===void 0?null:n.value}function hE(t,e){const r=cd(t,!0).delete(e);return new Af(r).toPromise()}const R3=800,k3=3;class AA{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await pg(),this.db)}async _withRetries(e){let r=0;for(;;)try{const n=await this._openDb();return await e(n)}catch(n){if(r++>k3)throw n;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return yA()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=ld._getInstance(A3()),this.receiver._subscribe("keyChanged",async(e,r)=>({keyProcessed:(await this._poll()).includes(r.key)})),this.receiver._subscribe("ping",async(e,r)=>["keyChanged"])}async initializeSender(){var e,r;if(this.activeServiceWorker=await E3(),!this.activeServiceWorker)return;this.sender=new x3(this.activeServiceWorker);const n=await this.sender._send("ping",{},800);n&&!((e=n[0])===null||e===void 0)&&e.fulfilled&&!((r=n[0])===null||r===void 0)&&r.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||T3()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await pg();return await fE(e,N0,"1"),await hE(e,N0),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,r){return this._withPendingWrite(async()=>(await this._withRetries(n=>fE(n,e,r)),this.localCache[e]=r,this.notifyServiceWorker(e)))}async _get(e){const r=await this._withRetries(n=>C3(n,e));return this.localCache[e]=r,r}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(r=>hE(r,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(i=>{const o=cd(i,!1).getAll();return new Af(o).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const r=[],n=new Set;if(e.length!==0)for(const{fbase_key:i,value:o}of e)n.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(o)&&(this.notifyListeners(i,o),r.push(i));for(const i of Object.keys(this.localCache))this.localCache[i]&&!n.has(i)&&(this.notifyListeners(i,null),r.push(i));return r}notifyListeners(e,r){this.localCache[e]=r;const n=this.listeners[e];if(n)for(const i of Array.from(n))i(r)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),R3)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,r){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}AA.type="LOCAL";const b3=AA;new Ef(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wA(t,e){return e?Di(e):(tt(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class f1 extends o1{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Jl(e,this._buildIdpRequest())}_linkToIdToken(e,r){return Jl(e,this._buildIdpRequest(r))}_getReauthenticationResolver(e){return Jl(e,this._buildIdpRequest())}_buildIdpRequest(e){const r={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(r.idToken=e),r}}function I3(t){return mA(t.auth,new f1(t),t.bypassAuthState)}function D3(t){const{auth:e,user:r}=t;return tt(r,e,"internal-error"),o3(r,new f1(t),t.bypassAuthState)}async function O3(t){const{auth:e,user:r}=t;return tt(r,e,"internal-error"),s3(r,new f1(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SA{constructor(e,r,n,i,o=!1){this.auth=e,this.resolver=n,this.user=i,this.bypassAuthState=o,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(r)?r:[r]}execute(){return new Promise(async(e,r)=>{this.pendingPromise={resolve:e,reject:r};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(n){this.reject(n)}})}async onAuthEvent(e){const{urlResponse:r,sessionId:n,postBody:i,tenantId:o,error:c,type:u}=e;if(c){this.reject(c);return}const h={auth:this.auth,requestUri:r,sessionId:n,tenantId:o||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(u)(h))}catch(d){this.reject(d)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return I3;case"linkViaPopup":case"linkViaRedirect":return O3;case"reauthViaPopup":case"reauthViaRedirect":return D3;default:ma(this.auth,"internal-error")}}resolve(e){Ui(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Ui(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const N3=new Ef(2e3,1e4);async function F3(t,e,r){if(ha(t.app))return Promise.reject(Da(t,"operation-not-supported-in-this-environment"));const n=Wo(t);pI(t,e,c1);const i=wA(n,r);return new Do(n,"signInViaPopup",e,i).executeNotNull()}class Do extends SA{constructor(e,r,n,i,o){super(e,r,i,o),this.provider=n,this.authWindow=null,this.pollId=null,Do.currentPopupAction&&Do.currentPopupAction.cancel(),Do.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return tt(e,this.auth,"internal-error"),e}async onExecution(){Ui(this.filter.length===1,"Popup operations only handle one event");const e=u1();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(r=>{this.reject(r)}),this.resolver._isIframeWebStorageSupported(this.auth,r=>{r||this.reject(Da(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(Da(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Do.currentPopupAction=null}pollUserCancellation(){const e=()=>{var r,n;if(!((n=(r=this.authWindow)===null||r===void 0?void 0:r.window)===null||n===void 0)&&n.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Da(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,N3.get())};e()}}Do.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const P3="pendingRedirect",v0=new Map;class M3 extends SA{constructor(e,r,n=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],r,void 0,n),this.eventId=null}async execute(){let e=v0.get(this.auth._key());if(!e){try{const n=await L3(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(n)}catch(r){e=()=>Promise.reject(r)}v0.set(this.auth._key(),e)}return this.bypassAuthState||v0.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const r=await this.auth._redirectUserForId(e.eventId);if(r)return this.user=r,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function L3(t,e){const r=B3(e),n=U3(t);if(!await n._isAvailable())return!1;const i=await n._get(r)==="true";return await n._remove(r),i}function V3(t,e){v0.set(t._key(),e)}function U3(t){return Di(t._redirectPersistence)}function B3(t){return g0(P3,t.config.apiKey,t.name)}async function j3(t,e,r=!1){if(ha(t.app))return Promise.reject(Ns(t));const n=Wo(t),i=wA(n,e),c=await new M3(n,i,r).execute();return c&&!r&&(delete c.user._redirectEventId,await n._persistUserIfCurrent(c.user),await n._setRedirectUser(null,e)),c}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const z3=10*60*1e3;class H3{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let r=!1;return this.consumers.forEach(n=>{this.isEventForConsumer(e,n)&&(r=!0,this.sendToConsumer(e,n),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!G3(e)||(this.hasHandledPotentialRedirect=!0,r||(this.queuedRedirectEvent=e,r=!0)),r}sendToConsumer(e,r){var n;if(e.error&&!CA(e)){const i=((n=e.error.code)===null||n===void 0?void 0:n.split("auth/")[1])||"internal-error";r.onError(Da(this.auth,i))}else r.onAuthEvent(e)}isEventForConsumer(e,r){const n=r.eventId===null||!!e.eventId&&e.eventId===r.eventId;return r.filter.includes(e.type)&&n}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=z3&&this.cachedEventUids.clear(),this.cachedEventUids.has(dE(e))}saveEventToCache(e){this.cachedEventUids.add(dE(e)),this.lastProcessedEventTime=Date.now()}}function dE(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function CA({type:t,error:e}){return t==="unknown"&&e?.code==="auth/no-auth-event"}function G3(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return CA(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function q3(t,e={}){return $s(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const K3=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,W3=/^https?/;async function X3(t){if(t.config.emulator)return;const{authorizedDomains:e}=await q3(t);for(const r of e)try{if(Y3(r))return}catch{}ma(t,"unauthorized-domain")}function Y3(t){const e=hg(),{protocol:r,hostname:n}=new URL(e);if(t.startsWith("chrome-extension://")){const c=new URL(t);return c.hostname===""&&n===""?r==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):r==="chrome-extension:"&&c.hostname===n}if(!W3.test(r))return!1;if(K3.test(t))return n===t;const i=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(n)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $3=new Ef(3e4,6e4);function pE(){const t=ei().___jsl;if(t?.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let r=0;r<t.CP.length;r++)t.CP[r]=null}}function Q3(t){return new Promise((e,r)=>{var n,i,o;function c(){pE(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{pE(),r(Da(t,"network-request-failed"))},timeout:$3.get()})}if(!((i=(n=ei().gapi)===null||n===void 0?void 0:n.iframes)===null||i===void 0)&&i.Iframe)e(gapi.iframes.getContext());else if(!((o=ei().gapi)===null||o===void 0)&&o.load)c();else{const u=HI("iframefcb");return ei()[u]=()=>{gapi.load?c():r(Da(t,"network-request-failed"))},fA(`${zI()}?onload=${u}`).catch(h=>r(h))}}).catch(e=>{throw _0=null,e})}let _0=null;function Z3(t){return _0=_0||Q3(t),_0}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const J3=new Ef(5e3,15e3),eD="__/auth/iframe",tD="emulator/auth/iframe",rD={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},nD=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function aD(t){const e=t.config;tt(e.authDomain,t,"auth-domain-config-required");const r=e.emulator?a1(e,tD):`https://${t.config.authDomain}/${eD}`,n={apiKey:e.apiKey,appName:t.name,v:gc},i=nD.get(t.config.apiHost);i&&(n.eid=i);const o=t._getFrameworks();return o.length&&(n.fw=o.join(",")),`${r}?${yf(n).slice(1)}`}async function iD(t){const e=await Z3(t),r=ei().gapi;return tt(r,t,"internal-error"),e.open({where:document.body,url:aD(t),messageHandlersFilter:r.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:rD,dontclear:!0},n=>new Promise(async(i,o)=>{await n.restyle({setHideOnLeave:!1});const c=Da(t,"network-request-failed"),u=ei().setTimeout(()=>{o(c)},J3.get());function h(){ei().clearTimeout(u),i(n)}n.ping(h).then(h,()=>{o(c)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sD={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},oD=500,lD=600,cD="_blank",uD="http://localhost";class mE{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function fD(t,e,r,n=oD,i=lD){const o=Math.max((window.screen.availHeight-i)/2,0).toString(),c=Math.max((window.screen.availWidth-n)/2,0).toString();let u="";const h=Object.assign(Object.assign({},sD),{width:n.toString(),height:i.toString(),top:o,left:c}),d=pn().toLowerCase();r&&(u=aA(d)?cD:r),rA(d)&&(e=e||uD,h.scrollbars="yes");const g=Object.entries(h).reduce((x,[A,S])=>`${x}${A}=${S},`,"");if(NI(d)&&u!=="_self")return hD(e||"",u),new mE(null);const _=window.open(e||"",u,g);tt(_,t,"popup-blocked");try{_.focus()}catch{}return new mE(_)}function hD(t,e){const r=document.createElement("a");r.href=t,r.target=e;const n=document.createEvent("MouseEvent");n.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),r.dispatchEvent(n)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dD="__/auth/handler",pD="emulator/auth/handler",mD=encodeURIComponent("fac");async function gE(t,e,r,n,i,o){tt(t.config.authDomain,t,"auth-domain-config-required"),tt(t.config.apiKey,t,"invalid-api-key");const c={apiKey:t.config.apiKey,appName:t.name,authType:r,redirectUrl:n,v:gc,eventId:i};if(e instanceof c1){e.setDefaultLanguage(t.languageCode),c.providerId=e.providerId||"",eb(e.getCustomParameters())||(c.customParameters=JSON.stringify(e.getCustomParameters()));for(const[g,_]of Object.entries({}))c[g]=_}if(e instanceof Tf){const g=e.getScopes().filter(_=>_!=="");g.length>0&&(c.scopes=g.join(","))}t.tenantId&&(c.tid=t.tenantId);const u=c;for(const g of Object.keys(u))u[g]===void 0&&delete u[g];const h=await t._getAppCheckToken(),d=h?`#${mD}=${encodeURIComponent(h)}`:"";return`${gD(t)}?${yf(u).slice(1)}${d}`}function gD({config:t}){return t.emulator?a1(t,pD):`https://${t.authDomain}/${dD}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hm="webStorageSupport";class vD{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=xA,this._completeRedirectFn=j3,this._overrideRedirectResult=V3}async _openPopup(e,r,n,i){var o;Ui((o=this.eventManagers[e._key()])===null||o===void 0?void 0:o.manager,"_initialize() not called before _openPopup()");const c=await gE(e,r,n,hg(),i);return fD(e,c,u1())}async _openRedirect(e,r,n,i){await this._originValidation(e);const o=await gE(e,r,n,hg(),i);return y3(o),new Promise(()=>{})}_initialize(e){const r=e._key();if(this.eventManagers[r]){const{manager:i,promise:o}=this.eventManagers[r];return i?Promise.resolve(i):(Ui(o,"If manager is not set, promise should be"),o)}const n=this.initAndGetManager(e);return this.eventManagers[r]={promise:n},n.catch(()=>{delete this.eventManagers[r]}),n}async initAndGetManager(e){const r=await iD(e),n=new H3(e);return r.register("authEvent",i=>(tt(i?.authEvent,e,"invalid-auth-event"),{status:n.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:n},this.iframes[e._key()]=r,n}_isIframeWebStorageSupported(e,r){this.iframes[e._key()].send(Hm,{type:Hm},i=>{var o;const c=(o=i?.[0])===null||o===void 0?void 0:o[Hm];c!==void 0&&r(!!c),ma(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const r=e._key();return this.originValidationPromises[r]||(this.originValidationPromises[r]=X3(e)),this.originValidationPromises[r]}get _shouldInitProactively(){return cA()||nA()||s1()}}const _D=vD;var vE="@firebase/auth",_E="1.10.8";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xD{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const r=this.auth.onIdTokenChanged(n=>{e(n?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,r),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const r=this.internalListeners.get(e);r&&(this.internalListeners.delete(e),r(),this.updateProactiveRefresh())}assertAuthConfigured(){tt(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yD(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function ED(t){ic(new Vo("auth",(e,{options:r})=>{const n=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),o=e.getProvider("app-check-internal"),{apiKey:c,authDomain:u}=n.options;tt(c&&!c.includes(":"),"invalid-api-key",{appName:n.name});const h={apiKey:c,authDomain:u,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:uA(t)},d=new UI(n,i,o,h);return YI(d,r),d},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,r,n)=>{e.getProvider("auth-internal").initialize()})),ic(new Vo("auth-internal",e=>{const r=Wo(e.getProvider("auth").getImmediate());return(n=>new xD(n))(r)},"PRIVATE").setInstantiationMode("EXPLICIT")),Os(vE,_E,yD(t)),Os(vE,_E,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const TD=5*60,AD=B2("authIdTokenMaxAge")||TD;let xE=null;const wD=t=>async e=>{const r=e&&await e.getIdTokenResult(),n=r&&(new Date().getTime()-Date.parse(r.issuedAtTime))/1e3;if(n&&n>AD)return;const i=r?.token;xE!==i&&(xE=i,await fetch(t,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))};function SD(t=K2()){const e=e1(t,"auth");if(e.isInitialized())return e.getImmediate();const r=XI(t,{popupRedirectResolver:_D,persistence:[b3,v3,xA]}),n=B2("authTokenSyncURL");if(n&&typeof isSecureContext=="boolean"&&isSecureContext){const o=new URL(n,location.origin);if(location.origin===o.origin){const c=wD(o.toString());h3(r,c,()=>c(r.currentUser)),f3(r,u=>c(u))}}const i=V2("auth");return i&&$I(r,`http://${i}`),r}function CD(){var t,e;return(e=(t=document.getElementsByTagName("head"))===null||t===void 0?void 0:t[0])!==null&&e!==void 0?e:document}BI({loadJS(t){return new Promise((e,r)=>{const n=document.createElement("script");n.setAttribute("src",t),n.onload=e,n.onerror=i=>{const o=Da("internal-error");o.customData=i,r(o)},n.type="text/javascript",n.charset="UTF-8",CD().appendChild(n)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});ED("Browser");var yE=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Fs,RA;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(C,T){function E(){}E.prototype=T.prototype,C.D=T.prototype,C.prototype=new E,C.prototype.constructor=C,C.C=function(D,b,O){for(var F=Array(arguments.length-2),Fe=2;Fe<arguments.length;Fe++)F[Fe-2]=arguments[Fe];return T.prototype[b].apply(D,F)}}function r(){this.blockSize=-1}function n(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(n,r),n.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(C,T,E){E||(E=0);var D=Array(16);if(typeof T=="string")for(var b=0;16>b;++b)D[b]=T.charCodeAt(E++)|T.charCodeAt(E++)<<8|T.charCodeAt(E++)<<16|T.charCodeAt(E++)<<24;else for(b=0;16>b;++b)D[b]=T[E++]|T[E++]<<8|T[E++]<<16|T[E++]<<24;T=C.g[0],E=C.g[1],b=C.g[2];var O=C.g[3],F=T+(O^E&(b^O))+D[0]+3614090360&4294967295;T=E+(F<<7&4294967295|F>>>25),F=O+(b^T&(E^b))+D[1]+3905402710&4294967295,O=T+(F<<12&4294967295|F>>>20),F=b+(E^O&(T^E))+D[2]+606105819&4294967295,b=O+(F<<17&4294967295|F>>>15),F=E+(T^b&(O^T))+D[3]+3250441966&4294967295,E=b+(F<<22&4294967295|F>>>10),F=T+(O^E&(b^O))+D[4]+4118548399&4294967295,T=E+(F<<7&4294967295|F>>>25),F=O+(b^T&(E^b))+D[5]+1200080426&4294967295,O=T+(F<<12&4294967295|F>>>20),F=b+(E^O&(T^E))+D[6]+2821735955&4294967295,b=O+(F<<17&4294967295|F>>>15),F=E+(T^b&(O^T))+D[7]+4249261313&4294967295,E=b+(F<<22&4294967295|F>>>10),F=T+(O^E&(b^O))+D[8]+1770035416&4294967295,T=E+(F<<7&4294967295|F>>>25),F=O+(b^T&(E^b))+D[9]+2336552879&4294967295,O=T+(F<<12&4294967295|F>>>20),F=b+(E^O&(T^E))+D[10]+4294925233&4294967295,b=O+(F<<17&4294967295|F>>>15),F=E+(T^b&(O^T))+D[11]+2304563134&4294967295,E=b+(F<<22&4294967295|F>>>10),F=T+(O^E&(b^O))+D[12]+1804603682&4294967295,T=E+(F<<7&4294967295|F>>>25),F=O+(b^T&(E^b))+D[13]+4254626195&4294967295,O=T+(F<<12&4294967295|F>>>20),F=b+(E^O&(T^E))+D[14]+2792965006&4294967295,b=O+(F<<17&4294967295|F>>>15),F=E+(T^b&(O^T))+D[15]+1236535329&4294967295,E=b+(F<<22&4294967295|F>>>10),F=T+(b^O&(E^b))+D[1]+4129170786&4294967295,T=E+(F<<5&4294967295|F>>>27),F=O+(E^b&(T^E))+D[6]+3225465664&4294967295,O=T+(F<<9&4294967295|F>>>23),F=b+(T^E&(O^T))+D[11]+643717713&4294967295,b=O+(F<<14&4294967295|F>>>18),F=E+(O^T&(b^O))+D[0]+3921069994&4294967295,E=b+(F<<20&4294967295|F>>>12),F=T+(b^O&(E^b))+D[5]+3593408605&4294967295,T=E+(F<<5&4294967295|F>>>27),F=O+(E^b&(T^E))+D[10]+38016083&4294967295,O=T+(F<<9&4294967295|F>>>23),F=b+(T^E&(O^T))+D[15]+3634488961&4294967295,b=O+(F<<14&4294967295|F>>>18),F=E+(O^T&(b^O))+D[4]+3889429448&4294967295,E=b+(F<<20&4294967295|F>>>12),F=T+(b^O&(E^b))+D[9]+568446438&4294967295,T=E+(F<<5&4294967295|F>>>27),F=O+(E^b&(T^E))+D[14]+3275163606&4294967295,O=T+(F<<9&4294967295|F>>>23),F=b+(T^E&(O^T))+D[3]+4107603335&4294967295,b=O+(F<<14&4294967295|F>>>18),F=E+(O^T&(b^O))+D[8]+1163531501&4294967295,E=b+(F<<20&4294967295|F>>>12),F=T+(b^O&(E^b))+D[13]+2850285829&4294967295,T=E+(F<<5&4294967295|F>>>27),F=O+(E^b&(T^E))+D[2]+4243563512&4294967295,O=T+(F<<9&4294967295|F>>>23),F=b+(T^E&(O^T))+D[7]+1735328473&4294967295,b=O+(F<<14&4294967295|F>>>18),F=E+(O^T&(b^O))+D[12]+2368359562&4294967295,E=b+(F<<20&4294967295|F>>>12),F=T+(E^b^O)+D[5]+4294588738&4294967295,T=E+(F<<4&4294967295|F>>>28),F=O+(T^E^b)+D[8]+2272392833&4294967295,O=T+(F<<11&4294967295|F>>>21),F=b+(O^T^E)+D[11]+1839030562&4294967295,b=O+(F<<16&4294967295|F>>>16),F=E+(b^O^T)+D[14]+4259657740&4294967295,E=b+(F<<23&4294967295|F>>>9),F=T+(E^b^O)+D[1]+2763975236&4294967295,T=E+(F<<4&4294967295|F>>>28),F=O+(T^E^b)+D[4]+1272893353&4294967295,O=T+(F<<11&4294967295|F>>>21),F=b+(O^T^E)+D[7]+4139469664&4294967295,b=O+(F<<16&4294967295|F>>>16),F=E+(b^O^T)+D[10]+3200236656&4294967295,E=b+(F<<23&4294967295|F>>>9),F=T+(E^b^O)+D[13]+681279174&4294967295,T=E+(F<<4&4294967295|F>>>28),F=O+(T^E^b)+D[0]+3936430074&4294967295,O=T+(F<<11&4294967295|F>>>21),F=b+(O^T^E)+D[3]+3572445317&4294967295,b=O+(F<<16&4294967295|F>>>16),F=E+(b^O^T)+D[6]+76029189&4294967295,E=b+(F<<23&4294967295|F>>>9),F=T+(E^b^O)+D[9]+3654602809&4294967295,T=E+(F<<4&4294967295|F>>>28),F=O+(T^E^b)+D[12]+3873151461&4294967295,O=T+(F<<11&4294967295|F>>>21),F=b+(O^T^E)+D[15]+530742520&4294967295,b=O+(F<<16&4294967295|F>>>16),F=E+(b^O^T)+D[2]+3299628645&4294967295,E=b+(F<<23&4294967295|F>>>9),F=T+(b^(E|~O))+D[0]+4096336452&4294967295,T=E+(F<<6&4294967295|F>>>26),F=O+(E^(T|~b))+D[7]+1126891415&4294967295,O=T+(F<<10&4294967295|F>>>22),F=b+(T^(O|~E))+D[14]+2878612391&4294967295,b=O+(F<<15&4294967295|F>>>17),F=E+(O^(b|~T))+D[5]+4237533241&4294967295,E=b+(F<<21&4294967295|F>>>11),F=T+(b^(E|~O))+D[12]+1700485571&4294967295,T=E+(F<<6&4294967295|F>>>26),F=O+(E^(T|~b))+D[3]+2399980690&4294967295,O=T+(F<<10&4294967295|F>>>22),F=b+(T^(O|~E))+D[10]+4293915773&4294967295,b=O+(F<<15&4294967295|F>>>17),F=E+(O^(b|~T))+D[1]+2240044497&4294967295,E=b+(F<<21&4294967295|F>>>11),F=T+(b^(E|~O))+D[8]+1873313359&4294967295,T=E+(F<<6&4294967295|F>>>26),F=O+(E^(T|~b))+D[15]+4264355552&4294967295,O=T+(F<<10&4294967295|F>>>22),F=b+(T^(O|~E))+D[6]+2734768916&4294967295,b=O+(F<<15&4294967295|F>>>17),F=E+(O^(b|~T))+D[13]+1309151649&4294967295,E=b+(F<<21&4294967295|F>>>11),F=T+(b^(E|~O))+D[4]+4149444226&4294967295,T=E+(F<<6&4294967295|F>>>26),F=O+(E^(T|~b))+D[11]+3174756917&4294967295,O=T+(F<<10&4294967295|F>>>22),F=b+(T^(O|~E))+D[2]+718787259&4294967295,b=O+(F<<15&4294967295|F>>>17),F=E+(O^(b|~T))+D[9]+3951481745&4294967295,C.g[0]=C.g[0]+T&4294967295,C.g[1]=C.g[1]+(b+(F<<21&4294967295|F>>>11))&4294967295,C.g[2]=C.g[2]+b&4294967295,C.g[3]=C.g[3]+O&4294967295}n.prototype.u=function(C,T){T===void 0&&(T=C.length);for(var E=T-this.blockSize,D=this.B,b=this.h,O=0;O<T;){if(b==0)for(;O<=E;)i(this,C,O),O+=this.blockSize;if(typeof C=="string"){for(;O<T;)if(D[b++]=C.charCodeAt(O++),b==this.blockSize){i(this,D),b=0;break}}else for(;O<T;)if(D[b++]=C[O++],b==this.blockSize){i(this,D),b=0;break}}this.h=b,this.o+=T},n.prototype.v=function(){var C=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);C[0]=128;for(var T=1;T<C.length-8;++T)C[T]=0;var E=8*this.o;for(T=C.length-8;T<C.length;++T)C[T]=E&255,E/=256;for(this.u(C),C=Array(16),T=E=0;4>T;++T)for(var D=0;32>D;D+=8)C[E++]=this.g[T]>>>D&255;return C};function o(C,T){var E=u;return Object.prototype.hasOwnProperty.call(E,C)?E[C]:E[C]=T(C)}function c(C,T){this.h=T;for(var E=[],D=!0,b=C.length-1;0<=b;b--){var O=C[b]|0;D&&O==T||(E[b]=O,D=!1)}this.g=E}var u={};function h(C){return-128<=C&&128>C?o(C,function(T){return new c([T|0],0>T?-1:0)}):new c([C|0],0>C?-1:0)}function d(C){if(isNaN(C)||!isFinite(C))return _;if(0>C)return w(d(-C));for(var T=[],E=1,D=0;C>=E;D++)T[D]=C/E|0,E*=4294967296;return new c(T,0)}function g(C,T){if(C.length==0)throw Error("number format error: empty string");if(T=T||10,2>T||36<T)throw Error("radix out of range: "+T);if(C.charAt(0)=="-")return w(g(C.substring(1),T));if(0<=C.indexOf("-"))throw Error('number format error: interior "-" character');for(var E=d(Math.pow(T,8)),D=_,b=0;b<C.length;b+=8){var O=Math.min(8,C.length-b),F=parseInt(C.substring(b,b+O),T);8>O?(O=d(Math.pow(T,O)),D=D.j(O).add(d(F))):(D=D.j(E),D=D.add(d(F)))}return D}var _=h(0),x=h(1),A=h(16777216);t=c.prototype,t.m=function(){if(R(this))return-w(this).m();for(var C=0,T=1,E=0;E<this.g.length;E++){var D=this.i(E);C+=(0<=D?D:4294967296+D)*T,T*=4294967296}return C},t.toString=function(C){if(C=C||10,2>C||36<C)throw Error("radix out of range: "+C);if(S(this))return"0";if(R(this))return"-"+w(this).toString(C);for(var T=d(Math.pow(C,6)),E=this,D="";;){var b=J(E,T).g;E=B(E,b.j(T));var O=((0<E.g.length?E.g[0]:E.h)>>>0).toString(C);if(E=b,S(E))return O+D;for(;6>O.length;)O="0"+O;D=O+D}},t.i=function(C){return 0>C?0:C<this.g.length?this.g[C]:this.h};function S(C){if(C.h!=0)return!1;for(var T=0;T<C.g.length;T++)if(C.g[T]!=0)return!1;return!0}function R(C){return C.h==-1}t.l=function(C){return C=B(this,C),R(C)?-1:S(C)?0:1};function w(C){for(var T=C.g.length,E=[],D=0;D<T;D++)E[D]=~C.g[D];return new c(E,~C.h).add(x)}t.abs=function(){return R(this)?w(this):this},t.add=function(C){for(var T=Math.max(this.g.length,C.g.length),E=[],D=0,b=0;b<=T;b++){var O=D+(this.i(b)&65535)+(C.i(b)&65535),F=(O>>>16)+(this.i(b)>>>16)+(C.i(b)>>>16);D=F>>>16,O&=65535,F&=65535,E[b]=F<<16|O}return new c(E,E[E.length-1]&-2147483648?-1:0)};function B(C,T){return C.add(w(T))}t.j=function(C){if(S(this)||S(C))return _;if(R(this))return R(C)?w(this).j(w(C)):w(w(this).j(C));if(R(C))return w(this.j(w(C)));if(0>this.l(A)&&0>C.l(A))return d(this.m()*C.m());for(var T=this.g.length+C.g.length,E=[],D=0;D<2*T;D++)E[D]=0;for(D=0;D<this.g.length;D++)for(var b=0;b<C.g.length;b++){var O=this.i(D)>>>16,F=this.i(D)&65535,Fe=C.i(b)>>>16,Ce=C.i(b)&65535;E[2*D+2*b]+=F*Ce,H(E,2*D+2*b),E[2*D+2*b+1]+=O*Ce,H(E,2*D+2*b+1),E[2*D+2*b+1]+=F*Fe,H(E,2*D+2*b+1),E[2*D+2*b+2]+=O*Fe,H(E,2*D+2*b+2)}for(D=0;D<T;D++)E[D]=E[2*D+1]<<16|E[2*D];for(D=T;D<2*T;D++)E[D]=0;return new c(E,0)};function H(C,T){for(;(C[T]&65535)!=C[T];)C[T+1]+=C[T]>>>16,C[T]&=65535,T++}function N(C,T){this.g=C,this.h=T}function J(C,T){if(S(T))throw Error("division by zero");if(S(C))return new N(_,_);if(R(C))return T=J(w(C),T),new N(w(T.g),w(T.h));if(R(T))return T=J(C,w(T)),new N(w(T.g),T.h);if(30<C.g.length){if(R(C)||R(T))throw Error("slowDivide_ only works with positive integers.");for(var E=x,D=T;0>=D.l(C);)E=re(E),D=re(D);var b=ne(E,1),O=ne(D,1);for(D=ne(D,2),E=ne(E,2);!S(D);){var F=O.add(D);0>=F.l(C)&&(b=b.add(E),O=F),D=ne(D,1),E=ne(E,1)}return T=B(C,b.j(T)),new N(b,T)}for(b=_;0<=C.l(T);){for(E=Math.max(1,Math.floor(C.m()/T.m())),D=Math.ceil(Math.log(E)/Math.LN2),D=48>=D?1:Math.pow(2,D-48),O=d(E),F=O.j(T);R(F)||0<F.l(C);)E-=D,O=d(E),F=O.j(T);S(O)&&(O=x),b=b.add(O),C=B(C,F)}return new N(b,C)}t.A=function(C){return J(this,C).h},t.and=function(C){for(var T=Math.max(this.g.length,C.g.length),E=[],D=0;D<T;D++)E[D]=this.i(D)&C.i(D);return new c(E,this.h&C.h)},t.or=function(C){for(var T=Math.max(this.g.length,C.g.length),E=[],D=0;D<T;D++)E[D]=this.i(D)|C.i(D);return new c(E,this.h|C.h)},t.xor=function(C){for(var T=Math.max(this.g.length,C.g.length),E=[],D=0;D<T;D++)E[D]=this.i(D)^C.i(D);return new c(E,this.h^C.h)};function re(C){for(var T=C.g.length+1,E=[],D=0;D<T;D++)E[D]=C.i(D)<<1|C.i(D-1)>>>31;return new c(E,C.h)}function ne(C,T){var E=T>>5;T%=32;for(var D=C.g.length-E,b=[],O=0;O<D;O++)b[O]=0<T?C.i(O+E)>>>T|C.i(O+E+1)<<32-T:C.i(O+E);return new c(b,C.h)}n.prototype.digest=n.prototype.v,n.prototype.reset=n.prototype.s,n.prototype.update=n.prototype.u,RA=n,c.prototype.add=c.prototype.add,c.prototype.multiply=c.prototype.j,c.prototype.modulo=c.prototype.A,c.prototype.compare=c.prototype.l,c.prototype.toNumber=c.prototype.m,c.prototype.toString=c.prototype.toString,c.prototype.getBits=c.prototype.i,c.fromNumber=d,c.fromString=g,Fs=c}).apply(typeof yE<"u"?yE:typeof self<"u"?self:typeof window<"u"?window:{});var e0=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var kA,Ru,bA,x0,mg,IA,DA,OA;(function(){var t,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(p,y,k){return p==Array.prototype||p==Object.prototype||(p[y]=k.value),p};function r(p){p=[typeof globalThis=="object"&&globalThis,p,typeof window=="object"&&window,typeof self=="object"&&self,typeof e0=="object"&&e0];for(var y=0;y<p.length;++y){var k=p[y];if(k&&k.Math==Math)return k}throw Error("Cannot find global object")}var n=r(this);function i(p,y){if(y)e:{var k=n;p=p.split(".");for(var V=0;V<p.length-1;V++){var fe=p[V];if(!(fe in k))break e;k=k[fe]}p=p[p.length-1],V=k[p],y=y(V),y!=V&&y!=null&&e(k,p,{configurable:!0,writable:!0,value:y})}}function o(p,y){p instanceof String&&(p+="");var k=0,V=!1,fe={next:function(){if(!V&&k<p.length){var ye=k++;return{value:y(ye,p[ye]),done:!1}}return V=!0,{done:!0,value:void 0}}};return fe[Symbol.iterator]=function(){return fe},fe}i("Array.prototype.values",function(p){return p||function(){return o(this,function(y,k){return k})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var c=c||{},u=this||self;function h(p){var y=typeof p;return y=y!="object"?y:p?Array.isArray(p)?"array":y:"null",y=="array"||y=="object"&&typeof p.length=="number"}function d(p){var y=typeof p;return y=="object"&&p!=null||y=="function"}function g(p,y,k){return p.call.apply(p.bind,arguments)}function _(p,y,k){if(!p)throw Error();if(2<arguments.length){var V=Array.prototype.slice.call(arguments,2);return function(){var fe=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(fe,V),p.apply(y,fe)}}return function(){return p.apply(y,arguments)}}function x(p,y,k){return x=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?g:_,x.apply(null,arguments)}function A(p,y){var k=Array.prototype.slice.call(arguments,1);return function(){var V=k.slice();return V.push.apply(V,arguments),p.apply(this,V)}}function S(p,y){function k(){}k.prototype=y.prototype,p.aa=y.prototype,p.prototype=new k,p.prototype.constructor=p,p.Qb=function(V,fe,ye){for(var Ve=Array(arguments.length-2),Rt=2;Rt<arguments.length;Rt++)Ve[Rt-2]=arguments[Rt];return y.prototype[fe].apply(V,Ve)}}function R(p){const y=p.length;if(0<y){const k=Array(y);for(let V=0;V<y;V++)k[V]=p[V];return k}return[]}function w(p,y){for(let k=1;k<arguments.length;k++){const V=arguments[k];if(h(V)){const fe=p.length||0,ye=V.length||0;p.length=fe+ye;for(let Ve=0;Ve<ye;Ve++)p[fe+Ve]=V[Ve]}else p.push(V)}}class B{constructor(y,k){this.i=y,this.j=k,this.h=0,this.g=null}get(){let y;return 0<this.h?(this.h--,y=this.g,this.g=y.next,y.next=null):y=this.i(),y}}function H(p){return/^[\s\xa0]*$/.test(p)}function N(){var p=u.navigator;return p&&(p=p.userAgent)?p:""}function J(p){return J[" "](p),p}J[" "]=function(){};var re=N().indexOf("Gecko")!=-1&&!(N().toLowerCase().indexOf("webkit")!=-1&&N().indexOf("Edge")==-1)&&!(N().indexOf("Trident")!=-1||N().indexOf("MSIE")!=-1)&&N().indexOf("Edge")==-1;function ne(p,y,k){for(const V in p)y.call(k,p[V],V,p)}function C(p,y){for(const k in p)y.call(void 0,p[k],k,p)}function T(p){const y={};for(const k in p)y[k]=p[k];return y}const E="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function D(p,y){let k,V;for(let fe=1;fe<arguments.length;fe++){V=arguments[fe];for(k in V)p[k]=V[k];for(let ye=0;ye<E.length;ye++)k=E[ye],Object.prototype.hasOwnProperty.call(V,k)&&(p[k]=V[k])}}function b(p){var y=1;p=p.split(":");const k=[];for(;0<y&&p.length;)k.push(p.shift()),y--;return p.length&&k.push(p.join(":")),k}function O(p){u.setTimeout(()=>{throw p},0)}function F(){var p=te;let y=null;return p.g&&(y=p.g,p.g=p.g.next,p.g||(p.h=null),y.next=null),y}class Fe{constructor(){this.h=this.g=null}add(y,k){const V=Ce.get();V.set(y,k),this.h?this.h.next=V:this.g=V,this.h=V}}var Ce=new B(()=>new ae,p=>p.reset());class ae{constructor(){this.next=this.g=this.h=null}set(y,k){this.h=y,this.g=k,this.next=null}reset(){this.next=this.g=this.h=null}}let oe,Oe=!1,te=new Fe,G=()=>{const p=u.Promise.resolve(void 0);oe=()=>{p.then(se)}};var se=()=>{for(var p;p=F();){try{p.h.call(p.g)}catch(k){O(k)}var y=Ce;y.j(p),100>y.h&&(y.h++,p.next=y.g,y.g=p)}Oe=!1};function M(){this.s=this.s,this.C=this.C}M.prototype.s=!1,M.prototype.ma=function(){this.s||(this.s=!0,this.N())},M.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function z(p,y){this.type=p,this.g=this.target=y,this.defaultPrevented=!1}z.prototype.h=function(){this.defaultPrevented=!0};var Q=function(){if(!u.addEventListener||!Object.defineProperty)return!1;var p=!1,y=Object.defineProperty({},"passive",{get:function(){p=!0}});try{const k=()=>{};u.addEventListener("test",k,y),u.removeEventListener("test",k,y)}catch{}return p}();function Z(p,y){if(z.call(this,p?p.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,p){var k=this.type=p.type,V=p.changedTouches&&p.changedTouches.length?p.changedTouches[0]:null;if(this.target=p.target||p.srcElement,this.g=y,y=p.relatedTarget){if(re){e:{try{J(y.nodeName);var fe=!0;break e}catch{}fe=!1}fe||(y=null)}}else k=="mouseover"?y=p.fromElement:k=="mouseout"&&(y=p.toElement);this.relatedTarget=y,V?(this.clientX=V.clientX!==void 0?V.clientX:V.pageX,this.clientY=V.clientY!==void 0?V.clientY:V.pageY,this.screenX=V.screenX||0,this.screenY=V.screenY||0):(this.clientX=p.clientX!==void 0?p.clientX:p.pageX,this.clientY=p.clientY!==void 0?p.clientY:p.pageY,this.screenX=p.screenX||0,this.screenY=p.screenY||0),this.button=p.button,this.key=p.key||"",this.ctrlKey=p.ctrlKey,this.altKey=p.altKey,this.shiftKey=p.shiftKey,this.metaKey=p.metaKey,this.pointerId=p.pointerId||0,this.pointerType=typeof p.pointerType=="string"?p.pointerType:ue[p.pointerType]||"",this.state=p.state,this.i=p,p.defaultPrevented&&Z.aa.h.call(this)}}S(Z,z);var ue={2:"touch",3:"pen",4:"mouse"};Z.prototype.h=function(){Z.aa.h.call(this);var p=this.i;p.preventDefault?p.preventDefault():p.returnValue=!1};var De="closure_listenable_"+(1e6*Math.random()|0),Ee=0;function we(p,y,k,V,fe){this.listener=p,this.proxy=null,this.src=y,this.type=k,this.capture=!!V,this.ha=fe,this.key=++Ee,this.da=this.fa=!1}function Te(p){p.da=!0,p.listener=null,p.proxy=null,p.src=null,p.ha=null}function Ue(p){this.src=p,this.g={},this.h=0}Ue.prototype.add=function(p,y,k,V,fe){var ye=p.toString();p=this.g[ye],p||(p=this.g[ye]=[],this.h++);var Ve=nt(p,y,V,fe);return-1<Ve?(y=p[Ve],k||(y.fa=!1)):(y=new we(y,this.src,ye,!!V,fe),y.fa=k,p.push(y)),y};function X(p,y){var k=y.type;if(k in p.g){var V=p.g[k],fe=Array.prototype.indexOf.call(V,y,void 0),ye;(ye=0<=fe)&&Array.prototype.splice.call(V,fe,1),ye&&(Te(y),p.g[k].length==0&&(delete p.g[k],p.h--))}}function nt(p,y,k,V){for(var fe=0;fe<p.length;++fe){var ye=p[fe];if(!ye.da&&ye.listener==y&&ye.capture==!!k&&ye.ha==V)return fe}return-1}var qe="closure_lm_"+(1e6*Math.random()|0),We={};function Be(p,y,k,V,fe){if(Array.isArray(y)){for(var ye=0;ye<y.length;ye++)Be(p,y[ye],k,V,fe);return null}return k=er(k),p&&p[De]?p.K(y,k,d(V)?!!V.capture:!1,fe):Pe(p,y,k,!1,V,fe)}function Pe(p,y,k,V,fe,ye){if(!y)throw Error("Invalid event type");var Ve=d(fe)?!!fe.capture:!!fe,Rt=fr(p);if(Rt||(p[qe]=Rt=new Ue(p)),k=Rt.add(y,k,V,Ve,ye),k.proxy)return k;if(V=Ye(),k.proxy=V,V.src=p,V.listener=k,p.addEventListener)Q||(fe=Ve),fe===void 0&&(fe=!1),p.addEventListener(y.toString(),V,fe);else if(p.attachEvent)p.attachEvent(rr(y.toString()),V);else if(p.addListener&&p.removeListener)p.addListener(V);else throw Error("addEventListener and attachEvent are unavailable.");return k}function Ye(){function p(k){return y.call(p.src,p.listener,k)}const y=yr;return p}function ut(p,y,k,V,fe){if(Array.isArray(y))for(var ye=0;ye<y.length;ye++)ut(p,y[ye],k,V,fe);else V=d(V)?!!V.capture:!!V,k=er(k),p&&p[De]?(p=p.i,y=String(y).toString(),y in p.g&&(ye=p.g[y],k=nt(ye,k,V,fe),-1<k&&(Te(ye[k]),Array.prototype.splice.call(ye,k,1),ye.length==0&&(delete p.g[y],p.h--)))):p&&(p=fr(p))&&(y=p.g[y.toString()],p=-1,y&&(p=nt(y,k,V,fe)),(k=-1<p?y[p]:null)&&_t(k))}function _t(p){if(typeof p!="number"&&p&&!p.da){var y=p.src;if(y&&y[De])X(y.i,p);else{var k=p.type,V=p.proxy;y.removeEventListener?y.removeEventListener(k,V,p.capture):y.detachEvent?y.detachEvent(rr(k),V):y.addListener&&y.removeListener&&y.removeListener(V),(k=fr(y))?(X(k,p),k.h==0&&(k.src=null,y[qe]=null)):Te(p)}}}function rr(p){return p in We?We[p]:We[p]="on"+p}function yr(p,y){if(p.da)p=!0;else{y=new Z(y,this);var k=p.listener,V=p.ha||p.src;p.fa&&_t(p),p=k.call(V,y)}return p}function fr(p){return p=p[qe],p instanceof Ue?p:null}var Et="__closure_events_fn_"+(1e9*Math.random()>>>0);function er(p){return typeof p=="function"?p:(p[Et]||(p[Et]=function(y){return p.handleEvent(y)}),p[Et])}function Ze(){M.call(this),this.i=new Ue(this),this.M=this,this.F=null}S(Ze,M),Ze.prototype[De]=!0,Ze.prototype.removeEventListener=function(p,y,k,V){ut(this,p,y,k,V)};function Je(p,y){var k,V=p.F;if(V)for(k=[];V;V=V.F)k.push(V);if(p=p.M,V=y.type||y,typeof y=="string")y=new z(y,p);else if(y instanceof z)y.target=y.target||p;else{var fe=y;y=new z(V,p),D(y,fe)}if(fe=!0,k)for(var ye=k.length-1;0<=ye;ye--){var Ve=y.g=k[ye];fe=dt(Ve,V,!0,y)&&fe}if(Ve=y.g=p,fe=dt(Ve,V,!0,y)&&fe,fe=dt(Ve,V,!1,y)&&fe,k)for(ye=0;ye<k.length;ye++)Ve=y.g=k[ye],fe=dt(Ve,V,!1,y)&&fe}Ze.prototype.N=function(){if(Ze.aa.N.call(this),this.i){var p=this.i,y;for(y in p.g){for(var k=p.g[y],V=0;V<k.length;V++)Te(k[V]);delete p.g[y],p.h--}}this.F=null},Ze.prototype.K=function(p,y,k,V){return this.i.add(String(p),y,!1,k,V)},Ze.prototype.L=function(p,y,k,V){return this.i.add(String(p),y,!0,k,V)};function dt(p,y,k,V){if(y=p.i.g[String(y)],!y)return!0;y=y.concat();for(var fe=!0,ye=0;ye<y.length;++ye){var Ve=y[ye];if(Ve&&!Ve.da&&Ve.capture==k){var Rt=Ve.listener,Ir=Ve.ha||Ve.src;Ve.fa&&X(p.i,Ve),fe=Rt.call(Ir,V)!==!1&&fe}}return fe&&!V.defaultPrevented}function Lt(p,y,k){if(typeof p=="function")k&&(p=x(p,k));else if(p&&typeof p.handleEvent=="function")p=x(p.handleEvent,p);else throw Error("Invalid listener argument");return 2147483647<Number(y)?-1:u.setTimeout(p,y||0)}function ot(p){p.g=Lt(()=>{p.g=null,p.i&&(p.i=!1,ot(p))},p.l);const y=p.h;p.h=null,p.m.apply(null,y)}class Ft extends M{constructor(y,k){super(),this.m=y,this.l=k,this.h=null,this.i=!1,this.g=null}j(y){this.h=arguments,this.g?this.i=!0:ot(this)}N(){super.N(),this.g&&(u.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Vt(p){M.call(this),this.h=p,this.g={}}S(Vt,M);var Ot=[];function Lr(p){ne(p.g,function(y,k){this.g.hasOwnProperty(k)&&_t(y)},p),p.g={}}Vt.prototype.N=function(){Vt.aa.N.call(this),Lr(this)},Vt.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Cn=u.JSON.stringify,Gi=u.JSON.parse,li=class{stringify(p){return u.JSON.stringify(p,void 0)}parse(p){return u.JSON.parse(p,void 0)}};function qi(){}qi.prototype.h=null;function Ki(p){return p.h||(p.h=p.i())}function Wi(){}var _a={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function xa(){z.call(this,"d")}S(xa,z);function Fa(){z.call(this,"c")}S(Fa,z);var Qn={},Js=null;function Pa(){return Js=Js||new Ze}Qn.La="serverreachability";function Xi(p){z.call(this,Qn.La,p)}S(Xi,z);function Ma(p){const y=Pa();Je(y,new Xi(y))}Qn.STAT_EVENT="statevent";function al(p,y){z.call(this,Qn.STAT_EVENT,p),this.stat=y}S(al,z);function $t(p){const y=Pa();Je(y,new al(y,p))}Qn.Ma="timingevent";function hr(p,y){z.call(this,Qn.Ma,p),this.size=y}S(hr,z);function nr(p,y){if(typeof p!="function")throw Error("Fn must not be null and must be a function");return u.setTimeout(function(){p()},y)}function Rn(){this.g=!0}Rn.prototype.xa=function(){this.g=!1};function eo(p,y,k,V,fe,ye){p.info(function(){if(p.g)if(ye)for(var Ve="",Rt=ye.split("&"),Ir=0;Ir<Rt.length;Ir++){var kt=Rt[Ir].split("=");if(1<kt.length){var Ur=kt[0];kt=kt[1];var Dr=Ur.split("_");Ve=2<=Dr.length&&Dr[1]=="type"?Ve+(Ur+"="+kt+"&"):Ve+(Ur+"=redacted&")}}else Ve=null;else Ve=ye;return"XMLHTTP REQ ("+V+") [attempt "+fe+"]: "+y+`
`+k+`
`+Ve})}function wc(p,y,k,V,fe,ye,Ve){p.info(function(){return"XMLHTTP RESP ("+V+") [ attempt "+fe+"]: "+y+`
`+k+`
`+ye+" "+Ve})}function P(p,y,k,V){p.info(function(){return"XMLHTTP TEXT ("+y+"): "+U(p,k)+(V?" "+V:"")})}function W(p,y){p.info(function(){return"TIMEOUT: "+y})}Rn.prototype.info=function(){};function U(p,y){if(!p.g)return y;if(!y)return null;try{var k=JSON.parse(y);if(k){for(p=0;p<k.length;p++)if(Array.isArray(k[p])){var V=k[p];if(!(2>V.length)){var fe=V[1];if(Array.isArray(fe)&&!(1>fe.length)){var ye=fe[0];if(ye!="noop"&&ye!="stop"&&ye!="close")for(var Ve=1;Ve<fe.length;Ve++)fe[Ve]=""}}}}return Cn(k)}catch{return y}}var j={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},q={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},Y;function de(){}S(de,qi),de.prototype.g=function(){return new XMLHttpRequest},de.prototype.i=function(){return{}},Y=new de;function xe(p,y,k,V){this.j=p,this.i=y,this.l=k,this.R=V||1,this.U=new Vt(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new ce}function ce(){this.i=null,this.g="",this.h=!1}var me={},ge={};function Ne(p,y,k){p.L=1,p.v=no(Ln(y)),p.m=k,p.P=!0,Le(p,null)}function Le(p,y){p.F=Date.now(),je(p),p.A=Ln(p.v);var k=p.A,V=p.R;Array.isArray(V)||(V=[String(V)]),bc(k.i,"t",V),p.C=0,k=p.j.J,p.h=new ce,p.g=Yf(p.j,k?y:null,!p.m),0<p.O&&(p.M=new Ft(x(p.Y,p,p.g),p.O)),y=p.U,k=p.g,V=p.ca;var fe="readystatechange";Array.isArray(fe)||(fe&&(Ot[0]=fe.toString()),fe=Ot);for(var ye=0;ye<fe.length;ye++){var Ve=Be(k,fe[ye],V||y.handleEvent,!1,y.h||y);if(!Ve)break;y.g[Ve.key]=Ve}y=p.H?T(p.H):{},p.m?(p.u||(p.u="POST"),y["Content-Type"]="application/x-www-form-urlencoded",p.g.ea(p.A,p.u,p.m,y)):(p.u="GET",p.g.ea(p.A,p.u,null,y)),Ma(),eo(p.i,p.u,p.A,p.l,p.R,p.m)}xe.prototype.ca=function(p){p=p.target;const y=this.M;y&&ta(p)==3?y.j():this.Y(p)},xe.prototype.Y=function(p){try{if(p==this.g)e:{const Dr=ta(this.g);var y=this.g.Ba();const mi=this.g.Z();if(!(3>Dr)&&(Dr!=3||this.g&&(this.h.h||this.g.oa()||jf(this.g)))){this.J||Dr!=4||y==7||(y==8||0>=mi?Ma(3):Ma(2)),Pt(this);var k=this.g.Z();this.X=k;t:if(ze(this)){var V=jf(this.g);p="";var fe=V.length,ye=ta(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){Ct(this),St(this);var Ve="";break t}this.h.i=new u.TextDecoder}for(y=0;y<fe;y++)this.h.h=!0,p+=this.h.i.decode(V[y],{stream:!(ye&&y==fe-1)});V.length=0,this.h.g+=p,this.C=0,Ve=this.h.g}else Ve=this.g.oa();if(this.o=k==200,wc(this.i,this.u,this.A,this.l,this.R,Dr,k),this.o){if(this.T&&!this.K){t:{if(this.g){var Rt,Ir=this.g;if((Rt=Ir.g?Ir.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!H(Rt)){var kt=Rt;break t}}kt=null}if(k=kt)P(this.i,this.l,k,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Mn(this,k);else{this.o=!1,this.s=3,$t(12),Ct(this),St(this);break e}}if(this.P){k=!0;let Wr;for(;!this.J&&this.C<Ve.length;)if(Wr=Me(this,Ve),Wr==ge){Dr==4&&(this.s=4,$t(14),k=!1),P(this.i,this.l,null,"[Incomplete Response]");break}else if(Wr==me){this.s=4,$t(15),P(this.i,this.l,Ve,"[Invalid Chunk]"),k=!1;break}else P(this.i,this.l,Wr,null),Mn(this,Wr);if(ze(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Dr!=4||Ve.length!=0||this.h.h||(this.s=1,$t(16),k=!1),this.o=this.o&&k,!k)P(this.i,this.l,Ve,"[Invalid Chunked Response]"),Ct(this),St(this);else if(0<Ve.length&&!this.W){this.W=!0;var Ur=this.j;Ur.g==this&&Ur.ba&&!Ur.M&&(Ur.j.info("Great, no buffering proxy detected. Bytes received: "+Ve.length),fo(Ur),Ur.M=!0,$t(11))}}else P(this.i,this.l,Ve,null),Mn(this,Ve);Dr==4&&Ct(this),this.o&&!this.J&&(Dr==4?Kf(this.j,this):(this.o=!1,je(this)))}else Vd(this.g),k==400&&0<Ve.indexOf("Unknown SID")?(this.s=3,$t(12)):(this.s=0,$t(13)),Ct(this),St(this)}}}catch{}finally{}};function ze(p){return p.g?p.u=="GET"&&p.L!=2&&p.j.Ca:!1}function Me(p,y){var k=p.C,V=y.indexOf(`
`,k);return V==-1?ge:(k=Number(y.substring(k,V)),isNaN(k)?me:(V+=1,V+k>y.length?ge:(y=y.slice(V,V+k),p.C=V+k,y)))}xe.prototype.cancel=function(){this.J=!0,Ct(this)};function je(p){p.S=Date.now()+p.I,at(p,p.I)}function at(p,y){if(p.B!=null)throw Error("WatchDog timer not null");p.B=nr(x(p.ba,p),y)}function Pt(p){p.B&&(u.clearTimeout(p.B),p.B=null)}xe.prototype.ba=function(){this.B=null;const p=Date.now();0<=p-this.S?(W(this.i,this.A),this.L!=2&&(Ma(),$t(17)),Ct(this),this.s=2,St(this)):at(this,this.S-p)};function St(p){p.j.G==0||p.J||Kf(p.j,p)}function Ct(p){Pt(p);var y=p.M;y&&typeof y.ma=="function"&&y.ma(),p.M=null,Lr(p.U),p.g&&(y=p.g,p.g=null,y.abort(),y.ma())}function Mn(p,y){try{var k=p.j;if(k.G!=0&&(k.g==p||_n(k.h,p))){if(!p.K&&_n(k.h,p)&&k.G==3){try{var V=k.Da.g.parse(y)}catch{V=null}if(Array.isArray(V)&&V.length==3){var fe=V;if(fe[0]==0){e:if(!k.u){if(k.g)if(k.g.F+3e3<p.F)pl(k),hl(k);else break e;Fc(k),$t(18)}}else k.za=fe[1],0<k.za-k.T&&37500>fe[2]&&k.F&&k.v==0&&!k.C&&(k.C=nr(x(k.Za,k),6e3));if(1>=Va(k.h)&&k.ca){try{k.ca()}catch{}k.ca=void 0}}else pi(k,11)}else if((p.K||k.g==p)&&pl(k),!H(y))for(fe=k.Da.g.parse(y),y=0;y<fe.length;y++){let kt=fe[y];if(k.T=kt[0],kt=kt[1],k.G==2)if(kt[0]=="c"){k.K=kt[1],k.ia=kt[2];const Ur=kt[3];Ur!=null&&(k.la=Ur,k.j.info("VER="+k.la));const Dr=kt[4];Dr!=null&&(k.Aa=Dr,k.j.info("SVER="+k.Aa));const mi=kt[5];mi!=null&&typeof mi=="number"&&0<mi&&(V=1.5*mi,k.L=V,k.j.info("backChannelRequestTimeoutMs_="+V)),V=k;const Wr=p.g;if(Wr){const qa=Wr.g?Wr.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(qa){var ye=V.h;ye.g||qa.indexOf("spdy")==-1&&qa.indexOf("quic")==-1&&qa.indexOf("h2")==-1||(ye.j=ye.l,ye.g=new Set,ye.h&&(il(ye,ye.h),ye.h=null))}if(V.D){const Mc=Wr.g?Wr.g.getResponseHeader("X-HTTP-Session-Id"):null;Mc&&(V.ya=Mc,qt(V.I,V.D,Mc))}}k.G=3,k.l&&k.l.ua(),k.ba&&(k.R=Date.now()-p.F,k.j.info("Handshake RTT: "+k.R+"ms")),V=k;var Ve=p;if(V.qa=Xf(V,V.J?V.ia:null,V.W),Ve.K){xn(V.h,Ve);var Rt=Ve,Ir=V.L;Ir&&(Rt.I=Ir),Rt.B&&(Pt(Rt),je(Rt)),V.g=Ve}else Gf(V);0<k.i.length&&dl(k)}else kt[0]!="stop"&&kt[0]!="close"||pi(k,7);else k.G==3&&(kt[0]=="stop"||kt[0]=="close"?kt[0]=="stop"?pi(k,7):Oc(k):kt[0]!="noop"&&k.l&&k.l.ta(kt),k.v=0)}}Ma(4)}catch{}}var La=class{constructor(p,y){this.g=p,this.map=y}};function vn(p){this.l=p||10,u.PerformanceNavigationTiming?(p=u.performance.getEntriesByType("navigation"),p=0<p.length&&(p[0].nextHopProtocol=="hq"||p[0].nextHopProtocol=="h2")):p=!!(u.chrome&&u.chrome.loadTimes&&u.chrome.loadTimes()&&u.chrome.loadTimes().wasFetchedViaSpdy),this.j=p?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function kn(p){return p.h?!0:p.g?p.g.size>=p.j:!1}function Va(p){return p.h?1:p.g?p.g.size:0}function _n(p,y){return p.h?p.h==y:p.g?p.g.has(y):!1}function il(p,y){p.g?p.g.add(y):p.h=y}function xn(p,y){p.h&&p.h==y?p.h=null:p.g&&p.g.has(y)&&p.g.delete(y)}vn.prototype.cancel=function(){if(this.i=Sc(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const p of this.g.values())p.cancel();this.g.clear()}};function Sc(p){if(p.h!=null)return p.i.concat(p.h.D);if(p.g!=null&&p.g.size!==0){let y=p.i;for(const k of p.g.values())y=y.concat(k.D);return y}return R(p.i)}function Fd(p){if(p.V&&typeof p.V=="function")return p.V();if(typeof Map<"u"&&p instanceof Map||typeof Set<"u"&&p instanceof Set)return Array.from(p.values());if(typeof p=="string")return p.split("");if(h(p)){for(var y=[],k=p.length,V=0;V<k;V++)y.push(p[V]);return y}y=[],k=0;for(V in p)y[k++]=p[V];return y}function sl(p){if(p.na&&typeof p.na=="function")return p.na();if(!p.V||typeof p.V!="function"){if(typeof Map<"u"&&p instanceof Map)return Array.from(p.keys());if(!(typeof Set<"u"&&p instanceof Set)){if(h(p)||typeof p=="string"){var y=[];p=p.length;for(var k=0;k<p;k++)y.push(k);return y}y=[],k=0;for(const V in p)y[k++]=V;return y}}}function Cc(p,y){if(p.forEach&&typeof p.forEach=="function")p.forEach(y,void 0);else if(h(p)||typeof p=="string")Array.prototype.forEach.call(p,y,void 0);else for(var k=sl(p),V=Fd(p),fe=V.length,ye=0;ye<fe;ye++)y.call(void 0,V[ye],k&&k[ye],p)}var to=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Pd(p,y){if(p){p=p.split("&");for(var k=0;k<p.length;k++){var V=p[k].indexOf("="),fe=null;if(0<=V){var ye=p[k].substring(0,V);fe=p[k].substring(V+1)}else ye=p[k];y(ye,fe?decodeURIComponent(fe.replace(/\+/g," ")):"")}}}function Er(p){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,p instanceof Er){this.h=p.h,ro(this,p.j),this.o=p.o,this.g=p.g,Yi(this,p.s),this.l=p.l;var y=p.i,k=new ui;k.i=y.i,y.g&&(k.g=new Map(y.g),k.h=y.h),ci(this,k),this.m=p.m}else p&&(y=String(p).match(to))?(this.h=!1,ro(this,y[1]||"",!0),this.o=Zn(y[2]||""),this.g=Zn(y[3]||"",!0),Yi(this,y[4]),this.l=Zn(y[5]||"",!0),ci(this,y[6]||"",!0),this.m=Zn(y[7]||"")):(this.h=!1,this.i=new ui(null,this.h))}Er.prototype.toString=function(){var p=[],y=this.j;y&&p.push(ao(y,Rc,!0),":");var k=this.g;return(k||y=="file")&&(p.push("//"),(y=this.o)&&p.push(ao(y,Rc,!0),"@"),p.push(encodeURIComponent(String(k)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),k=this.s,k!=null&&p.push(":",String(k))),(k=this.l)&&(this.g&&k.charAt(0)!="/"&&p.push("/"),p.push(ao(k,k.charAt(0)=="/"?Md:kc,!0))),(k=this.i.toString())&&p.push("?",k),(k=this.m)&&p.push("#",ao(k,ol)),p.join("")};function Ln(p){return new Er(p)}function ro(p,y,k){p.j=k?Zn(y,!0):y,p.j&&(p.j=p.j.replace(/:$/,""))}function Yi(p,y){if(y){if(y=Number(y),isNaN(y)||0>y)throw Error("Bad port number "+y);p.s=y}else p.s=null}function ci(p,y,k){y instanceof ui?(p.i=y,Uf(p.i,p.h)):(k||(y=ao(y,Ld)),p.i=new ui(y,p.h))}function qt(p,y,k){p.i.set(y,k)}function no(p){return qt(p,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),p}function Zn(p,y){return p?y?decodeURI(p.replace(/%25/g,"%2525")):decodeURIComponent(p):""}function ao(p,y,k){return typeof p=="string"?(p=encodeURI(p).replace(y,Vf),k&&(p=p.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),p):null}function Vf(p){return p=p.charCodeAt(0),"%"+(p>>4&15).toString(16)+(p&15).toString(16)}var Rc=/[#\/\?@]/g,kc=/[#\?:]/g,Md=/[#\?]/g,Ld=/[#\?@]/g,ol=/#/g;function ui(p,y){this.h=this.g=null,this.i=p||null,this.j=!!y}function Jn(p){p.g||(p.g=new Map,p.h=0,p.i&&Pd(p.i,function(y,k){p.add(decodeURIComponent(y.replace(/\+/g," ")),k)}))}t=ui.prototype,t.add=function(p,y){Jn(this),this.i=null,p=Ua(this,p);var k=this.g.get(p);return k||this.g.set(p,k=[]),k.push(y),this.h+=1,this};function fi(p,y){Jn(p),y=Ua(p,y),p.g.has(y)&&(p.i=null,p.h-=p.g.get(y).length,p.g.delete(y))}function hi(p,y){return Jn(p),y=Ua(p,y),p.g.has(y)}t.forEach=function(p,y){Jn(this),this.g.forEach(function(k,V){k.forEach(function(fe){p.call(y,fe,V,this)},this)},this)},t.na=function(){Jn(this);const p=Array.from(this.g.values()),y=Array.from(this.g.keys()),k=[];for(let V=0;V<y.length;V++){const fe=p[V];for(let ye=0;ye<fe.length;ye++)k.push(y[V])}return k},t.V=function(p){Jn(this);let y=[];if(typeof p=="string")hi(this,p)&&(y=y.concat(this.g.get(Ua(this,p))));else{p=Array.from(this.g.values());for(let k=0;k<p.length;k++)y=y.concat(p[k])}return y},t.set=function(p,y){return Jn(this),this.i=null,p=Ua(this,p),hi(this,p)&&(this.h-=this.g.get(p).length),this.g.set(p,[y]),this.h+=1,this},t.get=function(p,y){return p?(p=this.V(p),0<p.length?String(p[0]):y):y};function bc(p,y,k){fi(p,y),0<k.length&&(p.i=null,p.g.set(Ua(p,y),R(k)),p.h+=k.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const p=[],y=Array.from(this.g.keys());for(var k=0;k<y.length;k++){var V=y[k];const ye=encodeURIComponent(String(V)),Ve=this.V(V);for(V=0;V<Ve.length;V++){var fe=ye;Ve[V]!==""&&(fe+="="+encodeURIComponent(String(Ve[V]))),p.push(fe)}}return this.i=p.join("&")};function Ua(p,y){return y=String(y),p.j&&(y=y.toLowerCase()),y}function Uf(p,y){y&&!p.j&&(Jn(p),p.i=null,p.g.forEach(function(k,V){var fe=V.toLowerCase();V!=fe&&(fi(this,V),bc(this,fe,k))},p)),p.j=y}function io(p,y){const k=new Rn;if(u.Image){const V=new Image;V.onload=A(ea,k,"TestLoadImage: loaded",!0,y,V),V.onerror=A(ea,k,"TestLoadImage: error",!1,y,V),V.onabort=A(ea,k,"TestLoadImage: abort",!1,y,V),V.ontimeout=A(ea,k,"TestLoadImage: timeout",!1,y,V),u.setTimeout(function(){V.ontimeout&&V.ontimeout()},1e4),V.src=p}else y(!1)}function ya(p,y){const k=new Rn,V=new AbortController,fe=setTimeout(()=>{V.abort(),ea(k,"TestPingServer: timeout",!1,y)},1e4);fetch(p,{signal:V.signal}).then(ye=>{clearTimeout(fe),ye.ok?ea(k,"TestPingServer: ok",!0,y):ea(k,"TestPingServer: server error",!1,y)}).catch(()=>{clearTimeout(fe),ea(k,"TestPingServer: error",!1,y)})}function ea(p,y,k,V,fe){try{fe&&(fe.onload=null,fe.onerror=null,fe.onabort=null,fe.ontimeout=null),V(k)}catch{}}function so(){this.g=new li}function Ba(p,y,k){const V=k||"";try{Cc(p,function(fe,ye){let Ve=fe;d(fe)&&(Ve=Cn(fe)),y.push(V+ye+"="+encodeURIComponent(Ve))})}catch(fe){throw y.push(V+"type="+encodeURIComponent("_badmap")),fe}}function $i(p){this.l=p.Ub||null,this.j=p.eb||!1}S($i,qi),$i.prototype.g=function(){return new di(this.l,this.j)},$i.prototype.i=function(p){return function(){return p}}({});function di(p,y){Ze.call(this),this.D=p,this.o=y,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}S(di,Ze),t=di.prototype,t.open=function(p,y){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=p,this.A=y,this.readyState=1,za(this)},t.send=function(p){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const y={headers:this.u,method:this.B,credentials:this.m,cache:void 0};p&&(y.body=p),(this.D||u).fetch(new Request(this.A,y)).then(this.Sa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,ja(this)),this.readyState=0},t.Sa=function(p){if(this.g&&(this.l=p,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=p.headers,this.readyState=2,za(this)),this.g&&(this.readyState=3,za(this),this.g)))if(this.responseType==="arraybuffer")p.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof u.ReadableStream<"u"&&"body"in p){if(this.j=p.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;Ic(this)}else p.text().then(this.Ra.bind(this),this.ga.bind(this))};function Ic(p){p.j.read().then(p.Pa.bind(p)).catch(p.ga.bind(p))}t.Pa=function(p){if(this.g){if(this.o&&p.value)this.response.push(p.value);else if(!this.o){var y=p.value?p.value:new Uint8Array(0);(y=this.v.decode(y,{stream:!p.done}))&&(this.response=this.responseText+=y)}p.done?ja(this):za(this),this.readyState==3&&Ic(this)}},t.Ra=function(p){this.g&&(this.response=this.responseText=p,ja(this))},t.Qa=function(p){this.g&&(this.response=p,ja(this))},t.ga=function(){this.g&&ja(this)};function ja(p){p.readyState=4,p.l=null,p.j=null,p.v=null,za(p)}t.setRequestHeader=function(p,y){this.u.append(p,y)},t.getResponseHeader=function(p){return this.h&&this.h.get(p.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const p=[],y=this.h.entries();for(var k=y.next();!k.done;)k=k.value,p.push(k[0]+": "+k[1]),k=y.next();return p.join(`\r
`)};function za(p){p.onreadystatechange&&p.onreadystatechange.call(p)}Object.defineProperty(di.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(p){this.m=p?"include":"same-origin"}});function Dc(p){let y="";return ne(p,function(k,V){y+=V,y+=":",y+=k,y+=`\r
`}),y}function Vr(p,y,k){e:{for(V in k){var V=!1;break e}V=!0}V||(k=Dc(k),typeof p=="string"?k!=null&&encodeURIComponent(String(k)):qt(p,y,k))}function Bt(p){Ze.call(this),this.headers=new Map,this.o=p||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}S(Bt,Ze);var ll=/^https?$/i,oo=["POST","PUT"];t=Bt.prototype,t.Ha=function(p){this.J=p},t.ea=function(p,y,k,V){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+p);y=y?y.toUpperCase():"GET",this.D=p,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():Y.g(),this.v=this.o?Ki(this.o):Ki(Y),this.g.onreadystatechange=x(this.Ea,this);try{this.B=!0,this.g.open(y,String(p),!0),this.B=!1}catch(ye){Bf(this,ye);return}if(p=k||"",k=new Map(this.headers),V)if(Object.getPrototypeOf(V)===Object.prototype)for(var fe in V)k.set(fe,V[fe]);else if(typeof V.keys=="function"&&typeof V.get=="function")for(const ye of V.keys())k.set(ye,V.get(ye));else throw Error("Unknown input type for opt_headers: "+String(V));V=Array.from(k.keys()).find(ye=>ye.toLowerCase()=="content-type"),fe=u.FormData&&p instanceof u.FormData,!(0<=Array.prototype.indexOf.call(oo,y,void 0))||V||fe||k.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[ye,Ve]of k)this.g.setRequestHeader(ye,Ve);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{lo(this),this.u=!0,this.g.send(p),this.u=!1}catch(ye){Bf(this,ye)}};function Bf(p,y){p.h=!1,p.g&&(p.j=!0,p.g.abort(),p.j=!1),p.l=y,p.m=5,cl(p),Ha(p)}function cl(p){p.A||(p.A=!0,Je(p,"complete"),Je(p,"error"))}t.abort=function(p){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=p||7,Je(this,"complete"),Je(this,"abort"),Ha(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Ha(this,!0)),Bt.aa.N.call(this)},t.Ea=function(){this.s||(this.B||this.u||this.j?ul(this):this.bb())},t.bb=function(){ul(this)};function ul(p){if(p.h&&typeof c<"u"&&(!p.v[1]||ta(p)!=4||p.Z()!=2)){if(p.u&&ta(p)==4)Lt(p.Ea,0,p);else if(Je(p,"readystatechange"),ta(p)==4){p.h=!1;try{const Ve=p.Z();e:switch(Ve){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var y=!0;break e;default:y=!1}var k;if(!(k=y)){var V;if(V=Ve===0){var fe=String(p.D).match(to)[1]||null;!fe&&u.self&&u.self.location&&(fe=u.self.location.protocol.slice(0,-1)),V=!ll.test(fe?fe.toLowerCase():"")}k=V}if(k)Je(p,"complete"),Je(p,"success");else{p.m=6;try{var ye=2<ta(p)?p.g.statusText:""}catch{ye=""}p.l=ye+" ["+p.Z()+"]",cl(p)}}finally{Ha(p)}}}}function Ha(p,y){if(p.g){lo(p);const k=p.g,V=p.v[0]?()=>{}:null;p.g=null,p.v=null,y||Je(p,"ready");try{k.onreadystatechange=V}catch{}}}function lo(p){p.I&&(u.clearTimeout(p.I),p.I=null)}t.isActive=function(){return!!this.g};function ta(p){return p.g?p.g.readyState:0}t.Z=function(){try{return 2<ta(this)?this.g.status:-1}catch{return-1}},t.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.Oa=function(p){if(this.g){var y=this.g.responseText;return p&&y.indexOf(p)==0&&(y=y.substring(p.length)),Gi(y)}};function jf(p){try{if(!p.g)return null;if("response"in p.g)return p.g.response;switch(p.H){case"":case"text":return p.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in p.g)return p.g.mozResponseArrayBuffer}return null}catch{return null}}function Vd(p){const y={};p=(p.g&&2<=ta(p)&&p.g.getAllResponseHeaders()||"").split(`\r
`);for(let V=0;V<p.length;V++){if(H(p[V]))continue;var k=b(p[V]);const fe=k[0];if(k=k[1],typeof k!="string")continue;k=k.trim();const ye=y[fe]||[];y[fe]=ye,ye.push(k)}C(y,function(V){return V.join(", ")})}t.Ba=function(){return this.m},t.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function co(p,y,k){return k&&k.internalChannelParams&&k.internalChannelParams[p]||y}function fl(p){this.Aa=0,this.i=[],this.j=new Rn,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=co("failFast",!1,p),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=co("baseRetryDelayMs",5e3,p),this.cb=co("retryDelaySeedMs",1e4,p),this.Wa=co("forwardChannelMaxRetries",2,p),this.wa=co("forwardChannelRequestTimeoutMs",2e4,p),this.pa=p&&p.xmlHttpFactory||void 0,this.Xa=p&&p.Tb||void 0,this.Ca=p&&p.useFetchStreams||!1,this.L=void 0,this.J=p&&p.supportsCrossDomainXhr||!1,this.K="",this.h=new vn(p&&p.concurrentRequestLimit),this.Da=new so,this.P=p&&p.fastHandshake||!1,this.O=p&&p.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=p&&p.Rb||!1,p&&p.xa&&this.j.xa(),p&&p.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&p&&p.detectBufferingProxy||!1,this.ja=void 0,p&&p.longPollingTimeout&&0<p.longPollingTimeout&&(this.ja=p.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}t=fl.prototype,t.la=8,t.G=1,t.connect=function(p,y,k,V){$t(0),this.W=p,this.H=y||{},k&&V!==void 0&&(this.H.OSID=k,this.H.OAID=V),this.F=this.X,this.I=Xf(this,null,this.W),dl(this)};function Oc(p){if(zf(p),p.G==3){var y=p.U++,k=Ln(p.I);if(qt(k,"SID",p.K),qt(k,"RID",y),qt(k,"TYPE","terminate"),uo(p,k),y=new xe(p,p.j,y),y.L=2,y.v=no(Ln(k)),k=!1,u.navigator&&u.navigator.sendBeacon)try{k=u.navigator.sendBeacon(y.v.toString(),"")}catch{}!k&&u.Image&&(new Image().src=y.v,k=!0),k||(y.g=Yf(y.j,null),y.g.ea(y.v)),y.F=Date.now(),je(y)}Wf(p)}function hl(p){p.g&&(fo(p),p.g.cancel(),p.g=null)}function zf(p){hl(p),p.u&&(u.clearTimeout(p.u),p.u=null),pl(p),p.h.cancel(),p.s&&(typeof p.s=="number"&&u.clearTimeout(p.s),p.s=null)}function dl(p){if(!kn(p.h)&&!p.s){p.s=!0;var y=p.Ga;oe||G(),Oe||(oe(),Oe=!0),te.add(y,p),p.B=0}}function Ud(p,y){return Va(p.h)>=p.h.j-(p.s?1:0)?!1:p.s?(p.i=y.D.concat(p.i),!0):p.G==1||p.G==2||p.B>=(p.Va?0:p.Wa)?!1:(p.s=nr(x(p.Ga,p,y),Pc(p,p.B)),p.B++,!0)}t.Ga=function(p){if(this.s)if(this.s=null,this.G==1){if(!p){this.U=Math.floor(1e5*Math.random()),p=this.U++;const fe=new xe(this,this.j,p);let ye=this.o;if(this.S&&(ye?(ye=T(ye),D(ye,this.S)):ye=this.S),this.m!==null||this.O||(fe.H=ye,ye=null),this.P)e:{for(var y=0,k=0;k<this.i.length;k++){t:{var V=this.i[k];if("__data__"in V.map&&(V=V.map.__data__,typeof V=="string")){V=V.length;break t}V=void 0}if(V===void 0)break;if(y+=V,4096<y){y=k;break e}if(y===4096||k===this.i.length-1){y=k+1;break e}}y=1e3}else y=1e3;y=Hf(this,fe,y),k=Ln(this.I),qt(k,"RID",p),qt(k,"CVER",22),this.D&&qt(k,"X-HTTP-Session-Id",this.D),uo(this,k),ye&&(this.O?y="headers="+encodeURIComponent(String(Dc(ye)))+"&"+y:this.m&&Vr(k,this.m,ye)),il(this.h,fe),this.Ua&&qt(k,"TYPE","init"),this.P?(qt(k,"$req",y),qt(k,"SID","null"),fe.T=!0,Ne(fe,k,null)):Ne(fe,k,y),this.G=2}}else this.G==3&&(p?Nc(this,p):this.i.length==0||kn(this.h)||Nc(this))};function Nc(p,y){var k;y?k=y.l:k=p.U++;const V=Ln(p.I);qt(V,"SID",p.K),qt(V,"RID",k),qt(V,"AID",p.T),uo(p,V),p.m&&p.o&&Vr(V,p.m,p.o),k=new xe(p,p.j,k,p.B+1),p.m===null&&(k.H=p.o),y&&(p.i=y.D.concat(p.i)),y=Hf(p,k,1e3),k.I=Math.round(.5*p.wa)+Math.round(.5*p.wa*Math.random()),il(p.h,k),Ne(k,V,y)}function uo(p,y){p.H&&ne(p.H,function(k,V){qt(y,V,k)}),p.l&&Cc({},function(k,V){qt(y,V,k)})}function Hf(p,y,k){k=Math.min(p.i.length,k);var V=p.l?x(p.l.Na,p.l,p):null;e:{var fe=p.i;let ye=-1;for(;;){const Ve=["count="+k];ye==-1?0<k?(ye=fe[0].g,Ve.push("ofs="+ye)):ye=0:Ve.push("ofs="+ye);let Rt=!0;for(let Ir=0;Ir<k;Ir++){let kt=fe[Ir].g;const Ur=fe[Ir].map;if(kt-=ye,0>kt)ye=Math.max(0,fe[Ir].g-100),Rt=!1;else try{Ba(Ur,Ve,"req"+kt+"_")}catch{V&&V(Ur)}}if(Rt){V=Ve.join("&");break e}}}return p=p.i.splice(0,k),y.D=p,V}function Gf(p){if(!p.g&&!p.u){p.Y=1;var y=p.Fa;oe||G(),Oe||(oe(),Oe=!0),te.add(y,p),p.v=0}}function Fc(p){return p.g||p.u||3<=p.v?!1:(p.Y++,p.u=nr(x(p.Fa,p),Pc(p,p.v)),p.v++,!0)}t.Fa=function(){if(this.u=null,qf(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var p=2*this.R;this.j.info("BP detection timer enabled: "+p),this.A=nr(x(this.ab,this),p)}},t.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,$t(10),hl(this),qf(this))};function fo(p){p.A!=null&&(u.clearTimeout(p.A),p.A=null)}function qf(p){p.g=new xe(p,p.j,"rpc",p.Y),p.m===null&&(p.g.H=p.o),p.g.O=0;var y=Ln(p.qa);qt(y,"RID","rpc"),qt(y,"SID",p.K),qt(y,"AID",p.T),qt(y,"CI",p.F?"0":"1"),!p.F&&p.ja&&qt(y,"TO",p.ja),qt(y,"TYPE","xmlhttp"),uo(p,y),p.m&&p.o&&Vr(y,p.m,p.o),p.L&&(p.g.I=p.L);var k=p.g;p=p.ia,k.L=1,k.v=no(Ln(y)),k.m=null,k.P=!0,Le(k,p)}t.Za=function(){this.C!=null&&(this.C=null,hl(this),Fc(this),$t(19))};function pl(p){p.C!=null&&(u.clearTimeout(p.C),p.C=null)}function Kf(p,y){var k=null;if(p.g==y){pl(p),fo(p),p.g=null;var V=2}else if(_n(p.h,y))k=y.D,xn(p.h,y),V=1;else return;if(p.G!=0){if(y.o)if(V==1){k=y.m?y.m.length:0,y=Date.now()-y.F;var fe=p.B;V=Pa(),Je(V,new hr(V,k)),dl(p)}else Gf(p);else if(fe=y.s,fe==3||fe==0&&0<y.X||!(V==1&&Ud(p,y)||V==2&&Fc(p)))switch(k&&0<k.length&&(y=p.h,y.i=y.i.concat(k)),fe){case 1:pi(p,5);break;case 4:pi(p,10);break;case 3:pi(p,6);break;default:pi(p,2)}}}function Pc(p,y){let k=p.Ta+Math.floor(Math.random()*p.cb);return p.isActive()||(k*=2),k*y}function pi(p,y){if(p.j.info("Error code "+y),y==2){var k=x(p.fb,p),V=p.Xa;const fe=!V;V=new Er(V||"//www.google.com/images/cleardot.gif"),u.location&&u.location.protocol=="http"||ro(V,"https"),no(V),fe?io(V.toString(),k):ya(V.toString(),k)}else $t(2);p.G=0,p.l&&p.l.sa(y),Wf(p),zf(p)}t.fb=function(p){p?(this.j.info("Successfully pinged google.com"),$t(2)):(this.j.info("Failed to ping google.com"),$t(1))};function Wf(p){if(p.G=0,p.ka=[],p.l){const y=Sc(p.h);(y.length!=0||p.i.length!=0)&&(w(p.ka,y),w(p.ka,p.i),p.h.i.length=0,R(p.i),p.i.length=0),p.l.ra()}}function Xf(p,y,k){var V=k instanceof Er?Ln(k):new Er(k);if(V.g!="")y&&(V.g=y+"."+V.g),Yi(V,V.s);else{var fe=u.location;V=fe.protocol,y=y?y+"."+fe.hostname:fe.hostname,fe=+fe.port;var ye=new Er(null);V&&ro(ye,V),y&&(ye.g=y),fe&&Yi(ye,fe),k&&(ye.l=k),V=ye}return k=p.D,y=p.ya,k&&y&&qt(V,k,y),qt(V,"VER",p.la),uo(p,V),V}function Yf(p,y,k){if(y&&!p.J)throw Error("Can't create secondary domain capable XhrIo object.");return y=p.Ca&&!p.pa?new Bt(new $i({eb:k})):new Bt(p.pa),y.Ha(p.J),y}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function $f(){}t=$f.prototype,t.ua=function(){},t.ta=function(){},t.sa=function(){},t.ra=function(){},t.isActive=function(){return!0},t.Na=function(){};function ml(){}ml.prototype.g=function(p,y){return new yn(p,y)};function yn(p,y){Ze.call(this),this.g=new fl(y),this.l=p,this.h=y&&y.messageUrlParams||null,p=y&&y.messageHeaders||null,y&&y.clientProtocolHeaderRequired&&(p?p["X-Client-Protocol"]="webchannel":p={"X-Client-Protocol":"webchannel"}),this.g.o=p,p=y&&y.initMessageHeaders||null,y&&y.messageContentType&&(p?p["X-WebChannel-Content-Type"]=y.messageContentType:p={"X-WebChannel-Content-Type":y.messageContentType}),y&&y.va&&(p?p["X-WebChannel-Client-Profile"]=y.va:p={"X-WebChannel-Client-Profile":y.va}),this.g.S=p,(p=y&&y.Sb)&&!H(p)&&(this.g.m=p),this.v=y&&y.supportsCrossDomainXhr||!1,this.u=y&&y.sendRawJson||!1,(y=y&&y.httpSessionIdParam)&&!H(y)&&(this.g.D=y,p=this.h,p!==null&&y in p&&(p=this.h,y in p&&delete p[y])),this.j=new Ga(this)}S(yn,Ze),yn.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},yn.prototype.close=function(){Oc(this.g)},yn.prototype.o=function(p){var y=this.g;if(typeof p=="string"){var k={};k.__data__=p,p=k}else this.u&&(k={},k.__data__=Cn(p),p=k);y.i.push(new La(y.Ya++,p)),y.G==3&&dl(y)},yn.prototype.N=function(){this.g.l=null,delete this.j,Oc(this.g),delete this.g,yn.aa.N.call(this)};function Qf(p){xa.call(this),p.__headers__&&(this.headers=p.__headers__,this.statusCode=p.__status__,delete p.__headers__,delete p.__status__);var y=p.__sm__;if(y){e:{for(const k in y){p=k;break e}p=void 0}(this.i=p)&&(p=this.i,y=y!==null&&p in y?y[p]:void 0),this.data=y}else this.data=p}S(Qf,xa);function Zf(){Fa.call(this),this.status=1}S(Zf,Fa);function Ga(p){this.g=p}S(Ga,$f),Ga.prototype.ua=function(){Je(this.g,"a")},Ga.prototype.ta=function(p){Je(this.g,new Qf(p))},Ga.prototype.sa=function(p){Je(this.g,new Zf)},Ga.prototype.ra=function(){Je(this.g,"b")},ml.prototype.createWebChannel=ml.prototype.g,yn.prototype.send=yn.prototype.o,yn.prototype.open=yn.prototype.m,yn.prototype.close=yn.prototype.close,OA=function(){return new ml},DA=function(){return Pa()},IA=Qn,mg={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},j.NO_ERROR=0,j.TIMEOUT=8,j.HTTP_ERROR=6,x0=j,q.COMPLETE="complete",bA=q,Wi.EventType=_a,_a.OPEN="a",_a.CLOSE="b",_a.ERROR="c",_a.MESSAGE="d",Ze.prototype.listen=Ze.prototype.K,Ru=Wi,Bt.prototype.listenOnce=Bt.prototype.L,Bt.prototype.getLastError=Bt.prototype.Ka,Bt.prototype.getLastErrorCode=Bt.prototype.Ba,Bt.prototype.getStatus=Bt.prototype.Z,Bt.prototype.getResponseJson=Bt.prototype.Oa,Bt.prototype.getResponseText=Bt.prototype.oa,Bt.prototype.send=Bt.prototype.ea,Bt.prototype.setWithCredentials=Bt.prototype.Ha,kA=Bt}).apply(typeof e0<"u"?e0:typeof self<"u"?self:typeof window<"u"?window:{});const EE="@firebase/firestore",TE="4.8.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ln{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}ln.UNAUTHENTICATED=new ln(null),ln.GOOGLE_CREDENTIALS=new ln("google-credentials-uid"),ln.FIRST_PARTY=new ln("first-party-uid"),ln.MOCK_USER=new ln("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let _c="11.10.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Bo=new Zg("@firebase/firestore");function ql(){return Bo.logLevel}function Ge(t,...e){if(Bo.logLevel<=Tt.DEBUG){const r=e.map(h1);Bo.debug(`Firestore (${_c}): ${t}`,...r)}}function Bi(t,...e){if(Bo.logLevel<=Tt.ERROR){const r=e.map(h1);Bo.error(`Firestore (${_c}): ${t}`,...r)}}function Vs(t,...e){if(Bo.logLevel<=Tt.WARN){const r=e.map(h1);Bo.warn(`Firestore (${_c}): ${t}`,...r)}}function h1(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(r){return JSON.stringify(r)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rt(t,e,r){let n="Unexpected state";typeof e=="string"?n=e:r=e,NA(t,n,r)}function NA(t,e,r){let n=`FIRESTORE (${_c}) INTERNAL ASSERTION FAILED: ${e} (ID: ${t.toString(16)})`;if(r!==void 0)try{n+=" CONTEXT: "+JSON.stringify(r)}catch{n+=" CONTEXT: "+r}throw Bi(n),new Error(n)}function jt(t,e,r,n){let i="Unexpected state";typeof r=="string"?i=r:n=r,t||NA(e,i,n)}function ct(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Re={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class He extends zi{constructor(e,r){super(e,r),this.code=e,this.message=r,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ni{constructor(){this.promise=new Promise((e,r)=>{this.resolve=e,this.reject=r})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FA{constructor(e,r){this.user=r,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class RD{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,r){e.enqueueRetryable(()=>r(ln.UNAUTHENTICATED))}shutdown(){}}class kD{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,r){this.changeListener=r,e.enqueueRetryable(()=>r(this.token.user))}shutdown(){this.changeListener=null}}class bD{constructor(e){this.t=e,this.currentUser=ln.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,r){jt(this.o===void 0,42304);let n=this.i;const i=h=>this.i!==n?(n=this.i,r(h)):Promise.resolve();let o=new Ni;this.o=()=>{this.i++,this.currentUser=this.u(),o.resolve(),o=new Ni,e.enqueueRetryable(()=>i(this.currentUser))};const c=()=>{const h=o;e.enqueueRetryable(async()=>{await h.promise,await i(this.currentUser)})},u=h=>{Ge("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=h,this.o&&(this.auth.addAuthTokenListener(this.o),c())};this.t.onInit(h=>u(h)),setTimeout(()=>{if(!this.auth){const h=this.t.getImmediate({optional:!0});h?u(h):(Ge("FirebaseAuthCredentialsProvider","Auth not yet detected"),o.resolve(),o=new Ni)}},0),c()}getToken(){const e=this.i,r=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(r).then(n=>this.i!==e?(Ge("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):n?(jt(typeof n.accessToken=="string",31837,{l:n}),new FA(n.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return jt(e===null||typeof e=="string",2055,{h:e}),new ln(e)}}class ID{constructor(e,r,n){this.P=e,this.T=r,this.I=n,this.type="FirstParty",this.user=ln.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class DD{constructor(e,r,n){this.P=e,this.T=r,this.I=n}getToken(){return Promise.resolve(new ID(this.P,this.T,this.I))}start(e,r){e.enqueueRetryable(()=>r(ln.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class AE{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class OD{constructor(e,r){this.V=r,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,ha(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,r){jt(this.o===void 0,3512);const n=o=>{o.error!=null&&Ge("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${o.error.message}`);const c=o.token!==this.m;return this.m=o.token,Ge("FirebaseAppCheckTokenProvider",`Received ${c?"new":"existing"} token.`),c?r(o.token):Promise.resolve()};this.o=o=>{e.enqueueRetryable(()=>n(o))};const i=o=>{Ge("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=o,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(o=>i(o)),setTimeout(()=>{if(!this.appCheck){const o=this.V.getImmediate({optional:!0});o?i(o):Ge("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new AE(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(r=>r?(jt(typeof r.token=="string",44558,{tokenResult:r}),this.m=r.token,new AE(r.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ND(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),r=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(r);else for(let n=0;n<t;n++)r[n]=Math.floor(256*Math.random());return r}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function PA(){return new TextEncoder}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class d1{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",r=62*Math.floor(4.129032258064516);let n="";for(;n.length<20;){const i=ND(40);for(let o=0;o<i.length;++o)n.length<20&&i[o]<r&&(n+=e.charAt(i[o]%62))}return n}}function mt(t,e){return t<e?-1:t>e?1:0}function gg(t,e){let r=0;for(;r<t.length&&r<e.length;){const n=t.codePointAt(r),i=e.codePointAt(r);if(n!==i){if(n<128&&i<128)return mt(n,i);{const o=PA(),c=FD(o.encode(wE(t,r)),o.encode(wE(e,r)));return c!==0?c:mt(n,i)}}r+=n>65535?2:1}return mt(t.length,e.length)}function wE(t,e){return t.codePointAt(e)>65535?t.substring(e,e+2):t.substring(e,e+1)}function FD(t,e){for(let r=0;r<t.length&&r<e.length;++r)if(t[r]!==e[r])return mt(t[r],e[r]);return mt(t.length,e.length)}function oc(t,e,r){return t.length===e.length&&t.every((n,i)=>r(n,e[i]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const SE="__name__";class Ja{constructor(e,r,n){r===void 0?r=0:r>e.length&&rt(637,{offset:r,range:e.length}),n===void 0?n=e.length-r:n>e.length-r&&rt(1746,{length:n,range:e.length-r}),this.segments=e,this.offset=r,this.len=n}get length(){return this.len}isEqual(e){return Ja.comparator(this,e)===0}child(e){const r=this.segments.slice(this.offset,this.limit());return e instanceof Ja?e.forEach(n=>{r.push(n)}):r.push(e),this.construct(r)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==e.get(r))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==e.get(r))return!1;return!0}forEach(e){for(let r=this.offset,n=this.limit();r<n;r++)e(this.segments[r])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,r){const n=Math.min(e.length,r.length);for(let i=0;i<n;i++){const o=Ja.compareSegments(e.get(i),r.get(i));if(o!==0)return o}return mt(e.length,r.length)}static compareSegments(e,r){const n=Ja.isNumericId(e),i=Ja.isNumericId(r);return n&&!i?-1:!n&&i?1:n&&i?Ja.extractNumericId(e).compare(Ja.extractNumericId(r)):gg(e,r)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return Fs.fromString(e.substring(4,e.length-2))}}class Zt extends Ja{construct(e,r,n){return new Zt(e,r,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const r=[];for(const n of e){if(n.indexOf("//")>=0)throw new He(Re.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);r.push(...n.split("/").filter(i=>i.length>0))}return new Zt(r)}static emptyPath(){return new Zt([])}}const PD=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Jr extends Ja{construct(e,r,n){return new Jr(e,r,n)}static isValidIdentifier(e){return PD.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Jr.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===SE}static keyField(){return new Jr([SE])}static fromServerFormat(e){const r=[];let n="",i=0;const o=()=>{if(n.length===0)throw new He(Re.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);r.push(n),n=""};let c=!1;for(;i<e.length;){const u=e[i];if(u==="\\"){if(i+1===e.length)throw new He(Re.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const h=e[i+1];if(h!=="\\"&&h!=="."&&h!=="`")throw new He(Re.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=h,i+=2}else u==="`"?(c=!c,i++):u!=="."||c?(n+=u,i++):(o(),i++)}if(o(),c)throw new He(Re.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Jr(r)}static emptyPath(){return new Jr([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $e{constructor(e){this.path=e}static fromPath(e){return new $e(Zt.fromString(e))}static fromName(e){return new $e(Zt.fromString(e).popFirst(5))}static empty(){return new $e(Zt.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Zt.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,r){return Zt.comparator(e.path,r.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new $e(new Zt(e.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function MA(t,e,r){if(!r)throw new He(Re.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function MD(t,e,r,n){if(e===!0&&n===!0)throw new He(Re.INVALID_ARGUMENT,`${t} and ${r} cannot be used together.`)}function CE(t){if(!$e.isDocumentKey(t))throw new He(Re.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function RE(t){if($e.isDocumentKey(t))throw new He(Re.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function LA(t){return typeof t=="object"&&t!==null&&(Object.getPrototypeOf(t)===Object.prototype||Object.getPrototypeOf(t)===null)}function ud(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(n){return n.constructor?n.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":rt(12329,{type:typeof t})}function Oa(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new He(Re.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const r=ud(t);throw new He(Re.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${r}`)}}return t}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function br(t,e){const r={typeString:t};return e&&(r.value=e),r}function wf(t,e){if(!LA(t))throw new He(Re.INVALID_ARGUMENT,"JSON must be an object");let r;for(const n in e)if(e[n]){const i=e[n].typeString,o="value"in e[n]?{value:e[n].value}:void 0;if(!(n in t)){r=`JSON missing required field: '${n}'`;break}const c=t[n];if(i&&typeof c!==i){r=`JSON field '${n}' must be a ${i}.`;break}if(o!==void 0&&c!==o.value){r=`Expected '${n}' field to equal '${o.value}'`;break}}if(r)throw new He(Re.INVALID_ARGUMENT,r);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kE=-62135596800,bE=1e6;class tr{static now(){return tr.fromMillis(Date.now())}static fromDate(e){return tr.fromMillis(e.getTime())}static fromMillis(e){const r=Math.floor(e/1e3),n=Math.floor((e-1e3*r)*bE);return new tr(r,n)}constructor(e,r){if(this.seconds=e,this.nanoseconds=r,r<0)throw new He(Re.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(r>=1e9)throw new He(Re.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(e<kE)throw new He(Re.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new He(Re.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/bE}_compareTo(e){return this.seconds===e.seconds?mt(this.nanoseconds,e.nanoseconds):mt(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:tr._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(wf(e,tr._jsonSchema))return new tr(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-kE;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}tr._jsonSchemaVersion="firestore/timestamp/1.0",tr._jsonSchema={type:br("string",tr._jsonSchemaVersion),seconds:br("number"),nanoseconds:br("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lt{static fromTimestamp(e){return new lt(e)}static min(){return new lt(new tr(0,0))}static max(){return new lt(new tr(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rf=-1;function LD(t,e){const r=t.toTimestamp().seconds,n=t.toTimestamp().nanoseconds+1,i=lt.fromTimestamp(n===1e9?new tr(r+1,0):new tr(r,n));return new Us(i,$e.empty(),e)}function VD(t){return new Us(t.readTime,t.key,rf)}class Us{constructor(e,r,n){this.readTime=e,this.documentKey=r,this.largestBatchId=n}static min(){return new Us(lt.min(),$e.empty(),rf)}static max(){return new Us(lt.max(),$e.empty(),rf)}}function UD(t,e){let r=t.readTime.compareTo(e.readTime);return r!==0?r:(r=$e.comparator(t.documentKey,e.documentKey),r!==0?r:mt(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const BD="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class jD{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function xc(t){if(t.code!==Re.FAILED_PRECONDITION||t.message!==BD)throw t;Ge("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class be{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(r=>{this.isDone=!0,this.result=r,this.nextCallback&&this.nextCallback(r)},r=>{this.isDone=!0,this.error=r,this.catchCallback&&this.catchCallback(r)})}catch(e){return this.next(void 0,e)}next(e,r){return this.callbackAttached&&rt(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(r,this.error):this.wrapSuccess(e,this.result):new be((n,i)=>{this.nextCallback=o=>{this.wrapSuccess(e,o).next(n,i)},this.catchCallback=o=>{this.wrapFailure(r,o).next(n,i)}})}toPromise(){return new Promise((e,r)=>{this.next(e,r)})}wrapUserFunction(e){try{const r=e();return r instanceof be?r:be.resolve(r)}catch(r){return be.reject(r)}}wrapSuccess(e,r){return e?this.wrapUserFunction(()=>e(r)):be.resolve(r)}wrapFailure(e,r){return e?this.wrapUserFunction(()=>e(r)):be.reject(r)}static resolve(e){return new be((r,n)=>{r(e)})}static reject(e){return new be((r,n)=>{n(e)})}static waitFor(e){return new be((r,n)=>{let i=0,o=0,c=!1;e.forEach(u=>{++i,u.next(()=>{++o,c&&o===i&&r()},h=>n(h))}),c=!0,o===i&&r()})}static or(e){let r=be.resolve(!1);for(const n of e)r=r.next(i=>i?be.resolve(i):n());return r}static forEach(e,r){const n=[];return e.forEach((i,o)=>{n.push(r.call(this,i,o))}),this.waitFor(n)}static mapArray(e,r){return new be((n,i)=>{const o=e.length,c=new Array(o);let u=0;for(let h=0;h<o;h++){const d=h;r(e[d]).next(g=>{c[d]=g,++u,u===o&&n(c)},g=>i(g))}})}static doWhile(e,r){return new be((n,i)=>{const o=()=>{e()===!0?r().next(()=>{o()},i):n()};o()})}}function zD(t){const e=t.match(/Android ([\d.]+)/i),r=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(r)}function yc(t){return t.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fd{constructor(e,r){this.previousValue=e,r&&(r.sequenceNumberHandler=n=>this._e(n),this.ae=n=>r.writeSequenceNumber(n))}_e(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ae&&this.ae(e),e}}fd.ue=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const p1=-1;function hd(t){return t==null}function P0(t){return t===0&&1/t==-1/0}function HD(t){return typeof t=="number"&&Number.isInteger(t)&&!P0(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const VA="";function GD(t){let e="";for(let r=0;r<t.length;r++)e.length>0&&(e=IE(e)),e=qD(t.get(r),e);return IE(e)}function qD(t,e){let r=e;const n=t.length;for(let i=0;i<n;i++){const o=t.charAt(i);switch(o){case"\0":r+="";break;case VA:r+="";break;default:r+=o}}return r}function IE(t){return t+VA+""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function DE(t){let e=0;for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&e++;return e}function Qs(t,e){for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&e(r,t[r])}function UA(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class or{constructor(e,r){this.comparator=e,this.root=r||Qr.EMPTY}insert(e,r){return new or(this.comparator,this.root.insert(e,r,this.comparator).copy(null,null,Qr.BLACK,null,null))}remove(e){return new or(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Qr.BLACK,null,null))}get(e){let r=this.root;for(;!r.isEmpty();){const n=this.comparator(e,r.key);if(n===0)return r.value;n<0?r=r.left:n>0&&(r=r.right)}return null}indexOf(e){let r=0,n=this.root;for(;!n.isEmpty();){const i=this.comparator(e,n.key);if(i===0)return r+n.left.size;i<0?n=n.left:(r+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((r,n)=>(e(r,n),!1))}toString(){const e=[];return this.inorderTraversal((r,n)=>(e.push(`${r}:${n}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new t0(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new t0(this.root,e,this.comparator,!1)}getReverseIterator(){return new t0(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new t0(this.root,e,this.comparator,!0)}}class t0{constructor(e,r,n,i){this.isReverse=i,this.nodeStack=[];let o=1;for(;!e.isEmpty();)if(o=r?n(e.key,r):1,r&&i&&(o*=-1),o<0)e=this.isReverse?e.left:e.right;else{if(o===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const r={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return r}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Qr{constructor(e,r,n,i,o){this.key=e,this.value=r,this.color=n??Qr.RED,this.left=i??Qr.EMPTY,this.right=o??Qr.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,r,n,i,o){return new Qr(e??this.key,r??this.value,n??this.color,i??this.left,o??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,r,n){let i=this;const o=n(e,i.key);return i=o<0?i.copy(null,null,null,i.left.insert(e,r,n),null):o===0?i.copy(null,r,null,null,null):i.copy(null,null,null,null,i.right.insert(e,r,n)),i.fixUp()}removeMin(){if(this.left.isEmpty())return Qr.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,r){let n,i=this;if(r(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,r),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),r(e,i.key)===0){if(i.right.isEmpty())return Qr.EMPTY;n=i.right.min(),i=i.copy(n.key,n.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,r))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Qr.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Qr.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),r=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,r)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw rt(43730,{key:this.key,value:this.value});if(this.right.isRed())throw rt(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw rt(27949);return e+(this.isRed()?0:1)}}Qr.EMPTY=null,Qr.RED=!0,Qr.BLACK=!1;Qr.EMPTY=new class{constructor(){this.size=0}get key(){throw rt(57766)}get value(){throw rt(16141)}get color(){throw rt(16727)}get left(){throw rt(29726)}get right(){throw rt(36894)}copy(e,r,n,i,o){return this}insert(e,r,n){return new Qr(e,r)}remove(e,r){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pr{constructor(e){this.comparator=e,this.data=new or(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((r,n)=>(e(r),!1))}forEachInRange(e,r){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const i=n.getNext();if(this.comparator(i.key,e[1])>=0)return;r(i.key)}}forEachWhile(e,r){let n;for(n=r!==void 0?this.data.getIteratorFrom(r):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const r=this.data.getIteratorFrom(e);return r.hasNext()?r.getNext().key:null}getIterator(){return new OE(this.data.getIterator())}getIteratorFrom(e){return new OE(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let r=this;return r.size<e.size&&(r=e,e=this),e.forEach(n=>{r=r.add(n)}),r}isEqual(e){if(!(e instanceof Pr)||this.size!==e.size)return!1;const r=this.data.getIterator(),n=e.data.getIterator();for(;r.hasNext();){const i=r.getNext().key,o=n.getNext().key;if(this.comparator(i,o)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(r=>{e.push(r)}),e}toString(){const e=[];return this.forEach(r=>e.push(r)),"SortedSet("+e.toString()+")"}copy(e){const r=new Pr(this.comparator);return r.data=e,r}}class OE{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wn{constructor(e){this.fields=e,e.sort(Jr.comparator)}static empty(){return new Wn([])}unionWith(e){let r=new Pr(Jr.comparator);for(const n of this.fields)r=r.add(n);for(const n of e)r=r.add(n);return new Wn(r.toArray())}covers(e){for(const r of this.fields)if(r.isPrefixOf(e))return!0;return!1}isEqual(e){return oc(this.fields,e.fields,(r,n)=>r.isEqual(n))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BA extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rn{constructor(e){this.binaryString=e}static fromBase64String(e){const r=function(i){try{return atob(i)}catch(o){throw typeof DOMException<"u"&&o instanceof DOMException?new BA("Invalid base64 string: "+o):o}}(e);return new rn(r)}static fromUint8Array(e){const r=function(i){let o="";for(let c=0;c<i.length;++c)o+=String.fromCharCode(i[c]);return o}(e);return new rn(r)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(r){return btoa(r)}(this.binaryString)}toUint8Array(){return function(r){const n=new Uint8Array(r.length);for(let i=0;i<r.length;i++)n[i]=r.charCodeAt(i);return n}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return mt(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}rn.EMPTY_BYTE_STRING=new rn("");const KD=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Bs(t){if(jt(!!t,39018),typeof t=="string"){let e=0;const r=KD.exec(t);if(jt(!!r,46558,{timestamp:t}),r[1]){let i=r[1];i=(i+"000000000").substr(0,9),e=Number(i)}const n=new Date(t);return{seconds:Math.floor(n.getTime()/1e3),nanos:e}}return{seconds:vr(t.seconds),nanos:vr(t.nanos)}}function vr(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function js(t){return typeof t=="string"?rn.fromBase64String(t):rn.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jA="server_timestamp",zA="__type__",HA="__previous_value__",GA="__local_write_time__";function m1(t){var e,r;return((r=(((e=t?.mapValue)===null||e===void 0?void 0:e.fields)||{})[zA])===null||r===void 0?void 0:r.stringValue)===jA}function dd(t){const e=t.mapValue.fields[HA];return m1(e)?dd(e):e}function nf(t){const e=Bs(t.mapValue.fields[GA].timestampValue);return new tr(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WD{constructor(e,r,n,i,o,c,u,h,d,g){this.databaseId=e,this.appId=r,this.persistenceKey=n,this.host=i,this.ssl=o,this.forceLongPolling=c,this.autoDetectLongPolling=u,this.longPollingOptions=h,this.useFetchStreams=d,this.isUsingEmulator=g}}const M0="(default)";class af{constructor(e,r){this.projectId=e,this.database=r||M0}static empty(){return new af("","")}get isDefaultDatabase(){return this.database===M0}isEqual(e){return e instanceof af&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qA="__type__",XD="__max__",r0={mapValue:{}},KA="__vector__",L0="value";function zs(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?m1(t)?4:$D(t)?9007199254740991:YD(t)?10:11:rt(28295,{value:t})}function ii(t,e){if(t===e)return!0;const r=zs(t);if(r!==zs(e))return!1;switch(r){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return nf(t).isEqual(nf(e));case 3:return function(i,o){if(typeof i.timestampValue=="string"&&typeof o.timestampValue=="string"&&i.timestampValue.length===o.timestampValue.length)return i.timestampValue===o.timestampValue;const c=Bs(i.timestampValue),u=Bs(o.timestampValue);return c.seconds===u.seconds&&c.nanos===u.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(i,o){return js(i.bytesValue).isEqual(js(o.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(i,o){return vr(i.geoPointValue.latitude)===vr(o.geoPointValue.latitude)&&vr(i.geoPointValue.longitude)===vr(o.geoPointValue.longitude)}(t,e);case 2:return function(i,o){if("integerValue"in i&&"integerValue"in o)return vr(i.integerValue)===vr(o.integerValue);if("doubleValue"in i&&"doubleValue"in o){const c=vr(i.doubleValue),u=vr(o.doubleValue);return c===u?P0(c)===P0(u):isNaN(c)&&isNaN(u)}return!1}(t,e);case 9:return oc(t.arrayValue.values||[],e.arrayValue.values||[],ii);case 10:case 11:return function(i,o){const c=i.mapValue.fields||{},u=o.mapValue.fields||{};if(DE(c)!==DE(u))return!1;for(const h in c)if(c.hasOwnProperty(h)&&(u[h]===void 0||!ii(c[h],u[h])))return!1;return!0}(t,e);default:return rt(52216,{left:t})}}function sf(t,e){return(t.values||[]).find(r=>ii(r,e))!==void 0}function lc(t,e){if(t===e)return 0;const r=zs(t),n=zs(e);if(r!==n)return mt(r,n);switch(r){case 0:case 9007199254740991:return 0;case 1:return mt(t.booleanValue,e.booleanValue);case 2:return function(o,c){const u=vr(o.integerValue||o.doubleValue),h=vr(c.integerValue||c.doubleValue);return u<h?-1:u>h?1:u===h?0:isNaN(u)?isNaN(h)?0:-1:1}(t,e);case 3:return NE(t.timestampValue,e.timestampValue);case 4:return NE(nf(t),nf(e));case 5:return gg(t.stringValue,e.stringValue);case 6:return function(o,c){const u=js(o),h=js(c);return u.compareTo(h)}(t.bytesValue,e.bytesValue);case 7:return function(o,c){const u=o.split("/"),h=c.split("/");for(let d=0;d<u.length&&d<h.length;d++){const g=mt(u[d],h[d]);if(g!==0)return g}return mt(u.length,h.length)}(t.referenceValue,e.referenceValue);case 8:return function(o,c){const u=mt(vr(o.latitude),vr(c.latitude));return u!==0?u:mt(vr(o.longitude),vr(c.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return FE(t.arrayValue,e.arrayValue);case 10:return function(o,c){var u,h,d,g;const _=o.fields||{},x=c.fields||{},A=(u=_[L0])===null||u===void 0?void 0:u.arrayValue,S=(h=x[L0])===null||h===void 0?void 0:h.arrayValue,R=mt(((d=A?.values)===null||d===void 0?void 0:d.length)||0,((g=S?.values)===null||g===void 0?void 0:g.length)||0);return R!==0?R:FE(A,S)}(t.mapValue,e.mapValue);case 11:return function(o,c){if(o===r0.mapValue&&c===r0.mapValue)return 0;if(o===r0.mapValue)return 1;if(c===r0.mapValue)return-1;const u=o.fields||{},h=Object.keys(u),d=c.fields||{},g=Object.keys(d);h.sort(),g.sort();for(let _=0;_<h.length&&_<g.length;++_){const x=gg(h[_],g[_]);if(x!==0)return x;const A=lc(u[h[_]],d[g[_]]);if(A!==0)return A}return mt(h.length,g.length)}(t.mapValue,e.mapValue);default:throw rt(23264,{le:r})}}function NE(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return mt(t,e);const r=Bs(t),n=Bs(e),i=mt(r.seconds,n.seconds);return i!==0?i:mt(r.nanos,n.nanos)}function FE(t,e){const r=t.values||[],n=e.values||[];for(let i=0;i<r.length&&i<n.length;++i){const o=lc(r[i],n[i]);if(o)return o}return mt(r.length,n.length)}function cc(t){return vg(t)}function vg(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(r){const n=Bs(r);return`time(${n.seconds},${n.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(r){return js(r).toBase64()}(t.bytesValue):"referenceValue"in t?function(r){return $e.fromName(r).toString()}(t.referenceValue):"geoPointValue"in t?function(r){return`geo(${r.latitude},${r.longitude})`}(t.geoPointValue):"arrayValue"in t?function(r){let n="[",i=!0;for(const o of r.values||[])i?i=!1:n+=",",n+=vg(o);return n+"]"}(t.arrayValue):"mapValue"in t?function(r){const n=Object.keys(r.fields||{}).sort();let i="{",o=!0;for(const c of n)o?o=!1:i+=",",i+=`${c}:${vg(r.fields[c])}`;return i+"}"}(t.mapValue):rt(61005,{value:t})}function y0(t){switch(zs(t)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=dd(t);return e?16+y0(e):16;case 5:return 2*t.stringValue.length;case 6:return js(t.bytesValue).approximateByteSize();case 7:return t.referenceValue.length;case 9:return function(n){return(n.values||[]).reduce((i,o)=>i+y0(o),0)}(t.arrayValue);case 10:case 11:return function(n){let i=0;return Qs(n.fields,(o,c)=>{i+=o.length+y0(c)}),i}(t.mapValue);default:throw rt(13486,{value:t})}}function PE(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function _g(t){return!!t&&"integerValue"in t}function g1(t){return!!t&&"arrayValue"in t}function ME(t){return!!t&&"nullValue"in t}function LE(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function E0(t){return!!t&&"mapValue"in t}function YD(t){var e,r;return((r=(((e=t?.mapValue)===null||e===void 0?void 0:e.fields)||{})[qA])===null||r===void 0?void 0:r.stringValue)===KA}function Lu(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return Qs(t.mapValue.fields,(r,n)=>e.mapValue.fields[r]=Lu(n)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let r=0;r<(t.arrayValue.values||[]).length;++r)e.arrayValue.values[r]=Lu(t.arrayValue.values[r]);return e}return Object.assign({},t)}function $D(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue===XD}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pn{constructor(e){this.value=e}static empty(){return new Pn({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let r=this.value;for(let n=0;n<e.length-1;++n)if(r=(r.mapValue.fields||{})[e.get(n)],!E0(r))return null;return r=(r.mapValue.fields||{})[e.lastSegment()],r||null}}set(e,r){this.getFieldsMap(e.popLast())[e.lastSegment()]=Lu(r)}setAll(e){let r=Jr.emptyPath(),n={},i=[];e.forEach((c,u)=>{if(!r.isImmediateParentOf(u)){const h=this.getFieldsMap(r);this.applyChanges(h,n,i),n={},i=[],r=u.popLast()}c?n[u.lastSegment()]=Lu(c):i.push(u.lastSegment())});const o=this.getFieldsMap(r);this.applyChanges(o,n,i)}delete(e){const r=this.field(e.popLast());E0(r)&&r.mapValue.fields&&delete r.mapValue.fields[e.lastSegment()]}isEqual(e){return ii(this.value,e.value)}getFieldsMap(e){let r=this.value;r.mapValue.fields||(r.mapValue={fields:{}});for(let n=0;n<e.length;++n){let i=r.mapValue.fields[e.get(n)];E0(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},r.mapValue.fields[e.get(n)]=i),r=i}return r.mapValue.fields}applyChanges(e,r,n){Qs(r,(i,o)=>e[i]=o);for(const i of n)delete e[i]}clone(){return new Pn(Lu(this.value))}}function WA(t){const e=[];return Qs(t.fields,(r,n)=>{const i=new Jr([r]);if(E0(n)){const o=WA(n.mapValue).fields;if(o.length===0)e.push(i);else for(const c of o)e.push(i.child(c))}else e.push(i)}),new Wn(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class un{constructor(e,r,n,i,o,c,u){this.key=e,this.documentType=r,this.version=n,this.readTime=i,this.createTime=o,this.data=c,this.documentState=u}static newInvalidDocument(e){return new un(e,0,lt.min(),lt.min(),lt.min(),Pn.empty(),0)}static newFoundDocument(e,r,n,i){return new un(e,1,r,lt.min(),n,i,0)}static newNoDocument(e,r){return new un(e,2,r,lt.min(),lt.min(),Pn.empty(),0)}static newUnknownDocument(e,r){return new un(e,3,r,lt.min(),lt.min(),Pn.empty(),2)}convertToFoundDocument(e,r){return!this.createTime.isEqual(lt.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=r,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Pn.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Pn.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=lt.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof un&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new un(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class V0{constructor(e,r){this.position=e,this.inclusive=r}}function VE(t,e,r){let n=0;for(let i=0;i<t.position.length;i++){const o=e[i],c=t.position[i];if(o.field.isKeyField()?n=$e.comparator($e.fromName(c.referenceValue),r.key):n=lc(c,r.data.field(o.field)),o.dir==="desc"&&(n*=-1),n!==0)break}return n}function UE(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let r=0;r<t.position.length;r++)if(!ii(t.position[r],e.position[r]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class U0{constructor(e,r="asc"){this.field=e,this.dir=r}}function QD(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XA{}class kr extends XA{constructor(e,r,n){super(),this.field=e,this.op=r,this.value=n}static create(e,r,n){return e.isKeyField()?r==="in"||r==="not-in"?this.createKeyFieldInFilter(e,r,n):new JD(e,r,n):r==="array-contains"?new rO(e,n):r==="in"?new nO(e,n):r==="not-in"?new aO(e,n):r==="array-contains-any"?new iO(e,n):new kr(e,r,n)}static createKeyFieldInFilter(e,r,n){return r==="in"?new eO(e,n):new tO(e,n)}matches(e){const r=e.data.field(this.field);return this.op==="!="?r!==null&&r.nullValue===void 0&&this.matchesComparison(lc(r,this.value)):r!==null&&zs(this.value)===zs(r)&&this.matchesComparison(lc(r,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return rt(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Na extends XA{constructor(e,r){super(),this.filters=e,this.op=r,this.he=null}static create(e,r){return new Na(e,r)}matches(e){return YA(this)?this.filters.find(r=>!r.matches(e))===void 0:this.filters.find(r=>r.matches(e))!==void 0}getFlattenedFilters(){return this.he!==null||(this.he=this.filters.reduce((e,r)=>e.concat(r.getFlattenedFilters()),[])),this.he}getFilters(){return Object.assign([],this.filters)}}function YA(t){return t.op==="and"}function $A(t){return ZD(t)&&YA(t)}function ZD(t){for(const e of t.filters)if(e instanceof Na)return!1;return!0}function xg(t){if(t instanceof kr)return t.field.canonicalString()+t.op.toString()+cc(t.value);if($A(t))return t.filters.map(e=>xg(e)).join(",");{const e=t.filters.map(r=>xg(r)).join(",");return`${t.op}(${e})`}}function QA(t,e){return t instanceof kr?function(n,i){return i instanceof kr&&n.op===i.op&&n.field.isEqual(i.field)&&ii(n.value,i.value)}(t,e):t instanceof Na?function(n,i){return i instanceof Na&&n.op===i.op&&n.filters.length===i.filters.length?n.filters.reduce((o,c,u)=>o&&QA(c,i.filters[u]),!0):!1}(t,e):void rt(19439)}function ZA(t){return t instanceof kr?function(r){return`${r.field.canonicalString()} ${r.op} ${cc(r.value)}`}(t):t instanceof Na?function(r){return r.op.toString()+" {"+r.getFilters().map(ZA).join(" ,")+"}"}(t):"Filter"}class JD extends kr{constructor(e,r,n){super(e,r,n),this.key=$e.fromName(n.referenceValue)}matches(e){const r=$e.comparator(e.key,this.key);return this.matchesComparison(r)}}class eO extends kr{constructor(e,r){super(e,"in",r),this.keys=JA("in",r)}matches(e){return this.keys.some(r=>r.isEqual(e.key))}}class tO extends kr{constructor(e,r){super(e,"not-in",r),this.keys=JA("not-in",r)}matches(e){return!this.keys.some(r=>r.isEqual(e.key))}}function JA(t,e){var r;return(((r=e.arrayValue)===null||r===void 0?void 0:r.values)||[]).map(n=>$e.fromName(n.referenceValue))}class rO extends kr{constructor(e,r){super(e,"array-contains",r)}matches(e){const r=e.data.field(this.field);return g1(r)&&sf(r.arrayValue,this.value)}}class nO extends kr{constructor(e,r){super(e,"in",r)}matches(e){const r=e.data.field(this.field);return r!==null&&sf(this.value.arrayValue,r)}}class aO extends kr{constructor(e,r){super(e,"not-in",r)}matches(e){if(sf(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const r=e.data.field(this.field);return r!==null&&r.nullValue===void 0&&!sf(this.value.arrayValue,r)}}class iO extends kr{constructor(e,r){super(e,"array-contains-any",r)}matches(e){const r=e.data.field(this.field);return!(!g1(r)||!r.arrayValue.values)&&r.arrayValue.values.some(n=>sf(this.value.arrayValue,n))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sO{constructor(e,r=null,n=[],i=[],o=null,c=null,u=null){this.path=e,this.collectionGroup=r,this.orderBy=n,this.filters=i,this.limit=o,this.startAt=c,this.endAt=u,this.Pe=null}}function BE(t,e=null,r=[],n=[],i=null,o=null,c=null){return new sO(t,e,r,n,i,o,c)}function v1(t){const e=ct(t);if(e.Pe===null){let r=e.path.canonicalString();e.collectionGroup!==null&&(r+="|cg:"+e.collectionGroup),r+="|f:",r+=e.filters.map(n=>xg(n)).join(","),r+="|ob:",r+=e.orderBy.map(n=>function(o){return o.field.canonicalString()+o.dir}(n)).join(","),hd(e.limit)||(r+="|l:",r+=e.limit),e.startAt&&(r+="|lb:",r+=e.startAt.inclusive?"b:":"a:",r+=e.startAt.position.map(n=>cc(n)).join(",")),e.endAt&&(r+="|ub:",r+=e.endAt.inclusive?"a:":"b:",r+=e.endAt.position.map(n=>cc(n)).join(",")),e.Pe=r}return e.Pe}function _1(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let r=0;r<t.orderBy.length;r++)if(!QD(t.orderBy[r],e.orderBy[r]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let r=0;r<t.filters.length;r++)if(!QA(t.filters[r],e.filters[r]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!UE(t.startAt,e.startAt)&&UE(t.endAt,e.endAt)}function yg(t){return $e.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sf{constructor(e,r=null,n=[],i=[],o=null,c="F",u=null,h=null){this.path=e,this.collectionGroup=r,this.explicitOrderBy=n,this.filters=i,this.limit=o,this.limitType=c,this.startAt=u,this.endAt=h,this.Te=null,this.Ie=null,this.de=null,this.startAt,this.endAt}}function oO(t,e,r,n,i,o,c,u){return new Sf(t,e,r,n,i,o,c,u)}function x1(t){return new Sf(t)}function jE(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function ew(t){return t.collectionGroup!==null}function Vu(t){const e=ct(t);if(e.Te===null){e.Te=[];const r=new Set;for(const o of e.explicitOrderBy)e.Te.push(o),r.add(o.field.canonicalString());const n=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(c){let u=new Pr(Jr.comparator);return c.filters.forEach(h=>{h.getFlattenedFilters().forEach(d=>{d.isInequality()&&(u=u.add(d.field))})}),u})(e).forEach(o=>{r.has(o.canonicalString())||o.isKeyField()||e.Te.push(new U0(o,n))}),r.has(Jr.keyField().canonicalString())||e.Te.push(new U0(Jr.keyField(),n))}return e.Te}function ti(t){const e=ct(t);return e.Ie||(e.Ie=lO(e,Vu(t))),e.Ie}function lO(t,e){if(t.limitType==="F")return BE(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(i=>{const o=i.dir==="desc"?"asc":"desc";return new U0(i.field,o)});const r=t.endAt?new V0(t.endAt.position,t.endAt.inclusive):null,n=t.startAt?new V0(t.startAt.position,t.startAt.inclusive):null;return BE(t.path,t.collectionGroup,e,t.filters,t.limit,r,n)}}function Eg(t,e){const r=t.filters.concat([e]);return new Sf(t.path,t.collectionGroup,t.explicitOrderBy.slice(),r,t.limit,t.limitType,t.startAt,t.endAt)}function Tg(t,e,r){return new Sf(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,r,t.startAt,t.endAt)}function pd(t,e){return _1(ti(t),ti(e))&&t.limitType===e.limitType}function tw(t){return`${v1(ti(t))}|lt:${t.limitType}`}function Kl(t){return`Query(target=${function(r){let n=r.path.canonicalString();return r.collectionGroup!==null&&(n+=" collectionGroup="+r.collectionGroup),r.filters.length>0&&(n+=`, filters: [${r.filters.map(i=>ZA(i)).join(", ")}]`),hd(r.limit)||(n+=", limit: "+r.limit),r.orderBy.length>0&&(n+=`, orderBy: [${r.orderBy.map(i=>function(c){return`${c.field.canonicalString()} (${c.dir})`}(i)).join(", ")}]`),r.startAt&&(n+=", startAt: ",n+=r.startAt.inclusive?"b:":"a:",n+=r.startAt.position.map(i=>cc(i)).join(",")),r.endAt&&(n+=", endAt: ",n+=r.endAt.inclusive?"a:":"b:",n+=r.endAt.position.map(i=>cc(i)).join(",")),`Target(${n})`}(ti(t))}; limitType=${t.limitType})`}function md(t,e){return e.isFoundDocument()&&function(n,i){const o=i.key.path;return n.collectionGroup!==null?i.key.hasCollectionId(n.collectionGroup)&&n.path.isPrefixOf(o):$e.isDocumentKey(n.path)?n.path.isEqual(o):n.path.isImmediateParentOf(o)}(t,e)&&function(n,i){for(const o of Vu(n))if(!o.field.isKeyField()&&i.data.field(o.field)===null)return!1;return!0}(t,e)&&function(n,i){for(const o of n.filters)if(!o.matches(i))return!1;return!0}(t,e)&&function(n,i){return!(n.startAt&&!function(c,u,h){const d=VE(c,u,h);return c.inclusive?d<=0:d<0}(n.startAt,Vu(n),i)||n.endAt&&!function(c,u,h){const d=VE(c,u,h);return c.inclusive?d>=0:d>0}(n.endAt,Vu(n),i))}(t,e)}function cO(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function rw(t){return(e,r)=>{let n=!1;for(const i of Vu(t)){const o=uO(i,e,r);if(o!==0)return o;n=n||i.field.isKeyField()}return 0}}function uO(t,e,r){const n=t.field.isKeyField()?$e.comparator(e.key,r.key):function(o,c,u){const h=c.data.field(o),d=u.data.field(o);return h!==null&&d!==null?lc(h,d):rt(42886)}(t.field,e,r);switch(t.dir){case"asc":return n;case"desc":return-1*n;default:return rt(19790,{direction:t.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xo{constructor(e,r){this.mapKeyFn=e,this.equalsFn=r,this.inner={},this.innerSize=0}get(e){const r=this.mapKeyFn(e),n=this.inner[r];if(n!==void 0){for(const[i,o]of n)if(this.equalsFn(i,e))return o}}has(e){return this.get(e)!==void 0}set(e,r){const n=this.mapKeyFn(e),i=this.inner[n];if(i===void 0)return this.inner[n]=[[e,r]],void this.innerSize++;for(let o=0;o<i.length;o++)if(this.equalsFn(i[o][0],e))return void(i[o]=[e,r]);i.push([e,r]),this.innerSize++}delete(e){const r=this.mapKeyFn(e),n=this.inner[r];if(n===void 0)return!1;for(let i=0;i<n.length;i++)if(this.equalsFn(n[i][0],e))return n.length===1?delete this.inner[r]:n.splice(i,1),this.innerSize--,!0;return!1}forEach(e){Qs(this.inner,(r,n)=>{for(const[i,o]of n)e(i,o)})}isEmpty(){return UA(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fO=new or($e.comparator);function ji(){return fO}const nw=new or($e.comparator);function ku(...t){let e=nw;for(const r of t)e=e.insert(r.key,r);return e}function aw(t){let e=nw;return t.forEach((r,n)=>e=e.insert(r,n.overlayedDocument)),e}function Oo(){return Uu()}function iw(){return Uu()}function Uu(){return new Xo(t=>t.toString(),(t,e)=>t.isEqual(e))}const hO=new or($e.comparator),dO=new Pr($e.comparator);function At(...t){let e=dO;for(const r of t)e=e.add(r);return e}const pO=new Pr(mt);function mO(){return pO}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function y1(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:P0(e)?"-0":e}}function sw(t){return{integerValue:""+t}}function gO(t,e){return HD(e)?sw(e):y1(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gd{constructor(){this._=void 0}}function vO(t,e,r){return t instanceof B0?function(i,o){const c={fields:{[zA]:{stringValue:jA},[GA]:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return o&&m1(o)&&(o=dd(o)),o&&(c.fields[HA]=o),{mapValue:c}}(r,e):t instanceof of?lw(t,e):t instanceof lf?cw(t,e):function(i,o){const c=ow(i,o),u=zE(c)+zE(i.Ee);return _g(c)&&_g(i.Ee)?sw(u):y1(i.serializer,u)}(t,e)}function _O(t,e,r){return t instanceof of?lw(t,e):t instanceof lf?cw(t,e):r}function ow(t,e){return t instanceof j0?function(n){return _g(n)||function(o){return!!o&&"doubleValue"in o}(n)}(e)?e:{integerValue:0}:null}class B0 extends gd{}class of extends gd{constructor(e){super(),this.elements=e}}function lw(t,e){const r=uw(e);for(const n of t.elements)r.some(i=>ii(i,n))||r.push(n);return{arrayValue:{values:r}}}class lf extends gd{constructor(e){super(),this.elements=e}}function cw(t,e){let r=uw(e);for(const n of t.elements)r=r.filter(i=>!ii(i,n));return{arrayValue:{values:r}}}class j0 extends gd{constructor(e,r){super(),this.serializer=e,this.Ee=r}}function zE(t){return vr(t.integerValue||t.doubleValue)}function uw(t){return g1(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}function xO(t,e){return t.field.isEqual(e.field)&&function(n,i){return n instanceof of&&i instanceof of||n instanceof lf&&i instanceof lf?oc(n.elements,i.elements,ii):n instanceof j0&&i instanceof j0?ii(n.Ee,i.Ee):n instanceof B0&&i instanceof B0}(t.transform,e.transform)}class yO{constructor(e,r){this.version=e,this.transformResults=r}}class pa{constructor(e,r){this.updateTime=e,this.exists=r}static none(){return new pa}static exists(e){return new pa(void 0,e)}static updateTime(e){return new pa(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function T0(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class vd{}function fw(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new E1(t.key,pa.none()):new Cf(t.key,t.data,pa.none());{const r=t.data,n=Pn.empty();let i=new Pr(Jr.comparator);for(let o of e.fields)if(!i.has(o)){let c=r.field(o);c===null&&o.length>1&&(o=o.popLast(),c=r.field(o)),c===null?n.delete(o):n.set(o,c),i=i.add(o)}return new Zs(t.key,n,new Wn(i.toArray()),pa.none())}}function EO(t,e,r){t instanceof Cf?function(i,o,c){const u=i.value.clone(),h=GE(i.fieldTransforms,o,c.transformResults);u.setAll(h),o.convertToFoundDocument(c.version,u).setHasCommittedMutations()}(t,e,r):t instanceof Zs?function(i,o,c){if(!T0(i.precondition,o))return void o.convertToUnknownDocument(c.version);const u=GE(i.fieldTransforms,o,c.transformResults),h=o.data;h.setAll(hw(i)),h.setAll(u),o.convertToFoundDocument(c.version,h).setHasCommittedMutations()}(t,e,r):function(i,o,c){o.convertToNoDocument(c.version).setHasCommittedMutations()}(0,e,r)}function Bu(t,e,r,n){return t instanceof Cf?function(o,c,u,h){if(!T0(o.precondition,c))return u;const d=o.value.clone(),g=qE(o.fieldTransforms,h,c);return d.setAll(g),c.convertToFoundDocument(c.version,d).setHasLocalMutations(),null}(t,e,r,n):t instanceof Zs?function(o,c,u,h){if(!T0(o.precondition,c))return u;const d=qE(o.fieldTransforms,h,c),g=c.data;return g.setAll(hw(o)),g.setAll(d),c.convertToFoundDocument(c.version,g).setHasLocalMutations(),u===null?null:u.unionWith(o.fieldMask.fields).unionWith(o.fieldTransforms.map(_=>_.field))}(t,e,r,n):function(o,c,u){return T0(o.precondition,c)?(c.convertToNoDocument(c.version).setHasLocalMutations(),null):u}(t,e,r)}function TO(t,e){let r=null;for(const n of t.fieldTransforms){const i=e.data.field(n.field),o=ow(n.transform,i||null);o!=null&&(r===null&&(r=Pn.empty()),r.set(n.field,o))}return r||null}function HE(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(n,i){return n===void 0&&i===void 0||!(!n||!i)&&oc(n,i,(o,c)=>xO(o,c))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class Cf extends vd{constructor(e,r,n,i=[]){super(),this.key=e,this.value=r,this.precondition=n,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class Zs extends vd{constructor(e,r,n,i,o=[]){super(),this.key=e,this.data=r,this.fieldMask=n,this.precondition=i,this.fieldTransforms=o,this.type=1}getFieldMask(){return this.fieldMask}}function hw(t){const e=new Map;return t.fieldMask.fields.forEach(r=>{if(!r.isEmpty()){const n=t.data.field(r);e.set(r,n)}}),e}function GE(t,e,r){const n=new Map;jt(t.length===r.length,32656,{Ae:r.length,Re:t.length});for(let i=0;i<r.length;i++){const o=t[i],c=o.transform,u=e.data.field(o.field);n.set(o.field,_O(c,u,r[i]))}return n}function qE(t,e,r){const n=new Map;for(const i of t){const o=i.transform,c=r.data.field(i.field);n.set(i.field,vO(o,c,e))}return n}class E1 extends vd{constructor(e,r){super(),this.key=e,this.precondition=r,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class AO extends vd{constructor(e,r){super(),this.key=e,this.precondition=r,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wO{constructor(e,r,n,i){this.batchId=e,this.localWriteTime=r,this.baseMutations=n,this.mutations=i}applyToRemoteDocument(e,r){const n=r.mutationResults;for(let i=0;i<this.mutations.length;i++){const o=this.mutations[i];o.key.isEqual(e.key)&&EO(o,e,n[i])}}applyToLocalView(e,r){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(r=Bu(n,e,r,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(r=Bu(n,e,r,this.localWriteTime));return r}applyToLocalDocumentSet(e,r){const n=iw();return this.mutations.forEach(i=>{const o=e.get(i.key),c=o.overlayedDocument;let u=this.applyToLocalView(c,o.mutatedFields);u=r.has(i.key)?null:u;const h=fw(c,u);h!==null&&n.set(i.key,h),c.isValidDocument()||c.convertToNoDocument(lt.min())}),n}keys(){return this.mutations.reduce((e,r)=>e.add(r.key),At())}isEqual(e){return this.batchId===e.batchId&&oc(this.mutations,e.mutations,(r,n)=>HE(r,n))&&oc(this.baseMutations,e.baseMutations,(r,n)=>HE(r,n))}}class T1{constructor(e,r,n,i){this.batch=e,this.commitVersion=r,this.mutationResults=n,this.docVersions=i}static from(e,r,n){jt(e.mutations.length===n.length,58842,{Ve:e.mutations.length,me:n.length});let i=function(){return hO}();const o=e.mutations;for(let c=0;c<o.length;c++)i=i.insert(o[c].key,n[c].version);return new T1(e,r,n,i)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SO{constructor(e,r){this.largestBatchId=e,this.mutation=r}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CO{constructor(e,r){this.count=e,this.unchangedNames=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Sr,It;function RO(t){switch(t){case Re.OK:return rt(64938);case Re.CANCELLED:case Re.UNKNOWN:case Re.DEADLINE_EXCEEDED:case Re.RESOURCE_EXHAUSTED:case Re.INTERNAL:case Re.UNAVAILABLE:case Re.UNAUTHENTICATED:return!1;case Re.INVALID_ARGUMENT:case Re.NOT_FOUND:case Re.ALREADY_EXISTS:case Re.PERMISSION_DENIED:case Re.FAILED_PRECONDITION:case Re.ABORTED:case Re.OUT_OF_RANGE:case Re.UNIMPLEMENTED:case Re.DATA_LOSS:return!0;default:return rt(15467,{code:t})}}function dw(t){if(t===void 0)return Bi("GRPC error has no .code"),Re.UNKNOWN;switch(t){case Sr.OK:return Re.OK;case Sr.CANCELLED:return Re.CANCELLED;case Sr.UNKNOWN:return Re.UNKNOWN;case Sr.DEADLINE_EXCEEDED:return Re.DEADLINE_EXCEEDED;case Sr.RESOURCE_EXHAUSTED:return Re.RESOURCE_EXHAUSTED;case Sr.INTERNAL:return Re.INTERNAL;case Sr.UNAVAILABLE:return Re.UNAVAILABLE;case Sr.UNAUTHENTICATED:return Re.UNAUTHENTICATED;case Sr.INVALID_ARGUMENT:return Re.INVALID_ARGUMENT;case Sr.NOT_FOUND:return Re.NOT_FOUND;case Sr.ALREADY_EXISTS:return Re.ALREADY_EXISTS;case Sr.PERMISSION_DENIED:return Re.PERMISSION_DENIED;case Sr.FAILED_PRECONDITION:return Re.FAILED_PRECONDITION;case Sr.ABORTED:return Re.ABORTED;case Sr.OUT_OF_RANGE:return Re.OUT_OF_RANGE;case Sr.UNIMPLEMENTED:return Re.UNIMPLEMENTED;case Sr.DATA_LOSS:return Re.DATA_LOSS;default:return rt(39323,{code:t})}}(It=Sr||(Sr={}))[It.OK=0]="OK",It[It.CANCELLED=1]="CANCELLED",It[It.UNKNOWN=2]="UNKNOWN",It[It.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",It[It.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",It[It.NOT_FOUND=5]="NOT_FOUND",It[It.ALREADY_EXISTS=6]="ALREADY_EXISTS",It[It.PERMISSION_DENIED=7]="PERMISSION_DENIED",It[It.UNAUTHENTICATED=16]="UNAUTHENTICATED",It[It.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",It[It.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",It[It.ABORTED=10]="ABORTED",It[It.OUT_OF_RANGE=11]="OUT_OF_RANGE",It[It.UNIMPLEMENTED=12]="UNIMPLEMENTED",It[It.INTERNAL=13]="INTERNAL",It[It.UNAVAILABLE=14]="UNAVAILABLE",It[It.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kO=new Fs([4294967295,4294967295],0);function KE(t){const e=PA().encode(t),r=new RA;return r.update(e),new Uint8Array(r.digest())}function WE(t){const e=new DataView(t.buffer),r=e.getUint32(0,!0),n=e.getUint32(4,!0),i=e.getUint32(8,!0),o=e.getUint32(12,!0);return[new Fs([r,n],0),new Fs([i,o],0)]}class A1{constructor(e,r,n){if(this.bitmap=e,this.padding=r,this.hashCount=n,r<0||r>=8)throw new bu(`Invalid padding: ${r}`);if(n<0)throw new bu(`Invalid hash count: ${n}`);if(e.length>0&&this.hashCount===0)throw new bu(`Invalid hash count: ${n}`);if(e.length===0&&r!==0)throw new bu(`Invalid padding when bitmap length is 0: ${r}`);this.fe=8*e.length-r,this.ge=Fs.fromNumber(this.fe)}pe(e,r,n){let i=e.add(r.multiply(Fs.fromNumber(n)));return i.compare(kO)===1&&(i=new Fs([i.getBits(0),i.getBits(1)],0)),i.modulo(this.ge).toNumber()}ye(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.fe===0)return!1;const r=KE(e),[n,i]=WE(r);for(let o=0;o<this.hashCount;o++){const c=this.pe(n,i,o);if(!this.ye(c))return!1}return!0}static create(e,r,n){const i=e%8==0?0:8-e%8,o=new Uint8Array(Math.ceil(e/8)),c=new A1(o,i,r);return n.forEach(u=>c.insert(u)),c}insert(e){if(this.fe===0)return;const r=KE(e),[n,i]=WE(r);for(let o=0;o<this.hashCount;o++){const c=this.pe(n,i,o);this.we(c)}}we(e){const r=Math.floor(e/8),n=e%8;this.bitmap[r]|=1<<n}}class bu extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _d{constructor(e,r,n,i,o){this.snapshotVersion=e,this.targetChanges=r,this.targetMismatches=n,this.documentUpdates=i,this.resolvedLimboDocuments=o}static createSynthesizedRemoteEventForCurrentChange(e,r,n){const i=new Map;return i.set(e,Rf.createSynthesizedTargetChangeForCurrentChange(e,r,n)),new _d(lt.min(),i,new or(mt),ji(),At())}}class Rf{constructor(e,r,n,i,o){this.resumeToken=e,this.current=r,this.addedDocuments=n,this.modifiedDocuments=i,this.removedDocuments=o}static createSynthesizedTargetChangeForCurrentChange(e,r,n){return new Rf(n,r,At(),At(),At())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class A0{constructor(e,r,n,i){this.Se=e,this.removedTargetIds=r,this.key=n,this.be=i}}class pw{constructor(e,r){this.targetId=e,this.De=r}}class mw{constructor(e,r,n=rn.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=r,this.resumeToken=n,this.cause=i}}class XE{constructor(){this.ve=0,this.Ce=YE(),this.Fe=rn.EMPTY_BYTE_STRING,this.Me=!1,this.xe=!0}get current(){return this.Me}get resumeToken(){return this.Fe}get Oe(){return this.ve!==0}get Ne(){return this.xe}Be(e){e.approximateByteSize()>0&&(this.xe=!0,this.Fe=e)}Le(){let e=At(),r=At(),n=At();return this.Ce.forEach((i,o)=>{switch(o){case 0:e=e.add(i);break;case 2:r=r.add(i);break;case 1:n=n.add(i);break;default:rt(38017,{changeType:o})}}),new Rf(this.Fe,this.Me,e,r,n)}ke(){this.xe=!1,this.Ce=YE()}qe(e,r){this.xe=!0,this.Ce=this.Ce.insert(e,r)}Qe(e){this.xe=!0,this.Ce=this.Ce.remove(e)}$e(){this.ve+=1}Ue(){this.ve-=1,jt(this.ve>=0,3241,{ve:this.ve})}Ke(){this.xe=!0,this.Me=!0}}class bO{constructor(e){this.We=e,this.Ge=new Map,this.ze=ji(),this.je=n0(),this.Je=n0(),this.He=new or(mt)}Ye(e){for(const r of e.Se)e.be&&e.be.isFoundDocument()?this.Ze(r,e.be):this.Xe(r,e.key,e.be);for(const r of e.removedTargetIds)this.Xe(r,e.key,e.be)}et(e){this.forEachTarget(e,r=>{const n=this.tt(r);switch(e.state){case 0:this.nt(r)&&n.Be(e.resumeToken);break;case 1:n.Ue(),n.Oe||n.ke(),n.Be(e.resumeToken);break;case 2:n.Ue(),n.Oe||this.removeTarget(r);break;case 3:this.nt(r)&&(n.Ke(),n.Be(e.resumeToken));break;case 4:this.nt(r)&&(this.rt(r),n.Be(e.resumeToken));break;default:rt(56790,{state:e.state})}})}forEachTarget(e,r){e.targetIds.length>0?e.targetIds.forEach(r):this.Ge.forEach((n,i)=>{this.nt(i)&&r(i)})}it(e){const r=e.targetId,n=e.De.count,i=this.st(r);if(i){const o=i.target;if(yg(o))if(n===0){const c=new $e(o.path);this.Xe(r,c,un.newNoDocument(c,lt.min()))}else jt(n===1,20013,{expectedCount:n});else{const c=this.ot(r);if(c!==n){const u=this._t(e),h=u?this.ut(u,e,c):1;if(h!==0){this.rt(r);const d=h===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.He=this.He.insert(r,d)}}}}}_t(e){const r=e.De.unchangedNames;if(!r||!r.bits)return null;const{bits:{bitmap:n="",padding:i=0},hashCount:o=0}=r;let c,u;try{c=js(n).toUint8Array()}catch(h){if(h instanceof BA)return Vs("Decoding the base64 bloom filter in existence filter failed ("+h.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw h}try{u=new A1(c,i,o)}catch(h){return Vs(h instanceof bu?"BloomFilter error: ":"Applying bloom filter failed: ",h),null}return u.fe===0?null:u}ut(e,r,n){return r.De.count===n-this.ht(e,r.targetId)?0:2}ht(e,r){const n=this.We.getRemoteKeysForTarget(r);let i=0;return n.forEach(o=>{const c=this.We.lt(),u=`projects/${c.projectId}/databases/${c.database}/documents/${o.path.canonicalString()}`;e.mightContain(u)||(this.Xe(r,o,null),i++)}),i}Pt(e){const r=new Map;this.Ge.forEach((o,c)=>{const u=this.st(c);if(u){if(o.current&&yg(u.target)){const h=new $e(u.target.path);this.Tt(h).has(c)||this.It(c,h)||this.Xe(c,h,un.newNoDocument(h,e))}o.Ne&&(r.set(c,o.Le()),o.ke())}});let n=At();this.Je.forEach((o,c)=>{let u=!0;c.forEachWhile(h=>{const d=this.st(h);return!d||d.purpose==="TargetPurposeLimboResolution"||(u=!1,!1)}),u&&(n=n.add(o))}),this.ze.forEach((o,c)=>c.setReadTime(e));const i=new _d(e,r,this.He,this.ze,n);return this.ze=ji(),this.je=n0(),this.Je=n0(),this.He=new or(mt),i}Ze(e,r){if(!this.nt(e))return;const n=this.It(e,r.key)?2:0;this.tt(e).qe(r.key,n),this.ze=this.ze.insert(r.key,r),this.je=this.je.insert(r.key,this.Tt(r.key).add(e)),this.Je=this.Je.insert(r.key,this.dt(r.key).add(e))}Xe(e,r,n){if(!this.nt(e))return;const i=this.tt(e);this.It(e,r)?i.qe(r,1):i.Qe(r),this.Je=this.Je.insert(r,this.dt(r).delete(e)),this.Je=this.Je.insert(r,this.dt(r).add(e)),n&&(this.ze=this.ze.insert(r,n))}removeTarget(e){this.Ge.delete(e)}ot(e){const r=this.tt(e).Le();return this.We.getRemoteKeysForTarget(e).size+r.addedDocuments.size-r.removedDocuments.size}$e(e){this.tt(e).$e()}tt(e){let r=this.Ge.get(e);return r||(r=new XE,this.Ge.set(e,r)),r}dt(e){let r=this.Je.get(e);return r||(r=new Pr(mt),this.Je=this.Je.insert(e,r)),r}Tt(e){let r=this.je.get(e);return r||(r=new Pr(mt),this.je=this.je.insert(e,r)),r}nt(e){const r=this.st(e)!==null;return r||Ge("WatchChangeAggregator","Detected inactive target",e),r}st(e){const r=this.Ge.get(e);return r&&r.Oe?null:this.We.Et(e)}rt(e){this.Ge.set(e,new XE),this.We.getRemoteKeysForTarget(e).forEach(r=>{this.Xe(e,r,null)})}It(e,r){return this.We.getRemoteKeysForTarget(e).has(r)}}function n0(){return new or($e.comparator)}function YE(){return new or($e.comparator)}const IO={asc:"ASCENDING",desc:"DESCENDING"},DO={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},OO={and:"AND",or:"OR"};class NO{constructor(e,r){this.databaseId=e,this.useProto3Json=r}}function Ag(t,e){return t.useProto3Json||hd(e)?e:{value:e}}function z0(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function gw(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function FO(t,e){return z0(t,e.toTimestamp())}function ri(t){return jt(!!t,49232),lt.fromTimestamp(function(r){const n=Bs(r);return new tr(n.seconds,n.nanos)}(t))}function w1(t,e){return wg(t,e).canonicalString()}function wg(t,e){const r=function(i){return new Zt(["projects",i.projectId,"databases",i.database])}(t).child("documents");return e===void 0?r:r.child(e)}function vw(t){const e=Zt.fromString(t);return jt(Tw(e),10190,{key:e.toString()}),e}function Sg(t,e){return w1(t.databaseId,e.path)}function Gm(t,e){const r=vw(e);if(r.get(1)!==t.databaseId.projectId)throw new He(Re.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+r.get(1)+" vs "+t.databaseId.projectId);if(r.get(3)!==t.databaseId.database)throw new He(Re.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+r.get(3)+" vs "+t.databaseId.database);return new $e(xw(r))}function _w(t,e){return w1(t.databaseId,e)}function PO(t){const e=vw(t);return e.length===4?Zt.emptyPath():xw(e)}function Cg(t){return new Zt(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function xw(t){return jt(t.length>4&&t.get(4)==="documents",29091,{key:t.toString()}),t.popFirst(5)}function $E(t,e,r){return{name:Sg(t,e),fields:r.value.mapValue.fields}}function MO(t,e){let r;if("targetChange"in e){e.targetChange;const n=function(d){return d==="NO_CHANGE"?0:d==="ADD"?1:d==="REMOVE"?2:d==="CURRENT"?3:d==="RESET"?4:rt(39313,{state:d})}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],o=function(d,g){return d.useProto3Json?(jt(g===void 0||typeof g=="string",58123),rn.fromBase64String(g||"")):(jt(g===void 0||g instanceof Buffer||g instanceof Uint8Array,16193),rn.fromUint8Array(g||new Uint8Array))}(t,e.targetChange.resumeToken),c=e.targetChange.cause,u=c&&function(d){const g=d.code===void 0?Re.UNKNOWN:dw(d.code);return new He(g,d.message||"")}(c);r=new mw(n,i,o,u||null)}else if("documentChange"in e){e.documentChange;const n=e.documentChange;n.document,n.document.name,n.document.updateTime;const i=Gm(t,n.document.name),o=ri(n.document.updateTime),c=n.document.createTime?ri(n.document.createTime):lt.min(),u=new Pn({mapValue:{fields:n.document.fields}}),h=un.newFoundDocument(i,o,c,u),d=n.targetIds||[],g=n.removedTargetIds||[];r=new A0(d,g,h.key,h)}else if("documentDelete"in e){e.documentDelete;const n=e.documentDelete;n.document;const i=Gm(t,n.document),o=n.readTime?ri(n.readTime):lt.min(),c=un.newNoDocument(i,o),u=n.removedTargetIds||[];r=new A0([],u,c.key,c)}else if("documentRemove"in e){e.documentRemove;const n=e.documentRemove;n.document;const i=Gm(t,n.document),o=n.removedTargetIds||[];r=new A0([],o,i,null)}else{if(!("filter"in e))return rt(11601,{At:e});{e.filter;const n=e.filter;n.targetId;const{count:i=0,unchangedNames:o}=n,c=new CO(i,o),u=n.targetId;r=new pw(u,c)}}return r}function LO(t,e){let r;if(e instanceof Cf)r={update:$E(t,e.key,e.value)};else if(e instanceof E1)r={delete:Sg(t,e.key)};else if(e instanceof Zs)r={update:$E(t,e.key,e.data),updateMask:KO(e.fieldMask)};else{if(!(e instanceof AO))return rt(16599,{Rt:e.type});r={verify:Sg(t,e.key)}}return e.fieldTransforms.length>0&&(r.updateTransforms=e.fieldTransforms.map(n=>function(o,c){const u=c.transform;if(u instanceof B0)return{fieldPath:c.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(u instanceof of)return{fieldPath:c.field.canonicalString(),appendMissingElements:{values:u.elements}};if(u instanceof lf)return{fieldPath:c.field.canonicalString(),removeAllFromArray:{values:u.elements}};if(u instanceof j0)return{fieldPath:c.field.canonicalString(),increment:u.Ee};throw rt(20930,{transform:c.transform})}(0,n))),e.precondition.isNone||(r.currentDocument=function(i,o){return o.updateTime!==void 0?{updateTime:FO(i,o.updateTime)}:o.exists!==void 0?{exists:o.exists}:rt(27497)}(t,e.precondition)),r}function VO(t,e){return t&&t.length>0?(jt(e!==void 0,14353),t.map(r=>function(i,o){let c=i.updateTime?ri(i.updateTime):ri(o);return c.isEqual(lt.min())&&(c=ri(o)),new yO(c,i.transformResults||[])}(r,e))):[]}function UO(t,e){return{documents:[_w(t,e.path)]}}function BO(t,e){const r={structuredQuery:{}},n=e.path;let i;e.collectionGroup!==null?(i=n,r.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=n.popLast(),r.structuredQuery.from=[{collectionId:n.lastSegment()}]),r.parent=_w(t,i);const o=function(d){if(d.length!==0)return Ew(Na.create(d,"and"))}(e.filters);o&&(r.structuredQuery.where=o);const c=function(d){if(d.length!==0)return d.map(g=>function(x){return{field:Wl(x.field),direction:HO(x.dir)}}(g))}(e.orderBy);c&&(r.structuredQuery.orderBy=c);const u=Ag(t,e.limit);return u!==null&&(r.structuredQuery.limit=u),e.startAt&&(r.structuredQuery.startAt=function(d){return{before:d.inclusive,values:d.position}}(e.startAt)),e.endAt&&(r.structuredQuery.endAt=function(d){return{before:!d.inclusive,values:d.position}}(e.endAt)),{Vt:r,parent:i}}function jO(t){let e=PO(t.parent);const r=t.structuredQuery,n=r.from?r.from.length:0;let i=null;if(n>0){jt(n===1,65062);const g=r.from[0];g.allDescendants?i=g.collectionId:e=e.child(g.collectionId)}let o=[];r.where&&(o=function(_){const x=yw(_);return x instanceof Na&&$A(x)?x.getFilters():[x]}(r.where));let c=[];r.orderBy&&(c=function(_){return _.map(x=>function(S){return new U0(Xl(S.field),function(w){switch(w){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(S.direction))}(x))}(r.orderBy));let u=null;r.limit&&(u=function(_){let x;return x=typeof _=="object"?_.value:_,hd(x)?null:x}(r.limit));let h=null;r.startAt&&(h=function(_){const x=!!_.before,A=_.values||[];return new V0(A,x)}(r.startAt));let d=null;return r.endAt&&(d=function(_){const x=!_.before,A=_.values||[];return new V0(A,x)}(r.endAt)),oO(e,i,c,o,u,"F",h,d)}function zO(t,e){const r=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return rt(28987,{purpose:i})}}(e.purpose);return r==null?null:{"goog-listen-tags":r}}function yw(t){return t.unaryFilter!==void 0?function(r){switch(r.unaryFilter.op){case"IS_NAN":const n=Xl(r.unaryFilter.field);return kr.create(n,"==",{doubleValue:NaN});case"IS_NULL":const i=Xl(r.unaryFilter.field);return kr.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const o=Xl(r.unaryFilter.field);return kr.create(o,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const c=Xl(r.unaryFilter.field);return kr.create(c,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return rt(61313);default:return rt(60726)}}(t):t.fieldFilter!==void 0?function(r){return kr.create(Xl(r.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return rt(58110);default:return rt(50506)}}(r.fieldFilter.op),r.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(r){return Na.create(r.compositeFilter.filters.map(n=>yw(n)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return rt(1026)}}(r.compositeFilter.op))}(t):rt(30097,{filter:t})}function HO(t){return IO[t]}function GO(t){return DO[t]}function qO(t){return OO[t]}function Wl(t){return{fieldPath:t.canonicalString()}}function Xl(t){return Jr.fromServerFormat(t.fieldPath)}function Ew(t){return t instanceof kr?function(r){if(r.op==="=="){if(LE(r.value))return{unaryFilter:{field:Wl(r.field),op:"IS_NAN"}};if(ME(r.value))return{unaryFilter:{field:Wl(r.field),op:"IS_NULL"}}}else if(r.op==="!="){if(LE(r.value))return{unaryFilter:{field:Wl(r.field),op:"IS_NOT_NAN"}};if(ME(r.value))return{unaryFilter:{field:Wl(r.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Wl(r.field),op:GO(r.op),value:r.value}}}(t):t instanceof Na?function(r){const n=r.getFilters().map(i=>Ew(i));return n.length===1?n[0]:{compositeFilter:{op:qO(r.op),filters:n}}}(t):rt(54877,{filter:t})}function KO(t){const e=[];return t.fields.forEach(r=>e.push(r.canonicalString())),{fieldPaths:e}}function Tw(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cs{constructor(e,r,n,i,o=lt.min(),c=lt.min(),u=rn.EMPTY_BYTE_STRING,h=null){this.target=e,this.targetId=r,this.purpose=n,this.sequenceNumber=i,this.snapshotVersion=o,this.lastLimboFreeSnapshotVersion=c,this.resumeToken=u,this.expectedCount=h}withSequenceNumber(e){return new Cs(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,r){return new Cs(this.target,this.targetId,this.purpose,this.sequenceNumber,r,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Cs(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Cs(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WO{constructor(e){this.gt=e}}function XO(t){const e=jO({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?Tg(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YO{constructor(){this.Dn=new $O}addToCollectionParentIndex(e,r){return this.Dn.add(r),be.resolve()}getCollectionParents(e,r){return be.resolve(this.Dn.getEntries(r))}addFieldIndex(e,r){return be.resolve()}deleteFieldIndex(e,r){return be.resolve()}deleteAllFieldIndexes(e){return be.resolve()}createTargetIndexes(e,r){return be.resolve()}getDocumentsMatchingTarget(e,r){return be.resolve(null)}getIndexType(e,r){return be.resolve(0)}getFieldIndexes(e,r){return be.resolve([])}getNextCollectionGroupToUpdate(e){return be.resolve(null)}getMinOffset(e,r){return be.resolve(Us.min())}getMinOffsetFromCollectionGroup(e,r){return be.resolve(Us.min())}updateCollectionGroup(e,r,n){return be.resolve()}updateIndexEntries(e,r){return be.resolve()}}class $O{constructor(){this.index={}}add(e){const r=e.lastSegment(),n=e.popLast(),i=this.index[r]||new Pr(Zt.comparator),o=!i.has(n);return this.index[r]=i.add(n),o}has(e){const r=e.lastSegment(),n=e.popLast(),i=this.index[r];return i&&i.has(n)}getEntries(e){return(this.index[e]||new Pr(Zt.comparator)).toArray()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const QE={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},Aw=41943040;class Nn{static withCacheSize(e){return new Nn(e,Nn.DEFAULT_COLLECTION_PERCENTILE,Nn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,r,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=r,this.maximumSequenceNumbersToCollect=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Nn.DEFAULT_COLLECTION_PERCENTILE=10,Nn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Nn.DEFAULT=new Nn(Aw,Nn.DEFAULT_COLLECTION_PERCENTILE,Nn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Nn.DISABLED=new Nn(-1,0,0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uc{constructor(e){this._r=e}next(){return this._r+=2,this._r}static ar(){return new uc(0)}static ur(){return new uc(-1)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ZE="LruGarbageCollector",QO=1048576;function JE([t,e],[r,n]){const i=mt(t,r);return i===0?mt(e,n):i}class ZO{constructor(e){this.Tr=e,this.buffer=new Pr(JE),this.Ir=0}dr(){return++this.Ir}Er(e){const r=[e,this.dr()];if(this.buffer.size<this.Tr)this.buffer=this.buffer.add(r);else{const n=this.buffer.last();JE(r,n)<0&&(this.buffer=this.buffer.delete(n).add(r))}}get maxValue(){return this.buffer.last()[0]}}class JO{constructor(e,r,n){this.garbageCollector=e,this.asyncQueue=r,this.localStore=n,this.Ar=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Rr(6e4)}stop(){this.Ar&&(this.Ar.cancel(),this.Ar=null)}get started(){return this.Ar!==null}Rr(e){Ge(ZE,`Garbage collection scheduled in ${e}ms`),this.Ar=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Ar=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(r){yc(r)?Ge(ZE,"Ignoring IndexedDB error during garbage collection: ",r):await xc(r)}await this.Rr(3e5)})}}class eN{constructor(e,r){this.Vr=e,this.params=r}calculateTargetCount(e,r){return this.Vr.mr(e).next(n=>Math.floor(r/100*n))}nthSequenceNumber(e,r){if(r===0)return be.resolve(fd.ue);const n=new ZO(r);return this.Vr.forEachTarget(e,i=>n.Er(i.sequenceNumber)).next(()=>this.Vr.gr(e,i=>n.Er(i))).next(()=>n.maxValue)}removeTargets(e,r,n){return this.Vr.removeTargets(e,r,n)}removeOrphanedDocuments(e,r){return this.Vr.removeOrphanedDocuments(e,r)}collect(e,r){return this.params.cacheSizeCollectionThreshold===-1?(Ge("LruGarbageCollector","Garbage collection skipped; disabled"),be.resolve(QE)):this.getCacheSize(e).next(n=>n<this.params.cacheSizeCollectionThreshold?(Ge("LruGarbageCollector",`Garbage collection skipped; Cache size ${n} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),QE):this.pr(e,r))}getCacheSize(e){return this.Vr.getCacheSize(e)}pr(e,r){let n,i,o,c,u,h,d;const g=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(_=>(_>this.params.maximumSequenceNumbersToCollect?(Ge("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${_}`),i=this.params.maximumSequenceNumbersToCollect):i=_,c=Date.now(),this.nthSequenceNumber(e,i))).next(_=>(n=_,u=Date.now(),this.removeTargets(e,n,r))).next(_=>(o=_,h=Date.now(),this.removeOrphanedDocuments(e,n))).next(_=>(d=Date.now(),ql()<=Tt.DEBUG&&Ge("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${c-g}ms
	Determined least recently used ${i} in `+(u-c)+`ms
	Removed ${o} targets in `+(h-u)+`ms
	Removed ${_} documents in `+(d-h)+`ms
Total Duration: ${d-g}ms`),be.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:o,documentsRemoved:_})))}}function tN(t,e){return new eN(t,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rN{constructor(){this.changes=new Xo(e=>e.toString(),(e,r)=>e.isEqual(r)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,r){this.assertNotApplied(),this.changes.set(e,un.newInvalidDocument(e).setReadTime(r))}getEntry(e,r){this.assertNotApplied();const n=this.changes.get(r);return n!==void 0?be.resolve(n):this.getFromCache(e,r)}getEntries(e,r){return this.getAllFromCache(e,r)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nN{constructor(e,r){this.overlayedDocument=e,this.mutatedFields=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aN{constructor(e,r,n,i){this.remoteDocumentCache=e,this.mutationQueue=r,this.documentOverlayCache=n,this.indexManager=i}getDocument(e,r){let n=null;return this.documentOverlayCache.getOverlay(e,r).next(i=>(n=i,this.remoteDocumentCache.getEntry(e,r))).next(i=>(n!==null&&Bu(n.mutation,i,Wn.empty(),tr.now()),i))}getDocuments(e,r){return this.remoteDocumentCache.getEntries(e,r).next(n=>this.getLocalViewOfDocuments(e,n,At()).next(()=>n))}getLocalViewOfDocuments(e,r,n=At()){const i=Oo();return this.populateOverlays(e,i,r).next(()=>this.computeViews(e,r,i,n).next(o=>{let c=ku();return o.forEach((u,h)=>{c=c.insert(u,h.overlayedDocument)}),c}))}getOverlayedDocuments(e,r){const n=Oo();return this.populateOverlays(e,n,r).next(()=>this.computeViews(e,r,n,At()))}populateOverlays(e,r,n){const i=[];return n.forEach(o=>{r.has(o)||i.push(o)}),this.documentOverlayCache.getOverlays(e,i).next(o=>{o.forEach((c,u)=>{r.set(c,u)})})}computeViews(e,r,n,i){let o=ji();const c=Uu(),u=function(){return Uu()}();return r.forEach((h,d)=>{const g=n.get(d.key);i.has(d.key)&&(g===void 0||g.mutation instanceof Zs)?o=o.insert(d.key,d):g!==void 0?(c.set(d.key,g.mutation.getFieldMask()),Bu(g.mutation,d,g.mutation.getFieldMask(),tr.now())):c.set(d.key,Wn.empty())}),this.recalculateAndSaveOverlays(e,o).next(h=>(h.forEach((d,g)=>c.set(d,g)),r.forEach((d,g)=>{var _;return u.set(d,new nN(g,(_=c.get(d))!==null&&_!==void 0?_:null))}),u))}recalculateAndSaveOverlays(e,r){const n=Uu();let i=new or((c,u)=>c-u),o=At();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,r).next(c=>{for(const u of c)u.keys().forEach(h=>{const d=r.get(h);if(d===null)return;let g=n.get(h)||Wn.empty();g=u.applyToLocalView(d,g),n.set(h,g);const _=(i.get(u.batchId)||At()).add(h);i=i.insert(u.batchId,_)})}).next(()=>{const c=[],u=i.getReverseIterator();for(;u.hasNext();){const h=u.getNext(),d=h.key,g=h.value,_=iw();g.forEach(x=>{if(!o.has(x)){const A=fw(r.get(x),n.get(x));A!==null&&_.set(x,A),o=o.add(x)}}),c.push(this.documentOverlayCache.saveOverlays(e,d,_))}return be.waitFor(c)}).next(()=>n)}recalculateAndSaveOverlaysForDocumentKeys(e,r){return this.remoteDocumentCache.getEntries(e,r).next(n=>this.recalculateAndSaveOverlays(e,n))}getDocumentsMatchingQuery(e,r,n,i){return function(c){return $e.isDocumentKey(c.path)&&c.collectionGroup===null&&c.filters.length===0}(r)?this.getDocumentsMatchingDocumentQuery(e,r.path):ew(r)?this.getDocumentsMatchingCollectionGroupQuery(e,r,n,i):this.getDocumentsMatchingCollectionQuery(e,r,n,i)}getNextDocuments(e,r,n,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,r,n,i).next(o=>{const c=i-o.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,r,n.largestBatchId,i-o.size):be.resolve(Oo());let u=rf,h=o;return c.next(d=>be.forEach(d,(g,_)=>(u<_.largestBatchId&&(u=_.largestBatchId),o.get(g)?be.resolve():this.remoteDocumentCache.getEntry(e,g).next(x=>{h=h.insert(g,x)}))).next(()=>this.populateOverlays(e,d,o)).next(()=>this.computeViews(e,h,d,At())).next(g=>({batchId:u,changes:aw(g)})))})}getDocumentsMatchingDocumentQuery(e,r){return this.getDocument(e,new $e(r)).next(n=>{let i=ku();return n.isFoundDocument()&&(i=i.insert(n.key,n)),i})}getDocumentsMatchingCollectionGroupQuery(e,r,n,i){const o=r.collectionGroup;let c=ku();return this.indexManager.getCollectionParents(e,o).next(u=>be.forEach(u,h=>{const d=function(_,x){return new Sf(x,null,_.explicitOrderBy.slice(),_.filters.slice(),_.limit,_.limitType,_.startAt,_.endAt)}(r,h.child(o));return this.getDocumentsMatchingCollectionQuery(e,d,n,i).next(g=>{g.forEach((_,x)=>{c=c.insert(_,x)})})}).next(()=>c))}getDocumentsMatchingCollectionQuery(e,r,n,i){let o;return this.documentOverlayCache.getOverlaysForCollection(e,r.path,n.largestBatchId).next(c=>(o=c,this.remoteDocumentCache.getDocumentsMatchingQuery(e,r,n,o,i))).next(c=>{o.forEach((h,d)=>{const g=d.getKey();c.get(g)===null&&(c=c.insert(g,un.newInvalidDocument(g)))});let u=ku();return c.forEach((h,d)=>{const g=o.get(h);g!==void 0&&Bu(g.mutation,d,Wn.empty(),tr.now()),md(r,d)&&(u=u.insert(h,d))}),u})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iN{constructor(e){this.serializer=e,this.Br=new Map,this.Lr=new Map}getBundleMetadata(e,r){return be.resolve(this.Br.get(r))}saveBundleMetadata(e,r){return this.Br.set(r.id,function(i){return{id:i.id,version:i.version,createTime:ri(i.createTime)}}(r)),be.resolve()}getNamedQuery(e,r){return be.resolve(this.Lr.get(r))}saveNamedQuery(e,r){return this.Lr.set(r.name,function(i){return{name:i.name,query:XO(i.bundledQuery),readTime:ri(i.readTime)}}(r)),be.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sN{constructor(){this.overlays=new or($e.comparator),this.kr=new Map}getOverlay(e,r){return be.resolve(this.overlays.get(r))}getOverlays(e,r){const n=Oo();return be.forEach(r,i=>this.getOverlay(e,i).next(o=>{o!==null&&n.set(i,o)})).next(()=>n)}saveOverlays(e,r,n){return n.forEach((i,o)=>{this.wt(e,r,o)}),be.resolve()}removeOverlaysForBatchId(e,r,n){const i=this.kr.get(n);return i!==void 0&&(i.forEach(o=>this.overlays=this.overlays.remove(o)),this.kr.delete(n)),be.resolve()}getOverlaysForCollection(e,r,n){const i=Oo(),o=r.length+1,c=new $e(r.child("")),u=this.overlays.getIteratorFrom(c);for(;u.hasNext();){const h=u.getNext().value,d=h.getKey();if(!r.isPrefixOf(d.path))break;d.path.length===o&&h.largestBatchId>n&&i.set(h.getKey(),h)}return be.resolve(i)}getOverlaysForCollectionGroup(e,r,n,i){let o=new or((d,g)=>d-g);const c=this.overlays.getIterator();for(;c.hasNext();){const d=c.getNext().value;if(d.getKey().getCollectionGroup()===r&&d.largestBatchId>n){let g=o.get(d.largestBatchId);g===null&&(g=Oo(),o=o.insert(d.largestBatchId,g)),g.set(d.getKey(),d)}}const u=Oo(),h=o.getIterator();for(;h.hasNext()&&(h.getNext().value.forEach((d,g)=>u.set(d,g)),!(u.size()>=i)););return be.resolve(u)}wt(e,r,n){const i=this.overlays.get(n.key);if(i!==null){const c=this.kr.get(i.largestBatchId).delete(n.key);this.kr.set(i.largestBatchId,c)}this.overlays=this.overlays.insert(n.key,new SO(r,n));let o=this.kr.get(r);o===void 0&&(o=At(),this.kr.set(r,o)),this.kr.set(r,o.add(n.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oN{constructor(){this.sessionToken=rn.EMPTY_BYTE_STRING}getSessionToken(e){return be.resolve(this.sessionToken)}setSessionToken(e,r){return this.sessionToken=r,be.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class S1{constructor(){this.qr=new Pr(Hr.Qr),this.$r=new Pr(Hr.Ur)}isEmpty(){return this.qr.isEmpty()}addReference(e,r){const n=new Hr(e,r);this.qr=this.qr.add(n),this.$r=this.$r.add(n)}Kr(e,r){e.forEach(n=>this.addReference(n,r))}removeReference(e,r){this.Wr(new Hr(e,r))}Gr(e,r){e.forEach(n=>this.removeReference(n,r))}zr(e){const r=new $e(new Zt([])),n=new Hr(r,e),i=new Hr(r,e+1),o=[];return this.$r.forEachInRange([n,i],c=>{this.Wr(c),o.push(c.key)}),o}jr(){this.qr.forEach(e=>this.Wr(e))}Wr(e){this.qr=this.qr.delete(e),this.$r=this.$r.delete(e)}Jr(e){const r=new $e(new Zt([])),n=new Hr(r,e),i=new Hr(r,e+1);let o=At();return this.$r.forEachInRange([n,i],c=>{o=o.add(c.key)}),o}containsKey(e){const r=new Hr(e,0),n=this.qr.firstAfterOrEqual(r);return n!==null&&e.isEqual(n.key)}}class Hr{constructor(e,r){this.key=e,this.Hr=r}static Qr(e,r){return $e.comparator(e.key,r.key)||mt(e.Hr,r.Hr)}static Ur(e,r){return mt(e.Hr,r.Hr)||$e.comparator(e.key,r.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lN{constructor(e,r){this.indexManager=e,this.referenceDelegate=r,this.mutationQueue=[],this.er=1,this.Yr=new Pr(Hr.Qr)}checkEmpty(e){return be.resolve(this.mutationQueue.length===0)}addMutationBatch(e,r,n,i){const o=this.er;this.er++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const c=new wO(o,r,n,i);this.mutationQueue.push(c);for(const u of i)this.Yr=this.Yr.add(new Hr(u.key,o)),this.indexManager.addToCollectionParentIndex(e,u.key.path.popLast());return be.resolve(c)}lookupMutationBatch(e,r){return be.resolve(this.Zr(r))}getNextMutationBatchAfterBatchId(e,r){const n=r+1,i=this.Xr(n),o=i<0?0:i;return be.resolve(this.mutationQueue.length>o?this.mutationQueue[o]:null)}getHighestUnacknowledgedBatchId(){return be.resolve(this.mutationQueue.length===0?p1:this.er-1)}getAllMutationBatches(e){return be.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,r){const n=new Hr(r,0),i=new Hr(r,Number.POSITIVE_INFINITY),o=[];return this.Yr.forEachInRange([n,i],c=>{const u=this.Zr(c.Hr);o.push(u)}),be.resolve(o)}getAllMutationBatchesAffectingDocumentKeys(e,r){let n=new Pr(mt);return r.forEach(i=>{const o=new Hr(i,0),c=new Hr(i,Number.POSITIVE_INFINITY);this.Yr.forEachInRange([o,c],u=>{n=n.add(u.Hr)})}),be.resolve(this.ei(n))}getAllMutationBatchesAffectingQuery(e,r){const n=r.path,i=n.length+1;let o=n;$e.isDocumentKey(o)||(o=o.child(""));const c=new Hr(new $e(o),0);let u=new Pr(mt);return this.Yr.forEachWhile(h=>{const d=h.key.path;return!!n.isPrefixOf(d)&&(d.length===i&&(u=u.add(h.Hr)),!0)},c),be.resolve(this.ei(u))}ei(e){const r=[];return e.forEach(n=>{const i=this.Zr(n);i!==null&&r.push(i)}),r}removeMutationBatch(e,r){jt(this.ti(r.batchId,"removed")===0,55003),this.mutationQueue.shift();let n=this.Yr;return be.forEach(r.mutations,i=>{const o=new Hr(i.key,r.batchId);return n=n.delete(o),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.Yr=n})}rr(e){}containsKey(e,r){const n=new Hr(r,0),i=this.Yr.firstAfterOrEqual(n);return be.resolve(r.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,be.resolve()}ti(e,r){return this.Xr(e)}Xr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Zr(e){const r=this.Xr(e);return r<0||r>=this.mutationQueue.length?null:this.mutationQueue[r]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cN{constructor(e){this.ni=e,this.docs=function(){return new or($e.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,r){const n=r.key,i=this.docs.get(n),o=i?i.size:0,c=this.ni(r);return this.docs=this.docs.insert(n,{document:r.mutableCopy(),size:c}),this.size+=c-o,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const r=this.docs.get(e);r&&(this.docs=this.docs.remove(e),this.size-=r.size)}getEntry(e,r){const n=this.docs.get(r);return be.resolve(n?n.document.mutableCopy():un.newInvalidDocument(r))}getEntries(e,r){let n=ji();return r.forEach(i=>{const o=this.docs.get(i);n=n.insert(i,o?o.document.mutableCopy():un.newInvalidDocument(i))}),be.resolve(n)}getDocumentsMatchingQuery(e,r,n,i){let o=ji();const c=r.path,u=new $e(c.child("__id-9223372036854775808__")),h=this.docs.getIteratorFrom(u);for(;h.hasNext();){const{key:d,value:{document:g}}=h.getNext();if(!c.isPrefixOf(d.path))break;d.path.length>c.length+1||UD(VD(g),n)<=0||(i.has(g.key)||md(r,g))&&(o=o.insert(g.key,g.mutableCopy()))}return be.resolve(o)}getAllFromCollectionGroup(e,r,n,i){rt(9500)}ri(e,r){return be.forEach(this.docs,n=>r(n))}newChangeBuffer(e){return new uN(this)}getSize(e){return be.resolve(this.size)}}class uN extends rN{constructor(e){super(),this.Or=e}applyChanges(e){const r=[];return this.changes.forEach((n,i)=>{i.isValidDocument()?r.push(this.Or.addEntry(e,i)):this.Or.removeEntry(n)}),be.waitFor(r)}getFromCache(e,r){return this.Or.getEntry(e,r)}getAllFromCache(e,r){return this.Or.getEntries(e,r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fN{constructor(e){this.persistence=e,this.ii=new Xo(r=>v1(r),_1),this.lastRemoteSnapshotVersion=lt.min(),this.highestTargetId=0,this.si=0,this.oi=new S1,this.targetCount=0,this._i=uc.ar()}forEachTarget(e,r){return this.ii.forEach((n,i)=>r(i)),be.resolve()}getLastRemoteSnapshotVersion(e){return be.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return be.resolve(this.si)}allocateTargetId(e){return this.highestTargetId=this._i.next(),be.resolve(this.highestTargetId)}setTargetsMetadata(e,r,n){return n&&(this.lastRemoteSnapshotVersion=n),r>this.si&&(this.si=r),be.resolve()}hr(e){this.ii.set(e.target,e);const r=e.targetId;r>this.highestTargetId&&(this._i=new uc(r),this.highestTargetId=r),e.sequenceNumber>this.si&&(this.si=e.sequenceNumber)}addTargetData(e,r){return this.hr(r),this.targetCount+=1,be.resolve()}updateTargetData(e,r){return this.hr(r),be.resolve()}removeTargetData(e,r){return this.ii.delete(r.target),this.oi.zr(r.targetId),this.targetCount-=1,be.resolve()}removeTargets(e,r,n){let i=0;const o=[];return this.ii.forEach((c,u)=>{u.sequenceNumber<=r&&n.get(u.targetId)===null&&(this.ii.delete(c),o.push(this.removeMatchingKeysForTargetId(e,u.targetId)),i++)}),be.waitFor(o).next(()=>i)}getTargetCount(e){return be.resolve(this.targetCount)}getTargetData(e,r){const n=this.ii.get(r)||null;return be.resolve(n)}addMatchingKeys(e,r,n){return this.oi.Kr(r,n),be.resolve()}removeMatchingKeys(e,r,n){this.oi.Gr(r,n);const i=this.persistence.referenceDelegate,o=[];return i&&r.forEach(c=>{o.push(i.markPotentiallyOrphaned(e,c))}),be.waitFor(o)}removeMatchingKeysForTargetId(e,r){return this.oi.zr(r),be.resolve()}getMatchingKeysForTargetId(e,r){const n=this.oi.Jr(r);return be.resolve(n)}containsKey(e,r){return be.resolve(this.oi.containsKey(r))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ww{constructor(e,r){this.ai={},this.overlays={},this.ui=new fd(0),this.ci=!1,this.ci=!0,this.li=new oN,this.referenceDelegate=e(this),this.hi=new fN(this),this.indexManager=new YO,this.remoteDocumentCache=function(i){return new cN(i)}(n=>this.referenceDelegate.Pi(n)),this.serializer=new WO(r),this.Ti=new iN(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.ci=!1,Promise.resolve()}get started(){return this.ci}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let r=this.overlays[e.toKey()];return r||(r=new sN,this.overlays[e.toKey()]=r),r}getMutationQueue(e,r){let n=this.ai[e.toKey()];return n||(n=new lN(r,this.referenceDelegate),this.ai[e.toKey()]=n),n}getGlobalsCache(){return this.li}getTargetCache(){return this.hi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ti}runTransaction(e,r,n){Ge("MemoryPersistence","Starting transaction:",e);const i=new hN(this.ui.next());return this.referenceDelegate.Ii(),n(i).next(o=>this.referenceDelegate.di(i).next(()=>o)).toPromise().then(o=>(i.raiseOnCommittedEvent(),o))}Ei(e,r){return be.or(Object.values(this.ai).map(n=>()=>n.containsKey(e,r)))}}class hN extends jD{constructor(e){super(),this.currentSequenceNumber=e}}class C1{constructor(e){this.persistence=e,this.Ai=new S1,this.Ri=null}static Vi(e){return new C1(e)}get mi(){if(this.Ri)return this.Ri;throw rt(60996)}addReference(e,r,n){return this.Ai.addReference(n,r),this.mi.delete(n.toString()),be.resolve()}removeReference(e,r,n){return this.Ai.removeReference(n,r),this.mi.add(n.toString()),be.resolve()}markPotentiallyOrphaned(e,r){return this.mi.add(r.toString()),be.resolve()}removeTarget(e,r){this.Ai.zr(r.targetId).forEach(i=>this.mi.add(i.toString()));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,r.targetId).next(i=>{i.forEach(o=>this.mi.add(o.toString()))}).next(()=>n.removeTargetData(e,r))}Ii(){this.Ri=new Set}di(e){const r=this.persistence.getRemoteDocumentCache().newChangeBuffer();return be.forEach(this.mi,n=>{const i=$e.fromPath(n);return this.fi(e,i).next(o=>{o||r.removeEntry(i,lt.min())})}).next(()=>(this.Ri=null,r.apply(e)))}updateLimboDocument(e,r){return this.fi(e,r).next(n=>{n?this.mi.delete(r.toString()):this.mi.add(r.toString())})}Pi(e){return 0}fi(e,r){return be.or([()=>be.resolve(this.Ai.containsKey(r)),()=>this.persistence.getTargetCache().containsKey(e,r),()=>this.persistence.Ei(e,r)])}}class H0{constructor(e,r){this.persistence=e,this.gi=new Xo(n=>GD(n.path),(n,i)=>n.isEqual(i)),this.garbageCollector=tN(this,r)}static Vi(e,r){return new H0(e,r)}Ii(){}di(e){return be.resolve()}forEachTarget(e,r){return this.persistence.getTargetCache().forEachTarget(e,r)}mr(e){const r=this.yr(e);return this.persistence.getTargetCache().getTargetCount(e).next(n=>r.next(i=>n+i))}yr(e){let r=0;return this.gr(e,n=>{r++}).next(()=>r)}gr(e,r){return be.forEach(this.gi,(n,i)=>this.Sr(e,n,i).next(o=>o?be.resolve():r(i)))}removeTargets(e,r,n){return this.persistence.getTargetCache().removeTargets(e,r,n)}removeOrphanedDocuments(e,r){let n=0;const i=this.persistence.getRemoteDocumentCache(),o=i.newChangeBuffer();return i.ri(e,c=>this.Sr(e,c,r).next(u=>{u||(n++,o.removeEntry(c,lt.min()))})).next(()=>o.apply(e)).next(()=>n)}markPotentiallyOrphaned(e,r){return this.gi.set(r,e.currentSequenceNumber),be.resolve()}removeTarget(e,r){const n=r.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,n)}addReference(e,r,n){return this.gi.set(n,e.currentSequenceNumber),be.resolve()}removeReference(e,r,n){return this.gi.set(n,e.currentSequenceNumber),be.resolve()}updateLimboDocument(e,r){return this.gi.set(r,e.currentSequenceNumber),be.resolve()}Pi(e){let r=e.key.toString().length;return e.isFoundDocument()&&(r+=y0(e.data.value)),r}Sr(e,r,n){return be.or([()=>this.persistence.Ei(e,r),()=>this.persistence.getTargetCache().containsKey(e,r),()=>{const i=this.gi.get(r);return be.resolve(i!==void 0&&i>n)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class R1{constructor(e,r,n,i){this.targetId=e,this.fromCache=r,this.Is=n,this.ds=i}static Es(e,r){let n=At(),i=At();for(const o of r.docChanges)switch(o.type){case 0:n=n.add(o.doc.key);break;case 1:i=i.add(o.doc.key)}return new R1(e,r.fromCache,n,i)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dN{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pN{constructor(){this.As=!1,this.Rs=!1,this.Vs=100,this.fs=function(){return Xk()?8:zD(pn())>0?6:4}()}initialize(e,r){this.gs=e,this.indexManager=r,this.As=!0}getDocumentsMatchingQuery(e,r,n,i){const o={result:null};return this.ps(e,r).next(c=>{o.result=c}).next(()=>{if(!o.result)return this.ys(e,r,i,n).next(c=>{o.result=c})}).next(()=>{if(o.result)return;const c=new dN;return this.ws(e,r,c).next(u=>{if(o.result=u,this.Rs)return this.Ss(e,r,c,u.size)})}).next(()=>o.result)}Ss(e,r,n,i){return n.documentReadCount<this.Vs?(ql()<=Tt.DEBUG&&Ge("QueryEngine","SDK will not create cache indexes for query:",Kl(r),"since it only creates cache indexes for collection contains","more than or equal to",this.Vs,"documents"),be.resolve()):(ql()<=Tt.DEBUG&&Ge("QueryEngine","Query:",Kl(r),"scans",n.documentReadCount,"local documents and returns",i,"documents as results."),n.documentReadCount>this.fs*i?(ql()<=Tt.DEBUG&&Ge("QueryEngine","The SDK decides to create cache indexes for query:",Kl(r),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,ti(r))):be.resolve())}ps(e,r){if(jE(r))return be.resolve(null);let n=ti(r);return this.indexManager.getIndexType(e,n).next(i=>i===0?null:(r.limit!==null&&i===1&&(r=Tg(r,null,"F"),n=ti(r)),this.indexManager.getDocumentsMatchingTarget(e,n).next(o=>{const c=At(...o);return this.gs.getDocuments(e,c).next(u=>this.indexManager.getMinOffset(e,n).next(h=>{const d=this.bs(r,u);return this.Ds(r,d,c,h.readTime)?this.ps(e,Tg(r,null,"F")):this.vs(e,d,r,h)}))})))}ys(e,r,n,i){return jE(r)||i.isEqual(lt.min())?be.resolve(null):this.gs.getDocuments(e,n).next(o=>{const c=this.bs(r,o);return this.Ds(r,c,n,i)?be.resolve(null):(ql()<=Tt.DEBUG&&Ge("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),Kl(r)),this.vs(e,c,r,LD(i,rf)).next(u=>u))})}bs(e,r){let n=new Pr(rw(e));return r.forEach((i,o)=>{md(e,o)&&(n=n.add(o))}),n}Ds(e,r,n,i){if(e.limit===null)return!1;if(n.size!==r.size)return!0;const o=e.limitType==="F"?r.last():r.first();return!!o&&(o.hasPendingWrites||o.version.compareTo(i)>0)}ws(e,r,n){return ql()<=Tt.DEBUG&&Ge("QueryEngine","Using full collection scan to execute query:",Kl(r)),this.gs.getDocumentsMatchingQuery(e,r,Us.min(),n)}vs(e,r,n,i){return this.gs.getDocumentsMatchingQuery(e,n,i).next(o=>(r.forEach(c=>{o=o.insert(c.key,c)}),o))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const k1="LocalStore",mN=3e8;class gN{constructor(e,r,n,i){this.persistence=e,this.Cs=r,this.serializer=i,this.Fs=new or(mt),this.Ms=new Xo(o=>v1(o),_1),this.xs=new Map,this.Os=e.getRemoteDocumentCache(),this.hi=e.getTargetCache(),this.Ti=e.getBundleCache(),this.Ns(n)}Ns(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new aN(this.Os,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Os.setIndexManager(this.indexManager),this.Cs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",r=>e.collect(r,this.Fs))}}function vN(t,e,r,n){return new gN(t,e,r,n)}async function Sw(t,e){const r=ct(t);return await r.persistence.runTransaction("Handle user change","readonly",n=>{let i;return r.mutationQueue.getAllMutationBatches(n).next(o=>(i=o,r.Ns(e),r.mutationQueue.getAllMutationBatches(n))).next(o=>{const c=[],u=[];let h=At();for(const d of i){c.push(d.batchId);for(const g of d.mutations)h=h.add(g.key)}for(const d of o){u.push(d.batchId);for(const g of d.mutations)h=h.add(g.key)}return r.localDocuments.getDocuments(n,h).next(d=>({Bs:d,removedBatchIds:c,addedBatchIds:u}))})})}function _N(t,e){const r=ct(t);return r.persistence.runTransaction("Acknowledge batch","readwrite-primary",n=>{const i=e.batch.keys(),o=r.Os.newChangeBuffer({trackRemovals:!0});return function(u,h,d,g){const _=d.batch,x=_.keys();let A=be.resolve();return x.forEach(S=>{A=A.next(()=>g.getEntry(h,S)).next(R=>{const w=d.docVersions.get(S);jt(w!==null,48541),R.version.compareTo(w)<0&&(_.applyToRemoteDocument(R,d),R.isValidDocument()&&(R.setReadTime(d.commitVersion),g.addEntry(R)))})}),A.next(()=>u.mutationQueue.removeMutationBatch(h,_))}(r,n,e,o).next(()=>o.apply(n)).next(()=>r.mutationQueue.performConsistencyCheck(n)).next(()=>r.documentOverlayCache.removeOverlaysForBatchId(n,i,e.batch.batchId)).next(()=>r.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(n,function(u){let h=At();for(let d=0;d<u.mutationResults.length;++d)u.mutationResults[d].transformResults.length>0&&(h=h.add(u.batch.mutations[d].key));return h}(e))).next(()=>r.localDocuments.getDocuments(n,i))})}function Cw(t){const e=ct(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",r=>e.hi.getLastRemoteSnapshotVersion(r))}function xN(t,e){const r=ct(t),n=e.snapshotVersion;let i=r.Fs;return r.persistence.runTransaction("Apply remote event","readwrite-primary",o=>{const c=r.Os.newChangeBuffer({trackRemovals:!0});i=r.Fs;const u=[];e.targetChanges.forEach((g,_)=>{const x=i.get(_);if(!x)return;u.push(r.hi.removeMatchingKeys(o,g.removedDocuments,_).next(()=>r.hi.addMatchingKeys(o,g.addedDocuments,_)));let A=x.withSequenceNumber(o.currentSequenceNumber);e.targetMismatches.get(_)!==null?A=A.withResumeToken(rn.EMPTY_BYTE_STRING,lt.min()).withLastLimboFreeSnapshotVersion(lt.min()):g.resumeToken.approximateByteSize()>0&&(A=A.withResumeToken(g.resumeToken,n)),i=i.insert(_,A),function(R,w,B){return R.resumeToken.approximateByteSize()===0||w.snapshotVersion.toMicroseconds()-R.snapshotVersion.toMicroseconds()>=mN?!0:B.addedDocuments.size+B.modifiedDocuments.size+B.removedDocuments.size>0}(x,A,g)&&u.push(r.hi.updateTargetData(o,A))});let h=ji(),d=At();if(e.documentUpdates.forEach(g=>{e.resolvedLimboDocuments.has(g)&&u.push(r.persistence.referenceDelegate.updateLimboDocument(o,g))}),u.push(yN(o,c,e.documentUpdates).next(g=>{h=g.Ls,d=g.ks})),!n.isEqual(lt.min())){const g=r.hi.getLastRemoteSnapshotVersion(o).next(_=>r.hi.setTargetsMetadata(o,o.currentSequenceNumber,n));u.push(g)}return be.waitFor(u).next(()=>c.apply(o)).next(()=>r.localDocuments.getLocalViewOfDocuments(o,h,d)).next(()=>h)}).then(o=>(r.Fs=i,o))}function yN(t,e,r){let n=At(),i=At();return r.forEach(o=>n=n.add(o)),e.getEntries(t,n).next(o=>{let c=ji();return r.forEach((u,h)=>{const d=o.get(u);h.isFoundDocument()!==d.isFoundDocument()&&(i=i.add(u)),h.isNoDocument()&&h.version.isEqual(lt.min())?(e.removeEntry(u,h.readTime),c=c.insert(u,h)):!d.isValidDocument()||h.version.compareTo(d.version)>0||h.version.compareTo(d.version)===0&&d.hasPendingWrites?(e.addEntry(h),c=c.insert(u,h)):Ge(k1,"Ignoring outdated watch update for ",u,". Current version:",d.version," Watch version:",h.version)}),{Ls:c,ks:i}})}function EN(t,e){const r=ct(t);return r.persistence.runTransaction("Get next mutation batch","readonly",n=>(e===void 0&&(e=p1),r.mutationQueue.getNextMutationBatchAfterBatchId(n,e)))}function TN(t,e){const r=ct(t);return r.persistence.runTransaction("Allocate target","readwrite",n=>{let i;return r.hi.getTargetData(n,e).next(o=>o?(i=o,be.resolve(i)):r.hi.allocateTargetId(n).next(c=>(i=new Cs(e,c,"TargetPurposeListen",n.currentSequenceNumber),r.hi.addTargetData(n,i).next(()=>i))))}).then(n=>{const i=r.Fs.get(n.targetId);return(i===null||n.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(r.Fs=r.Fs.insert(n.targetId,n),r.Ms.set(e,n.targetId)),n})}async function Rg(t,e,r){const n=ct(t),i=n.Fs.get(e),o=r?"readwrite":"readwrite-primary";try{r||await n.persistence.runTransaction("Release target",o,c=>n.persistence.referenceDelegate.removeTarget(c,i))}catch(c){if(!yc(c))throw c;Ge(k1,`Failed to update sequence numbers for target ${e}: ${c}`)}n.Fs=n.Fs.remove(e),n.Ms.delete(i.target)}function eT(t,e,r){const n=ct(t);let i=lt.min(),o=At();return n.persistence.runTransaction("Execute query","readwrite",c=>function(h,d,g){const _=ct(h),x=_.Ms.get(g);return x!==void 0?be.resolve(_.Fs.get(x)):_.hi.getTargetData(d,g)}(n,c,ti(e)).next(u=>{if(u)return i=u.lastLimboFreeSnapshotVersion,n.hi.getMatchingKeysForTargetId(c,u.targetId).next(h=>{o=h})}).next(()=>n.Cs.getDocumentsMatchingQuery(c,e,r?i:lt.min(),r?o:At())).next(u=>(AN(n,cO(e),u),{documents:u,qs:o})))}function AN(t,e,r){let n=t.xs.get(e)||lt.min();r.forEach((i,o)=>{o.readTime.compareTo(n)>0&&(n=o.readTime)}),t.xs.set(e,n)}class tT{constructor(){this.activeTargetIds=mO()}Gs(e){this.activeTargetIds=this.activeTargetIds.add(e)}zs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Ws(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class wN{constructor(){this.Fo=new tT,this.Mo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,r,n){}addLocalQueryTarget(e,r=!0){return r&&this.Fo.Gs(e),this.Mo[e]||"not-current"}updateQueryState(e,r,n){this.Mo[e]=r}removeLocalQueryTarget(e){this.Fo.zs(e)}isLocalQueryTarget(e){return this.Fo.activeTargetIds.has(e)}clearQueryState(e){delete this.Mo[e]}getAllActiveQueryTargets(){return this.Fo.activeTargetIds}isActiveQueryTarget(e){return this.Fo.activeTargetIds.has(e)}start(){return this.Fo=new tT,Promise.resolve()}handleUserChange(e,r,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SN{xo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rT="ConnectivityMonitor";class nT{constructor(){this.Oo=()=>this.No(),this.Bo=()=>this.Lo(),this.ko=[],this.qo()}xo(e){this.ko.push(e)}shutdown(){window.removeEventListener("online",this.Oo),window.removeEventListener("offline",this.Bo)}qo(){window.addEventListener("online",this.Oo),window.addEventListener("offline",this.Bo)}No(){Ge(rT,"Network connectivity changed: AVAILABLE");for(const e of this.ko)e(0)}Lo(){Ge(rT,"Network connectivity changed: UNAVAILABLE");for(const e of this.ko)e(1)}static C(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let a0=null;function kg(){return a0===null?a0=function(){return 268435456+Math.round(2147483648*Math.random())}():a0++,"0x"+a0.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qm="RestConnection",CN={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class RN{get Qo(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const r=e.ssl?"https":"http",n=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.$o=r+"://"+e.host,this.Uo=`projects/${n}/databases/${i}`,this.Ko=this.databaseId.database===M0?`project_id=${n}`:`project_id=${n}&database_id=${i}`}Wo(e,r,n,i,o){const c=kg(),u=this.Go(e,r.toUriEncodedString());Ge(qm,`Sending RPC '${e}' ${c}:`,u,n);const h={"google-cloud-resource-prefix":this.Uo,"x-goog-request-params":this.Ko};this.zo(h,i,o);const{host:d}=new URL(u),g=mc(d);return this.jo(e,u,h,n,g).then(_=>(Ge(qm,`Received RPC '${e}' ${c}: `,_),_),_=>{throw Vs(qm,`RPC '${e}' ${c} failed with error: `,_,"url: ",u,"request:",n),_})}Jo(e,r,n,i,o,c){return this.Wo(e,r,n,i,o)}zo(e,r,n){e["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+_c}(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((i,o)=>e[o]=i),n&&n.headers.forEach((i,o)=>e[o]=i)}Go(e,r){const n=CN[e];return`${this.$o}/v1/${r}:${n}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kN{constructor(e){this.Ho=e.Ho,this.Yo=e.Yo}Zo(e){this.Xo=e}e_(e){this.t_=e}n_(e){this.r_=e}onMessage(e){this.i_=e}close(){this.Yo()}send(e){this.Ho(e)}s_(){this.Xo()}o_(){this.t_()}__(e){this.r_(e)}a_(e){this.i_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sn="WebChannelConnection";class bN extends RN{constructor(e){super(e),this.u_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}jo(e,r,n,i,o){const c=kg();return new Promise((u,h)=>{const d=new kA;d.setWithCredentials(!0),d.listenOnce(bA.COMPLETE,()=>{try{switch(d.getLastErrorCode()){case x0.NO_ERROR:const _=d.getResponseJson();Ge(sn,`XHR for RPC '${e}' ${c} received:`,JSON.stringify(_)),u(_);break;case x0.TIMEOUT:Ge(sn,`RPC '${e}' ${c} timed out`),h(new He(Re.DEADLINE_EXCEEDED,"Request time out"));break;case x0.HTTP_ERROR:const x=d.getStatus();if(Ge(sn,`RPC '${e}' ${c} failed with status:`,x,"response text:",d.getResponseText()),x>0){let A=d.getResponseJson();Array.isArray(A)&&(A=A[0]);const S=A?.error;if(S&&S.status&&S.message){const R=function(B){const H=B.toLowerCase().replace(/_/g,"-");return Object.values(Re).indexOf(H)>=0?H:Re.UNKNOWN}(S.status);h(new He(R,S.message))}else h(new He(Re.UNKNOWN,"Server responded with status "+d.getStatus()))}else h(new He(Re.UNAVAILABLE,"Connection failed."));break;default:rt(9055,{c_:e,streamId:c,l_:d.getLastErrorCode(),h_:d.getLastError()})}}finally{Ge(sn,`RPC '${e}' ${c} completed.`)}});const g=JSON.stringify(i);Ge(sn,`RPC '${e}' ${c} sending request:`,i),d.send(r,"POST",g,n,15)})}P_(e,r,n){const i=kg(),o=[this.$o,"/","google.firestore.v1.Firestore","/",e,"/channel"],c=OA(),u=DA(),h={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},d=this.longPollingOptions.timeoutSeconds;d!==void 0&&(h.longPollingTimeout=Math.round(1e3*d)),this.useFetchStreams&&(h.useFetchStreams=!0),this.zo(h.initMessageHeaders,r,n),h.encodeInitMessageHeaders=!0;const g=o.join("");Ge(sn,`Creating RPC '${e}' stream ${i}: ${g}`,h);const _=c.createWebChannel(g,h);this.T_(_);let x=!1,A=!1;const S=new kN({Ho:w=>{A?Ge(sn,`Not sending because RPC '${e}' stream ${i} is closed:`,w):(x||(Ge(sn,`Opening RPC '${e}' stream ${i} transport.`),_.open(),x=!0),Ge(sn,`RPC '${e}' stream ${i} sending:`,w),_.send(w))},Yo:()=>_.close()}),R=(w,B,H)=>{w.listen(B,N=>{try{H(N)}catch(J){setTimeout(()=>{throw J},0)}})};return R(_,Ru.EventType.OPEN,()=>{A||(Ge(sn,`RPC '${e}' stream ${i} transport opened.`),S.s_())}),R(_,Ru.EventType.CLOSE,()=>{A||(A=!0,Ge(sn,`RPC '${e}' stream ${i} transport closed`),S.__(),this.I_(_))}),R(_,Ru.EventType.ERROR,w=>{A||(A=!0,Vs(sn,`RPC '${e}' stream ${i} transport errored. Name:`,w.name,"Message:",w.message),S.__(new He(Re.UNAVAILABLE,"The operation could not be completed")))}),R(_,Ru.EventType.MESSAGE,w=>{var B;if(!A){const H=w.data[0];jt(!!H,16349);const N=H,J=N?.error||((B=N[0])===null||B===void 0?void 0:B.error);if(J){Ge(sn,`RPC '${e}' stream ${i} received error:`,J);const re=J.status;let ne=function(E){const D=Sr[E];if(D!==void 0)return dw(D)}(re),C=J.message;ne===void 0&&(ne=Re.INTERNAL,C="Unknown error status: "+re+" with message "+J.message),A=!0,S.__(new He(ne,C)),_.close()}else Ge(sn,`RPC '${e}' stream ${i} received:`,H),S.a_(H)}}),R(u,IA.STAT_EVENT,w=>{w.stat===mg.PROXY?Ge(sn,`RPC '${e}' stream ${i} detected buffering proxy`):w.stat===mg.NOPROXY&&Ge(sn,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{S.o_()},0),S}terminate(){this.u_.forEach(e=>e.close()),this.u_=[]}T_(e){this.u_.push(e)}I_(e){this.u_=this.u_.filter(r=>r===e)}}function Km(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xd(t){return new NO(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rw{constructor(e,r,n=1e3,i=1.5,o=6e4){this.Fi=e,this.timerId=r,this.d_=n,this.E_=i,this.A_=o,this.R_=0,this.V_=null,this.m_=Date.now(),this.reset()}reset(){this.R_=0}f_(){this.R_=this.A_}g_(e){this.cancel();const r=Math.floor(this.R_+this.p_()),n=Math.max(0,Date.now()-this.m_),i=Math.max(0,r-n);i>0&&Ge("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.R_} ms, delay with jitter: ${r} ms, last attempt: ${n} ms ago)`),this.V_=this.Fi.enqueueAfterDelay(this.timerId,i,()=>(this.m_=Date.now(),e())),this.R_*=this.E_,this.R_<this.d_&&(this.R_=this.d_),this.R_>this.A_&&(this.R_=this.A_)}y_(){this.V_!==null&&(this.V_.skipDelay(),this.V_=null)}cancel(){this.V_!==null&&(this.V_.cancel(),this.V_=null)}p_(){return(Math.random()-.5)*this.R_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aT="PersistentStream";class kw{constructor(e,r,n,i,o,c,u,h){this.Fi=e,this.w_=n,this.S_=i,this.connection=o,this.authCredentialsProvider=c,this.appCheckCredentialsProvider=u,this.listener=h,this.state=0,this.b_=0,this.D_=null,this.v_=null,this.stream=null,this.C_=0,this.F_=new Rw(e,r)}M_(){return this.state===1||this.state===5||this.x_()}x_(){return this.state===2||this.state===3}start(){this.C_=0,this.state!==4?this.auth():this.O_()}async stop(){this.M_()&&await this.close(0)}N_(){this.state=0,this.F_.reset()}B_(){this.x_()&&this.D_===null&&(this.D_=this.Fi.enqueueAfterDelay(this.w_,6e4,()=>this.L_()))}k_(e){this.q_(),this.stream.send(e)}async L_(){if(this.x_())return this.close(0)}q_(){this.D_&&(this.D_.cancel(),this.D_=null)}Q_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,r){this.q_(),this.Q_(),this.F_.cancel(),this.b_++,e!==4?this.F_.reset():r&&r.code===Re.RESOURCE_EXHAUSTED?(Bi(r.toString()),Bi("Using maximum backoff delay to prevent overloading the backend."),this.F_.f_()):r&&r.code===Re.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.U_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.n_(r)}U_(){}auth(){this.state=1;const e=this.K_(this.b_),r=this.b_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([n,i])=>{this.b_===r&&this.W_(n,i)},n=>{e(()=>{const i=new He(Re.UNKNOWN,"Fetching auth token failed: "+n.message);return this.G_(i)})})}W_(e,r){const n=this.K_(this.b_);this.stream=this.z_(e,r),this.stream.Zo(()=>{n(()=>this.listener.Zo())}),this.stream.e_(()=>{n(()=>(this.state=2,this.v_=this.Fi.enqueueAfterDelay(this.S_,1e4,()=>(this.x_()&&(this.state=3),Promise.resolve())),this.listener.e_()))}),this.stream.n_(i=>{n(()=>this.G_(i))}),this.stream.onMessage(i=>{n(()=>++this.C_==1?this.j_(i):this.onNext(i))})}O_(){this.state=5,this.F_.g_(async()=>{this.state=0,this.start()})}G_(e){return Ge(aT,`close with error: ${e}`),this.stream=null,this.close(4,e)}K_(e){return r=>{this.Fi.enqueueAndForget(()=>this.b_===e?r():(Ge(aT,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class IN extends kw{constructor(e,r,n,i,o,c){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",r,n,i,c),this.serializer=o}z_(e,r){return this.connection.P_("Listen",e,r)}j_(e){return this.onNext(e)}onNext(e){this.F_.reset();const r=MO(this.serializer,e),n=function(o){if(!("targetChange"in o))return lt.min();const c=o.targetChange;return c.targetIds&&c.targetIds.length?lt.min():c.readTime?ri(c.readTime):lt.min()}(e);return this.listener.J_(r,n)}H_(e){const r={};r.database=Cg(this.serializer),r.addTarget=function(o,c){let u;const h=c.target;if(u=yg(h)?{documents:UO(o,h)}:{query:BO(o,h).Vt},u.targetId=c.targetId,c.resumeToken.approximateByteSize()>0){u.resumeToken=gw(o,c.resumeToken);const d=Ag(o,c.expectedCount);d!==null&&(u.expectedCount=d)}else if(c.snapshotVersion.compareTo(lt.min())>0){u.readTime=z0(o,c.snapshotVersion.toTimestamp());const d=Ag(o,c.expectedCount);d!==null&&(u.expectedCount=d)}return u}(this.serializer,e);const n=zO(this.serializer,e);n&&(r.labels=n),this.k_(r)}Y_(e){const r={};r.database=Cg(this.serializer),r.removeTarget=e,this.k_(r)}}class DN extends kw{constructor(e,r,n,i,o,c){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",r,n,i,c),this.serializer=o}get Z_(){return this.C_>0}start(){this.lastStreamToken=void 0,super.start()}U_(){this.Z_&&this.X_([])}z_(e,r){return this.connection.P_("Write",e,r)}j_(e){return jt(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,jt(!e.writeResults||e.writeResults.length===0,55816),this.listener.ea()}onNext(e){jt(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.F_.reset();const r=VO(e.writeResults,e.commitTime),n=ri(e.commitTime);return this.listener.ta(n,r)}na(){const e={};e.database=Cg(this.serializer),this.k_(e)}X_(e){const r={streamToken:this.lastStreamToken,writes:e.map(n=>LO(this.serializer,n))};this.k_(r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ON{}class NN extends ON{constructor(e,r,n,i){super(),this.authCredentials=e,this.appCheckCredentials=r,this.connection=n,this.serializer=i,this.ra=!1}ia(){if(this.ra)throw new He(Re.FAILED_PRECONDITION,"The client has already been terminated.")}Wo(e,r,n,i){return this.ia(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,c])=>this.connection.Wo(e,wg(r,n),i,o,c)).catch(o=>{throw o.name==="FirebaseError"?(o.code===Re.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new He(Re.UNKNOWN,o.toString())})}Jo(e,r,n,i,o){return this.ia(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([c,u])=>this.connection.Jo(e,wg(r,n),i,c,u,o)).catch(c=>{throw c.name==="FirebaseError"?(c.code===Re.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),c):new He(Re.UNKNOWN,c.toString())})}terminate(){this.ra=!0,this.connection.terminate()}}class FN{constructor(e,r){this.asyncQueue=e,this.onlineStateHandler=r,this.state="Unknown",this.sa=0,this.oa=null,this._a=!0}aa(){this.sa===0&&(this.ua("Unknown"),this.oa=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.oa=null,this.ca("Backend didn't respond within 10 seconds."),this.ua("Offline"),Promise.resolve())))}la(e){this.state==="Online"?this.ua("Unknown"):(this.sa++,this.sa>=1&&(this.ha(),this.ca(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ua("Offline")))}set(e){this.ha(),this.sa=0,e==="Online"&&(this._a=!1),this.ua(e)}ua(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}ca(e){const r=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this._a?(Bi(r),this._a=!1):Ge("OnlineStateTracker",r)}ha(){this.oa!==null&&(this.oa.cancel(),this.oa=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jo="RemoteStore";class PN{constructor(e,r,n,i,o){this.localStore=e,this.datastore=r,this.asyncQueue=n,this.remoteSyncer={},this.Pa=[],this.Ta=new Map,this.Ia=new Set,this.da=[],this.Ea=o,this.Ea.xo(c=>{n.enqueueAndForget(async()=>{Yo(this)&&(Ge(jo,"Restarting streams for network reachability change."),await async function(h){const d=ct(h);d.Ia.add(4),await kf(d),d.Aa.set("Unknown"),d.Ia.delete(4),await yd(d)}(this))})}),this.Aa=new FN(n,i)}}async function yd(t){if(Yo(t))for(const e of t.da)await e(!0)}async function kf(t){for(const e of t.da)await e(!1)}function bw(t,e){const r=ct(t);r.Ta.has(e.targetId)||(r.Ta.set(e.targetId,e),O1(r)?D1(r):Ec(r).x_()&&I1(r,e))}function b1(t,e){const r=ct(t),n=Ec(r);r.Ta.delete(e),n.x_()&&Iw(r,e),r.Ta.size===0&&(n.x_()?n.B_():Yo(r)&&r.Aa.set("Unknown"))}function I1(t,e){if(t.Ra.$e(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(lt.min())>0){const r=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(r)}Ec(t).H_(e)}function Iw(t,e){t.Ra.$e(e),Ec(t).Y_(e)}function D1(t){t.Ra=new bO({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),Et:e=>t.Ta.get(e)||null,lt:()=>t.datastore.serializer.databaseId}),Ec(t).start(),t.Aa.aa()}function O1(t){return Yo(t)&&!Ec(t).M_()&&t.Ta.size>0}function Yo(t){return ct(t).Ia.size===0}function Dw(t){t.Ra=void 0}async function MN(t){t.Aa.set("Online")}async function LN(t){t.Ta.forEach((e,r)=>{I1(t,e)})}async function VN(t,e){Dw(t),O1(t)?(t.Aa.la(e),D1(t)):t.Aa.set("Unknown")}async function UN(t,e,r){if(t.Aa.set("Online"),e instanceof mw&&e.state===2&&e.cause)try{await async function(i,o){const c=o.cause;for(const u of o.targetIds)i.Ta.has(u)&&(await i.remoteSyncer.rejectListen(u,c),i.Ta.delete(u),i.Ra.removeTarget(u))}(t,e)}catch(n){Ge(jo,"Failed to remove targets %s: %s ",e.targetIds.join(","),n),await G0(t,n)}else if(e instanceof A0?t.Ra.Ye(e):e instanceof pw?t.Ra.it(e):t.Ra.et(e),!r.isEqual(lt.min()))try{const n=await Cw(t.localStore);r.compareTo(n)>=0&&await function(o,c){const u=o.Ra.Pt(c);return u.targetChanges.forEach((h,d)=>{if(h.resumeToken.approximateByteSize()>0){const g=o.Ta.get(d);g&&o.Ta.set(d,g.withResumeToken(h.resumeToken,c))}}),u.targetMismatches.forEach((h,d)=>{const g=o.Ta.get(h);if(!g)return;o.Ta.set(h,g.withResumeToken(rn.EMPTY_BYTE_STRING,g.snapshotVersion)),Iw(o,h);const _=new Cs(g.target,h,d,g.sequenceNumber);I1(o,_)}),o.remoteSyncer.applyRemoteEvent(u)}(t,r)}catch(n){Ge(jo,"Failed to raise snapshot:",n),await G0(t,n)}}async function G0(t,e,r){if(!yc(e))throw e;t.Ia.add(1),await kf(t),t.Aa.set("Offline"),r||(r=()=>Cw(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{Ge(jo,"Retrying IndexedDB access"),await r(),t.Ia.delete(1),await yd(t)})}function Ow(t,e){return e().catch(r=>G0(t,r,e))}async function Ed(t){const e=ct(t),r=Hs(e);let n=e.Pa.length>0?e.Pa[e.Pa.length-1].batchId:p1;for(;BN(e);)try{const i=await EN(e.localStore,n);if(i===null){e.Pa.length===0&&r.B_();break}n=i.batchId,jN(e,i)}catch(i){await G0(e,i)}Nw(e)&&Fw(e)}function BN(t){return Yo(t)&&t.Pa.length<10}function jN(t,e){t.Pa.push(e);const r=Hs(t);r.x_()&&r.Z_&&r.X_(e.mutations)}function Nw(t){return Yo(t)&&!Hs(t).M_()&&t.Pa.length>0}function Fw(t){Hs(t).start()}async function zN(t){Hs(t).na()}async function HN(t){const e=Hs(t);for(const r of t.Pa)e.X_(r.mutations)}async function GN(t,e,r){const n=t.Pa.shift(),i=T1.from(n,e,r);await Ow(t,()=>t.remoteSyncer.applySuccessfulWrite(i)),await Ed(t)}async function qN(t,e){e&&Hs(t).Z_&&await async function(n,i){if(function(c){return RO(c)&&c!==Re.ABORTED}(i.code)){const o=n.Pa.shift();Hs(n).N_(),await Ow(n,()=>n.remoteSyncer.rejectFailedWrite(o.batchId,i)),await Ed(n)}}(t,e),Nw(t)&&Fw(t)}async function iT(t,e){const r=ct(t);r.asyncQueue.verifyOperationInProgress(),Ge(jo,"RemoteStore received new credentials");const n=Yo(r);r.Ia.add(3),await kf(r),n&&r.Aa.set("Unknown"),await r.remoteSyncer.handleCredentialChange(e),r.Ia.delete(3),await yd(r)}async function KN(t,e){const r=ct(t);e?(r.Ia.delete(2),await yd(r)):e||(r.Ia.add(2),await kf(r),r.Aa.set("Unknown"))}function Ec(t){return t.Va||(t.Va=function(r,n,i){const o=ct(r);return o.ia(),new IN(n,o.connection,o.authCredentials,o.appCheckCredentials,o.serializer,i)}(t.datastore,t.asyncQueue,{Zo:MN.bind(null,t),e_:LN.bind(null,t),n_:VN.bind(null,t),J_:UN.bind(null,t)}),t.da.push(async e=>{e?(t.Va.N_(),O1(t)?D1(t):t.Aa.set("Unknown")):(await t.Va.stop(),Dw(t))})),t.Va}function Hs(t){return t.ma||(t.ma=function(r,n,i){const o=ct(r);return o.ia(),new DN(n,o.connection,o.authCredentials,o.appCheckCredentials,o.serializer,i)}(t.datastore,t.asyncQueue,{Zo:()=>Promise.resolve(),e_:zN.bind(null,t),n_:qN.bind(null,t),ea:HN.bind(null,t),ta:GN.bind(null,t)}),t.da.push(async e=>{e?(t.ma.N_(),await Ed(t)):(await t.ma.stop(),t.Pa.length>0&&(Ge(jo,`Stopping write stream with ${t.Pa.length} pending writes`),t.Pa=[]))})),t.ma}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class N1{constructor(e,r,n,i,o){this.asyncQueue=e,this.timerId=r,this.targetTimeMs=n,this.op=i,this.removalCallback=o,this.deferred=new Ni,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(c=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,r,n,i,o){const c=Date.now()+n,u=new N1(e,r,c,i,o);return u.start(n),u}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new He(Re.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function F1(t,e){if(Bi("AsyncQueue",`${e}: ${t}`),yc(t))return new He(Re.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ec{static emptySet(e){return new ec(e.comparator)}constructor(e){this.comparator=e?(r,n)=>e(r,n)||$e.comparator(r.key,n.key):(r,n)=>$e.comparator(r.key,n.key),this.keyedMap=ku(),this.sortedSet=new or(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const r=this.keyedMap.get(e);return r?this.sortedSet.indexOf(r):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((r,n)=>(e(r),!1))}add(e){const r=this.delete(e.key);return r.copy(r.keyedMap.insert(e.key,e),r.sortedSet.insert(e,null))}delete(e){const r=this.get(e);return r?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(r)):this}isEqual(e){if(!(e instanceof ec)||this.size!==e.size)return!1;const r=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;r.hasNext();){const i=r.getNext().key,o=n.getNext().key;if(!i.isEqual(o))return!1}return!0}toString(){const e=[];return this.forEach(r=>{e.push(r.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,r){const n=new ec;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=r,n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sT{constructor(){this.fa=new or($e.comparator)}track(e){const r=e.doc.key,n=this.fa.get(r);n?e.type!==0&&n.type===3?this.fa=this.fa.insert(r,e):e.type===3&&n.type!==1?this.fa=this.fa.insert(r,{type:n.type,doc:e.doc}):e.type===2&&n.type===2?this.fa=this.fa.insert(r,{type:2,doc:e.doc}):e.type===2&&n.type===0?this.fa=this.fa.insert(r,{type:0,doc:e.doc}):e.type===1&&n.type===0?this.fa=this.fa.remove(r):e.type===1&&n.type===2?this.fa=this.fa.insert(r,{type:1,doc:n.doc}):e.type===0&&n.type===1?this.fa=this.fa.insert(r,{type:2,doc:e.doc}):rt(63341,{At:e,ga:n}):this.fa=this.fa.insert(r,e)}pa(){const e=[];return this.fa.inorderTraversal((r,n)=>{e.push(n)}),e}}class fc{constructor(e,r,n,i,o,c,u,h,d){this.query=e,this.docs=r,this.oldDocs=n,this.docChanges=i,this.mutatedKeys=o,this.fromCache=c,this.syncStateChanged=u,this.excludesMetadataChanges=h,this.hasCachedResults=d}static fromInitialDocuments(e,r,n,i,o){const c=[];return r.forEach(u=>{c.push({type:0,doc:u})}),new fc(e,r,ec.emptySet(r),c,n,i,!0,!1,o)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&pd(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const r=this.docChanges,n=e.docChanges;if(r.length!==n.length)return!1;for(let i=0;i<r.length;i++)if(r[i].type!==n[i].type||!r[i].doc.isEqual(n[i].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WN{constructor(){this.ya=void 0,this.wa=[]}Sa(){return this.wa.some(e=>e.ba())}}class XN{constructor(){this.queries=oT(),this.onlineState="Unknown",this.Da=new Set}terminate(){(function(r,n){const i=ct(r),o=i.queries;i.queries=oT(),o.forEach((c,u)=>{for(const h of u.wa)h.onError(n)})})(this,new He(Re.ABORTED,"Firestore shutting down"))}}function oT(){return new Xo(t=>tw(t),pd)}async function Pw(t,e){const r=ct(t);let n=3;const i=e.query;let o=r.queries.get(i);o?!o.Sa()&&e.ba()&&(n=2):(o=new WN,n=e.ba()?0:1);try{switch(n){case 0:o.ya=await r.onListen(i,!0);break;case 1:o.ya=await r.onListen(i,!1);break;case 2:await r.onFirstRemoteStoreListen(i)}}catch(c){const u=F1(c,`Initialization of query '${Kl(e.query)}' failed`);return void e.onError(u)}r.queries.set(i,o),o.wa.push(e),e.va(r.onlineState),o.ya&&e.Ca(o.ya)&&P1(r)}async function Mw(t,e){const r=ct(t),n=e.query;let i=3;const o=r.queries.get(n);if(o){const c=o.wa.indexOf(e);c>=0&&(o.wa.splice(c,1),o.wa.length===0?i=e.ba()?0:1:!o.Sa()&&e.ba()&&(i=2))}switch(i){case 0:return r.queries.delete(n),r.onUnlisten(n,!0);case 1:return r.queries.delete(n),r.onUnlisten(n,!1);case 2:return r.onLastRemoteStoreUnlisten(n);default:return}}function YN(t,e){const r=ct(t);let n=!1;for(const i of e){const o=i.query,c=r.queries.get(o);if(c){for(const u of c.wa)u.Ca(i)&&(n=!0);c.ya=i}}n&&P1(r)}function $N(t,e,r){const n=ct(t),i=n.queries.get(e);if(i)for(const o of i.wa)o.onError(r);n.queries.delete(e)}function P1(t){t.Da.forEach(e=>{e.next()})}var bg,lT;(lT=bg||(bg={})).Fa="default",lT.Cache="cache";class Lw{constructor(e,r,n){this.query=e,this.Ma=r,this.xa=!1,this.Oa=null,this.onlineState="Unknown",this.options=n||{}}Ca(e){if(!this.options.includeMetadataChanges){const n=[];for(const i of e.docChanges)i.type!==3&&n.push(i);e=new fc(e.query,e.docs,e.oldDocs,n,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let r=!1;return this.xa?this.Na(e)&&(this.Ma.next(e),r=!0):this.Ba(e,this.onlineState)&&(this.La(e),r=!0),this.Oa=e,r}onError(e){this.Ma.error(e)}va(e){this.onlineState=e;let r=!1;return this.Oa&&!this.xa&&this.Ba(this.Oa,e)&&(this.La(this.Oa),r=!0),r}Ba(e,r){if(!e.fromCache||!this.ba())return!0;const n=r!=="Offline";return(!this.options.ka||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||r==="Offline")}Na(e){if(e.docChanges.length>0)return!0;const r=this.Oa&&this.Oa.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!r)&&this.options.includeMetadataChanges===!0}La(e){e=fc.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.xa=!0,this.Ma.next(e)}ba(){return this.options.source!==bg.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vw{constructor(e){this.key=e}}class Uw{constructor(e){this.key=e}}class QN{constructor(e,r){this.query=e,this.Ha=r,this.Ya=null,this.hasCachedResults=!1,this.current=!1,this.Za=At(),this.mutatedKeys=At(),this.Xa=rw(e),this.eu=new ec(this.Xa)}get tu(){return this.Ha}nu(e,r){const n=r?r.ru:new sT,i=r?r.eu:this.eu;let o=r?r.mutatedKeys:this.mutatedKeys,c=i,u=!1;const h=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,d=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((g,_)=>{const x=i.get(g),A=md(this.query,_)?_:null,S=!!x&&this.mutatedKeys.has(x.key),R=!!A&&(A.hasLocalMutations||this.mutatedKeys.has(A.key)&&A.hasCommittedMutations);let w=!1;x&&A?x.data.isEqual(A.data)?S!==R&&(n.track({type:3,doc:A}),w=!0):this.iu(x,A)||(n.track({type:2,doc:A}),w=!0,(h&&this.Xa(A,h)>0||d&&this.Xa(A,d)<0)&&(u=!0)):!x&&A?(n.track({type:0,doc:A}),w=!0):x&&!A&&(n.track({type:1,doc:x}),w=!0,(h||d)&&(u=!0)),w&&(A?(c=c.add(A),o=R?o.add(g):o.delete(g)):(c=c.delete(g),o=o.delete(g)))}),this.query.limit!==null)for(;c.size>this.query.limit;){const g=this.query.limitType==="F"?c.last():c.first();c=c.delete(g.key),o=o.delete(g.key),n.track({type:1,doc:g})}return{eu:c,ru:n,Ds:u,mutatedKeys:o}}iu(e,r){return e.hasLocalMutations&&r.hasCommittedMutations&&!r.hasLocalMutations}applyChanges(e,r,n,i){const o=this.eu;this.eu=e.eu,this.mutatedKeys=e.mutatedKeys;const c=e.ru.pa();c.sort((g,_)=>function(A,S){const R=w=>{switch(w){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return rt(20277,{At:w})}};return R(A)-R(S)}(g.type,_.type)||this.Xa(g.doc,_.doc)),this.su(n),i=i!=null&&i;const u=r&&!i?this.ou():[],h=this.Za.size===0&&this.current&&!i?1:0,d=h!==this.Ya;return this.Ya=h,c.length!==0||d?{snapshot:new fc(this.query,e.eu,o,c,e.mutatedKeys,h===0,d,!1,!!n&&n.resumeToken.approximateByteSize()>0),_u:u}:{_u:u}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({eu:this.eu,ru:new sT,mutatedKeys:this.mutatedKeys,Ds:!1},!1)):{_u:[]}}au(e){return!this.Ha.has(e)&&!!this.eu.has(e)&&!this.eu.get(e).hasLocalMutations}su(e){e&&(e.addedDocuments.forEach(r=>this.Ha=this.Ha.add(r)),e.modifiedDocuments.forEach(r=>{}),e.removedDocuments.forEach(r=>this.Ha=this.Ha.delete(r)),this.current=e.current)}ou(){if(!this.current)return[];const e=this.Za;this.Za=At(),this.eu.forEach(n=>{this.au(n.key)&&(this.Za=this.Za.add(n.key))});const r=[];return e.forEach(n=>{this.Za.has(n)||r.push(new Uw(n))}),this.Za.forEach(n=>{e.has(n)||r.push(new Vw(n))}),r}uu(e){this.Ha=e.qs,this.Za=At();const r=this.nu(e.documents);return this.applyChanges(r,!0)}cu(){return fc.fromInitialDocuments(this.query,this.eu,this.mutatedKeys,this.Ya===0,this.hasCachedResults)}}const M1="SyncEngine";class ZN{constructor(e,r,n){this.query=e,this.targetId=r,this.view=n}}class JN{constructor(e){this.key=e,this.lu=!1}}class e6{constructor(e,r,n,i,o,c){this.localStore=e,this.remoteStore=r,this.eventManager=n,this.sharedClientState=i,this.currentUser=o,this.maxConcurrentLimboResolutions=c,this.hu={},this.Pu=new Xo(u=>tw(u),pd),this.Tu=new Map,this.Iu=new Set,this.du=new or($e.comparator),this.Eu=new Map,this.Au=new S1,this.Ru={},this.Vu=new Map,this.mu=uc.ur(),this.onlineState="Unknown",this.fu=void 0}get isPrimaryClient(){return this.fu===!0}}async function t6(t,e,r=!0){const n=qw(t);let i;const o=n.Pu.get(e);return o?(n.sharedClientState.addLocalQueryTarget(o.targetId),i=o.view.cu()):i=await Bw(n,e,r,!0),i}async function r6(t,e){const r=qw(t);await Bw(r,e,!0,!1)}async function Bw(t,e,r,n){const i=await TN(t.localStore,ti(e)),o=i.targetId,c=t.sharedClientState.addLocalQueryTarget(o,r);let u;return n&&(u=await n6(t,e,o,c==="current",i.resumeToken)),t.isPrimaryClient&&r&&bw(t.remoteStore,i),u}async function n6(t,e,r,n,i){t.gu=(_,x,A)=>async function(R,w,B,H){let N=w.view.nu(B);N.Ds&&(N=await eT(R.localStore,w.query,!1).then(({documents:C})=>w.view.nu(C,N)));const J=H&&H.targetChanges.get(w.targetId),re=H&&H.targetMismatches.get(w.targetId)!=null,ne=w.view.applyChanges(N,R.isPrimaryClient,J,re);return uT(R,w.targetId,ne._u),ne.snapshot}(t,_,x,A);const o=await eT(t.localStore,e,!0),c=new QN(e,o.qs),u=c.nu(o.documents),h=Rf.createSynthesizedTargetChangeForCurrentChange(r,n&&t.onlineState!=="Offline",i),d=c.applyChanges(u,t.isPrimaryClient,h);uT(t,r,d._u);const g=new ZN(e,r,c);return t.Pu.set(e,g),t.Tu.has(r)?t.Tu.get(r).push(e):t.Tu.set(r,[e]),d.snapshot}async function a6(t,e,r){const n=ct(t),i=n.Pu.get(e),o=n.Tu.get(i.targetId);if(o.length>1)return n.Tu.set(i.targetId,o.filter(c=>!pd(c,e))),void n.Pu.delete(e);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(i.targetId),n.sharedClientState.isActiveQueryTarget(i.targetId)||await Rg(n.localStore,i.targetId,!1).then(()=>{n.sharedClientState.clearQueryState(i.targetId),r&&b1(n.remoteStore,i.targetId),Ig(n,i.targetId)}).catch(xc)):(Ig(n,i.targetId),await Rg(n.localStore,i.targetId,!0))}async function i6(t,e){const r=ct(t),n=r.Pu.get(e),i=r.Tu.get(n.targetId);r.isPrimaryClient&&i.length===1&&(r.sharedClientState.removeLocalQueryTarget(n.targetId),b1(r.remoteStore,n.targetId))}async function s6(t,e,r){const n=d6(t);try{const i=await function(c,u){const h=ct(c),d=tr.now(),g=u.reduce((A,S)=>A.add(S.key),At());let _,x;return h.persistence.runTransaction("Locally write mutations","readwrite",A=>{let S=ji(),R=At();return h.Os.getEntries(A,g).next(w=>{S=w,S.forEach((B,H)=>{H.isValidDocument()||(R=R.add(B))})}).next(()=>h.localDocuments.getOverlayedDocuments(A,S)).next(w=>{_=w;const B=[];for(const H of u){const N=TO(H,_.get(H.key).overlayedDocument);N!=null&&B.push(new Zs(H.key,N,WA(N.value.mapValue),pa.exists(!0)))}return h.mutationQueue.addMutationBatch(A,d,B,u)}).next(w=>{x=w;const B=w.applyToLocalDocumentSet(_,R);return h.documentOverlayCache.saveOverlays(A,w.batchId,B)})}).then(()=>({batchId:x.batchId,changes:aw(_)}))}(n.localStore,e);n.sharedClientState.addPendingMutation(i.batchId),function(c,u,h){let d=c.Ru[c.currentUser.toKey()];d||(d=new or(mt)),d=d.insert(u,h),c.Ru[c.currentUser.toKey()]=d}(n,i.batchId,r),await bf(n,i.changes),await Ed(n.remoteStore)}catch(i){const o=F1(i,"Failed to persist write");r.reject(o)}}async function jw(t,e){const r=ct(t);try{const n=await xN(r.localStore,e);e.targetChanges.forEach((i,o)=>{const c=r.Eu.get(o);c&&(jt(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1,22616),i.addedDocuments.size>0?c.lu=!0:i.modifiedDocuments.size>0?jt(c.lu,14607):i.removedDocuments.size>0&&(jt(c.lu,42227),c.lu=!1))}),await bf(r,n,e)}catch(n){await xc(n)}}function cT(t,e,r){const n=ct(t);if(n.isPrimaryClient&&r===0||!n.isPrimaryClient&&r===1){const i=[];n.Pu.forEach((o,c)=>{const u=c.view.va(e);u.snapshot&&i.push(u.snapshot)}),function(c,u){const h=ct(c);h.onlineState=u;let d=!1;h.queries.forEach((g,_)=>{for(const x of _.wa)x.va(u)&&(d=!0)}),d&&P1(h)}(n.eventManager,e),i.length&&n.hu.J_(i),n.onlineState=e,n.isPrimaryClient&&n.sharedClientState.setOnlineState(e)}}async function o6(t,e,r){const n=ct(t);n.sharedClientState.updateQueryState(e,"rejected",r);const i=n.Eu.get(e),o=i&&i.key;if(o){let c=new or($e.comparator);c=c.insert(o,un.newNoDocument(o,lt.min()));const u=At().add(o),h=new _d(lt.min(),new Map,new or(mt),c,u);await jw(n,h),n.du=n.du.remove(o),n.Eu.delete(e),L1(n)}else await Rg(n.localStore,e,!1).then(()=>Ig(n,e,r)).catch(xc)}async function l6(t,e){const r=ct(t),n=e.batch.batchId;try{const i=await _N(r.localStore,e);Hw(r,n,null),zw(r,n),r.sharedClientState.updateMutationState(n,"acknowledged"),await bf(r,i)}catch(i){await xc(i)}}async function c6(t,e,r){const n=ct(t);try{const i=await function(c,u){const h=ct(c);return h.persistence.runTransaction("Reject batch","readwrite-primary",d=>{let g;return h.mutationQueue.lookupMutationBatch(d,u).next(_=>(jt(_!==null,37113),g=_.keys(),h.mutationQueue.removeMutationBatch(d,_))).next(()=>h.mutationQueue.performConsistencyCheck(d)).next(()=>h.documentOverlayCache.removeOverlaysForBatchId(d,g,u)).next(()=>h.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(d,g)).next(()=>h.localDocuments.getDocuments(d,g))})}(n.localStore,e);Hw(n,e,r),zw(n,e),n.sharedClientState.updateMutationState(e,"rejected",r),await bf(n,i)}catch(i){await xc(i)}}function zw(t,e){(t.Vu.get(e)||[]).forEach(r=>{r.resolve()}),t.Vu.delete(e)}function Hw(t,e,r){const n=ct(t);let i=n.Ru[n.currentUser.toKey()];if(i){const o=i.get(e);o&&(r?o.reject(r):o.resolve(),i=i.remove(e)),n.Ru[n.currentUser.toKey()]=i}}function Ig(t,e,r=null){t.sharedClientState.removeLocalQueryTarget(e);for(const n of t.Tu.get(e))t.Pu.delete(n),r&&t.hu.pu(n,r);t.Tu.delete(e),t.isPrimaryClient&&t.Au.zr(e).forEach(n=>{t.Au.containsKey(n)||Gw(t,n)})}function Gw(t,e){t.Iu.delete(e.path.canonicalString());const r=t.du.get(e);r!==null&&(b1(t.remoteStore,r),t.du=t.du.remove(e),t.Eu.delete(r),L1(t))}function uT(t,e,r){for(const n of r)n instanceof Vw?(t.Au.addReference(n.key,e),u6(t,n)):n instanceof Uw?(Ge(M1,"Document no longer in limbo: "+n.key),t.Au.removeReference(n.key,e),t.Au.containsKey(n.key)||Gw(t,n.key)):rt(19791,{yu:n})}function u6(t,e){const r=e.key,n=r.path.canonicalString();t.du.get(r)||t.Iu.has(n)||(Ge(M1,"New document in limbo: "+r),t.Iu.add(n),L1(t))}function L1(t){for(;t.Iu.size>0&&t.du.size<t.maxConcurrentLimboResolutions;){const e=t.Iu.values().next().value;t.Iu.delete(e);const r=new $e(Zt.fromString(e)),n=t.mu.next();t.Eu.set(n,new JN(r)),t.du=t.du.insert(r,n),bw(t.remoteStore,new Cs(ti(x1(r.path)),n,"TargetPurposeLimboResolution",fd.ue))}}async function bf(t,e,r){const n=ct(t),i=[],o=[],c=[];n.Pu.isEmpty()||(n.Pu.forEach((u,h)=>{c.push(n.gu(h,e,r).then(d=>{var g;if((d||r)&&n.isPrimaryClient){const _=d?!d.fromCache:(g=r?.targetChanges.get(h.targetId))===null||g===void 0?void 0:g.current;n.sharedClientState.updateQueryState(h.targetId,_?"current":"not-current")}if(d){i.push(d);const _=R1.Es(h.targetId,d);o.push(_)}}))}),await Promise.all(c),n.hu.J_(i),await async function(h,d){const g=ct(h);try{await g.persistence.runTransaction("notifyLocalViewChanges","readwrite",_=>be.forEach(d,x=>be.forEach(x.Is,A=>g.persistence.referenceDelegate.addReference(_,x.targetId,A)).next(()=>be.forEach(x.ds,A=>g.persistence.referenceDelegate.removeReference(_,x.targetId,A)))))}catch(_){if(!yc(_))throw _;Ge(k1,"Failed to update sequence numbers: "+_)}for(const _ of d){const x=_.targetId;if(!_.fromCache){const A=g.Fs.get(x),S=A.snapshotVersion,R=A.withLastLimboFreeSnapshotVersion(S);g.Fs=g.Fs.insert(x,R)}}}(n.localStore,o))}async function f6(t,e){const r=ct(t);if(!r.currentUser.isEqual(e)){Ge(M1,"User change. New user:",e.toKey());const n=await Sw(r.localStore,e);r.currentUser=e,function(o,c){o.Vu.forEach(u=>{u.forEach(h=>{h.reject(new He(Re.CANCELLED,c))})}),o.Vu.clear()}(r,"'waitForPendingWrites' promise is rejected due to a user change."),r.sharedClientState.handleUserChange(e,n.removedBatchIds,n.addedBatchIds),await bf(r,n.Bs)}}function h6(t,e){const r=ct(t),n=r.Eu.get(e);if(n&&n.lu)return At().add(n.key);{let i=At();const o=r.Tu.get(e);if(!o)return i;for(const c of o){const u=r.Pu.get(c);i=i.unionWith(u.view.tu)}return i}}function qw(t){const e=ct(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=jw.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=h6.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=o6.bind(null,e),e.hu.J_=YN.bind(null,e.eventManager),e.hu.pu=$N.bind(null,e.eventManager),e}function d6(t){const e=ct(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=l6.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=c6.bind(null,e),e}class q0{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=xd(e.databaseInfo.databaseId),this.sharedClientState=this.bu(e),this.persistence=this.Du(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Cu(e,this.localStore),this.indexBackfillerScheduler=this.Fu(e,this.localStore)}Cu(e,r){return null}Fu(e,r){return null}vu(e){return vN(this.persistence,new pN,e.initialUser,this.serializer)}Du(e){return new ww(C1.Vi,this.serializer)}bu(e){return new wN}async terminate(){var e,r;(e=this.gcScheduler)===null||e===void 0||e.stop(),(r=this.indexBackfillerScheduler)===null||r===void 0||r.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}q0.provider={build:()=>new q0};class p6 extends q0{constructor(e){super(),this.cacheSizeBytes=e}Cu(e,r){jt(this.persistence.referenceDelegate instanceof H0,46915);const n=this.persistence.referenceDelegate.garbageCollector;return new JO(n,e.asyncQueue,r)}Du(e){const r=this.cacheSizeBytes!==void 0?Nn.withCacheSize(this.cacheSizeBytes):Nn.DEFAULT;return new ww(n=>H0.Vi(n,r),this.serializer)}}class Dg{async initialize(e,r){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(r),this.remoteStore=this.createRemoteStore(r),this.eventManager=this.createEventManager(r),this.syncEngine=this.createSyncEngine(r,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=n=>cT(this.syncEngine,n,1),this.remoteStore.remoteSyncer.handleCredentialChange=f6.bind(null,this.syncEngine),await KN(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new XN}()}createDatastore(e){const r=xd(e.databaseInfo.databaseId),n=function(o){return new bN(o)}(e.databaseInfo);return function(o,c,u,h){return new NN(o,c,u,h)}(e.authCredentials,e.appCheckCredentials,n,r)}createRemoteStore(e){return function(n,i,o,c,u){return new PN(n,i,o,c,u)}(this.localStore,this.datastore,e.asyncQueue,r=>cT(this.syncEngine,r,0),function(){return nT.C()?new nT:new SN}())}createSyncEngine(e,r){return function(i,o,c,u,h,d,g){const _=new e6(i,o,c,u,h,d);return g&&(_.fu=!0),_}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,r)}async terminate(){var e,r;await async function(i){const o=ct(i);Ge(jo,"RemoteStore shutting down."),o.Ia.add(5),await kf(o),o.Ea.shutdown(),o.Aa.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(r=this.eventManager)===null||r===void 0||r.terminate()}}Dg.provider={build:()=>new Dg};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kw{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.xu(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.xu(this.observer.error,e):Bi("Uncaught Error in snapshot listener:",e.toString()))}Ou(){this.muted=!0}xu(e,r){setTimeout(()=>{this.muted||e(r)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Gs="FirestoreClient";class m6{constructor(e,r,n,i,o){this.authCredentials=e,this.appCheckCredentials=r,this.asyncQueue=n,this.databaseInfo=i,this.user=ln.UNAUTHENTICATED,this.clientId=d1.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=o,this.authCredentials.start(n,async c=>{Ge(Gs,"Received user=",c.uid),await this.authCredentialListener(c),this.user=c}),this.appCheckCredentials.start(n,c=>(Ge(Gs,"Received new app check token=",c),this.appCheckCredentialListener(c,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Ni;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(r){const n=F1(r,"Failed to shutdown persistence");e.reject(n)}}),e.promise}}async function Wm(t,e){t.asyncQueue.verifyOperationInProgress(),Ge(Gs,"Initializing OfflineComponentProvider");const r=t.configuration;await e.initialize(r);let n=r.initialUser;t.setCredentialChangeListener(async i=>{n.isEqual(i)||(await Sw(e.localStore,i),n=i)}),e.persistence.setDatabaseDeletedListener(()=>{Vs("Terminating Firestore due to IndexedDb database deletion"),t.terminate().then(()=>{Ge("Terminating Firestore due to IndexedDb database deletion completed successfully")}).catch(i=>{Vs("Terminating Firestore due to IndexedDb database deletion failed",i)})}),t._offlineComponents=e}async function fT(t,e){t.asyncQueue.verifyOperationInProgress();const r=await g6(t);Ge(Gs,"Initializing OnlineComponentProvider"),await e.initialize(r,t.configuration),t.setCredentialChangeListener(n=>iT(e.remoteStore,n)),t.setAppCheckTokenChangeListener((n,i)=>iT(e.remoteStore,i)),t._onlineComponents=e}async function g6(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){Ge(Gs,"Using user provided OfflineComponentProvider");try{await Wm(t,t._uninitializedComponentsProvider._offline)}catch(e){const r=e;if(!function(i){return i.name==="FirebaseError"?i.code===Re.FAILED_PRECONDITION||i.code===Re.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11}(r))throw r;Vs("Error using user provided cache. Falling back to memory cache: "+r),await Wm(t,new q0)}}else Ge(Gs,"Using default OfflineComponentProvider"),await Wm(t,new p6(void 0));return t._offlineComponents}async function Ww(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(Ge(Gs,"Using user provided OnlineComponentProvider"),await fT(t,t._uninitializedComponentsProvider._online)):(Ge(Gs,"Using default OnlineComponentProvider"),await fT(t,new Dg))),t._onlineComponents}function v6(t){return Ww(t).then(e=>e.syncEngine)}async function Xw(t){const e=await Ww(t),r=e.eventManager;return r.onListen=t6.bind(null,e.syncEngine),r.onUnlisten=a6.bind(null,e.syncEngine),r.onFirstRemoteStoreListen=r6.bind(null,e.syncEngine),r.onLastRemoteStoreUnlisten=i6.bind(null,e.syncEngine),r}function _6(t,e,r={}){const n=new Ni;return t.asyncQueue.enqueueAndForget(async()=>function(o,c,u,h,d){const g=new Kw({next:x=>{g.Ou(),c.enqueueAndForget(()=>Mw(o,_));const A=x.docs.has(u);!A&&x.fromCache?d.reject(new He(Re.UNAVAILABLE,"Failed to get document because the client is offline.")):A&&x.fromCache&&h&&h.source==="server"?d.reject(new He(Re.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):d.resolve(x)},error:x=>d.reject(x)}),_=new Lw(x1(u.path),g,{includeMetadataChanges:!0,ka:!0});return Pw(o,_)}(await Xw(t),t.asyncQueue,e,r,n)),n.promise}function x6(t,e,r={}){const n=new Ni;return t.asyncQueue.enqueueAndForget(async()=>function(o,c,u,h,d){const g=new Kw({next:x=>{g.Ou(),c.enqueueAndForget(()=>Mw(o,_)),x.fromCache&&h.source==="server"?d.reject(new He(Re.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):d.resolve(x)},error:x=>d.reject(x)}),_=new Lw(u,g,{includeMetadataChanges:!0,ka:!0});return Pw(o,_)}(await Xw(t),t.asyncQueue,e,r,n)),n.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Yw(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hT=new Map;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $w="firestore.googleapis.com",dT=!0;class pT{constructor(e){var r,n;if(e.host===void 0){if(e.ssl!==void 0)throw new He(Re.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=$w,this.ssl=dT}else this.host=e.host,this.ssl=(r=e.ssl)!==null&&r!==void 0?r:dT;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=Aw;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<QO)throw new He(Re.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}MD("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=Yw((n=e.experimentalLongPollingOptions)!==null&&n!==void 0?n:{}),function(o){if(o.timeoutSeconds!==void 0){if(isNaN(o.timeoutSeconds))throw new He(Re.INVALID_ARGUMENT,`invalid long polling timeout: ${o.timeoutSeconds} (must not be NaN)`);if(o.timeoutSeconds<5)throw new He(Re.INVALID_ARGUMENT,`invalid long polling timeout: ${o.timeoutSeconds} (minimum allowed value is 5)`);if(o.timeoutSeconds>30)throw new He(Re.INVALID_ARGUMENT,`invalid long polling timeout: ${o.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(n,i){return n.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Td{constructor(e,r,n,i){this._authCredentials=e,this._appCheckCredentials=r,this._databaseId=n,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new pT({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new He(Re.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new He(Re.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new pT(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=function(n){if(!n)return new RD;switch(n.type){case"firstParty":return new DD(n.sessionIndex||"0",n.iamToken||null,n.authTokenFactory||null);case"provider":return n.client;default:throw new He(Re.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(r){const n=hT.get(r);n&&(Ge("ComponentProvider","Removing Datastore"),hT.delete(r),n.terminate())}(this),Promise.resolve()}}function y6(t,e,r,n={}){var i;t=Oa(t,Td);const o=mc(e),c=t._getSettings(),u=Object.assign(Object.assign({},c),{emulatorOptions:t._getEmulatorOptions()}),h=`${e}:${r}`;o&&(j2(`https://${h}`),z2("Firestore",!0)),c.host!==$w&&c.host!==h&&Vs("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const d=Object.assign(Object.assign({},c),{host:h,ssl:o,emulatorOptions:n});if(!Lo(d,u)&&(t._setSettings(d),n.mockUserToken)){let g,_;if(typeof n.mockUserToken=="string")g=n.mockUserToken,_=ln.MOCK_USER;else{g=Uk(n.mockUserToken,(i=t._app)===null||i===void 0?void 0:i.options.projectId);const x=n.mockUserToken.sub||n.mockUserToken.user_id;if(!x)throw new He(Re.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");_=new ln(x)}t._authCredentials=new kD(new FA(g,_))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tc{constructor(e,r,n){this.converter=r,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new Tc(this.firestore,e,this._query)}}class _r{constructor(e,r,n){this.converter=r,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Ps(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new _r(this.firestore,e,this._key)}toJSON(){return{type:_r._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,r,n){if(wf(r,_r._jsonSchema))return new _r(e,n||null,new $e(Zt.fromString(r.referencePath)))}}_r._jsonSchemaVersion="firestore/documentReference/1.0",_r._jsonSchema={type:br("string",_r._jsonSchemaVersion),referencePath:br("string")};class Ps extends Tc{constructor(e,r,n){super(e,r,x1(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new _r(this.firestore,null,new $e(e))}withConverter(e){return new Ps(this.firestore,e,this._path)}}function Fn(t,e,...r){if(t=qr(t),MA("collection","path",e),t instanceof Td){const n=Zt.fromString(e,...r);return RE(n),new Ps(t,null,n)}{if(!(t instanceof _r||t instanceof Ps))throw new He(Re.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=t._path.child(Zt.fromString(e,...r));return RE(n),new Ps(t.firestore,null,n)}}function Ms(t,e,...r){if(t=qr(t),arguments.length===1&&(e=d1.newId()),MA("doc","path",e),t instanceof Td){const n=Zt.fromString(e,...r);return CE(n),new _r(t,null,new $e(n))}{if(!(t instanceof _r||t instanceof Ps))throw new He(Re.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=t._path.child(Zt.fromString(e,...r));return CE(n),new _r(t.firestore,t instanceof Ps?t.converter:null,new $e(n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mT="AsyncQueue";class gT{constructor(e=Promise.resolve()){this.Zu=[],this.Xu=!1,this.ec=[],this.tc=null,this.nc=!1,this.rc=!1,this.sc=[],this.F_=new Rw(this,"async_queue_retry"),this.oc=()=>{const n=Km();n&&Ge(mT,"Visibility state changed to "+n.visibilityState),this.F_.y_()},this._c=e;const r=Km();r&&typeof r.addEventListener=="function"&&r.addEventListener("visibilitychange",this.oc)}get isShuttingDown(){return this.Xu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.ac(),this.uc(e)}enterRestrictedMode(e){if(!this.Xu){this.Xu=!0,this.rc=e||!1;const r=Km();r&&typeof r.removeEventListener=="function"&&r.removeEventListener("visibilitychange",this.oc)}}enqueue(e){if(this.ac(),this.Xu)return new Promise(()=>{});const r=new Ni;return this.uc(()=>this.Xu&&this.rc?Promise.resolve():(e().then(r.resolve,r.reject),r.promise)).then(()=>r.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Zu.push(e),this.cc()))}async cc(){if(this.Zu.length!==0){try{await this.Zu[0](),this.Zu.shift(),this.F_.reset()}catch(e){if(!yc(e))throw e;Ge(mT,"Operation failed with retryable error: "+e)}this.Zu.length>0&&this.F_.g_(()=>this.cc())}}uc(e){const r=this._c.then(()=>(this.nc=!0,e().catch(n=>{throw this.tc=n,this.nc=!1,Bi("INTERNAL UNHANDLED ERROR: ",vT(n)),n}).then(n=>(this.nc=!1,n))));return this._c=r,r}enqueueAfterDelay(e,r,n){this.ac(),this.sc.indexOf(e)>-1&&(r=0);const i=N1.createAndSchedule(this,e,r,n,o=>this.lc(o));return this.ec.push(i),i}ac(){this.tc&&rt(47125,{hc:vT(this.tc)})}verifyOperationInProgress(){}async Pc(){let e;do e=this._c,await e;while(e!==this._c)}Tc(e){for(const r of this.ec)if(r.timerId===e)return!0;return!1}Ic(e){return this.Pc().then(()=>{this.ec.sort((r,n)=>r.targetTimeMs-n.targetTimeMs);for(const r of this.ec)if(r.skipDelay(),e!=="all"&&r.timerId===e)break;return this.Pc()})}dc(e){this.sc.push(e)}lc(e){const r=this.ec.indexOf(e);this.ec.splice(r,1)}}function vT(t){let e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+`
`+t.stack),e}class $o extends Td{constructor(e,r,n,i){super(e,r,n,i),this.type="firestore",this._queue=new gT,this._persistenceKey=i?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new gT(e),this._firestoreClient=void 0,await e}}}function E6(t,e){const r=typeof t=="object"?t:K2(),n=typeof t=="string"?t:M0,i=e1(r,"firestore").getImmediate({identifier:n});if(!i._initialized){const o=Lk("firestore");o&&y6(i,...o)}return i}function V1(t){if(t._terminated)throw new He(Re.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||T6(t),t._firestoreClient}function T6(t){var e,r,n;const i=t._freezeSettings(),o=function(u,h,d,g){return new WD(u,h,d,g.host,g.ssl,g.experimentalForceLongPolling,g.experimentalAutoDetectLongPolling,Yw(g.experimentalLongPollingOptions),g.useFetchStreams,g.isUsingEmulator)}(t._databaseId,((e=t._app)===null||e===void 0?void 0:e.options.appId)||"",t._persistenceKey,i);t._componentsProvider||!((r=i.localCache)===null||r===void 0)&&r._offlineComponentProvider&&(!((n=i.localCache)===null||n===void 0)&&n._onlineComponentProvider)&&(t._componentsProvider={_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider}),t._firestoreClient=new m6(t._authCredentials,t._appCheckCredentials,t._queue,o,t._componentsProvider&&function(u){const h=u?._online.build();return{_offline:u?._offline.build(h),_online:h}}(t._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class da{constructor(e){this._byteString=e}static fromBase64String(e){try{return new da(rn.fromBase64String(e))}catch(r){throw new He(Re.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+r)}}static fromUint8Array(e){return new da(rn.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:da._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(wf(e,da._jsonSchema))return da.fromBase64String(e.bytes)}}da._jsonSchemaVersion="firestore/bytes/1.0",da._jsonSchema={type:br("string",da._jsonSchemaVersion),bytes:br("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ad{constructor(...e){for(let r=0;r<e.length;++r)if(e[r].length===0)throw new He(Re.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Jr(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class U1{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ni{constructor(e,r){if(!isFinite(e)||e<-90||e>90)throw new He(Re.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(r)||r<-180||r>180)throw new He(Re.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+r);this._lat=e,this._long=r}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return mt(this._lat,e._lat)||mt(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:ni._jsonSchemaVersion}}static fromJSON(e){if(wf(e,ni._jsonSchema))return new ni(e.latitude,e.longitude)}}ni._jsonSchemaVersion="firestore/geoPoint/1.0",ni._jsonSchema={type:br("string",ni._jsonSchemaVersion),latitude:br("number"),longitude:br("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ai{constructor(e){this._values=(e||[]).map(r=>r)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(n,i){if(n.length!==i.length)return!1;for(let o=0;o<n.length;++o)if(n[o]!==i[o])return!1;return!0}(this._values,e._values)}toJSON(){return{type:ai._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(wf(e,ai._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every(r=>typeof r=="number"))return new ai(e.vectorValues);throw new He(Re.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}ai._jsonSchemaVersion="firestore/vectorValue/1.0",ai._jsonSchema={type:br("string",ai._jsonSchemaVersion),vectorValues:br("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const A6=/^__.*__$/;class w6{constructor(e,r,n){this.data=e,this.fieldMask=r,this.fieldTransforms=n}toMutation(e,r){return this.fieldMask!==null?new Zs(e,this.data,this.fieldMask,r,this.fieldTransforms):new Cf(e,this.data,r,this.fieldTransforms)}}class Qw{constructor(e,r,n){this.data=e,this.fieldMask=r,this.fieldTransforms=n}toMutation(e,r){return new Zs(e,this.data,this.fieldMask,r,this.fieldTransforms)}}function Zw(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw rt(40011,{Ec:t})}}class B1{constructor(e,r,n,i,o,c){this.settings=e,this.databaseId=r,this.serializer=n,this.ignoreUndefinedProperties=i,o===void 0&&this.Ac(),this.fieldTransforms=o||[],this.fieldMask=c||[]}get path(){return this.settings.path}get Ec(){return this.settings.Ec}Rc(e){return new B1(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Vc(e){var r;const n=(r=this.path)===null||r===void 0?void 0:r.child(e),i=this.Rc({path:n,mc:!1});return i.fc(e),i}gc(e){var r;const n=(r=this.path)===null||r===void 0?void 0:r.child(e),i=this.Rc({path:n,mc:!1});return i.Ac(),i}yc(e){return this.Rc({path:void 0,mc:!0})}wc(e){return K0(e,this.settings.methodName,this.settings.Sc||!1,this.path,this.settings.bc)}contains(e){return this.fieldMask.find(r=>e.isPrefixOf(r))!==void 0||this.fieldTransforms.find(r=>e.isPrefixOf(r.field))!==void 0}Ac(){if(this.path)for(let e=0;e<this.path.length;e++)this.fc(this.path.get(e))}fc(e){if(e.length===0)throw this.wc("Document fields must not be empty");if(Zw(this.Ec)&&A6.test(e))throw this.wc('Document fields cannot begin and end with "__"')}}class S6{constructor(e,r,n){this.databaseId=e,this.ignoreUndefinedProperties=r,this.serializer=n||xd(e)}Dc(e,r,n,i=!1){return new B1({Ec:e,methodName:r,bc:n,path:Jr.emptyPath(),mc:!1,Sc:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function wd(t){const e=t._freezeSettings(),r=xd(t._databaseId);return new S6(t._databaseId,!!e.ignoreUndefinedProperties,r)}function Jw(t,e,r,n,i,o={}){const c=t.Dc(o.merge||o.mergeFields?2:0,e,r,i);j1("Data must be an object, but it was:",c,n);const u=eS(n,c);let h,d;if(o.merge)h=new Wn(c.fieldMask),d=c.fieldTransforms;else if(o.mergeFields){const g=[];for(const _ of o.mergeFields){const x=Og(e,_,r);if(!c.contains(x))throw new He(Re.INVALID_ARGUMENT,`Field '${x}' is specified in your field mask but missing from your input data.`);rS(g,x)||g.push(x)}h=new Wn(g),d=c.fieldTransforms.filter(_=>h.covers(_.field))}else h=null,d=c.fieldTransforms;return new w6(new Pn(u),h,d)}class Sd extends U1{_toFieldTransform(e){if(e.Ec!==2)throw e.Ec===1?e.wc(`${this._methodName}() can only appear at the top level of your update data`):e.wc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Sd}}function C6(t,e,r,n){const i=t.Dc(1,e,r);j1("Data must be an object, but it was:",i,n);const o=[],c=Pn.empty();Qs(n,(h,d)=>{const g=z1(e,h,r);d=qr(d);const _=i.gc(g);if(d instanceof Sd)o.push(g);else{const x=If(d,_);x!=null&&(o.push(g),c.set(g,x))}});const u=new Wn(o);return new Qw(c,u,i.fieldTransforms)}function R6(t,e,r,n,i,o){const c=t.Dc(1,e,r),u=[Og(e,n,r)],h=[i];if(o.length%2!=0)throw new He(Re.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let x=0;x<o.length;x+=2)u.push(Og(e,o[x])),h.push(o[x+1]);const d=[],g=Pn.empty();for(let x=u.length-1;x>=0;--x)if(!rS(d,u[x])){const A=u[x];let S=h[x];S=qr(S);const R=c.gc(A);if(S instanceof Sd)d.push(A);else{const w=If(S,R);w!=null&&(d.push(A),g.set(A,w))}}const _=new Wn(d);return new Qw(g,_,c.fieldTransforms)}function k6(t,e,r,n=!1){return If(r,t.Dc(n?4:3,e))}function If(t,e){if(tS(t=qr(t)))return j1("Unsupported field value:",e,t),eS(t,e);if(t instanceof U1)return function(n,i){if(!Zw(i.Ec))throw i.wc(`${n._methodName}() can only be used with update() and set()`);if(!i.path)throw i.wc(`${n._methodName}() is not currently supported inside arrays`);const o=n._toFieldTransform(i);o&&i.fieldTransforms.push(o)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.mc&&e.Ec!==4)throw e.wc("Nested arrays are not supported");return function(n,i){const o=[];let c=0;for(const u of n){let h=If(u,i.yc(c));h==null&&(h={nullValue:"NULL_VALUE"}),o.push(h),c++}return{arrayValue:{values:o}}}(t,e)}return function(n,i){if((n=qr(n))===null)return{nullValue:"NULL_VALUE"};if(typeof n=="number")return gO(i.serializer,n);if(typeof n=="boolean")return{booleanValue:n};if(typeof n=="string")return{stringValue:n};if(n instanceof Date){const o=tr.fromDate(n);return{timestampValue:z0(i.serializer,o)}}if(n instanceof tr){const o=new tr(n.seconds,1e3*Math.floor(n.nanoseconds/1e3));return{timestampValue:z0(i.serializer,o)}}if(n instanceof ni)return{geoPointValue:{latitude:n.latitude,longitude:n.longitude}};if(n instanceof da)return{bytesValue:gw(i.serializer,n._byteString)};if(n instanceof _r){const o=i.databaseId,c=n.firestore._databaseId;if(!c.isEqual(o))throw i.wc(`Document reference is for database ${c.projectId}/${c.database} but should be for database ${o.projectId}/${o.database}`);return{referenceValue:w1(n.firestore._databaseId||i.databaseId,n._key.path)}}if(n instanceof ai)return function(c,u){return{mapValue:{fields:{[qA]:{stringValue:KA},[L0]:{arrayValue:{values:c.toArray().map(d=>{if(typeof d!="number")throw u.wc("VectorValues must only contain numeric values.");return y1(u.serializer,d)})}}}}}}(n,i);throw i.wc(`Unsupported field value: ${ud(n)}`)}(t,e)}function eS(t,e){const r={};return UA(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Qs(t,(n,i)=>{const o=If(i,e.Vc(n));o!=null&&(r[n]=o)}),{mapValue:{fields:r}}}function tS(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof tr||t instanceof ni||t instanceof da||t instanceof _r||t instanceof U1||t instanceof ai)}function j1(t,e,r){if(!tS(r)||!LA(r)){const n=ud(r);throw n==="an object"?e.wc(t+" a custom object"):e.wc(t+" "+n)}}function Og(t,e,r){if((e=qr(e))instanceof Ad)return e._internalPath;if(typeof e=="string")return z1(t,e);throw K0("Field path arguments must be of type string or ",t,!1,void 0,r)}const b6=new RegExp("[~\\*/\\[\\]]");function z1(t,e,r){if(e.search(b6)>=0)throw K0(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,r);try{return new Ad(...e.split("."))._internalPath}catch{throw K0(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,r)}}function K0(t,e,r,n,i){const o=n&&!n.isEmpty(),c=i!==void 0;let u=`Function ${e}() called with invalid data`;r&&(u+=" (via `toFirestore()`)"),u+=". ";let h="";return(o||c)&&(h+=" (found",o&&(h+=` in field ${n}`),c&&(h+=` in document ${i}`),h+=")"),new He(Re.INVALID_ARGUMENT,u+t+h)}function rS(t,e){return t.some(r=>r.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nS{constructor(e,r,n,i,o){this._firestore=e,this._userDataWriter=r,this._key=n,this._document=i,this._converter=o}get id(){return this._key.path.lastSegment()}get ref(){return new _r(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new I6(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const r=this._document.data.field(H1("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r)}}}class I6 extends nS{data(){return super.data()}}function H1(t,e){return typeof e=="string"?z1(t,e):e instanceof Ad?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function D6(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new He(Re.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class G1{}class O6 extends G1{}function aS(t,e,...r){let n=[];e instanceof G1&&n.push(e),n=n.concat(r),function(o){const c=o.filter(h=>h instanceof q1).length,u=o.filter(h=>h instanceof Cd).length;if(c>1||c>0&&u>0)throw new He(Re.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(n);for(const i of n)t=i._apply(t);return t}class Cd extends O6{constructor(e,r,n){super(),this._field=e,this._op=r,this._value=n,this.type="where"}static _create(e,r,n){return new Cd(e,r,n)}_apply(e){const r=this._parse(e);return sS(e._query,r),new Tc(e.firestore,e.converter,Eg(e._query,r))}_parse(e){const r=wd(e.firestore);return function(o,c,u,h,d,g,_){let x;if(d.isKeyField()){if(g==="array-contains"||g==="array-contains-any")throw new He(Re.INVALID_ARGUMENT,`Invalid Query. You can't perform '${g}' queries on documentId().`);if(g==="in"||g==="not-in"){xT(_,g);const S=[];for(const R of _)S.push(_T(h,o,R));x={arrayValue:{values:S}}}else x=_T(h,o,_)}else g!=="in"&&g!=="not-in"&&g!=="array-contains-any"||xT(_,g),x=k6(u,c,_,g==="in"||g==="not-in");return kr.create(d,g,x)}(e._query,"where",r,e.firestore._databaseId,this._field,this._op,this._value)}}function iS(t,e,r){const n=e,i=H1("where",t);return Cd._create(i,n,r)}class q1 extends G1{constructor(e,r){super(),this.type=e,this._queryConstraints=r}static _create(e,r){return new q1(e,r)}_parse(e){const r=this._queryConstraints.map(n=>n._parse(e)).filter(n=>n.getFilters().length>0);return r.length===1?r[0]:Na.create(r,this._getOperator())}_apply(e){const r=this._parse(e);return r.getFilters().length===0?e:(function(i,o){let c=i;const u=o.getFlattenedFilters();for(const h of u)sS(c,h),c=Eg(c,h)}(e._query,r),new Tc(e.firestore,e.converter,Eg(e._query,r)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}function _T(t,e,r){if(typeof(r=qr(r))=="string"){if(r==="")throw new He(Re.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!ew(e)&&r.indexOf("/")!==-1)throw new He(Re.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${r}' contains a '/' character.`);const n=e.path.child(Zt.fromString(r));if(!$e.isDocumentKey(n))throw new He(Re.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${n}' is not because it has an odd number of segments (${n.length}).`);return PE(t,new $e(n))}if(r instanceof _r)return PE(t,r._key);throw new He(Re.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${ud(r)}.`)}function xT(t,e){if(!Array.isArray(t)||t.length===0)throw new He(Re.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function sS(t,e){const r=function(i,o){for(const c of i)for(const u of c.getFlattenedFilters())if(o.indexOf(u.op)>=0)return u.op;return null}(t.filters,function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(r!==null)throw r===e.op?new He(Re.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new He(Re.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${r.toString()}' filters.`)}class N6{convertValue(e,r="none"){switch(zs(e)){case 0:return null;case 1:return e.booleanValue;case 2:return vr(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,r);case 5:return e.stringValue;case 6:return this.convertBytes(js(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,r);case 11:return this.convertObject(e.mapValue,r);case 10:return this.convertVectorValue(e.mapValue);default:throw rt(62114,{value:e})}}convertObject(e,r){return this.convertObjectMap(e.fields,r)}convertObjectMap(e,r="none"){const n={};return Qs(e,(i,o)=>{n[i]=this.convertValue(o,r)}),n}convertVectorValue(e){var r,n,i;const o=(i=(n=(r=e.fields)===null||r===void 0?void 0:r[L0].arrayValue)===null||n===void 0?void 0:n.values)===null||i===void 0?void 0:i.map(c=>vr(c.doubleValue));return new ai(o)}convertGeoPoint(e){return new ni(vr(e.latitude),vr(e.longitude))}convertArray(e,r){return(e.values||[]).map(n=>this.convertValue(n,r))}convertServerTimestamp(e,r){switch(r){case"previous":const n=dd(e);return n==null?null:this.convertValue(n,r);case"estimate":return this.convertTimestamp(nf(e));default:return null}}convertTimestamp(e){const r=Bs(e);return new tr(r.seconds,r.nanos)}convertDocumentKey(e,r){const n=Zt.fromString(e);jt(Tw(n),9688,{name:e});const i=new af(n.get(1),n.get(3)),o=new $e(n.popFirst(5));return i.isEqual(r)||Bi(`Document ${o} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${r.projectId}/${r.database}) instead.`),o}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oS(t,e,r){let n;return n=t?t.toFirestore(e):e,n}class Iu{constructor(e,r){this.hasPendingWrites=e,this.fromCache=r}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Fo extends nS{constructor(e,r,n,i,o,c){super(e,r,n,i,c),this._firestore=e,this._firestoreImpl=e,this.metadata=o}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const r=new w0(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(r,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,r={}){if(this._document){const n=this._document.data.field(H1("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n,r.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new He(Re.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,r={};return r.type=Fo._jsonSchemaVersion,r.bundle="",r.bundleSource="DocumentSnapshot",r.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?r:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),r.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),r)}}Fo._jsonSchemaVersion="firestore/documentSnapshot/1.0",Fo._jsonSchema={type:br("string",Fo._jsonSchemaVersion),bundleSource:br("string","DocumentSnapshot"),bundleName:br("string"),bundle:br("string")};class w0 extends Fo{data(e={}){return super.data(e)}}class tc{constructor(e,r,n,i){this._firestore=e,this._userDataWriter=r,this._snapshot=i,this.metadata=new Iu(i.hasPendingWrites,i.fromCache),this.query=n}get docs(){const e=[];return this.forEach(r=>e.push(r)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,r){this._snapshot.docs.forEach(n=>{e.call(r,new w0(this._firestore,this._userDataWriter,n.key,n,new Iu(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const r=!!e.includeMetadataChanges;if(r&&this._snapshot.excludesMetadataChanges)throw new He(Re.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===r||(this._cachedChanges=function(i,o){if(i._snapshot.oldDocs.isEmpty()){let c=0;return i._snapshot.docChanges.map(u=>{const h=new w0(i._firestore,i._userDataWriter,u.doc.key,u.doc,new Iu(i._snapshot.mutatedKeys.has(u.doc.key),i._snapshot.fromCache),i.query.converter);return u.doc,{type:"added",doc:h,oldIndex:-1,newIndex:c++}})}{let c=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(u=>o||u.type!==3).map(u=>{const h=new w0(i._firestore,i._userDataWriter,u.doc.key,u.doc,new Iu(i._snapshot.mutatedKeys.has(u.doc.key),i._snapshot.fromCache),i.query.converter);let d=-1,g=-1;return u.type!==0&&(d=c.indexOf(u.doc.key),c=c.delete(u.doc.key)),u.type!==1&&(c=c.add(u.doc),g=c.indexOf(u.doc.key)),{type:F6(u.type),doc:h,oldIndex:d,newIndex:g}})}}(this,r),this._cachedChangesIncludeMetadataChanges=r),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new He(Re.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=tc._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=d1.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const r=[],n=[],i=[];return this.docs.forEach(o=>{o._document!==null&&(r.push(o._document),n.push(this._userDataWriter.convertObjectMap(o._document.data.value.mapValue.fields,"previous")),i.push(o.ref.path))}),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function F6(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return rt(61501,{type:t})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function P6(t){t=Oa(t,_r);const e=Oa(t.firestore,$o);return _6(V1(e),t._key).then(r=>L6(e,t,r))}tc._jsonSchemaVersion="firestore/querySnapshot/1.0",tc._jsonSchema={type:br("string",tc._jsonSchemaVersion),bundleSource:br("string","QuerySnapshot"),bundleName:br("string"),bundle:br("string")};class lS extends N6{constructor(e){super(),this.firestore=e}convertBytes(e){return new da(e)}convertReference(e){const r=this.convertDocumentKey(e,this.firestore._databaseId);return new _r(this.firestore,null,r)}}function Fi(t){t=Oa(t,Tc);const e=Oa(t.firestore,$o),r=V1(e),n=new lS(e);return D6(t._query),x6(r,t._query).then(i=>new tc(e,n,t,i))}function M6(t,e,r){t=Oa(t,_r);const n=Oa(t.firestore,$o),i=oS(t.converter,e);return Rd(n,[Jw(wd(n),"setDoc",t._key,i,t.converter!==null,r).toMutation(t._key,pa.none())])}function cS(t,e,r,...n){t=Oa(t,_r);const i=Oa(t.firestore,$o),o=wd(i);let c;return c=typeof(e=qr(e))=="string"||e instanceof Ad?R6(o,"updateDoc",t._key,e,r,n):C6(o,"updateDoc",t._key,e),Rd(i,[c.toMutation(t._key,pa.exists(!0))])}function Ng(t){return Rd(Oa(t.firestore,$o),[new E1(t._key,pa.none())])}function ju(t,e){const r=Oa(t.firestore,$o),n=Ms(t),i=oS(t.converter,e);return Rd(r,[Jw(wd(t.firestore),"addDoc",n._key,i,t.converter!==null,{}).toMutation(n._key,pa.exists(!1))]).then(()=>n)}function Rd(t,e){return function(n,i){const o=new Ni;return n.asyncQueue.enqueueAndForget(async()=>s6(await v6(n),i,o)),o.promise}(V1(t),e)}function L6(t,e,r){const n=r.docs.get(e._key),i=new lS(t);return new Fo(t,i,e._key,n,new Iu(r.hasPendingWrites,r.fromCache),e.converter)}(function(e,r=!0){(function(i){_c=i})(gc),ic(new Vo("firestore",(n,{instanceIdentifier:i,options:o})=>{const c=n.getProvider("app").getImmediate(),u=new $o(new bD(n.getProvider("auth-internal")),new OD(c,n.getProvider("app-check-internal")),function(d,g){if(!Object.prototype.hasOwnProperty.apply(d.options,["projectId"]))throw new He(Re.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new af(d.options.projectId,g)}(c,i),c);return o=Object.assign({useFetchStreams:r},o),u._setSettings(o),u},"PUBLIC").setMultipleInstances(!0)),Os(EE,TE,e),Os(EE,TE,"esm2017")})();var V6="firebase",U6="11.10.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Os(V6,U6,"app");const B6={apiKey:"AIzaSyAADvft0ne-CpB00qBPOkJMcFqCGe-tOaU",authDomain:"evalstage2-lucas2025.firebaseapp.com",projectId:"evalstage2-lucas2025",storageBucket:"evalstage2-lucas2025.appspot.com",messagingSenderId:"1074657513257",appId:"1:1074657513257:web:f3fcc8ec7a421801277138"},uS=q2(B6),i0=SD(uS),gr=E6(uS),fS=Ie.createContext(void 0),kd=()=>{const t=Ie.useContext(fS);if(t===void 0)throw new Error("useAuth must be used within an AuthProvider");return t},j6=({children:t})=>{const[e,r]=Ie.useState(null),[n,i]=Ie.useState(null),[o,c]=Ie.useState(!0);Ie.useEffect(()=>d3(i0,async x=>{if(i(x),x)try{const A=await P6(Ms(gr,"users",x.uid));if(A.exists()){const S=A.data(),R=S.createdAt?.toDate?.()||new Date(S.createdAt)||new Date;r({id:x.uid,email:S.email||x.email||"",nom:S.nom||"Utilisateur",prenom:S.prenom||"Test",role:S.role||"professeur",createdAt:R}),console.log("✅ Connexion réussie:",S)}else{const S={id:x.uid,email:x.email||"",nom:"Utilisateur",prenom:"Test",role:"professeur",createdAt:new Date};await M6(Ms(gr,"users",x.uid),S),r(S),console.log("✅ Document utilisateur créé:",S)}}catch(A){console.error("❌ Erreur utilisateur:",A);const S={id:x.uid,email:x.email||"",nom:"Utilisateur",prenom:"Test",role:"professeur",createdAt:new Date};r(S)}else r(null),console.log("🔴 Utilisateur déconnecté");c(!1)}),[]);const g={currentUser:e,firebaseUser:n,loading:o,login:async(_,x)=>{try{await u3(i0,_,x)}catch(A){throw A}},loginWithGoogle:async()=>{const _=new bi;try{await F3(i0,_)}catch(x){throw x}},logout:async()=>{try{await p3(i0)}catch(_){throw _}}};return K.jsx(fS.Provider,{value:g,children:t})},z6=({onToggleTheme:t,isDarkMode:e})=>{const[r,n]=Ie.useState(!1),{currentUser:i,logout:o}=kd(),c=async()=>{try{await o(),n(!1)}catch(h){console.error("Erreur lors de la déconnexion:",h)}},u=()=>{n(!r)};return K.jsx("nav",{className:"navigation",children:K.jsxs("div",{className:"nav-container",children:[K.jsx("button",{className:"menu-toggle",onClick:u,"aria-label":"Menu",children:"☰"}),K.jsx("div",{className:`nav-menu ${r?"open":""}`,children:i&&K.jsxs(K.Fragment,{children:[K.jsxs("div",{className:"user-info",children:[K.jsx("p",{children:"Connecté en tant que :"}),K.jsxs("strong",{children:[i.prenom," ",i.nom]}),K.jsxs("span",{className:"user-role",children:["(",i.role,")"]})]}),K.jsxs("div",{className:"nav-links",children:[K.jsx(ko,{to:"/",className:"nav-link",onClick:()=>n(!1),children:"Accueil"}),i.role==="admin"&&K.jsx(ko,{to:"/classes",className:"nav-link",onClick:()=>n(!1),children:"Gérer les classes"}),K.jsx(ko,{to:"/periodes-stage",className:"nav-link",onClick:()=>n(!1),children:"Périodes de stage"}),K.jsx(ko,{to:"/evaluations",className:"nav-link",onClick:()=>n(!1),children:"Évaluer un élève"}),K.jsx(ko,{to:"/rapports",className:"nav-link",onClick:()=>n(!1),children:"Exporter rapports"}),i.role==="admin"&&K.jsx(ko,{to:"/comptes",className:"nav-link",onClick:()=>n(!1),children:"Gestion des comptes"})]}),K.jsxs("div",{className:"nav-actions",children:[K.jsx("button",{className:"theme-toggle",onClick:t,children:e?"☀️":"🌙"}),K.jsx("button",{onClick:c,className:"logout-button",children:"Se déconnecter"})]})]})})]})})},H6=()=>{const[t,e]=Ie.useState(""),[r,n]=Ie.useState(""),[i,o]=Ie.useState(""),[c,u]=Ie.useState(!1),{login:h,loginWithGoogle:d}=kd(),g=Qg(),_=async A=>{if(A.preventDefault(),!t||!r){o("Veuillez remplir tous les champs");return}try{o(""),u(!0),await h(t,r),g("/")}catch(S){o("Email ou mot de passe incorrect"),console.error("Erreur de connexion:",S)}finally{u(!1)}},x=async()=>{try{o(""),u(!0),await d(),g("/")}catch(A){console.error("Erreur Google Auth:",A),o("La connexion Google a échoué")}finally{u(!1)}};return K.jsx("div",{className:"login-container",children:K.jsxs("div",{className:"login-card",children:[K.jsxs("div",{className:"login-header",children:[K.jsx("h1",{children:"evalstage2"}),K.jsx("p",{children:"Connexion"})]}),i&&K.jsx("div",{className:"error-message",children:i}),K.jsxs("form",{onSubmit:_,className:"login-form",children:[K.jsxs("div",{className:"form-group",children:[K.jsx("label",{htmlFor:"email",children:"Email"}),K.jsx("input",{type:"email",id:"email",value:t,onChange:A=>e(A.target.value),placeholder:"votre.email@exemple.com",required:!0})]}),K.jsxs("div",{className:"form-group",children:[K.jsx("label",{htmlFor:"password",children:"Mot de passe"}),K.jsx("input",{type:"password",id:"password",value:r,onChange:A=>n(A.target.value),placeholder:"Votre mot de passe",required:!0})]}),K.jsx("button",{type:"submit",className:"login-button",disabled:c,children:c?"Connexion...":"Se connecter"}),K.jsx("button",{type:"button",className:"google-button",onClick:x,disabled:c,children:"Se connecter avec Google"})]}),K.jsx("div",{className:"login-footer",children:K.jsx("p",{children:"Application d'évaluation des stages"})})]})})};/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var hS=1252,G6=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],K1={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},W1=function(t){G6.indexOf(t)!=-1&&(hS=K1[0]=t)};function q6(){W1(1252)}var ka=function(t){W1(t)};function dS(){ka(1200),q6()}function yT(t){for(var e=[],r=0,n=t.length;r<n;++r)e[r]=t.charCodeAt(r);return e}function K6(t){for(var e=[],r=0;r<t.length>>1;++r)e[r]=String.fromCharCode(t.charCodeAt(2*r)+(t.charCodeAt(2*r+1)<<8));return e.join("")}function pS(t){for(var e=[],r=0;r<t.length>>1;++r)e[r]=String.fromCharCode(t.charCodeAt(2*r+1)+(t.charCodeAt(2*r)<<8));return e.join("")}var Du=function(t){var e=t.charCodeAt(0),r=t.charCodeAt(1);return e==255&&r==254?K6(t.slice(2)):e==254&&r==255?pS(t.slice(2)):e==65279?t.slice(1):t},s0=function(e){return String.fromCharCode(e)},ET=function(e){return String.fromCharCode(e)},cf,Rs="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function TT(t){for(var e="",r=0,n=0,i=0,o=0,c=0,u=0,h=0,d=0;d<t.length;)r=t.charCodeAt(d++),o=r>>2,n=t.charCodeAt(d++),c=(r&3)<<4|n>>4,i=t.charCodeAt(d++),u=(n&15)<<2|i>>6,h=i&63,isNaN(n)?u=h=64:isNaN(i)&&(h=64),e+=Rs.charAt(o)+Rs.charAt(c)+Rs.charAt(u)+Rs.charAt(h);return e}function Yn(t){var e="",r=0,n=0,i=0,o=0,c=0,u=0,h=0;t=t.replace(/[^\w\+\/\=]/g,"");for(var d=0;d<t.length;)o=Rs.indexOf(t.charAt(d++)),c=Rs.indexOf(t.charAt(d++)),r=o<<2|c>>4,e+=String.fromCharCode(r),u=Rs.indexOf(t.charAt(d++)),n=(c&15)<<4|u>>2,u!==64&&(e+=String.fromCharCode(n)),h=Rs.indexOf(t.charAt(d++)),i=(u&3)<<6|h,h!==64&&(e+=String.fromCharCode(i));return e}var wt=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),Qo=function(){if(typeof Buffer<"u"){var t=!Buffer.from;if(!t)try{Buffer.from("foo","utf8")}catch{t=!0}return t?function(e,r){return r?new Buffer(e,r):new Buffer(e)}:Buffer.from.bind(Buffer)}return function(){}}();function qs(t){return wt?Buffer.alloc?Buffer.alloc(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}function AT(t){return wt?Buffer.allocUnsafe?Buffer.allocUnsafe(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}var Ca=function(e){return wt?Qo(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)&255})};function Zo(t){if(Array.isArray(t))return t.map(function(n){return String.fromCharCode(n)}).join("");for(var e=[],r=0;r<t.length;++r)e[r]=String.fromCharCode(t[r]);return e.join("")}function X1(t){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(t instanceof ArrayBuffer)return X1(new Uint8Array(t));for(var e=new Array(t.length),r=0;r<t.length;++r)e[r]=t[r];return e}var ws=wt?function(t){return Buffer.concat(t.map(function(e){return Buffer.isBuffer(e)?e:Qo(e)}))}:function(t){if(typeof Uint8Array<"u"){var e=0,r=0;for(e=0;e<t.length;++e)r+=t[e].length;var n=new Uint8Array(r),i=0;for(e=0,r=0;e<t.length;r+=i,++e)if(i=t[e].length,t[e]instanceof Uint8Array)n.set(t[e],r);else{if(typeof t[e]=="string")throw"wtf";n.set(new Uint8Array(t[e]),r)}return n}return[].concat.apply([],t.map(function(o){return Array.isArray(o)?o:[].slice.call(o)}))};function W6(t){for(var e=[],r=0,n=t.length+250,i=qs(t.length+255),o=0;o<t.length;++o){var c=t.charCodeAt(o);if(c<128)i[r++]=c;else if(c<2048)i[r++]=192|c>>6&31,i[r++]=128|c&63;else if(c>=55296&&c<57344){c=(c&1023)+64;var u=t.charCodeAt(++o)&1023;i[r++]=240|c>>8&7,i[r++]=128|c>>2&63,i[r++]=128|u>>6&15|(c&3)<<4,i[r++]=128|u&63}else i[r++]=224|c>>12&15,i[r++]=128|c>>6&63,i[r++]=128|c&63;r>n&&(e.push(i.slice(0,r)),r=0,i=qs(65535),n=65530)}return e.push(i.slice(0,r)),ws(e)}var Sn=/\u0000/g,Ou=/[\u0001-\u0006]/g;function rc(t){for(var e="",r=t.length-1;r>=0;)e+=t.charAt(r--);return e}function ba(t,e){var r=""+t;return r.length>=e?r:ur("0",e-r.length)+r}function Y1(t,e){var r=""+t;return r.length>=e?r:ur(" ",e-r.length)+r}function W0(t,e){var r=""+t;return r.length>=e?r:r+ur(" ",e-r.length)}function X6(t,e){var r=""+Math.round(t);return r.length>=e?r:ur("0",e-r.length)+r}function Y6(t,e){var r=""+t;return r.length>=e?r:ur("0",e-r.length)+r}var wT=Math.pow(2,32);function Gl(t,e){if(t>wT||t<-wT)return X6(t,e);var r=Math.round(t);return Y6(r,e)}function X0(t,e){return e=e||0,t.length>=7+e&&(t.charCodeAt(e)|32)===103&&(t.charCodeAt(e+1)|32)===101&&(t.charCodeAt(e+2)|32)===110&&(t.charCodeAt(e+3)|32)===101&&(t.charCodeAt(e+4)|32)===114&&(t.charCodeAt(e+5)|32)===97&&(t.charCodeAt(e+6)|32)===108}var ST=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],Xm=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function $6(t){return t||(t={}),t[0]="General",t[1]="0",t[2]="0.00",t[3]="#,##0",t[4]="#,##0.00",t[9]="0%",t[10]="0.00%",t[11]="0.00E+00",t[12]="# ?/?",t[13]="# ??/??",t[14]="m/d/yy",t[15]="d-mmm-yy",t[16]="d-mmm",t[17]="mmm-yy",t[18]="h:mm AM/PM",t[19]="h:mm:ss AM/PM",t[20]="h:mm",t[21]="h:mm:ss",t[22]="m/d/yy h:mm",t[37]="#,##0 ;(#,##0)",t[38]="#,##0 ;[Red](#,##0)",t[39]="#,##0.00;(#,##0.00)",t[40]="#,##0.00;[Red](#,##0.00)",t[45]="mm:ss",t[46]="[h]:mm:ss",t[47]="mmss.0",t[48]="##0.0E+0",t[49]="@",t[56]='"上午/下午 "hh"時"mm"分"ss"秒 "',t}var ht={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"上午/下午 "hh"時"mm"分"ss"秒 "'},CT={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},Q6={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function Y0(t,e,r){for(var n=t<0?-1:1,i=t*n,o=0,c=1,u=0,h=1,d=0,g=0,_=Math.floor(i);d<e&&(_=Math.floor(i),u=_*c+o,g=_*d+h,!(i-_<5e-8));)i=1/(i-_),o=c,c=u,h=d,d=g;if(g>e&&(d>e?(g=h,u=o):(g=d,u=c)),!r)return[0,n*u,g];var x=Math.floor(n*u/g);return[x,n*u-x*g,g]}function No(t,e,r){if(t>2958465||t<0)return null;var n=t|0,i=Math.floor(86400*(t-n)),o=0,c=[],u={D:n,T:i,u:86400*(t-n)-i,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(u.u)<1e-6&&(u.u=0),e&&e.date1904&&(n+=1462),u.u>.9999&&(u.u=0,++i==86400&&(u.T=i=0,++n,++u.D)),n===60)c=r?[1317,10,29]:[1900,2,29],o=3;else if(n===0)c=r?[1317,8,29]:[1900,1,0],o=6;else{n>60&&--n;var h=new Date(1900,0,1);h.setDate(h.getDate()+n-1),c=[h.getFullYear(),h.getMonth()+1,h.getDate()],o=h.getDay(),n<60&&(o=(o+6)%7),r&&(o=nF(h,c))}return u.y=c[0],u.m=c[1],u.d=c[2],u.S=i%60,i=Math.floor(i/60),u.M=i%60,i=Math.floor(i/60),u.H=i,u.q=o,u}var mS=new Date(1899,11,31,0,0,0),Z6=mS.getTime(),J6=new Date(1900,2,1,0,0,0);function gS(t,e){var r=t.getTime();return e?r-=1461*24*60*60*1e3:t>=J6&&(r+=24*60*60*1e3),(r-(Z6+(t.getTimezoneOffset()-mS.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function $1(t){return t.indexOf(".")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function eF(t){return t.indexOf("E")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function tF(t){var e=t<0?12:11,r=$1(t.toFixed(12));return r.length<=e||(r=t.toPrecision(10),r.length<=e)?r:t.toExponential(5)}function rF(t){var e=$1(t.toFixed(11));return e.length>(t<0?12:11)||e==="0"||e==="-0"?t.toPrecision(6):e}function uf(t){var e=Math.floor(Math.log(Math.abs(t))*Math.LOG10E),r;return e>=-4&&e<=-1?r=t.toPrecision(10+e):Math.abs(e)<=9?r=tF(t):e===10?r=t.toFixed(10).substr(0,12):r=rF(t),$1(eF(r.toUpperCase()))}function zo(t,e){switch(typeof t){case"string":return t;case"boolean":return t?"TRUE":"FALSE";case"number":return(t|0)===t?t.toString(10):uf(t);case"undefined":return"";case"object":if(t==null)return"";if(t instanceof Date)return ga(14,gS(t,e&&e.date1904),e)}throw new Error("unsupported value in General format: "+t)}function nF(t,e){e[0]-=581;var r=t.getDay();return t<60&&(r=(r+6)%7),r}function aF(t,e,r,n){var i="",o=0,c=0,u=r.y,h,d=0;switch(t){case 98:u=r.y+543;case 121:switch(e.length){case 1:case 2:h=u%100,d=2;break;default:h=u%1e4,d=4;break}break;case 109:switch(e.length){case 1:case 2:h=r.m,d=e.length;break;case 3:return Xm[r.m-1][1];case 5:return Xm[r.m-1][0];default:return Xm[r.m-1][2]}break;case 100:switch(e.length){case 1:case 2:h=r.d,d=e.length;break;case 3:return ST[r.q][0];default:return ST[r.q][1]}break;case 104:switch(e.length){case 1:case 2:h=1+(r.H+11)%12,d=e.length;break;default:throw"bad hour format: "+e}break;case 72:switch(e.length){case 1:case 2:h=r.H,d=e.length;break;default:throw"bad hour format: "+e}break;case 77:switch(e.length){case 1:case 2:h=r.M,d=e.length;break;default:throw"bad minute format: "+e}break;case 115:if(e!="s"&&e!="ss"&&e!=".0"&&e!=".00"&&e!=".000")throw"bad second format: "+e;return r.u===0&&(e=="s"||e=="ss")?ba(r.S,e.length):(n>=2?c=n===3?1e3:100:c=n===1?10:1,o=Math.round(c*(r.S+r.u)),o>=60*c&&(o=0),e==="s"?o===0?"0":""+o/c:(i=ba(o,2+n),e==="ss"?i.substr(0,2):"."+i.substr(2,e.length-1)));case 90:switch(e){case"[h]":case"[hh]":h=r.D*24+r.H;break;case"[m]":case"[mm]":h=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":h=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+e}d=e.length===3?1:2;break;case 101:h=u,d=1;break}var g=d>0?ba(h,d):"";return g}function ks(t){var e=3;if(t.length<=e)return t;for(var r=t.length%e,n=t.substr(0,r);r!=t.length;r+=e)n+=(n.length>0?",":"")+t.substr(r,e);return n}var vS=/%/g;function iF(t,e,r){var n=e.replace(vS,""),i=e.length-n.length;return Pi(t,n,r*Math.pow(10,2*i))+ur("%",i)}function sF(t,e,r){for(var n=e.length-1;e.charCodeAt(n-1)===44;)--n;return Pi(t,e.substr(0,n),r/Math.pow(10,3*(e.length-n)))}function _S(t,e){var r,n=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+_S(t,-e);var i=t.indexOf(".");i===-1&&(i=t.indexOf("E"));var o=Math.floor(Math.log(e)*Math.LOG10E)%i;if(o<0&&(o+=i),r=(e/Math.pow(10,o)).toPrecision(n+1+(i+o)%i),r.indexOf("e")===-1){var c=Math.floor(Math.log(e)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(c-r.length+o):r+="E+"+(c-o);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,i)+"."+r.substr(2+i),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(u,h,d,g){return h+d+g.substr(0,(i+o)%i)+"."+g.substr(o)+"E"})}else r=e.toExponential(n);return t.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),t.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var xS=/# (\?+)( ?)\/( ?)(\d+)/;function oF(t,e,r){var n=parseInt(t[4],10),i=Math.round(e*n),o=Math.floor(i/n),c=i-o*n,u=n;return r+(o===0?"":""+o)+" "+(c===0?ur(" ",t[1].length+1+t[4].length):Y1(c,t[1].length)+t[2]+"/"+t[3]+ba(u,t[4].length))}function lF(t,e,r){return r+(e===0?"":""+e)+ur(" ",t[1].length+2+t[4].length)}var yS=/^#*0*\.([0#]+)/,ES=/\).*[0#]/,TS=/\(###\) ###\\?-####/;function Tn(t){for(var e="",r,n=0;n!=t.length;++n)switch(r=t.charCodeAt(n)){case 35:break;case 63:e+=" ";break;case 48:e+="0";break;default:e+=String.fromCharCode(r)}return e}function RT(t,e){var r=Math.pow(10,e);return""+Math.round(t*r)/r}function kT(t,e){var r=t-Math.floor(t),n=Math.pow(10,e);return e<(""+Math.round(r*n)).length?0:Math.round(r*n)}function cF(t,e){return e<(""+Math.round((t-Math.floor(t))*Math.pow(10,e))).length?1:0}function uF(t){return t<2147483647&&t>-2147483648?""+(t>=0?t|0:t-1|0):""+Math.floor(t)}function ua(t,e,r){if(t.charCodeAt(0)===40&&!e.match(ES)){var n=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?ua("n",n,r):"("+ua("n",n,-r)+")"}if(e.charCodeAt(e.length-1)===44)return sF(t,e,r);if(e.indexOf("%")!==-1)return iF(t,e,r);if(e.indexOf("E")!==-1)return _S(e,r);if(e.charCodeAt(0)===36)return"$"+ua(t,e.substr(e.charAt(1)==" "?2:1),r);var i,o,c,u,h=Math.abs(r),d=r<0?"-":"";if(e.match(/^00+$/))return d+Gl(h,e.length);if(e.match(/^[#?]+$/))return i=Gl(r,0),i==="0"&&(i=""),i.length>e.length?i:Tn(e.substr(0,e.length-i.length))+i;if(o=e.match(xS))return oF(o,h,d);if(e.match(/^#+0+$/))return d+Gl(h,e.length-e.indexOf("0"));if(o=e.match(yS))return i=RT(r,o[1].length).replace(/^([^\.]+)$/,"$1."+Tn(o[1])).replace(/\.$/,"."+Tn(o[1])).replace(/\.(\d*)$/,function(S,R){return"."+R+ur("0",Tn(o[1]).length-R.length)}),e.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),o=e.match(/^(0*)\.(#*)$/))return d+RT(h,o[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,o[1].length?"0.":".");if(o=e.match(/^#{1,3},##0(\.?)$/))return d+ks(Gl(h,0));if(o=e.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+ua(t,e,-r):ks(""+(Math.floor(r)+cF(r,o[1].length)))+"."+ba(kT(r,o[1].length),o[1].length);if(o=e.match(/^#,#*,#0/))return ua(t,e.replace(/^#,#*,/,""),r);if(o=e.match(/^([0#]+)(\\?-([0#]+))+$/))return i=rc(ua(t,e.replace(/[\\-]/g,""),r)),c=0,rc(rc(e.replace(/\\/g,"")).replace(/[0#]/g,function(S){return c<i.length?i.charAt(c++):S==="0"?"0":""}));if(e.match(TS))return i=ua(t,"##########",r),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var g="";if(o=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return c=Math.min(o[4].length,7),u=Y0(h,Math.pow(10,c)-1,!1),i=""+d,g=Pi("n",o[1],u[1]),g.charAt(g.length-1)==" "&&(g=g.substr(0,g.length-1)+"0"),i+=g+o[2]+"/"+o[3],g=W0(u[2],c),g.length<o[4].length&&(g=Tn(o[4].substr(o[4].length-g.length))+g),i+=g,i;if(o=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return c=Math.min(Math.max(o[1].length,o[4].length),7),u=Y0(h,Math.pow(10,c)-1,!0),d+(u[0]||(u[1]?"":"0"))+" "+(u[1]?Y1(u[1],c)+o[2]+"/"+o[3]+W0(u[2],c):ur(" ",2*c+1+o[2].length+o[3].length));if(o=e.match(/^[#0?]+$/))return i=Gl(r,0),e.length<=i.length?i:Tn(e.substr(0,e.length-i.length))+i;if(o=e.match(/^([#0?]+)\.([#0]+)$/)){i=""+r.toFixed(Math.min(o[2].length,10)).replace(/([^0])0+$/,"$1"),c=i.indexOf(".");var _=e.indexOf(".")-c,x=e.length-i.length-_;return Tn(e.substr(0,_)+i+e.substr(e.length-x))}if(o=e.match(/^00,000\.([#0]*0)$/))return c=kT(r,o[1].length),r<0?"-"+ua(t,e,-r):ks(uF(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(S){return"00,"+(S.length<3?ba(0,3-S.length):"")+S})+"."+ba(c,o[1].length);switch(e){case"###,##0.00":return ua(t,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var A=ks(Gl(h,0));return A!=="0"?d+A:"";case"###,###.00":return ua(t,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return ua(t,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+e+"|")}function fF(t,e,r){for(var n=e.length-1;e.charCodeAt(n-1)===44;)--n;return Pi(t,e.substr(0,n),r/Math.pow(10,3*(e.length-n)))}function hF(t,e,r){var n=e.replace(vS,""),i=e.length-n.length;return Pi(t,n,r*Math.pow(10,2*i))+ur("%",i)}function AS(t,e){var r,n=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+AS(t,-e);var i=t.indexOf(".");i===-1&&(i=t.indexOf("E"));var o=Math.floor(Math.log(e)*Math.LOG10E)%i;if(o<0&&(o+=i),r=(e/Math.pow(10,o)).toPrecision(n+1+(i+o)%i),!r.match(/[Ee]/)){var c=Math.floor(Math.log(e)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(c-r.length+o):r+="E+"+(c-o),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(u,h,d,g){return h+d+g.substr(0,(i+o)%i)+"."+g.substr(o)+"E"})}else r=e.toExponential(n);return t.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),t.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function Za(t,e,r){if(t.charCodeAt(0)===40&&!e.match(ES)){var n=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Za("n",n,r):"("+Za("n",n,-r)+")"}if(e.charCodeAt(e.length-1)===44)return fF(t,e,r);if(e.indexOf("%")!==-1)return hF(t,e,r);if(e.indexOf("E")!==-1)return AS(e,r);if(e.charCodeAt(0)===36)return"$"+Za(t,e.substr(e.charAt(1)==" "?2:1),r);var i,o,c,u,h=Math.abs(r),d=r<0?"-":"";if(e.match(/^00+$/))return d+ba(h,e.length);if(e.match(/^[#?]+$/))return i=""+r,r===0&&(i=""),i.length>e.length?i:Tn(e.substr(0,e.length-i.length))+i;if(o=e.match(xS))return lF(o,h,d);if(e.match(/^#+0+$/))return d+ba(h,e.length-e.indexOf("0"));if(o=e.match(yS))return i=(""+r).replace(/^([^\.]+)$/,"$1."+Tn(o[1])).replace(/\.$/,"."+Tn(o[1])),i=i.replace(/\.(\d*)$/,function(S,R){return"."+R+ur("0",Tn(o[1]).length-R.length)}),e.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),o=e.match(/^(0*)\.(#*)$/))return d+(""+h).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,o[1].length?"0.":".");if(o=e.match(/^#{1,3},##0(\.?)$/))return d+ks(""+h);if(o=e.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Za(t,e,-r):ks(""+r)+"."+ur("0",o[1].length);if(o=e.match(/^#,#*,#0/))return Za(t,e.replace(/^#,#*,/,""),r);if(o=e.match(/^([0#]+)(\\?-([0#]+))+$/))return i=rc(Za(t,e.replace(/[\\-]/g,""),r)),c=0,rc(rc(e.replace(/\\/g,"")).replace(/[0#]/g,function(S){return c<i.length?i.charAt(c++):S==="0"?"0":""}));if(e.match(TS))return i=Za(t,"##########",r),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var g="";if(o=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return c=Math.min(o[4].length,7),u=Y0(h,Math.pow(10,c)-1,!1),i=""+d,g=Pi("n",o[1],u[1]),g.charAt(g.length-1)==" "&&(g=g.substr(0,g.length-1)+"0"),i+=g+o[2]+"/"+o[3],g=W0(u[2],c),g.length<o[4].length&&(g=Tn(o[4].substr(o[4].length-g.length))+g),i+=g,i;if(o=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return c=Math.min(Math.max(o[1].length,o[4].length),7),u=Y0(h,Math.pow(10,c)-1,!0),d+(u[0]||(u[1]?"":"0"))+" "+(u[1]?Y1(u[1],c)+o[2]+"/"+o[3]+W0(u[2],c):ur(" ",2*c+1+o[2].length+o[3].length));if(o=e.match(/^[#0?]+$/))return i=""+r,e.length<=i.length?i:Tn(e.substr(0,e.length-i.length))+i;if(o=e.match(/^([#0]+)\.([#0]+)$/)){i=""+r.toFixed(Math.min(o[2].length,10)).replace(/([^0])0+$/,"$1"),c=i.indexOf(".");var _=e.indexOf(".")-c,x=e.length-i.length-_;return Tn(e.substr(0,_)+i+e.substr(e.length-x))}if(o=e.match(/^00,000\.([#0]*0)$/))return r<0?"-"+Za(t,e,-r):ks(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(S){return"00,"+(S.length<3?ba(0,3-S.length):"")+S})+"."+ba(0,o[1].length);switch(e){case"###,###":case"##,###":case"#,###":var A=ks(""+h);return A!=="0"?d+A:"";default:if(e.match(/\.[0#?]*$/))return Za(t,e.slice(0,e.lastIndexOf(".")),r)+Tn(e.slice(e.lastIndexOf(".")))}throw new Error("unsupported format |"+e+"|")}function Pi(t,e,r){return(r|0)===r?Za(t,e,r):ua(t,e,r)}function dF(t){for(var e=[],r=!1,n=0,i=0;n<t.length;++n)switch(t.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:e[e.length]=t.substr(i,n-i),i=n+1}if(e[e.length]=t.substr(i),r===!0)throw new Error("Format |"+t+"| unterminated string ");return e}var wS=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function Ac(t){for(var e=0,r="",n="";e<t.length;)switch(r=t.charAt(e)){case"G":X0(t,e)&&(e+=6),e++;break;case'"':for(;t.charCodeAt(++e)!==34&&e<t.length;);++e;break;case"\\":e+=2;break;case"_":e+=2;break;case"@":++e;break;case"B":case"b":if(t.charAt(e+1)==="1"||t.charAt(e+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"上":if(t.substr(e,3).toUpperCase()==="A/P"||t.substr(e,5).toUpperCase()==="AM/PM"||t.substr(e,5).toUpperCase()==="上午/下午")return!0;++e;break;case"[":for(n=r;t.charAt(e++)!=="]"&&e<t.length;)n+=t.charAt(e);if(n.match(wS))return!0;break;case".":case"0":case"#":for(;e<t.length&&("0#?.,E+-%".indexOf(r=t.charAt(++e))>-1||r=="\\"&&t.charAt(e+1)=="-"&&"0#".indexOf(t.charAt(e+2))>-1););break;case"?":for(;t.charAt(++e)===r;);break;case"*":++e,(t.charAt(e)==" "||t.charAt(e)=="*")&&++e;break;case"(":case")":++e;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;e<t.length&&"0123456789".indexOf(t.charAt(++e))>-1;);break;case" ":++e;break;default:++e;break}return!1}function pF(t,e,r,n){for(var i=[],o="",c=0,u="",h="t",d,g,_,x="H";c<t.length;)switch(u=t.charAt(c)){case"G":if(!X0(t,c))throw new Error("unrecognized character "+u+" in "+t);i[i.length]={t:"G",v:"General"},c+=7;break;case'"':for(o="";(_=t.charCodeAt(++c))!==34&&c<t.length;)o+=String.fromCharCode(_);i[i.length]={t:"t",v:o},++c;break;case"\\":var A=t.charAt(++c),S=A==="("||A===")"?A:"t";i[i.length]={t:S,v:A},++c;break;case"_":i[i.length]={t:"t",v:" "},c+=2;break;case"@":i[i.length]={t:"T",v:e},++c;break;case"B":case"b":if(t.charAt(c+1)==="1"||t.charAt(c+1)==="2"){if(d==null&&(d=No(e,r,t.charAt(c+1)==="2"),d==null))return"";i[i.length]={t:"X",v:t.substr(c,2)},h=u,c+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":u=u.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(e<0||d==null&&(d=No(e,r),d==null))return"";for(o=u;++c<t.length&&t.charAt(c).toLowerCase()===u;)o+=u;u==="m"&&h.toLowerCase()==="h"&&(u="M"),u==="h"&&(u=x),i[i.length]={t:u,v:o},h=u;break;case"A":case"a":case"上":var R={t:u,v:u};if(d==null&&(d=No(e,r)),t.substr(c,3).toUpperCase()==="A/P"?(d!=null&&(R.v=d.H>=12?"P":"A"),R.t="T",x="h",c+=3):t.substr(c,5).toUpperCase()==="AM/PM"?(d!=null&&(R.v=d.H>=12?"PM":"AM"),R.t="T",c+=5,x="h"):t.substr(c,5).toUpperCase()==="上午/下午"?(d!=null&&(R.v=d.H>=12?"下午":"上午"),R.t="T",c+=5,x="h"):(R.t="t",++c),d==null&&R.t==="T")return"";i[i.length]=R,h=u;break;case"[":for(o=u;t.charAt(c++)!=="]"&&c<t.length;)o+=t.charAt(c);if(o.slice(-1)!=="]")throw'unterminated "[" block: |'+o+"|";if(o.match(wS)){if(d==null&&(d=No(e,r),d==null))return"";i[i.length]={t:"Z",v:o.toLowerCase()},h=o.charAt(1)}else o.indexOf("$")>-1&&(o=(o.match(/\$([^-\[\]]*)/)||[])[1]||"$",Ac(t)||(i[i.length]={t:"t",v:o}));break;case".":if(d!=null){for(o=u;++c<t.length&&(u=t.charAt(c))==="0";)o+=u;i[i.length]={t:"s",v:o};break}case"0":case"#":for(o=u;++c<t.length&&"0#?.,E+-%".indexOf(u=t.charAt(c))>-1;)o+=u;i[i.length]={t:"n",v:o};break;case"?":for(o=u;t.charAt(++c)===u;)o+=u;i[i.length]={t:u,v:o},h=u;break;case"*":++c,(t.charAt(c)==" "||t.charAt(c)=="*")&&++c;break;case"(":case")":i[i.length]={t:n===1?"t":u,v:u},++c;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(o=u;c<t.length&&"0123456789".indexOf(t.charAt(++c))>-1;)o+=t.charAt(c);i[i.length]={t:"D",v:o};break;case" ":i[i.length]={t:u,v:u},++c;break;case"$":i[i.length]={t:"t",v:"$"},++c;break;default:if(",$-+/():!^&'~{}<>=€acfijklopqrtuvwxzP".indexOf(u)===-1)throw new Error("unrecognized character "+u+" in "+t);i[i.length]={t:"t",v:u},++c;break}var w=0,B=0,H;for(c=i.length-1,h="t";c>=0;--c)switch(i[c].t){case"h":case"H":i[c].t=x,h="h",w<1&&(w=1);break;case"s":(H=i[c].v.match(/\.0+$/))&&(B=Math.max(B,H[0].length-1)),w<3&&(w=3);case"d":case"y":case"M":case"e":h=i[c].t;break;case"m":h==="s"&&(i[c].t="M",w<2&&(w=2));break;case"X":break;case"Z":w<1&&i[c].v.match(/[Hh]/)&&(w=1),w<2&&i[c].v.match(/[Mm]/)&&(w=2),w<3&&i[c].v.match(/[Ss]/)&&(w=3)}switch(w){case 0:break;case 1:d.u>=.5&&(d.u=0,++d.S),d.S>=60&&(d.S=0,++d.M),d.M>=60&&(d.M=0,++d.H);break;case 2:d.u>=.5&&(d.u=0,++d.S),d.S>=60&&(d.S=0,++d.M);break}var N="",J;for(c=0;c<i.length;++c)switch(i[c].t){case"t":case"T":case" ":case"D":break;case"X":i[c].v="",i[c].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":i[c].v=aF(i[c].t.charCodeAt(0),i[c].v,d,B),i[c].t="t";break;case"n":case"?":for(J=c+1;i[J]!=null&&((u=i[J].t)==="?"||u==="D"||(u===" "||u==="t")&&i[J+1]!=null&&(i[J+1].t==="?"||i[J+1].t==="t"&&i[J+1].v==="/")||i[c].t==="("&&(u===" "||u==="n"||u===")")||u==="t"&&(i[J].v==="/"||i[J].v===" "&&i[J+1]!=null&&i[J+1].t=="?"));)i[c].v+=i[J].v,i[J]={v:"",t:";"},++J;N+=i[c].v,c=J-1;break;case"G":i[c].t="t",i[c].v=zo(e,r);break}var re="",ne,C;if(N.length>0){N.charCodeAt(0)==40?(ne=e<0&&N.charCodeAt(0)===45?-e:e,C=Pi("n",N,ne)):(ne=e<0&&n>1?-e:e,C=Pi("n",N,ne),ne<0&&i[0]&&i[0].t=="t"&&(C=C.substr(1),i[0].v="-"+i[0].v)),J=C.length-1;var T=i.length;for(c=0;c<i.length;++c)if(i[c]!=null&&i[c].t!="t"&&i[c].v.indexOf(".")>-1){T=c;break}var E=i.length;if(T===i.length&&C.indexOf("E")===-1){for(c=i.length-1;c>=0;--c)i[c]==null||"n?".indexOf(i[c].t)===-1||(J>=i[c].v.length-1?(J-=i[c].v.length,i[c].v=C.substr(J+1,i[c].v.length)):J<0?i[c].v="":(i[c].v=C.substr(0,J+1),J=-1),i[c].t="t",E=c);J>=0&&E<i.length&&(i[E].v=C.substr(0,J+1)+i[E].v)}else if(T!==i.length&&C.indexOf("E")===-1){for(J=C.indexOf(".")-1,c=T;c>=0;--c)if(!(i[c]==null||"n?".indexOf(i[c].t)===-1)){for(g=i[c].v.indexOf(".")>-1&&c===T?i[c].v.indexOf(".")-1:i[c].v.length-1,re=i[c].v.substr(g+1);g>=0;--g)J>=0&&(i[c].v.charAt(g)==="0"||i[c].v.charAt(g)==="#")&&(re=C.charAt(J--)+re);i[c].v=re,i[c].t="t",E=c}for(J>=0&&E<i.length&&(i[E].v=C.substr(0,J+1)+i[E].v),J=C.indexOf(".")+1,c=T;c<i.length;++c)if(!(i[c]==null||"n?(".indexOf(i[c].t)===-1&&c!==T)){for(g=i[c].v.indexOf(".")>-1&&c===T?i[c].v.indexOf(".")+1:0,re=i[c].v.substr(0,g);g<i[c].v.length;++g)J<C.length&&(re+=C.charAt(J++));i[c].v=re,i[c].t="t",E=c}}}for(c=0;c<i.length;++c)i[c]!=null&&"n?".indexOf(i[c].t)>-1&&(ne=n>1&&e<0&&c>0&&i[c-1].v==="-"?-e:e,i[c].v=Pi(i[c].t,i[c].v,ne),i[c].t="t");var D="";for(c=0;c!==i.length;++c)i[c]!=null&&(D+=i[c].v);return D}var bT=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function IT(t,e){if(e==null)return!1;var r=parseFloat(e[2]);switch(e[1]){case"=":if(t==r)return!0;break;case">":if(t>r)return!0;break;case"<":if(t<r)return!0;break;case"<>":if(t!=r)return!0;break;case">=":if(t>=r)return!0;break;case"<=":if(t<=r)return!0;break}return!1}function mF(t,e){var r=dF(t),n=r.length,i=r[n-1].indexOf("@");if(n<4&&i>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof e!="number")return[4,r.length===4||i>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=i>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=i>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=i>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var o=e>0?r[0]:e<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,o];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var c=r[0].match(bT),u=r[1].match(bT);return IT(e,c)?[n,r[0]]:IT(e,u)?[n,r[1]]:[n,r[c!=null&&u!=null?2:1]]}return[n,o]}function ga(t,e,r){r==null&&(r={});var n="";switch(typeof t){case"string":t=="m/d/yy"&&r.dateNF?n=r.dateNF:n=t;break;case"number":t==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:ht)[t],n==null&&(n=r.table&&r.table[CT[t]]||ht[CT[t]]),n==null&&(n=Q6[t]||"General");break}if(X0(n,0))return zo(e,r);e instanceof Date&&(e=gS(e,r.date1904));var i=mF(n,e);if(X0(i[1]))return zo(e,r);if(e===!0)e="TRUE";else if(e===!1)e="FALSE";else if(e===""||e==null)return"";return pF(i[1],e,r,i[0])}function Po(t,e){if(typeof e!="number"){e=+e||-1;for(var r=0;r<392;++r){if(ht[r]==null){e<0&&(e=r);continue}if(ht[r]==t){e=r;break}}e<0&&(e=391)}return ht[e]=t,e}function SS(){ht=$6()}var gF={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},CS=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function vF(t){var e=typeof t=="number"?ht[t]:t;return e=e.replace(CS,"(\\d+)"),new RegExp("^"+e+"$")}function _F(t,e,r){var n=-1,i=-1,o=-1,c=-1,u=-1,h=-1;(e.match(CS)||[]).forEach(function(_,x){var A=parseInt(r[x+1],10);switch(_.toLowerCase().charAt(0)){case"y":n=A;break;case"d":o=A;break;case"h":c=A;break;case"s":h=A;break;case"m":c>=0?u=A:i=A;break}}),h>=0&&u==-1&&i>=0&&(u=i,i=-1);var d=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(i>=1?i:1)).slice(-2)+"-"+("00"+(o>=1?o:1)).slice(-2);d.length==7&&(d="0"+d),d.length==8&&(d="20"+d);var g=("00"+(c>=0?c:0)).slice(-2)+":"+("00"+(u>=0?u:0)).slice(-2)+":"+("00"+(h>=0?h:0)).slice(-2);return c==-1&&u==-1&&h==-1?d:n==-1&&i==-1&&o==-1?g:d+"T"+g}var xF=function(){var t={};t.version="1.2.0";function e(){for(var C=0,T=new Array(256),E=0;E!=256;++E)C=E,C=C&1?-306674912^C>>>1:C>>>1,C=C&1?-306674912^C>>>1:C>>>1,C=C&1?-306674912^C>>>1:C>>>1,C=C&1?-306674912^C>>>1:C>>>1,C=C&1?-306674912^C>>>1:C>>>1,C=C&1?-306674912^C>>>1:C>>>1,C=C&1?-306674912^C>>>1:C>>>1,C=C&1?-306674912^C>>>1:C>>>1,T[E]=C;return typeof Int32Array<"u"?new Int32Array(T):T}var r=e();function n(C){var T=0,E=0,D=0,b=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(D=0;D!=256;++D)b[D]=C[D];for(D=0;D!=256;++D)for(E=C[D],T=256+D;T<4096;T+=256)E=b[T]=E>>>8^C[E&255];var O=[];for(D=1;D!=16;++D)O[D-1]=typeof Int32Array<"u"?b.subarray(D*256,D*256+256):b.slice(D*256,D*256+256);return O}var i=n(r),o=i[0],c=i[1],u=i[2],h=i[3],d=i[4],g=i[5],_=i[6],x=i[7],A=i[8],S=i[9],R=i[10],w=i[11],B=i[12],H=i[13],N=i[14];function J(C,T){for(var E=T^-1,D=0,b=C.length;D<b;)E=E>>>8^r[(E^C.charCodeAt(D++))&255];return~E}function re(C,T){for(var E=T^-1,D=C.length-15,b=0;b<D;)E=N[C[b++]^E&255]^H[C[b++]^E>>8&255]^B[C[b++]^E>>16&255]^w[C[b++]^E>>>24]^R[C[b++]]^S[C[b++]]^A[C[b++]]^x[C[b++]]^_[C[b++]]^g[C[b++]]^d[C[b++]]^h[C[b++]]^u[C[b++]]^c[C[b++]]^o[C[b++]]^r[C[b++]];for(D+=15;b<D;)E=E>>>8^r[(E^C[b++])&255];return~E}function ne(C,T){for(var E=T^-1,D=0,b=C.length,O=0,F=0;D<b;)O=C.charCodeAt(D++),O<128?E=E>>>8^r[(E^O)&255]:O<2048?(E=E>>>8^r[(E^(192|O>>6&31))&255],E=E>>>8^r[(E^(128|O&63))&255]):O>=55296&&O<57344?(O=(O&1023)+64,F=C.charCodeAt(D++)&1023,E=E>>>8^r[(E^(240|O>>8&7))&255],E=E>>>8^r[(E^(128|O>>2&63))&255],E=E>>>8^r[(E^(128|F>>6&15|(O&3)<<4))&255],E=E>>>8^r[(E^(128|F&63))&255]):(E=E>>>8^r[(E^(224|O>>12&15))&255],E=E>>>8^r[(E^(128|O>>6&63))&255],E=E>>>8^r[(E^(128|O&63))&255]);return~E}return t.table=r,t.bstr=J,t.buf=re,t.str=ne,t}(),Dt=function(){var e={};e.version="1.2.1";function r(P,W){for(var U=P.split("/"),j=W.split("/"),q=0,Y=0,de=Math.min(U.length,j.length);q<de;++q){if(Y=U[q].length-j[q].length)return Y;if(U[q]!=j[q])return U[q]<j[q]?-1:1}return U.length-j.length}function n(P){if(P.charAt(P.length-1)=="/")return P.slice(0,-1).indexOf("/")===-1?P:n(P.slice(0,-1));var W=P.lastIndexOf("/");return W===-1?P:P.slice(0,W+1)}function i(P){if(P.charAt(P.length-1)=="/")return i(P.slice(0,-1));var W=P.lastIndexOf("/");return W===-1?P:P.slice(W+1)}function o(P,W){typeof W=="string"&&(W=new Date(W));var U=W.getHours();U=U<<6|W.getMinutes(),U=U<<5|W.getSeconds()>>>1,P.write_shift(2,U);var j=W.getFullYear()-1980;j=j<<4|W.getMonth()+1,j=j<<5|W.getDate(),P.write_shift(2,j)}function c(P){var W=P.read_shift(2)&65535,U=P.read_shift(2)&65535,j=new Date,q=U&31;U>>>=5;var Y=U&15;U>>>=4,j.setMilliseconds(0),j.setFullYear(U+1980),j.setMonth(Y-1),j.setDate(q);var de=W&31;W>>>=5;var xe=W&63;return W>>>=6,j.setHours(W),j.setMinutes(xe),j.setSeconds(de<<1),j}function u(P){Zr(P,0);for(var W={},U=0;P.l<=P.length-4;){var j=P.read_shift(2),q=P.read_shift(2),Y=P.l+q,de={};switch(j){case 21589:U=P.read_shift(1),U&1&&(de.mtime=P.read_shift(4)),q>5&&(U&2&&(de.atime=P.read_shift(4)),U&4&&(de.ctime=P.read_shift(4))),de.mtime&&(de.mt=new Date(de.mtime*1e3));break}P.l=Y,W[j]=de}return W}var h;function d(){return h||(h={})}function g(P,W){if(P[0]==80&&P[1]==75)return Wi(P,W);if((P[0]|32)==109&&(P[1]|32)==105)return al(P,W);if(P.length<512)throw new Error("CFB file size "+P.length+" < 512");var U=3,j=512,q=0,Y=0,de=0,xe=0,ce=0,me=[],ge=P.slice(0,512);Zr(ge,0);var Ne=_(ge);switch(U=Ne[0],U){case 3:j=512;break;case 4:j=4096;break;case 0:if(Ne[1]==0)return Wi(P,W);default:throw new Error("Major Version: Expected 3 or 4 saw "+U)}j!==512&&(ge=P.slice(0,j),Zr(ge,28));var Le=P.slice(0,j);x(ge,U);var ze=ge.read_shift(4,"i");if(U===3&&ze!==0)throw new Error("# Directory Sectors: Expected 0 saw "+ze);ge.l+=4,de=ge.read_shift(4,"i"),ge.l+=4,ge.chk("00100000","Mini Stream Cutoff Size: "),xe=ge.read_shift(4,"i"),q=ge.read_shift(4,"i"),ce=ge.read_shift(4,"i"),Y=ge.read_shift(4,"i");for(var Me=-1,je=0;je<109&&(Me=ge.read_shift(4,"i"),!(Me<0));++je)me[je]=Me;var at=A(P,j);w(ce,Y,at,j,me);var Pt=H(at,de,me,j);Pt[de].name="!Directory",q>0&&xe!==F&&(Pt[xe].name="!MiniFAT"),Pt[me[0]].name="!FAT",Pt.fat_addrs=me,Pt.ssz=j;var St={},Ct=[],Mn=[],La=[];N(de,Pt,at,Ct,q,St,Mn,xe),S(Mn,La,Ct),Ct.shift();var vn={FileIndex:Mn,FullPaths:La};return W&&W.raw&&(vn.raw={header:Le,sectors:at}),vn}function _(P){if(P[P.l]==80&&P[P.l+1]==75)return[0,0];P.chk(Fe,"Header Signature: "),P.l+=16;var W=P.read_shift(2,"u");return[P.read_shift(2,"u"),W]}function x(P,W){var U=9;switch(P.l+=2,U=P.read_shift(2)){case 9:if(W!=3)throw new Error("Sector Shift: Expected 9 saw "+U);break;case 12:if(W!=4)throw new Error("Sector Shift: Expected 12 saw "+U);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+U)}P.chk("0600","Mini Sector Shift: "),P.chk("000000000000","Reserved: ")}function A(P,W){for(var U=Math.ceil(P.length/W)-1,j=[],q=1;q<U;++q)j[q-1]=P.slice(q*W,(q+1)*W);return j[U-1]=P.slice(U*W),j}function S(P,W,U){for(var j=0,q=0,Y=0,de=0,xe=0,ce=U.length,me=[],ge=[];j<ce;++j)me[j]=ge[j]=j,W[j]=U[j];for(;xe<ge.length;++xe)j=ge[xe],q=P[j].L,Y=P[j].R,de=P[j].C,me[j]===j&&(q!==-1&&me[q]!==q&&(me[j]=me[q]),Y!==-1&&me[Y]!==Y&&(me[j]=me[Y])),de!==-1&&(me[de]=j),q!==-1&&j!=me[j]&&(me[q]=me[j],ge.lastIndexOf(q)<xe&&ge.push(q)),Y!==-1&&j!=me[j]&&(me[Y]=me[j],ge.lastIndexOf(Y)<xe&&ge.push(Y));for(j=1;j<ce;++j)me[j]===j&&(Y!==-1&&me[Y]!==Y?me[j]=me[Y]:q!==-1&&me[q]!==q&&(me[j]=me[q]));for(j=1;j<ce;++j)if(P[j].type!==0){if(xe=j,xe!=me[xe])do xe=me[xe],W[j]=W[xe]+"/"+W[j];while(xe!==0&&me[xe]!==-1&&xe!=me[xe]);me[j]=-1}for(W[0]+="/",j=1;j<ce;++j)P[j].type!==2&&(W[j]+="/")}function R(P,W,U){for(var j=P.start,q=P.size,Y=[],de=j;U&&q>0&&de>=0;)Y.push(W.slice(de*O,de*O+O)),q-=O,de=Io(U,de*4);return Y.length===0?Fr(0):ws(Y).slice(0,P.size)}function w(P,W,U,j,q){var Y=F;if(P===F){if(W!==0)throw new Error("DIFAT chain shorter than expected")}else if(P!==-1){var de=U[P],xe=(j>>>2)-1;if(!de)return;for(var ce=0;ce<xe&&(Y=Io(de,ce*4))!==F;++ce)q.push(Y);w(Io(de,j-4),W-1,U,j,q)}}function B(P,W,U,j,q){var Y=[],de=[];q||(q=[]);var xe=j-1,ce=0,me=0;for(ce=W;ce>=0;){q[ce]=!0,Y[Y.length]=ce,de.push(P[ce]);var ge=U[Math.floor(ce*4/j)];if(me=ce*4&xe,j<4+me)throw new Error("FAT boundary crossed: "+ce+" 4 "+j);if(!P[ge])break;ce=Io(P[ge],me)}return{nodes:Y,data:BT([de])}}function H(P,W,U,j){var q=P.length,Y=[],de=[],xe=[],ce=[],me=j-1,ge=0,Ne=0,Le=0,ze=0;for(ge=0;ge<q;++ge)if(xe=[],Le=ge+W,Le>=q&&(Le-=q),!de[Le]){ce=[];var Me=[];for(Ne=Le;Ne>=0;){Me[Ne]=!0,de[Ne]=!0,xe[xe.length]=Ne,ce.push(P[Ne]);var je=U[Math.floor(Ne*4/j)];if(ze=Ne*4&me,j<4+ze)throw new Error("FAT boundary crossed: "+Ne+" 4 "+j);if(!P[je]||(Ne=Io(P[je],ze),Me[Ne]))break}Y[Le]={nodes:xe,data:BT([ce])}}return Y}function N(P,W,U,j,q,Y,de,xe){for(var ce=0,me=j.length?2:0,ge=W[P].data,Ne=0,Le=0,ze;Ne<ge.length;Ne+=128){var Me=ge.slice(Ne,Ne+128);Zr(Me,64),Le=Me.read_shift(2),ze=ev(Me,0,Le-me),j.push(ze);var je={name:ze,type:Me.read_shift(1),color:Me.read_shift(1),L:Me.read_shift(4,"i"),R:Me.read_shift(4,"i"),C:Me.read_shift(4,"i"),clsid:Me.read_shift(16),state:Me.read_shift(4,"i"),start:0,size:0},at=Me.read_shift(2)+Me.read_shift(2)+Me.read_shift(2)+Me.read_shift(2);at!==0&&(je.ct=J(Me,Me.l-8));var Pt=Me.read_shift(2)+Me.read_shift(2)+Me.read_shift(2)+Me.read_shift(2);Pt!==0&&(je.mt=J(Me,Me.l-8)),je.start=Me.read_shift(4,"i"),je.size=Me.read_shift(4,"i"),je.size<0&&je.start<0&&(je.size=je.type=0,je.start=F,je.name=""),je.type===5?(ce=je.start,q>0&&ce!==F&&(W[ce].name="!StreamData")):je.size>=4096?(je.storage="fat",W[je.start]===void 0&&(W[je.start]=B(U,je.start,W.fat_addrs,W.ssz)),W[je.start].name=je.name,je.content=W[je.start].data.slice(0,je.size)):(je.storage="minifat",je.size<0?je.size=0:ce!==F&&je.start!==F&&W[ce]&&(je.content=R(je,W[ce].data,(W[xe]||{}).data))),je.content&&Zr(je.content,0),Y[ze]=je,de.push(je)}}function J(P,W){return new Date((qn(P,W+4)/1e7*Math.pow(2,32)+qn(P,W)/1e7-11644473600)*1e3)}function re(P,W){return d(),g(h.readFileSync(P),W)}function ne(P,W){var U=W&&W.type;switch(U||wt&&Buffer.isBuffer(P)&&(U="buffer"),U||"base64"){case"file":return re(P,W);case"base64":return g(Ca(Yn(P)),W);case"binary":return g(Ca(P),W)}return g(P,W)}function C(P,W){var U=W||{},j=U.root||"Root Entry";if(P.FullPaths||(P.FullPaths=[]),P.FileIndex||(P.FileIndex=[]),P.FullPaths.length!==P.FileIndex.length)throw new Error("inconsistent CFB structure");P.FullPaths.length===0&&(P.FullPaths[0]=j+"/",P.FileIndex[0]={name:j,type:5}),U.CLSID&&(P.FileIndex[0].clsid=U.CLSID),T(P)}function T(P){var W="Sh33tJ5";if(!Dt.find(P,"/"+W)){var U=Fr(4);U[0]=55,U[1]=U[3]=50,U[2]=54,P.FileIndex.push({name:W,type:2,content:U,size:4,L:69,R:69,C:69}),P.FullPaths.push(P.FullPaths[0]+W),E(P)}}function E(P,W){C(P);for(var U=!1,j=!1,q=P.FullPaths.length-1;q>=0;--q){var Y=P.FileIndex[q];switch(Y.type){case 0:j?U=!0:(P.FileIndex.pop(),P.FullPaths.pop());break;case 1:case 2:case 5:j=!0,isNaN(Y.R*Y.L*Y.C)&&(U=!0),Y.R>-1&&Y.L>-1&&Y.R==Y.L&&(U=!0);break;default:U=!0;break}}if(!(!U&&!W)){var de=new Date(1987,1,19),xe=0,ce=Object.create?Object.create(null):{},me=[];for(q=0;q<P.FullPaths.length;++q)ce[P.FullPaths[q]]=!0,P.FileIndex[q].type!==0&&me.push([P.FullPaths[q],P.FileIndex[q]]);for(q=0;q<me.length;++q){var ge=n(me[q][0]);j=ce[ge],j||(me.push([ge,{name:i(ge).replace("/",""),type:1,clsid:ae,ct:de,mt:de,content:null}]),ce[ge]=!0)}for(me.sort(function(ze,Me){return r(ze[0],Me[0])}),P.FullPaths=[],P.FileIndex=[],q=0;q<me.length;++q)P.FullPaths[q]=me[q][0],P.FileIndex[q]=me[q][1];for(q=0;q<me.length;++q){var Ne=P.FileIndex[q],Le=P.FullPaths[q];if(Ne.name=i(Le).replace("/",""),Ne.L=Ne.R=Ne.C=-(Ne.color=1),Ne.size=Ne.content?Ne.content.length:0,Ne.start=0,Ne.clsid=Ne.clsid||ae,q===0)Ne.C=me.length>1?1:-1,Ne.size=0,Ne.type=5;else if(Le.slice(-1)=="/"){for(xe=q+1;xe<me.length&&n(P.FullPaths[xe])!=Le;++xe);for(Ne.C=xe>=me.length?-1:xe,xe=q+1;xe<me.length&&n(P.FullPaths[xe])!=n(Le);++xe);Ne.R=xe>=me.length?-1:xe,Ne.type=1}else n(P.FullPaths[q+1]||"")==n(Le)&&(Ne.R=q+1),Ne.type=2}}}function D(P,W){var U=W||{};if(U.fileType=="mad")return $t(P,U);switch(E(P),U.fileType){case"zip":return xa(P,U)}var j=function(ze){for(var Me=0,je=0,at=0;at<ze.FileIndex.length;++at){var Pt=ze.FileIndex[at];if(Pt.content){var St=Pt.content.length;St>0&&(St<4096?Me+=St+63>>6:je+=St+511>>9)}}for(var Ct=ze.FullPaths.length+3>>2,Mn=Me+7>>3,La=Me+127>>7,vn=Mn+je+Ct+La,kn=vn+127>>7,Va=kn<=109?0:Math.ceil((kn-109)/127);vn+kn+Va+127>>7>kn;)Va=++kn<=109?0:Math.ceil((kn-109)/127);var _n=[1,Va,kn,La,Ct,je,Me,0];return ze.FileIndex[0].size=Me<<6,_n[7]=(ze.FileIndex[0].start=_n[0]+_n[1]+_n[2]+_n[3]+_n[4]+_n[5])+(_n[6]+7>>3),_n}(P),q=Fr(j[7]<<9),Y=0,de=0;{for(Y=0;Y<8;++Y)q.write_shift(1,Ce[Y]);for(Y=0;Y<8;++Y)q.write_shift(2,0);for(q.write_shift(2,62),q.write_shift(2,3),q.write_shift(2,65534),q.write_shift(2,9),q.write_shift(2,6),Y=0;Y<3;++Y)q.write_shift(2,0);for(q.write_shift(4,0),q.write_shift(4,j[2]),q.write_shift(4,j[0]+j[1]+j[2]+j[3]-1),q.write_shift(4,0),q.write_shift(4,4096),q.write_shift(4,j[3]?j[0]+j[1]+j[2]-1:F),q.write_shift(4,j[3]),q.write_shift(-4,j[1]?j[0]-1:F),q.write_shift(4,j[1]),Y=0;Y<109;++Y)q.write_shift(-4,Y<j[2]?j[1]+Y:-1)}if(j[1])for(de=0;de<j[1];++de){for(;Y<236+de*127;++Y)q.write_shift(-4,Y<j[2]?j[1]+Y:-1);q.write_shift(-4,de===j[1]-1?F:de+1)}var xe=function(ze){for(de+=ze;Y<de-1;++Y)q.write_shift(-4,Y+1);ze&&(++Y,q.write_shift(-4,F))};for(de=Y=0,de+=j[1];Y<de;++Y)q.write_shift(-4,oe.DIFSECT);for(de+=j[2];Y<de;++Y)q.write_shift(-4,oe.FATSECT);xe(j[3]),xe(j[4]);for(var ce=0,me=0,ge=P.FileIndex[0];ce<P.FileIndex.length;++ce)ge=P.FileIndex[ce],ge.content&&(me=ge.content.length,!(me<4096)&&(ge.start=de,xe(me+511>>9)));for(xe(j[6]+7>>3);q.l&511;)q.write_shift(-4,oe.ENDOFCHAIN);for(de=Y=0,ce=0;ce<P.FileIndex.length;++ce)ge=P.FileIndex[ce],ge.content&&(me=ge.content.length,!(!me||me>=4096)&&(ge.start=de,xe(me+63>>6)));for(;q.l&511;)q.write_shift(-4,oe.ENDOFCHAIN);for(Y=0;Y<j[4]<<2;++Y){var Ne=P.FullPaths[Y];if(!Ne||Ne.length===0){for(ce=0;ce<17;++ce)q.write_shift(4,0);for(ce=0;ce<3;++ce)q.write_shift(4,-1);for(ce=0;ce<12;++ce)q.write_shift(4,0);continue}ge=P.FileIndex[Y],Y===0&&(ge.start=ge.size?ge.start-1:F);var Le=Y===0&&U.root||ge.name;if(me=2*(Le.length+1),q.write_shift(64,Le,"utf16le"),q.write_shift(2,me),q.write_shift(1,ge.type),q.write_shift(1,ge.color),q.write_shift(-4,ge.L),q.write_shift(-4,ge.R),q.write_shift(-4,ge.C),ge.clsid)q.write_shift(16,ge.clsid,"hex");else for(ce=0;ce<4;++ce)q.write_shift(4,0);q.write_shift(4,ge.state||0),q.write_shift(4,0),q.write_shift(4,0),q.write_shift(4,0),q.write_shift(4,0),q.write_shift(4,ge.start),q.write_shift(4,ge.size),q.write_shift(4,0)}for(Y=1;Y<P.FileIndex.length;++Y)if(ge=P.FileIndex[Y],ge.size>=4096)if(q.l=ge.start+1<<9,wt&&Buffer.isBuffer(ge.content))ge.content.copy(q,q.l,0,ge.size),q.l+=ge.size+511&-512;else{for(ce=0;ce<ge.size;++ce)q.write_shift(1,ge.content[ce]);for(;ce&511;++ce)q.write_shift(1,0)}for(Y=1;Y<P.FileIndex.length;++Y)if(ge=P.FileIndex[Y],ge.size>0&&ge.size<4096)if(wt&&Buffer.isBuffer(ge.content))ge.content.copy(q,q.l,0,ge.size),q.l+=ge.size+63&-64;else{for(ce=0;ce<ge.size;++ce)q.write_shift(1,ge.content[ce]);for(;ce&63;++ce)q.write_shift(1,0)}if(wt)q.l=q.length;else for(;q.l<q.length;)q.write_shift(1,0);return q}function b(P,W){var U=P.FullPaths.map(function(ce){return ce.toUpperCase()}),j=U.map(function(ce){var me=ce.split("/");return me[me.length-(ce.slice(-1)=="/"?2:1)]}),q=!1;W.charCodeAt(0)===47?(q=!0,W=U[0].slice(0,-1)+W):q=W.indexOf("/")!==-1;var Y=W.toUpperCase(),de=q===!0?U.indexOf(Y):j.indexOf(Y);if(de!==-1)return P.FileIndex[de];var xe=!Y.match(Ou);for(Y=Y.replace(Sn,""),xe&&(Y=Y.replace(Ou,"!")),de=0;de<U.length;++de)if((xe?U[de].replace(Ou,"!"):U[de]).replace(Sn,"")==Y||(xe?j[de].replace(Ou,"!"):j[de]).replace(Sn,"")==Y)return P.FileIndex[de];return null}var O=64,F=-2,Fe="d0cf11e0a1b11ae1",Ce=[208,207,17,224,161,177,26,225],ae="00000000000000000000000000000000",oe={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:F,FREESECT:-1,HEADER_SIGNATURE:Fe,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:ae,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function Oe(P,W,U){d();var j=D(P,U);h.writeFileSync(W,j)}function te(P){for(var W=new Array(P.length),U=0;U<P.length;++U)W[U]=String.fromCharCode(P[U]);return W.join("")}function G(P,W){var U=D(P,W);switch(W&&W.type||"buffer"){case"file":return d(),h.writeFileSync(W.filename,U),U;case"binary":return typeof U=="string"?U:te(U);case"base64":return TT(typeof U=="string"?U:te(U));case"buffer":if(wt)return Buffer.isBuffer(U)?U:Qo(U);case"array":return typeof U=="string"?Ca(U):U}return U}var se;function M(P){try{var W=P.InflateRaw,U=new W;if(U._processChunk(new Uint8Array([3,0]),U._finishFlushFlag),U.bytesRead)se=P;else throw new Error("zlib does not expose bytesRead")}catch(j){console.error("cannot use native zlib: "+(j.message||j))}}function z(P,W){if(!se)return qi(P,W);var U=se.InflateRaw,j=new U,q=j._processChunk(P.slice(P.l),j._finishFlushFlag);return P.l+=j.bytesRead,q}function Q(P){return se?se.deflateRawSync(P):ot(P)}var Z=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],ue=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],De=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function Ee(P){var W=(P<<1|P<<11)&139536|(P<<5|P<<15)&558144;return(W>>16|W>>8|W)&255}for(var we=typeof Uint8Array<"u",Te=we?new Uint8Array(256):[],Ue=0;Ue<256;++Ue)Te[Ue]=Ee(Ue);function X(P,W){var U=Te[P&255];return W<=8?U>>>8-W:(U=U<<8|Te[P>>8&255],W<=16?U>>>16-W:(U=U<<8|Te[P>>16&255],U>>>24-W))}function nt(P,W){var U=W&7,j=W>>>3;return(P[j]|(U<=6?0:P[j+1]<<8))>>>U&3}function qe(P,W){var U=W&7,j=W>>>3;return(P[j]|(U<=5?0:P[j+1]<<8))>>>U&7}function We(P,W){var U=W&7,j=W>>>3;return(P[j]|(U<=4?0:P[j+1]<<8))>>>U&15}function Be(P,W){var U=W&7,j=W>>>3;return(P[j]|(U<=3?0:P[j+1]<<8))>>>U&31}function Pe(P,W){var U=W&7,j=W>>>3;return(P[j]|(U<=1?0:P[j+1]<<8))>>>U&127}function Ye(P,W,U){var j=W&7,q=W>>>3,Y=(1<<U)-1,de=P[q]>>>j;return U<8-j||(de|=P[q+1]<<8-j,U<16-j)||(de|=P[q+2]<<16-j,U<24-j)||(de|=P[q+3]<<24-j),de&Y}function ut(P,W,U){var j=W&7,q=W>>>3;return j<=5?P[q]|=(U&7)<<j:(P[q]|=U<<j&255,P[q+1]=(U&7)>>8-j),W+3}function _t(P,W,U){var j=W&7,q=W>>>3;return U=(U&1)<<j,P[q]|=U,W+1}function rr(P,W,U){var j=W&7,q=W>>>3;return U<<=j,P[q]|=U&255,U>>>=8,P[q+1]=U,W+8}function yr(P,W,U){var j=W&7,q=W>>>3;return U<<=j,P[q]|=U&255,U>>>=8,P[q+1]=U&255,P[q+2]=U>>>8,W+16}function fr(P,W){var U=P.length,j=2*U>W?2*U:W+5,q=0;if(U>=W)return P;if(wt){var Y=AT(j);if(P.copy)P.copy(Y);else for(;q<P.length;++q)Y[q]=P[q];return Y}else if(we){var de=new Uint8Array(j);if(de.set)de.set(P);else for(;q<U;++q)de[q]=P[q];return de}return P.length=j,P}function Et(P){for(var W=new Array(P),U=0;U<P;++U)W[U]=0;return W}function er(P,W,U){var j=1,q=0,Y=0,de=0,xe=0,ce=P.length,me=we?new Uint16Array(32):Et(32);for(Y=0;Y<32;++Y)me[Y]=0;for(Y=ce;Y<U;++Y)P[Y]=0;ce=P.length;var ge=we?new Uint16Array(ce):Et(ce);for(Y=0;Y<ce;++Y)me[q=P[Y]]++,j<q&&(j=q),ge[Y]=0;for(me[0]=0,Y=1;Y<=j;++Y)me[Y+16]=xe=xe+me[Y-1]<<1;for(Y=0;Y<ce;++Y)xe=P[Y],xe!=0&&(ge[Y]=me[xe+16]++);var Ne=0;for(Y=0;Y<ce;++Y)if(Ne=P[Y],Ne!=0)for(xe=X(ge[Y],j)>>j-Ne,de=(1<<j+4-Ne)-1;de>=0;--de)W[xe|de<<Ne]=Ne&15|Y<<4;return j}var Ze=we?new Uint16Array(512):Et(512),Je=we?new Uint16Array(32):Et(32);if(!we){for(var dt=0;dt<512;++dt)Ze[dt]=0;for(dt=0;dt<32;++dt)Je[dt]=0}(function(){for(var P=[],W=0;W<32;W++)P.push(5);er(P,Je,32);var U=[];for(W=0;W<=143;W++)U.push(8);for(;W<=255;W++)U.push(9);for(;W<=279;W++)U.push(7);for(;W<=287;W++)U.push(8);er(U,Ze,288)})();var Lt=function(){for(var W=we?new Uint8Array(32768):[],U=0,j=0;U<De.length-1;++U)for(;j<De[U+1];++j)W[j]=U;for(;j<32768;++j)W[j]=29;var q=we?new Uint8Array(259):[];for(U=0,j=0;U<ue.length-1;++U)for(;j<ue[U+1];++j)q[j]=U;function Y(xe,ce){for(var me=0;me<xe.length;){var ge=Math.min(65535,xe.length-me),Ne=me+ge==xe.length;for(ce.write_shift(1,+Ne),ce.write_shift(2,ge),ce.write_shift(2,~ge&65535);ge-- >0;)ce[ce.l++]=xe[me++]}return ce.l}function de(xe,ce){for(var me=0,ge=0,Ne=we?new Uint16Array(32768):[];ge<xe.length;){var Le=Math.min(65535,xe.length-ge);if(Le<10){for(me=ut(ce,me,+(ge+Le==xe.length)),me&7&&(me+=8-(me&7)),ce.l=me/8|0,ce.write_shift(2,Le),ce.write_shift(2,~Le&65535);Le-- >0;)ce[ce.l++]=xe[ge++];me=ce.l*8;continue}me=ut(ce,me,+(ge+Le==xe.length)+2);for(var ze=0;Le-- >0;){var Me=xe[ge];ze=(ze<<5^Me)&32767;var je=-1,at=0;if((je=Ne[ze])&&(je|=ge&-32768,je>ge&&(je-=32768),je<ge))for(;xe[je+at]==xe[ge+at]&&at<250;)++at;if(at>2){Me=q[at],Me<=22?me=rr(ce,me,Te[Me+1]>>1)-1:(rr(ce,me,3),me+=5,rr(ce,me,Te[Me-23]>>5),me+=3);var Pt=Me<8?0:Me-4>>2;Pt>0&&(yr(ce,me,at-ue[Me]),me+=Pt),Me=W[ge-je],me=rr(ce,me,Te[Me]>>3),me-=3;var St=Me<4?0:Me-2>>1;St>0&&(yr(ce,me,ge-je-De[Me]),me+=St);for(var Ct=0;Ct<at;++Ct)Ne[ze]=ge&32767,ze=(ze<<5^xe[ge])&32767,++ge;Le-=at-1}else Me<=143?Me=Me+48:me=_t(ce,me,1),me=rr(ce,me,Te[Me]),Ne[ze]=ge&32767,++ge}me=rr(ce,me,0)-1}return ce.l=(me+7)/8|0,ce.l}return function(ce,me){return ce.length<8?Y(ce,me):de(ce,me)}}();function ot(P){var W=Fr(50+Math.floor(P.length*1.1)),U=Lt(P,W);return W.slice(0,U)}var Ft=we?new Uint16Array(32768):Et(32768),Vt=we?new Uint16Array(32768):Et(32768),Ot=we?new Uint16Array(128):Et(128),Lr=1,Cn=1;function Gi(P,W){var U=Be(P,W)+257;W+=5;var j=Be(P,W)+1;W+=5;var q=We(P,W)+4;W+=4;for(var Y=0,de=we?new Uint8Array(19):Et(19),xe=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],ce=1,me=we?new Uint8Array(8):Et(8),ge=we?new Uint8Array(8):Et(8),Ne=de.length,Le=0;Le<q;++Le)de[Z[Le]]=Y=qe(P,W),ce<Y&&(ce=Y),me[Y]++,W+=3;var ze=0;for(me[0]=0,Le=1;Le<=ce;++Le)ge[Le]=ze=ze+me[Le-1]<<1;for(Le=0;Le<Ne;++Le)(ze=de[Le])!=0&&(xe[Le]=ge[ze]++);var Me=0;for(Le=0;Le<Ne;++Le)if(Me=de[Le],Me!=0){ze=Te[xe[Le]]>>8-Me;for(var je=(1<<7-Me)-1;je>=0;--je)Ot[ze|je<<Me]=Me&7|Le<<3}var at=[];for(ce=1;at.length<U+j;)switch(ze=Ot[Pe(P,W)],W+=ze&7,ze>>>=3){case 16:for(Y=3+nt(P,W),W+=2,ze=at[at.length-1];Y-- >0;)at.push(ze);break;case 17:for(Y=3+qe(P,W),W+=3;Y-- >0;)at.push(0);break;case 18:for(Y=11+Pe(P,W),W+=7;Y-- >0;)at.push(0);break;default:at.push(ze),ce<ze&&(ce=ze);break}var Pt=at.slice(0,U),St=at.slice(U);for(Le=U;Le<286;++Le)Pt[Le]=0;for(Le=j;Le<30;++Le)St[Le]=0;return Lr=er(Pt,Ft,286),Cn=er(St,Vt,30),W}function li(P,W){if(P[0]==3&&!(P[1]&3))return[qs(W),2];for(var U=0,j=0,q=AT(W||1<<18),Y=0,de=q.length>>>0,xe=0,ce=0;(j&1)==0;){if(j=qe(P,U),U+=3,j>>>1)j>>1==1?(xe=9,ce=5):(U=Gi(P,U),xe=Lr,ce=Cn);else{U&7&&(U+=8-(U&7));var me=P[U>>>3]|P[(U>>>3)+1]<<8;if(U+=32,me>0)for(!W&&de<Y+me&&(q=fr(q,Y+me),de=q.length);me-- >0;)q[Y++]=P[U>>>3],U+=8;continue}for(;;){!W&&de<Y+32767&&(q=fr(q,Y+32767),de=q.length);var ge=Ye(P,U,xe),Ne=j>>>1==1?Ze[ge]:Ft[ge];if(U+=Ne&15,Ne>>>=4,(Ne>>>8&255)===0)q[Y++]=Ne;else{if(Ne==256)break;Ne-=257;var Le=Ne<8?0:Ne-4>>2;Le>5&&(Le=0);var ze=Y+ue[Ne];Le>0&&(ze+=Ye(P,U,Le),U+=Le),ge=Ye(P,U,ce),Ne=j>>>1==1?Je[ge]:Vt[ge],U+=Ne&15,Ne>>>=4;var Me=Ne<4?0:Ne-2>>1,je=De[Ne];for(Me>0&&(je+=Ye(P,U,Me),U+=Me),!W&&de<ze&&(q=fr(q,ze+100),de=q.length);Y<ze;)q[Y]=q[Y-je],++Y}}}return W?[q,U+7>>>3]:[q.slice(0,Y),U+7>>>3]}function qi(P,W){var U=P.slice(P.l||0),j=li(U,W);return P.l+=j[1],j[0]}function Ki(P,W){if(P)typeof console<"u"&&console.error(W);else throw new Error(W)}function Wi(P,W){var U=P;Zr(U,0);var j=[],q=[],Y={FileIndex:j,FullPaths:q};C(Y,{root:W.root});for(var de=U.length-4;(U[de]!=80||U[de+1]!=75||U[de+2]!=5||U[de+3]!=6)&&de>=0;)--de;U.l=de+4,U.l+=4;var xe=U.read_shift(2);U.l+=6;var ce=U.read_shift(4);for(U.l=ce,de=0;de<xe;++de){U.l+=20;var me=U.read_shift(4),ge=U.read_shift(4),Ne=U.read_shift(2),Le=U.read_shift(2),ze=U.read_shift(2);U.l+=8;var Me=U.read_shift(4),je=u(U.slice(U.l+Ne,U.l+Ne+Le));U.l+=Ne+Le+ze;var at=U.l;U.l=Me+4,_a(U,me,ge,Y,je),U.l=at}return Y}function _a(P,W,U,j,q){P.l+=2;var Y=P.read_shift(2),de=P.read_shift(2),xe=c(P);if(Y&8257)throw new Error("Unsupported ZIP encryption");for(var ce=P.read_shift(4),me=P.read_shift(4),ge=P.read_shift(4),Ne=P.read_shift(2),Le=P.read_shift(2),ze="",Me=0;Me<Ne;++Me)ze+=String.fromCharCode(P[P.l++]);if(Le){var je=u(P.slice(P.l,P.l+Le));(je[21589]||{}).mt&&(xe=je[21589].mt),((q||{})[21589]||{}).mt&&(xe=q[21589].mt)}P.l+=Le;var at=P.slice(P.l,P.l+me);switch(de){case 8:at=z(P,ge);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+de)}var Pt=!1;Y&8&&(ce=P.read_shift(4),ce==134695760&&(ce=P.read_shift(4),Pt=!0),me=P.read_shift(4),ge=P.read_shift(4)),me!=W&&Ki(Pt,"Bad compressed size: "+W+" != "+me),ge!=U&&Ki(Pt,"Bad uncompressed size: "+U+" != "+ge),nr(j,ze,at,{unsafe:!0,mt:xe})}function xa(P,W){var U=W||{},j=[],q=[],Y=Fr(1),de=U.compression?8:0,xe=0,ce=0,me=0,ge=0,Ne=0,Le=P.FullPaths[0],ze=Le,Me=P.FileIndex[0],je=[],at=0;for(ce=1;ce<P.FullPaths.length;++ce)if(ze=P.FullPaths[ce].slice(Le.length),Me=P.FileIndex[ce],!(!Me.size||!Me.content||ze=="Sh33tJ5")){var Pt=ge,St=Fr(ze.length);for(me=0;me<ze.length;++me)St.write_shift(1,ze.charCodeAt(me)&127);St=St.slice(0,St.l),je[Ne]=xF.buf(Me.content,0);var Ct=Me.content;de==8&&(Ct=Q(Ct)),Y=Fr(30),Y.write_shift(4,67324752),Y.write_shift(2,20),Y.write_shift(2,xe),Y.write_shift(2,de),Me.mt?o(Y,Me.mt):Y.write_shift(4,0),Y.write_shift(-4,je[Ne]),Y.write_shift(4,Ct.length),Y.write_shift(4,Me.content.length),Y.write_shift(2,St.length),Y.write_shift(2,0),ge+=Y.length,j.push(Y),ge+=St.length,j.push(St),ge+=Ct.length,j.push(Ct),Y=Fr(46),Y.write_shift(4,33639248),Y.write_shift(2,0),Y.write_shift(2,20),Y.write_shift(2,xe),Y.write_shift(2,de),Y.write_shift(4,0),Y.write_shift(-4,je[Ne]),Y.write_shift(4,Ct.length),Y.write_shift(4,Me.content.length),Y.write_shift(2,St.length),Y.write_shift(2,0),Y.write_shift(2,0),Y.write_shift(2,0),Y.write_shift(2,0),Y.write_shift(4,0),Y.write_shift(4,Pt),at+=Y.l,q.push(Y),at+=St.length,q.push(St),++Ne}return Y=Fr(22),Y.write_shift(4,101010256),Y.write_shift(2,0),Y.write_shift(2,0),Y.write_shift(2,Ne),Y.write_shift(2,Ne),Y.write_shift(4,at),Y.write_shift(4,ge),Y.write_shift(2,0),ws([ws(j),ws(q),Y])}var Fa={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function Qn(P,W){if(P.ctype)return P.ctype;var U=P.name||"",j=U.match(/\.([^\.]+)$/);return j&&Fa[j[1]]||W&&(j=(U=W).match(/[\.\\]([^\.\\])+$/),j&&Fa[j[1]])?Fa[j[1]]:"application/octet-stream"}function Js(P){for(var W=TT(P),U=[],j=0;j<W.length;j+=76)U.push(W.slice(j,j+76));return U.join(`\r
`)+`\r
`}function Pa(P){var W=P.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(me){var ge=me.charCodeAt(0).toString(16).toUpperCase();return"="+(ge.length==1?"0"+ge:ge)});W=W.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),W.charAt(0)==`
`&&(W="=0D"+W.slice(1)),W=W.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var U=[],j=W.split(`\r
`),q=0;q<j.length;++q){var Y=j[q];if(Y.length==0){U.push("");continue}for(var de=0;de<Y.length;){var xe=76,ce=Y.slice(de,de+xe);ce.charAt(xe-1)=="="?xe--:ce.charAt(xe-2)=="="?xe-=2:ce.charAt(xe-3)=="="&&(xe-=3),ce=Y.slice(de,de+xe),de+=xe,de<Y.length&&(ce+="="),U.push(ce)}}return U.join(`\r
`)}function Xi(P){for(var W=[],U=0;U<P.length;++U){for(var j=P[U];U<=P.length&&j.charAt(j.length-1)=="=";)j=j.slice(0,j.length-1)+P[++U];W.push(j)}for(var q=0;q<W.length;++q)W[q]=W[q].replace(/[=][0-9A-Fa-f]{2}/g,function(Y){return String.fromCharCode(parseInt(Y.slice(1),16))});return Ca(W.join(`\r
`))}function Ma(P,W,U){for(var j="",q="",Y="",de,xe=0;xe<10;++xe){var ce=W[xe];if(!ce||ce.match(/^\s*$/))break;var me=ce.match(/^(.*?):\s*([^\s].*)$/);if(me)switch(me[1].toLowerCase()){case"content-location":j=me[2].trim();break;case"content-type":Y=me[2].trim();break;case"content-transfer-encoding":q=me[2].trim();break}}switch(++xe,q.toLowerCase()){case"base64":de=Ca(Yn(W.slice(xe).join("")));break;case"quoted-printable":de=Xi(W.slice(xe));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+q)}var ge=nr(P,j.slice(U.length),de,{unsafe:!0});Y&&(ge.ctype=Y)}function al(P,W){if(te(P.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var U=W&&W.root||"",j=(wt&&Buffer.isBuffer(P)?P.toString("binary"):te(P)).split(`\r
`),q=0,Y="";for(q=0;q<j.length;++q)if(Y=j[q],!!/^Content-Location:/i.test(Y)&&(Y=Y.slice(Y.indexOf("file")),U||(U=Y.slice(0,Y.lastIndexOf("/")+1)),Y.slice(0,U.length)!=U))for(;U.length>0&&(U=U.slice(0,U.length-1),U=U.slice(0,U.lastIndexOf("/")+1),Y.slice(0,U.length)!=U););var de=(j[1]||"").match(/boundary="(.*?)"/);if(!de)throw new Error("MAD cannot find boundary");var xe="--"+(de[1]||""),ce=[],me=[],ge={FileIndex:ce,FullPaths:me};C(ge);var Ne,Le=0;for(q=0;q<j.length;++q){var ze=j[q];ze!==xe&&ze!==xe+"--"||(Le++&&Ma(ge,j.slice(Ne,q),U),Ne=q)}return ge}function $t(P,W){var U=W||{},j=U.boundary||"SheetJS";j="------="+j;for(var q=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+j.slice(2)+'"',"","",""],Y=P.FullPaths[0],de=Y,xe=P.FileIndex[0],ce=1;ce<P.FullPaths.length;++ce)if(de=P.FullPaths[ce].slice(Y.length),xe=P.FileIndex[ce],!(!xe.size||!xe.content||de=="Sh33tJ5")){de=de.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(at){return"_x"+at.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(at){return"_u"+at.charCodeAt(0).toString(16)+"_"});for(var me=xe.content,ge=wt&&Buffer.isBuffer(me)?me.toString("binary"):te(me),Ne=0,Le=Math.min(1024,ge.length),ze=0,Me=0;Me<=Le;++Me)(ze=ge.charCodeAt(Me))>=32&&ze<128&&++Ne;var je=Ne>=Le*4/5;q.push(j),q.push("Content-Location: "+(U.root||"file:///C:/SheetJS/")+de),q.push("Content-Transfer-Encoding: "+(je?"quoted-printable":"base64")),q.push("Content-Type: "+Qn(xe,de)),q.push(""),q.push(je?Pa(ge):Js(ge))}return q.push(j+`--\r
`),q.join(`\r
`)}function hr(P){var W={};return C(W,P),W}function nr(P,W,U,j){var q=j&&j.unsafe;q||C(P);var Y=!q&&Dt.find(P,W);if(!Y){var de=P.FullPaths[0];W.slice(0,de.length)==de?de=W:(de.slice(-1)!="/"&&(de+="/"),de=(de+W).replace("//","/")),Y={name:i(W),type:2},P.FileIndex.push(Y),P.FullPaths.push(de),q||Dt.utils.cfb_gc(P)}return Y.content=U,Y.size=U?U.length:0,j&&(j.CLSID&&(Y.clsid=j.CLSID),j.mt&&(Y.mt=j.mt),j.ct&&(Y.ct=j.ct)),Y}function Rn(P,W){C(P);var U=Dt.find(P,W);if(U){for(var j=0;j<P.FileIndex.length;++j)if(P.FileIndex[j]==U)return P.FileIndex.splice(j,1),P.FullPaths.splice(j,1),!0}return!1}function eo(P,W,U){C(P);var j=Dt.find(P,W);if(j){for(var q=0;q<P.FileIndex.length;++q)if(P.FileIndex[q]==j)return P.FileIndex[q].name=i(U),P.FullPaths[q]=U,!0}return!1}function wc(P){E(P,!0)}return e.find=b,e.read=ne,e.parse=g,e.write=G,e.writeFile=Oe,e.utils={cfb_new:hr,cfb_add:nr,cfb_del:Rn,cfb_mov:eo,cfb_gc:wc,ReadShift:zu,CheckField:XS,prep_blob:Zr,bconcat:ws,use_zlib:M,_deflateRaw:ot,_inflateRaw:qi,consts:oe},e}();function yF(t){if(typeof Deno<"u")return Deno.readFileSync(t);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var e=File(t);e.open("r"),e.encoding="binary";var r=e.read();return e.close(),r}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+t)}function Ks(t){for(var e=Object.keys(t),r=[],n=0;n<e.length;++n)Object.prototype.hasOwnProperty.call(t,e[n])&&r.push(e[n]);return r}function Q1(t){for(var e=[],r=Ks(t),n=0;n!==r.length;++n)e[t[r[n]]]=r[n];return e}var $0=new Date(1899,11,30,0,0,0);function $n(t,e){var r=t.getTime(),n=$0.getTime()+(t.getTimezoneOffset()-$0.getTimezoneOffset())*6e4;return(r-n)/(24*60*60*1e3)}var RS=new Date,EF=$0.getTime()+(RS.getTimezoneOffset()-$0.getTimezoneOffset())*6e4,DT=RS.getTimezoneOffset();function bd(t){var e=new Date;return e.setTime(t*24*60*60*1e3+EF),e.getTimezoneOffset()!==DT&&e.setTime(e.getTime()+(e.getTimezoneOffset()-DT)*6e4),e}function TF(t){var e=0,r=0,n=!1,i=t.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!i)throw new Error("|"+t+"| is not an ISO8601 Duration");for(var o=1;o!=i.length;++o)if(i[o]){switch(r=1,o>3&&(n=!0),i[o].slice(i[o].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+i[o].slice(i[o].length-1));case"D":r*=24;case"H":r*=60;case"M":if(n)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}e+=r*parseInt(i[o],10)}return e}var OT=new Date("2017-02-19T19:06:09.000Z"),kS=isNaN(OT.getFullYear())?new Date("2/19/17"):OT,AF=kS.getFullYear()==2017;function en(t,e){var r=new Date(t);if(AF)return e>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):e<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(t instanceof Date)return t;if(kS.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return t.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var i=t.match(/\d+/g)||["2017","2","19","0","0","0"],o=new Date(+i[0],+i[1]-1,+i[2],+i[3]||0,+i[4]||0,+i[5]||0);return t.indexOf("Z")>-1&&(o=new Date(o.getTime()-o.getTimezoneOffset()*60*1e3)),o}function Ho(t,e){if(wt&&Buffer.isBuffer(t)){if(e){if(t[0]==255&&t[1]==254)return Fu(t.slice(2).toString("utf16le"));if(t[1]==254&&t[2]==255)return Fu(pS(t.slice(2).toString("binary")))}return t.toString("binary")}if(typeof TextDecoder<"u")try{if(e){if(t[0]==255&&t[1]==254)return Fu(new TextDecoder("utf-16le").decode(t.slice(2)));if(t[0]==254&&t[1]==255)return Fu(new TextDecoder("utf-16be").decode(t.slice(2)))}var r={"€":"","‚":"",ƒ:"","„":"","…":"","†":"","‡":"","ˆ":"","‰":"",Š:"","‹":"",Œ:"",Ž:"","‘":"","’":"","“":"","”":"","•":"","–":"","—":"","˜":"","™":"",š:"","›":"",œ:"",ž:"",Ÿ:""};return Array.isArray(t)&&(t=new Uint8Array(t)),new TextDecoder("latin1").decode(t).replace(/[€‚ƒ„…†‡ˆ‰Š‹ŒŽ‘’“”•–—˜™š›œžŸ]/g,function(o){return r[o]||o})}catch{}for(var n=[],i=0;i!=t.length;++i)n.push(String.fromCharCode(t[i]));return n.join("")}function tn(t){if(typeof JSON<"u"&&!Array.isArray(t))return JSON.parse(JSON.stringify(t));if(typeof t!="object"||t==null)return t;if(t instanceof Date)return new Date(t.getTime());var e={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=tn(t[r]));return e}function ur(t,e){for(var r="";r.length<e;)r+=t;return r}function Mi(t){var e=Number(t);if(!isNaN(e))return isFinite(e)?e:NaN;if(!/\d/.test(t))return e;var r=1,n=t.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(e=Number(n))||(n=n.replace(/[(](.*)[)]/,function(i,o){return r=-r,o}),!isNaN(e=Number(n)))?e/r:e}var wF=["january","february","march","april","may","june","july","august","september","october","november","december"];function ff(t){var e=new Date(t),r=new Date(NaN),n=e.getYear(),i=e.getMonth(),o=e.getDate();if(isNaN(o))return r;var c=t.toLowerCase();if(c.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(c=c.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),c.length>3&&wF.indexOf(c)==-1)return r}else if(c.match(/[a-z]/))return r;return n<0||n>8099?r:(i>0||o>1)&&n!=101?e:t.match(/[^-0-9:,\/\\]/)?r:e}var SF=function(){var t="abacaba".split(/(:?b)/i).length==5;return function(r,n,i){if(t||typeof n=="string")return r.split(n);for(var o=r.split(n),c=[o[0]],u=1;u<o.length;++u)c.push(i),c.push(o[u]);return c}}();function bS(t){return t?t.content&&t.type?Ho(t.content,!0):t.data?Du(t.data):t.asNodeBuffer&&wt?Du(t.asNodeBuffer().toString("binary")):t.asBinary?Du(t.asBinary()):t._data&&t._data.getContent?Du(Ho(Array.prototype.slice.call(t._data.getContent(),0))):null:null}function IS(t){if(!t)return null;if(t.data)return yT(t.data);if(t.asNodeBuffer&&wt)return t.asNodeBuffer();if(t._data&&t._data.getContent){var e=t._data.getContent();return typeof e=="string"?yT(e):Array.prototype.slice.call(e)}return t.content&&t.type?t.content:null}function CF(t){return t&&t.name.slice(-4)===".bin"?IS(t):bS(t)}function fa(t,e){for(var r=t.FullPaths||Ks(t.files),n=e.toLowerCase().replace(/[\/]/g,"\\"),i=n.replace(/\\/g,"/"),o=0;o<r.length;++o){var c=r[o].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==c||i==c)return t.files?t.files[r[o]]:t.FileIndex[o]}return null}function Z1(t,e){var r=fa(t,e);if(r==null)throw new Error("Cannot find file "+e+" in zip");return r}function Cr(t,e,r){if(!r)return CF(Z1(t,e));if(!e)return null;try{return Cr(t,e)}catch{return null}}function Kn(t,e,r){if(!r)return bS(Z1(t,e));if(!e)return null;try{return Kn(t,e)}catch{return null}}function RF(t,e,r){return IS(Z1(t,e))}function NT(t){for(var e=t.FullPaths||Ks(t.files),r=[],n=0;n<e.length;++n)e[n].slice(-1)!="/"&&r.push(e[n].replace(/^Root Entry[\/]/,""));return r.sort()}function kF(t,e,r){if(t.FullPaths){if(typeof r=="string"){var n;return wt?n=Qo(r):n=W6(r),Dt.utils.cfb_add(t,e,n)}Dt.utils.cfb_add(t,e,r)}else t.file(e,r)}function DS(t,e){switch(e.type){case"base64":return Dt.read(t,{type:"base64"});case"binary":return Dt.read(t,{type:"binary"});case"buffer":case"array":return Dt.read(t,{type:"buffer"})}throw new Error("Unrecognized type "+e.type)}function Nu(t,e){if(t.charAt(0)=="/")return t.slice(1);var r=e.split("/");e.slice(-1)!="/"&&r.pop();for(var n=t.split("/");n.length!==0;){var i=n.shift();i===".."?r.pop():i!=="."&&r.push(i)}return r.join("/")}var OS=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,bF=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,FT=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,IF=/<[^>]*>/g,gn=OS.match(FT)?FT:IF,DF=/<\w*:/,OF=/<(\/?)\w+:/;function st(t,e,r){for(var n={},i=0,o=0;i!==t.length&&!((o=t.charCodeAt(i))===32||o===10||o===13);++i);if(e||(n[0]=t.slice(0,i)),i===t.length)return n;var c=t.match(bF),u=0,h="",d=0,g="",_="",x=1;if(c)for(d=0;d!=c.length;++d){for(_=c[d],o=0;o!=_.length&&_.charCodeAt(o)!==61;++o);for(g=_.slice(0,o).trim();_.charCodeAt(o+1)==32;)++o;for(x=(i=_.charCodeAt(o+1))==34||i==39?1:0,h=_.slice(o+1+x,_.length-x),u=0;u!=g.length&&g.charCodeAt(u)!==58;++u);if(u===g.length)g.indexOf("_")>0&&(g=g.slice(0,g.indexOf("_"))),n[g]=h,n[g.toLowerCase()]=h;else{var A=(u===5&&g.slice(0,5)==="xmlns"?"xmlns":"")+g.slice(u+1);if(n[A]&&g.slice(u-3,u)=="ext")continue;n[A]=h,n[A.toLowerCase()]=h}}return n}function si(t){return t.replace(OF,"<$1")}var NS={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},NF=Q1(NS),Nt=function(){var t=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,e=/_x([\da-fA-F]{4})_/ig;return function r(n){var i=n+"",o=i.indexOf("<![CDATA[");if(o==-1)return i.replace(t,function(u,h){return NS[u]||String.fromCharCode(parseInt(h,u.indexOf("x")>-1?16:10))||u}).replace(e,function(u,h){return String.fromCharCode(parseInt(h,16))});var c=i.indexOf("]]>");return r(i.slice(0,o))+i.slice(o+9,c)+r(i.slice(c+3))}}(),FF=/[&<>'"]/g,PF=/[\u0000-\u001f]/g;function FS(t){var e=t+"";return e.replace(FF,function(r){return NF[r]}).replace(/\n/g,"<br/>").replace(PF,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}var PT=function(){var t=/&#(\d+);/g;function e(r,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(t,e)}}();function ir(t){switch(t){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function Ym(t){for(var e="",r=0,n=0,i=0,o=0,c=0,u=0;r<t.length;){if(n=t.charCodeAt(r++),n<128){e+=String.fromCharCode(n);continue}if(i=t.charCodeAt(r++),n>191&&n<224){c=(n&31)<<6,c|=i&63,e+=String.fromCharCode(c);continue}if(o=t.charCodeAt(r++),n<240){e+=String.fromCharCode((n&15)<<12|(i&63)<<6|o&63);continue}c=t.charCodeAt(r++),u=((n&7)<<18|(i&63)<<12|(o&63)<<6|c&63)-65536,e+=String.fromCharCode(55296+(u>>>10&1023)),e+=String.fromCharCode(56320+(u&1023))}return e}function MT(t){var e=qs(2*t.length),r,n,i=1,o=0,c=0,u;for(n=0;n<t.length;n+=i)i=1,(u=t.charCodeAt(n))<128?r=u:u<224?(r=(u&31)*64+(t.charCodeAt(n+1)&63),i=2):u<240?(r=(u&15)*4096+(t.charCodeAt(n+1)&63)*64+(t.charCodeAt(n+2)&63),i=3):(i=4,r=(u&7)*262144+(t.charCodeAt(n+1)&63)*4096+(t.charCodeAt(n+2)&63)*64+(t.charCodeAt(n+3)&63),r-=65536,c=55296+(r>>>10&1023),r=56320+(r&1023)),c!==0&&(e[o++]=c&255,e[o++]=c>>>8,c=0),e[o++]=r%256,e[o++]=r>>>8;return e.slice(0,o).toString("ucs2")}function LT(t){return Qo(t,"binary").toString("utf8")}var o0="foo bar bazâð£",Jt=wt&&(LT(o0)==Ym(o0)&&LT||MT(o0)==Ym(o0)&&MT)||Ym,Fu=wt?function(t){return Qo(t,"utf8").toString("binary")}:function(t){for(var e=[],r=0,n=0,i=0;r<t.length;)switch(n=t.charCodeAt(r++),!0){case n<128:e.push(String.fromCharCode(n));break;case n<2048:e.push(String.fromCharCode(192+(n>>6))),e.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,i=t.charCodeAt(r++)-56320+(n<<10),e.push(String.fromCharCode(240+(i>>18&7))),e.push(String.fromCharCode(144+(i>>12&63))),e.push(String.fromCharCode(128+(i>>6&63))),e.push(String.fromCharCode(128+(i&63)));break;default:e.push(String.fromCharCode(224+(n>>12))),e.push(String.fromCharCode(128+(n>>6&63))),e.push(String.fromCharCode(128+(n&63)))}return e.join("")},hf=function(){var t={};return function(r,n){var i=r+"|"+(n||"");return t[i]?t[i]:t[i]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",n||"")}}(),MF=function(){var t=[["nbsp"," "],["middot","·"],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(e){return[new RegExp("&"+e[0]+";","ig"),e[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),i=0;i<t.length;++i)n=n.replace(t[i][0],t[i][1]);return n}}(),LF=function(){var t={};return function(r){return t[r]!==void 0?t[r]:t[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}}(),VF=/<\/?(?:vt:)?variant>/g,UF=/<(?:vt:)([^>]*)>([\s\S]*)</;function VT(t,e){var r=st(t),n=t.match(LF(r.baseType))||[],i=[];if(n.length!=r.size){if(e.WTF)throw new Error("unexpected vector length "+n.length+" != "+r.size);return i}return n.forEach(function(o){var c=o.replace(VF,"").match(UF);c&&i.push({v:Jt(c[2]),t:c[1]})}),i}function J1(t){if(wt&&Buffer.isBuffer(t))return t.toString("utf8");if(typeof t=="string")return t;if(typeof Uint8Array<"u"&&t instanceof Uint8Array)return Jt(Zo(X1(t)));throw new Error("Bad input format: expected Buffer or string")}var df=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,BF={CT:"http://schemas.openxmlformats.org/package/2006/content-types"},jF=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"];function zF(t,e){for(var r=1-2*(t[e+7]>>>7),n=((t[e+7]&127)<<4)+(t[e+6]>>>4&15),i=t[e+6]&15,o=5;o>=0;--o)i=i*256+t[e+o];return n==2047?i==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,i+=Math.pow(2,52)),r*Math.pow(2,n-52)*i)}function HF(t,e,r){var n=(e<0||1/e==-1/0?1:0)<<7,i=0,o=0,c=n?-e:e;isFinite(c)?c==0?i=o=0:(i=Math.floor(Math.log(c)/Math.LN2),o=c*Math.pow(2,52-i),i<=-1023&&(!isFinite(o)||o<Math.pow(2,52))?i=-1022:(o-=Math.pow(2,52),i+=1023)):(i=2047,o=isNaN(e)?26985:0);for(var u=0;u<=5;++u,o/=256)t[r+u]=o&255;t[r+6]=(i&15)<<4|o&15,t[r+7]=i>>4|n}var UT=function(t){for(var e=[],r=10240,n=0;n<t[0].length;++n)if(t[0][n])for(var i=0,o=t[0][n].length;i<o;i+=r)e.push.apply(e,t[0][n].slice(i,i+r));return e},BT=wt?function(t){return t[0].length>0&&Buffer.isBuffer(t[0][0])?Buffer.concat(t[0].map(function(e){return Buffer.isBuffer(e)?e:Qo(e)})):UT(t)}:UT,jT=function(t,e,r){for(var n=[],i=e;i<r;i+=2)n.push(String.fromCharCode(Oi(t,i)));return n.join("").replace(Sn,"")},ev=wt?function(t,e,r){return Buffer.isBuffer(t)?t.toString("utf16le",e,r).replace(Sn,""):jT(t,e,r)}:jT,zT=function(t,e,r){for(var n=[],i=e;i<e+r;++i)n.push(("0"+t[i].toString(16)).slice(-2));return n.join("")},PS=wt?function(t,e,r){return Buffer.isBuffer(t)?t.toString("hex",e,e+r):zT(t,e,r)}:zT,HT=function(t,e,r){for(var n=[],i=e;i<r;i++)n.push(String.fromCharCode(Yl(t,i)));return n.join("")},Df=wt?function(e,r,n){return Buffer.isBuffer(e)?e.toString("utf8",r,n):HT(e,r,n)}:HT,MS=function(t,e){var r=qn(t,e);return r>0?Df(t,e+4,e+4+r-1):""},LS=MS,VS=function(t,e){var r=qn(t,e);return r>0?Df(t,e+4,e+4+r-1):""},US=VS,BS=function(t,e){var r=2*qn(t,e);return r>0?Df(t,e+4,e+4+r-1):""},jS=BS,zS=function(e,r){var n=qn(e,r);return n>0?ev(e,r+4,r+4+n):""},HS=zS,GS=function(t,e){var r=qn(t,e);return r>0?Df(t,e+4,e+4+r):""},qS=GS,KS=function(t,e){return zF(t,e)},Q0=KS,WS=function(e){return Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array};wt&&(LS=function(e,r){if(!Buffer.isBuffer(e))return MS(e,r);var n=e.readUInt32LE(r);return n>0?e.toString("utf8",r+4,r+4+n-1):""},US=function(e,r){if(!Buffer.isBuffer(e))return VS(e,r);var n=e.readUInt32LE(r);return n>0?e.toString("utf8",r+4,r+4+n-1):""},jS=function(e,r){if(!Buffer.isBuffer(e))return BS(e,r);var n=2*e.readUInt32LE(r);return e.toString("utf16le",r+4,r+4+n-1)},HS=function(e,r){if(!Buffer.isBuffer(e))return zS(e,r);var n=e.readUInt32LE(r);return e.toString("utf16le",r+4,r+4+n)},qS=function(e,r){if(!Buffer.isBuffer(e))return GS(e,r);var n=e.readUInt32LE(r);return e.toString("utf8",r+4,r+4+n)},Q0=function(e,r){return Buffer.isBuffer(e)?e.readDoubleLE(r):KS(e,r)},WS=function(e){return Buffer.isBuffer(e)||Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array});var Yl=function(t,e){return t[e]},Oi=function(t,e){return t[e+1]*256+t[e]},GF=function(t,e){var r=t[e+1]*256+t[e];return r<32768?r:(65535-r+1)*-1},qn=function(t,e){return t[e+3]*(1<<24)+(t[e+2]<<16)+(t[e+1]<<8)+t[e]},Io=function(t,e){return t[e+3]<<24|t[e+2]<<16|t[e+1]<<8|t[e]},qF=function(t,e){return t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3]};function zu(t,e){var r="",n,i,o=[],c,u,h,d;switch(e){case"dbcs":if(d=this.l,wt&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*t).toString("utf16le");else for(h=0;h<t;++h)r+=String.fromCharCode(Oi(this,d)),d+=2;t*=2;break;case"utf8":r=Df(this,this.l,this.l+t);break;case"utf16le":t*=2,r=ev(this,this.l,this.l+t);break;case"wstr":return zu.call(this,t,"dbcs");case"lpstr-ansi":r=LS(this,this.l),t=4+qn(this,this.l);break;case"lpstr-cp":r=US(this,this.l),t=4+qn(this,this.l);break;case"lpwstr":r=jS(this,this.l),t=4+2*qn(this,this.l);break;case"lpp4":t=4+qn(this,this.l),r=HS(this,this.l),t&2&&(t+=2);break;case"8lpp4":t=4+qn(this,this.l),r=qS(this,this.l),t&3&&(t+=4-(t&3));break;case"cstr":for(t=0,r="";(c=Yl(this,this.l+t++))!==0;)o.push(s0(c));r=o.join("");break;case"_wstr":for(t=0,r="";(c=Oi(this,this.l+t))!==0;)o.push(s0(c)),t+=2;t+=2,r=o.join("");break;case"dbcs-cont":for(r="",d=this.l,h=0;h<t;++h){if(this.lens&&this.lens.indexOf(d)!==-1)return c=Yl(this,d),this.l=d+1,u=zu.call(this,t-h,c?"dbcs-cont":"sbcs-cont"),o.join("")+u;o.push(s0(Oi(this,d))),d+=2}r=o.join(""),t*=2;break;case"cpstr":case"sbcs-cont":for(r="",d=this.l,h=0;h!=t;++h){if(this.lens&&this.lens.indexOf(d)!==-1)return c=Yl(this,d),this.l=d+1,u=zu.call(this,t-h,c?"dbcs-cont":"sbcs-cont"),o.join("")+u;o.push(s0(Yl(this,d))),d+=1}r=o.join("");break;default:switch(t){case 1:return n=Yl(this,this.l),this.l++,n;case 2:return n=(e==="i"?GF:Oi)(this,this.l),this.l+=2,n;case 4:case-4:return e==="i"||(this[this.l+3]&128)===0?(n=(t>0?Io:qF)(this,this.l),this.l+=4,n):(i=qn(this,this.l),this.l+=4,i);case 8:case-8:if(e==="f")return t==8?i=Q0(this,this.l):i=Q0([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,i;t=8;case 16:r=PS(this,this.l,t);break}}return this.l+=t,r}var KF=function(t,e,r){t[r]=e&255,t[r+1]=e>>>8&255,t[r+2]=e>>>16&255,t[r+3]=e>>>24&255},WF=function(t,e,r){t[r]=e&255,t[r+1]=e>>8&255,t[r+2]=e>>16&255,t[r+3]=e>>24&255},XF=function(t,e,r){t[r]=e&255,t[r+1]=e>>>8&255};function YF(t,e,r){var n=0,i=0;if(r==="dbcs"){for(i=0;i!=e.length;++i)XF(this,e.charCodeAt(i),this.l+2*i);n=2*e.length}else if(r==="sbcs"){for(e=e.replace(/[^\x00-\x7F]/g,"_"),i=0;i!=e.length;++i)this[this.l+i]=e.charCodeAt(i)&255;n=e.length}else if(r==="hex"){for(;i<t;++i)this[this.l++]=parseInt(e.slice(2*i,2*i+2),16)||0;return this}else if(r==="utf16le"){var o=Math.min(this.l+t,this.length);for(i=0;i<Math.min(e.length,t);++i){var c=e.charCodeAt(i);this[this.l++]=c&255,this[this.l++]=c>>8}for(;this.l<o;)this[this.l++]=0;return this}else switch(t){case 1:n=1,this[this.l]=e&255;break;case 2:n=2,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255;break;case 3:n=3,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255,e>>>=8,this[this.l+2]=e&255;break;case 4:n=4,KF(this,e,this.l);break;case 8:if(n=8,r==="f"){HF(this,e,this.l);break}case 16:break;case-4:n=4,WF(this,e,this.l);break}return this.l+=n,this}function XS(t,e){var r=PS(this,this.l,t.length>>1);if(r!==t)throw new Error(e+"Expected "+t+" saw "+r);this.l+=t.length>>1}function Zr(t,e){t.l=e,t.read_shift=zu,t.chk=XS,t.write_shift=YF}function mn(t,e){t.l+=e}function Fr(t){var e=qs(t);return Zr(e,0),e}function Hi(t,e,r){if(t){var n,i,o;Zr(t,t.l||0);for(var c=t.length,u=0,h=0;t.l<c;){u=t.read_shift(1),u&128&&(u=(u&127)+((t.read_shift(1)&127)<<7));var d=nd[u]||nd[65535];for(n=t.read_shift(1),o=n&127,i=1;i<4&&n&128;++i)o+=((n=t.read_shift(1))&127)<<7*i;h=t.l+o;var g=d.f&&d.f(t,o,r);if(t.l=h,e(g,d,u))return}}}function Fg(){var t=[],e=wt?256:2048,r=function(d){var g=Fr(d);return Zr(g,0),g},n=r(e),i=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&t.push(n),n=null)},o=function(d){return n&&d<n.length-n.l?n:(i(),n=r(Math.max(d+1,e)))},c=function(){return i(),ws(t)},u=function(d){i(),n=d,n.l==null&&(n.l=n.length),o(e)};return{next:o,push:u,end:c,_bufs:t}}function Hu(t,e,r){var n=tn(t);if(e.s?(n.cRel&&(n.c+=e.s.c),n.rRel&&(n.r+=e.s.r)):(n.cRel&&(n.c+=e.c),n.rRel&&(n.r+=e.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function GT(t,e,r){var n=tn(t);return n.s=Hu(n.s,e.s,r),n.e=Hu(n.e,e.s,r),n}function Gu(t,e){if(t.cRel&&t.c<0)for(t=tn(t);t.c<0;)t.c+=e>8?16384:256;if(t.rRel&&t.r<0)for(t=tn(t);t.r<0;)t.r+=e>8?1048576:e>5?65536:16384;var r=vt(t);return!t.cRel&&t.cRel!=null&&(r=ZF(r)),!t.rRel&&t.rRel!=null&&(r=$F(r)),r}function $m(t,e){return t.s.r==0&&!t.s.rRel&&t.e.r==(e.biff>=12?1048575:e.biff>=8?65536:16384)&&!t.e.rRel?(t.s.cRel?"":"$")+wn(t.s.c)+":"+(t.e.cRel?"":"$")+wn(t.e.c):t.s.c==0&&!t.s.cRel&&t.e.c==(e.biff>=12?16383:255)&&!t.e.cRel?(t.s.rRel?"":"$")+Xn(t.s.r)+":"+(t.e.rRel?"":"$")+Xn(t.e.r):Gu(t.s,e.biff)+":"+Gu(t.e,e.biff)}function YS(t){return parseInt(QF(t),10)-1}function Xn(t){return""+(t+1)}function $F(t){return t.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function QF(t){return t.replace(/\$(\d+)$/,"$1")}function $S(t){for(var e=JF(t),r=0,n=0;n!==e.length;++n)r=26*r+e.charCodeAt(n)-64;return r-1}function wn(t){if(t<0)throw new Error("invalid column "+t);var e="";for(++t;t;t=Math.floor((t-1)/26))e=String.fromCharCode((t-1)%26+65)+e;return e}function ZF(t){return t.replace(/^([A-Z])/,"$$$1")}function JF(t){return t.replace(/^\$([A-Z])/,"$1")}function Ia(t){for(var e=0,r=0,n=0;n<t.length;++n){var i=t.charCodeAt(n);i>=48&&i<=57?e=10*e+(i-48):i>=65&&i<=90&&(r=26*r+(i-64))}return{c:r-1,r:e-1}}function vt(t){for(var e=t.c+1,r="";e;e=(e-1)/26|0)r=String.fromCharCode((e-1)%26+65)+r;return r+(t.r+1)}function tv(t){var e=t.indexOf(":");return e==-1?{s:Ia(t),e:Ia(t)}:{s:Ia(t.slice(0,e)),e:Ia(t.slice(e+1))}}function Gt(t,e){return typeof e>"u"||typeof e=="number"?Gt(t.s,t.e):(typeof t!="string"&&(t=vt(t)),typeof e!="string"&&(e=vt(e)),t==e?t:t+":"+e)}function Kr(t){var e={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,i=0,o=t.length;for(r=0;n<o&&!((i=t.charCodeAt(n)-64)<1||i>26);++n)r=26*r+i;for(e.s.c=--r,r=0;n<o&&!((i=t.charCodeAt(n)-48)<0||i>9);++n)r=10*r+i;if(e.s.r=--r,n===o||i!=10)return e.e.c=e.s.c,e.e.r=e.s.r,e;for(++n,r=0;n!=o&&!((i=t.charCodeAt(n)-64)<1||i>26);++n)r=26*r+i;for(e.e.c=--r,r=0;n!=o&&!((i=t.charCodeAt(n)-48)<0||i>9);++n)r=10*r+i;return e.e.r=--r,e}function qT(t,e){var r=t.t=="d"&&e instanceof Date;if(t.z!=null)try{return t.w=ga(t.z,r?$n(e):e)}catch{}try{return t.w=ga((t.XF||{}).numFmtId||(r?14:0),r?$n(e):e)}catch{return""+e}}function hc(t,e,r){return t==null||t.t==null||t.t=="z"?"":t.w!==void 0?t.w:(t.t=="d"&&!t.z&&r&&r.dateNF&&(t.z=r.dateNF),t.t=="e"?rl[t.v]||t.v:e==null?qT(t,t.v):qT(t,e))}function Jo(t,e){var r=e&&e.sheet?e.sheet:"Sheet1",n={};return n[r]=t,{SheetNames:[r],Sheets:n}}function e8(t,e,r){var n=r||{},i=t?Array.isArray(t):n.dense,o=t||(i?[]:{}),c=0,u=0;if(o&&n.origin!=null){if(typeof n.origin=="number")c=n.origin;else{var h=typeof n.origin=="string"?Ia(n.origin):n.origin;c=h.r,u=h.c}o["!ref"]||(o["!ref"]="A1:A1")}var d={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(o["!ref"]){var g=Kr(o["!ref"]);d.s.c=g.s.c,d.s.r=g.s.r,d.e.c=Math.max(d.e.c,g.e.c),d.e.r=Math.max(d.e.r,g.e.r),c==-1&&(d.e.r=c=g.e.r+1)}for(var _=0;_!=e.length;++_)if(e[_]){if(!Array.isArray(e[_]))throw new Error("aoa_to_sheet expects an array of arrays");for(var x=0;x!=e[_].length;++x)if(!(typeof e[_][x]>"u")){var A={v:e[_][x]},S=c+_,R=u+x;if(d.s.r>S&&(d.s.r=S),d.s.c>R&&(d.s.c=R),d.e.r<S&&(d.e.r=S),d.e.c<R&&(d.e.c=R),e[_][x]&&typeof e[_][x]=="object"&&!Array.isArray(e[_][x])&&!(e[_][x]instanceof Date))A=e[_][x];else if(Array.isArray(A.v)&&(A.f=e[_][x][1],A.v=A.v[0]),A.v===null)if(A.f)A.t="n";else if(n.nullError)A.t="e",A.v=0;else if(n.sheetStubs)A.t="z";else continue;else typeof A.v=="number"?A.t="n":typeof A.v=="boolean"?A.t="b":A.v instanceof Date?(A.z=n.dateNF||ht[14],n.cellDates?(A.t="d",A.w=ga(A.z,$n(A.v))):(A.t="n",A.v=$n(A.v),A.w=ga(A.z,A.v))):A.t="s";if(i)o[S]||(o[S]=[]),o[S][R]&&o[S][R].z&&(A.z=o[S][R].z),o[S][R]=A;else{var w=vt({c:R,r:S});o[w]&&o[w].z&&(A.z=o[w].z),o[w]=A}}}return d.s.c<1e7&&(o["!ref"]=Gt(d)),o}function Of(t,e){return e8(null,t,e)}function t8(t){return t.read_shift(4,"i")}function dn(t){var e=t.read_shift(4);return e===0?"":t.read_shift(e,"dbcs")}function r8(t){return{ich:t.read_shift(2),ifnt:t.read_shift(2)}}function rv(t,e){var r=t.l,n=t.read_shift(1),i=dn(t),o=[],c={t:i,h:i};if((n&1)!==0){for(var u=t.read_shift(4),h=0;h!=u;++h)o.push(r8(t));c.r=o}else c.r=[{ich:0,ifnt:0}];return t.l=r+e,c}var n8=rv;function va(t){var e=t.read_shift(4),r=t.read_shift(2);return r+=t.read_shift(1)<<16,t.l++,{c:e,iStyleRef:r}}function el(t){var e=t.read_shift(2);return e+=t.read_shift(1)<<16,t.l++,{c:-1,iStyleRef:e}}var a8=dn;function nv(t){var e=t.read_shift(4);return e===0||e===4294967295?"":t.read_shift(e,"dbcs")}var i8=dn,Pg=nv;function av(t){var e=t.slice(t.l,t.l+4),r=e[0]&1,n=e[0]&2;t.l+=4;var i=n===0?Q0([0,0,0,0,e[0]&252,e[1],e[2],e[3]],0):Io(e,0)>>2;return r?i/100:i}function QS(t){var e={s:{},e:{}};return e.s.r=t.read_shift(4),e.e.r=t.read_shift(4),e.s.c=t.read_shift(4),e.e.c=t.read_shift(4),e}var tl=QS;function fn(t){if(t.length-t.l<8)throw"XLS Xnum Buffer underflow";return t.read_shift(8,"f")}function s8(t){var e={},r=t.read_shift(1),n=r>>>1,i=t.read_shift(1),o=t.read_shift(2,"i"),c=t.read_shift(1),u=t.read_shift(1),h=t.read_shift(1);switch(t.l++,n){case 0:e.auto=1;break;case 1:e.index=i;var d=Mo[i];d&&(e.rgb=mf(d));break;case 2:e.rgb=mf([c,u,h]);break;case 3:e.theme=i;break}return o!=0&&(e.tint=o>0?o/32767:o/32768),e}function o8(t){var e=t.read_shift(1);t.l++;var r={fBold:e&1,fItalic:e&2,fUnderline:e&4,fStrikeout:e&8,fOutline:e&16,fShadow:e&32,fCondense:e&64,fExtend:e&128};return r}function ZS(t,e){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=t.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return r[t.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return t.l-=4,t.read_shift(0,e==1?"lpstr":"lpwstr")}function l8(t){return ZS(t,1)}function c8(t){return ZS(t,2)}var iv=2,On=3,l0=11,KT=12,Z0=19,c0=64,u8=65,f8=71,h8=4108,d8=4126,Gr=80,JS=81,p8=[Gr,JS],m8={1:{n:"CodePage",t:iv},2:{n:"Category",t:Gr},3:{n:"PresentationFormat",t:Gr},4:{n:"ByteCount",t:On},5:{n:"LineCount",t:On},6:{n:"ParagraphCount",t:On},7:{n:"SlideCount",t:On},8:{n:"NoteCount",t:On},9:{n:"HiddenCount",t:On},10:{n:"MultimediaClipCount",t:On},11:{n:"ScaleCrop",t:l0},12:{n:"HeadingPairs",t:h8},13:{n:"TitlesOfParts",t:d8},14:{n:"Manager",t:Gr},15:{n:"Company",t:Gr},16:{n:"LinksUpToDate",t:l0},17:{n:"CharacterCount",t:On},19:{n:"SharedDoc",t:l0},22:{n:"HyperlinksChanged",t:l0},23:{n:"AppVersion",t:On,p:"version"},24:{n:"DigSig",t:u8},26:{n:"ContentType",t:Gr},27:{n:"ContentStatus",t:Gr},28:{n:"Language",t:Gr},29:{n:"Version",t:Gr},255:{},2147483648:{n:"Locale",t:Z0},2147483651:{n:"Behavior",t:Z0},1919054434:{}},g8={1:{n:"CodePage",t:iv},2:{n:"Title",t:Gr},3:{n:"Subject",t:Gr},4:{n:"Author",t:Gr},5:{n:"Keywords",t:Gr},6:{n:"Comments",t:Gr},7:{n:"Template",t:Gr},8:{n:"LastAuthor",t:Gr},9:{n:"RevNumber",t:Gr},10:{n:"EditTime",t:c0},11:{n:"LastPrinted",t:c0},12:{n:"CreatedDate",t:c0},13:{n:"ModifiedDate",t:c0},14:{n:"PageCount",t:On},15:{n:"WordCount",t:On},16:{n:"CharCount",t:On},17:{n:"Thumbnail",t:f8},18:{n:"Application",t:Gr},19:{n:"DocSecurity",t:On},255:{},2147483648:{n:"Locale",t:Z0},2147483651:{n:"Behavior",t:Z0},1919054434:{}},WT={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},v8=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function _8(t){return t.map(function(e){return[e>>16&255,e>>8&255,e&255]})}var x8=_8([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Mo=tn(x8),rl={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},e4={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},XT={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"};function y8(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function E8(t){var e=y8();if(!t||!t.match)return e;var r={};if((t.match(gn)||[]).forEach(function(n){var i=st(n);switch(i[0].replace(DF,"<")){case"<?xml":break;case"<Types":e.xmlns=i["xmlns"+(i[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[i.Extension]=i.ContentType;break;case"<Override":e[XT[i.ContentType]]!==void 0&&e[XT[i.ContentType]].push(i.PartName);break}}),e.xmlns!==BF.CT)throw new Error("Unknown Namespace: "+e.xmlns);return e.calcchain=e.calcchains.length>0?e.calcchains[0]:"",e.sst=e.strs.length>0?e.strs[0]:"",e.style=e.styles.length>0?e.styles[0]:"",e.defaults=r,delete e.calcchains,e}var $l={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function Mg(t){var e=t.lastIndexOf("/");return t.slice(0,e+1)+"_rels/"+t.slice(e+1)+".rels"}function qu(t,e){var r={"!id":{}};if(!t)return r;e.charAt(0)!=="/"&&(e="/"+e);var n={};return(t.match(gn)||[]).forEach(function(i){var o=st(i);if(o[0]==="<Relationship"){var c={};c.Type=o.Type,c.Target=o.Target,c.Id=o.Id,o.TargetMode&&(c.TargetMode=o.TargetMode);var u=o.TargetMode==="External"?o.Target:Nu(o.Target,e);r[u]=c,n[o.Id]=c}}),r["!id"]=n,r}var T8="application/vnd.oasis.opendocument.spreadsheet";function A8(t,e){for(var r=J1(t),n,i;n=df.exec(r);)switch(n[3]){case"manifest":break;case"file-entry":if(i=st(n[0],!1),i.path=="/"&&i.type!==T8)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(e&&e.WTF)throw n}}var Ku=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],w8=function(){for(var t=new Array(Ku.length),e=0;e<Ku.length;++e){var r=Ku[e],n="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);t[e]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return t}();function t4(t){var e={};t=Jt(t);for(var r=0;r<Ku.length;++r){var n=Ku[r],i=t.match(w8[r]);i!=null&&i.length>0&&(e[n[1]]=Nt(i[1])),n[2]==="date"&&e[n[1]]&&(e[n[1]]=en(e[n[1]]))}return e}var S8=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]];function r4(t,e,r,n){var i=[];if(typeof t=="string")i=VT(t,n);else for(var o=0;o<t.length;++o)i=i.concat(t[o].map(function(g){return{v:g}}));var c=typeof e=="string"?VT(e,n).map(function(g){return g.v}):e,u=0,h=0;if(c.length>0)for(var d=0;d!==i.length;d+=2){switch(h=+i[d+1].v,i[d].v){case"Worksheets":case"工作表":case"Листы":case"أوراق العمل":case"ワークシート":case"גליונות עבודה":case"Arbeitsblätter":case"Çalışma Sayfaları":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de cálculo":case"Planilhas":case"Regneark":case"Hojas de cálculo":case"Werkbladen":r.Worksheets=h,r.SheetNames=c.slice(u,u+h);break;case"Named Ranges":case"Rangos con nombre":case"名前付き一覧":case"Benannte Bereiche":case"Navngivne områder":r.NamedRanges=h,r.DefinedNames=c.slice(u,u+h);break;case"Charts":case"Diagramme":r.Chartsheets=h,r.ChartNames=c.slice(u,u+h);break}u+=h}}function C8(t,e,r){var n={};return e||(e={}),t=Jt(t),S8.forEach(function(i){var o=(t.match(hf(i[0]))||[])[1];switch(i[2]){case"string":o&&(e[i[1]]=Nt(o));break;case"bool":e[i[1]]=o==="true";break;case"raw":var c=t.match(new RegExp("<"+i[0]+"[^>]*>([\\s\\S]*?)</"+i[0]+">"));c&&c.length>0&&(n[i[1]]=c[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&r4(n.HeadingPairs,n.TitlesOfParts,e,r),e}var R8=/<[^>]+>[^<]*/g;function k8(t,e){var r={},n="",i=t.match(R8);if(i)for(var o=0;o!=i.length;++o){var c=i[o],u=st(c);switch(u[0]){case"<?xml":break;case"<Properties":break;case"<property":n=Nt(u.name);break;case"</property>":n=null;break;default:if(c.indexOf("<vt:")===0){var h=c.split(">"),d=h[0].slice(4),g=h[1];switch(d){case"lpstr":case"bstr":case"lpwstr":r[n]=Nt(g);break;case"bool":r[n]=ir(g);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[n]=parseInt(g,10);break;case"r4":case"r8":case"decimal":r[n]=parseFloat(g);break;case"filetime":case"date":r[n]=en(g);break;case"cy":case"error":r[n]=Nt(g);break;default:if(d.slice(-1)=="/")break;e.WTF&&typeof console<"u"&&console.warn("Unexpected",c,d,h)}}else if(c.slice(0,2)!=="</"){if(e.WTF)throw new Error(c)}}}return r}var b8={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},Qm;function I8(t,e,r){Qm||(Qm=Q1(b8)),e=Qm[e]||e,t[e]=r}function sv(t){var e=t.read_shift(4),r=t.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+e/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function n4(t,e,r){var n=t.l,i=t.read_shift(0,"lpstr-cp");if(r)for(;t.l-n&3;)++t.l;return i}function a4(t,e,r){var n=t.read_shift(0,"lpwstr");return n}function i4(t,e,r){return e===31?a4(t):n4(t,e,r)}function Lg(t,e,r){return i4(t,e,r===!1?0:4)}function D8(t,e){if(!e)throw new Error("VtUnalignedString must have positive length");return i4(t,e,0)}function O8(t){for(var e=t.read_shift(4),r=[],n=0;n!=e;++n){var i=t.l;r[n]=t.read_shift(0,"lpwstr").replace(Sn,""),t.l-i&2&&(t.l+=2)}return r}function N8(t){for(var e=t.read_shift(4),r=[],n=0;n!=e;++n)r[n]=t.read_shift(0,"lpstr-cp").replace(Sn,"");return r}function F8(t){var e=t.l,r=J0(t,JS);t[t.l]==0&&t[t.l+1]==0&&t.l-e&2&&(t.l+=2);var n=J0(t,On);return[r,n]}function P8(t){for(var e=t.read_shift(4),r=[],n=0;n<e/2;++n)r.push(F8(t));return r}function YT(t,e){for(var r=t.read_shift(4),n={},i=0;i!=r;++i){var o=t.read_shift(4),c=t.read_shift(4);n[o]=t.read_shift(c,e===1200?"utf16le":"utf8").replace(Sn,"").replace(Ou,"!"),e===1200&&c%2&&(t.l+=2)}return t.l&3&&(t.l=t.l>>3<<2),n}function s4(t){var e=t.read_shift(4),r=t.slice(t.l,t.l+e);return t.l+=e,(e&3)>0&&(t.l+=4-(e&3)&3),r}function M8(t){var e={};return e.Size=t.read_shift(4),t.l+=e.Size+3-(e.Size-1)%4,e}function J0(t,e,r){var n=t.read_shift(2),i,o=r||{};if(t.l+=2,e!==KT&&n!==e&&p8.indexOf(e)===-1&&!((e&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+e+" saw "+n);switch(e===KT?n:e){case 2:return i=t.read_shift(2,"i"),o.raw||(t.l+=2),i;case 3:return i=t.read_shift(4,"i"),i;case 11:return t.read_shift(4)!==0;case 19:return i=t.read_shift(4),i;case 30:return n4(t,n,4).replace(Sn,"");case 31:return a4(t);case 64:return sv(t);case 65:return s4(t);case 71:return M8(t);case 80:return Lg(t,n,!o.raw).replace(Sn,"");case 81:return D8(t,n).replace(Sn,"");case 4108:return P8(t);case 4126:case 4127:return n==4127?O8(t):N8(t);default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+n)}}function $T(t,e){var r=t.l,n=t.read_shift(4),i=t.read_shift(4),o=[],c=0,u=0,h=-1,d={};for(c=0;c!=i;++c){var g=t.read_shift(4),_=t.read_shift(4);o[c]=[g,_+r]}o.sort(function(H,N){return H[1]-N[1]});var x={};for(c=0;c!=i;++c){if(t.l!==o[c][1]){var A=!0;if(c>0&&e)switch(e[o[c-1][0]].t){case 2:t.l+2===o[c][1]&&(t.l+=2,A=!1);break;case 80:t.l<=o[c][1]&&(t.l=o[c][1],A=!1);break;case 4108:t.l<=o[c][1]&&(t.l=o[c][1],A=!1);break}if((!e||c==0)&&t.l<=o[c][1]&&(A=!1,t.l=o[c][1]),A)throw new Error("Read Error: Expected address "+o[c][1]+" at "+t.l+" :"+c)}if(e){var S=e[o[c][0]];if(x[S.n]=J0(t,S.t,{raw:!0}),S.p==="version"&&(x[S.n]=String(x[S.n]>>16)+"."+("0000"+String(x[S.n]&65535)).slice(-4)),S.n=="CodePage")switch(x[S.n]){case 0:x[S.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:ka(u=x[S.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+x[S.n])}}else if(o[c][0]===1){if(u=x.CodePage=J0(t,iv),ka(u),h!==-1){var R=t.l;t.l=o[h][1],d=YT(t,u),t.l=R}}else if(o[c][0]===0){if(u===0){h=c,t.l=o[c+1][1];continue}d=YT(t,u)}else{var w=d[o[c][0]],B;switch(t[t.l]){case 65:t.l+=4,B=s4(t);break;case 30:t.l+=4,B=Lg(t,t[t.l-4]).replace(/\u0000+$/,"");break;case 31:t.l+=4,B=Lg(t,t[t.l-4]).replace(/\u0000+$/,"");break;case 3:t.l+=4,B=t.read_shift(4,"i");break;case 19:t.l+=4,B=t.read_shift(4);break;case 5:t.l+=4,B=t.read_shift(8,"f");break;case 11:t.l+=4,B=mr(t,4);break;case 64:t.l+=4,B=en(sv(t));break;default:throw new Error("unparsed value: "+t[t.l])}x[w]=B}}return t.l=r+n,x}function QT(t,e,r){var n=t.content;if(!n)return{};Zr(n,0);var i,o,c,u,h=0;n.chk("feff","Byte Order: "),n.read_shift(2);var d=n.read_shift(4),g=n.read_shift(16);if(g!==Dt.utils.consts.HEADER_CLSID&&g!==r)throw new Error("Bad PropertySet CLSID "+g);if(i=n.read_shift(4),i!==1&&i!==2)throw new Error("Unrecognized #Sets: "+i);if(o=n.read_shift(16),u=n.read_shift(4),i===1&&u!==n.l)throw new Error("Length mismatch: "+u+" !== "+n.l);i===2&&(c=n.read_shift(16),h=n.read_shift(4));var _=$T(n,e),x={SystemIdentifier:d};for(var A in _)x[A]=_[A];if(x.FMTID=o,i===1)return x;if(h-n.l==2&&(n.l+=2),n.l!==h)throw new Error("Length mismatch 2: "+n.l+" !== "+h);var S;try{S=$T(n,null)}catch{}for(A in S)x[A]=S[A];return x.FMTID=[o,c],x}function xs(t,e){return t.read_shift(e),null}function L8(t,e,r){for(var n=[],i=t.l+e;t.l<i;)n.push(r(t,i-t.l));if(i!==t.l)throw new Error("Slurp error");return n}function mr(t,e){return t.read_shift(e)===1}function Rr(t){return t.read_shift(2,"u")}function o4(t,e){return L8(t,e,Rr)}function V8(t){var e=t.read_shift(1),r=t.read_shift(1);return r===1?e:e===1}function Nf(t,e,r){var n=t.read_shift(r&&r.biff>=12?2:1),i="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var o=t.read_shift(1);o&&(i="dbcs-cont")}else r.biff==12&&(i="wstr");r.biff>=2&&r.biff<=5&&(i="cpstr");var c=n?t.read_shift(n,i):"";return c}function U8(t){var e=t.read_shift(2),r=t.read_shift(1),n=r&4,i=r&8,o=1+(r&1),c=0,u,h={};i&&(c=t.read_shift(2)),n&&(u=t.read_shift(4));var d=o==2?"dbcs-cont":"sbcs-cont",g=e===0?"":t.read_shift(e,d);return i&&(t.l+=4*c),n&&(t.l+=u),h.t=g,i||(h.raw="<t>"+h.t+"</t>",h.r=h.t),h}function Go(t,e,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return t.read_shift(e,"cpstr");if(r.biff>=12)return t.read_shift(e,"dbcs-cont")}var i=t.read_shift(1);return i===0?n=t.read_shift(e,"sbcs-cont"):n=t.read_shift(e,"dbcs-cont"),n}function Ff(t,e,r){var n=t.read_shift(r&&r.biff==2?1:2);return n===0?(t.l++,""):Go(t,n,r)}function nl(t,e,r){if(r.biff>5)return Ff(t,e,r);var n=t.read_shift(1);return n===0?(t.l++,""):t.read_shift(n,r.biff<=4||!t.lens?"cpstr":"sbcs-cont")}function B8(t){var e=t.read_shift(1);t.l++;var r=t.read_shift(2);return t.l+=2,[e,r]}function j8(t){var e=t.read_shift(4),r=t.l,n=!1;e>24&&(t.l+=e-24,t.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),t.l=r);var i=t.read_shift((n?e-24:e)>>1,"utf16le").replace(Sn,"");return n&&(t.l+=24),i}function z8(t){for(var e=t.read_shift(2),r="";e-- >0;)r+="../";var n=t.read_shift(0,"lpstr-ansi");if(t.l+=2,t.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var i=t.read_shift(4);if(i===0)return r+n.replace(/\\/g,"/");var o=t.read_shift(4);if(t.read_shift(2)!=3)throw new Error("Bad FileMoniker");var c=t.read_shift(o>>1,"utf16le").replace(Sn,"");return r+c}function H8(t,e){var r=t.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return j8(t);case"0303000000000000c000000000000046":return z8(t);default:throw new Error("Unsupported Moniker "+r)}}function u0(t){var e=t.read_shift(4),r=e>0?t.read_shift(e,"utf16le").replace(Sn,""):"";return r}function G8(t,e){var r=t.l+e,n=t.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var i=t.read_shift(2);t.l+=2;var o,c,u,h,d="",g,_;i&16&&(o=u0(t,r-t.l)),i&128&&(c=u0(t,r-t.l)),(i&257)===257&&(u=u0(t,r-t.l)),(i&257)===1&&(h=H8(t,r-t.l)),i&8&&(d=u0(t,r-t.l)),i&32&&(g=t.read_shift(16)),i&64&&(_=sv(t)),t.l=r;var x=c||u||h||"";x&&d&&(x+="#"+d),x||(x="#"+d),i&2&&x.charAt(0)=="/"&&x.charAt(1)!="/"&&(x="file://"+x);var A={Target:x};return g&&(A.guid=g),_&&(A.time=_),o&&(A.Tooltip=o),A}function l4(t){var e=t.read_shift(1),r=t.read_shift(1),n=t.read_shift(1),i=t.read_shift(1);return[e,r,n,i]}function c4(t,e){var r=l4(t);return r[3]=0,r}function oi(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2);return{r:e,c:r,ixfe:n}}function q8(t){var e=t.read_shift(2),r=t.read_shift(2);return t.l+=8,{type:e,flags:r}}function K8(t,e,r){return e===0?"":nl(t,e,r)}function W8(t,e,r){var n=r.biff>8?4:2,i=t.read_shift(n),o=t.read_shift(n,"i"),c=t.read_shift(n,"i");return[i,o,c]}function u4(t){var e=t.read_shift(2),r=av(t);return[e,r]}function X8(t,e,r){t.l+=4,e-=4;var n=t.l+e,i=Nf(t,e,r),o=t.read_shift(2);if(n-=t.l,o!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+o);return t.l+=o,i}function Id(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2),i=t.read_shift(2);return{s:{c:n,r:e},e:{c:i,r}}}function f4(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(1),i=t.read_shift(1);return{s:{c:n,r:e},e:{c:i,r}}}var Y8=f4;function h4(t){t.l+=4;var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2);return t.l+=12,[r,e,n]}function $8(t){var e={};return t.l+=4,t.l+=16,e.fSharedNote=t.read_shift(2),t.l+=4,e}function Q8(t){var e={};return t.l+=4,t.cf=t.read_shift(2),e}function on(t){t.l+=2,t.l+=t.read_shift(2)}var Z8={0:on,4:on,5:on,6:on,7:Q8,8:on,9:on,10:on,11:on,12:on,13:$8,14:on,15:on,16:on,17:on,18:on,19:on,20:on,21:h4};function J8(t,e){for(var r=t.l+e,n=[];t.l<r;){var i=t.read_shift(2);t.l-=2;try{n.push(Z8[i](t,r-t.l))}catch{return t.l=r,n}}return t.l!=r&&(t.l=r),n}function f0(t,e){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=t.read_shift(2),e-=2,e>=2&&(r.dt=t.read_shift(2),t.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(e>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return t.read_shift(e),r}function eP(t,e){return e===0||t.read_shift(2),1200}function tP(t,e,r){if(r.enc)return t.l+=e,"";var n=t.l,i=nl(t,0,r);return t.read_shift(e+n-t.l),i}function rP(t,e,r){var n=r&&r.biff==8||e==2?t.read_shift(2):(t.l+=e,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function nP(t,e,r){var n=t.read_shift(4),i=t.read_shift(1)&3,o=t.read_shift(1);switch(o){case 0:o="Worksheet";break;case 1:o="Macrosheet";break;case 2:o="Chartsheet";break;case 6:o="VBAModule";break}var c=Nf(t,0,r);return c.length===0&&(c="Sheet1"),{pos:n,hs:i,dt:o,name:c}}function aP(t,e){for(var r=t.l+e,n=t.read_shift(4),i=t.read_shift(4),o=[],c=0;c!=i&&t.l<r;++c)o.push(U8(t));return o.Count=n,o.Unique=i,o}function iP(t,e){var r={};return r.dsst=t.read_shift(2),t.l+=e-2,r}function sP(t){var e={};e.r=t.read_shift(2),e.c=t.read_shift(2),e.cnt=t.read_shift(2)-e.c;var r=t.read_shift(2);t.l+=4;var n=t.read_shift(1);return t.l+=3,n&7&&(e.level=n&7),n&32&&(e.hidden=!0),n&64&&(e.hpt=r/20),e}function oP(t){var e=q8(t);if(e.type!=2211)throw new Error("Invalid Future Record "+e.type);var r=t.read_shift(4);return r!==0}function lP(t){return t.read_shift(2),t.read_shift(4)}function ZT(t,e,r){var n=0;r&&r.biff==2||(n=t.read_shift(2));var i=t.read_shift(2);r&&r.biff==2&&(n=1-(i>>15),i&=32767);var o={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[o,i]}function cP(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2),i=t.read_shift(2),o=t.read_shift(2),c=t.read_shift(2),u=t.read_shift(2),h=t.read_shift(2),d=t.read_shift(2);return{Pos:[e,r],Dim:[n,i],Flags:o,CurTab:c,FirstTab:u,Selected:h,TabRatio:d}}function uP(t,e,r){if(r&&r.biff>=2&&r.biff<5)return{};var n=t.read_shift(2);return{RTL:n&64}}function fP(){}function hP(t,e,r){var n={dyHeight:t.read_shift(2),fl:t.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:t.l+=2;break;default:t.l+=10;break}return n.name=Nf(t,0,r),n}function dP(t){var e=oi(t);return e.isst=t.read_shift(4),e}function pP(t,e,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=t.l+e,i=oi(t);r.biff==2&&t.l++;var o=Ff(t,n-t.l,r);return i.val=o,i}function mP(t,e,r){var n=t.read_shift(2),i=nl(t,0,r);return[n,i]}var gP=nl;function JT(t,e,r){var n=t.l+e,i=r.biff==8||!r.biff?4:2,o=t.read_shift(i),c=t.read_shift(i),u=t.read_shift(2),h=t.read_shift(2);return t.l=n,{s:{r:o,c:u},e:{r:c,c:h}}}function vP(t){var e=t.read_shift(2),r=t.read_shift(2),n=u4(t);return{r:e,c:r,ixfe:n[0],rknum:n[1]}}function _P(t,e){for(var r=t.l+e-2,n=t.read_shift(2),i=t.read_shift(2),o=[];t.l<r;)o.push(u4(t));if(t.l!==r)throw new Error("MulRK read error");var c=t.read_shift(2);if(o.length!=c-i+1)throw new Error("MulRK length mismatch");return{r:n,c:i,C:c,rkrec:o}}function xP(t,e){for(var r=t.l+e-2,n=t.read_shift(2),i=t.read_shift(2),o=[];t.l<r;)o.push(t.read_shift(2));if(t.l!==r)throw new Error("MulBlank read error");var c=t.read_shift(2);if(o.length!=c-i+1)throw new Error("MulBlank length mismatch");return{r:n,c:i,C:c,ixfe:o}}function yP(t,e,r,n){var i={},o=t.read_shift(4),c=t.read_shift(4),u=t.read_shift(4),h=t.read_shift(2);return i.patternType=v8[u>>26],n.cellStyles&&(i.alc=o&7,i.fWrap=o>>3&1,i.alcV=o>>4&7,i.fJustLast=o>>7&1,i.trot=o>>8&255,i.cIndent=o>>16&15,i.fShrinkToFit=o>>20&1,i.iReadOrder=o>>22&2,i.fAtrNum=o>>26&1,i.fAtrFnt=o>>27&1,i.fAtrAlc=o>>28&1,i.fAtrBdr=o>>29&1,i.fAtrPat=o>>30&1,i.fAtrProt=o>>31&1,i.dgLeft=c&15,i.dgRight=c>>4&15,i.dgTop=c>>8&15,i.dgBottom=c>>12&15,i.icvLeft=c>>16&127,i.icvRight=c>>23&127,i.grbitDiag=c>>30&3,i.icvTop=u&127,i.icvBottom=u>>7&127,i.icvDiag=u>>14&127,i.dgDiag=u>>21&15,i.icvFore=h&127,i.icvBack=h>>7&127,i.fsxButton=h>>14&1),i}function EP(t,e,r){var n={};return n.ifnt=t.read_shift(2),n.numFmtId=t.read_shift(2),n.flags=t.read_shift(2),n.fStyle=n.flags>>2&1,e-=6,n.data=yP(t,e,n.fStyle,r),n}function TP(t){t.l+=4;var e=[t.read_shift(2),t.read_shift(2)];if(e[0]!==0&&e[0]--,e[1]!==0&&e[1]--,e[0]>7||e[1]>7)throw new Error("Bad Gutters: "+e.join("|"));return e}function e2(t,e,r){var n=oi(t);(r.biff==2||e==9)&&++t.l;var i=V8(t);return n.val=i,n.t=i===!0||i===!1?"b":"e",n}function AP(t,e,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=oi(t),i=fn(t);return n.val=i,n}var t2=K8;function wP(t,e,r){var n=t.l+e,i=t.read_shift(2),o=t.read_shift(2);if(r.sbcch=o,o==1025||o==14849)return[o,i];if(o<1||o>255)throw new Error("Unexpected SupBook type: "+o);for(var c=Go(t,o),u=[];n>t.l;)u.push(Ff(t));return[o,i,c,u]}function r2(t,e,r){var n=t.read_shift(2),i,o={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return r.sbcch===14849&&(i=X8(t,e-2,r)),o.body=i||t.read_shift(e-2),typeof i=="string"&&(o.Name=i),o}var SP=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function n2(t,e,r){var n=t.l+e,i=t.read_shift(2),o=t.read_shift(1),c=t.read_shift(1),u=t.read_shift(r&&r.biff==2?1:2),h=0;(!r||r.biff>=5)&&(r.biff!=5&&(t.l+=2),h=t.read_shift(2),r.biff==5&&(t.l+=2),t.l+=4);var d=Go(t,c,r);i&32&&(d=SP[d.charCodeAt(0)]);var g=n-t.l;r&&r.biff==2&&--g;var _=n==t.l||u===0||!(g>0)?[]:s9(t,g,r,u);return{chKey:o,Name:d,itab:h,rgce:_}}function d4(t,e,r){if(r.biff<8)return CP(t,e,r);for(var n=[],i=t.l+e,o=t.read_shift(r.biff>8?4:2);o--!==0;)n.push(W8(t,r.biff>8?12:6,r));if(t.l!=i)throw new Error("Bad ExternSheet: "+t.l+" != "+i);return n}function CP(t,e,r){t[t.l+1]==3&&t[t.l]++;var n=Nf(t,e,r);return n.charCodeAt(0)==3?n.slice(1):n}function RP(t,e,r){if(r.biff<8){t.l+=e;return}var n=t.read_shift(2),i=t.read_shift(2),o=Go(t,n,r),c=Go(t,i,r);return[o,c]}function kP(t,e,r){var n=f4(t);t.l++;var i=t.read_shift(1);return e-=8,[o9(t,e,r),i,n]}function a2(t,e,r){var n=Y8(t);switch(r.biff){case 2:t.l++,e-=7;break;case 3:case 4:t.l+=2,e-=8;break;default:t.l+=6,e-=12}return[n,a9(t,e,r)]}function bP(t){var e=t.read_shift(4)!==0,r=t.read_shift(4)!==0,n=t.read_shift(4);return[e,r,n]}function IP(t,e,r){if(!(r.biff<8)){var n=t.read_shift(2),i=t.read_shift(2),o=t.read_shift(2),c=t.read_shift(2),u=nl(t,0,r);return r.biff<8&&t.read_shift(1),[{r:n,c:i},u,c,o]}}function DP(t,e,r){return IP(t,e,r)}function OP(t,e){for(var r=[],n=t.read_shift(2);n--;)r.push(Id(t));return r}function NP(t,e,r){if(r&&r.biff<8)return PP(t,e,r);var n=h4(t),i=J8(t,e-22,n[1]);return{cmo:n,ft:i}}var FP={8:function(t,e){var r=t.l+e;t.l+=10;var n=t.read_shift(2);t.l+=4,t.l+=2,t.l+=2,t.l+=2,t.l+=4;var i=t.read_shift(1);return t.l+=i,t.l=r,{fmt:n}}};function PP(t,e,r){t.l+=4;var n=t.read_shift(2),i=t.read_shift(2),o=t.read_shift(2);t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=6,e-=36;var c=[];return c.push((FP[n]||mn)(t,e,r)),{cmo:[i,n,o],ft:c}}function MP(t,e,r){var n=t.l,i="";try{t.l+=4;var o=(r.lastobj||{cmo:[0,0]}).cmo[1],c;[0,5,7,11,12,14].indexOf(o)==-1?t.l+=6:c=B8(t,6,r);var u=t.read_shift(2);t.read_shift(2),Rr(t,2);var h=t.read_shift(2);t.l+=h;for(var d=1;d<t.lens.length-1;++d){if(t.l-n!=t.lens[d])throw new Error("TxO: bad continue record");var g=t[t.l],_=Go(t,t.lens[d+1]-t.lens[d]-1);if(i+=_,i.length>=(g?u:2*u))break}if(i.length!==u&&i.length!==u*2)throw new Error("cchText: "+u+" != "+i.length);return t.l=n+e,{t:i}}catch{return t.l=n+e,{t:i}}}function LP(t,e){var r=Id(t);t.l+=16;var n=G8(t,e-24);return[r,n]}function VP(t,e){t.read_shift(2);var r=Id(t),n=t.read_shift((e-10)/2,"dbcs-cont");return n=n.replace(Sn,""),[r,n]}function UP(t){var e=[0,0],r;return r=t.read_shift(2),e[0]=WT[r]||r,r=t.read_shift(2),e[1]=WT[r]||r,e}function BP(t){for(var e=t.read_shift(2),r=[];e-- >0;)r.push(c4(t));return r}function jP(t){for(var e=t.read_shift(2),r=[];e-- >0;)r.push(c4(t));return r}function zP(t){t.l+=2;var e={cxfs:0,crc:0};return e.cxfs=t.read_shift(2),e.crc=t.read_shift(4),e}function p4(t,e,r){if(!r.cellStyles)return mn(t,e);var n=r&&r.biff>=12?4:2,i=t.read_shift(n),o=t.read_shift(n),c=t.read_shift(n),u=t.read_shift(n),h=t.read_shift(2);n==2&&(t.l+=2);var d={s:i,e:o,w:c,ixfe:u,flags:h};return(r.biff>=5||!r.biff)&&(d.level=h>>8&7),d}function HP(t,e){var r={};return e<32||(t.l+=16,r.header=fn(t),r.footer=fn(t),t.l+=2),r}function GP(t,e,r){var n={area:!1};if(r.biff!=5)return t.l+=e,n;var i=t.read_shift(1);return t.l+=3,i&16&&(n.area=!0),n}var qP=oi,KP=o4,WP=Ff;function XP(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(4),i={fmt:e,env:r,len:n,data:t.slice(t.l,t.l+n)};return t.l+=n,i}function YP(t,e,r){r.biffguess&&r.biff==5&&(r.biff=2);var n=oi(t);++t.l;var i=nl(t,e-7,r);return n.t="str",n.val=i,n}function $P(t){var e=oi(t);++t.l;var r=fn(t);return e.t="n",e.val=r,e}function QP(t){var e=oi(t);++t.l;var r=t.read_shift(2);return e.t="n",e.val=r,e}function ZP(t){var e=t.read_shift(1);return e===0?(t.l++,""):t.read_shift(e,"sbcs-cont")}function JP(t,e){t.l+=6,t.l+=2,t.l+=1,t.l+=3,t.l+=1,t.l+=e-13}function eM(t,e,r){var n=t.l+e,i=oi(t),o=t.read_shift(2),c=Go(t,o,r);return t.l=n,i.t="str",i.val=c,i}var tM=[2,3,48,49,131,139,140,245],i2=function(){var t={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},e=Q1({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(u,h){var d=[],g=qs(1);switch(h.type){case"base64":g=Ca(Yn(u));break;case"binary":g=Ca(u);break;case"buffer":case"array":g=u;break}Zr(g,0);var _=g.read_shift(1),x=!!(_&136),A=!1,S=!1;switch(_){case 2:break;case 3:break;case 48:A=!0,x=!0;break;case 49:A=!0,x=!0;break;case 131:break;case 139:break;case 140:S=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+_.toString(16))}var R=0,w=521;_==2&&(R=g.read_shift(2)),g.l+=3,_!=2&&(R=g.read_shift(4)),R>1048576&&(R=1e6),_!=2&&(w=g.read_shift(2));var B=g.read_shift(2),H=h.codepage||1252;_!=2&&(g.l+=16,g.read_shift(1),g[g.l]!==0&&(H=t[g[g.l]]),g.l+=1,g.l+=2),S&&(g.l+=36);for(var N=[],J={},re=Math.min(g.length,_==2?521:w-10-(A?264:0)),ne=S?32:11;g.l<re&&g[g.l]!=13;)switch(J={},J.name=cf.utils.decode(H,g.slice(g.l,g.l+ne)).replace(/[\u0000\r\n].*$/g,""),g.l+=ne,J.type=String.fromCharCode(g.read_shift(1)),_!=2&&!S&&(J.offset=g.read_shift(4)),J.len=g.read_shift(1),_==2&&(J.offset=g.read_shift(2)),J.dec=g.read_shift(1),J.name.length&&N.push(J),_!=2&&(g.l+=S?13:14),J.type){case"B":(!A||J.len!=8)&&h.WTF&&console.log("Skipping "+J.name+":"+J.type);break;case"G":case"P":h.WTF&&console.log("Skipping "+J.name+":"+J.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+J.type)}if(g[g.l]!==13&&(g.l=w-1),g.read_shift(1)!==13)throw new Error("DBF Terminator not found "+g.l+" "+g[g.l]);g.l=w;var C=0,T=0;for(d[0]=[],T=0;T!=N.length;++T)d[0][T]=N[T].name;for(;R-- >0;){if(g[g.l]===42){g.l+=B;continue}for(++g.l,d[++C]=[],T=0,T=0;T!=N.length;++T){var E=g.slice(g.l,g.l+N[T].len);g.l+=N[T].len,Zr(E,0);var D=cf.utils.decode(H,E);switch(N[T].type){case"C":D.trim().length&&(d[C][T]=D.replace(/\s+$/,""));break;case"D":D.length===8?d[C][T]=new Date(+D.slice(0,4),+D.slice(4,6)-1,+D.slice(6,8)):d[C][T]=D;break;case"F":d[C][T]=parseFloat(D.trim());break;case"+":case"I":d[C][T]=S?E.read_shift(-4,"i")^2147483648:E.read_shift(4,"i");break;case"L":switch(D.trim().toUpperCase()){case"Y":case"T":d[C][T]=!0;break;case"N":case"F":d[C][T]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+D+"|")}break;case"M":if(!x)throw new Error("DBF Unexpected MEMO for type "+_.toString(16));d[C][T]="##MEMO##"+(S?parseInt(D.trim(),10):E.read_shift(4));break;case"N":D=D.replace(/\u0000/g,"").trim(),D&&D!="."&&(d[C][T]=+D||0);break;case"@":d[C][T]=new Date(E.read_shift(-8,"f")-621356832e5);break;case"T":d[C][T]=new Date((E.read_shift(4)-2440588)*864e5+E.read_shift(4));break;case"Y":d[C][T]=E.read_shift(4,"i")/1e4+E.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":d[C][T]=-E.read_shift(-8,"f");break;case"B":if(A&&N[T].len==8){d[C][T]=E.read_shift(8,"f");break}case"G":case"P":E.l+=N[T].len;break;case"0":if(N[T].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+N[T].type)}}}if(_!=2&&g.l<g.length&&g[g.l++]!=26)throw new Error("DBF EOF Marker missing "+(g.l-1)+" of "+g.length+" "+g[g.l-1].toString(16));return h&&h.sheetRows&&(d=d.slice(0,h.sheetRows)),h.DBF=N,d}function n(u,h){var d=h||{};d.dateNF||(d.dateNF="yyyymmdd");var g=Of(r(u,d),d);return g["!cols"]=d.DBF.map(function(_){return{wch:_.len,DBF:_}}),delete d.DBF,g}function i(u,h){try{return Jo(n(u,h),h)}catch(d){if(h&&h.WTF)throw d}return{SheetNames:[],Sheets:{}}}var o={B:8,C:250,L:1,D:8,"?":0,"":0};function c(u,h){var d=h||{};if(+d.codepage>=0&&ka(+d.codepage),d.type=="string")throw new Error("Cannot write DBF to JS string");var g=Fg(),_=z4(u,{header:1,raw:!0,cellDates:!0}),x=_[0],A=_.slice(1),S=u["!cols"]||[],R=0,w=0,B=0,H=1;for(R=0;R<x.length;++R){if(((S[R]||{}).DBF||{}).name){x[R]=S[R].DBF.name,++B;continue}if(x[R]!=null){if(++B,typeof x[R]=="number"&&(x[R]=x[R].toString(10)),typeof x[R]!="string")throw new Error("DBF Invalid column name "+x[R]+" |"+typeof x[R]+"|");if(x.indexOf(x[R])!==R){for(w=0;w<1024;++w)if(x.indexOf(x[R]+"_"+w)==-1){x[R]+="_"+w;break}}}}var N=Kr(u["!ref"]),J=[],re=[],ne=[];for(R=0;R<=N.e.c-N.s.c;++R){var C="",T="",E=0,D=[];for(w=0;w<A.length;++w)A[w][R]!=null&&D.push(A[w][R]);if(D.length==0||x[R]==null){J[R]="?";continue}for(w=0;w<D.length;++w){switch(typeof D[w]){case"number":T="B";break;case"string":T="C";break;case"boolean":T="L";break;case"object":T=D[w]instanceof Date?"D":"C";break;default:T="C"}E=Math.max(E,String(D[w]).length),C=C&&C!=T?"C":T}E>250&&(E=250),T=((S[R]||{}).DBF||{}).type,T=="C"&&S[R].DBF.len>E&&(E=S[R].DBF.len),C=="B"&&T=="N"&&(C="N",ne[R]=S[R].DBF.dec,E=S[R].DBF.len),re[R]=C=="C"||T=="N"?E:o[C]||0,H+=re[R],J[R]=C}var b=g.next(32);for(b.write_shift(4,318902576),b.write_shift(4,A.length),b.write_shift(2,296+32*B),b.write_shift(2,H),R=0;R<4;++R)b.write_shift(4,0);for(b.write_shift(4,0|(+e[hS]||3)<<8),R=0,w=0;R<x.length;++R)if(x[R]!=null){var O=g.next(32),F=(x[R].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);O.write_shift(1,F,"sbcs"),O.write_shift(1,J[R]=="?"?"C":J[R],"sbcs"),O.write_shift(4,w),O.write_shift(1,re[R]||o[J[R]]||0),O.write_shift(1,ne[R]||0),O.write_shift(1,2),O.write_shift(4,0),O.write_shift(1,0),O.write_shift(4,0),O.write_shift(4,0),w+=re[R]||o[J[R]]||0}var Fe=g.next(264);for(Fe.write_shift(4,13),R=0;R<65;++R)Fe.write_shift(4,0);for(R=0;R<A.length;++R){var Ce=g.next(H);for(Ce.write_shift(1,0),w=0;w<x.length;++w)if(x[w]!=null)switch(J[w]){case"L":Ce.write_shift(1,A[R][w]==null?63:A[R][w]?84:70);break;case"B":Ce.write_shift(8,A[R][w]||0,"f");break;case"N":var ae="0";for(typeof A[R][w]=="number"&&(ae=A[R][w].toFixed(ne[w]||0)),B=0;B<re[w]-ae.length;++B)Ce.write_shift(1,32);Ce.write_shift(1,ae,"sbcs");break;case"D":A[R][w]?(Ce.write_shift(4,("0000"+A[R][w].getFullYear()).slice(-4),"sbcs"),Ce.write_shift(2,("00"+(A[R][w].getMonth()+1)).slice(-2),"sbcs"),Ce.write_shift(2,("00"+A[R][w].getDate()).slice(-2),"sbcs")):Ce.write_shift(8,"00000000","sbcs");break;case"C":var oe=String(A[R][w]!=null?A[R][w]:"").slice(0,re[w]);for(Ce.write_shift(1,oe,"sbcs"),B=0;B<re[w]-oe.length;++B)Ce.write_shift(1,32);break}}return g.next(1).write_shift(1,26),g.end()}return{to_workbook:i,to_sheet:n,from_sheet:c}}(),rM=function(){var t={AA:"À",BA:"Á",CA:"Â",DA:195,HA:"Ä",JA:197,AE:"È",BE:"É",CE:"Ê",HE:"Ë",AI:"Ì",BI:"Í",CI:"Î",HI:"Ï",AO:"Ò",BO:"Ó",CO:"Ô",DO:213,HO:"Ö",AU:"Ù",BU:"Ú",CU:"Û",HU:"Ü",Aa:"à",Ba:"á",Ca:"â",Da:227,Ha:"ä",Ja:229,Ae:"è",Be:"é",Ce:"ê",He:"ë",Ai:"ì",Bi:"í",Ci:"î",Hi:"ï",Ao:"ò",Bo:"ó",Co:"ô",Do:245,Ho:"ö",Au:"ù",Bu:"ú",Cu:"û",Hu:"ü",KC:"Ç",Kc:"ç",q:"æ",z:"œ",a:"Æ",j:"Œ",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},e=new RegExp("\x1BN("+Ks(t).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(x,A){var S=t[A];return typeof S=="number"?ET(S):S},n=function(x,A,S){var R=A.charCodeAt(0)-32<<4|S.charCodeAt(0)-48;return R==59?x:ET(R)};t["|"]=254;function i(x,A){switch(A.type){case"base64":return o(Yn(x),A);case"binary":return o(x,A);case"buffer":return o(wt&&Buffer.isBuffer(x)?x.toString("binary"):Zo(x),A);case"array":return o(Ho(x),A)}throw new Error("Unrecognized type "+A.type)}function o(x,A){var S=x.split(/[\n\r]+/),R=-1,w=-1,B=0,H=0,N=[],J=[],re=null,ne={},C=[],T=[],E=[],D=0,b;for(+A.codepage>=0&&ka(+A.codepage);B!==S.length;++B){D=0;var O=S[B].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(e,r),F=O.replace(/;;/g,"\0").split(";").map(function(Z){return Z.replace(/\u0000/g,";")}),Fe=F[0],Ce;if(O.length>0)switch(Fe){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":F[1].charAt(0)=="P"&&J.push(O.slice(3).replace(/;;/g,";"));break;case"C":var ae=!1,oe=!1,Oe=!1,te=!1,G=-1,se=-1;for(H=1;H<F.length;++H)switch(F[H].charAt(0)){case"A":break;case"X":w=parseInt(F[H].slice(1))-1,oe=!0;break;case"Y":for(R=parseInt(F[H].slice(1))-1,oe||(w=0),b=N.length;b<=R;++b)N[b]=[];break;case"K":Ce=F[H].slice(1),Ce.charAt(0)==='"'?Ce=Ce.slice(1,Ce.length-1):Ce==="TRUE"?Ce=!0:Ce==="FALSE"?Ce=!1:isNaN(Mi(Ce))?isNaN(ff(Ce).getDate())||(Ce=en(Ce)):(Ce=Mi(Ce),re!==null&&Ac(re)&&(Ce=bd(Ce))),ae=!0;break;case"E":te=!0;var M=nc(F[H].slice(1),{r:R,c:w});N[R][w]=[N[R][w],M];break;case"S":Oe=!0,N[R][w]=[N[R][w],"S5S"];break;case"G":break;case"R":G=parseInt(F[H].slice(1))-1;break;case"C":se=parseInt(F[H].slice(1))-1;break;default:if(A&&A.WTF)throw new Error("SYLK bad record "+O)}if(ae&&(N[R][w]&&N[R][w].length==2?N[R][w][0]=Ce:N[R][w]=Ce,re=null),Oe){if(te)throw new Error("SYLK shared formula cannot have own formula");var z=G>-1&&N[G][se];if(!z||!z[1])throw new Error("SYLK shared formula cannot find base");N[R][w][1]=w4(z[1],{r:R-G,c:w-se})}break;case"F":var Q=0;for(H=1;H<F.length;++H)switch(F[H].charAt(0)){case"X":w=parseInt(F[H].slice(1))-1,++Q;break;case"Y":for(R=parseInt(F[H].slice(1))-1,b=N.length;b<=R;++b)N[b]=[];break;case"M":D=parseInt(F[H].slice(1))/20;break;case"F":break;case"G":break;case"P":re=J[parseInt(F[H].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(E=F[H].slice(1).split(" "),b=parseInt(E[0],10);b<=parseInt(E[1],10);++b)D=parseInt(E[2],10),T[b-1]=D===0?{hidden:!0}:{wch:D},dc(T[b-1]);break;case"C":w=parseInt(F[H].slice(1))-1,T[w]||(T[w]={});break;case"R":R=parseInt(F[H].slice(1))-1,C[R]||(C[R]={}),D>0?(C[R].hpt=D,C[R].hpx=gf(D)):D===0&&(C[R].hidden=!0);break;default:if(A&&A.WTF)throw new Error("SYLK bad record "+O)}Q<1&&(re=null);break;default:if(A&&A.WTF)throw new Error("SYLK bad record "+O)}}return C.length>0&&(ne["!rows"]=C),T.length>0&&(ne["!cols"]=T),A&&A.sheetRows&&(N=N.slice(0,A.sheetRows)),[N,ne]}function c(x,A){var S=i(x,A),R=S[0],w=S[1],B=Of(R,A);return Ks(w).forEach(function(H){B[H]=w[H]}),B}function u(x,A){return Jo(c(x,A),A)}function h(x,A,S,R){var w="C;Y"+(S+1)+";X"+(R+1)+";K";switch(x.t){case"n":w+=x.v||0,x.f&&!x.F&&(w+=";E"+z5(x.f,{r:S,c:R}));break;case"b":w+=x.v?"TRUE":"FALSE";break;case"e":w+=x.w||x.v;break;case"d":w+='"'+(x.w||x.v)+'"';break;case"s":w+='"'+x.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return w}function d(x,A){A.forEach(function(S,R){var w="F;W"+(R+1)+" "+(R+1)+" ";S.hidden?w+="0":(typeof S.width=="number"&&!S.wpx&&(S.wpx=td(S.width)),typeof S.wpx=="number"&&!S.wch&&(S.wch=rd(S.wpx)),typeof S.wch=="number"&&(w+=Math.round(S.wch))),w.charAt(w.length-1)!=" "&&x.push(w)})}function g(x,A){A.forEach(function(S,R){var w="F;";S.hidden?w+="M0;":S.hpt?w+="M"+20*S.hpt+";":S.hpx&&(w+="M"+20*E4(S.hpx)+";"),w.length>2&&x.push(w+"R"+(R+1))})}function _(x,A){var S=["ID;PWXL;N;E"],R=[],w=Kr(x["!ref"]),B,H=Array.isArray(x),N=`\r
`;S.push("P;PGeneral"),S.push("F;P0;DG0G8;M255"),x["!cols"]&&d(S,x["!cols"]),x["!rows"]&&g(S,x["!rows"]),S.push("B;Y"+(w.e.r-w.s.r+1)+";X"+(w.e.c-w.s.c+1)+";D"+[w.s.c,w.s.r,w.e.c,w.e.r].join(" "));for(var J=w.s.r;J<=w.e.r;++J)for(var re=w.s.c;re<=w.e.c;++re){var ne=vt({r:J,c:re});B=H?(x[J]||[])[re]:x[ne],!(!B||B.v==null&&(!B.f||B.F))&&R.push(h(B,x,J,re))}return S.join(N)+N+R.join(N)+N+"E"+N}return{to_workbook:u,to_sheet:c,from_sheet:_}}(),nM=function(){function t(o,c){switch(c.type){case"base64":return e(Yn(o),c);case"binary":return e(o,c);case"buffer":return e(wt&&Buffer.isBuffer(o)?o.toString("binary"):Zo(o),c);case"array":return e(Ho(o),c)}throw new Error("Unrecognized type "+c.type)}function e(o,c){for(var u=o.split(`
`),h=-1,d=-1,g=0,_=[];g!==u.length;++g){if(u[g].trim()==="BOT"){_[++h]=[],d=0;continue}if(!(h<0)){var x=u[g].trim().split(","),A=x[0],S=x[1];++g;for(var R=u[g]||"";(R.match(/["]/g)||[]).length&1&&g<u.length-1;)R+=`
`+u[++g];switch(R=R.trim(),+A){case-1:if(R==="BOT"){_[++h]=[],d=0;continue}else if(R!=="EOD")throw new Error("Unrecognized DIF special command "+R);break;case 0:R==="TRUE"?_[h][d]=!0:R==="FALSE"?_[h][d]=!1:isNaN(Mi(S))?isNaN(ff(S).getDate())?_[h][d]=S:_[h][d]=en(S):_[h][d]=Mi(S),++d;break;case 1:R=R.slice(1,R.length-1),R=R.replace(/""/g,'"'),R&&R.match(/^=".*"$/)&&(R=R.slice(2,-1)),_[h][d++]=R!==""?R:null;break}if(R==="EOD")break}}return c&&c.sheetRows&&(_=_.slice(0,c.sheetRows)),_}function r(o,c){return Of(t(o,c),c)}function n(o,c){return Jo(r(o,c),c)}var i=function(){var o=function(h,d,g,_,x){h.push(d),h.push(g+","+_),h.push('"'+x.replace(/"/g,'""')+'"')},c=function(h,d,g,_){h.push(d+","+g),h.push(d==1?'"'+_.replace(/"/g,'""')+'"':_)};return function(h){var d=[],g=Kr(h["!ref"]),_,x=Array.isArray(h);o(d,"TABLE",0,1,"sheetjs"),o(d,"VECTORS",0,g.e.r-g.s.r+1,""),o(d,"TUPLES",0,g.e.c-g.s.c+1,""),o(d,"DATA",0,0,"");for(var A=g.s.r;A<=g.e.r;++A){c(d,-1,0,"BOT");for(var S=g.s.c;S<=g.e.c;++S){var R=vt({r:A,c:S});if(_=x?(h[A]||[])[S]:h[R],!_){c(d,1,0,"");continue}switch(_.t){case"n":var w=_.w;!w&&_.v!=null&&(w=_.v),w==null?_.f&&!_.F?c(d,1,0,"="+_.f):c(d,1,0,""):c(d,0,w,"V");break;case"b":c(d,0,_.v?1:0,_.v?"TRUE":"FALSE");break;case"s":c(d,1,0,isNaN(_.v)?_.v:'="'+_.v+'"');break;case"d":_.w||(_.w=ga(_.z||ht[14],$n(en(_.v)))),c(d,0,_.w,"V");break;default:c(d,1,0,"")}}}c(d,-1,0,"EOD");var B=`\r
`,H=d.join(B);return H}}();return{to_workbook:n,to_sheet:r,from_sheet:i}}(),aM=function(){function t(_){return _.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function e(_){return _.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(_,x){for(var A=_.split(`
`),S=-1,R=-1,w=0,B=[];w!==A.length;++w){var H=A[w].trim().split(":");if(H[0]==="cell"){var N=Ia(H[1]);if(B.length<=N.r)for(S=B.length;S<=N.r;++S)B[S]||(B[S]=[]);switch(S=N.r,R=N.c,H[2]){case"t":B[S][R]=t(H[3]);break;case"v":B[S][R]=+H[3];break;case"vtf":var J=H[H.length-1];case"vtc":switch(H[3]){case"nl":B[S][R]=!!+H[4];break;default:B[S][R]=+H[4];break}H[2]=="vtf"&&(B[S][R]=[B[S][R],J])}}}return x&&x.sheetRows&&(B=B.slice(0,x.sheetRows)),B}function n(_,x){return Of(r(_,x),x)}function i(_,x){return Jo(n(_,x),x)}var o=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),c=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,u=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),h="--SocialCalcSpreadsheetControlSave--";function d(_){if(!_||!_["!ref"])return"";for(var x=[],A=[],S,R="",w=tv(_["!ref"]),B=Array.isArray(_),H=w.s.r;H<=w.e.r;++H)for(var N=w.s.c;N<=w.e.c;++N)if(R=vt({r:H,c:N}),S=B?(_[H]||[])[N]:_[R],!(!S||S.v==null||S.t==="z")){switch(A=["cell",R,"t"],S.t){case"s":case"str":A.push(e(S.v));break;case"n":S.f?(A[2]="vtf",A[3]="n",A[4]=S.v,A[5]=e(S.f)):(A[2]="v",A[3]=S.v);break;case"b":A[2]="vt"+(S.f?"f":"c"),A[3]="nl",A[4]=S.v?"1":"0",A[5]=e(S.f||(S.v?"TRUE":"FALSE"));break;case"d":var J=$n(en(S.v));A[2]="vtc",A[3]="nd",A[4]=""+J,A[5]=S.w||ga(S.z||ht[14],J);break;case"e":continue}x.push(A.join(":"))}return x.push("sheet:c:"+(w.e.c-w.s.c+1)+":r:"+(w.e.r-w.s.r+1)+":tvf:1"),x.push("valueformat:1:text-wiki"),x.join(`
`)}function g(_){return[o,c,u,c,d(_),h].join(`
`)}return{to_workbook:i,to_sheet:n,from_sheet:g}}(),pf=function(){function t(g,_,x,A,S){S.raw?_[x][A]=g:g===""||(g==="TRUE"?_[x][A]=!0:g==="FALSE"?_[x][A]=!1:isNaN(Mi(g))?isNaN(ff(g).getDate())?_[x][A]=g:_[x][A]=en(g):_[x][A]=Mi(g))}function e(g,_){var x=_||{},A=[];if(!g||g.length===0)return A;for(var S=g.split(/[\r\n]/),R=S.length-1;R>=0&&S[R].length===0;)--R;for(var w=10,B=0,H=0;H<=R;++H)B=S[H].indexOf(" "),B==-1?B=S[H].length:B++,w=Math.max(w,B);for(H=0;H<=R;++H){A[H]=[];var N=0;for(t(S[H].slice(0,w).trim(),A,H,N,x),N=1;N<=(S[H].length-w)/10+1;++N)t(S[H].slice(w+(N-1)*10,w+N*10).trim(),A,H,N,x)}return x.sheetRows&&(A=A.slice(0,x.sheetRows)),A}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function i(g){for(var _={},x=!1,A=0,S=0;A<g.length;++A)(S=g.charCodeAt(A))==34?x=!x:!x&&S in r&&(_[S]=(_[S]||0)+1);S=[];for(A in _)Object.prototype.hasOwnProperty.call(_,A)&&S.push([_[A],A]);if(!S.length){_=n;for(A in _)Object.prototype.hasOwnProperty.call(_,A)&&S.push([_[A],A])}return S.sort(function(R,w){return R[0]-w[0]||n[R[1]]-n[w[1]]}),r[S.pop()[1]]||44}function o(g,_){var x=_||{},A="",S=x.dense?[]:{},R={s:{c:0,r:0},e:{c:0,r:0}};g.slice(0,4)=="sep="?g.charCodeAt(5)==13&&g.charCodeAt(6)==10?(A=g.charAt(4),g=g.slice(7)):g.charCodeAt(5)==13||g.charCodeAt(5)==10?(A=g.charAt(4),g=g.slice(6)):A=i(g.slice(0,1024)):x&&x.FS?A=x.FS:A=i(g.slice(0,1024));var w=0,B=0,H=0,N=0,J=0,re=A.charCodeAt(0),ne=!1,C=0,T=g.charCodeAt(0);g=g.replace(/\r\n/mg,`
`);var E=x.dateNF!=null?vF(x.dateNF):null;function D(){var b=g.slice(N,J),O={};if(b.charAt(0)=='"'&&b.charAt(b.length-1)=='"'&&(b=b.slice(1,-1).replace(/""/g,'"')),b.length===0)O.t="z";else if(x.raw)O.t="s",O.v=b;else if(b.trim().length===0)O.t="s",O.v=b;else if(b.charCodeAt(0)==61)b.charCodeAt(1)==34&&b.charCodeAt(b.length-1)==34?(O.t="s",O.v=b.slice(2,-1).replace(/""/g,'"')):G5(b)?(O.t="n",O.f=b.slice(1)):(O.t="s",O.v=b);else if(b=="TRUE")O.t="b",O.v=!0;else if(b=="FALSE")O.t="b",O.v=!1;else if(!isNaN(H=Mi(b)))O.t="n",x.cellText!==!1&&(O.w=b),O.v=H;else if(!isNaN(ff(b).getDate())||E&&b.match(E)){O.z=x.dateNF||ht[14];var F=0;E&&b.match(E)&&(b=_F(b,x.dateNF,b.match(E)||[]),F=1),x.cellDates?(O.t="d",O.v=en(b,F)):(O.t="n",O.v=$n(en(b,F))),x.cellText!==!1&&(O.w=ga(O.z,O.v instanceof Date?$n(O.v):O.v)),x.cellNF||delete O.z}else O.t="s",O.v=b;if(O.t=="z"||(x.dense?(S[w]||(S[w]=[]),S[w][B]=O):S[vt({c:B,r:w})]=O),N=J+1,T=g.charCodeAt(N),R.e.c<B&&(R.e.c=B),R.e.r<w&&(R.e.r=w),C==re)++B;else if(B=0,++w,x.sheetRows&&x.sheetRows<=w)return!0}e:for(;J<g.length;++J)switch(C=g.charCodeAt(J)){case 34:T===34&&(ne=!ne);break;case re:case 10:case 13:if(!ne&&D())break e;break}return J-N>0&&D(),S["!ref"]=Gt(R),S}function c(g,_){return!(_&&_.PRN)||_.FS||g.slice(0,4)=="sep="||g.indexOf("	")>=0||g.indexOf(",")>=0||g.indexOf(";")>=0?o(g,_):Of(e(g,_),_)}function u(g,_){var x="",A=_.type=="string"?[0,0,0,0]:pv(g,_);switch(_.type){case"base64":x=Yn(g);break;case"binary":x=g;break;case"buffer":_.codepage==65001?x=g.toString("utf8"):_.codepage&&typeof cf<"u"||(x=wt&&Buffer.isBuffer(g)?g.toString("binary"):Zo(g));break;case"array":x=Ho(g);break;case"string":x=g;break;default:throw new Error("Unrecognized type "+_.type)}return A[0]==239&&A[1]==187&&A[2]==191?x=Jt(x.slice(3)):_.type!="string"&&_.type!="buffer"&&_.codepage==65001?x=Jt(x):_.type=="binary"&&typeof cf<"u",x.slice(0,19)=="socialcalc:version:"?aM.to_sheet(_.type=="string"?x:Jt(x),_):c(x,_)}function h(g,_){return Jo(u(g,_),_)}function d(g){for(var _=[],x=Kr(g["!ref"]),A,S=Array.isArray(g),R=x.s.r;R<=x.e.r;++R){for(var w=[],B=x.s.c;B<=x.e.c;++B){var H=vt({r:R,c:B});if(A=S?(g[R]||[])[B]:g[H],!A||A.v==null){w.push("          ");continue}for(var N=(A.w||(hc(A),A.w)||"").slice(0,10);N.length<10;)N+=" ";w.push(N+(B===0?" ":""))}_.push(w.join(""))}return _.join(`
`)}return{to_workbook:h,to_sheet:u,from_sheet:d}}();function iM(t,e){var r=e||{},n=!!r.WTF;r.WTF=!0;try{var i=rM.to_workbook(t,r);return r.WTF=n,i}catch(o){if(r.WTF=n,!o.message.match(/SYLK bad record ID/)&&n)throw o;return pf.to_workbook(t,e)}}var Wu=function(){function t(M,z,Q){if(M){Zr(M,M.l||0);for(var Z=Q.Enum||G;M.l<M.length;){var ue=M.read_shift(2),De=Z[ue]||Z[65535],Ee=M.read_shift(2),we=M.l+Ee,Te=De.f&&De.f(M,Ee,Q);if(M.l=we,z(Te,De,ue))return}}}function e(M,z){switch(z.type){case"base64":return r(Ca(Yn(M)),z);case"binary":return r(Ca(M),z);case"buffer":case"array":return r(M,z)}throw"Unsupported type "+z.type}function r(M,z){if(!M)return M;var Q=z||{},Z=Q.dense?[]:{},ue="Sheet1",De="",Ee=0,we={},Te=[],Ue=[],X={s:{r:0,c:0},e:{r:0,c:0}},nt=Q.sheetRows||0;if(M[2]==0&&(M[3]==8||M[3]==9)&&M.length>=16&&M[14]==5&&M[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(M[2]==2)Q.Enum=G,t(M,function(Pe,Ye,ut){switch(ut){case 0:Q.vers=Pe,Pe>=4096&&(Q.qpro=!0);break;case 6:X=Pe;break;case 204:Pe&&(De=Pe);break;case 222:De=Pe;break;case 15:case 51:Q.qpro||(Pe[1].v=Pe[1].v.slice(1));case 13:case 14:case 16:ut==14&&(Pe[2]&112)==112&&(Pe[2]&15)>1&&(Pe[2]&15)<15&&(Pe[1].z=Q.dateNF||ht[14],Q.cellDates&&(Pe[1].t="d",Pe[1].v=bd(Pe[1].v))),Q.qpro&&Pe[3]>Ee&&(Z["!ref"]=Gt(X),we[ue]=Z,Te.push(ue),Z=Q.dense?[]:{},X={s:{r:0,c:0},e:{r:0,c:0}},Ee=Pe[3],ue=De||"Sheet"+(Ee+1),De="");var _t=Q.dense?(Z[Pe[0].r]||[])[Pe[0].c]:Z[vt(Pe[0])];if(_t){_t.t=Pe[1].t,_t.v=Pe[1].v,Pe[1].z!=null&&(_t.z=Pe[1].z),Pe[1].f!=null&&(_t.f=Pe[1].f);break}Q.dense?(Z[Pe[0].r]||(Z[Pe[0].r]=[]),Z[Pe[0].r][Pe[0].c]=Pe[1]):Z[vt(Pe[0])]=Pe[1];break}},Q);else if(M[2]==26||M[2]==14)Q.Enum=se,M[2]==14&&(Q.qpro=!0,M.l=0),t(M,function(Pe,Ye,ut){switch(ut){case 204:ue=Pe;break;case 22:Pe[1].v=Pe[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(Pe[3]>Ee&&(Z["!ref"]=Gt(X),we[ue]=Z,Te.push(ue),Z=Q.dense?[]:{},X={s:{r:0,c:0},e:{r:0,c:0}},Ee=Pe[3],ue="Sheet"+(Ee+1)),nt>0&&Pe[0].r>=nt)break;Q.dense?(Z[Pe[0].r]||(Z[Pe[0].r]=[]),Z[Pe[0].r][Pe[0].c]=Pe[1]):Z[vt(Pe[0])]=Pe[1],X.e.c<Pe[0].c&&(X.e.c=Pe[0].c),X.e.r<Pe[0].r&&(X.e.r=Pe[0].r);break;case 27:Pe[14e3]&&(Ue[Pe[14e3][0]]=Pe[14e3][1]);break;case 1537:Ue[Pe[0]]=Pe[1],Pe[0]==Ee&&(ue=Pe[1]);break}},Q);else throw new Error("Unrecognized LOTUS BOF "+M[2]);if(Z["!ref"]=Gt(X),we[De||ue]=Z,Te.push(De||ue),!Ue.length)return{SheetNames:Te,Sheets:we};for(var qe={},We=[],Be=0;Be<Ue.length;++Be)we[Te[Be]]?(We.push(Ue[Be]||Te[Be]),qe[Ue[Be]]=we[Ue[Be]]||we[Te[Be]]):(We.push(Ue[Be]),qe[Ue[Be]]={"!ref":"A1"});return{SheetNames:We,Sheets:qe}}function n(M,z){var Q=z||{};if(+Q.codepage>=0&&ka(+Q.codepage),Q.type=="string")throw new Error("Cannot write WK1 to JS string");var Z=Fg(),ue=Kr(M["!ref"]),De=Array.isArray(M),Ee=[];Sa(Z,0,o(1030)),Sa(Z,6,h(ue));for(var we=Math.min(ue.e.r,8191),Te=ue.s.r;Te<=we;++Te)for(var Ue=Xn(Te),X=ue.s.c;X<=ue.e.c;++X){Te===ue.s.r&&(Ee[X]=wn(X));var nt=Ee[X]+Ue,qe=De?(M[Te]||[])[X]:M[nt];if(!(!qe||qe.t=="z"))if(qe.t=="n")(qe.v|0)==qe.v&&qe.v>=-32768&&qe.v<=32767?Sa(Z,13,A(Te,X,qe.v)):Sa(Z,14,R(Te,X,qe.v));else{var We=hc(qe);Sa(Z,15,_(Te,X,We.slice(0,239)))}}return Sa(Z,1),Z.end()}function i(M,z){var Q=z||{};if(+Q.codepage>=0&&ka(+Q.codepage),Q.type=="string")throw new Error("Cannot write WK3 to JS string");var Z=Fg();Sa(Z,0,c(M));for(var ue=0,De=0;ue<M.SheetNames.length;++ue)(M.Sheets[M.SheetNames[ue]]||{})["!ref"]&&Sa(Z,27,te(M.SheetNames[ue],De++));var Ee=0;for(ue=0;ue<M.SheetNames.length;++ue){var we=M.Sheets[M.SheetNames[ue]];if(!(!we||!we["!ref"])){for(var Te=Kr(we["!ref"]),Ue=Array.isArray(we),X=[],nt=Math.min(Te.e.r,8191),qe=Te.s.r;qe<=nt;++qe)for(var We=Xn(qe),Be=Te.s.c;Be<=Te.e.c;++Be){qe===Te.s.r&&(X[Be]=wn(Be));var Pe=X[Be]+We,Ye=Ue?(we[qe]||[])[Be]:we[Pe];if(!(!Ye||Ye.t=="z"))if(Ye.t=="n")Sa(Z,23,D(qe,Be,Ee,Ye.v));else{var ut=hc(Ye);Sa(Z,22,C(qe,Be,Ee,ut.slice(0,239)))}}++Ee}}return Sa(Z,1),Z.end()}function o(M){var z=Fr(2);return z.write_shift(2,M),z}function c(M){var z=Fr(26);z.write_shift(2,4096),z.write_shift(2,4),z.write_shift(4,0);for(var Q=0,Z=0,ue=0,De=0;De<M.SheetNames.length;++De){var Ee=M.SheetNames[De],we=M.Sheets[Ee];if(!(!we||!we["!ref"])){++ue;var Te=tv(we["!ref"]);Q<Te.e.r&&(Q=Te.e.r),Z<Te.e.c&&(Z=Te.e.c)}}return Q>8191&&(Q=8191),z.write_shift(2,Q),z.write_shift(1,ue),z.write_shift(1,Z),z.write_shift(2,0),z.write_shift(2,0),z.write_shift(1,1),z.write_shift(1,2),z.write_shift(4,0),z.write_shift(4,0),z}function u(M,z,Q){var Z={s:{c:0,r:0},e:{c:0,r:0}};return z==8&&Q.qpro?(Z.s.c=M.read_shift(1),M.l++,Z.s.r=M.read_shift(2),Z.e.c=M.read_shift(1),M.l++,Z.e.r=M.read_shift(2),Z):(Z.s.c=M.read_shift(2),Z.s.r=M.read_shift(2),z==12&&Q.qpro&&(M.l+=2),Z.e.c=M.read_shift(2),Z.e.r=M.read_shift(2),z==12&&Q.qpro&&(M.l+=2),Z.s.c==65535&&(Z.s.c=Z.e.c=Z.s.r=Z.e.r=0),Z)}function h(M){var z=Fr(8);return z.write_shift(2,M.s.c),z.write_shift(2,M.s.r),z.write_shift(2,M.e.c),z.write_shift(2,M.e.r),z}function d(M,z,Q){var Z=[{c:0,r:0},{t:"n",v:0},0,0];return Q.qpro&&Q.vers!=20768?(Z[0].c=M.read_shift(1),Z[3]=M.read_shift(1),Z[0].r=M.read_shift(2),M.l+=2):(Z[2]=M.read_shift(1),Z[0].c=M.read_shift(2),Z[0].r=M.read_shift(2)),Z}function g(M,z,Q){var Z=M.l+z,ue=d(M,z,Q);if(ue[1].t="s",Q.vers==20768){M.l++;var De=M.read_shift(1);return ue[1].v=M.read_shift(De,"utf8"),ue}return Q.qpro&&M.l++,ue[1].v=M.read_shift(Z-M.l,"cstr"),ue}function _(M,z,Q){var Z=Fr(7+Q.length);Z.write_shift(1,255),Z.write_shift(2,z),Z.write_shift(2,M),Z.write_shift(1,39);for(var ue=0;ue<Z.length;++ue){var De=Q.charCodeAt(ue);Z.write_shift(1,De>=128?95:De)}return Z.write_shift(1,0),Z}function x(M,z,Q){var Z=d(M,z,Q);return Z[1].v=M.read_shift(2,"i"),Z}function A(M,z,Q){var Z=Fr(7);return Z.write_shift(1,255),Z.write_shift(2,z),Z.write_shift(2,M),Z.write_shift(2,Q,"i"),Z}function S(M,z,Q){var Z=d(M,z,Q);return Z[1].v=M.read_shift(8,"f"),Z}function R(M,z,Q){var Z=Fr(13);return Z.write_shift(1,255),Z.write_shift(2,z),Z.write_shift(2,M),Z.write_shift(8,Q,"f"),Z}function w(M,z,Q){var Z=M.l+z,ue=d(M,z,Q);if(ue[1].v=M.read_shift(8,"f"),Q.qpro)M.l=Z;else{var De=M.read_shift(2);J(M.slice(M.l,M.l+De),ue),M.l+=De}return ue}function B(M,z,Q){var Z=z&32768;return z&=-32769,z=(Z?M:0)+(z>=8192?z-16384:z),(Z?"":"$")+(Q?wn(z):Xn(z))}var H={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},N=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function J(M,z){Zr(M,0);for(var Q=[],Z=0,ue="",De="",Ee="",we="";M.l<M.length;){var Te=M[M.l++];switch(Te){case 0:Q.push(M.read_shift(8,"f"));break;case 1:De=B(z[0].c,M.read_shift(2),!0),ue=B(z[0].r,M.read_shift(2),!1),Q.push(De+ue);break;case 2:{var Ue=B(z[0].c,M.read_shift(2),!0),X=B(z[0].r,M.read_shift(2),!1);De=B(z[0].c,M.read_shift(2),!0),ue=B(z[0].r,M.read_shift(2),!1),Q.push(Ue+X+":"+De+ue)}break;case 3:if(M.l<M.length){console.error("WK1 premature formula end");return}break;case 4:Q.push("("+Q.pop()+")");break;case 5:Q.push(M.read_shift(2));break;case 6:{for(var nt="";Te=M[M.l++];)nt+=String.fromCharCode(Te);Q.push('"'+nt.replace(/"/g,'""')+'"')}break;case 8:Q.push("-"+Q.pop());break;case 23:Q.push("+"+Q.pop());break;case 22:Q.push("NOT("+Q.pop()+")");break;case 20:case 21:we=Q.pop(),Ee=Q.pop(),Q.push(["AND","OR"][Te-20]+"("+Ee+","+we+")");break;default:if(Te<32&&N[Te])we=Q.pop(),Ee=Q.pop(),Q.push(Ee+N[Te]+we);else if(H[Te]){if(Z=H[Te][1],Z==69&&(Z=M[M.l++]),Z>Q.length){console.error("WK1 bad formula parse 0x"+Te.toString(16)+":|"+Q.join("|")+"|");return}var qe=Q.slice(-Z);Q.length-=Z,Q.push(H[Te][0]+"("+qe.join(",")+")")}else return Te<=7?console.error("WK1 invalid opcode "+Te.toString(16)):Te<=24?console.error("WK1 unsupported op "+Te.toString(16)):Te<=30?console.error("WK1 invalid opcode "+Te.toString(16)):Te<=115?console.error("WK1 unsupported function opcode "+Te.toString(16)):console.error("WK1 unrecognized opcode "+Te.toString(16))}}Q.length==1?z[1].f=""+Q[0]:console.error("WK1 bad formula parse |"+Q.join("|")+"|")}function re(M){var z=[{c:0,r:0},{t:"n",v:0},0];return z[0].r=M.read_shift(2),z[3]=M[M.l++],z[0].c=M[M.l++],z}function ne(M,z){var Q=re(M);return Q[1].t="s",Q[1].v=M.read_shift(z-4,"cstr"),Q}function C(M,z,Q,Z){var ue=Fr(6+Z.length);ue.write_shift(2,M),ue.write_shift(1,Q),ue.write_shift(1,z),ue.write_shift(1,39);for(var De=0;De<Z.length;++De){var Ee=Z.charCodeAt(De);ue.write_shift(1,Ee>=128?95:Ee)}return ue.write_shift(1,0),ue}function T(M,z){var Q=re(M);Q[1].v=M.read_shift(2);var Z=Q[1].v>>1;if(Q[1].v&1)switch(Z&7){case 0:Z=(Z>>3)*5e3;break;case 1:Z=(Z>>3)*500;break;case 2:Z=(Z>>3)/20;break;case 3:Z=(Z>>3)/200;break;case 4:Z=(Z>>3)/2e3;break;case 5:Z=(Z>>3)/2e4;break;case 6:Z=(Z>>3)/16;break;case 7:Z=(Z>>3)/64;break}return Q[1].v=Z,Q}function E(M,z){var Q=re(M),Z=M.read_shift(4),ue=M.read_shift(4),De=M.read_shift(2);if(De==65535)return Z===0&&ue===3221225472?(Q[1].t="e",Q[1].v=15):Z===0&&ue===3489660928?(Q[1].t="e",Q[1].v=42):Q[1].v=0,Q;var Ee=De&32768;return De=(De&32767)-16446,Q[1].v=(1-Ee*2)*(ue*Math.pow(2,De+32)+Z*Math.pow(2,De)),Q}function D(M,z,Q,Z){var ue=Fr(14);if(ue.write_shift(2,M),ue.write_shift(1,Q),ue.write_shift(1,z),Z==0)return ue.write_shift(4,0),ue.write_shift(4,0),ue.write_shift(2,65535),ue;var De=0,Ee=0,we=0,Te=0;return Z<0&&(De=1,Z=-Z),Ee=Math.log2(Z)|0,Z/=Math.pow(2,Ee-31),Te=Z>>>0,(Te&2147483648)==0&&(Z/=2,++Ee,Te=Z>>>0),Z-=Te,Te|=2147483648,Te>>>=0,Z*=Math.pow(2,32),we=Z>>>0,ue.write_shift(4,we),ue.write_shift(4,Te),Ee+=16383+(De?32768:0),ue.write_shift(2,Ee),ue}function b(M,z){var Q=E(M);return M.l+=z-14,Q}function O(M,z){var Q=re(M),Z=M.read_shift(4);return Q[1].v=Z>>6,Q}function F(M,z){var Q=re(M),Z=M.read_shift(8,"f");return Q[1].v=Z,Q}function Fe(M,z){var Q=F(M);return M.l+=z-10,Q}function Ce(M,z){return M[M.l+z-1]==0?M.read_shift(z,"cstr"):""}function ae(M,z){var Q=M[M.l++];Q>z-1&&(Q=z-1);for(var Z="";Z.length<Q;)Z+=String.fromCharCode(M[M.l++]);return Z}function oe(M,z,Q){if(!(!Q.qpro||z<21)){var Z=M.read_shift(1);M.l+=17,M.l+=1,M.l+=2;var ue=M.read_shift(z-21,"cstr");return[Z,ue]}}function Oe(M,z){for(var Q={},Z=M.l+z;M.l<Z;){var ue=M.read_shift(2);if(ue==14e3){for(Q[ue]=[0,""],Q[ue][0]=M.read_shift(2);M[M.l];)Q[ue][1]+=String.fromCharCode(M[M.l]),M.l++;M.l++}}return Q}function te(M,z){var Q=Fr(5+M.length);Q.write_shift(2,14e3),Q.write_shift(2,z);for(var Z=0;Z<M.length;++Z){var ue=M.charCodeAt(Z);Q[Q.l++]=ue>127?95:ue}return Q[Q.l++]=0,Q}var G={0:{n:"BOF",f:Rr},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:u},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:x},14:{n:"NUMBER",f:S},15:{n:"LABEL",f:g},16:{n:"FORMULA",f:w},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:g},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:Ce},222:{n:"SHEETNAMELP",f:ae},65535:{n:""}},se={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:ne},23:{n:"NUMBER17",f:E},24:{n:"NUMBER18",f:T},25:{n:"FORMULA19",f:b},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:Oe},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:O},38:{n:"??"},39:{n:"NUMBER27",f:F},40:{n:"FORMULA28",f:Fe},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:Ce},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:oe},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:i,to_workbook:e}}();function sM(t){var e={},r=t.match(gn),n=0,i=!1;if(r)for(;n!=r.length;++n){var o=st(r[n]);switch(o[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!o.val)break;case"<shadow>":case"<shadow/>":e.shadow=1;break;case"</shadow>":break;case"<charset":if(o.val=="1")break;e.cp=K1[parseInt(o.val,10)];break;case"<outline":if(!o.val)break;case"<outline>":case"<outline/>":e.outline=1;break;case"</outline>":break;case"<rFont":e.name=o.val;break;case"<sz":e.sz=o.val;break;case"<strike":if(!o.val)break;case"<strike>":case"<strike/>":e.strike=1;break;case"</strike>":break;case"<u":if(!o.val)break;switch(o.val){case"double":e.uval="double";break;case"singleAccounting":e.uval="single-accounting";break;case"doubleAccounting":e.uval="double-accounting";break}case"<u>":case"<u/>":e.u=1;break;case"</u>":break;case"<b":if(o.val=="0")break;case"<b>":case"<b/>":e.b=1;break;case"</b>":break;case"<i":if(o.val=="0")break;case"<i>":case"<i/>":e.i=1;break;case"</i>":break;case"<color":o.rgb&&(e.color=o.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":e.family=o.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":e.valign=o.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(o[0].charCodeAt(1)!==47&&!i)throw new Error("Unrecognized rich format "+o[0])}}return e}var oM=function(){var t=hf("t"),e=hf("rPr");function r(o){var c=o.match(t);if(!c)return{t:"s",v:""};var u={t:"s",v:Nt(c[1])},h=o.match(e);return h&&(u.s=sM(h[1])),u}var n=/<(?:\w+:)?r>/g,i=/<\/(?:\w+:)?r>/;return function(c){return c.replace(n,"").split(i).map(r).filter(function(u){return u.v})}}(),lM=function(){var e=/(\r\n|\n)/g;function r(i,o,c){var u=[];i.u&&u.push("text-decoration: underline;"),i.uval&&u.push("text-underline-style:"+i.uval+";"),i.sz&&u.push("font-size:"+i.sz+"pt;"),i.outline&&u.push("text-effect: outline;"),i.shadow&&u.push("text-shadow: auto;"),o.push('<span style="'+u.join("")+'">'),i.b&&(o.push("<b>"),c.push("</b>")),i.i&&(o.push("<i>"),c.push("</i>")),i.strike&&(o.push("<s>"),c.push("</s>"));var h=i.valign||"";return h=="superscript"||h=="super"?h="sup":h=="subscript"&&(h="sub"),h!=""&&(o.push("<"+h+">"),c.push("</"+h+">")),c.push("</span>"),i}function n(i){var o=[[],i.v,[]];return i.v?(i.s&&r(i.s,o[0],o[2]),o[0].join("")+o[1].replace(e,"<br/>")+o[2].join("")):""}return function(o){return o.map(n).join("")}}(),cM=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,uM=/<(?:\w+:)?r>/,fM=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function ov(t,e){var r=e?e.cellHTML:!0,n={};return t?(t.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=Nt(Jt(t.slice(t.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=Jt(t),r&&(n.h=FS(n.t))):t.match(uM)&&(n.r=Jt(t),n.t=Nt(Jt((t.replace(fM,"").match(cM)||[]).join("").replace(gn,""))),r&&(n.h=lM(oM(n.r)))),n):{t:""}}var hM=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,dM=/<(?:\w+:)?(?:si|sstItem)>/g,pM=/<\/(?:\w+:)?(?:si|sstItem)>/;function mM(t,e){var r=[],n="";if(!t)return r;var i=t.match(hM);if(i){n=i[2].replace(dM,"").split(pM);for(var o=0;o!=n.length;++o){var c=ov(n[o].trim(),e);c!=null&&(r[r.length]=c)}i=st(i[1]),r.Count=i.count,r.Unique=i.uniqueCount}return r}function gM(t){return[t.read_shift(4),t.read_shift(4)]}function vM(t,e){var r=[],n=!1;return Hi(t,function(o,c,u){switch(u){case 159:r.Count=o[0],r.Unique=o[1];break;case 19:r.push(o);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(c.T,!n||e.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}),r}function m4(t){for(var e=[],r=t.split(""),n=0;n<r.length;++n)e[n]=r[n].charCodeAt(0);return e}function Li(t,e){var r={};return r.Major=t.read_shift(2),r.Minor=t.read_shift(2),e>=4&&(t.l+=e-4),r}function _M(t){var e={};return e.id=t.read_shift(0,"lpp4"),e.R=Li(t,4),e.U=Li(t,4),e.W=Li(t,4),e}function xM(t){for(var e=t.read_shift(4),r=t.l+e-4,n={},i=t.read_shift(4),o=[];i-- >0;)o.push({t:t.read_shift(4),v:t.read_shift(0,"lpp4")});if(n.name=t.read_shift(0,"lpp4"),n.comps=o,t.l!=r)throw new Error("Bad DataSpaceMapEntry: "+t.l+" != "+r);return n}function yM(t){var e=[];t.l+=4;for(var r=t.read_shift(4);r-- >0;)e.push(xM(t));return e}function EM(t){var e=[];t.l+=4;for(var r=t.read_shift(4);r-- >0;)e.push(t.read_shift(0,"lpp4"));return e}function TM(t){var e={};return t.read_shift(4),t.l+=4,e.id=t.read_shift(0,"lpp4"),e.name=t.read_shift(0,"lpp4"),e.R=Li(t,4),e.U=Li(t,4),e.W=Li(t,4),e}function AM(t){var e=TM(t);if(e.ename=t.read_shift(0,"8lpp4"),e.blksz=t.read_shift(4),e.cmode=t.read_shift(4),t.read_shift(4)!=4)throw new Error("Bad !Primary record");return e}function g4(t,e){var r=t.l+e,n={};n.Flags=t.read_shift(4)&63,t.l+=4,n.AlgID=t.read_shift(4);var i=!1;switch(n.AlgID){case 26126:case 26127:case 26128:i=n.Flags==36;break;case 26625:i=n.Flags==4;break;case 0:i=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!i)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=t.read_shift(4),n.KeySize=t.read_shift(4),n.ProviderType=t.read_shift(4),t.l+=8,n.CSPName=t.read_shift(r-t.l>>1,"utf16le"),t.l=r,n}function v4(t,e){var r={},n=t.l+e;return t.l+=4,r.Salt=t.slice(t.l,t.l+16),t.l+=16,r.Verifier=t.slice(t.l,t.l+16),t.l+=16,t.read_shift(4),r.VerifierHash=t.slice(t.l,n),t.l=n,r}function wM(t){var e=Li(t);switch(e.Minor){case 2:return[e.Minor,SM(t)];case 3:return[e.Minor,CM()];case 4:return[e.Minor,RM(t)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+e.Minor)}function SM(t){var e=t.read_shift(4);if((e&63)!=36)throw new Error("EncryptionInfo mismatch");var r=t.read_shift(4),n=g4(t,r),i=v4(t,t.length-t.l);return{t:"Std",h:n,v:i}}function CM(){throw new Error("File is password-protected: ECMA-376 Extensible")}function RM(t){var e=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];t.l+=4;var r=t.read_shift(t.length-t.l,"utf8"),n={};return r.replace(gn,function(o){var c=st(o);switch(si(c[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":e.forEach(function(u){n[u]=c[u]});break;case"<dataIntegrity":n.encryptedHmacKey=c.encryptedHmacKey,n.encryptedHmacValue=c.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=c.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(c);break;default:throw c[0]}}),n}function kM(t,e){var r={},n=r.EncryptionVersionInfo=Li(t,4);if(e-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);r.Flags=t.read_shift(4),e-=4;var i=t.read_shift(4);return e-=4,r.EncryptionHeader=g4(t,i),e-=i,r.EncryptionVerifier=v4(t,e),r}function bM(t){var e={},r=e.EncryptionVersionInfo=Li(t,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return e.Salt=t.read_shift(16),e.EncryptedVerifier=t.read_shift(16),e.EncryptedVerifierHash=t.read_shift(16),e}function IM(t){var e=0,r,n=m4(t),i=n.length+1,o,c,u,h,d;for(r=qs(i),r[0]=n.length,o=1;o!=i;++o)r[o]=n[o-1];for(o=i-1;o>=0;--o)c=r[o],u=(e&16384)===0?0:1,h=e<<1&32767,d=u|h,e=d^c;return e^52811}var _4=function(){var t=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],e=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(c){return(c/2|c*128)&255},i=function(c,u){return n(c^u)},o=function(c){for(var u=e[c.length-1],h=104,d=c.length-1;d>=0;--d)for(var g=c[d],_=0;_!=7;++_)g&64&&(u^=r[h]),g*=2,--h;return u};return function(c){for(var u=m4(c),h=o(u),d=u.length,g=qs(16),_=0;_!=16;++_)g[_]=0;var x,A,S;for((d&1)===1&&(x=h>>8,g[d]=i(t[0],x),--d,x=h&255,A=u[u.length-1],g[d]=i(A,x));d>0;)--d,x=h>>8,g[d]=i(u[d],x),--d,x=h&255,g[d]=i(u[d],x);for(d=15,S=15-u.length;S>0;)x=h>>8,g[d]=i(t[S],x),--d,--S,x=h&255,g[d]=i(u[d],x),--d,--S;return g}}(),DM=function(t,e,r,n,i){i||(i=e),n||(n=_4(t));var o,c;for(o=0;o!=e.length;++o)c=e[o],c^=n[r],c=(c>>5|c<<3)&255,i[o]=c,++r;return[i,r,n]},OM=function(t){var e=0,r=_4(t);return function(n){var i=DM("",n,e,r);return e=i[1],i[0]}};function NM(t,e,r,n){var i={key:Rr(t),verificationBytes:Rr(t)};return r.password&&(i.verifier=IM(r.password)),n.valid=i.verificationBytes===i.verifier,n.valid&&(n.insitu=OM(r.password)),i}function FM(t,e,r){var n=r||{};return n.Info=t.read_shift(2),t.l-=2,n.Info===1?n.Data=bM(t):n.Data=kM(t,e),n}function PM(t,e,r){var n={Type:r.biff>=8?t.read_shift(2):0};return n.Type?FM(t,e-2,n):NM(t,r.biff>=8?e:e-2,r,n),n}var MM=function(){function t(i,o){switch(o.type){case"base64":return e(Yn(i),o);case"binary":return e(i,o);case"buffer":return e(wt&&Buffer.isBuffer(i)?i.toString("binary"):Zo(i),o);case"array":return e(Ho(i),o)}throw new Error("Unrecognized type "+o.type)}function e(i,o){var c=o||{},u=c.dense?[]:{},h=i.match(/\\trowd.*?\\row\b/g);if(!h.length)throw new Error("RTF missing table");var d={s:{c:0,r:0},e:{c:0,r:h.length-1}};return h.forEach(function(g,_){Array.isArray(u)&&(u[_]=[]);for(var x=/\\\w+\b/g,A=0,S,R=-1;S=x.exec(g);){switch(S[0]){case"\\cell":var w=g.slice(A,x.lastIndex-S[0].length);if(w[0]==" "&&(w=w.slice(1)),++R,w.length){var B={v:w,t:"s"};Array.isArray(u)?u[_][R]=B:u[vt({r:_,c:R})]=B}break}A=x.lastIndex}R>d.e.c&&(d.e.c=R)}),u["!ref"]=Gt(d),u}function r(i,o){return Jo(t(i,o),o)}function n(i){for(var o=["{\\rtf1\\ansi"],c=Kr(i["!ref"]),u,h=Array.isArray(i),d=c.s.r;d<=c.e.r;++d){o.push("\\trowd\\trautofit1");for(var g=c.s.c;g<=c.e.c;++g)o.push("\\cellx"+(g+1));for(o.push("\\pard\\intbl"),g=c.s.c;g<=c.e.c;++g){var _=vt({r:d,c:g});u=h?(i[d]||[])[g]:i[_],!(!u||u.v==null&&(!u.f||u.F))&&(o.push(" "+(u.w||(hc(u),u.w))),o.push("\\cell"))}o.push("\\pard\\intbl\\row")}return o.join("")+"}"}return{to_workbook:r,to_sheet:t,from_sheet:n}}();function LM(t){var e=t.slice(t[0]==="#"?1:0).slice(0,6);return[parseInt(e.slice(0,2),16),parseInt(e.slice(2,4),16),parseInt(e.slice(4,6),16)]}function mf(t){for(var e=0,r=1;e!=3;++e)r=r*256+(t[e]>255?255:t[e]<0?0:t[e]);return r.toString(16).toUpperCase().slice(1)}function VM(t){var e=t[0]/255,r=t[1]/255,n=t[2]/255,i=Math.max(e,r,n),o=Math.min(e,r,n),c=i-o;if(c===0)return[0,0,e];var u=0,h=0,d=i+o;switch(h=c/(d>1?2-d:d),i){case e:u=((r-n)/c+6)%6;break;case r:u=(n-e)/c+2;break;case n:u=(e-r)/c+4;break}return[u/6,h,d/2]}function UM(t){var e=t[0],r=t[1],n=t[2],i=r*2*(n<.5?n:1-n),o=n-i/2,c=[o,o,o],u=6*e,h;if(r!==0)switch(u|0){case 0:case 6:h=i*u,c[0]+=i,c[1]+=h;break;case 1:h=i*(2-u),c[0]+=h,c[1]+=i;break;case 2:h=i*(u-2),c[1]+=i,c[2]+=h;break;case 3:h=i*(4-u),c[1]+=h,c[2]+=i;break;case 4:h=i*(u-4),c[2]+=i,c[0]+=h;break;case 5:h=i*(6-u),c[2]+=h,c[0]+=i;break}for(var d=0;d!=3;++d)c[d]=Math.round(c[d]*255);return c}function ed(t,e){if(e===0)return t;var r=VM(LM(t));return e<0?r[2]=r[2]*(1+e):r[2]=1-(1-r[2])*(1-e),mf(UM(r))}var x4=6,BM=15,jM=1,An=x4;function td(t){return Math.floor((t+Math.round(128/An)/256)*An)}function rd(t){return Math.floor((t-5)/An*100+.5)/100}function Vg(t){return Math.round((t*An+5)/An*256)/256}function Zm(t){return Vg(rd(td(t)))}function lv(t){var e=Math.abs(t-Zm(t)),r=An;if(e>.005)for(An=jM;An<BM;++An)Math.abs(t-Zm(t))<=e&&(e=Math.abs(t-Zm(t)),r=An);An=r}function dc(t){t.width?(t.wpx=td(t.width),t.wch=rd(t.wpx),t.MDW=An):t.wpx?(t.wch=rd(t.wpx),t.width=Vg(t.wch),t.MDW=An):typeof t.wch=="number"&&(t.width=Vg(t.wch),t.wpx=td(t.width),t.MDW=An),t.customWidth&&delete t.customWidth}var zM=96,y4=zM;function E4(t){return t*96/y4}function gf(t){return t*y4/96}var HM={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function GM(t,e,r,n){e.Borders=[];var i={},o=!1;(t[0].match(gn)||[]).forEach(function(c){var u=st(c);switch(si(u[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":i={},u.diagonalUp&&(i.diagonalUp=ir(u.diagonalUp)),u.diagonalDown&&(i.diagonalDown=ir(u.diagonalDown)),e.Borders.push(i);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":o=!0;break;case"</ext>":o=!1;break;default:if(n&&n.WTF&&!o)throw new Error("unrecognized "+u[0]+" in borders")}})}function qM(t,e,r,n){e.Fills=[];var i={},o=!1;(t[0].match(gn)||[]).forEach(function(c){var u=st(c);switch(si(u[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":i={},e.Fills.push(i);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":e.Fills.push(i),i={};break;case"<patternFill":case"<patternFill>":u.patternType&&(i.patternType=u.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":i.bgColor||(i.bgColor={}),u.indexed&&(i.bgColor.indexed=parseInt(u.indexed,10)),u.theme&&(i.bgColor.theme=parseInt(u.theme,10)),u.tint&&(i.bgColor.tint=parseFloat(u.tint)),u.rgb&&(i.bgColor.rgb=u.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":i.fgColor||(i.fgColor={}),u.theme&&(i.fgColor.theme=parseInt(u.theme,10)),u.tint&&(i.fgColor.tint=parseFloat(u.tint)),u.rgb!=null&&(i.fgColor.rgb=u.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":o=!0;break;case"</ext>":o=!1;break;default:if(n&&n.WTF&&!o)throw new Error("unrecognized "+u[0]+" in fills")}})}function KM(t,e,r,n){e.Fonts=[];var i={},o=!1;(t[0].match(gn)||[]).forEach(function(c){var u=st(c);switch(si(u[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":e.Fonts.push(i),i={};break;case"<name":u.val&&(i.name=Jt(u.val));break;case"<name/>":case"</name>":break;case"<b":i.bold=u.val?ir(u.val):1;break;case"<b/>":i.bold=1;break;case"<i":i.italic=u.val?ir(u.val):1;break;case"<i/>":i.italic=1;break;case"<u":switch(u.val){case"none":i.underline=0;break;case"single":i.underline=1;break;case"double":i.underline=2;break;case"singleAccounting":i.underline=33;break;case"doubleAccounting":i.underline=34;break}break;case"<u/>":i.underline=1;break;case"<strike":i.strike=u.val?ir(u.val):1;break;case"<strike/>":i.strike=1;break;case"<outline":i.outline=u.val?ir(u.val):1;break;case"<outline/>":i.outline=1;break;case"<shadow":i.shadow=u.val?ir(u.val):1;break;case"<shadow/>":i.shadow=1;break;case"<condense":i.condense=u.val?ir(u.val):1;break;case"<condense/>":i.condense=1;break;case"<extend":i.extend=u.val?ir(u.val):1;break;case"<extend/>":i.extend=1;break;case"<sz":u.val&&(i.sz=+u.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":u.val&&(i.vertAlign=u.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":u.val&&(i.family=parseInt(u.val,10));break;case"<family/>":case"</family>":break;case"<scheme":u.val&&(i.scheme=u.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(u.val=="1")break;u.codepage=K1[parseInt(u.val,10)];break;case"<color":if(i.color||(i.color={}),u.auto&&(i.color.auto=ir(u.auto)),u.rgb)i.color.rgb=u.rgb.slice(-6);else if(u.indexed){i.color.index=parseInt(u.indexed,10);var h=Mo[i.color.index];i.color.index==81&&(h=Mo[1]),h||(h=Mo[1]),i.color.rgb=h[0].toString(16)+h[1].toString(16)+h[2].toString(16)}else u.theme&&(i.color.theme=parseInt(u.theme,10),u.tint&&(i.color.tint=parseFloat(u.tint)),u.theme&&r.themeElements&&r.themeElements.clrScheme&&(i.color.rgb=ed(r.themeElements.clrScheme[i.color.theme].rgb,i.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":o=!0;break;case"</AlternateContent>":o=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":o=!0;break;case"</ext>":o=!1;break;default:if(n&&n.WTF&&!o)throw new Error("unrecognized "+u[0]+" in fonts")}})}function WM(t,e,r){e.NumberFmt=[];for(var n=Ks(ht),i=0;i<n.length;++i)e.NumberFmt[n[i]]=ht[n[i]];var o=t[0].match(gn);if(o)for(i=0;i<o.length;++i){var c=st(o[i]);switch(si(c[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var u=Nt(Jt(c.formatCode)),h=parseInt(c.numFmtId,10);if(e.NumberFmt[h]=u,h>0){if(h>392){for(h=392;h>60&&e.NumberFmt[h]!=null;--h);e.NumberFmt[h]=u}Po(u,h)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+c[0]+" in numFmts")}}}var h0=["numFmtId","fillId","fontId","borderId","xfId"],d0=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function XM(t,e,r){e.CellXf=[];var n,i=!1;(t[0].match(gn)||[]).forEach(function(o){var c=st(o),u=0;switch(si(c[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=c,delete n[0],u=0;u<h0.length;++u)n[h0[u]]&&(n[h0[u]]=parseInt(n[h0[u]],10));for(u=0;u<d0.length;++u)n[d0[u]]&&(n[d0[u]]=ir(n[d0[u]]));if(e.NumberFmt&&n.numFmtId>392){for(u=392;u>60;--u)if(e.NumberFmt[n.numFmtId]==e.NumberFmt[u]){n.numFmtId=u;break}}e.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var h={};c.vertical&&(h.vertical=c.vertical),c.horizontal&&(h.horizontal=c.horizontal),c.textRotation!=null&&(h.textRotation=c.textRotation),c.indent&&(h.indent=c.indent),c.wrapText&&(h.wrapText=ir(c.wrapText)),n.alignment=h;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":i=!0;break;case"</AlternateContent>":i=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(r&&r.WTF&&!i)throw new Error("unrecognized "+c[0]+" in cellXfs")}})}var YM=function(){var e=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,i=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,o=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(u,h,d){var g={};if(!u)return g;u=u.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var _;return(_=u.match(e))&&WM(_,g,d),(_=u.match(i))&&KM(_,g,h,d),(_=u.match(n))&&qM(_,g,h,d),(_=u.match(o))&&GM(_,g,h,d),(_=u.match(r))&&XM(_,g,d),g}}();function $M(t,e){var r=t.read_shift(2),n=dn(t);return[r,n]}function QM(t,e,r){var n={};n.sz=t.read_shift(2)/20;var i=o8(t);i.fItalic&&(n.italic=1),i.fCondense&&(n.condense=1),i.fExtend&&(n.extend=1),i.fShadow&&(n.shadow=1),i.fOutline&&(n.outline=1),i.fStrikeout&&(n.strike=1);var o=t.read_shift(2);switch(o===700&&(n.bold=1),t.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var c=t.read_shift(1);c!=0&&(n.underline=c);var u=t.read_shift(1);u>0&&(n.family=u);var h=t.read_shift(1);switch(h>0&&(n.charset=h),t.l++,n.color=s8(t),t.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=dn(t),n}var ZM=mn;function JM(t,e){var r=t.l+e,n=t.read_shift(2),i=t.read_shift(2);return t.l=r,{ixfe:n,numFmtId:i}}var e5=mn;function t5(t,e,r){var n={};n.NumberFmt=[];for(var i in ht)n.NumberFmt[i]=ht[i];n.CellXf=[],n.Fonts=[];var o=[],c=!1;return Hi(t,function(h,d,g){switch(g){case 44:n.NumberFmt[h[0]]=h[1],Po(h[1],h[0]);break;case 43:n.Fonts.push(h),h.color.theme!=null&&e&&e.themeElements&&e.themeElements.clrScheme&&(h.color.rgb=ed(e.themeElements.clrScheme[h.color.theme].rgb,h.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:o[o.length-1]==617&&n.CellXf.push(h);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:c=!0;break;case 36:c=!1;break;case 37:o.push(g),c=!0;break;case 38:o.pop(),c=!1;break;default:if(d.T>0)o.push(g);else if(d.T<0)o.pop();else if(!c||r.WTF&&o[o.length-1]!=37)throw new Error("Unexpected record 0x"+g.toString(16))}}),n}var r5=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function n5(t,e,r){e.themeElements.clrScheme=[];var n={};(t[0].match(gn)||[]).forEach(function(i){var o=st(i);switch(o[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=o.val;break;case"<a:sysClr":n.rgb=o.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":o[0].charAt(1)==="/"?(e.themeElements.clrScheme[r5.indexOf(o[0])]=n,n={}):n.name=o[0].slice(3,o[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+o[0]+" in clrScheme")}})}function a5(){}function i5(){}var s5=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,o5=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,l5=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function c5(t,e,r){e.themeElements={};var n;[["clrScheme",s5,n5],["fontScheme",o5,a5],["fmtScheme",l5,i5]].forEach(function(i){if(!(n=t.match(i[1])))throw new Error(i[0]+" not found in themeElements");i[2](n,e,r)})}var u5=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function T4(t,e){(!t||t.length===0)&&(t=f5());var r,n={};if(!(r=t.match(u5)))throw new Error("themeElements not found in theme");return c5(r[0],n,e),n.raw=t,n}function f5(t,e){var r=[OS];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',r[r.length]='<a:font script="Hang" typeface="맑은 고딕"/>',r[r.length]='<a:font script="Hans" typeface="宋体"/>',r[r.length]='<a:font script="Hant" typeface="新細明體"/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',r[r.length]='<a:font script="Hang" typeface="맑은 고딕"/>',r[r.length]='<a:font script="Hans" typeface="宋体"/>',r[r.length]='<a:font script="Hant" typeface="新細明體"/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function h5(t,e,r){var n=t.l+e,i=t.read_shift(4);if(i!==124226){if(!r.cellStyles){t.l=n;return}var o=t.slice(t.l);t.l=n;var c;try{c=DS(o,{type:"array"})}catch{return}var u=Kn(c,"theme/theme/theme1.xml",!0);if(u)return T4(u,r)}}function d5(t){return t.read_shift(4)}function p5(t){var e={};switch(e.xclrType=t.read_shift(2),e.nTintShade=t.read_shift(2),e.xclrType){case 0:t.l+=4;break;case 1:e.xclrValue=m5(t,4);break;case 2:e.xclrValue=l4(t);break;case 3:e.xclrValue=d5(t);break;case 4:t.l+=4;break}return t.l+=8,e}function m5(t,e){return mn(t,e)}function g5(t,e){return mn(t,e)}function v5(t){var e=t.read_shift(2),r=t.read_shift(2)-4,n=[e];switch(e){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=p5(t);break;case 6:n[1]=g5(t,r);break;case 14:case 15:n[1]=t.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+e+" "+r)}return n}function _5(t,e){var r=t.l+e;t.l+=2;var n=t.read_shift(2);t.l+=2;for(var i=t.read_shift(2),o=[];i-- >0;)o.push(v5(t,r-t.l));return{ixfe:n,ext:o}}function x5(t,e){e.forEach(function(r){r[0]})}function y5(t,e){return{flags:t.read_shift(4),version:t.read_shift(4),name:dn(t)}}function E5(t){for(var e=[],r=t.read_shift(4);r-- >0;)e.push([t.read_shift(4),t.read_shift(4)]);return e}function T5(t){return t.l+=4,t.read_shift(4)!=0}function A5(t,e,r){var n={Types:[],Cell:[],Value:[]},i=r||{},o=[],c=!1,u=2;return Hi(t,function(h,d,g){switch(g){case 335:n.Types.push({name:h.name});break;case 51:h.forEach(function(_){u==1?n.Cell.push({type:n.Types[_[0]-1].name,index:_[1]}):u==0&&n.Value.push({type:n.Types[_[0]-1].name,index:_[1]})});break;case 337:u=h?1:0;break;case 338:u=2;break;case 35:o.push(g),c=!0;break;case 36:o.pop(),c=!1;break;default:if(!d.T){if(!c||i.WTF&&o[o.length-1]!=35)throw new Error("Unexpected record 0x"+g.toString(16))}}}),n}function w5(t,e,r){var n={Types:[],Cell:[],Value:[]};if(!t)return n;var i=!1,o=2,c;return t.replace(gn,function(u){var h=st(u);switch(si(h[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:h.name});break;case"</metadataType>":break;case"<futureMetadata":for(var d=0;d<n.Types.length;++d)n.Types[d].name==h.name&&(c=n.Types[d]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":o==1?n.Cell.push({type:n.Types[h.t-1].name,index:+h.v}):o==0&&n.Value.push({type:n.Types[h.t-1].name,index:+h.v});break;case"</rc>":break;case"<cellMetadata":o=1;break;case"</cellMetadata>":o=2;break;case"<valueMetadata":o=0;break;case"</valueMetadata>":o=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;case"<rvb":if(!c)break;c.offsets||(c.offsets=[]),c.offsets.push(+h.i);break;default:if(!i&&r.WTF)throw new Error("unrecognized "+h[0]+" in metadata")}return u}),n}function S5(t){var e=[];if(!t)return e;var r=1;return(t.match(gn)||[]).forEach(function(n){var i=st(n);switch(i[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete i[0],i.i?r=i.i:i.i=r,e.push(i);break}}),e}function C5(t){var e={};e.i=t.read_shift(4);var r={};r.r=t.read_shift(4),r.c=t.read_shift(4),e.r=vt(r);var n=t.read_shift(1);return n&2&&(e.l="1"),n&8&&(e.a="1"),e}function R5(t,e,r){var n=[];return Hi(t,function(o,c,u){switch(u){case 63:n.push(o);break;default:if(!c.T)throw new Error("Unexpected record 0x"+u.toString(16))}}),n}function k5(t,e,r,n){if(!t)return t;var i=n||{},o=!1;Hi(t,function(u,h,d){switch(d){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:o=!0;break;case 36:o=!1;break;default:if(!h.T){if(!o||i.WTF)throw new Error("Unexpected record 0x"+d.toString(16))}}},i)}function b5(t,e){if(!t)return"??";var r=(t.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return e["!id"][r].Target}function s2(t,e,r,n){var i=Array.isArray(t),o;e.forEach(function(c){var u=Ia(c.ref);if(i?(t[u.r]||(t[u.r]=[]),o=t[u.r][u.c]):o=t[c.ref],!o){o={t:"z"},i?t[u.r][u.c]=o:t[c.ref]=o;var h=Kr(t["!ref"]||"BDWGO1000001:A1");h.s.r>u.r&&(h.s.r=u.r),h.e.r<u.r&&(h.e.r=u.r),h.s.c>u.c&&(h.s.c=u.c),h.e.c<u.c&&(h.e.c=u.c);var d=Gt(h);d!==t["!ref"]&&(t["!ref"]=d)}o.c||(o.c=[]);var g={a:c.author,t:c.t,r:c.r,T:r};c.h&&(g.h=c.h);for(var _=o.c.length-1;_>=0;--_){if(!r&&o.c[_].T)return;r&&!o.c[_].T&&o.c.splice(_,1)}if(r&&n){for(_=0;_<n.length;++_)if(g.a==n[_].id){g.a=n[_].name||g.a;break}}o.c.push(g)})}function I5(t,e){if(t.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],n=[],i=t.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);i&&i[1]&&i[1].split(/<\/\w*:?author>/).forEach(function(c){if(!(c===""||c.trim()==="")){var u=c.match(/<(?:\w+:)?author[^>]*>(.*)/);u&&r.push(u[1])}});var o=t.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return o&&o[1]&&o[1].split(/<\/\w*:?comment>/).forEach(function(c){if(!(c===""||c.trim()==="")){var u=c.match(/<(?:\w+:)?comment[^>]*>/);if(u){var h=st(u[0]),d={author:h.authorId&&r[h.authorId]||"sheetjsghost",ref:h.ref,guid:h.guid},g=Ia(h.ref);if(!(e.sheetRows&&e.sheetRows<=g.r)){var _=c.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),x=!!_&&!!_[1]&&ov(_[1])||{r:"",t:"",h:""};d.r=x.r,x.r=="<t></t>"&&(x.t=x.h=""),d.t=(x.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.cellHTML&&(d.h=x.h),n.push(d)}}}}),n}function D5(t,e){var r=[],n=!1,i={},o=0;return t.replace(gn,function(u,h){var d=st(u);switch(si(d[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":i={author:d.personId,guid:d.id,ref:d.ref,T:1};break;case"</threadedComment>":i.t!=null&&r.push(i);break;case"<text>":case"<text":o=h+u.length;break;case"</text>":i.t=t.slice(o,h).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&e.WTF)throw new Error("unrecognized "+d[0]+" in threaded comments")}return u}),r}function O5(t,e){var r=[],n=!1;return t.replace(gn,function(o){var c=st(o);switch(si(c[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:c.displayname,id:c.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&e.WTF)throw new Error("unrecognized "+c[0]+" in threaded comments")}return o}),r}function N5(t){var e={};e.iauthor=t.read_shift(4);var r=tl(t);return e.rfx=r.s,e.ref=vt(r.s),t.l+=16,e}var F5=dn;function P5(t,e){var r=[],n=[],i={},o=!1;return Hi(t,function(u,h,d){switch(d){case 632:n.push(u);break;case 635:i=u;break;case 637:i.t=u.t,i.h=u.h,i.r=u.r;break;case 636:if(i.author=n[i.iauthor],delete i.iauthor,e.sheetRows&&i.rfx&&e.sheetRows<=i.rfx.r)break;i.t||(i.t=""),delete i.rfx,r.push(i);break;case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:break;case 38:break;default:if(!h.T){if(!o||e.WTF)throw new Error("Unexpected record 0x"+d.toString(16))}}}),r}var M5="application/vnd.ms-office.vbaProject";function L5(t){var e=Dt.utils.cfb_new({root:"R"});return t.FullPaths.forEach(function(r,n){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var i=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");Dt.utils.cfb_add(e,i,t.FileIndex[n].content)}}),Dt.write(e)}function V5(){return{"!type":"dialog"}}function U5(){return{"!type":"dialog"}}function B5(){return{"!type":"macro"}}function j5(){return{"!type":"macro"}}var nc=function(){var t=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,e={r:0,c:0};function r(n,i,o,c){var u=!1,h=!1;o.length==0?h=!0:o.charAt(0)=="["&&(h=!0,o=o.slice(1,-1)),c.length==0?u=!0:c.charAt(0)=="["&&(u=!0,c=c.slice(1,-1));var d=o.length>0?parseInt(o,10)|0:0,g=c.length>0?parseInt(c,10)|0:0;return u?g+=e.c:--g,h?d+=e.r:--d,i+(u?"":"$")+wn(g)+(h?"":"$")+Xn(d)}return function(i,o){return e=o,i.replace(t,r)}}(),A4=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,z5=function(){return function(e,r){return e.replace(A4,function(n,i,o,c,u,h){var d=$S(c)-(o?0:r.c),g=YS(h)-(u?0:r.r),_=g==0?"":u?g+1:"["+g+"]",x=d==0?"":o?d+1:"["+d+"]";return i+"R"+_+"C"+x})}}();function w4(t,e){return t.replace(A4,function(r,n,i,o,c,u){return n+(i=="$"?i+o:wn($S(o)+e.c))+(c=="$"?c+u:Xn(YS(u)+e.r))})}function H5(t,e,r){var n=tv(e),i=n.s,o=Ia(r),c={r:o.r-i.r,c:o.c-i.c};return w4(t,c)}function G5(t){return t.length!=1}function o2(t){return t.replace(/_xlfn\./g,"")}function wr(t){t.l+=1}function Ws(t,e){var r=t.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function S4(t,e,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return C4(t);r.biff==12&&(n=4)}var i=t.read_shift(n),o=t.read_shift(n),c=Ws(t),u=Ws(t);return{s:{r:i,c:c[0],cRel:c[1],rRel:c[2]},e:{r:o,c:u[0],cRel:u[1],rRel:u[2]}}}function C4(t){var e=Ws(t),r=Ws(t),n=t.read_shift(1),i=t.read_shift(1);return{s:{r:e[0],c:n,cRel:e[1],rRel:e[2]},e:{r:r[0],c:i,cRel:r[1],rRel:r[2]}}}function q5(t,e,r){if(r.biff<8)return C4(t);var n=t.read_shift(r.biff==12?4:2),i=t.read_shift(r.biff==12?4:2),o=Ws(t),c=Ws(t);return{s:{r:n,c:o[0],cRel:o[1],rRel:o[2]},e:{r:i,c:c[0],cRel:c[1],rRel:c[2]}}}function R4(t,e,r){if(r&&r.biff>=2&&r.biff<=5)return K5(t);var n=t.read_shift(r&&r.biff==12?4:2),i=Ws(t);return{r:n,c:i[0],cRel:i[1],rRel:i[2]}}function K5(t){var e=Ws(t),r=t.read_shift(1);return{r:e[0],c:r,cRel:e[1],rRel:e[2]}}function W5(t){var e=t.read_shift(2),r=t.read_shift(2);return{r:e,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function X5(t,e,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return Y5(t);var i=t.read_shift(n>=12?4:2),o=t.read_shift(2),c=(o&16384)>>14,u=(o&32768)>>15;if(o&=16383,u==1)for(;i>524287;)i-=1048576;if(c==1)for(;o>8191;)o=o-16384;return{r:i,c:o,cRel:c,rRel:u}}function Y5(t){var e=t.read_shift(2),r=t.read_shift(1),n=(e&32768)>>15,i=(e&16384)>>14;return e&=16383,n==1&&e>=8192&&(e=e-16384),i==1&&r>=128&&(r=r-256),{r:e,c:r,cRel:i,rRel:n}}function $5(t,e,r){var n=(t[t.l++]&96)>>5,i=S4(t,r.biff>=2&&r.biff<=5?6:8,r);return[n,i]}function Q5(t,e,r){var n=(t[t.l++]&96)>>5,i=t.read_shift(2,"i"),o=8;if(r)switch(r.biff){case 5:t.l+=12,o=6;break;case 12:o=12;break}var c=S4(t,o,r);return[n,i,c]}function Z5(t,e,r){var n=(t[t.l++]&96)>>5;return t.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function J5(t,e,r){var n=(t[t.l++]&96)>>5,i=t.read_shift(2),o=8;if(r)switch(r.biff){case 5:t.l+=12,o=6;break;case 12:o=12;break}return t.l+=o,[n,i]}function eL(t,e,r){var n=(t[t.l++]&96)>>5,i=q5(t,e-1,r);return[n,i]}function tL(t,e,r){var n=(t[t.l++]&96)>>5;return t.l+=r.biff==2?6:r.biff==12?14:7,[n]}function l2(t){var e=t[t.l+1]&1,r=1;return t.l+=4,[e,r]}function rL(t,e,r){t.l+=2;for(var n=t.read_shift(r&&r.biff==2?1:2),i=[],o=0;o<=n;++o)i.push(t.read_shift(r&&r.biff==2?1:2));return i}function nL(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=2,[n,t.read_shift(r&&r.biff==2?1:2)]}function aL(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=2,[n,t.read_shift(r&&r.biff==2?1:2)]}function iL(t){var e=t[t.l+1]&255?1:0;return t.l+=2,[e,t.read_shift(2)]}function sL(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=r&&r.biff==2?3:4,[n]}function k4(t){var e=t.read_shift(1),r=t.read_shift(1);return[e,r]}function oL(t){return t.read_shift(2),k4(t)}function lL(t){return t.read_shift(2),k4(t)}function cL(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var i=R4(t,0,r);return[n,i]}function uL(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var i=X5(t,0,r);return[n,i]}function fL(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var i=t.read_shift(2);r&&r.biff==5&&(t.l+=12);var o=R4(t,0,r);return[n,i,o]}function hL(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var i=t.read_shift(r&&r.biff<=3?1:2);return[d9[i],D4[i],n]}function dL(t,e,r){var n=t[t.l++],i=t.read_shift(1),o=r&&r.biff<=3?[n==88?-1:0,t.read_shift(1)]:pL(t);return[i,(o[0]===0?D4:h9)[o[1]]]}function pL(t){return[t[t.l+1]>>7,t.read_shift(2)&32767]}function mL(t,e,r){t.l+=r&&r.biff==2?3:4}function gL(t,e,r){if(t.l++,r&&r.biff==12)return[t.read_shift(4,"i"),0];var n=t.read_shift(2),i=t.read_shift(r&&r.biff==2?1:2);return[n,i]}function vL(t){return t.l++,rl[t.read_shift(1)]}function _L(t){return t.l++,t.read_shift(2)}function xL(t){return t.l++,t.read_shift(1)!==0}function yL(t){return t.l++,fn(t)}function EL(t,e,r){return t.l++,Nf(t,e-1,r)}function TL(t,e){var r=[t.read_shift(1)];if(e==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=mr(t,1)?"TRUE":"FALSE",e!=12&&(t.l+=7);break;case 37:case 16:r[1]=rl[t[t.l]],t.l+=e==12?4:8;break;case 0:t.l+=8;break;case 1:r[1]=fn(t);break;case 2:r[1]=nl(t,0,{biff:e>0&&e<8?2:e});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function AL(t,e,r){for(var n=t.read_shift(r.biff==12?4:2),i=[],o=0;o!=n;++o)i.push((r.biff==12?tl:Id)(t));return i}function wL(t,e,r){var n=0,i=0;r.biff==12?(n=t.read_shift(4),i=t.read_shift(4)):(i=1+t.read_shift(1),n=1+t.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--i==0&&(i=256));for(var o=0,c=[];o!=n&&(c[o]=[]);++o)for(var u=0;u!=i;++u)c[o][u]=TL(t,r.biff);return c}function SL(t,e,r){var n=t.read_shift(1)>>>5&3,i=!r||r.biff>=8?4:2,o=t.read_shift(i);switch(r.biff){case 2:t.l+=5;break;case 3:case 4:t.l+=8;break;case 5:t.l+=12;break}return[n,0,o]}function CL(t,e,r){if(r.biff==5)return RL(t);var n=t.read_shift(1)>>>5&3,i=t.read_shift(2),o=t.read_shift(4);return[n,i,o]}function RL(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2,"i");t.l+=8;var n=t.read_shift(2);return t.l+=12,[e,r,n]}function kL(t,e,r){var n=t.read_shift(1)>>>5&3;t.l+=r&&r.biff==2?3:4;var i=t.read_shift(r&&r.biff==2?1:2);return[n,i]}function bL(t,e,r){var n=t.read_shift(1)>>>5&3,i=t.read_shift(r&&r.biff==2?1:2);return[n,i]}function IL(t,e,r){var n=t.read_shift(1)>>>5&3;return t.l+=4,r.biff<8&&t.l--,r.biff==12&&(t.l+=2),[n]}function DL(t,e,r){var n=(t[t.l++]&96)>>5,i=t.read_shift(2),o=4;if(r)switch(r.biff){case 5:o=15;break;case 12:o=6;break}return t.l+=o,[n,i]}var OL=mn,NL=mn,FL=mn;function Pf(t,e,r){return t.l+=2,[W5(t)]}function cv(t){return t.l+=6,[]}var PL=Pf,ML=cv,LL=cv,VL=Pf;function b4(t){return t.l+=2,[Rr(t),t.read_shift(2)&1]}var UL=Pf,BL=b4,jL=cv,zL=Pf,HL=Pf,GL=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function qL(t){t.l+=2;var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(4),i=t.read_shift(2),o=t.read_shift(2),c=GL[r>>2&31];return{ixti:e,coltype:r&3,rt:c,idx:n,c:i,C:o}}function KL(t){return t.l+=2,[t.read_shift(4)]}function WL(t,e,r){return t.l+=5,t.l+=2,t.l+=r.biff==2?1:4,["PTGSHEET"]}function XL(t,e,r){return t.l+=r.biff==2?4:5,["PTGENDSHEET"]}function YL(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2);return[e,r]}function $L(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2);return[e,r]}function QL(t){return t.l+=4,[0,0]}var c2={1:{n:"PtgExp",f:gL},2:{n:"PtgTbl",f:FL},3:{n:"PtgAdd",f:wr},4:{n:"PtgSub",f:wr},5:{n:"PtgMul",f:wr},6:{n:"PtgDiv",f:wr},7:{n:"PtgPower",f:wr},8:{n:"PtgConcat",f:wr},9:{n:"PtgLt",f:wr},10:{n:"PtgLe",f:wr},11:{n:"PtgEq",f:wr},12:{n:"PtgGe",f:wr},13:{n:"PtgGt",f:wr},14:{n:"PtgNe",f:wr},15:{n:"PtgIsect",f:wr},16:{n:"PtgUnion",f:wr},17:{n:"PtgRange",f:wr},18:{n:"PtgUplus",f:wr},19:{n:"PtgUminus",f:wr},20:{n:"PtgPercent",f:wr},21:{n:"PtgParen",f:wr},22:{n:"PtgMissArg",f:wr},23:{n:"PtgStr",f:EL},26:{n:"PtgSheet",f:WL},27:{n:"PtgEndSheet",f:XL},28:{n:"PtgErr",f:vL},29:{n:"PtgBool",f:xL},30:{n:"PtgInt",f:_L},31:{n:"PtgNum",f:yL},32:{n:"PtgArray",f:tL},33:{n:"PtgFunc",f:hL},34:{n:"PtgFuncVar",f:dL},35:{n:"PtgName",f:SL},36:{n:"PtgRef",f:cL},37:{n:"PtgArea",f:$5},38:{n:"PtgMemArea",f:kL},39:{n:"PtgMemErr",f:OL},40:{n:"PtgMemNoMem",f:NL},41:{n:"PtgMemFunc",f:bL},42:{n:"PtgRefErr",f:IL},43:{n:"PtgAreaErr",f:Z5},44:{n:"PtgRefN",f:uL},45:{n:"PtgAreaN",f:eL},46:{n:"PtgMemAreaN",f:YL},47:{n:"PtgMemNoMemN",f:$L},57:{n:"PtgNameX",f:CL},58:{n:"PtgRef3d",f:fL},59:{n:"PtgArea3d",f:Q5},60:{n:"PtgRefErr3d",f:DL},61:{n:"PtgAreaErr3d",f:J5},255:{}},ZL={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},JL={1:{n:"PtgElfLel",f:b4},2:{n:"PtgElfRw",f:zL},3:{n:"PtgElfCol",f:PL},6:{n:"PtgElfRwV",f:HL},7:{n:"PtgElfColV",f:VL},10:{n:"PtgElfRadical",f:UL},11:{n:"PtgElfRadicalS",f:jL},13:{n:"PtgElfColS",f:ML},15:{n:"PtgElfColSV",f:LL},16:{n:"PtgElfRadicalLel",f:BL},25:{n:"PtgList",f:qL},29:{n:"PtgSxName",f:KL},255:{}},e9={0:{n:"PtgAttrNoop",f:QL},1:{n:"PtgAttrSemi",f:sL},2:{n:"PtgAttrIf",f:aL},4:{n:"PtgAttrChoose",f:rL},8:{n:"PtgAttrGoto",f:nL},16:{n:"PtgAttrSum",f:mL},32:{n:"PtgAttrBaxcel",f:l2},33:{n:"PtgAttrBaxcel",f:l2},64:{n:"PtgAttrSpace",f:oL},65:{n:"PtgAttrSpaceSemi",f:lL},128:{n:"PtgAttrIfError",f:iL},255:{}};function Mf(t,e,r,n){if(n.biff<8)return mn(t,e);for(var i=t.l+e,o=[],c=0;c!==r.length;++c)switch(r[c][0]){case"PtgArray":r[c][1]=wL(t,0,n),o.push(r[c][1]);break;case"PtgMemArea":r[c][2]=AL(t,r[c][1],n),o.push(r[c][2]);break;case"PtgExp":n&&n.biff==12&&(r[c][1][1]=t.read_shift(4),o.push(r[c][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[c][0]}return e=i-t.l,e!==0&&o.push(mn(t,e)),o}function Lf(t,e,r){for(var n=t.l+e,i,o,c=[];n!=t.l;)e=n-t.l,o=t[t.l],i=c2[o]||c2[ZL[o]],(o===24||o===25)&&(i=(o===24?JL:e9)[t[t.l+1]]),!i||!i.f?mn(t,e):c.push([i.n,i.f(t,e,r)]);return c}function t9(t){for(var e=[],r=0;r<t.length;++r){for(var n=t[r],i=[],o=0;o<n.length;++o){var c=n[o];if(c)switch(c[0]){case 2:i.push('"'+c[1].replace(/"/g,'""')+'"');break;default:i.push(c[1])}else i.push("")}e.push(i.join(","))}return e.join(";")}var r9={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function n9(t,e){if(!t&&!(e&&e.biff<=5&&e.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(t)?"'"+t+"'":t}function I4(t,e,r){if(!t)return"SH33TJSERR0";if(r.biff>8&&(!t.XTI||!t.XTI[e]))return t.SheetNames[e];if(!t.XTI)return"SH33TJSERR6";var n=t.XTI[e];if(r.biff<8)return e>1e4&&(e-=65536),e<0&&(e=-e),e==0?"":t.XTI[e-1];if(!n)return"SH33TJSERR1";var i="";if(r.biff>8)switch(t[n[0]][0]){case 357:return i=n[1]==-1?"#REF":t.SheetNames[n[1]],n[1]==n[2]?i:i+":"+t.SheetNames[n[2]];case 358:return r.SID!=null?t.SheetNames[r.SID]:"SH33TJSSAME"+t[n[0]][0];case 355:default:return"SH33TJSSRC"+t[n[0]][0]}switch(t[n[0]][0][0]){case 1025:return i=n[1]==-1?"#REF":t.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?i:i+":"+t.SheetNames[n[2]];case 14849:return t[n[0]].slice(1).map(function(o){return o.Name}).join(";;");default:return t[n[0]][0][3]?(i=n[1]==-1?"#REF":t[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?i:i+":"+t[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function u2(t,e,r){var n=I4(t,e,r);return n=="#REF"?n:n9(n,r)}function cn(t,e,r,n,i){var o=i&&i.biff||8,c={s:{c:0,r:0}},u=[],h,d,g,_=0,x=0,A,S="";if(!t[0]||!t[0][0])return"";for(var R=-1,w="",B=0,H=t[0].length;B<H;++B){var N=t[0][B];switch(N[0]){case"PtgUminus":u.push("-"+u.pop());break;case"PtgUplus":u.push("+"+u.pop());break;case"PtgPercent":u.push(u.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(h=u.pop(),d=u.pop(),R>=0){switch(t[0][R][1][0]){case 0:w=ur(" ",t[0][R][1][1]);break;case 1:w=ur("\r",t[0][R][1][1]);break;default:if(w="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][R][1][0])}d=d+w,R=-1}u.push(d+r9[N[0]]+h);break;case"PtgIsect":h=u.pop(),d=u.pop(),u.push(d+" "+h);break;case"PtgUnion":h=u.pop(),d=u.pop(),u.push(d+","+h);break;case"PtgRange":h=u.pop(),d=u.pop(),u.push(d+":"+h);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":g=Hu(N[1][1],c,i),u.push(Gu(g,o));break;case"PtgRefN":g=r?Hu(N[1][1],r,i):N[1][1],u.push(Gu(g,o));break;case"PtgRef3d":_=N[1][1],g=Hu(N[1][2],c,i),S=u2(n,_,i),u.push(S+"!"+Gu(g,o));break;case"PtgFunc":case"PtgFuncVar":var J=N[1][0],re=N[1][1];J||(J=0),J&=127;var ne=J==0?[]:u.slice(-J);u.length-=J,re==="User"&&(re=ne.shift()),u.push(re+"("+ne.join(",")+")");break;case"PtgBool":u.push(N[1]?"TRUE":"FALSE");break;case"PtgInt":u.push(N[1]);break;case"PtgNum":u.push(String(N[1]));break;case"PtgStr":u.push('"'+N[1].replace(/"/g,'""')+'"');break;case"PtgErr":u.push(N[1]);break;case"PtgAreaN":A=GT(N[1][1],r?{s:r}:c,i),u.push($m(A,i));break;case"PtgArea":A=GT(N[1][1],c,i),u.push($m(A,i));break;case"PtgArea3d":_=N[1][1],A=N[1][2],S=u2(n,_,i),u.push(S+"!"+$m(A,i));break;case"PtgAttrSum":u.push("SUM("+u.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":x=N[1][2];var C=(n.names||[])[x-1]||(n[0]||[])[x],T=C?C.Name:"SH33TJSNAME"+String(x);T&&T.slice(0,6)=="_xlfn."&&!i.xlfn&&(T=T.slice(6)),u.push(T);break;case"PtgNameX":var E=N[1][1];x=N[1][2];var D;if(i.biff<=5)E<0&&(E=-E),n[E]&&(D=n[E][x]);else{var b="";if(((n[E]||[])[0]||[])[0]==14849||(((n[E]||[])[0]||[])[0]==1025?n[E][x]&&n[E][x].itab>0&&(b=n.SheetNames[n[E][x].itab-1]+"!"):b=n.SheetNames[x-1]+"!"),n[E]&&n[E][x])b+=n[E][x].Name;else if(n[0]&&n[0][x])b+=n[0][x].Name;else{var O=(I4(n,E,i)||"").split(";;");O[x-1]?b=O[x-1]:b+="SH33TJSERRX"}u.push(b);break}D||(D={Name:"SH33TJSERRY"}),u.push(D.Name);break;case"PtgParen":var F="(",Fe=")";if(R>=0){switch(w="",t[0][R][1][0]){case 2:F=ur(" ",t[0][R][1][1])+F;break;case 3:F=ur("\r",t[0][R][1][1])+F;break;case 4:Fe=ur(" ",t[0][R][1][1])+Fe;break;case 5:Fe=ur("\r",t[0][R][1][1])+Fe;break;default:if(i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][R][1][0])}R=-1}u.push(F+u.pop()+Fe);break;case"PtgRefErr":u.push("#REF!");break;case"PtgRefErr3d":u.push("#REF!");break;case"PtgExp":g={c:N[1][1],r:N[1][0]};var Ce={c:r.c,r:r.r};if(n.sharedf[vt(g)]){var ae=n.sharedf[vt(g)];u.push(cn(ae,c,Ce,n,i))}else{var oe=!1;for(h=0;h!=n.arrayf.length;++h)if(d=n.arrayf[h],!(g.c<d[0].s.c||g.c>d[0].e.c)&&!(g.r<d[0].s.r||g.r>d[0].e.r)){u.push(cn(d[1],c,Ce,n,i)),oe=!0;break}oe||u.push(N[1])}break;case"PtgArray":u.push("{"+t9(N[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":R=B;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":u.push("");break;case"PtgAreaErr":u.push("#REF!");break;case"PtgAreaErr3d":u.push("#REF!");break;case"PtgList":u.push("Table"+N[1].idx+"[#"+N[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(N));default:throw new Error("Unrecognized Formula Token: "+String(N))}var Oe=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(i.biff!=3&&R>=0&&Oe.indexOf(t[0][B][0])==-1){N=t[0][R];var te=!0;switch(N[1][0]){case 4:te=!1;case 0:w=ur(" ",N[1][1]);break;case 5:te=!1;case 1:w=ur("\r",N[1][1]);break;default:if(w="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+N[1][0])}u.push((te?w:"")+u.pop()+(te?"":w)),R=-1}}if(u.length>1&&i.WTF)throw new Error("bad formula stack");return u[0]}function a9(t,e,r){var n=t.l+e,i=r.biff==2?1:2,o,c=t.read_shift(i);if(c==65535)return[[],mn(t,e-2)];var u=Lf(t,c,r);return e!==c+i&&(o=Mf(t,e-c-i,u,r)),t.l=n,[u,o]}function i9(t,e,r){var n=t.l+e,i=r.biff==2?1:2,o,c=t.read_shift(i);if(c==65535)return[[],mn(t,e-2)];var u=Lf(t,c,r);return e!==c+i&&(o=Mf(t,e-c-i,u,r)),t.l=n,[u,o]}function s9(t,e,r,n){var i=t.l+e,o=Lf(t,n,r),c;return i!==t.l&&(c=Mf(t,i-t.l,o,r)),[o,c]}function o9(t,e,r){var n=t.l+e,i,o=t.read_shift(2),c=Lf(t,o,r);return o==65535?[[],mn(t,e-2)]:(e!==o+2&&(i=Mf(t,n-o-2,c,r)),[c,i])}function l9(t){var e;if(Oi(t,t.l+6)!==65535)return[fn(t),"n"];switch(t[t.l]){case 0:return t.l+=8,["String","s"];case 1:return e=t[t.l+2]===1,t.l+=8,[e,"b"];case 2:return e=t[t.l+2],t.l+=8,[e,"e"];case 3:return t.l+=8,["","s"]}return[]}function Jm(t,e,r){var n=t.l+e,i=oi(t);r.biff==2&&++t.l;var o=l9(t),c=t.read_shift(1);r.biff!=2&&(t.read_shift(1),r.biff>=5&&t.read_shift(4));var u=i9(t,n-t.l,r);return{cell:i,val:o[0],formula:u,shared:c>>3&1,tt:o[1]}}function Dd(t,e,r){var n=t.read_shift(4),i=Lf(t,n,r),o=t.read_shift(4),c=o>0?Mf(t,o,i,r):null;return[i,c]}var c9=Dd,Od=Dd,u9=Dd,f9=Dd,h9={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},D4={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},d9={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function f2(t){return t.slice(0,3)=="of:"&&(t=t.slice(3)),t.charCodeAt(0)==61&&(t=t.slice(1),t.charCodeAt(0)==61&&(t=t.slice(1))),t=t.replace(/COM\.MICROSOFT\./g,""),t=t.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(e,r){return r.replace(/\./g,"")}),t=t.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),t.replace(/[;~]/g,",").replace(/\|/g,";")}function eg(t){var e=t.split(":"),r=e[0].split(".")[0];return[r,e[0].split(".")[1]+(e.length>1?":"+(e[1].split(".")[1]||e[1].split(".")[0]):"")]}var Xu={},ac={};function Yu(t,e){if(t){var r=[.7,.7,.75,.75,.3,.3];e=="xlml"&&(r=[1,1,1,1,.5,.5]),t.left==null&&(t.left=r[0]),t.right==null&&(t.right=r[1]),t.top==null&&(t.top=r[2]),t.bottom==null&&(t.bottom=r[3]),t.header==null&&(t.header=r[4]),t.footer==null&&(t.footer=r[5])}}function O4(t,e,r,n,i,o){try{n.cellNF&&(t.z=ht[e])}catch(u){if(n.WTF)throw u}if(!(t.t==="z"&&!n.cellStyles)){if(t.t==="d"&&typeof t.v=="string"&&(t.v=en(t.v)),(!n||n.cellText!==!1)&&t.t!=="z")try{if(ht[e]==null&&Po(gF[e]||"General",e),t.t==="e")t.w=t.w||rl[t.v];else if(e===0)if(t.t==="n")(t.v|0)===t.v?t.w=t.v.toString(10):t.w=uf(t.v);else if(t.t==="d"){var c=$n(t.v);(c|0)===c?t.w=c.toString(10):t.w=uf(c)}else{if(t.v===void 0)return"";t.w=zo(t.v,ac)}else t.t==="d"?t.w=ga(e,$n(t.v),ac):t.w=ga(e,t.v,ac)}catch(u){if(n.WTF)throw u}if(n.cellStyles&&r!=null)try{t.s=o.Fills[r],t.s.fgColor&&t.s.fgColor.theme&&!t.s.fgColor.rgb&&(t.s.fgColor.rgb=ed(i.themeElements.clrScheme[t.s.fgColor.theme].rgb,t.s.fgColor.tint||0),n.WTF&&(t.s.fgColor.raw_rgb=i.themeElements.clrScheme[t.s.fgColor.theme].rgb)),t.s.bgColor&&t.s.bgColor.theme&&(t.s.bgColor.rgb=ed(i.themeElements.clrScheme[t.s.bgColor.theme].rgb,t.s.bgColor.tint||0),n.WTF&&(t.s.bgColor.raw_rgb=i.themeElements.clrScheme[t.s.bgColor.theme].rgb))}catch(u){if(n.WTF&&o.Fills)throw u}}}function p9(t,e){var r=Kr(e);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(t["!ref"]=Gt(r))}var m9=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,g9=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,v9=/<(?:\w:)?hyperlink [^>]*>/mg,_9=/"(\w*:\w*)"/,x9=/<(?:\w:)?col\b[^>]*[\/]?>/g,y9=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,E9=/<(?:\w:)?pageMargins[^>]*\/>/g,N4=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,T9=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,A9=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function w9(t,e,r,n,i,o,c){if(!t)return t;n||(n={"!id":{}});var u=e.dense?[]:{},h={s:{r:2e6,c:2e6},e:{r:0,c:0}},d="",g="",_=t.match(g9);_?(d=t.slice(0,_.index),g=t.slice(_.index+_[0].length)):d=g=t;var x=d.match(N4);x?uv(x[0],u,i,r):(x=d.match(T9))&&S9(x[0],x[1]||"",u,i,r);var A=(d.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(A>0){var S=d.slice(A,A+50).match(_9);S&&p9(u,S[1])}var R=d.match(A9);R&&R[1]&&D9(R[1],i);var w=[];if(e.cellStyles){var B=d.match(x9);B&&k9(w,B)}_&&O9(_[1],u,e,h,o,c);var H=g.match(y9);H&&(u["!autofilter"]=b9(H[0]));var N=[],J=g.match(m9);if(J)for(A=0;A!=J.length;++A)N[A]=Kr(J[A].slice(J[A].indexOf('"')+1));var re=g.match(v9);re&&C9(u,re,n);var ne=g.match(E9);if(ne&&(u["!margins"]=R9(st(ne[0]))),!u["!ref"]&&h.e.c>=h.s.c&&h.e.r>=h.s.r&&(u["!ref"]=Gt(h)),e.sheetRows>0&&u["!ref"]){var C=Kr(u["!ref"]);e.sheetRows<=+C.e.r&&(C.e.r=e.sheetRows-1,C.e.r>h.e.r&&(C.e.r=h.e.r),C.e.r<C.s.r&&(C.s.r=C.e.r),C.e.c>h.e.c&&(C.e.c=h.e.c),C.e.c<C.s.c&&(C.s.c=C.e.c),u["!fullref"]=u["!ref"],u["!ref"]=Gt(C))}return w.length>0&&(u["!cols"]=w),N.length>0&&(u["!merges"]=N),u}function uv(t,e,r,n){var i=st(t);r.Sheets[n]||(r.Sheets[n]={}),i.codeName&&(r.Sheets[n].CodeName=Nt(Jt(i.codeName)))}function S9(t,e,r,n,i){uv(t.slice(0,t.indexOf(">")),r,n,i)}function C9(t,e,r){for(var n=Array.isArray(t),i=0;i!=e.length;++i){var o=st(Jt(e[i]),!0);if(!o.ref)return;var c=((r||{})["!id"]||[])[o.id];c?(o.Target=c.Target,o.location&&(o.Target+="#"+Nt(o.location))):(o.Target="#"+Nt(o.location),c={Target:o.Target,TargetMode:"Internal"}),o.Rel=c,o.tooltip&&(o.Tooltip=o.tooltip,delete o.tooltip);for(var u=Kr(o.ref),h=u.s.r;h<=u.e.r;++h)for(var d=u.s.c;d<=u.e.c;++d){var g=vt({c:d,r:h});n?(t[h]||(t[h]=[]),t[h][d]||(t[h][d]={t:"z",v:void 0}),t[h][d].l=o):(t[g]||(t[g]={t:"z",v:void 0}),t[g].l=o)}}}function R9(t){var e={};return["left","right","top","bottom","header","footer"].forEach(function(r){t[r]&&(e[r]=parseFloat(t[r]))}),e}function k9(t,e){for(var r=!1,n=0;n!=e.length;++n){var i=st(e[n],!0);i.hidden&&(i.hidden=ir(i.hidden));var o=parseInt(i.min,10)-1,c=parseInt(i.max,10)-1;for(i.outlineLevel&&(i.level=+i.outlineLevel||0),delete i.min,delete i.max,i.width=+i.width,!r&&i.width&&(r=!0,lv(i.width)),dc(i);o<=c;)t[o++]=tn(i)}}function b9(t){var e={ref:(t.match(/ref="([^"]*)"/)||[])[1]};return e}var I9=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function D9(t,e){e.Views||(e.Views=[{}]),(t.match(I9)||[]).forEach(function(r,n){var i=st(r);e.Views[n]||(e.Views[n]={}),+i.zoomScale&&(e.Views[n].zoom=+i.zoomScale),ir(i.rightToLeft)&&(e.Views[n].RTL=!0)})}var O9=function(){var t=/<(?:\w+:)?c[ \/>]/,e=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,i=/ref=["']([^"']*)["']/,o=hf("v"),c=hf("f");return function(h,d,g,_,x,A){for(var S=0,R="",w=[],B=[],H=0,N=0,J=0,re="",ne,C,T=0,E=0,D,b,O=0,F=0,Fe=Array.isArray(A.CellXf),Ce,ae=[],oe=[],Oe=Array.isArray(d),te=[],G={},se=!1,M=!!g.sheetStubs,z=h.split(e),Q=0,Z=z.length;Q!=Z;++Q){R=z[Q].trim();var ue=R.length;if(ue!==0){var De=0;e:for(S=0;S<ue;++S)switch(R[S]){case">":if(R[S-1]!="/"){++S;break e}if(g&&g.cellStyles){if(C=st(R.slice(De,S),!0),T=C.r!=null?parseInt(C.r,10):T+1,E=-1,g.sheetRows&&g.sheetRows<T)continue;G={},se=!1,C.ht&&(se=!0,G.hpt=parseFloat(C.ht),G.hpx=gf(G.hpt)),C.hidden=="1"&&(se=!0,G.hidden=!0),C.outlineLevel!=null&&(se=!0,G.level=+C.outlineLevel),se&&(te[T-1]=G)}break;case"<":De=S;break}if(De>=S)break;if(C=st(R.slice(De,S),!0),T=C.r!=null?parseInt(C.r,10):T+1,E=-1,!(g.sheetRows&&g.sheetRows<T)){_.s.r>T-1&&(_.s.r=T-1),_.e.r<T-1&&(_.e.r=T-1),g&&g.cellStyles&&(G={},se=!1,C.ht&&(se=!0,G.hpt=parseFloat(C.ht),G.hpx=gf(G.hpt)),C.hidden=="1"&&(se=!0,G.hidden=!0),C.outlineLevel!=null&&(se=!0,G.level=+C.outlineLevel),se&&(te[T-1]=G)),w=R.slice(S).split(t);for(var Ee=0;Ee!=w.length&&w[Ee].trim().charAt(0)=="<";++Ee);for(w=w.slice(Ee),S=0;S!=w.length;++S)if(R=w[S].trim(),R.length!==0){if(B=R.match(r),H=S,N=0,J=0,R="<c "+(R.slice(0,1)=="<"?">":"")+R,B!=null&&B.length===2){for(H=0,re=B[1],N=0;N!=re.length&&!((J=re.charCodeAt(N)-64)<1||J>26);++N)H=26*H+J;--H,E=H}else++E;for(N=0;N!=R.length&&R.charCodeAt(N)!==62;++N);if(++N,C=st(R.slice(0,N),!0),C.r||(C.r=vt({r:T-1,c:E})),re=R.slice(N),ne={t:""},(B=re.match(o))!=null&&B[1]!==""&&(ne.v=Nt(B[1])),g.cellFormula){if((B=re.match(c))!=null&&B[1]!==""){if(ne.f=Nt(Jt(B[1])).replace(/\r\n/g,`
`),g.xlfn||(ne.f=o2(ne.f)),B[0].indexOf('t="array"')>-1)ne.F=(re.match(i)||[])[1],ne.F.indexOf(":")>-1&&ae.push([Kr(ne.F),ne.F]);else if(B[0].indexOf('t="shared"')>-1){b=st(B[0]);var we=Nt(Jt(B[1]));g.xlfn||(we=o2(we)),oe[parseInt(b.si,10)]=[b,we,C.r]}}else(B=re.match(/<f[^>]*\/>/))&&(b=st(B[0]),oe[b.si]&&(ne.f=H5(oe[b.si][1],oe[b.si][2],C.r)));var Te=Ia(C.r);for(N=0;N<ae.length;++N)Te.r>=ae[N][0].s.r&&Te.r<=ae[N][0].e.r&&Te.c>=ae[N][0].s.c&&Te.c<=ae[N][0].e.c&&(ne.F=ae[N][1])}if(C.t==null&&ne.v===void 0)if(ne.f||ne.F)ne.v=0,ne.t="n";else if(M)ne.t="z";else continue;else ne.t=C.t||"n";switch(_.s.c>E&&(_.s.c=E),_.e.c<E&&(_.e.c=E),ne.t){case"n":if(ne.v==""||ne.v==null){if(!M)continue;ne.t="z"}else ne.v=parseFloat(ne.v);break;case"s":if(typeof ne.v>"u"){if(!M)continue;ne.t="z"}else D=Xu[parseInt(ne.v,10)],ne.v=D.t,ne.r=D.r,g.cellHTML&&(ne.h=D.h);break;case"str":ne.t="s",ne.v=ne.v!=null?Jt(ne.v):"",g.cellHTML&&(ne.h=FS(ne.v));break;case"inlineStr":B=re.match(n),ne.t="s",B!=null&&(D=ov(B[1]))?(ne.v=D.t,g.cellHTML&&(ne.h=D.h)):ne.v="";break;case"b":ne.v=ir(ne.v);break;case"d":g.cellDates?ne.v=en(ne.v,1):(ne.v=$n(en(ne.v,1)),ne.t="n");break;case"e":(!g||g.cellText!==!1)&&(ne.w=ne.v),ne.v=e4[ne.v];break}if(O=F=0,Ce=null,Fe&&C.s!==void 0&&(Ce=A.CellXf[C.s],Ce!=null&&(Ce.numFmtId!=null&&(O=Ce.numFmtId),g.cellStyles&&Ce.fillId!=null&&(F=Ce.fillId))),O4(ne,O,F,g,x,A),g.cellDates&&Fe&&ne.t=="n"&&Ac(ht[O])&&(ne.t="d",ne.v=bd(ne.v)),C.cm&&g.xlmeta){var Ue=(g.xlmeta.Cell||[])[+C.cm-1];Ue&&Ue.type=="XLDAPR"&&(ne.D=!0)}if(Oe){var X=Ia(C.r);d[X.r]||(d[X.r]=[]),d[X.r][X.c]=ne}else d[C.r]=ne}}}}te.length>0&&(d["!rows"]=te)}}();function N9(t,e){var r={},n=t.l+e;r.r=t.read_shift(4),t.l+=4;var i=t.read_shift(2);t.l+=1;var o=t.read_shift(1);return t.l=n,o&7&&(r.level=o&7),o&16&&(r.hidden=!0),o&32&&(r.hpt=i/20),r}var F9=tl;function P9(){}function M9(t,e){var r={},n=t[t.l];return++t.l,r.above=!(n&64),r.left=!(n&128),t.l+=18,r.name=a8(t),r}function L9(t){var e=va(t);return[e]}function V9(t){var e=el(t);return[e]}function U9(t){var e=va(t),r=t.read_shift(1);return[e,r,"b"]}function B9(t){var e=el(t),r=t.read_shift(1);return[e,r,"b"]}function j9(t){var e=va(t),r=t.read_shift(1);return[e,r,"e"]}function z9(t){var e=el(t),r=t.read_shift(1);return[e,r,"e"]}function H9(t){var e=va(t),r=t.read_shift(4);return[e,r,"s"]}function G9(t){var e=el(t),r=t.read_shift(4);return[e,r,"s"]}function q9(t){var e=va(t),r=fn(t);return[e,r,"n"]}function F4(t){var e=el(t),r=fn(t);return[e,r,"n"]}function K9(t){var e=va(t),r=av(t);return[e,r,"n"]}function W9(t){var e=el(t),r=av(t);return[e,r,"n"]}function X9(t){var e=va(t),r=rv(t);return[e,r,"is"]}function Y9(t){var e=va(t),r=dn(t);return[e,r,"str"]}function $9(t){var e=el(t),r=dn(t);return[e,r,"str"]}function Q9(t,e,r){var n=t.l+e,i=va(t);i.r=r["!row"];var o=t.read_shift(1),c=[i,o,"b"];if(r.cellFormula){t.l+=2;var u=Od(t,n-t.l,r);c[3]=cn(u,null,i,r.supbooks,r)}else t.l=n;return c}function Z9(t,e,r){var n=t.l+e,i=va(t);i.r=r["!row"];var o=t.read_shift(1),c=[i,o,"e"];if(r.cellFormula){t.l+=2;var u=Od(t,n-t.l,r);c[3]=cn(u,null,i,r.supbooks,r)}else t.l=n;return c}function J9(t,e,r){var n=t.l+e,i=va(t);i.r=r["!row"];var o=fn(t),c=[i,o,"n"];if(r.cellFormula){t.l+=2;var u=Od(t,n-t.l,r);c[3]=cn(u,null,i,r.supbooks,r)}else t.l=n;return c}function e7(t,e,r){var n=t.l+e,i=va(t);i.r=r["!row"];var o=dn(t),c=[i,o,"str"];if(r.cellFormula){t.l+=2;var u=Od(t,n-t.l,r);c[3]=cn(u,null,i,r.supbooks,r)}else t.l=n;return c}var t7=tl;function r7(t,e){var r=t.l+e,n=tl(t),i=nv(t),o=dn(t),c=dn(t),u=dn(t);t.l=r;var h={rfx:n,relId:i,loc:o,display:u};return c&&(h.Tooltip=c),h}function n7(){}function a7(t,e,r){var n=t.l+e,i=QS(t),o=t.read_shift(1),c=[i];if(c[2]=o,r.cellFormula){var u=c9(t,n-t.l,r);c[1]=u}else t.l=n;return c}function i7(t,e,r){var n=t.l+e,i=tl(t),o=[i];if(r.cellFormula){var c=f9(t,n-t.l,r);o[1]=c,t.l=n}else t.l=n;return o}var s7=["left","right","top","bottom","header","footer"];function o7(t){var e={};return s7.forEach(function(r){e[r]=fn(t)}),e}function l7(t){var e=t.read_shift(2);return t.l+=28,{RTL:e&32}}function c7(){}function u7(){}function f7(t,e,r,n,i,o,c){if(!t)return t;var u=e||{};n||(n={"!id":{}});var h=u.dense?[]:{},d,g={s:{r:2e6,c:2e6},e:{r:0,c:0}},_=!1,x=!1,A,S,R,w,B,H,N,J,re,ne=[];u.biff=12,u["!row"]=0;var C=0,T=!1,E=[],D={},b=u.supbooks||i.supbooks||[[]];if(b.sharedf=D,b.arrayf=E,b.SheetNames=i.SheetNames||i.Sheets.map(function(Oe){return Oe.name}),!u.supbooks&&(u.supbooks=b,i.Names))for(var O=0;O<i.Names.length;++O)b[0][O+1]=i.Names[O];var F=[],Fe=[],Ce=!1;nd[16]={n:"BrtShortReal",f:F4};var ae;if(Hi(t,function(te,G,se){if(!x)switch(se){case 148:d=te;break;case 0:A=te,u.sheetRows&&u.sheetRows<=A.r&&(x=!0),J=Xn(w=A.r),u["!row"]=A.r,(te.hidden||te.hpt||te.level!=null)&&(te.hpt&&(te.hpx=gf(te.hpt)),Fe[te.r]=te);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(S={t:te[2]},te[2]){case"n":S.v=te[1];break;case"s":N=Xu[te[1]],S.v=N.t,S.r=N.r;break;case"b":S.v=!!te[1];break;case"e":S.v=te[1],u.cellText!==!1&&(S.w=rl[S.v]);break;case"str":S.t="s",S.v=te[1];break;case"is":S.t="s",S.v=te[1].t;break}if((R=c.CellXf[te[0].iStyleRef])&&O4(S,R.numFmtId,null,u,o,c),B=te[0].c==-1?B+1:te[0].c,u.dense?(h[w]||(h[w]=[]),h[w][B]=S):h[wn(B)+J]=S,u.cellFormula){for(T=!1,C=0;C<E.length;++C){var M=E[C];A.r>=M[0].s.r&&A.r<=M[0].e.r&&B>=M[0].s.c&&B<=M[0].e.c&&(S.F=Gt(M[0]),T=!0)}!T&&te.length>3&&(S.f=te[3])}if(g.s.r>A.r&&(g.s.r=A.r),g.s.c>B&&(g.s.c=B),g.e.r<A.r&&(g.e.r=A.r),g.e.c<B&&(g.e.c=B),u.cellDates&&R&&S.t=="n"&&Ac(ht[R.numFmtId])){var z=No(S.v);z&&(S.t="d",S.v=new Date(z.y,z.m-1,z.d,z.H,z.M,z.S,z.u))}ae&&(ae.type=="XLDAPR"&&(S.D=!0),ae=void 0);break;case 1:case 12:if(!u.sheetStubs||_)break;S={t:"z",v:void 0},B=te[0].c==-1?B+1:te[0].c,u.dense?(h[w]||(h[w]=[]),h[w][B]=S):h[wn(B)+J]=S,g.s.r>A.r&&(g.s.r=A.r),g.s.c>B&&(g.s.c=B),g.e.r<A.r&&(g.e.r=A.r),g.e.c<B&&(g.e.c=B),ae&&(ae.type=="XLDAPR"&&(S.D=!0),ae=void 0);break;case 176:ne.push(te);break;case 49:ae=((u.xlmeta||{}).Cell||[])[te-1];break;case 494:var Q=n["!id"][te.relId];for(Q?(te.Target=Q.Target,te.loc&&(te.Target+="#"+te.loc),te.Rel=Q):te.relId==""&&(te.Target="#"+te.loc),w=te.rfx.s.r;w<=te.rfx.e.r;++w)for(B=te.rfx.s.c;B<=te.rfx.e.c;++B)u.dense?(h[w]||(h[w]=[]),h[w][B]||(h[w][B]={t:"z",v:void 0}),h[w][B].l=te):(H=vt({c:B,r:w}),h[H]||(h[H]={t:"z",v:void 0}),h[H].l=te);break;case 426:if(!u.cellFormula)break;E.push(te),re=u.dense?h[w][B]:h[wn(B)+J],re.f=cn(te[1],g,{r:A.r,c:B},b,u),re.F=Gt(te[0]);break;case 427:if(!u.cellFormula)break;D[vt(te[0].s)]=te[1],re=u.dense?h[w][B]:h[wn(B)+J],re.f=cn(te[1],g,{r:A.r,c:B},b,u);break;case 60:if(!u.cellStyles)break;for(;te.e>=te.s;)F[te.e--]={width:te.w/256,hidden:!!(te.flags&1),level:te.level},Ce||(Ce=!0,lv(te.w/256)),dc(F[te.e+1]);break;case 161:h["!autofilter"]={ref:Gt(te)};break;case 476:h["!margins"]=te;break;case 147:i.Sheets[r]||(i.Sheets[r]={}),te.name&&(i.Sheets[r].CodeName=te.name),(te.above||te.left)&&(h["!outline"]={above:te.above,left:te.left});break;case 137:i.Views||(i.Views=[{}]),i.Views[0]||(i.Views[0]={}),te.RTL&&(i.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:_=!0;break;case 36:_=!1;break;case 37:_=!0;break;case 38:_=!1;break;default:if(!G.T){if(!_||u.WTF)throw new Error("Unexpected record 0x"+se.toString(16))}}},u),delete u.supbooks,delete u["!row"],!h["!ref"]&&(g.s.r<2e6||d&&(d.e.r>0||d.e.c>0||d.s.r>0||d.s.c>0))&&(h["!ref"]=Gt(d||g)),u.sheetRows&&h["!ref"]){var oe=Kr(h["!ref"]);u.sheetRows<=+oe.e.r&&(oe.e.r=u.sheetRows-1,oe.e.r>g.e.r&&(oe.e.r=g.e.r),oe.e.r<oe.s.r&&(oe.s.r=oe.e.r),oe.e.c>g.e.c&&(oe.e.c=g.e.c),oe.e.c<oe.s.c&&(oe.s.c=oe.e.c),h["!fullref"]=h["!ref"],h["!ref"]=Gt(oe))}return ne.length>0&&(h["!merges"]=ne),F.length>0&&(h["!cols"]=F),Fe.length>0&&(h["!rows"]=Fe),h}function h7(t){var e=[],r=t.match(/^<c:numCache>/),n;(t.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(o){var c=o.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);c&&(e[+c[1]]=r?+c[2]:c[2])});var i=Nt((t.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(t.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(o){n=o.replace(/<.*?>/g,"")}),[e,i,n]}function d7(t,e,r,n,i,o){var c=o||{"!type":"chart"};if(!t)return o;var u=0,h=0,d="A",g={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(t.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(_){var x=h7(_);g.s.r=g.s.c=0,g.e.c=u,d=wn(u),x[0].forEach(function(A,S){c[d+Xn(S)]={t:"n",v:A,z:x[1]},h=S}),g.e.r<h&&(g.e.r=h),++u}),u>0&&(c["!ref"]=Gt(g)),c}function p7(t,e,r,n,i){if(!t)return t;n||(n={"!id":{}});var o={"!type":"chart","!drawel":null,"!rel":""},c,u=t.match(N4);return u&&uv(u[0],o,i,r),(c=t.match(/drawing r:id="(.*?)"/))&&(o["!rel"]=c[1]),n["!id"][o["!rel"]]&&(o["!drawel"]=n["!id"][o["!rel"]]),o}function m7(t,e){t.l+=10;var r=dn(t);return{name:r}}function g7(t,e,r,n,i){if(!t)return t;n||(n={"!id":{}});var o={"!type":"chart","!drawel":null,"!rel":""},c=!1;return Hi(t,function(h,d,g){switch(g){case 550:o["!rel"]=h;break;case 651:i.Sheets[r]||(i.Sheets[r]={}),h.name&&(i.Sheets[r].CodeName=h.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:c=!0;break;case 36:c=!1;break;case 37:break;case 38:break;default:if(!(d.T>0)){if(!(d.T<0)){if(!c||e.WTF)throw new Error("Unexpected record 0x"+g.toString(16))}}}},e),n["!id"][o["!rel"]]&&(o["!drawel"]=n["!id"][o["!rel"]]),o}var P4=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],v7=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],_7=[],x7=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function h2(t,e){for(var r=0;r!=t.length;++r)for(var n=t[r],i=0;i!=e.length;++i){var o=e[i];if(n[o[0]]==null)n[o[0]]=o[1];else switch(o[2]){case"bool":typeof n[o[0]]=="string"&&(n[o[0]]=ir(n[o[0]]));break;case"int":typeof n[o[0]]=="string"&&(n[o[0]]=parseInt(n[o[0]],10));break}}}function d2(t,e){for(var r=0;r!=e.length;++r){var n=e[r];if(t[n[0]]==null)t[n[0]]=n[1];else switch(n[2]){case"bool":typeof t[n[0]]=="string"&&(t[n[0]]=ir(t[n[0]]));break;case"int":typeof t[n[0]]=="string"&&(t[n[0]]=parseInt(t[n[0]],10));break}}}function M4(t){d2(t.WBProps,P4),d2(t.CalcPr,x7),h2(t.WBView,v7),h2(t.Sheets,_7),ac.date1904=ir(t.WBProps.date1904)}var y7="][*?/\\".split("");function E7(t,e){if(t.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return y7.forEach(function(n){if(t.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}var T7=/<\w+:workbook/;function A7(t,e){if(!t)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,i="xmlns",o={},c=0;if(t.replace(gn,function(h,d){var g=st(h);switch(si(g[0])){case"<?xml":break;case"<workbook":h.match(T7)&&(i="xmlns"+h.match(/<(\w+):/)[1]),r.xmlns=g[i];break;case"</workbook>":break;case"<fileVersion":delete g[0],r.AppVersion=g;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":P4.forEach(function(_){if(g[_[0]]!=null)switch(_[2]){case"bool":r.WBProps[_[0]]=ir(g[_[0]]);break;case"int":r.WBProps[_[0]]=parseInt(g[_[0]],10);break;default:r.WBProps[_[0]]=g[_[0]]}}),g.codeName&&(r.WBProps.CodeName=Jt(g.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete g[0],r.WBView.push(g);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(g.state){case"hidden":g.Hidden=1;break;case"veryHidden":g.Hidden=2;break;default:g.Hidden=0}delete g.state,g.name=Nt(Jt(g.name)),delete g[0],r.Sheets.push(g);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":o={},o.Name=Jt(g.name),g.comment&&(o.Comment=g.comment),g.localSheetId&&(o.Sheet=+g.localSheetId),ir(g.hidden||"0")&&(o.Hidden=!0),c=d+h.length;break;case"</definedName>":o.Ref=Nt(Jt(t.slice(c,d))),r.Names.push(o);break;case"<definedName/>":break;case"<calcPr":delete g[0],r.CalcPr=g;break;case"<calcPr/>":delete g[0],r.CalcPr=g;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&e.WTF)throw new Error("unrecognized "+g[0]+" in workbook")}return h}),jF.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return M4(r),r}function w7(t,e){var r={};return r.Hidden=t.read_shift(4),r.iTabID=t.read_shift(4),r.strRelID=Pg(t),r.name=dn(t),r}function S7(t,e){var r={},n=t.read_shift(4);r.defaultThemeVersion=t.read_shift(4);var i=e>8?dn(t):"";return i.length>0&&(r.CodeName=i),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function C7(t,e){var r={};return t.read_shift(4),r.ArchID=t.read_shift(4),t.l+=e-8,r}function R7(t,e,r){var n=t.l+e;t.l+=4,t.l+=1;var i=t.read_shift(4),o=i8(t),c=u9(t,0,r),u=nv(t);t.l=n;var h={Name:o,Ptg:c};return i<268435455&&(h.Sheet=i),u&&(h.Comment=u),h}function k7(t,e){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],i=!1;e||(e={}),e.biff=12;var o=[],c=[[]];return c.SheetNames=[],c.XTI=[],nd[16]={n:"BrtFRTArchID$",f:C7},Hi(t,function(h,d,g){switch(g){case 156:c.SheetNames.push(h.name),r.Sheets.push(h);break;case 153:r.WBProps=h;break;case 39:h.Sheet!=null&&(e.SID=h.Sheet),h.Ref=cn(h.Ptg,null,null,c,e),delete e.SID,delete h.Ptg,o.push(h);break;case 1036:break;case 357:case 358:case 355:case 667:c[0].length?c.push([g,h]):c[0]=[g,h],c[c.length-1].XTI=[];break;case 362:c.length===0&&(c[0]=[],c[0].XTI=[]),c[c.length-1].XTI=c[c.length-1].XTI.concat(h),c.XTI=c.XTI.concat(h);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(g),i=!0;break;case 36:n.pop(),i=!1;break;case 37:n.push(g),i=!0;break;case 38:n.pop(),i=!1;break;case 16:break;default:if(!d.T){if(!i||e.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+g.toString(16))}}},e),M4(r),r.Names=o,r.supbooks=c,r}function b7(t,e,r){return e.slice(-4)===".bin"?k7(t,r):A7(t,r)}function I7(t,e,r,n,i,o,c,u){return e.slice(-4)===".bin"?f7(t,n,r,i,o,c,u):w9(t,n,r,i,o,c,u)}function D7(t,e,r,n,i,o,c,u){return e.slice(-4)===".bin"?g7(t,n,r,i,o):p7(t,n,r,i,o)}function O7(t,e,r,n,i,o,c,u){return e.slice(-4)===".bin"?B5():j5()}function N7(t,e,r,n,i,o,c,u){return e.slice(-4)===".bin"?V5():U5()}function F7(t,e,r,n){return e.slice(-4)===".bin"?t5(t,r,n):YM(t,r,n)}function P7(t,e,r){return T4(t,r)}function M7(t,e,r){return e.slice(-4)===".bin"?vM(t,r):mM(t,r)}function L7(t,e,r){return e.slice(-4)===".bin"?P5(t,r):I5(t,r)}function V7(t,e,r){return e.slice(-4)===".bin"?R5(t):S5(t)}function U7(t,e,r,n){return r.slice(-4)===".bin"?k5(t,e,r,n):void 0}function B7(t,e,r){return e.slice(-4)===".bin"?A5(t,e,r):w5(t,e,r)}var L4=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,V4=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function wa(t,e){var r=t.split(/\s+/),n=[];if(n[0]=r[0],r.length===1)return n;var i=t.match(L4),o,c,u,h;if(i)for(h=0;h!=i.length;++h)o=i[h].match(V4),(c=o[1].indexOf(":"))===-1?n[o[1]]=o[2].slice(1,o[2].length-1):(o[1].slice(0,6)==="xmlns:"?u="xmlns"+o[1].slice(6):u=o[1].slice(c+1),n[u]=o[2].slice(1,o[2].length-1));return n}function j7(t){var e=t.split(/\s+/),r={};if(e.length===1)return r;var n=t.match(L4),i,o,c,u;if(n)for(u=0;u!=n.length;++u)i=n[u].match(V4),(o=i[1].indexOf(":"))===-1?r[i[1]]=i[2].slice(1,i[2].length-1):(i[1].slice(0,6)==="xmlns:"?c="xmlns"+i[1].slice(6):c=i[1].slice(o+1),r[c]=i[2].slice(1,i[2].length-1));return r}var $u;function z7(t,e){var r=$u[t]||Nt(t);return r==="General"?zo(e):ga(r,e)}function H7(t,e,r,n){var i=n;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":i=ir(n);break;case"i2":case"int":i=parseInt(n,10);break;case"r4":case"float":i=parseFloat(n);break;case"date":case"dateTime.tz":i=en(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}t[Nt(e)]=i}function G7(t,e,r){if(t.t!=="z"){if(!r||r.cellText!==!1)try{t.t==="e"?t.w=t.w||rl[t.v]:e==="General"?t.t==="n"?(t.v|0)===t.v?t.w=t.v.toString(10):t.w=uf(t.v):t.w=zo(t.v):t.w=z7(e||"General",t.v)}catch(o){if(r.WTF)throw o}try{var n=$u[e]||e||"General";if(r.cellNF&&(t.z=n),r.cellDates&&t.t=="n"&&Ac(n)){var i=No(t.v);i&&(t.t="d",t.v=new Date(i.y,i.m-1,i.d,i.H,i.M,i.S,i.u))}}catch(o){if(r.WTF)throw o}}}function q7(t,e,r){if(r.cellStyles&&e.Interior){var n=e.Interior;n.Pattern&&(n.patternType=HM[n.Pattern]||n.Pattern)}t[e.ID]=e}function K7(t,e,r,n,i,o,c,u,h,d){var g="General",_=n.StyleID,x={};d=d||{};var A=[],S=0;for(_===void 0&&u&&(_=u.StyleID),_===void 0&&c&&(_=c.StyleID);o[_]!==void 0&&(o[_].nf&&(g=o[_].nf),o[_].Interior&&A.push(o[_].Interior),!!o[_].Parent);)_=o[_].Parent;switch(r.Type){case"Boolean":n.t="b",n.v=ir(t);break;case"String":n.t="s",n.r=PT(Nt(t)),n.v=t.indexOf("<")>-1?Nt(e||t).replace(/<.*?>/g,""):n.r;break;case"DateTime":t.slice(-1)!="Z"&&(t+="Z"),n.v=(en(t)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),n.v!==n.v?n.v=Nt(t):n.v<60&&(n.v=n.v-1),(!g||g=="General")&&(g="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+t),n.t||(n.t="n");break;case"Error":n.t="e",n.v=e4[t],d.cellText!==!1&&(n.w=t);break;default:t==""&&e==""?n.t="z":(n.t="s",n.v=PT(e||t));break}if(G7(n,g,d),d.cellFormula!==!1)if(n.Formula){var R=Nt(n.Formula);R.charCodeAt(0)==61&&(R=R.slice(1)),n.f=nc(R,i),delete n.Formula,n.ArrayRange=="RC"?n.F=nc("RC:RC",i):n.ArrayRange&&(n.F=nc(n.ArrayRange,i),h.push([Kr(n.F),n.F]))}else for(S=0;S<h.length;++S)i.r>=h[S][0].s.r&&i.r<=h[S][0].e.r&&i.c>=h[S][0].s.c&&i.c<=h[S][0].e.c&&(n.F=h[S][1]);d.cellStyles&&(A.forEach(function(w){!x.patternType&&w.patternType&&(x.patternType=w.patternType)}),n.s=x),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function W7(t){t.t=t.v||"",t.t=t.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.v=t.w=t.ixfe=void 0}function tg(t,e){var r=e||{};SS();var n=Du(J1(t));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(n=Jt(n));var i=n.slice(0,1024).toLowerCase(),o=!1;if(i=i.replace(/".*?"/g,""),(i.indexOf(">")&1023)>Math.min(i.indexOf(",")&1023,i.indexOf(";")&1023)){var c=tn(r);return c.type="string",pf.to_workbook(n,c)}if(i.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(Ye){i.indexOf("<"+Ye)>=0&&(o=!0)}),o)return J7(n,r);$u={"General Number":"General","General Date":ht[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":ht[15],"Short Date":ht[14],"Long Time":ht[19],"Medium Time":ht[18],"Short Time":ht[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:ht[2],Standard:ht[4],Percent:ht[10],Scientific:ht[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var u,h=[],d,g={},_=[],x=r.dense?[]:{},A="",S={},R={},w=wa('<Data ss:Type="String">'),B=0,H=0,N=0,J={s:{r:2e6,c:2e6},e:{r:0,c:0}},re={},ne={},C="",T=0,E=[],D={},b={},O=0,F=[],Fe=[],Ce={},ae=[],oe,Oe=!1,te=[],G=[],se={},M=0,z=0,Q={Sheets:[],WBProps:{date1904:!1}},Z={};df.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var ue="";u=df.exec(n);)switch(u[3]=(ue=u[3]).toLowerCase()){case"data":if(ue=="data"){if(u[1]==="/"){if((d=h.pop())[0]!==u[3])throw new Error("Bad state: "+d.join("|"))}else u[0].charAt(u[0].length-2)!=="/"&&h.push([u[3],!0]);break}if(h[h.length-1][1])break;u[1]==="/"?K7(n.slice(B,u.index),C,w,h[h.length-1][0]=="comment"?Ce:S,{c:H,r:N},re,ae[H],R,te,r):(C="",w=wa(u[0]),B=u.index+u[0].length);break;case"cell":if(u[1]==="/")if(Fe.length>0&&(S.c=Fe),(!r.sheetRows||r.sheetRows>N)&&S.v!==void 0&&(r.dense?(x[N]||(x[N]=[]),x[N][H]=S):x[wn(H)+Xn(N)]=S),S.HRef&&(S.l={Target:Nt(S.HRef)},S.HRefScreenTip&&(S.l.Tooltip=S.HRefScreenTip),delete S.HRef,delete S.HRefScreenTip),(S.MergeAcross||S.MergeDown)&&(M=H+(parseInt(S.MergeAcross,10)|0),z=N+(parseInt(S.MergeDown,10)|0),E.push({s:{c:H,r:N},e:{c:M,r:z}})),!r.sheetStubs)S.MergeAcross?H=M+1:++H;else if(S.MergeAcross||S.MergeDown){for(var De=H;De<=M;++De)for(var Ee=N;Ee<=z;++Ee)(De>H||Ee>N)&&(r.dense?(x[Ee]||(x[Ee]=[]),x[Ee][De]={t:"z"}):x[wn(De)+Xn(Ee)]={t:"z"});H=M+1}else++H;else S=j7(u[0]),S.Index&&(H=+S.Index-1),H<J.s.c&&(J.s.c=H),H>J.e.c&&(J.e.c=H),u[0].slice(-2)==="/>"&&++H,Fe=[];break;case"row":u[1]==="/"||u[0].slice(-2)==="/>"?(N<J.s.r&&(J.s.r=N),N>J.e.r&&(J.e.r=N),u[0].slice(-2)==="/>"&&(R=wa(u[0]),R.Index&&(N=+R.Index-1)),H=0,++N):(R=wa(u[0]),R.Index&&(N=+R.Index-1),se={},(R.AutoFitHeight=="0"||R.Height)&&(se.hpx=parseInt(R.Height,10),se.hpt=E4(se.hpx),G[N]=se),R.Hidden=="1"&&(se.hidden=!0,G[N]=se));break;case"worksheet":if(u[1]==="/"){if((d=h.pop())[0]!==u[3])throw new Error("Bad state: "+d.join("|"));_.push(A),J.s.r<=J.e.r&&J.s.c<=J.e.c&&(x["!ref"]=Gt(J),r.sheetRows&&r.sheetRows<=J.e.r&&(x["!fullref"]=x["!ref"],J.e.r=r.sheetRows-1,x["!ref"]=Gt(J))),E.length&&(x["!merges"]=E),ae.length>0&&(x["!cols"]=ae),G.length>0&&(x["!rows"]=G),g[A]=x}else J={s:{r:2e6,c:2e6},e:{r:0,c:0}},N=H=0,h.push([u[3],!1]),d=wa(u[0]),A=Nt(d.Name),x=r.dense?[]:{},E=[],te=[],G=[],Z={name:A,Hidden:0},Q.Sheets.push(Z);break;case"table":if(u[1]==="/"){if((d=h.pop())[0]!==u[3])throw new Error("Bad state: "+d.join("|"))}else{if(u[0].slice(-2)=="/>")break;h.push([u[3],!1]),ae=[],Oe=!1}break;case"style":u[1]==="/"?q7(re,ne,r):ne=wa(u[0]);break;case"numberformat":ne.nf=Nt(wa(u[0]).Format||"General"),$u[ne.nf]&&(ne.nf=$u[ne.nf]);for(var we=0;we!=392&&ht[we]!=ne.nf;++we);if(we==392){for(we=57;we!=392;++we)if(ht[we]==null){Po(ne.nf,we);break}}break;case"column":if(h[h.length-1][0]!=="table")break;if(oe=wa(u[0]),oe.Hidden&&(oe.hidden=!0,delete oe.Hidden),oe.Width&&(oe.wpx=parseInt(oe.Width,10)),!Oe&&oe.wpx>10){Oe=!0,An=x4;for(var Te=0;Te<ae.length;++Te)ae[Te]&&dc(ae[Te])}Oe&&dc(oe),ae[oe.Index-1||ae.length]=oe;for(var Ue=0;Ue<+oe.Span;++Ue)ae[ae.length]=tn(oe);break;case"namedrange":if(u[1]==="/")break;Q.Names||(Q.Names=[]);var X=st(u[0]),nt={Name:X.Name,Ref:nc(X.RefersTo.slice(1),{r:0,c:0})};Q.Sheets.length>0&&(nt.Sheet=Q.Sheets.length-1),Q.Names.push(nt);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(u[0].slice(-2)==="/>")break;u[1]==="/"?C+=n.slice(T,u.index):T=u.index+u[0].length;break;case"interior":if(!r.cellStyles)break;ne.Interior=wa(u[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(u[0].slice(-2)==="/>")break;u[1]==="/"?I8(D,ue,n.slice(O,u.index)):O=u.index+u[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(u[1]==="/"){if((d=h.pop())[0]!==u[3])throw new Error("Bad state: "+d.join("|"))}else h.push([u[3],!1]);break;case"comment":if(u[1]==="/"){if((d=h.pop())[0]!==u[3])throw new Error("Bad state: "+d.join("|"));W7(Ce),Fe.push(Ce)}else h.push([u[3],!1]),d=wa(u[0]),Ce={a:d.Author};break;case"autofilter":if(u[1]==="/"){if((d=h.pop())[0]!==u[3])throw new Error("Bad state: "+d.join("|"))}else if(u[0].charAt(u[0].length-2)!=="/"){var qe=wa(u[0]);x["!autofilter"]={ref:nc(qe.Range).replace(/\$/g,"")},h.push([u[3],!0])}break;case"name":break;case"datavalidation":if(u[1]==="/"){if((d=h.pop())[0]!==u[3])throw new Error("Bad state: "+d.join("|"))}else u[0].charAt(u[0].length-2)!=="/"&&h.push([u[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(u[1]==="/"){if((d=h.pop())[0]!==u[3])throw new Error("Bad state: "+d.join("|"))}else u[0].charAt(u[0].length-2)!=="/"&&h.push([u[3],!0]);break;case"null":break;default:if(h.length==0&&u[3]=="document"||h.length==0&&u[3]=="uof")return _2(n,r);var We=!0;switch(h[h.length-1][0]){case"officedocumentsettings":switch(u[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:We=!1}break;case"componentoptions":switch(u[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:We=!1}break;case"excelworkbook":switch(u[3]){case"date1904":Q.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:We=!1}break;case"workbookoptions":switch(u[3]){case"owcversion":break;case"height":break;case"width":break;default:We=!1}break;case"worksheetoptions":switch(u[3]){case"visible":if(u[0].slice(-2)!=="/>")if(u[1]==="/")switch(n.slice(O,u.index)){case"SheetHidden":Z.Hidden=1;break;case"SheetVeryHidden":Z.Hidden=2;break}else O=u.index+u[0].length;break;case"header":x["!margins"]||Yu(x["!margins"]={},"xlml"),isNaN(+st(u[0]).Margin)||(x["!margins"].header=+st(u[0]).Margin);break;case"footer":x["!margins"]||Yu(x["!margins"]={},"xlml"),isNaN(+st(u[0]).Margin)||(x["!margins"].footer=+st(u[0]).Margin);break;case"pagemargins":var Be=st(u[0]);x["!margins"]||Yu(x["!margins"]={},"xlml"),isNaN(+Be.Top)||(x["!margins"].top=+Be.Top),isNaN(+Be.Left)||(x["!margins"].left=+Be.Left),isNaN(+Be.Right)||(x["!margins"].right=+Be.Right),isNaN(+Be.Bottom)||(x["!margins"].bottom=+Be.Bottom);break;case"displayrighttoleft":Q.Views||(Q.Views=[]),Q.Views[0]||(Q.Views[0]={}),Q.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":x["!outline"]||(x["!outline"]={}),x["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":x["!outline"]||(x["!outline"]={}),x["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:We=!1}break;case"pivottable":case"pivotcache":switch(u[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:We=!1}break;case"pagebreaks":switch(u[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:We=!1}break;case"autofilter":switch(u[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:We=!1}break;case"querytable":switch(u[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:We=!1}break;case"datavalidation":switch(u[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:We=!1}break;case"sorting":case"conditionalformatting":switch(u[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:We=!1}break;case"mapinfo":case"schema":case"data":switch(u[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:We=!1}break;case"smarttags":break;default:We=!1;break}if(We||u[3].match(/!\[CDATA/))break;if(!h[h.length-1][1])throw"Unrecognized tag: "+u[3]+"|"+h.join("|");if(h[h.length-1][0]==="customdocumentproperties"){if(u[0].slice(-2)==="/>")break;u[1]==="/"?H7(b,ue,F,n.slice(O,u.index)):(F=u,O=u.index+u[0].length);break}if(r.WTF)throw"Unrecognized tag: "+u[3]+"|"+h.join("|")}var Pe={};return!r.bookSheets&&!r.bookProps&&(Pe.Sheets=g),Pe.SheetNames=_,Pe.Workbook=Q,Pe.SSF=tn(ht),Pe.Props=D,Pe.Custprops=b,Pe}function Ug(t,e){switch(dv(e=e||{}),e.type||"base64"){case"base64":return tg(Yn(t),e);case"binary":case"buffer":case"file":return tg(t,e);case"array":return tg(Zo(t),e)}}function X7(t){var e={},r=t.content;if(r.l=28,e.AnsiUserType=r.read_shift(0,"lpstr-ansi"),e.AnsiClipboardFormat=l8(r),r.length-r.l<=4)return e;var n=r.read_shift(4);if(n==0||n>40||(r.l-=4,e.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(n=r.read_shift(4),n!==1907505652)||(e.UnicodeClipboardFormat=c8(r),n=r.read_shift(4),n==0||n>40))return e;r.l-=4,e.Reserved2=r.read_shift(0,"lpwstr")}var Y7=[60,1084,2066,2165,2175];function $7(t,e,r,n,i){var o=n,c=[],u=r.slice(r.l,r.l+o);if(i&&i.enc&&i.enc.insitu&&u.length>0)switch(t){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:i.enc.insitu(u)}c.push(u),r.l+=o;for(var h=Oi(r,r.l),d=Bg[h],g=0;d!=null&&Y7.indexOf(h)>-1;)o=Oi(r,r.l+2),g=r.l+4,h==2066?g+=4:(h==2165||h==2175)&&(g+=12),u=r.slice(g,r.l+4+o),c.push(u),r.l+=4+o,d=Bg[h=Oi(r,r.l)];var _=ws(c);Zr(_,0);var x=0;_.lens=[];for(var A=0;A<c.length;++A)_.lens.push(x),x+=c[A].length;if(_.length<n)throw"XLS Record 0x"+t.toString(16)+" Truncated: "+_.length+" < "+n;return e.f(_,_.length,i)}function Qa(t,e,r){if(t.t!=="z"&&t.XF){var n=0;try{n=t.z||t.XF.numFmtId||0,e.cellNF&&(t.z=ht[n])}catch(o){if(e.WTF)throw o}if(!e||e.cellText!==!1)try{t.t==="e"?t.w=t.w||rl[t.v]:n===0||n=="General"?t.t==="n"?(t.v|0)===t.v?t.w=t.v.toString(10):t.w=uf(t.v):t.w=zo(t.v):t.w=ga(n,t.v,{date1904:!!r,dateNF:e&&e.dateNF})}catch(o){if(e.WTF)throw o}if(e.cellDates&&n&&t.t=="n"&&Ac(ht[n]||String(n))){var i=No(t.v);i&&(t.t="d",t.v=new Date(i.y,i.m-1,i.d,i.H,i.M,i.S,i.u))}}}function p0(t,e,r){return{v:t,ixfe:e,t:r}}function Q7(t,e){var r={opts:{}},n={},i=e.dense?[]:{},o={},c={},u=null,h=[],d="",g={},_,x="",A,S,R,w,B={},H=[],N,J,re=[],ne=[],C={Sheets:[],WBProps:{date1904:!1},Views:[{}]},T={},E=function(ot){return ot<8?Mo[ot]:ot<64&&ne[ot-8]||Mo[ot]},D=function(ot,Ft,Vt){var Ot=Ft.XF.data;if(!(!Ot||!Ot.patternType||!Vt||!Vt.cellStyles)){Ft.s={},Ft.s.patternType=Ot.patternType;var Lr;(Lr=mf(E(Ot.icvFore)))&&(Ft.s.fgColor={rgb:Lr}),(Lr=mf(E(Ot.icvBack)))&&(Ft.s.bgColor={rgb:Lr})}},b=function(ot,Ft,Vt){if(!(se>1)&&!(Vt.sheetRows&&ot.r>=Vt.sheetRows)){if(Vt.cellStyles&&Ft.XF&&Ft.XF.data&&D(ot,Ft,Vt),delete Ft.ixfe,delete Ft.XF,_=ot,x=vt(ot),(!c||!c.s||!c.e)&&(c={s:{r:0,c:0},e:{r:0,c:0}}),ot.r<c.s.r&&(c.s.r=ot.r),ot.c<c.s.c&&(c.s.c=ot.c),ot.r+1>c.e.r&&(c.e.r=ot.r+1),ot.c+1>c.e.c&&(c.e.c=ot.c+1),Vt.cellFormula&&Ft.f){for(var Ot=0;Ot<H.length;++Ot)if(!(H[Ot][0].s.c>ot.c||H[Ot][0].s.r>ot.r)&&!(H[Ot][0].e.c<ot.c||H[Ot][0].e.r<ot.r)){Ft.F=Gt(H[Ot][0]),(H[Ot][0].s.c!=ot.c||H[Ot][0].s.r!=ot.r)&&delete Ft.f,Ft.f&&(Ft.f=""+cn(H[Ot][1],c,ot,te,O));break}}Vt.dense?(i[ot.r]||(i[ot.r]=[]),i[ot.r][ot.c]=Ft):i[x]=Ft}},O={enc:!1,sbcch:0,snames:[],sharedf:B,arrayf:H,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!e&&!!e.cellStyles,WTF:!!e&&!!e.wtf};e.password&&(O.password=e.password);var F,Fe=[],Ce=[],ae=[],oe=[],Oe=!1,te=[];te.SheetNames=O.snames,te.sharedf=O.sharedf,te.arrayf=O.arrayf,te.names=[],te.XTI=[];var G=0,se=0,M=0,z=[],Q=[],Z;O.codepage=1200,ka(1200);for(var ue=!1;t.l<t.length-1;){var De=t.l,Ee=t.read_shift(2);if(Ee===0&&G===10)break;var we=t.l===t.length?0:t.read_shift(2),Te=Bg[Ee];if(Te&&Te.f){if(e.bookSheets&&G===133&&Ee!==133)break;if(G=Ee,Te.r===2||Te.r==12){var Ue=t.read_shift(2);if(we-=2,!O.enc&&Ue!==Ee&&((Ue&255)<<8|Ue>>8)!==Ee)throw new Error("rt mismatch: "+Ue+"!="+Ee);Te.r==12&&(t.l+=10,we-=10)}var X={};if(Ee===10?X=Te.f(t,we,O):X=$7(Ee,Te,t,we,O),se==0&&[9,521,1033,2057].indexOf(G)===-1)continue;switch(Ee){case 34:r.opts.Date1904=C.WBProps.date1904=X;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(O.enc||(t.l=0),O.enc=X,!e.password)throw new Error("File is password-protected");if(X.valid==null)throw new Error("Encryption scheme unsupported");if(!X.valid)throw new Error("Password is incorrect");break;case 92:O.lastuser=X;break;case 66:var nt=Number(X);switch(nt){case 21010:nt=1200;break;case 32768:nt=1e4;break;case 32769:nt=1252;break}ka(O.codepage=nt),ue=!0;break;case 317:O.rrtabid=X;break;case 25:O.winlocked=X;break;case 439:r.opts.RefreshAll=X;break;case 12:r.opts.CalcCount=X;break;case 16:r.opts.CalcDelta=X;break;case 17:r.opts.CalcIter=X;break;case 13:r.opts.CalcMode=X;break;case 14:r.opts.CalcPrecision=X;break;case 95:r.opts.CalcSaveRecalc=X;break;case 15:O.CalcRefMode=X;break;case 2211:r.opts.FullCalc=X;break;case 129:X.fDialog&&(i["!type"]="dialog"),X.fBelow||((i["!outline"]||(i["!outline"]={})).above=!0),X.fRight||((i["!outline"]||(i["!outline"]={})).left=!0);break;case 224:re.push(X);break;case 430:te.push([X]),te[te.length-1].XTI=[];break;case 35:case 547:te[te.length-1].push(X);break;case 24:case 536:Z={Name:X.Name,Ref:cn(X.rgce,c,null,te,O)},X.itab>0&&(Z.Sheet=X.itab-1),te.names.push(Z),te[0]||(te[0]=[],te[0].XTI=[]),te[te.length-1].push(X),X.Name=="_xlnm._FilterDatabase"&&X.itab>0&&X.rgce&&X.rgce[0]&&X.rgce[0][0]&&X.rgce[0][0][0]=="PtgArea3d"&&(Q[X.itab-1]={ref:Gt(X.rgce[0][0][1][2])});break;case 22:O.ExternCount=X;break;case 23:te.length==0&&(te[0]=[],te[0].XTI=[]),te[te.length-1].XTI=te[te.length-1].XTI.concat(X),te.XTI=te.XTI.concat(X);break;case 2196:if(O.biff<8)break;Z!=null&&(Z.Comment=X[1]);break;case 18:i["!protect"]=X;break;case 19:X!==0&&O.WTF&&console.error("Password verifier: "+X);break;case 133:o[X.pos]=X,O.snames.push(X.name);break;case 10:{if(--se)break;if(c.e){if(c.e.r>0&&c.e.c>0){if(c.e.r--,c.e.c--,i["!ref"]=Gt(c),e.sheetRows&&e.sheetRows<=c.e.r){var qe=c.e.r;c.e.r=e.sheetRows-1,i["!fullref"]=i["!ref"],i["!ref"]=Gt(c),c.e.r=qe}c.e.r++,c.e.c++}Fe.length>0&&(i["!merges"]=Fe),Ce.length>0&&(i["!objects"]=Ce),ae.length>0&&(i["!cols"]=ae),oe.length>0&&(i["!rows"]=oe),C.Sheets.push(T)}d===""?g=i:n[d]=i,i=e.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(O.biff===8&&(O.biff={9:2,521:3,1033:4}[Ee]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[X.BIFFVer]||8),O.biffguess=X.BIFFVer==0,X.BIFFVer==0&&X.dt==4096&&(O.biff=5,ue=!0,ka(O.codepage=28591)),O.biff==8&&X.BIFFVer==0&&X.dt==16&&(O.biff=2),se++)break;if(i=e.dense?[]:{},O.biff<8&&!ue&&(ue=!0,ka(O.codepage=e.codepage||1252)),O.biff<5||X.BIFFVer==0&&X.dt==4096){d===""&&(d="Sheet1"),c={s:{r:0,c:0},e:{r:0,c:0}};var We={pos:t.l-we,name:d};o[We.pos]=We,O.snames.push(d)}else d=(o[De]||{name:""}).name;X.dt==32&&(i["!type"]="chart"),X.dt==64&&(i["!type"]="macro"),Fe=[],Ce=[],O.arrayf=H=[],ae=[],oe=[],Oe=!1,T={Hidden:(o[De]||{hs:0}).hs,name:d}}break;case 515:case 3:case 2:i["!type"]=="chart"&&(e.dense?(i[X.r]||[])[X.c]:i[vt({c:X.c,r:X.r})])&&++X.c,N={ixfe:X.ixfe,XF:re[X.ixfe]||{},v:X.val,t:"n"},M>0&&(N.z=z[N.ixfe>>8&63]),Qa(N,e,r.opts.Date1904),b({c:X.c,r:X.r},N,e);break;case 5:case 517:N={ixfe:X.ixfe,XF:re[X.ixfe],v:X.val,t:X.t},M>0&&(N.z=z[N.ixfe>>8&63]),Qa(N,e,r.opts.Date1904),b({c:X.c,r:X.r},N,e);break;case 638:N={ixfe:X.ixfe,XF:re[X.ixfe],v:X.rknum,t:"n"},M>0&&(N.z=z[N.ixfe>>8&63]),Qa(N,e,r.opts.Date1904),b({c:X.c,r:X.r},N,e);break;case 189:for(var Be=X.c;Be<=X.C;++Be){var Pe=X.rkrec[Be-X.c][0];N={ixfe:Pe,XF:re[Pe],v:X.rkrec[Be-X.c][1],t:"n"},M>0&&(N.z=z[N.ixfe>>8&63]),Qa(N,e,r.opts.Date1904),b({c:Be,r:X.r},N,e)}break;case 6:case 518:case 1030:{if(X.val=="String"){u=X;break}if(N=p0(X.val,X.cell.ixfe,X.tt),N.XF=re[N.ixfe],e.cellFormula){var Ye=X.formula;if(Ye&&Ye[0]&&Ye[0][0]&&Ye[0][0][0]=="PtgExp"){var ut=Ye[0][0][1][0],_t=Ye[0][0][1][1],rr=vt({r:ut,c:_t});B[rr]?N.f=""+cn(X.formula,c,X.cell,te,O):N.F=((e.dense?(i[ut]||[])[_t]:i[rr])||{}).F}else N.f=""+cn(X.formula,c,X.cell,te,O)}M>0&&(N.z=z[N.ixfe>>8&63]),Qa(N,e,r.opts.Date1904),b(X.cell,N,e),u=X}break;case 7:case 519:if(u)u.val=X,N=p0(X,u.cell.ixfe,"s"),N.XF=re[N.ixfe],e.cellFormula&&(N.f=""+cn(u.formula,c,u.cell,te,O)),M>0&&(N.z=z[N.ixfe>>8&63]),Qa(N,e,r.opts.Date1904),b(u.cell,N,e),u=null;else throw new Error("String record expects Formula");break;case 33:case 545:{H.push(X);var yr=vt(X[0].s);if(A=e.dense?(i[X[0].s.r]||[])[X[0].s.c]:i[yr],e.cellFormula&&A){if(!u||!yr||!A)break;A.f=""+cn(X[1],c,X[0],te,O),A.F=Gt(X[0])}}break;case 1212:{if(!e.cellFormula)break;if(x){if(!u)break;B[vt(u.cell)]=X[0],A=e.dense?(i[u.cell.r]||[])[u.cell.c]:i[vt(u.cell)],(A||{}).f=""+cn(X[0],c,_,te,O)}}break;case 253:N=p0(h[X.isst].t,X.ixfe,"s"),h[X.isst].h&&(N.h=h[X.isst].h),N.XF=re[N.ixfe],M>0&&(N.z=z[N.ixfe>>8&63]),Qa(N,e,r.opts.Date1904),b({c:X.c,r:X.r},N,e);break;case 513:e.sheetStubs&&(N={ixfe:X.ixfe,XF:re[X.ixfe],t:"z"},M>0&&(N.z=z[N.ixfe>>8&63]),Qa(N,e,r.opts.Date1904),b({c:X.c,r:X.r},N,e));break;case 190:if(e.sheetStubs)for(var fr=X.c;fr<=X.C;++fr){var Et=X.ixfe[fr-X.c];N={ixfe:Et,XF:re[Et],t:"z"},M>0&&(N.z=z[N.ixfe>>8&63]),Qa(N,e,r.opts.Date1904),b({c:fr,r:X.r},N,e)}break;case 214:case 516:case 4:N=p0(X.val,X.ixfe,"s"),N.XF=re[N.ixfe],M>0&&(N.z=z[N.ixfe>>8&63]),Qa(N,e,r.opts.Date1904),b({c:X.c,r:X.r},N,e);break;case 0:case 512:se===1&&(c=X);break;case 252:h=X;break;case 1054:if(O.biff==4){z[M++]=X[1];for(var er=0;er<M+163&&ht[er]!=X[1];++er);er>=163&&Po(X[1],M+163)}else Po(X[1],X[0]);break;case 30:{z[M++]=X;for(var Ze=0;Ze<M+163&&ht[Ze]!=X;++Ze);Ze>=163&&Po(X,M+163)}break;case 229:Fe=Fe.concat(X);break;case 93:Ce[X.cmo[0]]=O.lastobj=X;break;case 438:O.lastobj.TxO=X;break;case 127:O.lastobj.ImData=X;break;case 440:for(w=X[0].s.r;w<=X[0].e.r;++w)for(R=X[0].s.c;R<=X[0].e.c;++R)A=e.dense?(i[w]||[])[R]:i[vt({c:R,r:w})],A&&(A.l=X[1]);break;case 2048:for(w=X[0].s.r;w<=X[0].e.r;++w)for(R=X[0].s.c;R<=X[0].e.c;++R)A=e.dense?(i[w]||[])[R]:i[vt({c:R,r:w})],A&&A.l&&(A.l.Tooltip=X[1]);break;case 28:{if(O.biff<=5&&O.biff>=2)break;A=e.dense?(i[X[0].r]||[])[X[0].c]:i[vt(X[0])];var Je=Ce[X[2]];A||(e.dense?(i[X[0].r]||(i[X[0].r]=[]),A=i[X[0].r][X[0].c]={t:"z"}):A=i[vt(X[0])]={t:"z"},c.e.r=Math.max(c.e.r,X[0].r),c.s.r=Math.min(c.s.r,X[0].r),c.e.c=Math.max(c.e.c,X[0].c),c.s.c=Math.min(c.s.c,X[0].c)),A.c||(A.c=[]),S={a:X[1],t:Je.TxO.t},A.c.push(S)}break;case 2173:x5(re[X.ixfe],X.ext);break;case 125:{if(!O.cellStyles)break;for(;X.e>=X.s;)ae[X.e--]={width:X.w/256,level:X.level||0,hidden:!!(X.flags&1)},Oe||(Oe=!0,lv(X.w/256)),dc(ae[X.e+1])}break;case 520:{var dt={};X.level!=null&&(oe[X.r]=dt,dt.level=X.level),X.hidden&&(oe[X.r]=dt,dt.hidden=!0),X.hpt&&(oe[X.r]=dt,dt.hpt=X.hpt,dt.hpx=gf(X.hpt))}break;case 38:case 39:case 40:case 41:i["!margins"]||Yu(i["!margins"]={}),i["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[Ee]]=X;break;case 161:i["!margins"]||Yu(i["!margins"]={}),i["!margins"].header=X.header,i["!margins"].footer=X.footer;break;case 574:X.RTL&&(C.Views[0].RTL=!0);break;case 146:ne=X;break;case 2198:F=X;break;case 140:J=X;break;case 442:d?T.CodeName=X||T.name:C.WBProps.CodeName=X||"ThisWorkbook";break}}else Te||console.error("Missing Info for XLS Record 0x"+Ee.toString(16)),t.l+=we}return r.SheetNames=Ks(o).sort(function(Lt,ot){return Number(Lt)-Number(ot)}).map(function(Lt){return o[Lt].name}),e.bookSheets||(r.Sheets=n),!r.SheetNames.length&&g["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=g)):r.Preamble=g,r.Sheets&&Q.forEach(function(Lt,ot){r.Sheets[r.SheetNames[ot]]["!autofilter"]=Lt}),r.Strings=h,r.SSF=tn(ht),O.enc&&(r.Encryption=O.enc),F&&(r.Themes=F),r.Metadata={},J!==void 0&&(r.Metadata.Country=J),te.names.length>0&&(C.Names=te.names),r.Workbook=C,r}var p2={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function Z7(t,e,r){var n=Dt.find(t,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var i=QT(n,m8,p2.DSI);for(var o in i)e[o]=i[o]}catch(d){if(r.WTF)throw d}var c=Dt.find(t,"/!SummaryInformation");if(c&&c.size>0)try{var u=QT(c,g8,p2.SI);for(var h in u)e[h]==null&&(e[h]=u[h])}catch(d){if(r.WTF)throw d}e.HeadingPairs&&e.TitlesOfParts&&(r4(e.HeadingPairs,e.TitlesOfParts,e,r),delete e.HeadingPairs,delete e.TitlesOfParts)}function U4(t,e){e||(e={}),dv(e),dS(),e.codepage&&W1(e.codepage);var r,n;if(t.FullPaths){if(Dt.find(t,"/encryption"))throw new Error("File is password-protected");r=Dt.find(t,"!CompObj"),n=Dt.find(t,"/Workbook")||Dt.find(t,"/Book")}else{switch(e.type){case"base64":t=Ca(Yn(t));break;case"binary":t=Ca(t);break;case"buffer":break;case"array":Array.isArray(t)||(t=Array.prototype.slice.call(t));break}Zr(t,0),n={content:t}}var i,o;if(r&&X7(r),e.bookProps&&!e.bookSheets)i={};else{var c=wt?"buffer":"array";if(n&&n.content)i=Q7(n.content,e);else if((o=Dt.find(t,"PerfectOffice_MAIN"))&&o.content)i=Wu.to_workbook(o.content,(e.type=c,e));else if((o=Dt.find(t,"NativeContent_MAIN"))&&o.content)i=Wu.to_workbook(o.content,(e.type=c,e));else throw(o=Dt.find(t,"MN0"))&&o.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");e.bookVBA&&t.FullPaths&&Dt.find(t,"/_VBA_PROJECT_CUR/VBA/dir")&&(i.vbaraw=L5(t))}var u={};return t.FullPaths&&Z7(t,u,e),i.Props=i.Custprops=u,e.bookFiles&&(i.cfb=t),i}var nd={0:{f:N9},1:{f:L9},2:{f:K9},3:{f:j9},4:{f:U9},5:{f:q9},6:{f:Y9},7:{f:H9},8:{f:e7},9:{f:J9},10:{f:Q9},11:{f:Z9},12:{f:V9},13:{f:W9},14:{f:z9},15:{f:B9},16:{f:F4},17:{f:$9},18:{f:G9},19:{f:rv},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:R7},40:{},42:{},43:{f:QM},44:{f:$M},45:{f:ZM},46:{f:e5},47:{f:JM},48:{},49:{f:t8},50:{},51:{f:E5},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:p4},62:{f:X9},63:{f:C5},64:{f:c7},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:mn,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:l7},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:M9},148:{f:F9,p:16},151:{f:n7},152:{},153:{f:S7},154:{},155:{},156:{f:w7},157:{},158:{},159:{T:1,f:gM},160:{T:-1},161:{T:1,f:tl},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:t7},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:y5},336:{T:-1},337:{f:T5,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:Pg},357:{},358:{},359:{},360:{T:1},361:{},362:{f:d4},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:a7},427:{f:i7},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:o7},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:P9},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:r7},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:Pg},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:F5},633:{T:1},634:{T:-1},635:{T:1,f:N5},636:{T:-1},637:{f:n8},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:m7},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:u7},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},Bg={6:{f:Jm},10:{f:xs},12:{f:Rr},13:{f:Rr},14:{f:mr},15:{f:mr},16:{f:fn},17:{f:mr},18:{f:mr},19:{f:Rr},20:{f:t2},21:{f:t2},23:{f:d4},24:{f:n2},25:{f:mr},26:{},27:{},28:{f:DP},29:{},34:{f:mr},35:{f:r2},38:{f:fn},39:{f:fn},40:{f:fn},41:{f:fn},42:{f:mr},43:{f:mr},47:{f:PM},49:{f:hP},51:{f:Rr},60:{},61:{f:cP},64:{f:mr},65:{f:fP},66:{f:Rr},77:{},80:{},81:{},82:{},85:{f:Rr},89:{},90:{},91:{},92:{f:tP},93:{f:NP},94:{},95:{f:mr},96:{},97:{},99:{f:mr},125:{f:p4},128:{f:TP},129:{f:rP},130:{f:Rr},131:{f:mr},132:{f:mr},133:{f:nP},134:{},140:{f:UP},141:{f:Rr},144:{},146:{f:jP},151:{},152:{},153:{},154:{},155:{},156:{f:Rr},157:{},158:{},160:{f:KP},161:{f:HP},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:_P},190:{f:xP},193:{f:xs},197:{},198:{},199:{},200:{},201:{},202:{f:mr},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:Rr},220:{},221:{f:mr},222:{},224:{f:EP},225:{f:eP},226:{f:xs},227:{},229:{f:OP},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:aP},253:{f:dP},255:{f:iP},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:o4},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:mr},353:{f:xs},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:wP},431:{f:mr},432:{},433:{},434:{},437:{},438:{f:MP},439:{f:mr},440:{f:LP},441:{},442:{f:Ff},443:{},444:{f:Rr},445:{},446:{},448:{f:xs},449:{f:lP,r:2},450:{f:xs},512:{f:JT},513:{f:qP},515:{f:AP},516:{f:pP},517:{f:e2},519:{f:WP},520:{f:sP},523:{},545:{f:a2},549:{f:ZT},566:{},574:{f:uP},638:{f:vP},659:{},1048:{},1054:{f:mP},1084:{},1212:{f:kP},2048:{f:VP},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:f0},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:xs},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:zP,r:12},2173:{f:_5,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:mr,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:RP,r:12},2197:{},2198:{f:h5,r:12},2199:{},2200:{},2201:{},2202:{f:bP,r:12},2203:{f:xs},2204:{},2205:{},2206:{},2207:{},2211:{f:oP},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:Rr},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:GP},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:BP},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:JT},1:{},2:{f:QP},3:{f:$P},4:{f:YP},5:{f:e2},7:{f:ZP},8:{},9:{f:f0},11:{},22:{f:Rr},30:{f:gP},31:{},32:{},33:{f:a2},36:{},37:{f:ZT},50:{f:JP},62:{},52:{},67:{},68:{f:Rr},69:{},86:{},126:{},127:{f:XP},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:eM},223:{},234:{},354:{},421:{},518:{f:Jm},521:{f:f0},536:{f:n2},547:{f:r2},561:{},579:{},1030:{f:Jm},1033:{f:f0},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function Sa(t,e,r,n){var i=e;if(!isNaN(i)){var o=(r||[]).length||0,c=t.next(4);c.write_shift(2,i),c.write_shift(2,o),o>0&&WS(r)&&t.push(r)}}function m2(t,e){var r=e||{},n=r.dense?[]:{};t=t.replace(/<!--.*?-->/g,"");var i=t.match(/<table/i);if(!i)throw new Error("Invalid HTML: could not find <table>");var o=t.match(/<\/table/i),c=i.index,u=o&&o.index||t.length,h=SF(t.slice(c,u),/(:?<tr[^>]*>)/i,"<tr>"),d=-1,g=0,_=0,x=0,A={s:{r:1e7,c:1e7},e:{r:0,c:0}},S=[];for(c=0;c<h.length;++c){var R=h[c].trim(),w=R.slice(0,3).toLowerCase();if(w=="<tr"){if(++d,r.sheetRows&&r.sheetRows<=d){--d;break}g=0;continue}if(!(w!="<td"&&w!="<th")){var B=R.split(/<\/t[dh]>/i);for(u=0;u<B.length;++u){var H=B[u].trim();if(H.match(/<t[dh]/i)){for(var N=H,J=0;N.charAt(0)=="<"&&(J=N.indexOf(">"))>-1;)N=N.slice(J+1);for(var re=0;re<S.length;++re){var ne=S[re];ne.s.c==g&&ne.s.r<d&&d<=ne.e.r&&(g=ne.e.c+1,re=-1)}var C=st(H.slice(0,H.indexOf(">")));x=C.colspan?+C.colspan:1,((_=+C.rowspan)>1||x>1)&&S.push({s:{r:d,c:g},e:{r:d+(_||1)-1,c:g+x-1}});var T=C.t||C["data-t"]||"";if(!N.length){g+=x;continue}if(N=MF(N),A.s.r>d&&(A.s.r=d),A.e.r<d&&(A.e.r=d),A.s.c>g&&(A.s.c=g),A.e.c<g&&(A.e.c=g),!N.length){g+=x;continue}var E={t:"s",v:N};r.raw||!N.trim().length||T=="s"||(N==="TRUE"?E={t:"b",v:!0}:N==="FALSE"?E={t:"b",v:!1}:isNaN(Mi(N))?isNaN(ff(N).getDate())||(E={t:"d",v:en(N)},r.cellDates||(E={t:"n",v:$n(E.v)}),E.z=r.dateNF||ht[14]):E={t:"n",v:Mi(N)}),r.dense?(n[d]||(n[d]=[]),n[d][g]=E):n[vt({r:d,c:g})]=E,g+=x}}}}return n["!ref"]=Gt(A),S.length&&(n["!merges"]=S),n}function J7(t,e){var r=t.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return Jo(m2(r[0],e),e);var n=H4();return r.forEach(function(i,o){G4(n,m2(i,e),"Sheet"+(o+1))}),n}function eV(t){var e=t.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,i){return Array(parseInt(i,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=Nt(e.replace(/<[^>]*>/g,""));return[r]}var g2={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function B4(t,e){var r=e||{},n=J1(t),i=[],o,c,u={name:""},h="",d=0,g,_,x={},A=[],S=r.dense?[]:{},R,w,B={value:""},H="",N=0,J=[],re=-1,ne=-1,C={s:{r:1e6,c:1e7},e:{r:0,c:0}},T=0,E={},D=[],b={},O=0,F=0,Fe=[],Ce=1,ae=1,oe=[],Oe={Names:[]},te={},G=["",""],se=[],M={},z="",Q=0,Z=!1,ue=!1,De=0;for(df.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");R=df.exec(n);)switch(R[3]=R[3].replace(/_.*$/,"")){case"table":case"工作表":R[1]==="/"?(C.e.c>=C.s.c&&C.e.r>=C.s.r?S["!ref"]=Gt(C):S["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=C.e.r&&(S["!fullref"]=S["!ref"],C.e.r=r.sheetRows-1,S["!ref"]=Gt(C)),D.length&&(S["!merges"]=D),Fe.length&&(S["!rows"]=Fe),g.name=g.名称||g.name,typeof JSON<"u"&&JSON.stringify(g),A.push(g.name),x[g.name]=S,ue=!1):R[0].charAt(R[0].length-2)!=="/"&&(g=st(R[0],!1),re=ne=-1,C.s.r=C.s.c=1e7,C.e.r=C.e.c=0,S=r.dense?[]:{},D=[],Fe=[],ue=!0);break;case"table-row-group":R[1]==="/"?--T:++T;break;case"table-row":case"行":if(R[1]==="/"){re+=Ce,Ce=1;break}if(_=st(R[0],!1),_.行号?re=_.行号-1:re==-1&&(re=0),Ce=+_["number-rows-repeated"]||1,Ce<10)for(De=0;De<Ce;++De)T>0&&(Fe[re+De]={level:T});ne=-1;break;case"covered-table-cell":R[1]!=="/"&&++ne,r.sheetStubs&&(r.dense?(S[re]||(S[re]=[]),S[re][ne]={t:"z"}):S[vt({r:re,c:ne})]={t:"z"}),H="",J=[];break;case"table-cell":case"数据":if(R[0].charAt(R[0].length-2)==="/")++ne,B=st(R[0],!1),ae=parseInt(B["number-columns-repeated"]||"1",10),w={t:"z",v:null},B.formula&&r.cellFormula!=!1&&(w.f=f2(Nt(B.formula))),(B.数据类型||B["value-type"])=="string"&&(w.t="s",w.v=Nt(B["string-value"]||""),r.dense?(S[re]||(S[re]=[]),S[re][ne]=w):S[vt({r:re,c:ne})]=w),ne+=ae-1;else if(R[1]!=="/"){++ne,H="",N=0,J=[],ae=1;var Ee=Ce?re+Ce-1:re;if(ne>C.e.c&&(C.e.c=ne),ne<C.s.c&&(C.s.c=ne),re<C.s.r&&(C.s.r=re),Ee>C.e.r&&(C.e.r=Ee),B=st(R[0],!1),se=[],M={},w={t:B.数据类型||B["value-type"],v:null},r.cellFormula)if(B.formula&&(B.formula=Nt(B.formula)),B["number-matrix-columns-spanned"]&&B["number-matrix-rows-spanned"]&&(O=parseInt(B["number-matrix-rows-spanned"],10)||0,F=parseInt(B["number-matrix-columns-spanned"],10)||0,b={s:{r:re,c:ne},e:{r:re+O-1,c:ne+F-1}},w.F=Gt(b),oe.push([b,w.F])),B.formula)w.f=f2(B.formula);else for(De=0;De<oe.length;++De)re>=oe[De][0].s.r&&re<=oe[De][0].e.r&&ne>=oe[De][0].s.c&&ne<=oe[De][0].e.c&&(w.F=oe[De][1]);switch((B["number-columns-spanned"]||B["number-rows-spanned"])&&(O=parseInt(B["number-rows-spanned"],10)||0,F=parseInt(B["number-columns-spanned"],10)||0,b={s:{r:re,c:ne},e:{r:re+O-1,c:ne+F-1}},D.push(b)),B["number-columns-repeated"]&&(ae=parseInt(B["number-columns-repeated"],10)),w.t){case"boolean":w.t="b",w.v=ir(B["boolean-value"]);break;case"float":w.t="n",w.v=parseFloat(B.value);break;case"percentage":w.t="n",w.v=parseFloat(B.value);break;case"currency":w.t="n",w.v=parseFloat(B.value);break;case"date":w.t="d",w.v=en(B["date-value"]),r.cellDates||(w.t="n",w.v=$n(w.v)),w.z="m/d/yy";break;case"time":w.t="n",w.v=TF(B["time-value"])/86400,r.cellDates&&(w.t="d",w.v=bd(w.v)),w.z="HH:MM:SS";break;case"number":w.t="n",w.v=parseFloat(B.数据数值);break;default:if(w.t==="string"||w.t==="text"||!w.t)w.t="s",B["string-value"]!=null&&(H=Nt(B["string-value"]),J=[]);else throw new Error("Unsupported value type "+w.t)}}else{if(Z=!1,w.t==="s"&&(w.v=H||"",J.length&&(w.R=J),Z=N==0),te.Target&&(w.l=te),se.length>0&&(w.c=se,se=[]),H&&r.cellText!==!1&&(w.w=H),Z&&(w.t="z",delete w.v),(!Z||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=re))for(var we=0;we<Ce;++we){if(ae=parseInt(B["number-columns-repeated"]||"1",10),r.dense)for(S[re+we]||(S[re+we]=[]),S[re+we][ne]=we==0?w:tn(w);--ae>0;)S[re+we][ne+ae]=tn(w);else for(S[vt({r:re+we,c:ne})]=w;--ae>0;)S[vt({r:re+we,c:ne+ae})]=tn(w);C.e.c<=ne&&(C.e.c=ne)}ae=parseInt(B["number-columns-repeated"]||"1",10),ne+=ae-1,ae=0,w={},H="",J=[]}te={};break;case"document":case"document-content":case"电子表格文档":case"spreadsheet":case"主体":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(R[1]==="/"){if((o=i.pop())[0]!==R[3])throw"Bad state: "+o}else R[0].charAt(R[0].length-2)!=="/"&&i.push([R[3],!0]);break;case"annotation":if(R[1]==="/"){if((o=i.pop())[0]!==R[3])throw"Bad state: "+o;M.t=H,J.length&&(M.R=J),M.a=z,se.push(M)}else R[0].charAt(R[0].length-2)!=="/"&&i.push([R[3],!1]);z="",Q=0,H="",N=0,J=[];break;case"creator":R[1]==="/"?z=n.slice(Q,R.index):Q=R.index+R[0].length;break;case"meta":case"元数据":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(R[1]==="/"){if((o=i.pop())[0]!==R[3])throw"Bad state: "+o}else R[0].charAt(R[0].length-2)!=="/"&&i.push([R[3],!1]);H="",N=0,J=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(R[1]==="/"){if(E[u.name]=h,(o=i.pop())[0]!==R[3])throw"Bad state: "+o}else R[0].charAt(R[0].length-2)!=="/"&&(h="",u=st(R[0],!1),i.push([R[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(i[i.length-1][0]){case"time-style":case"date-style":c=st(R[0],!1),h+=g2[R[3]][c.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(i[i.length-1][0]){case"time-style":case"date-style":c=st(R[0],!1),h+=g2[R[3]][c.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(R[0].slice(-2)==="/>")break;if(R[1]==="/")switch(i[i.length-1][0]){case"number-style":case"date-style":case"time-style":h+=n.slice(d,R.index);break}else d=R.index+R[0].length;break;case"named-range":c=st(R[0],!1),G=eg(c["cell-range-address"]);var Te={Name:c.name,Ref:G[0]+"!"+G[1]};ue&&(Te.Sheet=A.length),Oe.Names.push(Te);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"电子表格":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"文本串":if(["master-styles"].indexOf(i[i.length-1][0])>-1)break;if(R[1]==="/"&&(!B||!B["string-value"])){var Ue=eV(n.slice(N,R.index));H=(H.length>0?H+`
`:"")+Ue[0]}else st(R[0],!1),N=R.index+R[0].length;break;case"s":break;case"database-range":if(R[1]==="/")break;try{G=eg(st(R[0])["target-range-address"]),x[G[0]]["!autofilter"]={ref:G[1]}}catch{}break;case"date":break;case"object":break;case"title":case"标题":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(R[1]!=="/"){if(te=st(R[0],!1),!te.href)break;te.Target=Nt(te.href),delete te.href,te.Target.charAt(0)=="#"&&te.Target.indexOf(".")>-1?(G=eg(te.Target.slice(1)),te.Target="#"+G[0]+"!"+G[1]):te.Target.match(/^\.\.[\\\/]/)&&(te.Target=te.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(R[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case"表:":case"字:":break;default:if(r.WTF)throw new Error(R)}}var X={Sheets:x,SheetNames:A,Workbook:Oe};return r.bookSheets&&delete X.Sheets,X}function v2(t,e){e=e||{},fa(t,"META-INF/manifest.xml")&&A8(Cr(t,"META-INF/manifest.xml"),e);var r=Kn(t,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var n=B4(Jt(r),e);return fa(t,"meta.xml")&&(n.Props=t4(Cr(t,"meta.xml"))),n}function _2(t,e){return B4(t,e)}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function fv(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}function jg(t){return typeof TextDecoder<"u"?new TextDecoder().decode(t):Jt(Zo(t))}function zg(t){var e=t.reduce(function(i,o){return i+o.length},0),r=new Uint8Array(e),n=0;return t.forEach(function(i){r.set(i,n),n+=i.length}),r}function x2(t){return t-=t>>1&1431655765,t=(t&858993459)+(t>>2&858993459),(t+(t>>4)&252645135)*16843009>>>24}function tV(t,e){for(var r=(t[e+15]&127)<<7|t[e+14]>>1,n=t[e+14]&1,i=e+13;i>=e;--i)n=n*256+t[i];return(t[e+15]&128?-n:n)*Math.pow(10,r-6176)}function vf(t,e){var r=e?e[0]:0,n=t[r]&127;e:if(t[r++]>=128&&(n|=(t[r]&127)<<7,t[r++]<128||(n|=(t[r]&127)<<14,t[r++]<128)||(n|=(t[r]&127)<<21,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,28),++r,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,35),++r,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,42),++r,t[r++]<128)))break e;return e&&(e[0]=r),n}function Mr(t){var e=0,r=t[e]&127;e:if(t[e++]>=128){if(r|=(t[e]&127)<<7,t[e++]<128||(r|=(t[e]&127)<<14,t[e++]<128)||(r|=(t[e]&127)<<21,t[e++]<128))break e;r|=(t[e]&127)<<28}return r}function hn(t){for(var e=[],r=[0];r[0]<t.length;){var n=r[0],i=vf(t,r),o=i&7;i=Math.floor(i/8);var c=0,u;if(i==0)break;switch(o){case 0:{for(var h=r[0];t[r[0]++]>=128;);u=t.slice(h,r[0])}break;case 5:c=4,u=t.slice(r[0],r[0]+c),r[0]+=c;break;case 1:c=8,u=t.slice(r[0],r[0]+c),r[0]+=c;break;case 2:c=vf(t,r),u=t.slice(r[0],r[0]+c),r[0]+=c;break;case 3:case 4:default:throw new Error("PB Type ".concat(o," for Field ").concat(i," at offset ").concat(n))}var d={data:u,type:o};e[i]==null?e[i]=[d]:e[i].push(d)}return e}function hv(t,e){return t?.map(function(r){return e(r.data)})||[]}function rV(t){for(var e,r=[],n=[0];n[0]<t.length;){var i=vf(t,n),o=hn(t.slice(n[0],n[0]+i));n[0]+=i;var c={id:Mr(o[1][0].data),messages:[]};o[2].forEach(function(u){var h=hn(u.data),d=Mr(h[3][0].data);c.messages.push({meta:h,data:t.slice(n[0],n[0]+d)}),n[0]+=d}),(e=o[3])!=null&&e[0]&&(c.merge=Mr(o[3][0].data)>>>0>0),r.push(c)}return r}function nV(t,e){if(t!=0)throw new Error("Unexpected Snappy chunk type ".concat(t));for(var r=[0],n=vf(e,r),i=[];r[0]<e.length;){var o=e[r[0]]&3;if(o==0){var c=e[r[0]++]>>2;if(c<60)++c;else{var u=c-59;c=e[r[0]],u>1&&(c|=e[r[0]+1]<<8),u>2&&(c|=e[r[0]+2]<<16),u>3&&(c|=e[r[0]+3]<<24),c>>>=0,c++,r[0]+=u}i.push(e.slice(r[0],r[0]+c)),r[0]+=c;continue}else{var h=0,d=0;if(o==1?(d=(e[r[0]]>>2&7)+4,h=(e[r[0]++]&224)<<3,h|=e[r[0]++]):(d=(e[r[0]++]>>2)+1,o==2?(h=e[r[0]]|e[r[0]+1]<<8,r[0]+=2):(h=(e[r[0]]|e[r[0]+1]<<8|e[r[0]+2]<<16|e[r[0]+3]<<24)>>>0,r[0]+=4)),i=[zg(i)],h==0)throw new Error("Invalid offset 0");if(h>i[0].length)throw new Error("Invalid offset beyond length");if(d>=h)for(i.push(i[0].slice(-h)),d-=h;d>=i[i.length-1].length;)i.push(i[i.length-1]),d-=i[i.length-1].length;i.push(i[0].slice(-h,-h+d))}}var g=zg(i);if(g.length!=n)throw new Error("Unexpected length: ".concat(g.length," != ").concat(n));return g}function aV(t){for(var e=[],r=0;r<t.length;){var n=t[r++],i=t[r]|t[r+1]<<8|t[r+2]<<16;r+=3,e.push(nV(n,t.slice(r,r+i))),r+=i}if(r!==t.length)throw new Error("data is not a valid framed stream!");return zg(e)}function iV(t,e,r,n){var i=fv(t),o=i.getUint32(4,!0),c=(n>1?12:8)+x2(o&(n>1?3470:398))*4,u=-1,h=-1,d=NaN,g=new Date(2001,0,1);o&512&&(u=i.getUint32(c,!0),c+=4),c+=x2(o&(n>1?12288:4096))*4,o&16&&(h=i.getUint32(c,!0),c+=4),o&32&&(d=i.getFloat64(c,!0),c+=8),o&64&&(g.setTime(g.getTime()+i.getFloat64(c,!0)*1e3),c+=8);var _;switch(t[2]){case 0:break;case 2:_={t:"n",v:d};break;case 3:_={t:"s",v:e[h]};break;case 5:_={t:"d",v:g};break;case 6:_={t:"b",v:d>0};break;case 7:_={t:"n",v:d/86400};break;case 8:_={t:"e",v:0};break;case 9:if(u>-1)_={t:"s",v:r[u]};else if(h>-1)_={t:"s",v:e[h]};else if(!isNaN(d))_={t:"n",v:d};else throw new Error("Unsupported cell type ".concat(t.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(t.slice(0,4)))}return _}function sV(t,e,r){var n=fv(t),i=n.getUint32(8,!0),o=12,c=-1,u=-1,h=NaN,d=NaN,g=new Date(2001,0,1);i&1&&(h=tV(t,o),o+=16),i&2&&(d=n.getFloat64(o,!0),o+=8),i&4&&(g.setTime(g.getTime()+n.getFloat64(o,!0)*1e3),o+=8),i&8&&(u=n.getUint32(o,!0),o+=4),i&16&&(c=n.getUint32(o,!0),o+=4);var _;switch(t[1]){case 0:break;case 2:_={t:"n",v:h};break;case 3:_={t:"s",v:e[u]};break;case 5:_={t:"d",v:g};break;case 6:_={t:"b",v:d>0};break;case 7:_={t:"n",v:d/86400};break;case 8:_={t:"e",v:0};break;case 9:if(c>-1)_={t:"s",v:r[c]};else throw new Error("Unsupported cell type ".concat(t[1]," : ").concat(i&31," : ").concat(t.slice(0,4)));break;case 10:_={t:"n",v:h};break;default:throw new Error("Unsupported cell type ".concat(t[1]," : ").concat(i&31," : ").concat(t.slice(0,4)))}return _}function oV(t,e,r){switch(t[0]){case 0:case 1:case 2:case 3:return iV(t,e,r,t[0]);case 5:return sV(t,e,r);default:throw new Error("Unsupported payload version ".concat(t[0]))}}function Ls(t){var e=hn(t);return vf(e[1][0].data)}function y2(t,e){var r=hn(e.data),n=Mr(r[1][0].data),i=r[3],o=[];return(i||[]).forEach(function(c){var u=hn(c.data),h=Mr(u[1][0].data)>>>0;switch(n){case 1:o[h]=jg(u[3][0].data);break;case 8:{var d=t[Ls(u[9][0].data)][0],g=hn(d.data),_=t[Ls(g[1][0].data)][0],x=Mr(_.meta[1][0].data);if(x!=2001)throw new Error("2000 unexpected reference to ".concat(x));var A=hn(_.data);o[h]=A[3].map(function(S){return jg(S.data)}).join("")}break}}),o}function lV(t,e){var r,n,i,o,c,u,h,d,g,_,x,A,S,R,w=hn(t),B=Mr(w[1][0].data)>>>0,H=Mr(w[2][0].data)>>>0,N=((n=(r=w[8])==null?void 0:r[0])==null?void 0:n.data)&&Mr(w[8][0].data)>0||!1,J,re;if((o=(i=w[7])==null?void 0:i[0])!=null&&o.data&&e!=0)J=(u=(c=w[7])==null?void 0:c[0])==null?void 0:u.data,re=(d=(h=w[6])==null?void 0:h[0])==null?void 0:d.data;else if((_=(g=w[4])==null?void 0:g[0])!=null&&_.data&&e!=1)J=(A=(x=w[4])==null?void 0:x[0])==null?void 0:A.data,re=(R=(S=w[3])==null?void 0:S[0])==null?void 0:R.data;else throw"NUMBERS Tile missing ".concat(e," cell storage");for(var ne=N?4:1,C=fv(J),T=[],E=0;E<J.length/2;++E){var D=C.getUint16(E*2,!0);D<65535&&T.push([E,D])}if(T.length!=H)throw"Expected ".concat(H," cells, found ").concat(T.length);var b=[];for(E=0;E<T.length-1;++E)b[T[E][0]]=re.subarray(T[E][1]*ne,T[E+1][1]*ne);return T.length>=1&&(b[T[T.length-1][0]]=re.subarray(T[T.length-1][1]*ne)),{R:B,cells:b}}function cV(t,e){var r,n=hn(e.data),i=(r=n?.[7])!=null&&r[0]?Mr(n[7][0].data)>>>0>0?1:0:-1,o=hv(n[5],function(c){return lV(c,i)});return{nrows:Mr(n[4][0].data)>>>0,data:o.reduce(function(c,u){return c[u.R]||(c[u.R]=[]),u.cells.forEach(function(h,d){if(c[u.R][d])throw new Error("Duplicate cell r=".concat(u.R," c=").concat(d));c[u.R][d]=h}),c},[])}}function uV(t,e,r){var n,i=hn(e.data),o={s:{r:0,c:0},e:{r:0,c:0}};if(o.e.r=(Mr(i[6][0].data)>>>0)-1,o.e.r<0)throw new Error("Invalid row varint ".concat(i[6][0].data));if(o.e.c=(Mr(i[7][0].data)>>>0)-1,o.e.c<0)throw new Error("Invalid col varint ".concat(i[7][0].data));r["!ref"]=Gt(o);var c=hn(i[4][0].data),u=y2(t,t[Ls(c[4][0].data)][0]),h=(n=c[17])!=null&&n[0]?y2(t,t[Ls(c[17][0].data)][0]):[],d=hn(c[3][0].data),g=0;d[1].forEach(function(_){var x=hn(_.data),A=t[Ls(x[2][0].data)][0],S=Mr(A.meta[1][0].data);if(S!=6002)throw new Error("6001 unexpected reference to ".concat(S));var R=cV(t,A);R.data.forEach(function(w,B){w.forEach(function(H,N){var J=vt({r:g+B,c:N}),re=oV(H,u,h);re&&(r[J]=re)})}),g+=R.nrows})}function fV(t,e){var r=hn(e.data),n={"!ref":"A1"},i=t[Ls(r[2][0].data)],o=Mr(i[0].meta[1][0].data);if(o!=6001)throw new Error("6000 unexpected reference to ".concat(o));return uV(t,i[0],n),n}function hV(t,e){var r,n=hn(e.data),i={name:(r=n[1])!=null&&r[0]?jg(n[1][0].data):"",sheets:[]},o=hv(n[2],Ls);return o.forEach(function(c){t[c].forEach(function(u){var h=Mr(u.meta[1][0].data);h==6e3&&i.sheets.push(fV(t,u))})}),i}function dV(t,e){var r=H4(),n=hn(e.data),i=hv(n[1],Ls);if(i.forEach(function(o){t[o].forEach(function(c){var u=Mr(c.meta[1][0].data);if(u==2){var h=hV(t,c);h.sheets.forEach(function(d,g){G4(r,d,g==0?h.name:h.name+"_"+g,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function rg(t){var e,r,n,i,o={},c=[];if(t.FullPaths.forEach(function(h){if(h.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),t.FileIndex.forEach(function(h){if(h.name.match(/\.iwa$/)){var d;try{d=aV(h.content)}catch(_){return console.log("?? "+h.content.length+" "+(_.message||_))}var g;try{g=rV(d)}catch(_){return console.log("## "+(_.message||_))}g.forEach(function(_){o[_.id]=_.messages,c.push(_.id)})}}),!c.length)throw new Error("File has no messages");var u=((i=(n=(r=(e=o?.[1])==null?void 0:e[0])==null?void 0:r.meta)==null?void 0:n[1])==null?void 0:i[0].data)&&Mr(o[1][0].meta[1][0].data)==1&&o[1][0];if(u||c.forEach(function(h){o[h].forEach(function(d){var g=Mr(d.meta[1][0].data)>>>0;if(g==1)if(!u)u=d;else throw new Error("Document has multiple roots")})}),!u)throw new Error("Cannot find Document root");return dV(o,u)}function pV(t){return function(r){for(var n=0;n!=t.length;++n){var i=t[n];r[i[0]]===void 0&&(r[i[0]]=i[1]),i[2]==="n"&&(r[i[0]]=Number(r[i[0]]))}}}function dv(t){pV([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(t)}function mV(t){return $l.WS.indexOf(t)>-1?"sheet":t==$l.CS?"chart":t==$l.DS?"dialog":t==$l.MS?"macro":t&&t.length?t:"sheet"}function gV(t,e){if(!t)return 0;try{t=e.map(function(n){return n.id||(n.id=n.strRelID),[n.name,t["!id"][n.id].Target,mV(t["!id"][n.id].Type)]})}catch{return null}return!t||t.length===0?null:t}function vV(t,e,r,n,i,o,c,u,h,d,g,_){try{o[n]=qu(Kn(t,r,!0),e);var x=Cr(t,e),A;switch(u){case"sheet":A=I7(x,e,i,h,o[n],d,g,_);break;case"chart":if(A=D7(x,e,i,h,o[n],d,g,_),!A||!A["!drawel"])break;var S=Nu(A["!drawel"].Target,e),R=Mg(S),w=b5(Kn(t,S,!0),qu(Kn(t,R,!0),S)),B=Nu(w,S),H=Mg(B);A=d7(Kn(t,B,!0),B,h,qu(Kn(t,H,!0),B),d,A);break;case"macro":A=O7(x,e,i,h,o[n],d,g,_);break;case"dialog":A=N7(x,e,i,h,o[n],d,g,_);break;default:throw new Error("Unrecognized sheet type "+u)}c[n]=A;var N=[];o&&o[n]&&Ks(o[n]).forEach(function(J){var re="";if(o[n][J].Type==$l.CMNT){re=Nu(o[n][J].Target,e);var ne=L7(Cr(t,re,!0),re,h);if(!ne||!ne.length)return;s2(A,ne,!1)}o[n][J].Type==$l.TCMNT&&(re=Nu(o[n][J].Target,e),N=N.concat(D5(Cr(t,re,!0),h)))}),N&&N.length&&s2(A,N,!0,h.people||[])}catch(J){if(h.WTF)throw J}}function ca(t){return t.charAt(0)=="/"?t.slice(1):t}function _V(t,e){if(SS(),e=e||{},dv(e),fa(t,"META-INF/manifest.xml")||fa(t,"objectdata.xml"))return v2(t,e);if(fa(t,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof rg<"u"){if(t.FileIndex)return rg(t);var r=Dt.utils.cfb_new();return NT(t).forEach(function(Fe){kF(r,Fe,RF(t,Fe))}),rg(r)}throw new Error("Unsupported NUMBERS file")}if(!fa(t,"[Content_Types].xml"))throw fa(t,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):fa(t,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=NT(t),i=E8(Kn(t,"[Content_Types].xml")),o=!1,c,u;if(i.workbooks.length===0&&(u="xl/workbook.xml",Cr(t,u,!0)&&i.workbooks.push(u)),i.workbooks.length===0){if(u="xl/workbook.bin",!Cr(t,u,!0))throw new Error("Could not find workbook");i.workbooks.push(u),o=!0}i.workbooks[0].slice(-3)=="bin"&&(o=!0);var h={},d={};if(!e.bookSheets&&!e.bookProps){if(Xu=[],i.sst)try{Xu=M7(Cr(t,ca(i.sst)),i.sst,e)}catch(Fe){if(e.WTF)throw Fe}e.cellStyles&&i.themes.length&&(h=P7(Kn(t,i.themes[0].replace(/^\//,""),!0)||"",i.themes[0],e)),i.style&&(d=F7(Cr(t,ca(i.style)),i.style,h,e))}i.links.map(function(Fe){try{var Ce=qu(Kn(t,Mg(ca(Fe))),Fe);return U7(Cr(t,ca(Fe)),Ce,Fe,e)}catch{}});var g=b7(Cr(t,ca(i.workbooks[0])),i.workbooks[0],e),_={},x="";i.coreprops.length&&(x=Cr(t,ca(i.coreprops[0]),!0),x&&(_=t4(x)),i.extprops.length!==0&&(x=Cr(t,ca(i.extprops[0]),!0),x&&C8(x,_,e)));var A={};(!e.bookSheets||e.bookProps)&&i.custprops.length!==0&&(x=Kn(t,ca(i.custprops[0]),!0),x&&(A=k8(x,e)));var S={};if((e.bookSheets||e.bookProps)&&(g.Sheets?c=g.Sheets.map(function(Ce){return Ce.name}):_.Worksheets&&_.SheetNames.length>0&&(c=_.SheetNames),e.bookProps&&(S.Props=_,S.Custprops=A),e.bookSheets&&typeof c<"u"&&(S.SheetNames=c),e.bookSheets?S.SheetNames:e.bookProps))return S;c={};var R={};e.bookDeps&&i.calcchain&&(R=V7(Cr(t,ca(i.calcchain)),i.calcchain));var w=0,B={},H,N;{var J=g.Sheets;_.Worksheets=J.length,_.SheetNames=[];for(var re=0;re!=J.length;++re)_.SheetNames[re]=J[re].name}var ne=o?"bin":"xml",C=i.workbooks[0].lastIndexOf("/"),T=(i.workbooks[0].slice(0,C+1)+"_rels/"+i.workbooks[0].slice(C+1)+".rels").replace(/^\//,"");fa(t,T)||(T="xl/_rels/workbook."+ne+".rels");var E=qu(Kn(t,T,!0),T.replace(/_rels.*/,"s5s"));(i.metadata||[]).length>=1&&(e.xlmeta=B7(Cr(t,ca(i.metadata[0])),i.metadata[0],e)),(i.people||[]).length>=1&&(e.people=O5(Cr(t,ca(i.people[0])),e)),E&&(E=gV(E,g.Sheets));var D=Cr(t,"xl/worksheets/sheet.xml",!0)?1:0;e:for(w=0;w!=_.Worksheets;++w){var b="sheet";if(E&&E[w]?(H="xl/"+E[w][1].replace(/[\/]?xl\//,""),fa(t,H)||(H=E[w][1]),fa(t,H)||(H=T.replace(/_rels\/.*$/,"")+E[w][1]),b=E[w][2]):(H="xl/worksheets/sheet"+(w+1-D)+"."+ne,H=H.replace(/sheet0\./,"sheet.")),N=H.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),e&&e.sheets!=null)switch(typeof e.sheets){case"number":if(w!=e.sheets)continue e;break;case"string":if(_.SheetNames[w].toLowerCase()!=e.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(e.sheets)){for(var O=!1,F=0;F!=e.sheets.length;++F)typeof e.sheets[F]=="number"&&e.sheets[F]==w&&(O=1),typeof e.sheets[F]=="string"&&e.sheets[F].toLowerCase()==_.SheetNames[w].toLowerCase()&&(O=1);if(!O)continue e}}vV(t,H,N,_.SheetNames[w],w,B,c,b,e,g,h,d)}return S={Directory:i,Workbook:g,Props:_,Custprops:A,Deps:R,Sheets:c,SheetNames:_.SheetNames,Strings:Xu,Styles:d,Themes:h,SSF:tn(ht)},e&&e.bookFiles&&(t.files?(S.keys=n,S.files=t.files):(S.keys=[],S.files={},t.FullPaths.forEach(function(Fe,Ce){Fe=Fe.replace(/^Root Entry[\/]/,""),S.keys.push(Fe),S.files[Fe]=t.FileIndex[Ce]}))),e&&e.bookVBA&&(i.vba.length>0?S.vbaraw=Cr(t,ca(i.vba[0]),!0):i.defaults&&i.defaults.bin===M5&&(S.vbaraw=Cr(t,"xl/vbaProject.bin",!0))),S}function xV(t,e){var r=e||{},n="Workbook",i=Dt.find(t,n);try{if(n="/!DataSpaces/Version",i=Dt.find(t,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(_M(i.content),n="/!DataSpaces/DataSpaceMap",i=Dt.find(t,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var o=yM(i.content);if(o.length!==1||o[0].comps.length!==1||o[0].comps[0].t!==0||o[0].name!=="StrongEncryptionDataSpace"||o[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",i=Dt.find(t,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var c=EM(i.content);if(c.length!=1||c[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",i=Dt.find(t,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);AM(i.content)}catch{}if(n="/EncryptionInfo",i=Dt.find(t,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var u=wM(i.content);if(n="/EncryptedPackage",i=Dt.find(t,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(u[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(u[1],i.content,r.password||"",r);if(u[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(u[1],i.content,r.password||"",r);throw new Error("File is password-protected")}function pv(t,e){var r="";switch((e||{}).type||"base64"){case"buffer":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];case"base64":r=Yn(t.slice(0,12));break;case"binary":r=t;break;case"array":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];default:throw new Error("Unrecognized type "+(e&&e.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function yV(t,e){return Dt.find(t,"EncryptedPackage")?xV(t,e):U4(t,e)}function EV(t,e){var r,n=t,i=e||{};return i.type||(i.type=wt&&Buffer.isBuffer(t)?"buffer":"base64"),r=DS(n,i),_V(r,i)}function j4(t,e){var r=0;e:for(;r<t.length;)switch(t.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return Ug(t.slice(r),e);default:break e}return pf.to_workbook(t,e)}function TV(t,e){var r="",n=pv(t,e);switch(e.type){case"base64":r=Yn(t);break;case"binary":r=t;break;case"buffer":r=t.toString("binary");break;case"array":r=Ho(t);break;default:throw new Error("Unrecognized type "+e.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(r=Jt(r)),e.type="binary",j4(r,e)}function AV(t,e){var r=t;return e.type=="base64"&&(r=Yn(r)),r=cf.utils.decode(1200,r.slice(2),"str"),e.type="binary",j4(r,e)}function wV(t){return t.match(/[^\x00-\x7F]/)?Fu(t):t}function ng(t,e,r,n){return n?(r.type="string",pf.to_workbook(t,r)):pf.to_workbook(e,r)}function Hg(t,e){dS();var r=e||{};if(typeof ArrayBuffer<"u"&&t instanceof ArrayBuffer)return Hg(new Uint8Array(t),(r=tn(r),r.type="array",r));typeof Uint8Array<"u"&&t instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var n=t,i=[0,0,0,0],o=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),ac={},r.dateNF&&(ac.dateNF=r.dateNF),r.type||(r.type=wt&&Buffer.isBuffer(t)?"buffer":"base64"),r.type=="file"&&(r.type=wt?"buffer":"binary",n=yF(t),typeof Uint8Array<"u"&&!wt&&(r.type="array")),r.type=="string"&&(o=!0,r.type="binary",r.codepage=65001,n=wV(t)),r.type=="array"&&typeof Uint8Array<"u"&&t instanceof Uint8Array&&typeof ArrayBuffer<"u"){var c=new ArrayBuffer(3),u=new Uint8Array(c);if(u.foo="bar",!u.foo)return r=tn(r),r.type="array",Hg(X1(n),r)}switch((i=pv(n,r))[0]){case 208:if(i[1]===207&&i[2]===17&&i[3]===224&&i[4]===161&&i[5]===177&&i[6]===26&&i[7]===225)return yV(Dt.read(n,r),r);break;case 9:if(i[1]<=8)return U4(n,r);break;case 60:return Ug(n,r);case 73:if(i[1]===73&&i[2]===42&&i[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(i[1]===68)return iM(n,r);break;case 84:if(i[1]===65&&i[2]===66&&i[3]===76)return nM.to_workbook(n,r);break;case 80:return i[1]===75&&i[2]<9&&i[3]<9?EV(n,r):ng(t,n,r,o);case 239:return i[3]===60?Ug(n,r):ng(t,n,r,o);case 255:if(i[1]===254)return AV(n,r);if(i[1]===0&&i[2]===2&&i[3]===0)return Wu.to_workbook(n,r);break;case 0:if(i[1]===0&&(i[2]>=2&&i[3]===0||i[2]===0&&(i[3]===8||i[3]===9)))return Wu.to_workbook(n,r);break;case 3:case 131:case 139:case 140:return i2.to_workbook(n,r);case 123:if(i[1]===92&&i[2]===114&&i[3]===116)return MM.to_workbook(n,r);break;case 10:case 13:case 32:return TV(n,r);case 137:if(i[1]===80&&i[2]===78&&i[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return tM.indexOf(i[0])>-1&&i[2]<=12&&i[3]<=31?i2.to_workbook(n,r):ng(t,n,r,o)}function SV(t,e,r,n,i,o,c,u){var h=Xn(r),d=u.defval,g=u.raw||!Object.prototype.hasOwnProperty.call(u,"raw"),_=!0,x=i===1?[]:{};if(i!==1)if(Object.defineProperty)try{Object.defineProperty(x,"__rowNum__",{value:r,enumerable:!1})}catch{x.__rowNum__=r}else x.__rowNum__=r;if(!c||t[r])for(var A=e.s.c;A<=e.e.c;++A){var S=c?t[r][A]:t[n[A]+h];if(S===void 0||S.t===void 0){if(d===void 0)continue;o[A]!=null&&(x[o[A]]=d);continue}var R=S.v;switch(S.t){case"z":if(R==null)break;continue;case"e":R=R==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+S.t)}if(o[A]!=null){if(R==null)if(S.t=="e"&&R===null)x[o[A]]=null;else if(d!==void 0)x[o[A]]=d;else if(g&&R===null)x[o[A]]=null;else continue;else x[o[A]]=g&&(S.t!=="n"||S.t==="n"&&u.rawNumbers!==!1)?R:hc(S,R,u);R!=null&&(_=!1)}}return{row:x,isempty:_}}function z4(t,e){if(t==null||t["!ref"]==null)return[];var r={t:"n",v:0},n=0,i=1,o=[],c=0,u="",h={s:{r:0,c:0},e:{r:0,c:0}},d=e||{},g=d.range!=null?d.range:t["!ref"];switch(d.header===1?n=1:d.header==="A"?n=2:Array.isArray(d.header)?n=3:d.header==null&&(n=0),typeof g){case"string":h=Kr(g);break;case"number":h=Kr(t["!ref"]),h.s.r=g;break;default:h=g}n>0&&(i=0);var _=Xn(h.s.r),x=[],A=[],S=0,R=0,w=Array.isArray(t),B=h.s.r,H=0,N={};w&&!t[B]&&(t[B]=[]);var J=d.skipHidden&&t["!cols"]||[],re=d.skipHidden&&t["!rows"]||[];for(H=h.s.c;H<=h.e.c;++H)if(!(J[H]||{}).hidden)switch(x[H]=wn(H),r=w?t[B][H]:t[x[H]+_],n){case 1:o[H]=H-h.s.c;break;case 2:o[H]=x[H];break;case 3:o[H]=d.header[H-h.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),u=c=hc(r,null,d),R=N[c]||0,!R)N[c]=1;else{do u=c+"_"+R++;while(N[u]);N[c]=R,N[u]=1}o[H]=u}for(B=h.s.r+i;B<=h.e.r;++B)if(!(re[B]||{}).hidden){var ne=SV(t,h,B,x,n,o,w,d);(ne.isempty===!1||(n===1?d.blankrows!==!1:d.blankrows))&&(A[S++]=ne.row)}return A.length=S,A}function H4(){return{SheetNames:[],Sheets:{}}}function G4(t,e,r,n){var i=1;if(!r)for(;i<=65535&&t.SheetNames.indexOf(r="Sheet"+i)!=-1;++i,r=void 0);if(!r||t.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&t.SheetNames.indexOf(r)>=0){var o=r.match(/(^.*?)(\d+)$/);i=o&&+o[2]||0;var c=o&&o[1]||r;for(++i;i<=65535&&t.SheetNames.indexOf(r=c+i)!=-1;++i);}if(E7(r),t.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return t.SheetNames.push(r),t.Sheets[r]=e,r}var CV={sheet_to_json:z4},S0={exports:{}};/* @license
Papa Parse
v5.5.3
https://github.com/mholt/PapaParse
License: MIT
*/var RV=S0.exports,E2;function kV(){return E2||(E2=1,function(t,e){((r,n)=>{t.exports=n()})(RV,function r(){var n=typeof self<"u"?self:typeof window<"u"?window:n!==void 0?n:{},i,o=!n.document&&!!n.postMessage,c=n.IS_PAPA_WORKER||!1,u={},h=0,d={};function g(T){this._handle=null,this._finished=!1,this._completed=!1,this._halted=!1,this._input=null,this._baseIndex=0,this._partialLine="",this._rowCount=0,this._start=0,this._nextChunk=null,this.isFirstChunk=!0,this._completeResults={data:[],errors:[],meta:{}},(function(E){var D=re(E);D.chunkSize=parseInt(D.chunkSize),E.step||E.chunk||(D.chunkSize=null),this._handle=new R(D),(this._handle.streamer=this)._config=D}).call(this,T),this.parseChunk=function(E,D){var b=parseInt(this._config.skipFirstNLines)||0;if(this.isFirstChunk&&0<b){let F=this._config.newline;F||(O=this._config.quoteChar||'"',F=this._handle.guessLineEndings(E,O)),E=[...E.split(F).slice(b)].join(F)}this.isFirstChunk&&C(this._config.beforeFirstChunk)&&(O=this._config.beforeFirstChunk(E))!==void 0&&(E=O),this.isFirstChunk=!1,this._halted=!1;var b=this._partialLine+E,O=(this._partialLine="",this._handle.parse(b,this._baseIndex,!this._finished));if(!this._handle.paused()&&!this._handle.aborted()){if(E=O.meta.cursor,b=(this._finished||(this._partialLine=b.substring(E-this._baseIndex),this._baseIndex=E),O&&O.data&&(this._rowCount+=O.data.length),this._finished||this._config.preview&&this._rowCount>=this._config.preview),c)n.postMessage({results:O,workerId:d.WORKER_ID,finished:b});else if(C(this._config.chunk)&&!D){if(this._config.chunk(O,this._handle),this._handle.paused()||this._handle.aborted())return void(this._halted=!0);this._completeResults=O=void 0}return this._config.step||this._config.chunk||(this._completeResults.data=this._completeResults.data.concat(O.data),this._completeResults.errors=this._completeResults.errors.concat(O.errors),this._completeResults.meta=O.meta),this._completed||!b||!C(this._config.complete)||O&&O.meta.aborted||(this._config.complete(this._completeResults,this._input),this._completed=!0),b||O&&O.meta.paused||this._nextChunk(),O}this._halted=!0},this._sendError=function(E){C(this._config.error)?this._config.error(E):c&&this._config.error&&n.postMessage({workerId:d.WORKER_ID,error:E,finished:!1})}}function _(T){var E;(T=T||{}).chunkSize||(T.chunkSize=d.RemoteChunkSize),g.call(this,T),this._nextChunk=o?function(){this._readChunk(),this._chunkLoaded()}:function(){this._readChunk()},this.stream=function(D){this._input=D,this._nextChunk()},this._readChunk=function(){if(this._finished)this._chunkLoaded();else{if(E=new XMLHttpRequest,this._config.withCredentials&&(E.withCredentials=this._config.withCredentials),o||(E.onload=ne(this._chunkLoaded,this),E.onerror=ne(this._chunkError,this)),E.open(this._config.downloadRequestBody?"POST":"GET",this._input,!o),this._config.downloadRequestHeaders){var D,b=this._config.downloadRequestHeaders;for(D in b)E.setRequestHeader(D,b[D])}var O;this._config.chunkSize&&(O=this._start+this._config.chunkSize-1,E.setRequestHeader("Range","bytes="+this._start+"-"+O));try{E.send(this._config.downloadRequestBody)}catch(F){this._chunkError(F.message)}o&&E.status===0&&this._chunkError()}},this._chunkLoaded=function(){E.readyState===4&&(E.status<200||400<=E.status?this._chunkError():(this._start+=this._config.chunkSize||E.responseText.length,this._finished=!this._config.chunkSize||this._start>=(D=>(D=D.getResponseHeader("Content-Range"))!==null?parseInt(D.substring(D.lastIndexOf("/")+1)):-1)(E),this.parseChunk(E.responseText)))},this._chunkError=function(D){D=E.statusText||D,this._sendError(new Error(D))}}function x(T){(T=T||{}).chunkSize||(T.chunkSize=d.LocalChunkSize),g.call(this,T);var E,D,b=typeof FileReader<"u";this.stream=function(O){this._input=O,D=O.slice||O.webkitSlice||O.mozSlice,b?((E=new FileReader).onload=ne(this._chunkLoaded,this),E.onerror=ne(this._chunkError,this)):E=new FileReaderSync,this._nextChunk()},this._nextChunk=function(){this._finished||this._config.preview&&!(this._rowCount<this._config.preview)||this._readChunk()},this._readChunk=function(){var O=this._input,F=(this._config.chunkSize&&(F=Math.min(this._start+this._config.chunkSize,this._input.size),O=D.call(O,this._start,F)),E.readAsText(O,this._config.encoding));b||this._chunkLoaded({target:{result:F}})},this._chunkLoaded=function(O){this._start+=this._config.chunkSize,this._finished=!this._config.chunkSize||this._start>=this._input.size,this.parseChunk(O.target.result)},this._chunkError=function(){this._sendError(E.error)}}function A(T){var E;g.call(this,T=T||{}),this.stream=function(D){return E=D,this._nextChunk()},this._nextChunk=function(){var D,b;if(!this._finished)return D=this._config.chunkSize,E=D?(b=E.substring(0,D),E.substring(D)):(b=E,""),this._finished=!E,this.parseChunk(b)}}function S(T){g.call(this,T=T||{});var E=[],D=!0,b=!1;this.pause=function(){g.prototype.pause.apply(this,arguments),this._input.pause()},this.resume=function(){g.prototype.resume.apply(this,arguments),this._input.resume()},this.stream=function(O){this._input=O,this._input.on("data",this._streamData),this._input.on("end",this._streamEnd),this._input.on("error",this._streamError)},this._checkIsFinished=function(){b&&E.length===1&&(this._finished=!0)},this._nextChunk=function(){this._checkIsFinished(),E.length?this.parseChunk(E.shift()):D=!0},this._streamData=ne(function(O){try{E.push(typeof O=="string"?O:O.toString(this._config.encoding)),D&&(D=!1,this._checkIsFinished(),this.parseChunk(E.shift()))}catch(F){this._streamError(F)}},this),this._streamError=ne(function(O){this._streamCleanUp(),this._sendError(O)},this),this._streamEnd=ne(function(){this._streamCleanUp(),b=!0,this._streamData("")},this),this._streamCleanUp=ne(function(){this._input.removeListener("data",this._streamData),this._input.removeListener("end",this._streamEnd),this._input.removeListener("error",this._streamError)},this)}function R(T){var E,D,b,O,F=Math.pow(2,53),Fe=-F,Ce=/^\s*-?(\d+\.?|\.\d+|\d+\.\d+)([eE][-+]?\d+)?\s*$/,ae=/^((\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z)))$/,oe=this,Oe=0,te=0,G=!1,se=!1,M=[],z={data:[],errors:[],meta:{}};function Q(Ee){return T.skipEmptyLines==="greedy"?Ee.join("").trim()==="":Ee.length===1&&Ee[0].length===0}function Z(){if(z&&b&&(De("Delimiter","UndetectableDelimiter","Unable to auto-detect delimiting character; defaulted to '"+d.DefaultDelimiter+"'"),b=!1),T.skipEmptyLines&&(z.data=z.data.filter(function(X){return!Q(X)})),ue()){let X=function(nt,qe){C(T.transformHeader)&&(nt=T.transformHeader(nt,qe)),M.push(nt)};var Ue=X;if(z)if(Array.isArray(z.data[0])){for(var Ee=0;ue()&&Ee<z.data.length;Ee++)z.data[Ee].forEach(X);z.data.splice(0,1)}else z.data.forEach(X)}function we(X,nt){for(var qe=T.header?{}:[],We=0;We<X.length;We++){var Be=We,Pe=X[We],Pe=((Ye,ut)=>(_t=>(T.dynamicTypingFunction&&T.dynamicTyping[_t]===void 0&&(T.dynamicTyping[_t]=T.dynamicTypingFunction(_t)),(T.dynamicTyping[_t]||T.dynamicTyping)===!0))(Ye)?ut==="true"||ut==="TRUE"||ut!=="false"&&ut!=="FALSE"&&((_t=>{if(Ce.test(_t)&&(_t=parseFloat(_t),Fe<_t&&_t<F))return 1})(ut)?parseFloat(ut):ae.test(ut)?new Date(ut):ut===""?null:ut):ut)(Be=T.header?We>=M.length?"__parsed_extra":M[We]:Be,Pe=T.transform?T.transform(Pe,Be):Pe);Be==="__parsed_extra"?(qe[Be]=qe[Be]||[],qe[Be].push(Pe)):qe[Be]=Pe}return T.header&&(We>M.length?De("FieldMismatch","TooManyFields","Too many fields: expected "+M.length+" fields but parsed "+We,te+nt):We<M.length&&De("FieldMismatch","TooFewFields","Too few fields: expected "+M.length+" fields but parsed "+We,te+nt)),qe}var Te;z&&(T.header||T.dynamicTyping||T.transform)&&(Te=1,!z.data.length||Array.isArray(z.data[0])?(z.data=z.data.map(we),Te=z.data.length):z.data=we(z.data,0),T.header&&z.meta&&(z.meta.fields=M),te+=Te)}function ue(){return T.header&&M.length===0}function De(Ee,we,Te,Ue){Ee={type:Ee,code:we,message:Te},Ue!==void 0&&(Ee.row=Ue),z.errors.push(Ee)}C(T.step)&&(O=T.step,T.step=function(Ee){z=Ee,ue()?Z():(Z(),z.data.length!==0&&(Oe+=Ee.data.length,T.preview&&Oe>T.preview?D.abort():(z.data=z.data[0],O(z,oe))))}),this.parse=function(Ee,we,Te){var Ue=T.quoteChar||'"',Ue=(T.newline||(T.newline=this.guessLineEndings(Ee,Ue)),b=!1,T.delimiter?C(T.delimiter)&&(T.delimiter=T.delimiter(Ee),z.meta.delimiter=T.delimiter):((Ue=((X,nt,qe,We,Be)=>{var Pe,Ye,ut,_t;Be=Be||[",","	","|",";",d.RECORD_SEP,d.UNIT_SEP];for(var rr=0;rr<Be.length;rr++){for(var yr,fr=Be[rr],Et=0,er=0,Ze=0,Je=(ut=void 0,new B({comments:We,delimiter:fr,newline:nt,preview:10}).parse(X)),dt=0;dt<Je.data.length;dt++)qe&&Q(Je.data[dt])?Ze++:(yr=Je.data[dt].length,er+=yr,ut===void 0?ut=yr:0<yr&&(Et+=Math.abs(yr-ut),ut=yr));0<Je.data.length&&(er/=Je.data.length-Ze),(Ye===void 0||Et<=Ye)&&(_t===void 0||_t<er)&&1.99<er&&(Ye=Et,Pe=fr,_t=er)}return{successful:!!(T.delimiter=Pe),bestDelimiter:Pe}})(Ee,T.newline,T.skipEmptyLines,T.comments,T.delimitersToGuess)).successful?T.delimiter=Ue.bestDelimiter:(b=!0,T.delimiter=d.DefaultDelimiter),z.meta.delimiter=T.delimiter),re(T));return T.preview&&T.header&&Ue.preview++,E=Ee,D=new B(Ue),z=D.parse(E,we,Te),Z(),G?{meta:{paused:!0}}:z||{meta:{paused:!1}}},this.paused=function(){return G},this.pause=function(){G=!0,D.abort(),E=C(T.chunk)?"":E.substring(D.getCharIndex())},this.resume=function(){oe.streamer._halted?(G=!1,oe.streamer.parseChunk(E,!0)):setTimeout(oe.resume,3)},this.aborted=function(){return se},this.abort=function(){se=!0,D.abort(),z.meta.aborted=!0,C(T.complete)&&T.complete(z),E=""},this.guessLineEndings=function(X,Ue){X=X.substring(0,1048576);var Ue=new RegExp(w(Ue)+"([^]*?)"+w(Ue),"gm"),Te=(X=X.replace(Ue,"")).split("\r"),Ue=X.split(`
`),X=1<Ue.length&&Ue[0].length<Te[0].length;if(Te.length===1||X)return`
`;for(var nt=0,qe=0;qe<Te.length;qe++)Te[qe][0]===`
`&&nt++;return nt>=Te.length/2?`\r
`:"\r"}}function w(T){return T.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function B(T){var E=(T=T||{}).delimiter,D=T.newline,b=T.comments,O=T.step,F=T.preview,Fe=T.fastMode,Ce=null,ae=!1,oe=T.quoteChar==null?'"':T.quoteChar,Oe=oe;if(T.escapeChar!==void 0&&(Oe=T.escapeChar),(typeof E!="string"||-1<d.BAD_DELIMITERS.indexOf(E))&&(E=","),b===E)throw new Error("Comment character same as delimiter");b===!0?b="#":(typeof b!="string"||-1<d.BAD_DELIMITERS.indexOf(b))&&(b=!1),D!==`
`&&D!=="\r"&&D!==`\r
`&&(D=`
`);var te=0,G=!1;this.parse=function(se,M,z){if(typeof se!="string")throw new Error("Input must be a string");var Q=se.length,Z=E.length,ue=D.length,De=b.length,Ee=C(O),we=[],Te=[],Ue=[],X=te=0;if(!se)return Et();if(Fe||Fe!==!1&&se.indexOf(oe)===-1){for(var nt=se.split(D),qe=0;qe<nt.length;qe++){if(Ue=nt[qe],te+=Ue.length,qe!==nt.length-1)te+=D.length;else if(z)return Et();if(!b||Ue.substring(0,De)!==b){if(Ee){if(we=[],_t(Ue.split(E)),er(),G)return Et()}else _t(Ue.split(E));if(F&&F<=qe)return we=we.slice(0,F),Et(!0)}}return Et()}for(var We=se.indexOf(E,te),Be=se.indexOf(D,te),Pe=new RegExp(w(Oe)+w(oe),"g"),Ye=se.indexOf(oe,te);;)if(se[te]===oe)for(Ye=te,te++;;){if((Ye=se.indexOf(oe,Ye+1))===-1)return z||Te.push({type:"Quotes",code:"MissingQuotes",message:"Quoted field unterminated",row:we.length,index:te}),yr();if(Ye===Q-1)return yr(se.substring(te,Ye).replace(Pe,oe));if(oe===Oe&&se[Ye+1]===Oe)Ye++;else if(oe===Oe||Ye===0||se[Ye-1]!==Oe){We!==-1&&We<Ye+1&&(We=se.indexOf(E,Ye+1));var ut=rr((Be=Be!==-1&&Be<Ye+1?se.indexOf(D,Ye+1):Be)===-1?We:Math.min(We,Be));if(se.substr(Ye+1+ut,Z)===E){Ue.push(se.substring(te,Ye).replace(Pe,oe)),se[te=Ye+1+ut+Z]!==oe&&(Ye=se.indexOf(oe,te)),We=se.indexOf(E,te),Be=se.indexOf(D,te);break}if(ut=rr(Be),se.substring(Ye+1+ut,Ye+1+ut+ue)===D){if(Ue.push(se.substring(te,Ye).replace(Pe,oe)),fr(Ye+1+ut+ue),We=se.indexOf(E,te),Ye=se.indexOf(oe,te),Ee&&(er(),G))return Et();if(F&&we.length>=F)return Et(!0);break}Te.push({type:"Quotes",code:"InvalidQuotes",message:"Trailing quote on quoted field is malformed",row:we.length,index:te}),Ye++}}else if(b&&Ue.length===0&&se.substring(te,te+De)===b){if(Be===-1)return Et();te=Be+ue,Be=se.indexOf(D,te),We=se.indexOf(E,te)}else if(We!==-1&&(We<Be||Be===-1))Ue.push(se.substring(te,We)),te=We+Z,We=se.indexOf(E,te);else{if(Be===-1)break;if(Ue.push(se.substring(te,Be)),fr(Be+ue),Ee&&(er(),G))return Et();if(F&&we.length>=F)return Et(!0)}return yr();function _t(Ze){we.push(Ze),X=te}function rr(Ze){var Je=0;return Je=Ze!==-1&&(Ze=se.substring(Ye+1,Ze))&&Ze.trim()===""?Ze.length:Je}function yr(Ze){return z||(Ze===void 0&&(Ze=se.substring(te)),Ue.push(Ze),te=Q,_t(Ue),Ee&&er()),Et()}function fr(Ze){te=Ze,_t(Ue),Ue=[],Be=se.indexOf(D,te)}function Et(Ze){if(T.header&&!M&&we.length&&!ae){var Je=we[0],dt=Object.create(null),Lt=new Set(Je);let ot=!1;for(let Ft=0;Ft<Je.length;Ft++){let Vt=Je[Ft];if(dt[Vt=C(T.transformHeader)?T.transformHeader(Vt,Ft):Vt]){let Ot,Lr=dt[Vt];for(;Ot=Vt+"_"+Lr,Lr++,Lt.has(Ot););Lt.add(Ot),Je[Ft]=Ot,dt[Vt]++,ot=!0,(Ce=Ce===null?{}:Ce)[Ot]=Vt}else dt[Vt]=1,Je[Ft]=Vt;Lt.add(Vt)}ot&&console.warn("Duplicate headers found and renamed."),ae=!0}return{data:we,errors:Te,meta:{delimiter:E,linebreak:D,aborted:G,truncated:!!Ze,cursor:X+(M||0),renamedHeaders:Ce}}}function er(){O(Et()),we=[],Te=[]}},this.abort=function(){G=!0},this.getCharIndex=function(){return te}}function H(T){var E=T.data,D=u[E.workerId],b=!1;if(E.error)D.userError(E.error,E.file);else if(E.results&&E.results.data){var O={abort:function(){b=!0,N(E.workerId,{data:[],errors:[],meta:{aborted:!0}})},pause:J,resume:J};if(C(D.userStep)){for(var F=0;F<E.results.data.length&&(D.userStep({data:E.results.data[F],errors:E.results.errors,meta:E.results.meta},O),!b);F++);delete E.results}else C(D.userChunk)&&(D.userChunk(E.results,O,E.file),delete E.results)}E.finished&&!b&&N(E.workerId,E.results)}function N(T,E){var D=u[T];C(D.userComplete)&&D.userComplete(E),D.terminate(),delete u[T]}function J(){throw new Error("Not implemented.")}function re(T){if(typeof T!="object"||T===null)return T;var E,D=Array.isArray(T)?[]:{};for(E in T)D[E]=re(T[E]);return D}function ne(T,E){return function(){T.apply(E,arguments)}}function C(T){return typeof T=="function"}return d.parse=function(T,E){var D=(E=E||{}).dynamicTyping||!1;if(C(D)&&(E.dynamicTypingFunction=D,D={}),E.dynamicTyping=D,E.transform=!!C(E.transform)&&E.transform,!E.worker||!d.WORKERS_SUPPORTED)return D=null,d.NODE_STREAM_INPUT,typeof T=="string"?(T=(b=>b.charCodeAt(0)!==65279?b:b.slice(1))(T),D=new(E.download?_:A)(E)):T.readable===!0&&C(T.read)&&C(T.on)?D=new S(E):(n.File&&T instanceof File||T instanceof Object)&&(D=new x(E)),D.stream(T);(D=(()=>{var b;return!!d.WORKERS_SUPPORTED&&(b=(()=>{var O=n.URL||n.webkitURL||null,F=r.toString();return d.BLOB_URL||(d.BLOB_URL=O.createObjectURL(new Blob(["var global = (function() { if (typeof self !== 'undefined') { return self; } if (typeof window !== 'undefined') { return window; } if (typeof global !== 'undefined') { return global; } return {}; })(); global.IS_PAPA_WORKER=true; ","(",F,")();"],{type:"text/javascript"})))})(),(b=new n.Worker(b)).onmessage=H,b.id=h++,u[b.id]=b)})()).userStep=E.step,D.userChunk=E.chunk,D.userComplete=E.complete,D.userError=E.error,E.step=C(E.step),E.chunk=C(E.chunk),E.complete=C(E.complete),E.error=C(E.error),delete E.worker,D.postMessage({input:T,config:E,workerId:D.id})},d.unparse=function(T,E){var D=!1,b=!0,O=",",F=`\r
`,Fe='"',Ce=Fe+Fe,ae=!1,oe=null,Oe=!1,te=((()=>{if(typeof E=="object"){if(typeof E.delimiter!="string"||d.BAD_DELIMITERS.filter(function(M){return E.delimiter.indexOf(M)!==-1}).length||(O=E.delimiter),typeof E.quotes!="boolean"&&typeof E.quotes!="function"&&!Array.isArray(E.quotes)||(D=E.quotes),typeof E.skipEmptyLines!="boolean"&&typeof E.skipEmptyLines!="string"||(ae=E.skipEmptyLines),typeof E.newline=="string"&&(F=E.newline),typeof E.quoteChar=="string"&&(Fe=E.quoteChar),typeof E.header=="boolean"&&(b=E.header),Array.isArray(E.columns)){if(E.columns.length===0)throw new Error("Option columns is empty");oe=E.columns}E.escapeChar!==void 0&&(Ce=E.escapeChar+Fe),E.escapeFormulae instanceof RegExp?Oe=E.escapeFormulae:typeof E.escapeFormulae=="boolean"&&E.escapeFormulae&&(Oe=/^[=+\-@\t\r].*$/)}})(),new RegExp(w(Fe),"g"));if(typeof T=="string"&&(T=JSON.parse(T)),Array.isArray(T)){if(!T.length||Array.isArray(T[0]))return G(null,T,ae);if(typeof T[0]=="object")return G(oe||Object.keys(T[0]),T,ae)}else if(typeof T=="object")return typeof T.data=="string"&&(T.data=JSON.parse(T.data)),Array.isArray(T.data)&&(T.fields||(T.fields=T.meta&&T.meta.fields||oe),T.fields||(T.fields=Array.isArray(T.data[0])?T.fields:typeof T.data[0]=="object"?Object.keys(T.data[0]):[]),Array.isArray(T.data[0])||typeof T.data[0]=="object"||(T.data=[T.data])),G(T.fields||[],T.data||[],ae);throw new Error("Unable to serialize unrecognized input");function G(M,z,Q){var Z="",ue=(typeof M=="string"&&(M=JSON.parse(M)),typeof z=="string"&&(z=JSON.parse(z)),Array.isArray(M)&&0<M.length),De=!Array.isArray(z[0]);if(ue&&b){for(var Ee=0;Ee<M.length;Ee++)0<Ee&&(Z+=O),Z+=se(M[Ee],Ee);0<z.length&&(Z+=F)}for(var we=0;we<z.length;we++){var Te=(ue?M:z[we]).length,Ue=!1,X=ue?Object.keys(z[we]).length===0:z[we].length===0;if(Q&&!ue&&(Ue=Q==="greedy"?z[we].join("").trim()==="":z[we].length===1&&z[we][0].length===0),Q==="greedy"&&ue){for(var nt=[],qe=0;qe<Te;qe++){var We=De?M[qe]:qe;nt.push(z[we][We])}Ue=nt.join("").trim()===""}if(!Ue){for(var Be=0;Be<Te;Be++){0<Be&&!X&&(Z+=O);var Pe=ue&&De?M[Be]:Be;Z+=se(z[we][Pe],Be)}we<z.length-1&&(!Q||0<Te&&!X)&&(Z+=F)}}return Z}function se(M,z){var Q,Z;return M==null?"":M.constructor===Date?JSON.stringify(M).slice(1,25):(Z=!1,Oe&&typeof M=="string"&&Oe.test(M)&&(M="'"+M,Z=!0),Q=M.toString().replace(te,Ce),(Z=Z||D===!0||typeof D=="function"&&D(M,z)||Array.isArray(D)&&D[z]||((ue,De)=>{for(var Ee=0;Ee<De.length;Ee++)if(-1<ue.indexOf(De[Ee]))return!0;return!1})(Q,d.BAD_DELIMITERS)||-1<Q.indexOf(O)||Q.charAt(0)===" "||Q.charAt(Q.length-1)===" ")?Fe+Q+Fe:Q)}},d.RECORD_SEP="",d.UNIT_SEP="",d.BYTE_ORDER_MARK="\uFEFF",d.BAD_DELIMITERS=["\r",`
`,'"',d.BYTE_ORDER_MARK],d.WORKERS_SUPPORTED=!o&&!!n.Worker,d.NODE_STREAM_INPUT=1,d.LocalChunkSize=10485760,d.RemoteChunkSize=5242880,d.DefaultDelimiter=",",d.Parser=B,d.ParserHandle=R,d.NetworkStreamer=_,d.FileStreamer=x,d.StringStreamer=A,d.ReadableStreamStreamer=S,n.jQuery&&((i=n.jQuery).fn.parse=function(T){var E=T.config||{},D=[];return this.each(function(F){if(!(i(this).prop("tagName").toUpperCase()==="INPUT"&&i(this).attr("type").toLowerCase()==="file"&&n.FileReader)||!this.files||this.files.length===0)return!0;for(var Fe=0;Fe<this.files.length;Fe++)D.push({file:this.files[Fe],inputElem:this,instanceConfig:i.extend({},E)})}),b(),this;function b(){if(D.length===0)C(T.complete)&&T.complete();else{var F,Fe,Ce,ae,oe=D[0];if(C(T.before)){var Oe=T.before(oe.file,oe.inputElem);if(typeof Oe=="object"){if(Oe.action==="abort")return F="AbortError",Fe=oe.file,Ce=oe.inputElem,ae=Oe.reason,void(C(T.error)&&T.error({name:F},Fe,Ce,ae));if(Oe.action==="skip")return void O();typeof Oe.config=="object"&&(oe.instanceConfig=i.extend(oe.instanceConfig,Oe.config))}else if(Oe==="skip")return void O()}var te=oe.instanceConfig.complete;oe.instanceConfig.complete=function(G){C(te)&&te(G,oe.file,oe.inputElem),O()},d.parse(oe.file,oe.instanceConfig)}}function O(){D.splice(0,1),b()}}),c&&(n.onmessage=function(T){T=T.data,d.WORKER_ID===void 0&&T&&(d.WORKER_ID=T.workerId),typeof T.input=="string"?n.postMessage({workerId:d.WORKER_ID,results:d.parse(T.input,T.config),finished:!0}):(n.File&&T.input instanceof File||T.input instanceof Object)&&(T=d.parse(T.input,T.config))&&n.postMessage({workerId:d.WORKER_ID,results:T,finished:!0})}),(_.prototype=Object.create(g.prototype)).constructor=_,(x.prototype=Object.create(g.prototype)).constructor=x,(A.prototype=Object.create(A.prototype)).constructor=A,(S.prototype=Object.create(g.prototype)).constructor=S,d})}(S0)),S0.exports}var bV=kV();const IV=Gg(bV),DV=()=>{const[t,e]=Ie.useState([]),[r,n]=Ie.useState([]),[i,o]=Ie.useState(!0),[c,u]=Ie.useState(!1),[h,d]=Ie.useState(!1),[g,_]=Ie.useState(""),[x,A]=Ie.useState(null),[S,R]=Ie.useState({nom:"",annee:new Date().getFullYear().toString(),professeurPrincipal:""}),[w,B]=Ie.useState({nom:"",prenom:"",dateNaissance:""});Ie.useEffect(()=>{H(),N()},[]);const H=async()=>{try{const O=(await Fi(Fn(gr,"classes"))).docs.map(Fe=>({id:Fe.id,...Fe.data(),createdAt:Fe.data().createdAt?.toDate()||new Date})),F=await Promise.all(O.map(async Fe=>{const Ce=aS(Fn(gr,"eleves"),iS("classeId","==",Fe.id)),ae=await Fi(Ce);return{id:Fe.id,nom:Fe.nom,effectif:ae.size}}));e(F)}catch(b){console.error("Erreur lors du chargement des classes:",b)}finally{o(!1)}},N=async()=>{try{const O=(await Fi(Fn(gr,"eleves"))).docs.map(F=>({id:F.id,...F.data()}));n(O)}catch(b){console.error("Erreur lors du chargement des élèves:",b)}},J=async b=>{b.preventDefault();try{x?(await cS(Ms(gr,"classes",x.id),{...S,updatedAt:new Date}),A(null)):await ju(Fn(gr,"classes"),{...S,createdAt:new Date}),R({nom:"",annee:new Date().getFullYear().toString(),professeurPrincipal:""}),u(!1),H()}catch(O){console.error("Erreur lors de la sauvegarde:",O)}},re=async b=>{if(b.preventDefault(),!g){alert("Veuillez sélectionner une classe");return}try{await ju(Fn(gr,"eleves"),{...w,classeId:g,createdAt:new Date}),B({nom:"",prenom:"",dateNaissance:""}),d(!1),N(),H()}catch(O){console.error("Erreur lors de la sauvegarde de l'élève:",O)}},ne=async b=>{const O=b.target.files?.[0];if(!O||!g){alert("Veuillez sélectionner une classe et un fichier");return}try{let F=[];if(O.name.endsWith(".csv")){const ae=await O.text(),oe=ae.includes(";");F=IV.parse(ae,{header:!0,delimiter:oe?";":","}).data.filter(te=>Object.values(te).some(G=>G&&String(G).trim()!==""))}else if(O.name.endsWith(".xlsx")){const ae=await O.arrayBuffer(),oe=Hg(ae,{type:"array"}),Oe=oe.Sheets[oe.SheetNames[0]];F=CV.sheet_to_json(Oe)}else{alert("Format de fichier non supporté. Utilisez .csv ou .xlsx");return}const Fe=["nom","prenom","dateNaissance"],Ce=F[0]||{};for(const ae of Fe)if(!Object.keys(Ce).includes(ae)){alert(`Colonne manquante : ${ae}`);return}for(const ae of F)await ju(Fn(gr,"eleves"),{nom:ae.nom.trim(),prenom:ae.prenom.trim(),dateNaissance:ae.dateNaissance,classeId:g,createdAt:new Date});N(),H(),alert("Import terminé !")}catch(F){console.error("Erreur lors de l'import:",F),alert("Erreur lors de l'import")}},C=b=>{A(b),R({nom:b.nom,annee:b.annee,professeurPrincipal:b.professeurPrincipal}),u(!0)},T=async b=>{if(window.confirm("Êtes-vous sûr de vouloir supprimer cette classe ?"))try{await Ng(Ms(gr,"classes",b)),H()}catch(O){console.error("Erreur lors de la suppression:",O)}},E=async b=>{if(window.confirm("Êtes-vous sûr de vouloir supprimer cet élève ?"))try{await Ng(Ms(gr,"eleves",b)),N(),H()}catch(O){console.error("Erreur lors de la suppression:",O)}},D=b=>r.filter(O=>O.classeId===b);return i?K.jsx("div",{className:"loading",children:"Chargement des classes..."}):K.jsxs("div",{className:"gestion-classes",children:[K.jsxs("div",{className:"header",children:[K.jsx("h1",{children:"Gestion des Classes"}),K.jsx("button",{className:"btn-primary",onClick:()=>{u(!0),A(null),R({nom:"",annee:new Date().getFullYear().toString(),professeurPrincipal:""})},children:"Ajouter une classe"})]}),c&&K.jsx("div",{className:"form-overlay",children:K.jsxs("div",{className:"form-container",children:[K.jsx("h2",{children:x?"Modifier la classe":"Nouvelle classe"}),K.jsxs("form",{onSubmit:J,children:[K.jsxs("div",{className:"form-group",children:[K.jsx("label",{children:"Nom de la classe:"}),K.jsx("input",{type:"text",value:S.nom,onChange:b=>R({...S,nom:b.target.value}),required:!0})]}),K.jsxs("div",{className:"form-group",children:[K.jsx("label",{children:"Année scolaire:"}),K.jsx("input",{type:"text",value:S.annee,onChange:b=>R({...S,annee:b.target.value}),required:!0})]}),K.jsxs("div",{className:"form-group",children:[K.jsx("label",{children:"Professeur principal:"}),K.jsx("input",{type:"text",value:S.professeurPrincipal,onChange:b=>R({...S,professeurPrincipal:b.target.value}),required:!0})]}),K.jsxs("div",{className:"form-actions",children:[K.jsx("button",{type:"submit",className:"btn-primary",children:x?"Modifier":"Ajouter"}),K.jsx("button",{type:"button",className:"btn-secondary",onClick:()=>{u(!1),A(null)},children:"Annuler"})]})]})]})}),h&&K.jsx("div",{className:"form-overlay",children:K.jsxs("div",{className:"form-container",children:[K.jsx("h2",{children:"Ajouter un élève"}),K.jsxs("form",{onSubmit:re,children:[K.jsxs("div",{className:"form-group",children:[K.jsx("label",{children:"Classe:"}),K.jsxs("select",{value:g,onChange:b=>_(b.target.value),required:!0,children:[K.jsx("option",{value:"",children:"Sélectionner une classe"}),t.map(b=>K.jsx("option",{value:b.id,children:b.nom},b.id))]})]}),K.jsxs("div",{className:"form-group",children:[K.jsx("label",{children:"Nom:"}),K.jsx("input",{type:"text",value:w.nom,onChange:b=>B({...w,nom:b.target.value}),required:!0})]}),K.jsxs("div",{className:"form-group",children:[K.jsx("label",{children:"Prénom:"}),K.jsx("input",{type:"text",value:w.prenom,onChange:b=>B({...w,prenom:b.target.value}),required:!0})]}),K.jsxs("div",{className:"form-group",children:[K.jsx("label",{children:"Date de naissance:"}),K.jsx("input",{type:"date",value:w.dateNaissance,onChange:b=>B({...w,dateNaissance:b.target.value}),required:!0})]}),K.jsxs("div",{className:"form-actions",children:[K.jsx("button",{type:"submit",className:"btn-primary",children:"Ajouter"}),K.jsx("button",{type:"button",className:"btn-secondary",onClick:()=>{d(!1),_(""),B({nom:"",prenom:"",dateNaissance:""})},children:"Annuler"})]})]})]})}),K.jsx("div",{className:"classes-grid",children:t.map(b=>{const O=D(b.id);return K.jsxs("div",{className:"class-tile",children:[K.jsxs("div",{className:"class-content",children:[K.jsx("h3",{children:b.nom}),K.jsxs("div",{className:"effectif",children:[K.jsx("span",{className:"effectif-number",children:b.effectif}),K.jsx("span",{className:"effectif-label",children:"élèves"})]})]}),O.length>0&&K.jsxs("div",{className:"eleves-list",children:[K.jsx("h4",{children:"Élèves :"}),K.jsx("div",{className:"eleves-container",children:O.map(F=>K.jsxs("div",{className:"eleve-item",children:[K.jsxs("span",{children:[F.prenom," ",F.nom]}),K.jsx("button",{className:"btn-delete-small",onClick:()=>E(F.id),title:"Supprimer",children:"×"})]},F.id))})]}),K.jsxs("div",{className:"class-actions",children:[K.jsx("button",{className:"btn-add-eleve",onClick:()=>{_(b.id),d(!0)},title:"Ajouter un élève",children:"👤+"}),K.jsx("button",{className:"btn-import",onClick:()=>{_(b.id),document.getElementById("import-file")?.click()},title:"Importer des élèves",children:"📁"}),K.jsx("button",{className:"btn-edit",onClick:()=>C(b),title:"Modifier",children:"✏️"}),K.jsx("button",{className:"btn-delete",onClick:()=>T(b.id),title:"Supprimer",children:"🗑️"})]})]},b.id)})}),K.jsx("input",{id:"import-file",type:"file",accept:".csv,.xlsx",style:{display:"none"},onChange:ne}),t.length===0&&K.jsxs("div",{className:"empty-state",children:[K.jsx("p",{children:"Aucune classe enregistrée"}),K.jsx("button",{className:"btn-primary",onClick:()=>u(!0),children:"Créer la première classe"})]})]})},Nd="periodesStage",q4=async()=>(await Fi(Fn(gr,Nd))).docs.map(e=>({id:e.id,...e.data()})),OV=async t=>(await ju(Fn(gr,Nd),t)).id,NV=async(t,e)=>{await cS(Ms(gr,Nd,t),e)},FV=async t=>{await Ng(Ms(gr,Nd,t))},T2=t=>t?new Date(t).toLocaleDateString("fr-FR"):"",PV=()=>{const[t,e]=Ie.useState([]),[r,n]=Ie.useState({nom:"",dateDebut:"",dateFin:""}),[i,o]=Ie.useState(null),[c,u]=Ie.useState(!1),[h,d]=Ie.useState(!1),g=async()=>{u(!0),e(await q4()),u(!1)};Ie.useEffect(()=>{g()},[]);const _=w=>{n({...r,[w.target.name]:w.target.value})},x=async w=>{w.preventDefault(),i?(await NV(i,r),o(null)):await OV(r),n({nom:"",dateDebut:"",dateFin:""}),d(!1),g()},A=w=>{o(w.id),n({nom:w.nom,dateDebut:w.dateDebut,dateFin:w.dateFin}),d(!0)},S=async w=>{window.confirm("Supprimer cette période ?")&&(await FV(w),g())},R=(w,B)=>{if(!w||!B)return 0;const H=new Date(w),N=new Date(B),J=Math.abs(N.getTime()-H.getTime());return Math.ceil(J/(1e3*60*60*24))};return c?K.jsx("div",{className:"loading",children:"Chargement des périodes..."}):K.jsxs("div",{className:"gestion-periodes-stage",children:[K.jsxs("div",{className:"header",children:[K.jsx("h1",{children:"Gestion des Périodes de Stage"}),K.jsx("button",{className:"btn-primary",onClick:()=>{d(!0),o(null),n({nom:"",dateDebut:"",dateFin:""})},children:"Ajouter une période"})]}),h&&K.jsx("div",{className:"form-overlay",children:K.jsxs("div",{className:"form-container",children:[K.jsx("h2",{children:i?"Modifier la période":"Nouvelle période"}),K.jsxs("form",{onSubmit:x,children:[K.jsxs("div",{className:"form-group",children:[K.jsx("label",{children:"Nom de la période:"}),K.jsx("input",{name:"nom",type:"text",placeholder:"Ex: PFMP1, PFMP2...",value:r.nom,onChange:_,required:!0})]}),K.jsxs("div",{className:"form-group",children:[K.jsx("label",{children:"Date de début:"}),K.jsx("input",{name:"dateDebut",type:"date",value:r.dateDebut,onChange:_,required:!0})]}),K.jsxs("div",{className:"form-group",children:[K.jsx("label",{children:"Date de fin:"}),K.jsx("input",{name:"dateFin",type:"date",value:r.dateFin,onChange:_,required:!0})]}),K.jsxs("div",{className:"form-actions",children:[K.jsx("button",{type:"submit",className:"btn-primary",children:i?"Modifier":"Ajouter"}),K.jsx("button",{type:"button",className:"btn-secondary",onClick:()=>{d(!1),o(null),n({nom:"",dateDebut:"",dateFin:""})},children:"Annuler"})]})]})]})}),K.jsx("div",{className:"periodes-grid",children:t.map(w=>{const B=R(w.dateDebut,w.dateFin);return K.jsxs("div",{className:"periode-tile",children:[K.jsxs("div",{className:"periode-content",children:[K.jsx("h3",{children:w.nom}),K.jsxs("div",{className:"periode-dates",children:[K.jsxs("div",{className:"date-item",children:[K.jsx("span",{className:"date-label",children:"Début"}),K.jsx("span",{className:"date-value",children:T2(w.dateDebut)})]}),K.jsxs("div",{className:"date-item",children:[K.jsx("span",{className:"date-label",children:"Fin"}),K.jsx("span",{className:"date-value",children:T2(w.dateFin)})]})]}),K.jsxs("div",{className:"periode-duree",children:[K.jsx("span",{className:"duree-number",children:B}),K.jsx("span",{className:"duree-label",children:"jours"})]})]}),K.jsxs("div",{className:"periode-actions",children:[K.jsx("button",{className:"btn-edit",onClick:()=>A(w),title:"Modifier",children:"✏️"}),K.jsx("button",{className:"btn-delete",onClick:()=>S(w.id),title:"Supprimer",children:"🗑️"})]})]},w.id)})}),t.length===0&&K.jsxs("div",{className:"empty-state",children:[K.jsx("p",{children:"Aucune période de stage enregistrée"}),K.jsx("button",{className:"btn-primary",onClick:()=>d(!0),children:"Créer la première période"})]})]})},MV=()=>{const[t,e]=Ie.useState([]),[r,n]=Ie.useState([]),[i,o]=Ie.useState([]),[c,u]=Ie.useState(""),[h,d]=Ie.useState(""),[g,_]=Ie.useState(!0),[x,A]=Ie.useState({eleveId:"",stageId:"",dateEvaluation:new Date,competences:{technique:0,communication:0,autonomie:0,travailEquipe:0,ponctualite:0},commentaires:"",noteGlobale:0,recommandations:""});Ie.useEffect(()=>{S(),q4().then(N=>o(N))},[]),Ie.useEffect(()=>{c&&R(c)},[c]);const S=async()=>{try{const J=(await Fi(Fn(gr,"eleves"))).docs.map(re=>({id:re.id,...re.data()}));e(J)}catch(N){console.error("Erreur lors du chargement des élèves:",N)}finally{_(!1)}},R=async N=>{try{const J=aS(Fn(gr,"stages"),iS("eleveId","==",N)),ne=(await Fi(J)).docs.map(C=>({id:C.id,...C.data(),dateDebut:C.data().dateDebut?.toDate()||new Date,dateFin:C.data().dateFin?.toDate()||new Date}));n(ne)}catch(J){console.error("Erreur lors du chargement des stages:",J)}},w=(N,J)=>{A(re=>({...re,competences:{...re.competences,[N]:J}}))},B=()=>{const{competences:N}=x,J=Object.values(N).reduce((re,ne)=>re+ne,0);return Math.round(J/Object.keys(N).length)},H=async N=>{N.preventDefault();try{const J=B(),re={...x,noteGlobale:J,dateEvaluation:new Date};await ju(Fn(gr,"evaluations"),re),alert("Évaluation enregistrée avec succès !"),A({eleveId:"",stageId:"",dateEvaluation:new Date,competences:{technique:0,communication:0,autonomie:0,travailEquipe:0,ponctualite:0},commentaires:"",noteGlobale:0,recommandations:""}),u(""),d("")}catch(J){console.error("Erreur lors de la sauvegarde:",J),alert("Erreur lors de la sauvegarde de l'évaluation")}};return g?K.jsx("div",{className:"loading",children:"Chargement..."}):K.jsxs("div",{className:"evaluation-eleve",children:[K.jsx("div",{className:"header",children:K.jsx("h1",{children:"Évaluer un Élève"})}),K.jsxs("form",{onSubmit:H,className:"evaluation-form",children:[K.jsxs("div",{className:"form-section",children:[K.jsx("h2",{children:"Sélection de l'élève, du stage et de la période"}),K.jsxs("div",{className:"form-group",children:[K.jsx("label",{children:"Élève:"}),K.jsxs("select",{value:c,onChange:N=>{u(N.target.value),d("")},required:!0,children:[K.jsx("option",{value:"",children:"Sélectionner un élève"}),t.map(N=>K.jsxs("option",{value:N.id,children:[N.prenom," ",N.nom," - ",N.classe]},N.id))]})]}),c&&K.jsxs("div",{className:"form-group",children:[K.jsx("label",{children:"Stage:"}),K.jsxs("select",{value:h,onChange:N=>{d(N.target.value),A(J=>({...J,eleveId:c,stageId:N.target.value}))},required:!0,children:[K.jsx("option",{value:"",children:"Sélectionner un stage"}),r.map(N=>K.jsxs("option",{value:N.id,children:[N.entreprise," - ",N.dateDebut.toLocaleDateString()," à ",N.dateFin.toLocaleDateString()]},N.id))]})]}),K.jsxs("div",{className:"form-group",children:[K.jsx("label",{children:"Période de stage :"}),K.jsxs("select",{value:x.periodeId||"",onChange:N=>A(J=>({...J,periodeId:N.target.value})),required:!0,children:[K.jsx("option",{value:"",children:"Sélectionner une période"}),i.map(N=>K.jsx("option",{value:N.id,children:N.nom},N.id))]})]})]}),h&&K.jsxs(K.Fragment,{children:[K.jsxs("div",{className:"form-section",children:[K.jsx("h2",{children:"Évaluation des compétences"}),K.jsxs("div",{className:"competences-grid",children:[K.jsxs("div",{className:"competence-item",children:[K.jsx("label",{children:"Compétences techniques:"}),K.jsx("input",{type:"range",min:"0",max:"20",value:x.competences.technique,onChange:N=>w("technique",parseInt(N.target.value))}),K.jsxs("span",{className:"note",children:[x.competences.technique,"/20"]})]}),K.jsxs("div",{className:"competence-item",children:[K.jsx("label",{children:"Communication:"}),K.jsx("input",{type:"range",min:"0",max:"20",value:x.competences.communication,onChange:N=>w("communication",parseInt(N.target.value))}),K.jsxs("span",{className:"note",children:[x.competences.communication,"/20"]})]}),K.jsxs("div",{className:"competence-item",children:[K.jsx("label",{children:"Autonomie:"}),K.jsx("input",{type:"range",min:"0",max:"20",value:x.competences.autonomie,onChange:N=>w("autonomie",parseInt(N.target.value))}),K.jsxs("span",{className:"note",children:[x.competences.autonomie,"/20"]})]}),K.jsxs("div",{className:"competence-item",children:[K.jsx("label",{children:"Travail d'équipe:"}),K.jsx("input",{type:"range",min:"0",max:"20",value:x.competences.travailEquipe,onChange:N=>w("travailEquipe",parseInt(N.target.value))}),K.jsxs("span",{className:"note",children:[x.competences.travailEquipe,"/20"]})]}),K.jsxs("div",{className:"competence-item",children:[K.jsx("label",{children:"Ponctualité:"}),K.jsx("input",{type:"range",min:"0",max:"20",value:x.competences.ponctualite,onChange:N=>w("ponctualite",parseInt(N.target.value))}),K.jsxs("span",{className:"note",children:[x.competences.ponctualite,"/20"]})]})]}),K.jsx("div",{className:"note-globale",children:K.jsxs("h3",{children:["Note globale: ",B(),"/20"]})})]}),K.jsxs("div",{className:"form-section",children:[K.jsx("h2",{children:"Commentaires et recommandations"}),K.jsxs("div",{className:"form-group",children:[K.jsx("label",{children:"Commentaires généraux:"}),K.jsx("textarea",{value:x.commentaires,onChange:N=>A({...x,commentaires:N.target.value}),rows:4,placeholder:"Commentaires sur le stage..."})]}),K.jsxs("div",{className:"form-group",children:[K.jsx("label",{children:"Recommandations:"}),K.jsx("textarea",{value:x.recommandations,onChange:N=>A({...x,recommandations:N.target.value}),rows:4,placeholder:"Recommandations pour l'élève..."})]})]}),K.jsx("div",{className:"form-actions",children:K.jsx("button",{type:"submit",className:"btn-primary",children:"Enregistrer l'évaluation"})})]})]})]})},LV=()=>{const[t,e]=Ie.useState([]),[r,n]=Ie.useState([]),[i,o]=Ie.useState([]),[c,u]=Ie.useState(!0),[h,d]=Ie.useState(""),[g,_]=Ie.useState(""),[x,A]=Ie.useState("global");Ie.useEffect(()=>{S()},[]);const S=async()=>{try{const T=(await Fi(Fn(gr,"eleves"))).docs.map(F=>({id:F.id,...F.data()}));e(T);const D=(await Fi(Fn(gr,"stages"))).docs.map(F=>({id:F.id,...F.data(),dateDebut:F.data().dateDebut?.toDate()||new Date,dateFin:F.data().dateFin?.toDate()||new Date}));n(D);const O=(await Fi(Fn(gr,"evaluations"))).docs.map(F=>({id:F.id,...F.data(),dateEvaluation:F.data().dateEvaluation?.toDate()||new Date}));o(O)}catch(C){console.error("Erreur lors du chargement des données:",C)}finally{u(!1)}},R=()=>[...new Set(t.map(T=>T.classe))].sort(),w=C=>t.filter(T=>T.classe===C),B=C=>i.filter(T=>T.eleveId===C),H=C=>r.find(T=>T.eleveId===C),N=()=>{if(!h)return"";const C=w(h);let T=`RAPPORT DE CLASSE - ${h}
`;return T+=`Généré le ${new Date().toLocaleDateString()}

`,C.forEach(E=>{const D=H(E.id),b=B(E.id);if(T+=`ÉLÈVE: ${E.prenom} ${E.nom}
`,D&&(T+=`Stage: ${D.entreprise} (${D.dateDebut.toLocaleDateString()} - ${D.dateFin.toLocaleDateString()})
`),b.length>0){const O=b.reduce((F,Fe)=>F+Fe.noteGlobale,0)/b.length;T+=`Note moyenne: ${O.toFixed(1)}/20
`}T+=`
`}),T},J=()=>{if(!g)return"";const C=t.find(b=>b.id===g);if(!C)return"";const T=H(g),E=B(g);let D=`RAPPORT INDIVIDUEL - ${C.prenom} ${C.nom}
`;return D+=`Classe: ${C.classe}
`,D+=`Généré le ${new Date().toLocaleDateString()}

`,T&&(D+=`STAGE:
`,D+=`Entreprise: ${T.entreprise}
`,D+=`Période: ${T.dateDebut.toLocaleDateString()} - ${T.dateFin.toLocaleDateString()}
`,D+=`Statut: ${T.statut}

`),E.length>0&&(D+=`ÉVALUATIONS:
`,E.forEach((b,O)=>{D+=`Évaluation ${O+1} (${b.dateEvaluation.toLocaleDateString()}):
`,D+=`- Compétences techniques: ${b.competences.technique}/20
`,D+=`- Communication: ${b.competences.communication}/20
`,D+=`- Autonomie: ${b.competences.autonomie}/20
`,D+=`- Travail d'équipe: ${b.competences.travailEquipe}/20
`,D+=`- Ponctualité: ${b.competences.ponctualite}/20
`,D+=`- Note globale: ${b.noteGlobale}/20
`,b.commentaires&&(D+=`- Commentaires: ${b.commentaires}
`),b.recommandations&&(D+=`- Recommandations: ${b.recommandations}
`),D+=`
`})),D},re=()=>{let C=`RAPPORT GLOBAL - ÉVALUATIONS DE STAGES
`;if(C+=`Généré le ${new Date().toLocaleDateString()}

`,C+=`STATISTIQUES GÉNÉRALES:
`,C+=`- Nombre total d'élèves: ${t.length}
`,C+=`- Nombre total de stages: ${r.length}
`,C+=`- Nombre total d'évaluations: ${i.length}

`,i.length>0){const T=i.reduce((E,D)=>E+D.noteGlobale,0)/i.length;C+=`- Note moyenne globale: ${T.toFixed(1)}/20

`}return C+=`RÉPARTITION PAR CLASSE:
`,R().forEach(T=>{const E=w(T),D=E.flatMap(O=>B(O.id)),b=D.length>0?D.reduce((O,F)=>O+F.noteGlobale,0)/D.length:0;C+=`- ${T}: ${E.length} élèves, ${D.length} évaluations, moyenne: ${b.toFixed(1)}/20
`}),C},ne=()=>{let C="";switch(x){case"classe":C=N();break;case"eleve":C=J();break;case"global":C=re();break}if(C){const T=new Blob([C],{type:"text/plain"}),E=URL.createObjectURL(T),D=document.createElement("a");D.href=E,D.download=`rapport_${x}_${new Date().toISOString().split("T")[0]}.txt`,document.body.appendChild(D),D.click(),document.body.removeChild(D),URL.revokeObjectURL(E)}};return c?K.jsx("div",{className:"loading",children:"Chargement des données..."}):K.jsxs("div",{className:"export-rapports",children:[K.jsx("div",{className:"header",children:K.jsx("h1",{children:"Exporter les Rapports"})}),K.jsxs("div",{className:"rapport-config",children:[K.jsxs("div",{className:"form-group",children:[K.jsx("label",{children:"Type de rapport:"}),K.jsxs("select",{value:x,onChange:C=>A(C.target.value),children:[K.jsx("option",{value:"global",children:"Rapport global"}),K.jsx("option",{value:"classe",children:"Rapport par classe"}),K.jsx("option",{value:"eleve",children:"Rapport individuel"})]})]}),x==="classe"&&K.jsxs("div",{className:"form-group",children:[K.jsx("label",{children:"Sélectionner une classe:"}),K.jsxs("select",{value:h,onChange:C=>d(C.target.value),children:[K.jsx("option",{value:"",children:"Choisir une classe"}),R().map(C=>K.jsx("option",{value:C,children:C},C))]})]}),x==="eleve"&&K.jsxs("div",{className:"form-group",children:[K.jsx("label",{children:"Sélectionner un élève:"}),K.jsxs("select",{value:g,onChange:C=>_(C.target.value),children:[K.jsx("option",{value:"",children:"Choisir un élève"}),t.map(C=>K.jsxs("option",{value:C.id,children:[C.prenom," ",C.nom," - ",C.classe]},C.id))]})]}),K.jsx("button",{className:"btn-export",onClick:ne,disabled:x==="classe"&&!h||x==="eleve"&&!g,children:"Exporter le rapport"})]}),K.jsxs("div",{className:"preview",children:[K.jsx("h3",{children:"Aperçu du rapport:"}),K.jsxs("div",{className:"preview-content",children:[x==="classe"&&h&&K.jsx("pre",{children:N()}),x==="eleve"&&g&&K.jsx("pre",{children:J()}),x==="global"&&K.jsx("pre",{children:re()})]})]})]})},VV=({isDarkMode:t})=>{const{currentUser:e}=kd(),r=[{label:"Gérer les classes",description:"Créez, modifiez et supprimez les classes",link:"/classes",show:e?.role==="admin",icon:"🏫"},{label:"Gérer les stages",description:"Définissez les périodes de stage (PFMP1, PFMP2...)",link:"/periodes-stage",show:!0,icon:"💼"},{label:"Évaluer un élève",description:"Remplissez une fiche d'évaluation",link:"/evaluations",show:!0,icon:"📝"},{label:"Exporter rapports",description:"Téléchargez les rapports de suivi",link:"/rapports",show:!0,icon:"📊"},{label:"Gestion des comptes",description:"Gérez les comptes utilisateurs",link:"/comptes",show:e?.role==="admin",icon:"👤"}];return K.jsx("div",{className:`app home-landing ${t?"dark":"light"}`,children:K.jsxs("main",{className:"main",style:{minHeight:"100vh"},children:[K.jsx("h1",{style:{textAlign:"center",fontSize:"3rem",fontWeight:800,marginBottom:"1rem"},children:"Gérez vos stages et évaluations avec IA"}),K.jsx("p",{style:{textAlign:"center",fontSize:"1.3rem",marginBottom:"2.5rem",color:"#555"},children:"Plateforme moderne pour la gestion des stages, des élèves et des évaluations"}),K.jsx("div",{className:"tiles-grid",children:r.filter(n=>n.show).map(n=>K.jsxs(ko,{to:n.link,className:"tile-card",children:[K.jsx("div",{className:"tile-icon",children:n.icon}),K.jsx("div",{className:"tile-title",children:n.label}),K.jsx("div",{className:"tile-desc",children:n.description})]},n.label))}),e&&K.jsxs("p",{style:{textAlign:"center",marginTop:"2rem",color:"#888"},children:["Connecté en tant que : ",e.prenom," ",e.nom," (",e.role,")"]})]})})},wu=({children:t})=>{const{currentUser:e,loading:r}=kd();return r?K.jsx("div",{className:"loading",children:"Chargement..."}):e?K.jsx(K.Fragment,{children:t}):K.jsx(F2,{to:"/login"})},UV=()=>{const[t,e]=Ie.useState(!1),r=()=>{e(!t)};return K.jsx(Sk,{children:K.jsxs("div",{className:`app ${t?"dark":"light"}`,children:[K.jsx(z6,{onToggleTheme:r,isDarkMode:t}),K.jsxs(_k,{children:[K.jsx(ys,{path:"/login",element:K.jsx(H6,{})}),K.jsx(ys,{path:"/",element:K.jsx(wu,{children:K.jsx(VV,{isDarkMode:t})})}),K.jsx(ys,{path:"/classes",element:K.jsx(wu,{children:K.jsx(DV,{})})}),K.jsx(ys,{path:"/periodes-stage",element:K.jsx(wu,{children:K.jsx(PV,{})})}),K.jsx(ys,{path:"/evaluations",element:K.jsx(wu,{children:K.jsx(MV,{})})}),K.jsx(ys,{path:"/rapports",element:K.jsx(wu,{children:K.jsx(LV,{})})}),K.jsx(ys,{path:"*",element:K.jsx(F2,{to:"/"})})]})]})})};function BV(){return K.jsx(j6,{children:K.jsx(UV,{})})}RR.createRoot(document.getElementById("root")).render(K.jsx(A2.StrictMode,{children:K.jsx(BV,{})}));
