function iR(t,e){for(var r=0;r<e.length;r++){const n=e[r];if(typeof n!="string"&&!Array.isArray(n)){for(const i in n)if(i!=="default"&&!(i in t)){const o=Object.getOwnPropertyDescriptor(n,i);o&&Object.defineProperty(t,i,o.get?o:{enumerable:!0,get:()=>n[i]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const c of o.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&n(c)}).observe(document,{childList:!0,subtree:!0});function r(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerPolicy&&(o.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?o.credentials="include":i.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function n(i){if(i.ep)return;i.ep=!0;const o=r(i);fetch(i.href,o)}})();function zg(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var Im={exports:{}},Eu={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ty;function sR(){if(Ty)return Eu;Ty=1;var t=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function r(n,i,o){var c=null;if(o!==void 0&&(c=""+o),i.key!==void 0&&(c=""+i.key),"key"in i){o={};for(var u in i)u!=="key"&&(o[u]=i[u])}else o=i;return i=o.ref,{$$typeof:t,type:n,key:c,ref:i!==void 0?i:null,props:o}}return Eu.Fragment=e,Eu.jsx=r,Eu.jsxs=r,Eu}var Ay;function oR(){return Ay||(Ay=1,Im.exports=sR()),Im.exports}var ie=oR(),Dm={exports:{}},ft={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var wy;function lR(){if(wy)return ft;wy=1;var t=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),i=Symbol.for("react.profiler"),o=Symbol.for("react.consumer"),c=Symbol.for("react.context"),u=Symbol.for("react.forward_ref"),h=Symbol.for("react.suspense"),d=Symbol.for("react.memo"),g=Symbol.for("react.lazy"),_=Symbol.iterator;function x(G){return G===null||typeof G!="object"?null:(G=_&&G[_]||G["@@iterator"],typeof G=="function"?G:null)}var A={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},w=Object.assign,S={};function C(G,se,M){this.props=G,this.context=se,this.refs=S,this.updater=M||A}C.prototype.isReactComponent={},C.prototype.setState=function(G,se){if(typeof G!="object"&&typeof G!="function"&&G!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,G,se,"setState")},C.prototype.forceUpdate=function(G){this.updater.enqueueForceUpdate(this,G,"forceUpdate")};function z(){}z.prototype=C.prototype;function W(G,se,M){this.props=G,this.context=se,this.refs=S,this.updater=M||A}var P=W.prototype=new z;P.constructor=W,w(P,C.prototype),P.isPureReactComponent=!0;var re=Array.isArray,Q={H:null,A:null,T:null,S:null,V:null},ee=Object.prototype.hasOwnProperty;function k(G,se,M,j,Y,Z){return M=Z.ref,{$$typeof:t,type:G,key:se,ref:M!==void 0?M:null,props:Z}}function T(G,se){return k(G.type,se,void 0,void 0,void 0,G.props)}function E(G){return typeof G=="object"&&G!==null&&G.$$typeof===t}function I(G){var se={"=":"=0",":":"=2"};return"$"+G.replace(/[=:]/g,function(M){return se[M]})}var O=/\/+/g;function D(G,se){return typeof G=="object"&&G!==null&&G.key!=null?I(""+G.key):se.toString(36)}function F(){}function Fe(G){switch(G.status){case"fulfilled":return G.value;case"rejected":throw G.reason;default:switch(typeof G.status=="string"?G.then(F,F):(G.status="pending",G.then(function(se){G.status==="pending"&&(G.status="fulfilled",G.value=se)},function(se){G.status==="pending"&&(G.status="rejected",G.reason=se)})),G.status){case"fulfilled":return G.value;case"rejected":throw G.reason}}throw G}function Ce(G,se,M,j,Y){var Z=typeof G;(Z==="undefined"||Z==="boolean")&&(G=null);var ue=!1;if(G===null)ue=!0;else switch(Z){case"bigint":case"string":case"number":ue=!0;break;case"object":switch(G.$$typeof){case t:case e:ue=!0;break;case g:return ue=G._init,Ce(ue(G._payload),se,M,j,Y)}}if(ue)return Y=Y(G),ue=j===""?"."+D(G,0):j,re(Y)?(M="",ue!=null&&(M=ue.replace(O,"$&/")+"/"),Ce(Y,se,M,"",function(we){return we})):Y!=null&&(E(Y)&&(Y=T(Y,M+(Y.key==null||G&&G.key===Y.key?"":(""+Y.key).replace(O,"$&/")+"/")+ue)),se.push(Y)),1;ue=0;var Ie=j===""?".":j+":";if(re(G))for(var Ee=0;Ee<G.length;Ee++)j=G[Ee],Z=Ie+D(j,Ee),ue+=Ce(j,se,M,Z,Y);else if(Ee=x(G),typeof Ee=="function")for(G=Ee.call(G),Ee=0;!(j=G.next()).done;)j=j.value,Z=Ie+D(j,Ee++),ue+=Ce(j,se,M,Z,Y);else if(Z==="object"){if(typeof G.then=="function")return Ce(Fe(G),se,M,j,Y);throw se=String(G),Error("Objects are not valid as a React child (found: "+(se==="[object Object]"?"object with keys {"+Object.keys(G).join(", ")+"}":se)+"). If you meant to render a collection of children, use an array instead.")}return ue}function ne(G,se,M){if(G==null)return G;var j=[],Y=0;return Ce(G,j,"","",function(Z){return se.call(M,Z,Y++)}),j}function oe(G){if(G._status===-1){var se=G._result;se=se(),se.then(function(M){(G._status===0||G._status===-1)&&(G._status=1,G._result=M)},function(M){(G._status===0||G._status===-1)&&(G._status=2,G._result=M)}),G._status===-1&&(G._status=0,G._result=se)}if(G._status===1)return G._result.default;throw G._result}var be=typeof reportError=="function"?reportError:function(G){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var se=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof G=="object"&&G!==null&&typeof G.message=="string"?String(G.message):String(G),error:G});if(!window.dispatchEvent(se))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",G);return}console.error(G)};function te(){}return ft.Children={map:ne,forEach:function(G,se,M){ne(G,function(){se.apply(this,arguments)},M)},count:function(G){var se=0;return ne(G,function(){se++}),se},toArray:function(G){return ne(G,function(se){return se})||[]},only:function(G){if(!E(G))throw Error("React.Children.only expected to receive a single React element child.");return G}},ft.Component=C,ft.Fragment=r,ft.Profiler=i,ft.PureComponent=W,ft.StrictMode=n,ft.Suspense=h,ft.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=Q,ft.__COMPILER_RUNTIME={__proto__:null,c:function(G){return Q.H.useMemoCache(G)}},ft.cache=function(G){return function(){return G.apply(null,arguments)}},ft.cloneElement=function(G,se,M){if(G==null)throw Error("The argument must be a React element, but you passed "+G+".");var j=w({},G.props),Y=G.key,Z=void 0;if(se!=null)for(ue in se.ref!==void 0&&(Z=void 0),se.key!==void 0&&(Y=""+se.key),se)!ee.call(se,ue)||ue==="key"||ue==="__self"||ue==="__source"||ue==="ref"&&se.ref===void 0||(j[ue]=se[ue]);var ue=arguments.length-2;if(ue===1)j.children=M;else if(1<ue){for(var Ie=Array(ue),Ee=0;Ee<ue;Ee++)Ie[Ee]=arguments[Ee+2];j.children=Ie}return k(G.type,Y,void 0,void 0,Z,j)},ft.createContext=function(G){return G={$$typeof:c,_currentValue:G,_currentValue2:G,_threadCount:0,Provider:null,Consumer:null},G.Provider=G,G.Consumer={$$typeof:o,_context:G},G},ft.createElement=function(G,se,M){var j,Y={},Z=null;if(se!=null)for(j in se.key!==void 0&&(Z=""+se.key),se)ee.call(se,j)&&j!=="key"&&j!=="__self"&&j!=="__source"&&(Y[j]=se[j]);var ue=arguments.length-2;if(ue===1)Y.children=M;else if(1<ue){for(var Ie=Array(ue),Ee=0;Ee<ue;Ee++)Ie[Ee]=arguments[Ee+2];Y.children=Ie}if(G&&G.defaultProps)for(j in ue=G.defaultProps,ue)Y[j]===void 0&&(Y[j]=ue[j]);return k(G,Z,void 0,void 0,null,Y)},ft.createRef=function(){return{current:null}},ft.forwardRef=function(G){return{$$typeof:u,render:G}},ft.isValidElement=E,ft.lazy=function(G){return{$$typeof:g,_payload:{_status:-1,_result:G},_init:oe}},ft.memo=function(G,se){return{$$typeof:d,type:G,compare:se===void 0?null:se}},ft.startTransition=function(G){var se=Q.T,M={};Q.T=M;try{var j=G(),Y=Q.S;Y!==null&&Y(M,j),typeof j=="object"&&j!==null&&typeof j.then=="function"&&j.then(te,be)}catch(Z){be(Z)}finally{Q.T=se}},ft.unstable_useCacheRefresh=function(){return Q.H.useCacheRefresh()},ft.use=function(G){return Q.H.use(G)},ft.useActionState=function(G,se,M){return Q.H.useActionState(G,se,M)},ft.useCallback=function(G,se){return Q.H.useCallback(G,se)},ft.useContext=function(G){return Q.H.useContext(G)},ft.useDebugValue=function(){},ft.useDeferredValue=function(G,se){return Q.H.useDeferredValue(G,se)},ft.useEffect=function(G,se,M){var j=Q.H;if(typeof M=="function")throw Error("useEffect CRUD overload is not enabled in this build of React.");return j.useEffect(G,se)},ft.useId=function(){return Q.H.useId()},ft.useImperativeHandle=function(G,se,M){return Q.H.useImperativeHandle(G,se,M)},ft.useInsertionEffect=function(G,se){return Q.H.useInsertionEffect(G,se)},ft.useLayoutEffect=function(G,se){return Q.H.useLayoutEffect(G,se)},ft.useMemo=function(G,se){return Q.H.useMemo(G,se)},ft.useOptimistic=function(G,se){return Q.H.useOptimistic(G,se)},ft.useReducer=function(G,se,M){return Q.H.useReducer(G,se,M)},ft.useRef=function(G){return Q.H.useRef(G)},ft.useState=function(G){return Q.H.useState(G)},ft.useSyncExternalStore=function(G,se,M){return Q.H.useSyncExternalStore(G,se,M)},ft.useTransition=function(){return Q.H.useTransition()},ft.version="19.1.0",ft}var Sy;function Hg(){return Sy||(Sy=1,Dm.exports=lR()),Dm.exports}var Pe=Hg();const g2=zg(Pe),cR=iR({__proto__:null,default:g2},[Pe]);var Om={exports:{}},Tu={},Nm={exports:{}},Fm={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Cy;function uR(){return Cy||(Cy=1,function(t){function e(ne,oe){var be=ne.length;ne.push(oe);e:for(;0<be;){var te=be-1>>>1,G=ne[te];if(0<i(G,oe))ne[te]=oe,ne[be]=G,be=te;else break e}}function r(ne){return ne.length===0?null:ne[0]}function n(ne){if(ne.length===0)return null;var oe=ne[0],be=ne.pop();if(be!==oe){ne[0]=be;e:for(var te=0,G=ne.length,se=G>>>1;te<se;){var M=2*(te+1)-1,j=ne[M],Y=M+1,Z=ne[Y];if(0>i(j,be))Y<G&&0>i(Z,j)?(ne[te]=Z,ne[Y]=be,te=Y):(ne[te]=j,ne[M]=be,te=M);else if(Y<G&&0>i(Z,be))ne[te]=Z,ne[Y]=be,te=Y;else break e}}return oe}function i(ne,oe){var be=ne.sortIndex-oe.sortIndex;return be!==0?be:ne.id-oe.id}if(t.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var o=performance;t.unstable_now=function(){return o.now()}}else{var c=Date,u=c.now();t.unstable_now=function(){return c.now()-u}}var h=[],d=[],g=1,_=null,x=3,A=!1,w=!1,S=!1,C=!1,z=typeof setTimeout=="function"?setTimeout:null,W=typeof clearTimeout=="function"?clearTimeout:null,P=typeof setImmediate<"u"?setImmediate:null;function re(ne){for(var oe=r(d);oe!==null;){if(oe.callback===null)n(d);else if(oe.startTime<=ne)n(d),oe.sortIndex=oe.expirationTime,e(h,oe);else break;oe=r(d)}}function Q(ne){if(S=!1,re(ne),!w)if(r(h)!==null)w=!0,ee||(ee=!0,D());else{var oe=r(d);oe!==null&&Ce(Q,oe.startTime-ne)}}var ee=!1,k=-1,T=5,E=-1;function I(){return C?!0:!(t.unstable_now()-E<T)}function O(){if(C=!1,ee){var ne=t.unstable_now();E=ne;var oe=!0;try{e:{w=!1,S&&(S=!1,W(k),k=-1),A=!0;var be=x;try{t:{for(re(ne),_=r(h);_!==null&&!(_.expirationTime>ne&&I());){var te=_.callback;if(typeof te=="function"){_.callback=null,x=_.priorityLevel;var G=te(_.expirationTime<=ne);if(ne=t.unstable_now(),typeof G=="function"){_.callback=G,re(ne),oe=!0;break t}_===r(h)&&n(h),re(ne)}else n(h);_=r(h)}if(_!==null)oe=!0;else{var se=r(d);se!==null&&Ce(Q,se.startTime-ne),oe=!1}}break e}finally{_=null,x=be,A=!1}oe=void 0}}finally{oe?D():ee=!1}}}var D;if(typeof P=="function")D=function(){P(O)};else if(typeof MessageChannel<"u"){var F=new MessageChannel,Fe=F.port2;F.port1.onmessage=O,D=function(){Fe.postMessage(null)}}else D=function(){z(O,0)};function Ce(ne,oe){k=z(function(){ne(t.unstable_now())},oe)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(ne){ne.callback=null},t.unstable_forceFrameRate=function(ne){0>ne||125<ne?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):T=0<ne?Math.floor(1e3/ne):5},t.unstable_getCurrentPriorityLevel=function(){return x},t.unstable_next=function(ne){switch(x){case 1:case 2:case 3:var oe=3;break;default:oe=x}var be=x;x=oe;try{return ne()}finally{x=be}},t.unstable_requestPaint=function(){C=!0},t.unstable_runWithPriority=function(ne,oe){switch(ne){case 1:case 2:case 3:case 4:case 5:break;default:ne=3}var be=x;x=ne;try{return oe()}finally{x=be}},t.unstable_scheduleCallback=function(ne,oe,be){var te=t.unstable_now();switch(typeof be=="object"&&be!==null?(be=be.delay,be=typeof be=="number"&&0<be?te+be:te):be=te,ne){case 1:var G=-1;break;case 2:G=250;break;case 5:G=1073741823;break;case 4:G=1e4;break;default:G=5e3}return G=be+G,ne={id:g++,callback:oe,priorityLevel:ne,startTime:be,expirationTime:G,sortIndex:-1},be>te?(ne.sortIndex=be,e(d,ne),r(h)===null&&ne===r(d)&&(S?(W(k),k=-1):S=!0,Ce(Q,be-te))):(ne.sortIndex=G,e(h,ne),w||A||(w=!0,ee||(ee=!0,D()))),ne},t.unstable_shouldYield=I,t.unstable_wrapCallback=function(ne){var oe=x;return function(){var be=x;x=oe;try{return ne.apply(this,arguments)}finally{x=be}}}}(Fm)),Fm}var Ry;function fR(){return Ry||(Ry=1,Nm.exports=uR()),Nm.exports}var Pm={exports:{}},an={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ky;function hR(){if(ky)return an;ky=1;var t=Hg();function e(h){var d="https://react.dev/errors/"+h;if(1<arguments.length){d+="?args[]="+encodeURIComponent(arguments[1]);for(var g=2;g<arguments.length;g++)d+="&args[]="+encodeURIComponent(arguments[g])}return"Minified React error #"+h+"; visit "+d+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function r(){}var n={d:{f:r,r:function(){throw Error(e(522))},D:r,C:r,L:r,m:r,X:r,S:r,M:r},p:0,findDOMNode:null},i=Symbol.for("react.portal");function o(h,d,g){var _=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:i,key:_==null?null:""+_,children:h,containerInfo:d,implementation:g}}var c=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function u(h,d){if(h==="font")return"";if(typeof d=="string")return d==="use-credentials"?d:""}return an.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=n,an.createPortal=function(h,d){var g=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!d||d.nodeType!==1&&d.nodeType!==9&&d.nodeType!==11)throw Error(e(299));return o(h,d,null,g)},an.flushSync=function(h){var d=c.T,g=n.p;try{if(c.T=null,n.p=2,h)return h()}finally{c.T=d,n.p=g,n.d.f()}},an.preconnect=function(h,d){typeof h=="string"&&(d?(d=d.crossOrigin,d=typeof d=="string"?d==="use-credentials"?d:"":void 0):d=null,n.d.C(h,d))},an.prefetchDNS=function(h){typeof h=="string"&&n.d.D(h)},an.preinit=function(h,d){if(typeof h=="string"&&d&&typeof d.as=="string"){var g=d.as,_=u(g,d.crossOrigin),x=typeof d.integrity=="string"?d.integrity:void 0,A=typeof d.fetchPriority=="string"?d.fetchPriority:void 0;g==="style"?n.d.S(h,typeof d.precedence=="string"?d.precedence:void 0,{crossOrigin:_,integrity:x,fetchPriority:A}):g==="script"&&n.d.X(h,{crossOrigin:_,integrity:x,fetchPriority:A,nonce:typeof d.nonce=="string"?d.nonce:void 0})}},an.preinitModule=function(h,d){if(typeof h=="string")if(typeof d=="object"&&d!==null){if(d.as==null||d.as==="script"){var g=u(d.as,d.crossOrigin);n.d.M(h,{crossOrigin:g,integrity:typeof d.integrity=="string"?d.integrity:void 0,nonce:typeof d.nonce=="string"?d.nonce:void 0})}}else d==null&&n.d.M(h)},an.preload=function(h,d){if(typeof h=="string"&&typeof d=="object"&&d!==null&&typeof d.as=="string"){var g=d.as,_=u(g,d.crossOrigin);n.d.L(h,g,{crossOrigin:_,integrity:typeof d.integrity=="string"?d.integrity:void 0,nonce:typeof d.nonce=="string"?d.nonce:void 0,type:typeof d.type=="string"?d.type:void 0,fetchPriority:typeof d.fetchPriority=="string"?d.fetchPriority:void 0,referrerPolicy:typeof d.referrerPolicy=="string"?d.referrerPolicy:void 0,imageSrcSet:typeof d.imageSrcSet=="string"?d.imageSrcSet:void 0,imageSizes:typeof d.imageSizes=="string"?d.imageSizes:void 0,media:typeof d.media=="string"?d.media:void 0})}},an.preloadModule=function(h,d){if(typeof h=="string")if(d){var g=u(d.as,d.crossOrigin);n.d.m(h,{as:typeof d.as=="string"&&d.as!=="script"?d.as:void 0,crossOrigin:g,integrity:typeof d.integrity=="string"?d.integrity:void 0})}else n.d.m(h)},an.requestFormReset=function(h){n.d.r(h)},an.unstable_batchedUpdates=function(h,d){return h(d)},an.useFormState=function(h,d,g){return c.H.useFormState(h,d,g)},an.useFormStatus=function(){return c.H.useHostTransitionStatus()},an.version="19.1.0",an}var by;function v2(){if(by)return Pm.exports;by=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}return t(),Pm.exports=hR(),Pm.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Iy;function dR(){if(Iy)return Tu;Iy=1;var t=fR(),e=Hg(),r=v2();function n(a){var s="https://react.dev/errors/"+a;if(1<arguments.length){s+="?args[]="+encodeURIComponent(arguments[1]);for(var l=2;l<arguments.length;l++)s+="&args[]="+encodeURIComponent(arguments[l])}return"Minified React error #"+a+"; visit "+s+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function i(a){return!(!a||a.nodeType!==1&&a.nodeType!==9&&a.nodeType!==11)}function o(a){var s=a,l=a;if(a.alternate)for(;s.return;)s=s.return;else{a=s;do s=a,(s.flags&4098)!==0&&(l=s.return),a=s.return;while(a)}return s.tag===3?l:null}function c(a){if(a.tag===13){var s=a.memoizedState;if(s===null&&(a=a.alternate,a!==null&&(s=a.memoizedState)),s!==null)return s.dehydrated}return null}function u(a){if(o(a)!==a)throw Error(n(188))}function h(a){var s=a.alternate;if(!s){if(s=o(a),s===null)throw Error(n(188));return s!==a?null:a}for(var l=a,f=s;;){var m=l.return;if(m===null)break;var v=m.alternate;if(v===null){if(f=m.return,f!==null){l=f;continue}break}if(m.child===v.child){for(v=m.child;v;){if(v===l)return u(m),a;if(v===f)return u(m),s;v=v.sibling}throw Error(n(188))}if(l.return!==f.return)l=m,f=v;else{for(var b=!1,L=m.child;L;){if(L===l){b=!0,l=m,f=v;break}if(L===f){b=!0,f=m,l=v;break}L=L.sibling}if(!b){for(L=v.child;L;){if(L===l){b=!0,l=v,f=m;break}if(L===f){b=!0,f=v,l=m;break}L=L.sibling}if(!b)throw Error(n(189))}}if(l.alternate!==f)throw Error(n(190))}if(l.tag!==3)throw Error(n(188));return l.stateNode.current===l?a:s}function d(a){var s=a.tag;if(s===5||s===26||s===27||s===6)return a;for(a=a.child;a!==null;){if(s=d(a),s!==null)return s;a=a.sibling}return null}var g=Object.assign,_=Symbol.for("react.element"),x=Symbol.for("react.transitional.element"),A=Symbol.for("react.portal"),w=Symbol.for("react.fragment"),S=Symbol.for("react.strict_mode"),C=Symbol.for("react.profiler"),z=Symbol.for("react.provider"),W=Symbol.for("react.consumer"),P=Symbol.for("react.context"),re=Symbol.for("react.forward_ref"),Q=Symbol.for("react.suspense"),ee=Symbol.for("react.suspense_list"),k=Symbol.for("react.memo"),T=Symbol.for("react.lazy"),E=Symbol.for("react.activity"),I=Symbol.for("react.memo_cache_sentinel"),O=Symbol.iterator;function D(a){return a===null||typeof a!="object"?null:(a=O&&a[O]||a["@@iterator"],typeof a=="function"?a:null)}var F=Symbol.for("react.client.reference");function Fe(a){if(a==null)return null;if(typeof a=="function")return a.$$typeof===F?null:a.displayName||a.name||null;if(typeof a=="string")return a;switch(a){case w:return"Fragment";case C:return"Profiler";case S:return"StrictMode";case Q:return"Suspense";case ee:return"SuspenseList";case E:return"Activity"}if(typeof a=="object")switch(a.$$typeof){case A:return"Portal";case P:return(a.displayName||"Context")+".Provider";case W:return(a._context.displayName||"Context")+".Consumer";case re:var s=a.render;return a=a.displayName,a||(a=s.displayName||s.name||"",a=a!==""?"ForwardRef("+a+")":"ForwardRef"),a;case k:return s=a.displayName||null,s!==null?s:Fe(a.type)||"Memo";case T:s=a._payload,a=a._init;try{return Fe(a(s))}catch{}}return null}var Ce=Array.isArray,ne=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,oe=r.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,be={pending:!1,data:null,method:null,action:null},te=[],G=-1;function se(a){return{current:a}}function M(a){0>G||(a.current=te[G],te[G]=null,G--)}function j(a,s){G++,te[G]=a.current,a.current=s}var Y=se(null),Z=se(null),ue=se(null),Ie=se(null);function Ee(a,s){switch(j(ue,s),j(Z,a),j(Y,null),s.nodeType){case 9:case 11:a=(a=s.documentElement)&&(a=a.namespaceURI)?$x(a):0;break;default:if(a=s.tagName,s=s.namespaceURI)s=$x(s),a=Qx(s,a);else switch(a){case"svg":a=1;break;case"math":a=2;break;default:a=0}}M(Y),j(Y,a)}function we(){M(Y),M(Z),M(ue)}function Te(a){a.memoizedState!==null&&j(Ie,a);var s=Y.current,l=Qx(s,a.type);s!==l&&(j(Z,a),j(Y,l))}function Ue(a){Z.current===a&&(M(Y),M(Z)),Ie.current===a&&(M(Ie),gu._currentValue=be)}var K=Object.prototype.hasOwnProperty,nt=t.unstable_scheduleCallback,Ge=t.unstable_cancelCallback,Ke=t.unstable_shouldYield,Be=t.unstable_requestPaint,Ne=t.unstable_now,Ye=t.unstable_getCurrentPriorityLevel,ut=t.unstable_ImmediatePriority,_t=t.unstable_UserBlockingPriority,rr=t.unstable_NormalPriority,_r=t.unstable_LowPriority,fr=t.unstable_IdlePriority,Et=t.log,er=t.unstable_setDisableYieldValue,Ze=null,Je=null;function dt(a){if(typeof Et=="function"&&er(a),Je&&typeof Je.setStrictMode=="function")try{Je.setStrictMode(Ze,a)}catch{}}var Lt=Math.clz32?Math.clz32:Vt,ot=Math.log,Ft=Math.LN2;function Vt(a){return a>>>=0,a===0?32:31-(ot(a)/Ft|0)|0}var Ot=256,Lr=4194304;function Cn(a){var s=a&42;if(s!==0)return s;switch(a&-a){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return a&4194048;case 4194304:case 8388608:case 16777216:case 33554432:return a&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return a}}function Hi(a,s,l){var f=a.pendingLanes;if(f===0)return 0;var m=0,v=a.suspendedLanes,b=a.pingedLanes;a=a.warmLanes;var L=f&134217727;return L!==0?(f=L&~v,f!==0?m=Cn(f):(b&=L,b!==0?m=Cn(b):l||(l=L&~a,l!==0&&(m=Cn(l))))):(L=f&~v,L!==0?m=Cn(L):b!==0?m=Cn(b):l||(l=f&~a,l!==0&&(m=Cn(l)))),m===0?0:s!==0&&s!==m&&(s&v)===0&&(v=m&-m,l=s&-s,v>=l||v===32&&(l&4194048)!==0)?s:m}function li(a,s){return(a.pendingLanes&~(a.suspendedLanes&~a.pingedLanes)&s)===0}function Gi(a,s){switch(a){case 1:case 2:case 4:case 8:case 64:return s+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return s+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function qi(){var a=Ot;return Ot<<=1,(Ot&4194048)===0&&(Ot=256),a}function Ki(){var a=Lr;return Lr<<=1,(Lr&62914560)===0&&(Lr=4194304),a}function _a(a){for(var s=[],l=0;31>l;l++)s.push(a);return s}function xa(a,s){a.pendingLanes|=s,s!==268435456&&(a.suspendedLanes=0,a.pingedLanes=0,a.warmLanes=0)}function Na(a,s,l,f,m,v){var b=a.pendingLanes;a.pendingLanes=l,a.suspendedLanes=0,a.pingedLanes=0,a.warmLanes=0,a.expiredLanes&=l,a.entangledLanes&=l,a.errorRecoveryDisabledLanes&=l,a.shellSuspendCounter=0;var L=a.entanglements,J=a.expirationTimes,pe=a.hiddenUpdates;for(l=b&~l;0<l;){var Ae=31-Lt(l),Re=1<<Ae;L[Ae]=0,J[Ae]=-1;var ve=pe[Ae];if(ve!==null)for(pe[Ae]=null,Ae=0;Ae<ve.length;Ae++){var _e=ve[Ae];_e!==null&&(_e.lane&=-536870913)}l&=~Re}f!==0&&$n(a,f,0),v!==0&&m===0&&a.tag!==0&&(a.suspendedLanes|=v&~(b&~s))}function $n(a,s,l){a.pendingLanes|=s,a.suspendedLanes&=~s;var f=31-Lt(s);a.entangledLanes|=s,a.entanglements[f]=a.entanglements[f]|1073741824|l&4194090}function Zs(a,s){var l=a.entangledLanes|=s;for(a=a.entanglements;l;){var f=31-Lt(l),m=1<<f;m&s|a[f]&s&&(a[f]|=s),l&=~m}}function Fa(a){switch(a){case 2:a=1;break;case 8:a=4;break;case 32:a=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:a=128;break;case 268435456:a=134217728;break;default:a=0}return a}function Xi(a){return a&=-a,2<a?8<a?(a&134217727)!==0?32:268435456:8:2}function Pa(){var a=oe.p;return a!==0?a:(a=window.event,a===void 0?32:gy(a.type))}function nl(a,s){var l=oe.p;try{return oe.p=a,s()}finally{oe.p=l}}var Qt=Math.random().toString(36).slice(2),hr="__reactFiber$"+Qt,nr="__reactProps$"+Qt,Rn="__reactContainer$"+Qt,Js="__reactEvents$"+Qt,Ac="__reactListeners$"+Qt,N="__reactHandles$"+Qt,q="__reactResources$"+Qt,U="__reactMarker$"+Qt;function B(a){delete a[hr],delete a[nr],delete a[Js],delete a[Ac],delete a[N]}function H(a){var s=a[hr];if(s)return s;for(var l=a.parentNode;l;){if(s=l[Rn]||l[hr]){if(l=s.alternate,s.child!==null||l!==null&&l.child!==null)for(a=ty(a);a!==null;){if(l=a[hr])return l;a=ty(a)}return s}a=l,l=a.parentNode}return null}function X(a){if(a=a[hr]||a[Rn]){var s=a.tag;if(s===5||s===6||s===13||s===26||s===27||s===3)return a}return null}function de(a){var s=a.tag;if(s===5||s===26||s===27||s===6)return a.stateNode;throw Error(n(33))}function xe(a){var s=a[q];return s||(s=a[q]={hoistableStyles:new Map,hoistableScripts:new Map}),s}function ce(a){a[U]=!0}var me=new Set,ge={};function Oe(a,s){Le(a,s),Le(a+"Capture",s)}function Le(a,s){for(ge[a]=s,a=0;a<s.length;a++)me.add(s[a])}var ze=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Me={},je={};function at(a){return K.call(je,a)?!0:K.call(Me,a)?!1:ze.test(a)?je[a]=!0:(Me[a]=!0,!1)}function Pt(a,s,l){if(at(s))if(l===null)a.removeAttribute(s);else{switch(typeof l){case"undefined":case"function":case"symbol":a.removeAttribute(s);return;case"boolean":var f=s.toLowerCase().slice(0,5);if(f!=="data-"&&f!=="aria-"){a.removeAttribute(s);return}}a.setAttribute(s,""+l)}}function St(a,s,l){if(l===null)a.removeAttribute(s);else{switch(typeof l){case"undefined":case"function":case"symbol":case"boolean":a.removeAttribute(s);return}a.setAttribute(s,""+l)}}function Ct(a,s,l,f){if(f===null)a.removeAttribute(l);else{switch(typeof f){case"undefined":case"function":case"symbol":case"boolean":a.removeAttribute(l);return}a.setAttributeNS(s,l,""+f)}}var Pn,Ma;function vn(a){if(Pn===void 0)try{throw Error()}catch(l){var s=l.stack.trim().match(/\n( *(at )?)/);Pn=s&&s[1]||"",Ma=-1<l.stack.indexOf(`
    at`)?" (<anonymous>)":-1<l.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Pn+a+Ma}var kn=!1;function La(a,s){if(!a||kn)return"";kn=!0;var l=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var f={DetermineComponentFrameRoot:function(){try{if(s){var Re=function(){throw Error()};if(Object.defineProperty(Re.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(Re,[])}catch(_e){var ve=_e}Reflect.construct(a,[],Re)}else{try{Re.call()}catch(_e){ve=_e}a.call(Re.prototype)}}else{try{throw Error()}catch(_e){ve=_e}(Re=a())&&typeof Re.catch=="function"&&Re.catch(function(){})}}catch(_e){if(_e&&ve&&typeof _e.stack=="string")return[_e.stack,ve.stack]}return[null,null]}};f.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var m=Object.getOwnPropertyDescriptor(f.DetermineComponentFrameRoot,"name");m&&m.configurable&&Object.defineProperty(f.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var v=f.DetermineComponentFrameRoot(),b=v[0],L=v[1];if(b&&L){var J=b.split(`
`),pe=L.split(`
`);for(m=f=0;f<J.length&&!J[f].includes("DetermineComponentFrameRoot");)f++;for(;m<pe.length&&!pe[m].includes("DetermineComponentFrameRoot");)m++;if(f===J.length||m===pe.length)for(f=J.length-1,m=pe.length-1;1<=f&&0<=m&&J[f]!==pe[m];)m--;for(;1<=f&&0<=m;f--,m--)if(J[f]!==pe[m]){if(f!==1||m!==1)do if(f--,m--,0>m||J[f]!==pe[m]){var Ae=`
`+J[f].replace(" at new "," at ");return a.displayName&&Ae.includes("<anonymous>")&&(Ae=Ae.replace("<anonymous>",a.displayName)),Ae}while(1<=f&&0<=m);break}}}finally{kn=!1,Error.prepareStackTrace=l}return(l=a?a.displayName||a.name:"")?vn(l):""}function _n(a){switch(a.tag){case 26:case 27:case 5:return vn(a.type);case 16:return vn("Lazy");case 13:return vn("Suspense");case 19:return vn("SuspenseList");case 0:case 15:return La(a.type,!1);case 11:return La(a.type.render,!1);case 1:return La(a.type,!0);case 31:return vn("Activity");default:return""}}function al(a){try{var s="";do s+=_n(a),a=a.return;while(a);return s}catch(l){return`
Error generating stack: `+l.message+`
`+l.stack}}function xn(a){switch(typeof a){case"bigint":case"boolean":case"number":case"string":case"undefined":return a;case"object":return a;default:return""}}function wc(a){var s=a.type;return(a=a.nodeName)&&a.toLowerCase()==="input"&&(s==="checkbox"||s==="radio")}function Fd(a){var s=wc(a)?"checked":"value",l=Object.getOwnPropertyDescriptor(a.constructor.prototype,s),f=""+a[s];if(!a.hasOwnProperty(s)&&typeof l<"u"&&typeof l.get=="function"&&typeof l.set=="function"){var m=l.get,v=l.set;return Object.defineProperty(a,s,{configurable:!0,get:function(){return m.call(this)},set:function(b){f=""+b,v.call(this,b)}}),Object.defineProperty(a,s,{enumerable:l.enumerable}),{getValue:function(){return f},setValue:function(b){f=""+b},stopTracking:function(){a._valueTracker=null,delete a[s]}}}}function il(a){a._valueTracker||(a._valueTracker=Fd(a))}function Sc(a){if(!a)return!1;var s=a._valueTracker;if(!s)return!0;var l=s.getValue(),f="";return a&&(f=wc(a)?a.checked?"true":"false":a.value),a=f,a!==l?(s.setValue(a),!0):!1}function eo(a){if(a=a||(typeof document<"u"?document:void 0),typeof a>"u")return null;try{return a.activeElement||a.body}catch{return a.body}}var Pd=/[\n"\\]/g;function xr(a){return a.replace(Pd,function(s){return"\\"+s.charCodeAt(0).toString(16)+" "})}function Mn(a,s,l,f,m,v,b,L){a.name="",b!=null&&typeof b!="function"&&typeof b!="symbol"&&typeof b!="boolean"?a.type=b:a.removeAttribute("type"),s!=null?b==="number"?(s===0&&a.value===""||a.value!=s)&&(a.value=""+xn(s)):a.value!==""+xn(s)&&(a.value=""+xn(s)):b!=="submit"&&b!=="reset"||a.removeAttribute("value"),s!=null?Wi(a,b,xn(s)):l!=null?Wi(a,b,xn(l)):f!=null&&a.removeAttribute("value"),m==null&&v!=null&&(a.defaultChecked=!!v),m!=null&&(a.checked=m&&typeof m!="function"&&typeof m!="symbol"),L!=null&&typeof L!="function"&&typeof L!="symbol"&&typeof L!="boolean"?a.name=""+xn(L):a.removeAttribute("name")}function to(a,s,l,f,m,v,b,L){if(v!=null&&typeof v!="function"&&typeof v!="symbol"&&typeof v!="boolean"&&(a.type=v),s!=null||l!=null){if(!(v!=="submit"&&v!=="reset"||s!=null))return;l=l!=null?""+xn(l):"",s=s!=null?""+xn(s):l,L||s===a.value||(a.value=s),a.defaultValue=s}f=f??m,f=typeof f!="function"&&typeof f!="symbol"&&!!f,a.checked=L?a.checked:!!f,a.defaultChecked=!!f,b!=null&&typeof b!="function"&&typeof b!="symbol"&&typeof b!="boolean"&&(a.name=b)}function Wi(a,s,l){s==="number"&&eo(a.ownerDocument)===a||a.defaultValue===""+l||(a.defaultValue=""+l)}function ci(a,s,l,f){if(a=a.options,s){s={};for(var m=0;m<l.length;m++)s["$"+l[m]]=!0;for(l=0;l<a.length;l++)m=s.hasOwnProperty("$"+a[l].value),a[l].selected!==m&&(a[l].selected=m),m&&f&&(a[l].defaultSelected=!0)}else{for(l=""+xn(l),s=null,m=0;m<a.length;m++){if(a[m].value===l){a[m].selected=!0,f&&(a[m].defaultSelected=!0);return}s!==null||a[m].disabled||(s=a[m])}s!==null&&(s.selected=!0)}}function Kt(a,s,l){if(s!=null&&(s=""+xn(s),s!==a.value&&(a.value=s),l==null)){a.defaultValue!==s&&(a.defaultValue=s);return}a.defaultValue=l!=null?""+xn(l):""}function ro(a,s,l,f){if(s==null){if(f!=null){if(l!=null)throw Error(n(92));if(Ce(f)){if(1<f.length)throw Error(n(93));f=f[0]}l=f}l==null&&(l=""),s=l}l=xn(s),a.defaultValue=l,f=a.textContent,f===l&&f!==""&&f!==null&&(a.value=f)}function Qn(a,s){if(s){var l=a.firstChild;if(l&&l===a.lastChild&&l.nodeType===3){l.nodeValue=s;return}}a.textContent=s}var no=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Nf(a,s,l){var f=s.indexOf("--")===0;l==null||typeof l=="boolean"||l===""?f?a.setProperty(s,""):s==="float"?a.cssFloat="":a[s]="":f?a.setProperty(s,l):typeof l!="number"||l===0||no.has(s)?s==="float"?a.cssFloat=l:a[s]=(""+l).trim():a[s]=l+"px"}function Cc(a,s,l){if(s!=null&&typeof s!="object")throw Error(n(62));if(a=a.style,l!=null){for(var f in l)!l.hasOwnProperty(f)||s!=null&&s.hasOwnProperty(f)||(f.indexOf("--")===0?a.setProperty(f,""):f==="float"?a.cssFloat="":a[f]="");for(var m in s)f=s[m],s.hasOwnProperty(m)&&l[m]!==f&&Nf(a,m,f)}else for(var v in s)s.hasOwnProperty(v)&&Nf(a,v,s[v])}function Rc(a){if(a.indexOf("-")===-1)return!1;switch(a){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Md=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Ld=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function sl(a){return Ld.test(""+a)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":a}var ui=null;function Zn(a){return a=a.target||a.srcElement||window,a.correspondingUseElement&&(a=a.correspondingUseElement),a.nodeType===3?a.parentNode:a}var fi=null,hi=null;function kc(a){var s=X(a);if(s&&(a=s.stateNode)){var l=a[nr]||null;e:switch(a=s.stateNode,s.type){case"input":if(Mn(a,l.value,l.defaultValue,l.defaultValue,l.checked,l.defaultChecked,l.type,l.name),s=l.name,l.type==="radio"&&s!=null){for(l=a;l.parentNode;)l=l.parentNode;for(l=l.querySelectorAll('input[name="'+xr(""+s)+'"][type="radio"]'),s=0;s<l.length;s++){var f=l[s];if(f!==a&&f.form===a.form){var m=f[nr]||null;if(!m)throw Error(n(90));Mn(f,m.value,m.defaultValue,m.defaultValue,m.checked,m.defaultChecked,m.type,m.name)}}for(s=0;s<l.length;s++)f=l[s],f.form===a.form&&Sc(f)}break e;case"textarea":Kt(a,l.value,l.defaultValue);break e;case"select":s=l.value,s!=null&&ci(a,!!l.multiple,s,!1)}}}var Va=!1;function Ff(a,s,l){if(Va)return a(s,l);Va=!0;try{var f=a(s);return f}finally{if(Va=!1,(fi!==null||hi!==null)&&(Rh(),fi&&(s=fi,a=hi,hi=fi=null,kc(s),a)))for(s=0;s<a.length;s++)kc(a[s])}}function ao(a,s){var l=a.stateNode;if(l===null)return null;var f=l[nr]||null;if(f===null)return null;l=f[s];e:switch(s){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(f=!f.disabled)||(a=a.type,f=!(a==="button"||a==="input"||a==="select"||a==="textarea")),a=!f;break e;default:a=!1}if(a)return null;if(l&&typeof l!="function")throw Error(n(231,s,typeof l));return l}var ya=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Jn=!1;if(ya)try{var io={};Object.defineProperty(io,"passive",{get:function(){Jn=!0}}),window.addEventListener("test",io,io),window.removeEventListener("test",io,io)}catch{Jn=!1}var Ua=null,Yi=null,di=null;function bc(){if(di)return di;var a,s=Yi,l=s.length,f,m="value"in Ua?Ua.value:Ua.textContent,v=m.length;for(a=0;a<l&&s[a]===m[a];a++);var b=l-a;for(f=1;f<=b&&s[l-f]===m[v-f];f++);return di=m.slice(a,1<f?1-f:void 0)}function Ba(a){var s=a.keyCode;return"charCode"in a?(a=a.charCode,a===0&&s===13&&(a=13)):a=s,a===10&&(a=13),32<=a||a===13?a:0}function ja(){return!0}function Ic(){return!1}function Vr(a){function s(l,f,m,v,b){this._reactName=l,this._targetInst=m,this.type=f,this.nativeEvent=v,this.target=b,this.currentTarget=null;for(var L in a)a.hasOwnProperty(L)&&(l=a[L],this[L]=l?l(v):v[L]);return this.isDefaultPrevented=(v.defaultPrevented!=null?v.defaultPrevented:v.returnValue===!1)?ja:Ic,this.isPropagationStopped=Ic,this}return g(s.prototype,{preventDefault:function(){this.defaultPrevented=!0;var l=this.nativeEvent;l&&(l.preventDefault?l.preventDefault():typeof l.returnValue!="unknown"&&(l.returnValue=!1),this.isDefaultPrevented=ja)},stopPropagation:function(){var l=this.nativeEvent;l&&(l.stopPropagation?l.stopPropagation():typeof l.cancelBubble!="unknown"&&(l.cancelBubble=!0),this.isPropagationStopped=ja)},persist:function(){},isPersistent:ja}),s}var Bt={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(a){return a.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},ol=Vr(Bt),so=g({},Bt,{view:0,detail:0}),Pf=Vr(so),ll,cl,za,oo=g({},so,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:uo,button:0,buttons:0,relatedTarget:function(a){return a.relatedTarget===void 0?a.fromElement===a.srcElement?a.toElement:a.fromElement:a.relatedTarget},movementX:function(a){return"movementX"in a?a.movementX:(a!==za&&(za&&a.type==="mousemove"?(ll=a.screenX-za.screenX,cl=a.screenY-za.screenY):cl=ll=0,za=a),ll)},movementY:function(a){return"movementY"in a?a.movementY:cl}}),ea=Vr(oo),Mf=g({},oo,{dataTransfer:0}),Vd=Vr(Mf),lo=g({},so,{relatedTarget:0}),ul=Vr(lo),Dc=g({},Bt,{animationName:0,elapsedTime:0,pseudoElement:0}),fl=Vr(Dc),Lf=g({},Bt,{clipboardData:function(a){return"clipboardData"in a?a.clipboardData:window.clipboardData}}),hl=Vr(Lf),Ud=g({},Bt,{data:0}),Oc=Vr(Ud),co={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Vf={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Uf={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Nc(a){var s=this.nativeEvent;return s.getModifierState?s.getModifierState(a):(a=Uf[a])?!!s[a]:!1}function uo(){return Nc}var Bf=g({},so,{key:function(a){if(a.key){var s=co[a.key]||a.key;if(s!=="Unidentified")return s}return a.type==="keypress"?(a=Ba(a),a===13?"Enter":String.fromCharCode(a)):a.type==="keydown"||a.type==="keyup"?Vf[a.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:uo,charCode:function(a){return a.type==="keypress"?Ba(a):0},keyCode:function(a){return a.type==="keydown"||a.type==="keyup"?a.keyCode:0},which:function(a){return a.type==="keypress"?Ba(a):a.type==="keydown"||a.type==="keyup"?a.keyCode:0}}),dl=Vr(Bf),jf=g({},oo,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Fc=Vr(jf),pi=g({},so,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:uo}),zf=Vr(pi),Hf=g({},Bt,{propertyName:0,elapsedTime:0,pseudoElement:0}),Gf=Vr(Hf),qf=g({},oo,{deltaX:function(a){return"deltaX"in a?a.deltaX:"wheelDeltaX"in a?-a.wheelDeltaX:0},deltaY:function(a){return"deltaY"in a?a.deltaY:"wheelDeltaY"in a?-a.wheelDeltaY:"wheelDelta"in a?-a.wheelDelta:0},deltaZ:0,deltaMode:0}),pl=Vr(qf),yn=g({},Bt,{newState:0,oldState:0}),Kf=Vr(yn),Xf=[9,13,27,32],Ha=ya&&"CompositionEvent"in window,p=null;ya&&"documentMode"in document&&(p=document.documentMode);var y=ya&&"TextEvent"in window&&!p,R=ya&&(!Ha||p&&8<p&&11>=p),V=" ",fe=!1;function ye(a,s){switch(a){case"keyup":return Xf.indexOf(s.keyCode)!==-1;case"keydown":return s.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Ve(a){return a=a.detail,typeof a=="object"&&"data"in a?a.data:null}var Rt=!1;function kr(a,s){switch(a){case"compositionend":return Ve(s);case"keypress":return s.which!==32?null:(fe=!0,V);case"textInput":return a=s.data,a===V&&fe?null:a;default:return null}}function kt(a,s){if(Rt)return a==="compositionend"||!Ha&&ye(a,s)?(a=bc(),di=Yi=Ua=null,Rt=!1,a):null;switch(a){case"paste":return null;case"keypress":if(!(s.ctrlKey||s.altKey||s.metaKey)||s.ctrlKey&&s.altKey){if(s.char&&1<s.char.length)return s.char;if(s.which)return String.fromCharCode(s.which)}return null;case"compositionend":return R&&s.locale!=="ko"?null:s.data;default:return null}}var Ur={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function br(a){var s=a&&a.nodeName&&a.nodeName.toLowerCase();return s==="input"?!!Ur[a.type]:s==="textarea"}function mi(a,s,l,f){fi?hi?hi.push(f):hi=[f]:fi=f,s=Nh(s,"onChange"),0<s.length&&(l=new ol("onChange","change",null,l,f),a.push({event:l,listeners:s}))}var Kr=null,Ga=null;function Pc(a){qx(a,0)}function Wf(a){var s=de(a);if(Sc(s))return a}function hv(a,s){if(a==="change")return s}var dv=!1;if(ya){var Bd;if(ya){var jd="oninput"in document;if(!jd){var pv=document.createElement("div");pv.setAttribute("oninput","return;"),jd=typeof pv.oninput=="function"}Bd=jd}else Bd=!1;dv=Bd&&(!document.documentMode||9<document.documentMode)}function mv(){Kr&&(Kr.detachEvent("onpropertychange",gv),Ga=Kr=null)}function gv(a){if(a.propertyName==="value"&&Wf(Ga)){var s=[];mi(s,Ga,a,Zn(a)),Ff(Pc,s)}}function P4(a,s,l){a==="focusin"?(mv(),Kr=s,Ga=l,Kr.attachEvent("onpropertychange",gv)):a==="focusout"&&mv()}function M4(a){if(a==="selectionchange"||a==="keyup"||a==="keydown")return Wf(Ga)}function L4(a,s){if(a==="click")return Wf(s)}function V4(a,s){if(a==="input"||a==="change")return Wf(s)}function U4(a,s){return a===s&&(a!==0||1/a===1/s)||a!==a&&s!==s}var Ln=typeof Object.is=="function"?Object.is:U4;function Mc(a,s){if(Ln(a,s))return!0;if(typeof a!="object"||a===null||typeof s!="object"||s===null)return!1;var l=Object.keys(a),f=Object.keys(s);if(l.length!==f.length)return!1;for(f=0;f<l.length;f++){var m=l[f];if(!K.call(s,m)||!Ln(a[m],s[m]))return!1}return!0}function vv(a){for(;a&&a.firstChild;)a=a.firstChild;return a}function _v(a,s){var l=vv(a);a=0;for(var f;l;){if(l.nodeType===3){if(f=a+l.textContent.length,a<=s&&f>=s)return{node:l,offset:s-a};a=f}e:{for(;l;){if(l.nextSibling){l=l.nextSibling;break e}l=l.parentNode}l=void 0}l=vv(l)}}function xv(a,s){return a&&s?a===s?!0:a&&a.nodeType===3?!1:s&&s.nodeType===3?xv(a,s.parentNode):"contains"in a?a.contains(s):a.compareDocumentPosition?!!(a.compareDocumentPosition(s)&16):!1:!1}function yv(a){a=a!=null&&a.ownerDocument!=null&&a.ownerDocument.defaultView!=null?a.ownerDocument.defaultView:window;for(var s=eo(a.document);s instanceof a.HTMLIFrameElement;){try{var l=typeof s.contentWindow.location.href=="string"}catch{l=!1}if(l)a=s.contentWindow;else break;s=eo(a.document)}return s}function zd(a){var s=a&&a.nodeName&&a.nodeName.toLowerCase();return s&&(s==="input"&&(a.type==="text"||a.type==="search"||a.type==="tel"||a.type==="url"||a.type==="password")||s==="textarea"||a.contentEditable==="true")}var B4=ya&&"documentMode"in document&&11>=document.documentMode,ml=null,Hd=null,Lc=null,Gd=!1;function Ev(a,s,l){var f=l.window===l?l.document:l.nodeType===9?l:l.ownerDocument;Gd||ml==null||ml!==eo(f)||(f=ml,"selectionStart"in f&&zd(f)?f={start:f.selectionStart,end:f.selectionEnd}:(f=(f.ownerDocument&&f.ownerDocument.defaultView||window).getSelection(),f={anchorNode:f.anchorNode,anchorOffset:f.anchorOffset,focusNode:f.focusNode,focusOffset:f.focusOffset}),Lc&&Mc(Lc,f)||(Lc=f,f=Nh(Hd,"onSelect"),0<f.length&&(s=new ol("onSelect","select",null,s,l),a.push({event:s,listeners:f}),s.target=ml)))}function fo(a,s){var l={};return l[a.toLowerCase()]=s.toLowerCase(),l["Webkit"+a]="webkit"+s,l["Moz"+a]="moz"+s,l}var gl={animationend:fo("Animation","AnimationEnd"),animationiteration:fo("Animation","AnimationIteration"),animationstart:fo("Animation","AnimationStart"),transitionrun:fo("Transition","TransitionRun"),transitionstart:fo("Transition","TransitionStart"),transitioncancel:fo("Transition","TransitionCancel"),transitionend:fo("Transition","TransitionEnd")},qd={},Tv={};ya&&(Tv=document.createElement("div").style,"AnimationEvent"in window||(delete gl.animationend.animation,delete gl.animationiteration.animation,delete gl.animationstart.animation),"TransitionEvent"in window||delete gl.transitionend.transition);function ho(a){if(qd[a])return qd[a];if(!gl[a])return a;var s=gl[a],l;for(l in s)if(s.hasOwnProperty(l)&&l in Tv)return qd[a]=s[l];return a}var Av=ho("animationend"),wv=ho("animationiteration"),Sv=ho("animationstart"),j4=ho("transitionrun"),z4=ho("transitionstart"),H4=ho("transitioncancel"),Cv=ho("transitionend"),Rv=new Map,Kd="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Kd.push("scrollEnd");function Ea(a,s){Rv.set(a,s),Oe(s,[a])}var kv=new WeakMap;function ta(a,s){if(typeof a=="object"&&a!==null){var l=kv.get(a);return l!==void 0?l:(s={value:a,source:s,stack:al(s)},kv.set(a,s),s)}return{value:a,source:s,stack:al(s)}}var ra=[],vl=0,Xd=0;function Yf(){for(var a=vl,s=Xd=vl=0;s<a;){var l=ra[s];ra[s++]=null;var f=ra[s];ra[s++]=null;var m=ra[s];ra[s++]=null;var v=ra[s];if(ra[s++]=null,f!==null&&m!==null){var b=f.pending;b===null?m.next=m:(m.next=b.next,b.next=m),f.pending=m}v!==0&&bv(l,m,v)}}function $f(a,s,l,f){ra[vl++]=a,ra[vl++]=s,ra[vl++]=l,ra[vl++]=f,Xd|=f,a.lanes|=f,a=a.alternate,a!==null&&(a.lanes|=f)}function Wd(a,s,l,f){return $f(a,s,l,f),Qf(a)}function _l(a,s){return $f(a,null,null,s),Qf(a)}function bv(a,s,l){a.lanes|=l;var f=a.alternate;f!==null&&(f.lanes|=l);for(var m=!1,v=a.return;v!==null;)v.childLanes|=l,f=v.alternate,f!==null&&(f.childLanes|=l),v.tag===22&&(a=v.stateNode,a===null||a._visibility&1||(m=!0)),a=v,v=v.return;return a.tag===3?(v=a.stateNode,m&&s!==null&&(m=31-Lt(l),a=v.hiddenUpdates,f=a[m],f===null?a[m]=[s]:f.push(s),s.lane=l|536870912),v):null}function Qf(a){if(50<lu)throw lu=0,em=null,Error(n(185));for(var s=a.return;s!==null;)a=s,s=a.return;return a.tag===3?a.stateNode:null}var xl={};function G4(a,s,l,f){this.tag=a,this.key=l,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=s,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=f,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Vn(a,s,l,f){return new G4(a,s,l,f)}function Yd(a){return a=a.prototype,!(!a||!a.isReactComponent)}function gi(a,s){var l=a.alternate;return l===null?(l=Vn(a.tag,s,a.key,a.mode),l.elementType=a.elementType,l.type=a.type,l.stateNode=a.stateNode,l.alternate=a,a.alternate=l):(l.pendingProps=s,l.type=a.type,l.flags=0,l.subtreeFlags=0,l.deletions=null),l.flags=a.flags&65011712,l.childLanes=a.childLanes,l.lanes=a.lanes,l.child=a.child,l.memoizedProps=a.memoizedProps,l.memoizedState=a.memoizedState,l.updateQueue=a.updateQueue,s=a.dependencies,l.dependencies=s===null?null:{lanes:s.lanes,firstContext:s.firstContext},l.sibling=a.sibling,l.index=a.index,l.ref=a.ref,l.refCleanup=a.refCleanup,l}function Iv(a,s){a.flags&=65011714;var l=a.alternate;return l===null?(a.childLanes=0,a.lanes=s,a.child=null,a.subtreeFlags=0,a.memoizedProps=null,a.memoizedState=null,a.updateQueue=null,a.dependencies=null,a.stateNode=null):(a.childLanes=l.childLanes,a.lanes=l.lanes,a.child=l.child,a.subtreeFlags=0,a.deletions=null,a.memoizedProps=l.memoizedProps,a.memoizedState=l.memoizedState,a.updateQueue=l.updateQueue,a.type=l.type,s=l.dependencies,a.dependencies=s===null?null:{lanes:s.lanes,firstContext:s.firstContext}),a}function Zf(a,s,l,f,m,v){var b=0;if(f=a,typeof a=="function")Yd(a)&&(b=1);else if(typeof a=="string")b=KC(a,l,Y.current)?26:a==="html"||a==="head"||a==="body"?27:5;else e:switch(a){case E:return a=Vn(31,l,s,m),a.elementType=E,a.lanes=v,a;case w:return po(l.children,m,v,s);case S:b=8,m|=24;break;case C:return a=Vn(12,l,s,m|2),a.elementType=C,a.lanes=v,a;case Q:return a=Vn(13,l,s,m),a.elementType=Q,a.lanes=v,a;case ee:return a=Vn(19,l,s,m),a.elementType=ee,a.lanes=v,a;default:if(typeof a=="object"&&a!==null)switch(a.$$typeof){case z:case P:b=10;break e;case W:b=9;break e;case re:b=11;break e;case k:b=14;break e;case T:b=16,f=null;break e}b=29,l=Error(n(130,a===null?"null":typeof a,"")),f=null}return s=Vn(b,l,s,m),s.elementType=a,s.type=f,s.lanes=v,s}function po(a,s,l,f){return a=Vn(7,a,f,s),a.lanes=l,a}function $d(a,s,l){return a=Vn(6,a,null,s),a.lanes=l,a}function Qd(a,s,l){return s=Vn(4,a.children!==null?a.children:[],a.key,s),s.lanes=l,s.stateNode={containerInfo:a.containerInfo,pendingChildren:null,implementation:a.implementation},s}var yl=[],El=0,Jf=null,eh=0,na=[],aa=0,mo=null,vi=1,_i="";function go(a,s){yl[El++]=eh,yl[El++]=Jf,Jf=a,eh=s}function Dv(a,s,l){na[aa++]=vi,na[aa++]=_i,na[aa++]=mo,mo=a;var f=vi;a=_i;var m=32-Lt(f)-1;f&=~(1<<m),l+=1;var v=32-Lt(s)+m;if(30<v){var b=m-m%5;v=(f&(1<<b)-1).toString(32),f>>=b,m-=b,vi=1<<32-Lt(s)+m|l<<m|f,_i=v+a}else vi=1<<v|l<<m|f,_i=a}function Zd(a){a.return!==null&&(go(a,1),Dv(a,1,0))}function Jd(a){for(;a===Jf;)Jf=yl[--El],yl[El]=null,eh=yl[--El],yl[El]=null;for(;a===mo;)mo=na[--aa],na[aa]=null,_i=na[--aa],na[aa]=null,vi=na[--aa],na[aa]=null}var En=null,lr=null,Ut=!1,vo=null,qa=!1,ep=Error(n(519));function _o(a){var s=Error(n(418,""));throw Bc(ta(s,a)),ep}function Ov(a){var s=a.stateNode,l=a.type,f=a.memoizedProps;switch(s[hr]=a,s[nr]=f,l){case"dialog":yt("cancel",s),yt("close",s);break;case"iframe":case"object":case"embed":yt("load",s);break;case"video":case"audio":for(l=0;l<uu.length;l++)yt(uu[l],s);break;case"source":yt("error",s);break;case"img":case"image":case"link":yt("error",s),yt("load",s);break;case"details":yt("toggle",s);break;case"input":yt("invalid",s),to(s,f.value,f.defaultValue,f.checked,f.defaultChecked,f.type,f.name,!0),il(s);break;case"select":yt("invalid",s);break;case"textarea":yt("invalid",s),ro(s,f.value,f.defaultValue,f.children),il(s)}l=f.children,typeof l!="string"&&typeof l!="number"&&typeof l!="bigint"||s.textContent===""+l||f.suppressHydrationWarning===!0||Yx(s.textContent,l)?(f.popover!=null&&(yt("beforetoggle",s),yt("toggle",s)),f.onScroll!=null&&yt("scroll",s),f.onScrollEnd!=null&&yt("scrollend",s),f.onClick!=null&&(s.onclick=Fh),s=!0):s=!1,s||_o(a)}function Nv(a){for(En=a.return;En;)switch(En.tag){case 5:case 13:qa=!1;return;case 27:case 3:qa=!0;return;default:En=En.return}}function Vc(a){if(a!==En)return!1;if(!Ut)return Nv(a),Ut=!0,!1;var s=a.tag,l;if((l=s!==3&&s!==27)&&((l=s===5)&&(l=a.type,l=!(l!=="form"&&l!=="button")||gm(a.type,a.memoizedProps)),l=!l),l&&lr&&_o(a),Nv(a),s===13){if(a=a.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(n(317));e:{for(a=a.nextSibling,s=0;a;){if(a.nodeType===8)if(l=a.data,l==="/$"){if(s===0){lr=Aa(a.nextSibling);break e}s--}else l!=="$"&&l!=="$!"&&l!=="$?"||s++;a=a.nextSibling}lr=null}}else s===27?(s=lr,fs(a.type)?(a=ym,ym=null,lr=a):lr=s):lr=En?Aa(a.stateNode.nextSibling):null;return!0}function Uc(){lr=En=null,Ut=!1}function Fv(){var a=vo;return a!==null&&(Dn===null?Dn=a:Dn.push.apply(Dn,a),vo=null),a}function Bc(a){vo===null?vo=[a]:vo.push(a)}var tp=se(null),xo=null,xi=null;function $i(a,s,l){j(tp,s._currentValue),s._currentValue=l}function yi(a){a._currentValue=tp.current,M(tp)}function rp(a,s,l){for(;a!==null;){var f=a.alternate;if((a.childLanes&s)!==s?(a.childLanes|=s,f!==null&&(f.childLanes|=s)):f!==null&&(f.childLanes&s)!==s&&(f.childLanes|=s),a===l)break;a=a.return}}function np(a,s,l,f){var m=a.child;for(m!==null&&(m.return=a);m!==null;){var v=m.dependencies;if(v!==null){var b=m.child;v=v.firstContext;e:for(;v!==null;){var L=v;v=m;for(var J=0;J<s.length;J++)if(L.context===s[J]){v.lanes|=l,L=v.alternate,L!==null&&(L.lanes|=l),rp(v.return,l,a),f||(b=null);break e}v=L.next}}else if(m.tag===18){if(b=m.return,b===null)throw Error(n(341));b.lanes|=l,v=b.alternate,v!==null&&(v.lanes|=l),rp(b,l,a),b=null}else b=m.child;if(b!==null)b.return=m;else for(b=m;b!==null;){if(b===a){b=null;break}if(m=b.sibling,m!==null){m.return=b.return,b=m;break}b=b.return}m=b}}function jc(a,s,l,f){a=null;for(var m=s,v=!1;m!==null;){if(!v){if((m.flags&524288)!==0)v=!0;else if((m.flags&262144)!==0)break}if(m.tag===10){var b=m.alternate;if(b===null)throw Error(n(387));if(b=b.memoizedProps,b!==null){var L=m.type;Ln(m.pendingProps.value,b.value)||(a!==null?a.push(L):a=[L])}}else if(m===Ie.current){if(b=m.alternate,b===null)throw Error(n(387));b.memoizedState.memoizedState!==m.memoizedState.memoizedState&&(a!==null?a.push(gu):a=[gu])}m=m.return}a!==null&&np(s,a,l,f),s.flags|=262144}function th(a){for(a=a.firstContext;a!==null;){if(!Ln(a.context._currentValue,a.memoizedValue))return!0;a=a.next}return!1}function yo(a){xo=a,xi=null,a=a.dependencies,a!==null&&(a.firstContext=null)}function nn(a){return Pv(xo,a)}function rh(a,s){return xo===null&&yo(a),Pv(a,s)}function Pv(a,s){var l=s._currentValue;if(s={context:s,memoizedValue:l,next:null},xi===null){if(a===null)throw Error(n(308));xi=s,a.dependencies={lanes:0,firstContext:s},a.flags|=524288}else xi=xi.next=s;return l}var q4=typeof AbortController<"u"?AbortController:function(){var a=[],s=this.signal={aborted:!1,addEventListener:function(l,f){a.push(f)}};this.abort=function(){s.aborted=!0,a.forEach(function(l){return l()})}},K4=t.unstable_scheduleCallback,X4=t.unstable_NormalPriority,Ir={$$typeof:P,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function ap(){return{controller:new q4,data:new Map,refCount:0}}function zc(a){a.refCount--,a.refCount===0&&K4(X4,function(){a.controller.abort()})}var Hc=null,ip=0,Tl=0,Al=null;function W4(a,s){if(Hc===null){var l=Hc=[];ip=0,Tl=om(),Al={status:"pending",value:void 0,then:function(f){l.push(f)}}}return ip++,s.then(Mv,Mv),s}function Mv(){if(--ip===0&&Hc!==null){Al!==null&&(Al.status="fulfilled");var a=Hc;Hc=null,Tl=0,Al=null;for(var s=0;s<a.length;s++)(0,a[s])()}}function Y4(a,s){var l=[],f={status:"pending",value:null,reason:null,then:function(m){l.push(m)}};return a.then(function(){f.status="fulfilled",f.value=s;for(var m=0;m<l.length;m++)(0,l[m])(s)},function(m){for(f.status="rejected",f.reason=m,m=0;m<l.length;m++)(0,l[m])(void 0)}),f}var Lv=ne.S;ne.S=function(a,s){typeof s=="object"&&s!==null&&typeof s.then=="function"&&W4(a,s),Lv!==null&&Lv(a,s)};var Eo=se(null);function sp(){var a=Eo.current;return a!==null?a:Zt.pooledCache}function nh(a,s){s===null?j(Eo,Eo.current):j(Eo,s.pool)}function Vv(){var a=sp();return a===null?null:{parent:Ir._currentValue,pool:a}}var Gc=Error(n(460)),Uv=Error(n(474)),ah=Error(n(542)),op={then:function(){}};function Bv(a){return a=a.status,a==="fulfilled"||a==="rejected"}function ih(){}function jv(a,s,l){switch(l=a[l],l===void 0?a.push(s):l!==s&&(s.then(ih,ih),s=l),s.status){case"fulfilled":return s.value;case"rejected":throw a=s.reason,Hv(a),a;default:if(typeof s.status=="string")s.then(ih,ih);else{if(a=Zt,a!==null&&100<a.shellSuspendCounter)throw Error(n(482));a=s,a.status="pending",a.then(function(f){if(s.status==="pending"){var m=s;m.status="fulfilled",m.value=f}},function(f){if(s.status==="pending"){var m=s;m.status="rejected",m.reason=f}})}switch(s.status){case"fulfilled":return s.value;case"rejected":throw a=s.reason,Hv(a),a}throw qc=s,Gc}}var qc=null;function zv(){if(qc===null)throw Error(n(459));var a=qc;return qc=null,a}function Hv(a){if(a===Gc||a===ah)throw Error(n(483))}var Qi=!1;function lp(a){a.updateQueue={baseState:a.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function cp(a,s){a=a.updateQueue,s.updateQueue===a&&(s.updateQueue={baseState:a.baseState,firstBaseUpdate:a.firstBaseUpdate,lastBaseUpdate:a.lastBaseUpdate,shared:a.shared,callbacks:null})}function Zi(a){return{lane:a,tag:0,payload:null,callback:null,next:null}}function Ji(a,s,l){var f=a.updateQueue;if(f===null)return null;if(f=f.shared,(zt&2)!==0){var m=f.pending;return m===null?s.next=s:(s.next=m.next,m.next=s),f.pending=s,s=Qf(a),bv(a,null,l),s}return $f(a,f,s,l),Qf(a)}function Kc(a,s,l){if(s=s.updateQueue,s!==null&&(s=s.shared,(l&4194048)!==0)){var f=s.lanes;f&=a.pendingLanes,l|=f,s.lanes=l,Zs(a,l)}}function up(a,s){var l=a.updateQueue,f=a.alternate;if(f!==null&&(f=f.updateQueue,l===f)){var m=null,v=null;if(l=l.firstBaseUpdate,l!==null){do{var b={lane:l.lane,tag:l.tag,payload:l.payload,callback:null,next:null};v===null?m=v=b:v=v.next=b,l=l.next}while(l!==null);v===null?m=v=s:v=v.next=s}else m=v=s;l={baseState:f.baseState,firstBaseUpdate:m,lastBaseUpdate:v,shared:f.shared,callbacks:f.callbacks},a.updateQueue=l;return}a=l.lastBaseUpdate,a===null?l.firstBaseUpdate=s:a.next=s,l.lastBaseUpdate=s}var fp=!1;function Xc(){if(fp){var a=Al;if(a!==null)throw a}}function Wc(a,s,l,f){fp=!1;var m=a.updateQueue;Qi=!1;var v=m.firstBaseUpdate,b=m.lastBaseUpdate,L=m.shared.pending;if(L!==null){m.shared.pending=null;var J=L,pe=J.next;J.next=null,b===null?v=pe:b.next=pe,b=J;var Ae=a.alternate;Ae!==null&&(Ae=Ae.updateQueue,L=Ae.lastBaseUpdate,L!==b&&(L===null?Ae.firstBaseUpdate=pe:L.next=pe,Ae.lastBaseUpdate=J))}if(v!==null){var Re=m.baseState;b=0,Ae=pe=J=null,L=v;do{var ve=L.lane&-536870913,_e=ve!==L.lane;if(_e?(bt&ve)===ve:(f&ve)===ve){ve!==0&&ve===Tl&&(fp=!0),Ae!==null&&(Ae=Ae.next={lane:0,tag:L.tag,payload:L.payload,callback:null,next:null});e:{var it=a,Qe=L;ve=s;var Yt=l;switch(Qe.tag){case 1:if(it=Qe.payload,typeof it=="function"){Re=it.call(Yt,Re,ve);break e}Re=it;break e;case 3:it.flags=it.flags&-65537|128;case 0:if(it=Qe.payload,ve=typeof it=="function"?it.call(Yt,Re,ve):it,ve==null)break e;Re=g({},Re,ve);break e;case 2:Qi=!0}}ve=L.callback,ve!==null&&(a.flags|=64,_e&&(a.flags|=8192),_e=m.callbacks,_e===null?m.callbacks=[ve]:_e.push(ve))}else _e={lane:ve,tag:L.tag,payload:L.payload,callback:L.callback,next:null},Ae===null?(pe=Ae=_e,J=Re):Ae=Ae.next=_e,b|=ve;if(L=L.next,L===null){if(L=m.shared.pending,L===null)break;_e=L,L=_e.next,_e.next=null,m.lastBaseUpdate=_e,m.shared.pending=null}}while(!0);Ae===null&&(J=Re),m.baseState=J,m.firstBaseUpdate=pe,m.lastBaseUpdate=Ae,v===null&&(m.shared.lanes=0),os|=b,a.lanes=b,a.memoizedState=Re}}function Gv(a,s){if(typeof a!="function")throw Error(n(191,a));a.call(s)}function qv(a,s){var l=a.callbacks;if(l!==null)for(a.callbacks=null,a=0;a<l.length;a++)Gv(l[a],s)}var wl=se(null),sh=se(0);function Kv(a,s){a=Ri,j(sh,a),j(wl,s),Ri=a|s.baseLanes}function hp(){j(sh,Ri),j(wl,wl.current)}function dp(){Ri=sh.current,M(wl),M(sh)}var es=0,pt=null,Xt=null,yr=null,oh=!1,Sl=!1,To=!1,lh=0,Yc=0,Cl=null,$4=0;function dr(){throw Error(n(321))}function pp(a,s){if(s===null)return!1;for(var l=0;l<s.length&&l<a.length;l++)if(!Ln(a[l],s[l]))return!1;return!0}function mp(a,s,l,f,m,v){return es=v,pt=s,s.memoizedState=null,s.updateQueue=null,s.lanes=0,ne.H=a===null||a.memoizedState===null?b_:I_,To=!1,v=l(f,m),To=!1,Sl&&(v=Wv(s,l,f,m)),Xv(a),v}function Xv(a){ne.H=ph;var s=Xt!==null&&Xt.next!==null;if(es=0,yr=Xt=pt=null,oh=!1,Yc=0,Cl=null,s)throw Error(n(300));a===null||Br||(a=a.dependencies,a!==null&&th(a)&&(Br=!0))}function Wv(a,s,l,f){pt=a;var m=0;do{if(Sl&&(Cl=null),Yc=0,Sl=!1,25<=m)throw Error(n(301));if(m+=1,yr=Xt=null,a.updateQueue!=null){var v=a.updateQueue;v.lastEffect=null,v.events=null,v.stores=null,v.memoCache!=null&&(v.memoCache.index=0)}ne.H=nC,v=s(l,f)}while(Sl);return v}function Q4(){var a=ne.H,s=a.useState()[0];return s=typeof s.then=="function"?$c(s):s,a=a.useState()[0],(Xt!==null?Xt.memoizedState:null)!==a&&(pt.flags|=1024),s}function gp(){var a=lh!==0;return lh=0,a}function vp(a,s,l){s.updateQueue=a.updateQueue,s.flags&=-2053,a.lanes&=~l}function _p(a){if(oh){for(a=a.memoizedState;a!==null;){var s=a.queue;s!==null&&(s.pending=null),a=a.next}oh=!1}es=0,yr=Xt=pt=null,Sl=!1,Yc=lh=0,Cl=null}function bn(){var a={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return yr===null?pt.memoizedState=yr=a:yr=yr.next=a,yr}function Er(){if(Xt===null){var a=pt.alternate;a=a!==null?a.memoizedState:null}else a=Xt.next;var s=yr===null?pt.memoizedState:yr.next;if(s!==null)yr=s,Xt=a;else{if(a===null)throw pt.alternate===null?Error(n(467)):Error(n(310));Xt=a,a={memoizedState:Xt.memoizedState,baseState:Xt.baseState,baseQueue:Xt.baseQueue,queue:Xt.queue,next:null},yr===null?pt.memoizedState=yr=a:yr=yr.next=a}return yr}function xp(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function $c(a){var s=Yc;return Yc+=1,Cl===null&&(Cl=[]),a=jv(Cl,a,s),s=pt,(yr===null?s.memoizedState:yr.next)===null&&(s=s.alternate,ne.H=s===null||s.memoizedState===null?b_:I_),a}function ch(a){if(a!==null&&typeof a=="object"){if(typeof a.then=="function")return $c(a);if(a.$$typeof===P)return nn(a)}throw Error(n(438,String(a)))}function yp(a){var s=null,l=pt.updateQueue;if(l!==null&&(s=l.memoCache),s==null){var f=pt.alternate;f!==null&&(f=f.updateQueue,f!==null&&(f=f.memoCache,f!=null&&(s={data:f.data.map(function(m){return m.slice()}),index:0})))}if(s==null&&(s={data:[],index:0}),l===null&&(l=xp(),pt.updateQueue=l),l.memoCache=s,l=s.data[s.index],l===void 0)for(l=s.data[s.index]=Array(a),f=0;f<a;f++)l[f]=I;return s.index++,l}function Ei(a,s){return typeof s=="function"?s(a):s}function uh(a){var s=Er();return Ep(s,Xt,a)}function Ep(a,s,l){var f=a.queue;if(f===null)throw Error(n(311));f.lastRenderedReducer=l;var m=a.baseQueue,v=f.pending;if(v!==null){if(m!==null){var b=m.next;m.next=v.next,v.next=b}s.baseQueue=m=v,f.pending=null}if(v=a.baseState,m===null)a.memoizedState=v;else{s=m.next;var L=b=null,J=null,pe=s,Ae=!1;do{var Re=pe.lane&-536870913;if(Re!==pe.lane?(bt&Re)===Re:(es&Re)===Re){var ve=pe.revertLane;if(ve===0)J!==null&&(J=J.next={lane:0,revertLane:0,action:pe.action,hasEagerState:pe.hasEagerState,eagerState:pe.eagerState,next:null}),Re===Tl&&(Ae=!0);else if((es&ve)===ve){pe=pe.next,ve===Tl&&(Ae=!0);continue}else Re={lane:0,revertLane:pe.revertLane,action:pe.action,hasEagerState:pe.hasEagerState,eagerState:pe.eagerState,next:null},J===null?(L=J=Re,b=v):J=J.next=Re,pt.lanes|=ve,os|=ve;Re=pe.action,To&&l(v,Re),v=pe.hasEagerState?pe.eagerState:l(v,Re)}else ve={lane:Re,revertLane:pe.revertLane,action:pe.action,hasEagerState:pe.hasEagerState,eagerState:pe.eagerState,next:null},J===null?(L=J=ve,b=v):J=J.next=ve,pt.lanes|=Re,os|=Re;pe=pe.next}while(pe!==null&&pe!==s);if(J===null?b=v:J.next=L,!Ln(v,a.memoizedState)&&(Br=!0,Ae&&(l=Al,l!==null)))throw l;a.memoizedState=v,a.baseState=b,a.baseQueue=J,f.lastRenderedState=v}return m===null&&(f.lanes=0),[a.memoizedState,f.dispatch]}function Tp(a){var s=Er(),l=s.queue;if(l===null)throw Error(n(311));l.lastRenderedReducer=a;var f=l.dispatch,m=l.pending,v=s.memoizedState;if(m!==null){l.pending=null;var b=m=m.next;do v=a(v,b.action),b=b.next;while(b!==m);Ln(v,s.memoizedState)||(Br=!0),s.memoizedState=v,s.baseQueue===null&&(s.baseState=v),l.lastRenderedState=v}return[v,f]}function Yv(a,s,l){var f=pt,m=Er(),v=Ut;if(v){if(l===void 0)throw Error(n(407));l=l()}else l=s();var b=!Ln((Xt||m).memoizedState,l);b&&(m.memoizedState=l,Br=!0),m=m.queue;var L=Zv.bind(null,f,m,a);if(Qc(2048,8,L,[a]),m.getSnapshot!==s||b||yr!==null&&yr.memoizedState.tag&1){if(f.flags|=2048,Rl(9,fh(),Qv.bind(null,f,m,l,s),null),Zt===null)throw Error(n(349));v||(es&124)!==0||$v(f,s,l)}return l}function $v(a,s,l){a.flags|=16384,a={getSnapshot:s,value:l},s=pt.updateQueue,s===null?(s=xp(),pt.updateQueue=s,s.stores=[a]):(l=s.stores,l===null?s.stores=[a]:l.push(a))}function Qv(a,s,l,f){s.value=l,s.getSnapshot=f,Jv(s)&&e_(a)}function Zv(a,s,l){return l(function(){Jv(s)&&e_(a)})}function Jv(a){var s=a.getSnapshot;a=a.value;try{var l=s();return!Ln(a,l)}catch{return!0}}function e_(a){var s=_l(a,2);s!==null&&Hn(s,a,2)}function Ap(a){var s=bn();if(typeof a=="function"){var l=a;if(a=l(),To){dt(!0);try{l()}finally{dt(!1)}}}return s.memoizedState=s.baseState=a,s.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ei,lastRenderedState:a},s}function t_(a,s,l,f){return a.baseState=l,Ep(a,Xt,typeof f=="function"?f:Ei)}function Z4(a,s,l,f,m){if(dh(a))throw Error(n(485));if(a=s.action,a!==null){var v={payload:m,action:a,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(b){v.listeners.push(b)}};ne.T!==null?l(!0):v.isTransition=!1,f(v),l=s.pending,l===null?(v.next=s.pending=v,r_(s,v)):(v.next=l.next,s.pending=l.next=v)}}function r_(a,s){var l=s.action,f=s.payload,m=a.state;if(s.isTransition){var v=ne.T,b={};ne.T=b;try{var L=l(m,f),J=ne.S;J!==null&&J(b,L),n_(a,s,L)}catch(pe){wp(a,s,pe)}finally{ne.T=v}}else try{v=l(m,f),n_(a,s,v)}catch(pe){wp(a,s,pe)}}function n_(a,s,l){l!==null&&typeof l=="object"&&typeof l.then=="function"?l.then(function(f){a_(a,s,f)},function(f){return wp(a,s,f)}):a_(a,s,l)}function a_(a,s,l){s.status="fulfilled",s.value=l,i_(s),a.state=l,s=a.pending,s!==null&&(l=s.next,l===s?a.pending=null:(l=l.next,s.next=l,r_(a,l)))}function wp(a,s,l){var f=a.pending;if(a.pending=null,f!==null){f=f.next;do s.status="rejected",s.reason=l,i_(s),s=s.next;while(s!==f)}a.action=null}function i_(a){a=a.listeners;for(var s=0;s<a.length;s++)(0,a[s])()}function s_(a,s){return s}function o_(a,s){if(Ut){var l=Zt.formState;if(l!==null){e:{var f=pt;if(Ut){if(lr){t:{for(var m=lr,v=qa;m.nodeType!==8;){if(!v){m=null;break t}if(m=Aa(m.nextSibling),m===null){m=null;break t}}v=m.data,m=v==="F!"||v==="F"?m:null}if(m){lr=Aa(m.nextSibling),f=m.data==="F!";break e}}_o(f)}f=!1}f&&(s=l[0])}}return l=bn(),l.memoizedState=l.baseState=s,f={pending:null,lanes:0,dispatch:null,lastRenderedReducer:s_,lastRenderedState:s},l.queue=f,l=C_.bind(null,pt,f),f.dispatch=l,f=Ap(!1),v=bp.bind(null,pt,!1,f.queue),f=bn(),m={state:s,dispatch:null,action:a,pending:null},f.queue=m,l=Z4.bind(null,pt,m,v,l),m.dispatch=l,f.memoizedState=a,[s,l,!1]}function l_(a){var s=Er();return c_(s,Xt,a)}function c_(a,s,l){if(s=Ep(a,s,s_)[0],a=uh(Ei)[0],typeof s=="object"&&s!==null&&typeof s.then=="function")try{var f=$c(s)}catch(b){throw b===Gc?ah:b}else f=s;s=Er();var m=s.queue,v=m.dispatch;return l!==s.memoizedState&&(pt.flags|=2048,Rl(9,fh(),J4.bind(null,m,l),null)),[f,v,a]}function J4(a,s){a.action=s}function u_(a){var s=Er(),l=Xt;if(l!==null)return c_(s,l,a);Er(),s=s.memoizedState,l=Er();var f=l.queue.dispatch;return l.memoizedState=a,[s,f,!1]}function Rl(a,s,l,f){return a={tag:a,create:l,deps:f,inst:s,next:null},s=pt.updateQueue,s===null&&(s=xp(),pt.updateQueue=s),l=s.lastEffect,l===null?s.lastEffect=a.next=a:(f=l.next,l.next=a,a.next=f,s.lastEffect=a),a}function fh(){return{destroy:void 0,resource:void 0}}function f_(){return Er().memoizedState}function hh(a,s,l,f){var m=bn();f=f===void 0?null:f,pt.flags|=a,m.memoizedState=Rl(1|s,fh(),l,f)}function Qc(a,s,l,f){var m=Er();f=f===void 0?null:f;var v=m.memoizedState.inst;Xt!==null&&f!==null&&pp(f,Xt.memoizedState.deps)?m.memoizedState=Rl(s,v,l,f):(pt.flags|=a,m.memoizedState=Rl(1|s,v,l,f))}function h_(a,s){hh(8390656,8,a,s)}function d_(a,s){Qc(2048,8,a,s)}function p_(a,s){return Qc(4,2,a,s)}function m_(a,s){return Qc(4,4,a,s)}function g_(a,s){if(typeof s=="function"){a=a();var l=s(a);return function(){typeof l=="function"?l():s(null)}}if(s!=null)return a=a(),s.current=a,function(){s.current=null}}function v_(a,s,l){l=l!=null?l.concat([a]):null,Qc(4,4,g_.bind(null,s,a),l)}function Sp(){}function __(a,s){var l=Er();s=s===void 0?null:s;var f=l.memoizedState;return s!==null&&pp(s,f[1])?f[0]:(l.memoizedState=[a,s],a)}function x_(a,s){var l=Er();s=s===void 0?null:s;var f=l.memoizedState;if(s!==null&&pp(s,f[1]))return f[0];if(f=a(),To){dt(!0);try{a()}finally{dt(!1)}}return l.memoizedState=[f,s],f}function Cp(a,s,l){return l===void 0||(es&1073741824)!==0?a.memoizedState=s:(a.memoizedState=l,a=Tx(),pt.lanes|=a,os|=a,l)}function y_(a,s,l,f){return Ln(l,s)?l:wl.current!==null?(a=Cp(a,l,f),Ln(a,s)||(Br=!0),a):(es&42)===0?(Br=!0,a.memoizedState=l):(a=Tx(),pt.lanes|=a,os|=a,s)}function E_(a,s,l,f,m){var v=oe.p;oe.p=v!==0&&8>v?v:8;var b=ne.T,L={};ne.T=L,bp(a,!1,s,l);try{var J=m(),pe=ne.S;if(pe!==null&&pe(L,J),J!==null&&typeof J=="object"&&typeof J.then=="function"){var Ae=Y4(J,f);Zc(a,s,Ae,zn(a))}else Zc(a,s,f,zn(a))}catch(Re){Zc(a,s,{then:function(){},status:"rejected",reason:Re},zn())}finally{oe.p=v,ne.T=b}}function eC(){}function Rp(a,s,l,f){if(a.tag!==5)throw Error(n(476));var m=T_(a).queue;E_(a,m,s,be,l===null?eC:function(){return A_(a),l(f)})}function T_(a){var s=a.memoizedState;if(s!==null)return s;s={memoizedState:be,baseState:be,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ei,lastRenderedState:be},next:null};var l={};return s.next={memoizedState:l,baseState:l,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ei,lastRenderedState:l},next:null},a.memoizedState=s,a=a.alternate,a!==null&&(a.memoizedState=s),s}function A_(a){var s=T_(a).next.queue;Zc(a,s,{},zn())}function kp(){return nn(gu)}function w_(){return Er().memoizedState}function S_(){return Er().memoizedState}function tC(a){for(var s=a.return;s!==null;){switch(s.tag){case 24:case 3:var l=zn();a=Zi(l);var f=Ji(s,a,l);f!==null&&(Hn(f,s,l),Kc(f,s,l)),s={cache:ap()},a.payload=s;return}s=s.return}}function rC(a,s,l){var f=zn();l={lane:f,revertLane:0,action:l,hasEagerState:!1,eagerState:null,next:null},dh(a)?R_(s,l):(l=Wd(a,s,l,f),l!==null&&(Hn(l,a,f),k_(l,s,f)))}function C_(a,s,l){var f=zn();Zc(a,s,l,f)}function Zc(a,s,l,f){var m={lane:f,revertLane:0,action:l,hasEagerState:!1,eagerState:null,next:null};if(dh(a))R_(s,m);else{var v=a.alternate;if(a.lanes===0&&(v===null||v.lanes===0)&&(v=s.lastRenderedReducer,v!==null))try{var b=s.lastRenderedState,L=v(b,l);if(m.hasEagerState=!0,m.eagerState=L,Ln(L,b))return $f(a,s,m,0),Zt===null&&Yf(),!1}catch{}finally{}if(l=Wd(a,s,m,f),l!==null)return Hn(l,a,f),k_(l,s,f),!0}return!1}function bp(a,s,l,f){if(f={lane:2,revertLane:om(),action:f,hasEagerState:!1,eagerState:null,next:null},dh(a)){if(s)throw Error(n(479))}else s=Wd(a,l,f,2),s!==null&&Hn(s,a,2)}function dh(a){var s=a.alternate;return a===pt||s!==null&&s===pt}function R_(a,s){Sl=oh=!0;var l=a.pending;l===null?s.next=s:(s.next=l.next,l.next=s),a.pending=s}function k_(a,s,l){if((l&4194048)!==0){var f=s.lanes;f&=a.pendingLanes,l|=f,s.lanes=l,Zs(a,l)}}var ph={readContext:nn,use:ch,useCallback:dr,useContext:dr,useEffect:dr,useImperativeHandle:dr,useLayoutEffect:dr,useInsertionEffect:dr,useMemo:dr,useReducer:dr,useRef:dr,useState:dr,useDebugValue:dr,useDeferredValue:dr,useTransition:dr,useSyncExternalStore:dr,useId:dr,useHostTransitionStatus:dr,useFormState:dr,useActionState:dr,useOptimistic:dr,useMemoCache:dr,useCacheRefresh:dr},b_={readContext:nn,use:ch,useCallback:function(a,s){return bn().memoizedState=[a,s===void 0?null:s],a},useContext:nn,useEffect:h_,useImperativeHandle:function(a,s,l){l=l!=null?l.concat([a]):null,hh(4194308,4,g_.bind(null,s,a),l)},useLayoutEffect:function(a,s){return hh(4194308,4,a,s)},useInsertionEffect:function(a,s){hh(4,2,a,s)},useMemo:function(a,s){var l=bn();s=s===void 0?null:s;var f=a();if(To){dt(!0);try{a()}finally{dt(!1)}}return l.memoizedState=[f,s],f},useReducer:function(a,s,l){var f=bn();if(l!==void 0){var m=l(s);if(To){dt(!0);try{l(s)}finally{dt(!1)}}}else m=s;return f.memoizedState=f.baseState=m,a={pending:null,lanes:0,dispatch:null,lastRenderedReducer:a,lastRenderedState:m},f.queue=a,a=a.dispatch=rC.bind(null,pt,a),[f.memoizedState,a]},useRef:function(a){var s=bn();return a={current:a},s.memoizedState=a},useState:function(a){a=Ap(a);var s=a.queue,l=C_.bind(null,pt,s);return s.dispatch=l,[a.memoizedState,l]},useDebugValue:Sp,useDeferredValue:function(a,s){var l=bn();return Cp(l,a,s)},useTransition:function(){var a=Ap(!1);return a=E_.bind(null,pt,a.queue,!0,!1),bn().memoizedState=a,[!1,a]},useSyncExternalStore:function(a,s,l){var f=pt,m=bn();if(Ut){if(l===void 0)throw Error(n(407));l=l()}else{if(l=s(),Zt===null)throw Error(n(349));(bt&124)!==0||$v(f,s,l)}m.memoizedState=l;var v={value:l,getSnapshot:s};return m.queue=v,h_(Zv.bind(null,f,v,a),[a]),f.flags|=2048,Rl(9,fh(),Qv.bind(null,f,v,l,s),null),l},useId:function(){var a=bn(),s=Zt.identifierPrefix;if(Ut){var l=_i,f=vi;l=(f&~(1<<32-Lt(f)-1)).toString(32)+l,s=""+s+"R"+l,l=lh++,0<l&&(s+="H"+l.toString(32)),s+=""}else l=$4++,s=""+s+"r"+l.toString(32)+"";return a.memoizedState=s},useHostTransitionStatus:kp,useFormState:o_,useActionState:o_,useOptimistic:function(a){var s=bn();s.memoizedState=s.baseState=a;var l={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return s.queue=l,s=bp.bind(null,pt,!0,l),l.dispatch=s,[a,s]},useMemoCache:yp,useCacheRefresh:function(){return bn().memoizedState=tC.bind(null,pt)}},I_={readContext:nn,use:ch,useCallback:__,useContext:nn,useEffect:d_,useImperativeHandle:v_,useInsertionEffect:p_,useLayoutEffect:m_,useMemo:x_,useReducer:uh,useRef:f_,useState:function(){return uh(Ei)},useDebugValue:Sp,useDeferredValue:function(a,s){var l=Er();return y_(l,Xt.memoizedState,a,s)},useTransition:function(){var a=uh(Ei)[0],s=Er().memoizedState;return[typeof a=="boolean"?a:$c(a),s]},useSyncExternalStore:Yv,useId:w_,useHostTransitionStatus:kp,useFormState:l_,useActionState:l_,useOptimistic:function(a,s){var l=Er();return t_(l,Xt,a,s)},useMemoCache:yp,useCacheRefresh:S_},nC={readContext:nn,use:ch,useCallback:__,useContext:nn,useEffect:d_,useImperativeHandle:v_,useInsertionEffect:p_,useLayoutEffect:m_,useMemo:x_,useReducer:Tp,useRef:f_,useState:function(){return Tp(Ei)},useDebugValue:Sp,useDeferredValue:function(a,s){var l=Er();return Xt===null?Cp(l,a,s):y_(l,Xt.memoizedState,a,s)},useTransition:function(){var a=Tp(Ei)[0],s=Er().memoizedState;return[typeof a=="boolean"?a:$c(a),s]},useSyncExternalStore:Yv,useId:w_,useHostTransitionStatus:kp,useFormState:u_,useActionState:u_,useOptimistic:function(a,s){var l=Er();return Xt!==null?t_(l,Xt,a,s):(l.baseState=a,[a,l.queue.dispatch])},useMemoCache:yp,useCacheRefresh:S_},kl=null,Jc=0;function mh(a){var s=Jc;return Jc+=1,kl===null&&(kl=[]),jv(kl,a,s)}function eu(a,s){s=s.props.ref,a.ref=s!==void 0?s:null}function gh(a,s){throw s.$$typeof===_?Error(n(525)):(a=Object.prototype.toString.call(s),Error(n(31,a==="[object Object]"?"object with keys {"+Object.keys(s).join(", ")+"}":a)))}function D_(a){var s=a._init;return s(a._payload)}function O_(a){function s(le,ae){if(a){var he=le.deletions;he===null?(le.deletions=[ae],le.flags|=16):he.push(ae)}}function l(le,ae){if(!a)return null;for(;ae!==null;)s(le,ae),ae=ae.sibling;return null}function f(le){for(var ae=new Map;le!==null;)le.key!==null?ae.set(le.key,le):ae.set(le.index,le),le=le.sibling;return ae}function m(le,ae){return le=gi(le,ae),le.index=0,le.sibling=null,le}function v(le,ae,he){return le.index=he,a?(he=le.alternate,he!==null?(he=he.index,he<ae?(le.flags|=67108866,ae):he):(le.flags|=67108866,ae)):(le.flags|=1048576,ae)}function b(le){return a&&le.alternate===null&&(le.flags|=67108866),le}function L(le,ae,he,Se){return ae===null||ae.tag!==6?(ae=$d(he,le.mode,Se),ae.return=le,ae):(ae=m(ae,he),ae.return=le,ae)}function J(le,ae,he,Se){var qe=he.type;return qe===w?Ae(le,ae,he.props.children,Se,he.key):ae!==null&&(ae.elementType===qe||typeof qe=="object"&&qe!==null&&qe.$$typeof===T&&D_(qe)===ae.type)?(ae=m(ae,he.props),eu(ae,he),ae.return=le,ae):(ae=Zf(he.type,he.key,he.props,null,le.mode,Se),eu(ae,he),ae.return=le,ae)}function pe(le,ae,he,Se){return ae===null||ae.tag!==4||ae.stateNode.containerInfo!==he.containerInfo||ae.stateNode.implementation!==he.implementation?(ae=Qd(he,le.mode,Se),ae.return=le,ae):(ae=m(ae,he.children||[]),ae.return=le,ae)}function Ae(le,ae,he,Se,qe){return ae===null||ae.tag!==7?(ae=po(he,le.mode,Se,qe),ae.return=le,ae):(ae=m(ae,he),ae.return=le,ae)}function Re(le,ae,he){if(typeof ae=="string"&&ae!==""||typeof ae=="number"||typeof ae=="bigint")return ae=$d(""+ae,le.mode,he),ae.return=le,ae;if(typeof ae=="object"&&ae!==null){switch(ae.$$typeof){case x:return he=Zf(ae.type,ae.key,ae.props,null,le.mode,he),eu(he,ae),he.return=le,he;case A:return ae=Qd(ae,le.mode,he),ae.return=le,ae;case T:var Se=ae._init;return ae=Se(ae._payload),Re(le,ae,he)}if(Ce(ae)||D(ae))return ae=po(ae,le.mode,he,null),ae.return=le,ae;if(typeof ae.then=="function")return Re(le,mh(ae),he);if(ae.$$typeof===P)return Re(le,rh(le,ae),he);gh(le,ae)}return null}function ve(le,ae,he,Se){var qe=ae!==null?ae.key:null;if(typeof he=="string"&&he!==""||typeof he=="number"||typeof he=="bigint")return qe!==null?null:L(le,ae,""+he,Se);if(typeof he=="object"&&he!==null){switch(he.$$typeof){case x:return he.key===qe?J(le,ae,he,Se):null;case A:return he.key===qe?pe(le,ae,he,Se):null;case T:return qe=he._init,he=qe(he._payload),ve(le,ae,he,Se)}if(Ce(he)||D(he))return qe!==null?null:Ae(le,ae,he,Se,null);if(typeof he.then=="function")return ve(le,ae,mh(he),Se);if(he.$$typeof===P)return ve(le,ae,rh(le,he),Se);gh(le,he)}return null}function _e(le,ae,he,Se,qe){if(typeof Se=="string"&&Se!==""||typeof Se=="number"||typeof Se=="bigint")return le=le.get(he)||null,L(ae,le,""+Se,qe);if(typeof Se=="object"&&Se!==null){switch(Se.$$typeof){case x:return le=le.get(Se.key===null?he:Se.key)||null,J(ae,le,Se,qe);case A:return le=le.get(Se.key===null?he:Se.key)||null,pe(ae,le,Se,qe);case T:var gt=Se._init;return Se=gt(Se._payload),_e(le,ae,he,Se,qe)}if(Ce(Se)||D(Se))return le=le.get(he)||null,Ae(ae,le,Se,qe,null);if(typeof Se.then=="function")return _e(le,ae,he,mh(Se),qe);if(Se.$$typeof===P)return _e(le,ae,he,rh(ae,Se),qe);gh(ae,Se)}return null}function it(le,ae,he,Se){for(var qe=null,gt=null,We=ae,et=ae=0,zr=null;We!==null&&et<he.length;et++){We.index>et?(zr=We,We=null):zr=We.sibling;var Mt=ve(le,We,he[et],Se);if(Mt===null){We===null&&(We=zr);break}a&&We&&Mt.alternate===null&&s(le,We),ae=v(Mt,ae,et),gt===null?qe=Mt:gt.sibling=Mt,gt=Mt,We=zr}if(et===he.length)return l(le,We),Ut&&go(le,et),qe;if(We===null){for(;et<he.length;et++)We=Re(le,he[et],Se),We!==null&&(ae=v(We,ae,et),gt===null?qe=We:gt.sibling=We,gt=We);return Ut&&go(le,et),qe}for(We=f(We);et<he.length;et++)zr=_e(We,le,et,he[et],Se),zr!==null&&(a&&zr.alternate!==null&&We.delete(zr.key===null?et:zr.key),ae=v(zr,ae,et),gt===null?qe=zr:gt.sibling=zr,gt=zr);return a&&We.forEach(function(gs){return s(le,gs)}),Ut&&go(le,et),qe}function Qe(le,ae,he,Se){if(he==null)throw Error(n(151));for(var qe=null,gt=null,We=ae,et=ae=0,zr=null,Mt=he.next();We!==null&&!Mt.done;et++,Mt=he.next()){We.index>et?(zr=We,We=null):zr=We.sibling;var gs=ve(le,We,Mt.value,Se);if(gs===null){We===null&&(We=zr);break}a&&We&&gs.alternate===null&&s(le,We),ae=v(gs,ae,et),gt===null?qe=gs:gt.sibling=gs,gt=gs,We=zr}if(Mt.done)return l(le,We),Ut&&go(le,et),qe;if(We===null){for(;!Mt.done;et++,Mt=he.next())Mt=Re(le,Mt.value,Se),Mt!==null&&(ae=v(Mt,ae,et),gt===null?qe=Mt:gt.sibling=Mt,gt=Mt);return Ut&&go(le,et),qe}for(We=f(We);!Mt.done;et++,Mt=he.next())Mt=_e(We,le,et,Mt.value,Se),Mt!==null&&(a&&Mt.alternate!==null&&We.delete(Mt.key===null?et:Mt.key),ae=v(Mt,ae,et),gt===null?qe=Mt:gt.sibling=Mt,gt=Mt);return a&&We.forEach(function(aR){return s(le,aR)}),Ut&&go(le,et),qe}function Yt(le,ae,he,Se){if(typeof he=="object"&&he!==null&&he.type===w&&he.key===null&&(he=he.props.children),typeof he=="object"&&he!==null){switch(he.$$typeof){case x:e:{for(var qe=he.key;ae!==null;){if(ae.key===qe){if(qe=he.type,qe===w){if(ae.tag===7){l(le,ae.sibling),Se=m(ae,he.props.children),Se.return=le,le=Se;break e}}else if(ae.elementType===qe||typeof qe=="object"&&qe!==null&&qe.$$typeof===T&&D_(qe)===ae.type){l(le,ae.sibling),Se=m(ae,he.props),eu(Se,he),Se.return=le,le=Se;break e}l(le,ae);break}else s(le,ae);ae=ae.sibling}he.type===w?(Se=po(he.props.children,le.mode,Se,he.key),Se.return=le,le=Se):(Se=Zf(he.type,he.key,he.props,null,le.mode,Se),eu(Se,he),Se.return=le,le=Se)}return b(le);case A:e:{for(qe=he.key;ae!==null;){if(ae.key===qe)if(ae.tag===4&&ae.stateNode.containerInfo===he.containerInfo&&ae.stateNode.implementation===he.implementation){l(le,ae.sibling),Se=m(ae,he.children||[]),Se.return=le,le=Se;break e}else{l(le,ae);break}else s(le,ae);ae=ae.sibling}Se=Qd(he,le.mode,Se),Se.return=le,le=Se}return b(le);case T:return qe=he._init,he=qe(he._payload),Yt(le,ae,he,Se)}if(Ce(he))return it(le,ae,he,Se);if(D(he)){if(qe=D(he),typeof qe!="function")throw Error(n(150));return he=qe.call(he),Qe(le,ae,he,Se)}if(typeof he.then=="function")return Yt(le,ae,mh(he),Se);if(he.$$typeof===P)return Yt(le,ae,rh(le,he),Se);gh(le,he)}return typeof he=="string"&&he!==""||typeof he=="number"||typeof he=="bigint"?(he=""+he,ae!==null&&ae.tag===6?(l(le,ae.sibling),Se=m(ae,he),Se.return=le,le=Se):(l(le,ae),Se=$d(he,le.mode,Se),Se.return=le,le=Se),b(le)):l(le,ae)}return function(le,ae,he,Se){try{Jc=0;var qe=Yt(le,ae,he,Se);return kl=null,qe}catch(We){if(We===Gc||We===ah)throw We;var gt=Vn(29,We,null,le.mode);return gt.lanes=Se,gt.return=le,gt}finally{}}}var bl=O_(!0),N_=O_(!1),ia=se(null),Ka=null;function ts(a){var s=a.alternate;j(Dr,Dr.current&1),j(ia,a),Ka===null&&(s===null||wl.current!==null||s.memoizedState!==null)&&(Ka=a)}function F_(a){if(a.tag===22){if(j(Dr,Dr.current),j(ia,a),Ka===null){var s=a.alternate;s!==null&&s.memoizedState!==null&&(Ka=a)}}else rs()}function rs(){j(Dr,Dr.current),j(ia,ia.current)}function Ti(a){M(ia),Ka===a&&(Ka=null),M(Dr)}var Dr=se(0);function vh(a){for(var s=a;s!==null;){if(s.tag===13){var l=s.memoizedState;if(l!==null&&(l=l.dehydrated,l===null||l.data==="$?"||xm(l)))return s}else if(s.tag===19&&s.memoizedProps.revealOrder!==void 0){if((s.flags&128)!==0)return s}else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===a)break;for(;s.sibling===null;){if(s.return===null||s.return===a)return null;s=s.return}s.sibling.return=s.return,s=s.sibling}return null}function Ip(a,s,l,f){s=a.memoizedState,l=l(f,s),l=l==null?s:g({},s,l),a.memoizedState=l,a.lanes===0&&(a.updateQueue.baseState=l)}var Dp={enqueueSetState:function(a,s,l){a=a._reactInternals;var f=zn(),m=Zi(f);m.payload=s,l!=null&&(m.callback=l),s=Ji(a,m,f),s!==null&&(Hn(s,a,f),Kc(s,a,f))},enqueueReplaceState:function(a,s,l){a=a._reactInternals;var f=zn(),m=Zi(f);m.tag=1,m.payload=s,l!=null&&(m.callback=l),s=Ji(a,m,f),s!==null&&(Hn(s,a,f),Kc(s,a,f))},enqueueForceUpdate:function(a,s){a=a._reactInternals;var l=zn(),f=Zi(l);f.tag=2,s!=null&&(f.callback=s),s=Ji(a,f,l),s!==null&&(Hn(s,a,l),Kc(s,a,l))}};function P_(a,s,l,f,m,v,b){return a=a.stateNode,typeof a.shouldComponentUpdate=="function"?a.shouldComponentUpdate(f,v,b):s.prototype&&s.prototype.isPureReactComponent?!Mc(l,f)||!Mc(m,v):!0}function M_(a,s,l,f){a=s.state,typeof s.componentWillReceiveProps=="function"&&s.componentWillReceiveProps(l,f),typeof s.UNSAFE_componentWillReceiveProps=="function"&&s.UNSAFE_componentWillReceiveProps(l,f),s.state!==a&&Dp.enqueueReplaceState(s,s.state,null)}function Ao(a,s){var l=s;if("ref"in s){l={};for(var f in s)f!=="ref"&&(l[f]=s[f])}if(a=a.defaultProps){l===s&&(l=g({},l));for(var m in a)l[m]===void 0&&(l[m]=a[m])}return l}var _h=typeof reportError=="function"?reportError:function(a){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var s=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof a=="object"&&a!==null&&typeof a.message=="string"?String(a.message):String(a),error:a});if(!window.dispatchEvent(s))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",a);return}console.error(a)};function L_(a){_h(a)}function V_(a){console.error(a)}function U_(a){_h(a)}function xh(a,s){try{var l=a.onUncaughtError;l(s.value,{componentStack:s.stack})}catch(f){setTimeout(function(){throw f})}}function B_(a,s,l){try{var f=a.onCaughtError;f(l.value,{componentStack:l.stack,errorBoundary:s.tag===1?s.stateNode:null})}catch(m){setTimeout(function(){throw m})}}function Op(a,s,l){return l=Zi(l),l.tag=3,l.payload={element:null},l.callback=function(){xh(a,s)},l}function j_(a){return a=Zi(a),a.tag=3,a}function z_(a,s,l,f){var m=l.type.getDerivedStateFromError;if(typeof m=="function"){var v=f.value;a.payload=function(){return m(v)},a.callback=function(){B_(s,l,f)}}var b=l.stateNode;b!==null&&typeof b.componentDidCatch=="function"&&(a.callback=function(){B_(s,l,f),typeof m!="function"&&(ls===null?ls=new Set([this]):ls.add(this));var L=f.stack;this.componentDidCatch(f.value,{componentStack:L!==null?L:""})})}function aC(a,s,l,f,m){if(l.flags|=32768,f!==null&&typeof f=="object"&&typeof f.then=="function"){if(s=l.alternate,s!==null&&jc(s,l,m,!0),l=ia.current,l!==null){switch(l.tag){case 13:return Ka===null?rm():l.alternate===null&&cr===0&&(cr=3),l.flags&=-257,l.flags|=65536,l.lanes=m,f===op?l.flags|=16384:(s=l.updateQueue,s===null?l.updateQueue=new Set([f]):s.add(f),am(a,f,m)),!1;case 22:return l.flags|=65536,f===op?l.flags|=16384:(s=l.updateQueue,s===null?(s={transitions:null,markerInstances:null,retryQueue:new Set([f])},l.updateQueue=s):(l=s.retryQueue,l===null?s.retryQueue=new Set([f]):l.add(f)),am(a,f,m)),!1}throw Error(n(435,l.tag))}return am(a,f,m),rm(),!1}if(Ut)return s=ia.current,s!==null?((s.flags&65536)===0&&(s.flags|=256),s.flags|=65536,s.lanes=m,f!==ep&&(a=Error(n(422),{cause:f}),Bc(ta(a,l)))):(f!==ep&&(s=Error(n(423),{cause:f}),Bc(ta(s,l))),a=a.current.alternate,a.flags|=65536,m&=-m,a.lanes|=m,f=ta(f,l),m=Op(a.stateNode,f,m),up(a,m),cr!==4&&(cr=2)),!1;var v=Error(n(520),{cause:f});if(v=ta(v,l),ou===null?ou=[v]:ou.push(v),cr!==4&&(cr=2),s===null)return!0;f=ta(f,l),l=s;do{switch(l.tag){case 3:return l.flags|=65536,a=m&-m,l.lanes|=a,a=Op(l.stateNode,f,a),up(l,a),!1;case 1:if(s=l.type,v=l.stateNode,(l.flags&128)===0&&(typeof s.getDerivedStateFromError=="function"||v!==null&&typeof v.componentDidCatch=="function"&&(ls===null||!ls.has(v))))return l.flags|=65536,m&=-m,l.lanes|=m,m=j_(m),z_(m,a,l,f),up(l,m),!1}l=l.return}while(l!==null);return!1}var H_=Error(n(461)),Br=!1;function Xr(a,s,l,f){s.child=a===null?N_(s,null,l,f):bl(s,a.child,l,f)}function G_(a,s,l,f,m){l=l.render;var v=s.ref;if("ref"in f){var b={};for(var L in f)L!=="ref"&&(b[L]=f[L])}else b=f;return yo(s),f=mp(a,s,l,b,v,m),L=gp(),a!==null&&!Br?(vp(a,s,m),Ai(a,s,m)):(Ut&&L&&Zd(s),s.flags|=1,Xr(a,s,f,m),s.child)}function q_(a,s,l,f,m){if(a===null){var v=l.type;return typeof v=="function"&&!Yd(v)&&v.defaultProps===void 0&&l.compare===null?(s.tag=15,s.type=v,K_(a,s,v,f,m)):(a=Zf(l.type,null,f,s,s.mode,m),a.ref=s.ref,a.return=s,s.child=a)}if(v=a.child,!Bp(a,m)){var b=v.memoizedProps;if(l=l.compare,l=l!==null?l:Mc,l(b,f)&&a.ref===s.ref)return Ai(a,s,m)}return s.flags|=1,a=gi(v,f),a.ref=s.ref,a.return=s,s.child=a}function K_(a,s,l,f,m){if(a!==null){var v=a.memoizedProps;if(Mc(v,f)&&a.ref===s.ref)if(Br=!1,s.pendingProps=f=v,Bp(a,m))(a.flags&131072)!==0&&(Br=!0);else return s.lanes=a.lanes,Ai(a,s,m)}return Np(a,s,l,f,m)}function X_(a,s,l){var f=s.pendingProps,m=f.children,v=a!==null?a.memoizedState:null;if(f.mode==="hidden"){if((s.flags&128)!==0){if(f=v!==null?v.baseLanes|l:l,a!==null){for(m=s.child=a.child,v=0;m!==null;)v=v|m.lanes|m.childLanes,m=m.sibling;s.childLanes=v&~f}else s.childLanes=0,s.child=null;return W_(a,s,f,l)}if((l&536870912)!==0)s.memoizedState={baseLanes:0,cachePool:null},a!==null&&nh(s,v!==null?v.cachePool:null),v!==null?Kv(s,v):hp(),F_(s);else return s.lanes=s.childLanes=536870912,W_(a,s,v!==null?v.baseLanes|l:l,l)}else v!==null?(nh(s,v.cachePool),Kv(s,v),rs(),s.memoizedState=null):(a!==null&&nh(s,null),hp(),rs());return Xr(a,s,m,l),s.child}function W_(a,s,l,f){var m=sp();return m=m===null?null:{parent:Ir._currentValue,pool:m},s.memoizedState={baseLanes:l,cachePool:m},a!==null&&nh(s,null),hp(),F_(s),a!==null&&jc(a,s,f,!0),null}function yh(a,s){var l=s.ref;if(l===null)a!==null&&a.ref!==null&&(s.flags|=4194816);else{if(typeof l!="function"&&typeof l!="object")throw Error(n(284));(a===null||a.ref!==l)&&(s.flags|=4194816)}}function Np(a,s,l,f,m){return yo(s),l=mp(a,s,l,f,void 0,m),f=gp(),a!==null&&!Br?(vp(a,s,m),Ai(a,s,m)):(Ut&&f&&Zd(s),s.flags|=1,Xr(a,s,l,m),s.child)}function Y_(a,s,l,f,m,v){return yo(s),s.updateQueue=null,l=Wv(s,f,l,m),Xv(a),f=gp(),a!==null&&!Br?(vp(a,s,v),Ai(a,s,v)):(Ut&&f&&Zd(s),s.flags|=1,Xr(a,s,l,v),s.child)}function $_(a,s,l,f,m){if(yo(s),s.stateNode===null){var v=xl,b=l.contextType;typeof b=="object"&&b!==null&&(v=nn(b)),v=new l(f,v),s.memoizedState=v.state!==null&&v.state!==void 0?v.state:null,v.updater=Dp,s.stateNode=v,v._reactInternals=s,v=s.stateNode,v.props=f,v.state=s.memoizedState,v.refs={},lp(s),b=l.contextType,v.context=typeof b=="object"&&b!==null?nn(b):xl,v.state=s.memoizedState,b=l.getDerivedStateFromProps,typeof b=="function"&&(Ip(s,l,b,f),v.state=s.memoizedState),typeof l.getDerivedStateFromProps=="function"||typeof v.getSnapshotBeforeUpdate=="function"||typeof v.UNSAFE_componentWillMount!="function"&&typeof v.componentWillMount!="function"||(b=v.state,typeof v.componentWillMount=="function"&&v.componentWillMount(),typeof v.UNSAFE_componentWillMount=="function"&&v.UNSAFE_componentWillMount(),b!==v.state&&Dp.enqueueReplaceState(v,v.state,null),Wc(s,f,v,m),Xc(),v.state=s.memoizedState),typeof v.componentDidMount=="function"&&(s.flags|=4194308),f=!0}else if(a===null){v=s.stateNode;var L=s.memoizedProps,J=Ao(l,L);v.props=J;var pe=v.context,Ae=l.contextType;b=xl,typeof Ae=="object"&&Ae!==null&&(b=nn(Ae));var Re=l.getDerivedStateFromProps;Ae=typeof Re=="function"||typeof v.getSnapshotBeforeUpdate=="function",L=s.pendingProps!==L,Ae||typeof v.UNSAFE_componentWillReceiveProps!="function"&&typeof v.componentWillReceiveProps!="function"||(L||pe!==b)&&M_(s,v,f,b),Qi=!1;var ve=s.memoizedState;v.state=ve,Wc(s,f,v,m),Xc(),pe=s.memoizedState,L||ve!==pe||Qi?(typeof Re=="function"&&(Ip(s,l,Re,f),pe=s.memoizedState),(J=Qi||P_(s,l,J,f,ve,pe,b))?(Ae||typeof v.UNSAFE_componentWillMount!="function"&&typeof v.componentWillMount!="function"||(typeof v.componentWillMount=="function"&&v.componentWillMount(),typeof v.UNSAFE_componentWillMount=="function"&&v.UNSAFE_componentWillMount()),typeof v.componentDidMount=="function"&&(s.flags|=4194308)):(typeof v.componentDidMount=="function"&&(s.flags|=4194308),s.memoizedProps=f,s.memoizedState=pe),v.props=f,v.state=pe,v.context=b,f=J):(typeof v.componentDidMount=="function"&&(s.flags|=4194308),f=!1)}else{v=s.stateNode,cp(a,s),b=s.memoizedProps,Ae=Ao(l,b),v.props=Ae,Re=s.pendingProps,ve=v.context,pe=l.contextType,J=xl,typeof pe=="object"&&pe!==null&&(J=nn(pe)),L=l.getDerivedStateFromProps,(pe=typeof L=="function"||typeof v.getSnapshotBeforeUpdate=="function")||typeof v.UNSAFE_componentWillReceiveProps!="function"&&typeof v.componentWillReceiveProps!="function"||(b!==Re||ve!==J)&&M_(s,v,f,J),Qi=!1,ve=s.memoizedState,v.state=ve,Wc(s,f,v,m),Xc();var _e=s.memoizedState;b!==Re||ve!==_e||Qi||a!==null&&a.dependencies!==null&&th(a.dependencies)?(typeof L=="function"&&(Ip(s,l,L,f),_e=s.memoizedState),(Ae=Qi||P_(s,l,Ae,f,ve,_e,J)||a!==null&&a.dependencies!==null&&th(a.dependencies))?(pe||typeof v.UNSAFE_componentWillUpdate!="function"&&typeof v.componentWillUpdate!="function"||(typeof v.componentWillUpdate=="function"&&v.componentWillUpdate(f,_e,J),typeof v.UNSAFE_componentWillUpdate=="function"&&v.UNSAFE_componentWillUpdate(f,_e,J)),typeof v.componentDidUpdate=="function"&&(s.flags|=4),typeof v.getSnapshotBeforeUpdate=="function"&&(s.flags|=1024)):(typeof v.componentDidUpdate!="function"||b===a.memoizedProps&&ve===a.memoizedState||(s.flags|=4),typeof v.getSnapshotBeforeUpdate!="function"||b===a.memoizedProps&&ve===a.memoizedState||(s.flags|=1024),s.memoizedProps=f,s.memoizedState=_e),v.props=f,v.state=_e,v.context=J,f=Ae):(typeof v.componentDidUpdate!="function"||b===a.memoizedProps&&ve===a.memoizedState||(s.flags|=4),typeof v.getSnapshotBeforeUpdate!="function"||b===a.memoizedProps&&ve===a.memoizedState||(s.flags|=1024),f=!1)}return v=f,yh(a,s),f=(s.flags&128)!==0,v||f?(v=s.stateNode,l=f&&typeof l.getDerivedStateFromError!="function"?null:v.render(),s.flags|=1,a!==null&&f?(s.child=bl(s,a.child,null,m),s.child=bl(s,null,l,m)):Xr(a,s,l,m),s.memoizedState=v.state,a=s.child):a=Ai(a,s,m),a}function Q_(a,s,l,f){return Uc(),s.flags|=256,Xr(a,s,l,f),s.child}var Fp={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Pp(a){return{baseLanes:a,cachePool:Vv()}}function Mp(a,s,l){return a=a!==null?a.childLanes&~l:0,s&&(a|=sa),a}function Z_(a,s,l){var f=s.pendingProps,m=!1,v=(s.flags&128)!==0,b;if((b=v)||(b=a!==null&&a.memoizedState===null?!1:(Dr.current&2)!==0),b&&(m=!0,s.flags&=-129),b=(s.flags&32)!==0,s.flags&=-33,a===null){if(Ut){if(m?ts(s):rs(),Ut){var L=lr,J;if(J=L){e:{for(J=L,L=qa;J.nodeType!==8;){if(!L){L=null;break e}if(J=Aa(J.nextSibling),J===null){L=null;break e}}L=J}L!==null?(s.memoizedState={dehydrated:L,treeContext:mo!==null?{id:vi,overflow:_i}:null,retryLane:536870912,hydrationErrors:null},J=Vn(18,null,null,0),J.stateNode=L,J.return=s,s.child=J,En=s,lr=null,J=!0):J=!1}J||_o(s)}if(L=s.memoizedState,L!==null&&(L=L.dehydrated,L!==null))return xm(L)?s.lanes=32:s.lanes=536870912,null;Ti(s)}return L=f.children,f=f.fallback,m?(rs(),m=s.mode,L=Eh({mode:"hidden",children:L},m),f=po(f,m,l,null),L.return=s,f.return=s,L.sibling=f,s.child=L,m=s.child,m.memoizedState=Pp(l),m.childLanes=Mp(a,b,l),s.memoizedState=Fp,f):(ts(s),Lp(s,L))}if(J=a.memoizedState,J!==null&&(L=J.dehydrated,L!==null)){if(v)s.flags&256?(ts(s),s.flags&=-257,s=Vp(a,s,l)):s.memoizedState!==null?(rs(),s.child=a.child,s.flags|=128,s=null):(rs(),m=f.fallback,L=s.mode,f=Eh({mode:"visible",children:f.children},L),m=po(m,L,l,null),m.flags|=2,f.return=s,m.return=s,f.sibling=m,s.child=f,bl(s,a.child,null,l),f=s.child,f.memoizedState=Pp(l),f.childLanes=Mp(a,b,l),s.memoizedState=Fp,s=m);else if(ts(s),xm(L)){if(b=L.nextSibling&&L.nextSibling.dataset,b)var pe=b.dgst;b=pe,f=Error(n(419)),f.stack="",f.digest=b,Bc({value:f,source:null,stack:null}),s=Vp(a,s,l)}else if(Br||jc(a,s,l,!1),b=(l&a.childLanes)!==0,Br||b){if(b=Zt,b!==null&&(f=l&-l,f=(f&42)!==0?1:Fa(f),f=(f&(b.suspendedLanes|l))!==0?0:f,f!==0&&f!==J.retryLane))throw J.retryLane=f,_l(a,f),Hn(b,a,f),H_;L.data==="$?"||rm(),s=Vp(a,s,l)}else L.data==="$?"?(s.flags|=192,s.child=a.child,s=null):(a=J.treeContext,lr=Aa(L.nextSibling),En=s,Ut=!0,vo=null,qa=!1,a!==null&&(na[aa++]=vi,na[aa++]=_i,na[aa++]=mo,vi=a.id,_i=a.overflow,mo=s),s=Lp(s,f.children),s.flags|=4096);return s}return m?(rs(),m=f.fallback,L=s.mode,J=a.child,pe=J.sibling,f=gi(J,{mode:"hidden",children:f.children}),f.subtreeFlags=J.subtreeFlags&65011712,pe!==null?m=gi(pe,m):(m=po(m,L,l,null),m.flags|=2),m.return=s,f.return=s,f.sibling=m,s.child=f,f=m,m=s.child,L=a.child.memoizedState,L===null?L=Pp(l):(J=L.cachePool,J!==null?(pe=Ir._currentValue,J=J.parent!==pe?{parent:pe,pool:pe}:J):J=Vv(),L={baseLanes:L.baseLanes|l,cachePool:J}),m.memoizedState=L,m.childLanes=Mp(a,b,l),s.memoizedState=Fp,f):(ts(s),l=a.child,a=l.sibling,l=gi(l,{mode:"visible",children:f.children}),l.return=s,l.sibling=null,a!==null&&(b=s.deletions,b===null?(s.deletions=[a],s.flags|=16):b.push(a)),s.child=l,s.memoizedState=null,l)}function Lp(a,s){return s=Eh({mode:"visible",children:s},a.mode),s.return=a,a.child=s}function Eh(a,s){return a=Vn(22,a,null,s),a.lanes=0,a.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},a}function Vp(a,s,l){return bl(s,a.child,null,l),a=Lp(s,s.pendingProps.children),a.flags|=2,s.memoizedState=null,a}function J_(a,s,l){a.lanes|=s;var f=a.alternate;f!==null&&(f.lanes|=s),rp(a.return,s,l)}function Up(a,s,l,f,m){var v=a.memoizedState;v===null?a.memoizedState={isBackwards:s,rendering:null,renderingStartTime:0,last:f,tail:l,tailMode:m}:(v.isBackwards=s,v.rendering=null,v.renderingStartTime=0,v.last=f,v.tail=l,v.tailMode=m)}function ex(a,s,l){var f=s.pendingProps,m=f.revealOrder,v=f.tail;if(Xr(a,s,f.children,l),f=Dr.current,(f&2)!==0)f=f&1|2,s.flags|=128;else{if(a!==null&&(a.flags&128)!==0)e:for(a=s.child;a!==null;){if(a.tag===13)a.memoizedState!==null&&J_(a,l,s);else if(a.tag===19)J_(a,l,s);else if(a.child!==null){a.child.return=a,a=a.child;continue}if(a===s)break e;for(;a.sibling===null;){if(a.return===null||a.return===s)break e;a=a.return}a.sibling.return=a.return,a=a.sibling}f&=1}switch(j(Dr,f),m){case"forwards":for(l=s.child,m=null;l!==null;)a=l.alternate,a!==null&&vh(a)===null&&(m=l),l=l.sibling;l=m,l===null?(m=s.child,s.child=null):(m=l.sibling,l.sibling=null),Up(s,!1,m,l,v);break;case"backwards":for(l=null,m=s.child,s.child=null;m!==null;){if(a=m.alternate,a!==null&&vh(a)===null){s.child=m;break}a=m.sibling,m.sibling=l,l=m,m=a}Up(s,!0,l,null,v);break;case"together":Up(s,!1,null,null,void 0);break;default:s.memoizedState=null}return s.child}function Ai(a,s,l){if(a!==null&&(s.dependencies=a.dependencies),os|=s.lanes,(l&s.childLanes)===0)if(a!==null){if(jc(a,s,l,!1),(l&s.childLanes)===0)return null}else return null;if(a!==null&&s.child!==a.child)throw Error(n(153));if(s.child!==null){for(a=s.child,l=gi(a,a.pendingProps),s.child=l,l.return=s;a.sibling!==null;)a=a.sibling,l=l.sibling=gi(a,a.pendingProps),l.return=s;l.sibling=null}return s.child}function Bp(a,s){return(a.lanes&s)!==0?!0:(a=a.dependencies,!!(a!==null&&th(a)))}function iC(a,s,l){switch(s.tag){case 3:Ee(s,s.stateNode.containerInfo),$i(s,Ir,a.memoizedState.cache),Uc();break;case 27:case 5:Te(s);break;case 4:Ee(s,s.stateNode.containerInfo);break;case 10:$i(s,s.type,s.memoizedProps.value);break;case 13:var f=s.memoizedState;if(f!==null)return f.dehydrated!==null?(ts(s),s.flags|=128,null):(l&s.child.childLanes)!==0?Z_(a,s,l):(ts(s),a=Ai(a,s,l),a!==null?a.sibling:null);ts(s);break;case 19:var m=(a.flags&128)!==0;if(f=(l&s.childLanes)!==0,f||(jc(a,s,l,!1),f=(l&s.childLanes)!==0),m){if(f)return ex(a,s,l);s.flags|=128}if(m=s.memoizedState,m!==null&&(m.rendering=null,m.tail=null,m.lastEffect=null),j(Dr,Dr.current),f)break;return null;case 22:case 23:return s.lanes=0,X_(a,s,l);case 24:$i(s,Ir,a.memoizedState.cache)}return Ai(a,s,l)}function tx(a,s,l){if(a!==null)if(a.memoizedProps!==s.pendingProps)Br=!0;else{if(!Bp(a,l)&&(s.flags&128)===0)return Br=!1,iC(a,s,l);Br=(a.flags&131072)!==0}else Br=!1,Ut&&(s.flags&1048576)!==0&&Dv(s,eh,s.index);switch(s.lanes=0,s.tag){case 16:e:{a=s.pendingProps;var f=s.elementType,m=f._init;if(f=m(f._payload),s.type=f,typeof f=="function")Yd(f)?(a=Ao(f,a),s.tag=1,s=$_(null,s,f,a,l)):(s.tag=0,s=Np(null,s,f,a,l));else{if(f!=null){if(m=f.$$typeof,m===re){s.tag=11,s=G_(null,s,f,a,l);break e}else if(m===k){s.tag=14,s=q_(null,s,f,a,l);break e}}throw s=Fe(f)||f,Error(n(306,s,""))}}return s;case 0:return Np(a,s,s.type,s.pendingProps,l);case 1:return f=s.type,m=Ao(f,s.pendingProps),$_(a,s,f,m,l);case 3:e:{if(Ee(s,s.stateNode.containerInfo),a===null)throw Error(n(387));f=s.pendingProps;var v=s.memoizedState;m=v.element,cp(a,s),Wc(s,f,null,l);var b=s.memoizedState;if(f=b.cache,$i(s,Ir,f),f!==v.cache&&np(s,[Ir],l,!0),Xc(),f=b.element,v.isDehydrated)if(v={element:f,isDehydrated:!1,cache:b.cache},s.updateQueue.baseState=v,s.memoizedState=v,s.flags&256){s=Q_(a,s,f,l);break e}else if(f!==m){m=ta(Error(n(424)),s),Bc(m),s=Q_(a,s,f,l);break e}else{switch(a=s.stateNode.containerInfo,a.nodeType){case 9:a=a.body;break;default:a=a.nodeName==="HTML"?a.ownerDocument.body:a}for(lr=Aa(a.firstChild),En=s,Ut=!0,vo=null,qa=!0,l=N_(s,null,f,l),s.child=l;l;)l.flags=l.flags&-3|4096,l=l.sibling}else{if(Uc(),f===m){s=Ai(a,s,l);break e}Xr(a,s,f,l)}s=s.child}return s;case 26:return yh(a,s),a===null?(l=iy(s.type,null,s.pendingProps,null))?s.memoizedState=l:Ut||(l=s.type,a=s.pendingProps,f=Ph(ue.current).createElement(l),f[hr]=s,f[nr]=a,Yr(f,l,a),ce(f),s.stateNode=f):s.memoizedState=iy(s.type,a.memoizedProps,s.pendingProps,a.memoizedState),null;case 27:return Te(s),a===null&&Ut&&(f=s.stateNode=ry(s.type,s.pendingProps,ue.current),En=s,qa=!0,m=lr,fs(s.type)?(ym=m,lr=Aa(f.firstChild)):lr=m),Xr(a,s,s.pendingProps.children,l),yh(a,s),a===null&&(s.flags|=4194304),s.child;case 5:return a===null&&Ut&&((m=f=lr)&&(f=NC(f,s.type,s.pendingProps,qa),f!==null?(s.stateNode=f,En=s,lr=Aa(f.firstChild),qa=!1,m=!0):m=!1),m||_o(s)),Te(s),m=s.type,v=s.pendingProps,b=a!==null?a.memoizedProps:null,f=v.children,gm(m,v)?f=null:b!==null&&gm(m,b)&&(s.flags|=32),s.memoizedState!==null&&(m=mp(a,s,Q4,null,null,l),gu._currentValue=m),yh(a,s),Xr(a,s,f,l),s.child;case 6:return a===null&&Ut&&((a=l=lr)&&(l=FC(l,s.pendingProps,qa),l!==null?(s.stateNode=l,En=s,lr=null,a=!0):a=!1),a||_o(s)),null;case 13:return Z_(a,s,l);case 4:return Ee(s,s.stateNode.containerInfo),f=s.pendingProps,a===null?s.child=bl(s,null,f,l):Xr(a,s,f,l),s.child;case 11:return G_(a,s,s.type,s.pendingProps,l);case 7:return Xr(a,s,s.pendingProps,l),s.child;case 8:return Xr(a,s,s.pendingProps.children,l),s.child;case 12:return Xr(a,s,s.pendingProps.children,l),s.child;case 10:return f=s.pendingProps,$i(s,s.type,f.value),Xr(a,s,f.children,l),s.child;case 9:return m=s.type._context,f=s.pendingProps.children,yo(s),m=nn(m),f=f(m),s.flags|=1,Xr(a,s,f,l),s.child;case 14:return q_(a,s,s.type,s.pendingProps,l);case 15:return K_(a,s,s.type,s.pendingProps,l);case 19:return ex(a,s,l);case 31:return f=s.pendingProps,l=s.mode,f={mode:f.mode,children:f.children},a===null?(l=Eh(f,l),l.ref=s.ref,s.child=l,l.return=s,s=l):(l=gi(a.child,f),l.ref=s.ref,s.child=l,l.return=s,s=l),s;case 22:return X_(a,s,l);case 24:return yo(s),f=nn(Ir),a===null?(m=sp(),m===null&&(m=Zt,v=ap(),m.pooledCache=v,v.refCount++,v!==null&&(m.pooledCacheLanes|=l),m=v),s.memoizedState={parent:f,cache:m},lp(s),$i(s,Ir,m)):((a.lanes&l)!==0&&(cp(a,s),Wc(s,null,null,l),Xc()),m=a.memoizedState,v=s.memoizedState,m.parent!==f?(m={parent:f,cache:f},s.memoizedState=m,s.lanes===0&&(s.memoizedState=s.updateQueue.baseState=m),$i(s,Ir,f)):(f=v.cache,$i(s,Ir,f),f!==m.cache&&np(s,[Ir],l,!0))),Xr(a,s,s.pendingProps.children,l),s.child;case 29:throw s.pendingProps}throw Error(n(156,s.tag))}function wi(a){a.flags|=4}function rx(a,s){if(s.type!=="stylesheet"||(s.state.loading&4)!==0)a.flags&=-16777217;else if(a.flags|=16777216,!uy(s)){if(s=ia.current,s!==null&&((bt&4194048)===bt?Ka!==null:(bt&62914560)!==bt&&(bt&536870912)===0||s!==Ka))throw qc=op,Uv;a.flags|=8192}}function Th(a,s){s!==null&&(a.flags|=4),a.flags&16384&&(s=a.tag!==22?Ki():536870912,a.lanes|=s,Nl|=s)}function tu(a,s){if(!Ut)switch(a.tailMode){case"hidden":s=a.tail;for(var l=null;s!==null;)s.alternate!==null&&(l=s),s=s.sibling;l===null?a.tail=null:l.sibling=null;break;case"collapsed":l=a.tail;for(var f=null;l!==null;)l.alternate!==null&&(f=l),l=l.sibling;f===null?s||a.tail===null?a.tail=null:a.tail.sibling=null:f.sibling=null}}function sr(a){var s=a.alternate!==null&&a.alternate.child===a.child,l=0,f=0;if(s)for(var m=a.child;m!==null;)l|=m.lanes|m.childLanes,f|=m.subtreeFlags&65011712,f|=m.flags&65011712,m.return=a,m=m.sibling;else for(m=a.child;m!==null;)l|=m.lanes|m.childLanes,f|=m.subtreeFlags,f|=m.flags,m.return=a,m=m.sibling;return a.subtreeFlags|=f,a.childLanes=l,s}function sC(a,s,l){var f=s.pendingProps;switch(Jd(s),s.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return sr(s),null;case 1:return sr(s),null;case 3:return l=s.stateNode,f=null,a!==null&&(f=a.memoizedState.cache),s.memoizedState.cache!==f&&(s.flags|=2048),yi(Ir),we(),l.pendingContext&&(l.context=l.pendingContext,l.pendingContext=null),(a===null||a.child===null)&&(Vc(s)?wi(s):a===null||a.memoizedState.isDehydrated&&(s.flags&256)===0||(s.flags|=1024,Fv())),sr(s),null;case 26:return l=s.memoizedState,a===null?(wi(s),l!==null?(sr(s),rx(s,l)):(sr(s),s.flags&=-16777217)):l?l!==a.memoizedState?(wi(s),sr(s),rx(s,l)):(sr(s),s.flags&=-16777217):(a.memoizedProps!==f&&wi(s),sr(s),s.flags&=-16777217),null;case 27:Ue(s),l=ue.current;var m=s.type;if(a!==null&&s.stateNode!=null)a.memoizedProps!==f&&wi(s);else{if(!f){if(s.stateNode===null)throw Error(n(166));return sr(s),null}a=Y.current,Vc(s)?Ov(s):(a=ry(m,f,l),s.stateNode=a,wi(s))}return sr(s),null;case 5:if(Ue(s),l=s.type,a!==null&&s.stateNode!=null)a.memoizedProps!==f&&wi(s);else{if(!f){if(s.stateNode===null)throw Error(n(166));return sr(s),null}if(a=Y.current,Vc(s))Ov(s);else{switch(m=Ph(ue.current),a){case 1:a=m.createElementNS("http://www.w3.org/2000/svg",l);break;case 2:a=m.createElementNS("http://www.w3.org/1998/Math/MathML",l);break;default:switch(l){case"svg":a=m.createElementNS("http://www.w3.org/2000/svg",l);break;case"math":a=m.createElementNS("http://www.w3.org/1998/Math/MathML",l);break;case"script":a=m.createElement("div"),a.innerHTML="<script><\/script>",a=a.removeChild(a.firstChild);break;case"select":a=typeof f.is=="string"?m.createElement("select",{is:f.is}):m.createElement("select"),f.multiple?a.multiple=!0:f.size&&(a.size=f.size);break;default:a=typeof f.is=="string"?m.createElement(l,{is:f.is}):m.createElement(l)}}a[hr]=s,a[nr]=f;e:for(m=s.child;m!==null;){if(m.tag===5||m.tag===6)a.appendChild(m.stateNode);else if(m.tag!==4&&m.tag!==27&&m.child!==null){m.child.return=m,m=m.child;continue}if(m===s)break e;for(;m.sibling===null;){if(m.return===null||m.return===s)break e;m=m.return}m.sibling.return=m.return,m=m.sibling}s.stateNode=a;e:switch(Yr(a,l,f),l){case"button":case"input":case"select":case"textarea":a=!!f.autoFocus;break e;case"img":a=!0;break e;default:a=!1}a&&wi(s)}}return sr(s),s.flags&=-16777217,null;case 6:if(a&&s.stateNode!=null)a.memoizedProps!==f&&wi(s);else{if(typeof f!="string"&&s.stateNode===null)throw Error(n(166));if(a=ue.current,Vc(s)){if(a=s.stateNode,l=s.memoizedProps,f=null,m=En,m!==null)switch(m.tag){case 27:case 5:f=m.memoizedProps}a[hr]=s,a=!!(a.nodeValue===l||f!==null&&f.suppressHydrationWarning===!0||Yx(a.nodeValue,l)),a||_o(s)}else a=Ph(a).createTextNode(f),a[hr]=s,s.stateNode=a}return sr(s),null;case 13:if(f=s.memoizedState,a===null||a.memoizedState!==null&&a.memoizedState.dehydrated!==null){if(m=Vc(s),f!==null&&f.dehydrated!==null){if(a===null){if(!m)throw Error(n(318));if(m=s.memoizedState,m=m!==null?m.dehydrated:null,!m)throw Error(n(317));m[hr]=s}else Uc(),(s.flags&128)===0&&(s.memoizedState=null),s.flags|=4;sr(s),m=!1}else m=Fv(),a!==null&&a.memoizedState!==null&&(a.memoizedState.hydrationErrors=m),m=!0;if(!m)return s.flags&256?(Ti(s),s):(Ti(s),null)}if(Ti(s),(s.flags&128)!==0)return s.lanes=l,s;if(l=f!==null,a=a!==null&&a.memoizedState!==null,l){f=s.child,m=null,f.alternate!==null&&f.alternate.memoizedState!==null&&f.alternate.memoizedState.cachePool!==null&&(m=f.alternate.memoizedState.cachePool.pool);var v=null;f.memoizedState!==null&&f.memoizedState.cachePool!==null&&(v=f.memoizedState.cachePool.pool),v!==m&&(f.flags|=2048)}return l!==a&&l&&(s.child.flags|=8192),Th(s,s.updateQueue),sr(s),null;case 4:return we(),a===null&&fm(s.stateNode.containerInfo),sr(s),null;case 10:return yi(s.type),sr(s),null;case 19:if(M(Dr),m=s.memoizedState,m===null)return sr(s),null;if(f=(s.flags&128)!==0,v=m.rendering,v===null)if(f)tu(m,!1);else{if(cr!==0||a!==null&&(a.flags&128)!==0)for(a=s.child;a!==null;){if(v=vh(a),v!==null){for(s.flags|=128,tu(m,!1),a=v.updateQueue,s.updateQueue=a,Th(s,a),s.subtreeFlags=0,a=l,l=s.child;l!==null;)Iv(l,a),l=l.sibling;return j(Dr,Dr.current&1|2),s.child}a=a.sibling}m.tail!==null&&Ne()>Sh&&(s.flags|=128,f=!0,tu(m,!1),s.lanes=4194304)}else{if(!f)if(a=vh(v),a!==null){if(s.flags|=128,f=!0,a=a.updateQueue,s.updateQueue=a,Th(s,a),tu(m,!0),m.tail===null&&m.tailMode==="hidden"&&!v.alternate&&!Ut)return sr(s),null}else 2*Ne()-m.renderingStartTime>Sh&&l!==536870912&&(s.flags|=128,f=!0,tu(m,!1),s.lanes=4194304);m.isBackwards?(v.sibling=s.child,s.child=v):(a=m.last,a!==null?a.sibling=v:s.child=v,m.last=v)}return m.tail!==null?(s=m.tail,m.rendering=s,m.tail=s.sibling,m.renderingStartTime=Ne(),s.sibling=null,a=Dr.current,j(Dr,f?a&1|2:a&1),s):(sr(s),null);case 22:case 23:return Ti(s),dp(),f=s.memoizedState!==null,a!==null?a.memoizedState!==null!==f&&(s.flags|=8192):f&&(s.flags|=8192),f?(l&536870912)!==0&&(s.flags&128)===0&&(sr(s),s.subtreeFlags&6&&(s.flags|=8192)):sr(s),l=s.updateQueue,l!==null&&Th(s,l.retryQueue),l=null,a!==null&&a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(l=a.memoizedState.cachePool.pool),f=null,s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(f=s.memoizedState.cachePool.pool),f!==l&&(s.flags|=2048),a!==null&&M(Eo),null;case 24:return l=null,a!==null&&(l=a.memoizedState.cache),s.memoizedState.cache!==l&&(s.flags|=2048),yi(Ir),sr(s),null;case 25:return null;case 30:return null}throw Error(n(156,s.tag))}function oC(a,s){switch(Jd(s),s.tag){case 1:return a=s.flags,a&65536?(s.flags=a&-65537|128,s):null;case 3:return yi(Ir),we(),a=s.flags,(a&65536)!==0&&(a&128)===0?(s.flags=a&-65537|128,s):null;case 26:case 27:case 5:return Ue(s),null;case 13:if(Ti(s),a=s.memoizedState,a!==null&&a.dehydrated!==null){if(s.alternate===null)throw Error(n(340));Uc()}return a=s.flags,a&65536?(s.flags=a&-65537|128,s):null;case 19:return M(Dr),null;case 4:return we(),null;case 10:return yi(s.type),null;case 22:case 23:return Ti(s),dp(),a!==null&&M(Eo),a=s.flags,a&65536?(s.flags=a&-65537|128,s):null;case 24:return yi(Ir),null;case 25:return null;default:return null}}function nx(a,s){switch(Jd(s),s.tag){case 3:yi(Ir),we();break;case 26:case 27:case 5:Ue(s);break;case 4:we();break;case 13:Ti(s);break;case 19:M(Dr);break;case 10:yi(s.type);break;case 22:case 23:Ti(s),dp(),a!==null&&M(Eo);break;case 24:yi(Ir)}}function ru(a,s){try{var l=s.updateQueue,f=l!==null?l.lastEffect:null;if(f!==null){var m=f.next;l=m;do{if((l.tag&a)===a){f=void 0;var v=l.create,b=l.inst;f=v(),b.destroy=f}l=l.next}while(l!==m)}}catch(L){$t(s,s.return,L)}}function ns(a,s,l){try{var f=s.updateQueue,m=f!==null?f.lastEffect:null;if(m!==null){var v=m.next;f=v;do{if((f.tag&a)===a){var b=f.inst,L=b.destroy;if(L!==void 0){b.destroy=void 0,m=s;var J=l,pe=L;try{pe()}catch(Ae){$t(m,J,Ae)}}}f=f.next}while(f!==v)}}catch(Ae){$t(s,s.return,Ae)}}function ax(a){var s=a.updateQueue;if(s!==null){var l=a.stateNode;try{qv(s,l)}catch(f){$t(a,a.return,f)}}}function ix(a,s,l){l.props=Ao(a.type,a.memoizedProps),l.state=a.memoizedState;try{l.componentWillUnmount()}catch(f){$t(a,s,f)}}function nu(a,s){try{var l=a.ref;if(l!==null){switch(a.tag){case 26:case 27:case 5:var f=a.stateNode;break;case 30:f=a.stateNode;break;default:f=a.stateNode}typeof l=="function"?a.refCleanup=l(f):l.current=f}}catch(m){$t(a,s,m)}}function Xa(a,s){var l=a.ref,f=a.refCleanup;if(l!==null)if(typeof f=="function")try{f()}catch(m){$t(a,s,m)}finally{a.refCleanup=null,a=a.alternate,a!=null&&(a.refCleanup=null)}else if(typeof l=="function")try{l(null)}catch(m){$t(a,s,m)}else l.current=null}function sx(a){var s=a.type,l=a.memoizedProps,f=a.stateNode;try{e:switch(s){case"button":case"input":case"select":case"textarea":l.autoFocus&&f.focus();break e;case"img":l.src?f.src=l.src:l.srcSet&&(f.srcset=l.srcSet)}}catch(m){$t(a,a.return,m)}}function jp(a,s,l){try{var f=a.stateNode;kC(f,a.type,l,s),f[nr]=s}catch(m){$t(a,a.return,m)}}function ox(a){return a.tag===5||a.tag===3||a.tag===26||a.tag===27&&fs(a.type)||a.tag===4}function zp(a){e:for(;;){for(;a.sibling===null;){if(a.return===null||ox(a.return))return null;a=a.return}for(a.sibling.return=a.return,a=a.sibling;a.tag!==5&&a.tag!==6&&a.tag!==18;){if(a.tag===27&&fs(a.type)||a.flags&2||a.child===null||a.tag===4)continue e;a.child.return=a,a=a.child}if(!(a.flags&2))return a.stateNode}}function Hp(a,s,l){var f=a.tag;if(f===5||f===6)a=a.stateNode,s?(l.nodeType===9?l.body:l.nodeName==="HTML"?l.ownerDocument.body:l).insertBefore(a,s):(s=l.nodeType===9?l.body:l.nodeName==="HTML"?l.ownerDocument.body:l,s.appendChild(a),l=l._reactRootContainer,l!=null||s.onclick!==null||(s.onclick=Fh));else if(f!==4&&(f===27&&fs(a.type)&&(l=a.stateNode,s=null),a=a.child,a!==null))for(Hp(a,s,l),a=a.sibling;a!==null;)Hp(a,s,l),a=a.sibling}function Ah(a,s,l){var f=a.tag;if(f===5||f===6)a=a.stateNode,s?l.insertBefore(a,s):l.appendChild(a);else if(f!==4&&(f===27&&fs(a.type)&&(l=a.stateNode),a=a.child,a!==null))for(Ah(a,s,l),a=a.sibling;a!==null;)Ah(a,s,l),a=a.sibling}function lx(a){var s=a.stateNode,l=a.memoizedProps;try{for(var f=a.type,m=s.attributes;m.length;)s.removeAttributeNode(m[0]);Yr(s,f,l),s[hr]=a,s[nr]=l}catch(v){$t(a,a.return,v)}}var Si=!1,pr=!1,Gp=!1,cx=typeof WeakSet=="function"?WeakSet:Set,jr=null;function lC(a,s){if(a=a.containerInfo,pm=jh,a=yv(a),zd(a)){if("selectionStart"in a)var l={start:a.selectionStart,end:a.selectionEnd};else e:{l=(l=a.ownerDocument)&&l.defaultView||window;var f=l.getSelection&&l.getSelection();if(f&&f.rangeCount!==0){l=f.anchorNode;var m=f.anchorOffset,v=f.focusNode;f=f.focusOffset;try{l.nodeType,v.nodeType}catch{l=null;break e}var b=0,L=-1,J=-1,pe=0,Ae=0,Re=a,ve=null;t:for(;;){for(var _e;Re!==l||m!==0&&Re.nodeType!==3||(L=b+m),Re!==v||f!==0&&Re.nodeType!==3||(J=b+f),Re.nodeType===3&&(b+=Re.nodeValue.length),(_e=Re.firstChild)!==null;)ve=Re,Re=_e;for(;;){if(Re===a)break t;if(ve===l&&++pe===m&&(L=b),ve===v&&++Ae===f&&(J=b),(_e=Re.nextSibling)!==null)break;Re=ve,ve=Re.parentNode}Re=_e}l=L===-1||J===-1?null:{start:L,end:J}}else l=null}l=l||{start:0,end:0}}else l=null;for(mm={focusedElem:a,selectionRange:l},jh=!1,jr=s;jr!==null;)if(s=jr,a=s.child,(s.subtreeFlags&1024)!==0&&a!==null)a.return=s,jr=a;else for(;jr!==null;){switch(s=jr,v=s.alternate,a=s.flags,s.tag){case 0:break;case 11:case 15:break;case 1:if((a&1024)!==0&&v!==null){a=void 0,l=s,m=v.memoizedProps,v=v.memoizedState,f=l.stateNode;try{var it=Ao(l.type,m,l.elementType===l.type);a=f.getSnapshotBeforeUpdate(it,v),f.__reactInternalSnapshotBeforeUpdate=a}catch(Qe){$t(l,l.return,Qe)}}break;case 3:if((a&1024)!==0){if(a=s.stateNode.containerInfo,l=a.nodeType,l===9)_m(a);else if(l===1)switch(a.nodeName){case"HEAD":case"HTML":case"BODY":_m(a);break;default:a.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((a&1024)!==0)throw Error(n(163))}if(a=s.sibling,a!==null){a.return=s.return,jr=a;break}jr=s.return}}function ux(a,s,l){var f=l.flags;switch(l.tag){case 0:case 11:case 15:as(a,l),f&4&&ru(5,l);break;case 1:if(as(a,l),f&4)if(a=l.stateNode,s===null)try{a.componentDidMount()}catch(b){$t(l,l.return,b)}else{var m=Ao(l.type,s.memoizedProps);s=s.memoizedState;try{a.componentDidUpdate(m,s,a.__reactInternalSnapshotBeforeUpdate)}catch(b){$t(l,l.return,b)}}f&64&&ax(l),f&512&&nu(l,l.return);break;case 3:if(as(a,l),f&64&&(a=l.updateQueue,a!==null)){if(s=null,l.child!==null)switch(l.child.tag){case 27:case 5:s=l.child.stateNode;break;case 1:s=l.child.stateNode}try{qv(a,s)}catch(b){$t(l,l.return,b)}}break;case 27:s===null&&f&4&&lx(l);case 26:case 5:as(a,l),s===null&&f&4&&sx(l),f&512&&nu(l,l.return);break;case 12:as(a,l);break;case 13:as(a,l),f&4&&dx(a,l),f&64&&(a=l.memoizedState,a!==null&&(a=a.dehydrated,a!==null&&(l=vC.bind(null,l),PC(a,l))));break;case 22:if(f=l.memoizedState!==null||Si,!f){s=s!==null&&s.memoizedState!==null||pr,m=Si;var v=pr;Si=f,(pr=s)&&!v?is(a,l,(l.subtreeFlags&8772)!==0):as(a,l),Si=m,pr=v}break;case 30:break;default:as(a,l)}}function fx(a){var s=a.alternate;s!==null&&(a.alternate=null,fx(s)),a.child=null,a.deletions=null,a.sibling=null,a.tag===5&&(s=a.stateNode,s!==null&&B(s)),a.stateNode=null,a.return=null,a.dependencies=null,a.memoizedProps=null,a.memoizedState=null,a.pendingProps=null,a.stateNode=null,a.updateQueue=null}var ar=null,In=!1;function Ci(a,s,l){for(l=l.child;l!==null;)hx(a,s,l),l=l.sibling}function hx(a,s,l){if(Je&&typeof Je.onCommitFiberUnmount=="function")try{Je.onCommitFiberUnmount(Ze,l)}catch{}switch(l.tag){case 26:pr||Xa(l,s),Ci(a,s,l),l.memoizedState?l.memoizedState.count--:l.stateNode&&(l=l.stateNode,l.parentNode.removeChild(l));break;case 27:pr||Xa(l,s);var f=ar,m=In;fs(l.type)&&(ar=l.stateNode,In=!1),Ci(a,s,l),hu(l.stateNode),ar=f,In=m;break;case 5:pr||Xa(l,s);case 6:if(f=ar,m=In,ar=null,Ci(a,s,l),ar=f,In=m,ar!==null)if(In)try{(ar.nodeType===9?ar.body:ar.nodeName==="HTML"?ar.ownerDocument.body:ar).removeChild(l.stateNode)}catch(v){$t(l,s,v)}else try{ar.removeChild(l.stateNode)}catch(v){$t(l,s,v)}break;case 18:ar!==null&&(In?(a=ar,ey(a.nodeType===9?a.body:a.nodeName==="HTML"?a.ownerDocument.body:a,l.stateNode),yu(a)):ey(ar,l.stateNode));break;case 4:f=ar,m=In,ar=l.stateNode.containerInfo,In=!0,Ci(a,s,l),ar=f,In=m;break;case 0:case 11:case 14:case 15:pr||ns(2,l,s),pr||ns(4,l,s),Ci(a,s,l);break;case 1:pr||(Xa(l,s),f=l.stateNode,typeof f.componentWillUnmount=="function"&&ix(l,s,f)),Ci(a,s,l);break;case 21:Ci(a,s,l);break;case 22:pr=(f=pr)||l.memoizedState!==null,Ci(a,s,l),pr=f;break;default:Ci(a,s,l)}}function dx(a,s){if(s.memoizedState===null&&(a=s.alternate,a!==null&&(a=a.memoizedState,a!==null&&(a=a.dehydrated,a!==null))))try{yu(a)}catch(l){$t(s,s.return,l)}}function cC(a){switch(a.tag){case 13:case 19:var s=a.stateNode;return s===null&&(s=a.stateNode=new cx),s;case 22:return a=a.stateNode,s=a._retryCache,s===null&&(s=a._retryCache=new cx),s;default:throw Error(n(435,a.tag))}}function qp(a,s){var l=cC(a);s.forEach(function(f){var m=_C.bind(null,a,f);l.has(f)||(l.add(f),f.then(m,m))})}function Un(a,s){var l=s.deletions;if(l!==null)for(var f=0;f<l.length;f++){var m=l[f],v=a,b=s,L=b;e:for(;L!==null;){switch(L.tag){case 27:if(fs(L.type)){ar=L.stateNode,In=!1;break e}break;case 5:ar=L.stateNode,In=!1;break e;case 3:case 4:ar=L.stateNode.containerInfo,In=!0;break e}L=L.return}if(ar===null)throw Error(n(160));hx(v,b,m),ar=null,In=!1,v=m.alternate,v!==null&&(v.return=null),m.return=null}if(s.subtreeFlags&13878)for(s=s.child;s!==null;)px(s,a),s=s.sibling}var Ta=null;function px(a,s){var l=a.alternate,f=a.flags;switch(a.tag){case 0:case 11:case 14:case 15:Un(s,a),Bn(a),f&4&&(ns(3,a,a.return),ru(3,a),ns(5,a,a.return));break;case 1:Un(s,a),Bn(a),f&512&&(pr||l===null||Xa(l,l.return)),f&64&&Si&&(a=a.updateQueue,a!==null&&(f=a.callbacks,f!==null&&(l=a.shared.hiddenCallbacks,a.shared.hiddenCallbacks=l===null?f:l.concat(f))));break;case 26:var m=Ta;if(Un(s,a),Bn(a),f&512&&(pr||l===null||Xa(l,l.return)),f&4){var v=l!==null?l.memoizedState:null;if(f=a.memoizedState,l===null)if(f===null)if(a.stateNode===null){e:{f=a.type,l=a.memoizedProps,m=m.ownerDocument||m;t:switch(f){case"title":v=m.getElementsByTagName("title")[0],(!v||v[U]||v[hr]||v.namespaceURI==="http://www.w3.org/2000/svg"||v.hasAttribute("itemprop"))&&(v=m.createElement(f),m.head.insertBefore(v,m.querySelector("head > title"))),Yr(v,f,l),v[hr]=a,ce(v),f=v;break e;case"link":var b=ly("link","href",m).get(f+(l.href||""));if(b){for(var L=0;L<b.length;L++)if(v=b[L],v.getAttribute("href")===(l.href==null||l.href===""?null:l.href)&&v.getAttribute("rel")===(l.rel==null?null:l.rel)&&v.getAttribute("title")===(l.title==null?null:l.title)&&v.getAttribute("crossorigin")===(l.crossOrigin==null?null:l.crossOrigin)){b.splice(L,1);break t}}v=m.createElement(f),Yr(v,f,l),m.head.appendChild(v);break;case"meta":if(b=ly("meta","content",m).get(f+(l.content||""))){for(L=0;L<b.length;L++)if(v=b[L],v.getAttribute("content")===(l.content==null?null:""+l.content)&&v.getAttribute("name")===(l.name==null?null:l.name)&&v.getAttribute("property")===(l.property==null?null:l.property)&&v.getAttribute("http-equiv")===(l.httpEquiv==null?null:l.httpEquiv)&&v.getAttribute("charset")===(l.charSet==null?null:l.charSet)){b.splice(L,1);break t}}v=m.createElement(f),Yr(v,f,l),m.head.appendChild(v);break;default:throw Error(n(468,f))}v[hr]=a,ce(v),f=v}a.stateNode=f}else cy(m,a.type,a.stateNode);else a.stateNode=oy(m,f,a.memoizedProps);else v!==f?(v===null?l.stateNode!==null&&(l=l.stateNode,l.parentNode.removeChild(l)):v.count--,f===null?cy(m,a.type,a.stateNode):oy(m,f,a.memoizedProps)):f===null&&a.stateNode!==null&&jp(a,a.memoizedProps,l.memoizedProps)}break;case 27:Un(s,a),Bn(a),f&512&&(pr||l===null||Xa(l,l.return)),l!==null&&f&4&&jp(a,a.memoizedProps,l.memoizedProps);break;case 5:if(Un(s,a),Bn(a),f&512&&(pr||l===null||Xa(l,l.return)),a.flags&32){m=a.stateNode;try{Qn(m,"")}catch(_e){$t(a,a.return,_e)}}f&4&&a.stateNode!=null&&(m=a.memoizedProps,jp(a,m,l!==null?l.memoizedProps:m)),f&1024&&(Gp=!0);break;case 6:if(Un(s,a),Bn(a),f&4){if(a.stateNode===null)throw Error(n(162));f=a.memoizedProps,l=a.stateNode;try{l.nodeValue=f}catch(_e){$t(a,a.return,_e)}}break;case 3:if(Vh=null,m=Ta,Ta=Mh(s.containerInfo),Un(s,a),Ta=m,Bn(a),f&4&&l!==null&&l.memoizedState.isDehydrated)try{yu(s.containerInfo)}catch(_e){$t(a,a.return,_e)}Gp&&(Gp=!1,mx(a));break;case 4:f=Ta,Ta=Mh(a.stateNode.containerInfo),Un(s,a),Bn(a),Ta=f;break;case 12:Un(s,a),Bn(a);break;case 13:Un(s,a),Bn(a),a.child.flags&8192&&a.memoizedState!==null!=(l!==null&&l.memoizedState!==null)&&(Qp=Ne()),f&4&&(f=a.updateQueue,f!==null&&(a.updateQueue=null,qp(a,f)));break;case 22:m=a.memoizedState!==null;var J=l!==null&&l.memoizedState!==null,pe=Si,Ae=pr;if(Si=pe||m,pr=Ae||J,Un(s,a),pr=Ae,Si=pe,Bn(a),f&8192)e:for(s=a.stateNode,s._visibility=m?s._visibility&-2:s._visibility|1,m&&(l===null||J||Si||pr||wo(a)),l=null,s=a;;){if(s.tag===5||s.tag===26){if(l===null){J=l=s;try{if(v=J.stateNode,m)b=v.style,typeof b.setProperty=="function"?b.setProperty("display","none","important"):b.display="none";else{L=J.stateNode;var Re=J.memoizedProps.style,ve=Re!=null&&Re.hasOwnProperty("display")?Re.display:null;L.style.display=ve==null||typeof ve=="boolean"?"":(""+ve).trim()}}catch(_e){$t(J,J.return,_e)}}}else if(s.tag===6){if(l===null){J=s;try{J.stateNode.nodeValue=m?"":J.memoizedProps}catch(_e){$t(J,J.return,_e)}}}else if((s.tag!==22&&s.tag!==23||s.memoizedState===null||s===a)&&s.child!==null){s.child.return=s,s=s.child;continue}if(s===a)break e;for(;s.sibling===null;){if(s.return===null||s.return===a)break e;l===s&&(l=null),s=s.return}l===s&&(l=null),s.sibling.return=s.return,s=s.sibling}f&4&&(f=a.updateQueue,f!==null&&(l=f.retryQueue,l!==null&&(f.retryQueue=null,qp(a,l))));break;case 19:Un(s,a),Bn(a),f&4&&(f=a.updateQueue,f!==null&&(a.updateQueue=null,qp(a,f)));break;case 30:break;case 21:break;default:Un(s,a),Bn(a)}}function Bn(a){var s=a.flags;if(s&2){try{for(var l,f=a.return;f!==null;){if(ox(f)){l=f;break}f=f.return}if(l==null)throw Error(n(160));switch(l.tag){case 27:var m=l.stateNode,v=zp(a);Ah(a,v,m);break;case 5:var b=l.stateNode;l.flags&32&&(Qn(b,""),l.flags&=-33);var L=zp(a);Ah(a,L,b);break;case 3:case 4:var J=l.stateNode.containerInfo,pe=zp(a);Hp(a,pe,J);break;default:throw Error(n(161))}}catch(Ae){$t(a,a.return,Ae)}a.flags&=-3}s&4096&&(a.flags&=-4097)}function mx(a){if(a.subtreeFlags&1024)for(a=a.child;a!==null;){var s=a;mx(s),s.tag===5&&s.flags&1024&&s.stateNode.reset(),a=a.sibling}}function as(a,s){if(s.subtreeFlags&8772)for(s=s.child;s!==null;)ux(a,s.alternate,s),s=s.sibling}function wo(a){for(a=a.child;a!==null;){var s=a;switch(s.tag){case 0:case 11:case 14:case 15:ns(4,s,s.return),wo(s);break;case 1:Xa(s,s.return);var l=s.stateNode;typeof l.componentWillUnmount=="function"&&ix(s,s.return,l),wo(s);break;case 27:hu(s.stateNode);case 26:case 5:Xa(s,s.return),wo(s);break;case 22:s.memoizedState===null&&wo(s);break;case 30:wo(s);break;default:wo(s)}a=a.sibling}}function is(a,s,l){for(l=l&&(s.subtreeFlags&8772)!==0,s=s.child;s!==null;){var f=s.alternate,m=a,v=s,b=v.flags;switch(v.tag){case 0:case 11:case 15:is(m,v,l),ru(4,v);break;case 1:if(is(m,v,l),f=v,m=f.stateNode,typeof m.componentDidMount=="function")try{m.componentDidMount()}catch(pe){$t(f,f.return,pe)}if(f=v,m=f.updateQueue,m!==null){var L=f.stateNode;try{var J=m.shared.hiddenCallbacks;if(J!==null)for(m.shared.hiddenCallbacks=null,m=0;m<J.length;m++)Gv(J[m],L)}catch(pe){$t(f,f.return,pe)}}l&&b&64&&ax(v),nu(v,v.return);break;case 27:lx(v);case 26:case 5:is(m,v,l),l&&f===null&&b&4&&sx(v),nu(v,v.return);break;case 12:is(m,v,l);break;case 13:is(m,v,l),l&&b&4&&dx(m,v);break;case 22:v.memoizedState===null&&is(m,v,l),nu(v,v.return);break;case 30:break;default:is(m,v,l)}s=s.sibling}}function Kp(a,s){var l=null;a!==null&&a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(l=a.memoizedState.cachePool.pool),a=null,s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(a=s.memoizedState.cachePool.pool),a!==l&&(a!=null&&a.refCount++,l!=null&&zc(l))}function Xp(a,s){a=null,s.alternate!==null&&(a=s.alternate.memoizedState.cache),s=s.memoizedState.cache,s!==a&&(s.refCount++,a!=null&&zc(a))}function Wa(a,s,l,f){if(s.subtreeFlags&10256)for(s=s.child;s!==null;)gx(a,s,l,f),s=s.sibling}function gx(a,s,l,f){var m=s.flags;switch(s.tag){case 0:case 11:case 15:Wa(a,s,l,f),m&2048&&ru(9,s);break;case 1:Wa(a,s,l,f);break;case 3:Wa(a,s,l,f),m&2048&&(a=null,s.alternate!==null&&(a=s.alternate.memoizedState.cache),s=s.memoizedState.cache,s!==a&&(s.refCount++,a!=null&&zc(a)));break;case 12:if(m&2048){Wa(a,s,l,f),a=s.stateNode;try{var v=s.memoizedProps,b=v.id,L=v.onPostCommit;typeof L=="function"&&L(b,s.alternate===null?"mount":"update",a.passiveEffectDuration,-0)}catch(J){$t(s,s.return,J)}}else Wa(a,s,l,f);break;case 13:Wa(a,s,l,f);break;case 23:break;case 22:v=s.stateNode,b=s.alternate,s.memoizedState!==null?v._visibility&2?Wa(a,s,l,f):au(a,s):v._visibility&2?Wa(a,s,l,f):(v._visibility|=2,Il(a,s,l,f,(s.subtreeFlags&10256)!==0)),m&2048&&Kp(b,s);break;case 24:Wa(a,s,l,f),m&2048&&Xp(s.alternate,s);break;default:Wa(a,s,l,f)}}function Il(a,s,l,f,m){for(m=m&&(s.subtreeFlags&10256)!==0,s=s.child;s!==null;){var v=a,b=s,L=l,J=f,pe=b.flags;switch(b.tag){case 0:case 11:case 15:Il(v,b,L,J,m),ru(8,b);break;case 23:break;case 22:var Ae=b.stateNode;b.memoizedState!==null?Ae._visibility&2?Il(v,b,L,J,m):au(v,b):(Ae._visibility|=2,Il(v,b,L,J,m)),m&&pe&2048&&Kp(b.alternate,b);break;case 24:Il(v,b,L,J,m),m&&pe&2048&&Xp(b.alternate,b);break;default:Il(v,b,L,J,m)}s=s.sibling}}function au(a,s){if(s.subtreeFlags&10256)for(s=s.child;s!==null;){var l=a,f=s,m=f.flags;switch(f.tag){case 22:au(l,f),m&2048&&Kp(f.alternate,f);break;case 24:au(l,f),m&2048&&Xp(f.alternate,f);break;default:au(l,f)}s=s.sibling}}var iu=8192;function Dl(a){if(a.subtreeFlags&iu)for(a=a.child;a!==null;)vx(a),a=a.sibling}function vx(a){switch(a.tag){case 26:Dl(a),a.flags&iu&&a.memoizedState!==null&&WC(Ta,a.memoizedState,a.memoizedProps);break;case 5:Dl(a);break;case 3:case 4:var s=Ta;Ta=Mh(a.stateNode.containerInfo),Dl(a),Ta=s;break;case 22:a.memoizedState===null&&(s=a.alternate,s!==null&&s.memoizedState!==null?(s=iu,iu=16777216,Dl(a),iu=s):Dl(a));break;default:Dl(a)}}function _x(a){var s=a.alternate;if(s!==null&&(a=s.child,a!==null)){s.child=null;do s=a.sibling,a.sibling=null,a=s;while(a!==null)}}function su(a){var s=a.deletions;if((a.flags&16)!==0){if(s!==null)for(var l=0;l<s.length;l++){var f=s[l];jr=f,yx(f,a)}_x(a)}if(a.subtreeFlags&10256)for(a=a.child;a!==null;)xx(a),a=a.sibling}function xx(a){switch(a.tag){case 0:case 11:case 15:su(a),a.flags&2048&&ns(9,a,a.return);break;case 3:su(a);break;case 12:su(a);break;case 22:var s=a.stateNode;a.memoizedState!==null&&s._visibility&2&&(a.return===null||a.return.tag!==13)?(s._visibility&=-3,wh(a)):su(a);break;default:su(a)}}function wh(a){var s=a.deletions;if((a.flags&16)!==0){if(s!==null)for(var l=0;l<s.length;l++){var f=s[l];jr=f,yx(f,a)}_x(a)}for(a=a.child;a!==null;){switch(s=a,s.tag){case 0:case 11:case 15:ns(8,s,s.return),wh(s);break;case 22:l=s.stateNode,l._visibility&2&&(l._visibility&=-3,wh(s));break;default:wh(s)}a=a.sibling}}function yx(a,s){for(;jr!==null;){var l=jr;switch(l.tag){case 0:case 11:case 15:ns(8,l,s);break;case 23:case 22:if(l.memoizedState!==null&&l.memoizedState.cachePool!==null){var f=l.memoizedState.cachePool.pool;f!=null&&f.refCount++}break;case 24:zc(l.memoizedState.cache)}if(f=l.child,f!==null)f.return=l,jr=f;else e:for(l=a;jr!==null;){f=jr;var m=f.sibling,v=f.return;if(fx(f),f===l){jr=null;break e}if(m!==null){m.return=v,jr=m;break e}jr=v}}}var uC={getCacheForType:function(a){var s=nn(Ir),l=s.data.get(a);return l===void 0&&(l=a(),s.data.set(a,l)),l}},fC=typeof WeakMap=="function"?WeakMap:Map,zt=0,Zt=null,xt=null,bt=0,Ht=0,jn=null,ss=!1,Ol=!1,Wp=!1,Ri=0,cr=0,os=0,So=0,Yp=0,sa=0,Nl=0,ou=null,Dn=null,$p=!1,Qp=0,Sh=1/0,Ch=null,ls=null,Wr=0,cs=null,Fl=null,Pl=0,Zp=0,Jp=null,Ex=null,lu=0,em=null;function zn(){if((zt&2)!==0&&bt!==0)return bt&-bt;if(ne.T!==null){var a=Tl;return a!==0?a:om()}return Pa()}function Tx(){sa===0&&(sa=(bt&536870912)===0||Ut?qi():536870912);var a=ia.current;return a!==null&&(a.flags|=32),sa}function Hn(a,s,l){(a===Zt&&(Ht===2||Ht===9)||a.cancelPendingCommit!==null)&&(Ml(a,0),us(a,bt,sa,!1)),xa(a,l),((zt&2)===0||a!==Zt)&&(a===Zt&&((zt&2)===0&&(So|=l),cr===4&&us(a,bt,sa,!1)),Ya(a))}function Ax(a,s,l){if((zt&6)!==0)throw Error(n(327));var f=!l&&(s&124)===0&&(s&a.expiredLanes)===0||li(a,s),m=f?pC(a,s):nm(a,s,!0),v=f;do{if(m===0){Ol&&!f&&us(a,s,0,!1);break}else{if(l=a.current.alternate,v&&!hC(l)){m=nm(a,s,!1),v=!1;continue}if(m===2){if(v=s,a.errorRecoveryDisabledLanes&v)var b=0;else b=a.pendingLanes&-536870913,b=b!==0?b:b&536870912?536870912:0;if(b!==0){s=b;e:{var L=a;m=ou;var J=L.current.memoizedState.isDehydrated;if(J&&(Ml(L,b).flags|=256),b=nm(L,b,!1),b!==2){if(Wp&&!J){L.errorRecoveryDisabledLanes|=v,So|=v,m=4;break e}v=Dn,Dn=m,v!==null&&(Dn===null?Dn=v:Dn.push.apply(Dn,v))}m=b}if(v=!1,m!==2)continue}}if(m===1){Ml(a,0),us(a,s,0,!0);break}e:{switch(f=a,v=m,v){case 0:case 1:throw Error(n(345));case 4:if((s&4194048)!==s)break;case 6:us(f,s,sa,!ss);break e;case 2:Dn=null;break;case 3:case 5:break;default:throw Error(n(329))}if((s&62914560)===s&&(m=Qp+300-Ne(),10<m)){if(us(f,s,sa,!ss),Hi(f,0,!0)!==0)break e;f.timeoutHandle=Zx(wx.bind(null,f,l,Dn,Ch,$p,s,sa,So,Nl,ss,v,2,-0,0),m);break e}wx(f,l,Dn,Ch,$p,s,sa,So,Nl,ss,v,0,-0,0)}}break}while(!0);Ya(a)}function wx(a,s,l,f,m,v,b,L,J,pe,Ae,Re,ve,_e){if(a.timeoutHandle=-1,Re=s.subtreeFlags,(Re&8192||(Re&16785408)===16785408)&&(mu={stylesheets:null,count:0,unsuspend:XC},vx(s),Re=YC(),Re!==null)){a.cancelPendingCommit=Re(Dx.bind(null,a,s,v,l,f,m,b,L,J,Ae,1,ve,_e)),us(a,v,b,!pe);return}Dx(a,s,v,l,f,m,b,L,J)}function hC(a){for(var s=a;;){var l=s.tag;if((l===0||l===11||l===15)&&s.flags&16384&&(l=s.updateQueue,l!==null&&(l=l.stores,l!==null)))for(var f=0;f<l.length;f++){var m=l[f],v=m.getSnapshot;m=m.value;try{if(!Ln(v(),m))return!1}catch{return!1}}if(l=s.child,s.subtreeFlags&16384&&l!==null)l.return=s,s=l;else{if(s===a)break;for(;s.sibling===null;){if(s.return===null||s.return===a)return!0;s=s.return}s.sibling.return=s.return,s=s.sibling}}return!0}function us(a,s,l,f){s&=~Yp,s&=~So,a.suspendedLanes|=s,a.pingedLanes&=~s,f&&(a.warmLanes|=s),f=a.expirationTimes;for(var m=s;0<m;){var v=31-Lt(m),b=1<<v;f[v]=-1,m&=~b}l!==0&&$n(a,l,s)}function Rh(){return(zt&6)===0?(cu(0),!1):!0}function tm(){if(xt!==null){if(Ht===0)var a=xt.return;else a=xt,xi=xo=null,_p(a),kl=null,Jc=0,a=xt;for(;a!==null;)nx(a.alternate,a),a=a.return;xt=null}}function Ml(a,s){var l=a.timeoutHandle;l!==-1&&(a.timeoutHandle=-1,IC(l)),l=a.cancelPendingCommit,l!==null&&(a.cancelPendingCommit=null,l()),tm(),Zt=a,xt=l=gi(a.current,null),bt=s,Ht=0,jn=null,ss=!1,Ol=li(a,s),Wp=!1,Nl=sa=Yp=So=os=cr=0,Dn=ou=null,$p=!1,(s&8)!==0&&(s|=s&32);var f=a.entangledLanes;if(f!==0)for(a=a.entanglements,f&=s;0<f;){var m=31-Lt(f),v=1<<m;s|=a[m],f&=~v}return Ri=s,Yf(),l}function Sx(a,s){pt=null,ne.H=ph,s===Gc||s===ah?(s=zv(),Ht=3):s===Uv?(s=zv(),Ht=4):Ht=s===H_?8:s!==null&&typeof s=="object"&&typeof s.then=="function"?6:1,jn=s,xt===null&&(cr=1,xh(a,ta(s,a.current)))}function Cx(){var a=ne.H;return ne.H=ph,a===null?ph:a}function Rx(){var a=ne.A;return ne.A=uC,a}function rm(){cr=4,ss||(bt&4194048)!==bt&&ia.current!==null||(Ol=!0),(os&134217727)===0&&(So&134217727)===0||Zt===null||us(Zt,bt,sa,!1)}function nm(a,s,l){var f=zt;zt|=2;var m=Cx(),v=Rx();(Zt!==a||bt!==s)&&(Ch=null,Ml(a,s)),s=!1;var b=cr;e:do try{if(Ht!==0&&xt!==null){var L=xt,J=jn;switch(Ht){case 8:tm(),b=6;break e;case 3:case 2:case 9:case 6:ia.current===null&&(s=!0);var pe=Ht;if(Ht=0,jn=null,Ll(a,L,J,pe),l&&Ol){b=0;break e}break;default:pe=Ht,Ht=0,jn=null,Ll(a,L,J,pe)}}dC(),b=cr;break}catch(Ae){Sx(a,Ae)}while(!0);return s&&a.shellSuspendCounter++,xi=xo=null,zt=f,ne.H=m,ne.A=v,xt===null&&(Zt=null,bt=0,Yf()),b}function dC(){for(;xt!==null;)kx(xt)}function pC(a,s){var l=zt;zt|=2;var f=Cx(),m=Rx();Zt!==a||bt!==s?(Ch=null,Sh=Ne()+500,Ml(a,s)):Ol=li(a,s);e:do try{if(Ht!==0&&xt!==null){s=xt;var v=jn;t:switch(Ht){case 1:Ht=0,jn=null,Ll(a,s,v,1);break;case 2:case 9:if(Bv(v)){Ht=0,jn=null,bx(s);break}s=function(){Ht!==2&&Ht!==9||Zt!==a||(Ht=7),Ya(a)},v.then(s,s);break e;case 3:Ht=7;break e;case 4:Ht=5;break e;case 7:Bv(v)?(Ht=0,jn=null,bx(s)):(Ht=0,jn=null,Ll(a,s,v,7));break;case 5:var b=null;switch(xt.tag){case 26:b=xt.memoizedState;case 5:case 27:var L=xt;if(!b||uy(b)){Ht=0,jn=null;var J=L.sibling;if(J!==null)xt=J;else{var pe=L.return;pe!==null?(xt=pe,kh(pe)):xt=null}break t}}Ht=0,jn=null,Ll(a,s,v,5);break;case 6:Ht=0,jn=null,Ll(a,s,v,6);break;case 8:tm(),cr=6;break e;default:throw Error(n(462))}}mC();break}catch(Ae){Sx(a,Ae)}while(!0);return xi=xo=null,ne.H=f,ne.A=m,zt=l,xt!==null?0:(Zt=null,bt=0,Yf(),cr)}function mC(){for(;xt!==null&&!Ke();)kx(xt)}function kx(a){var s=tx(a.alternate,a,Ri);a.memoizedProps=a.pendingProps,s===null?kh(a):xt=s}function bx(a){var s=a,l=s.alternate;switch(s.tag){case 15:case 0:s=Y_(l,s,s.pendingProps,s.type,void 0,bt);break;case 11:s=Y_(l,s,s.pendingProps,s.type.render,s.ref,bt);break;case 5:_p(s);default:nx(l,s),s=xt=Iv(s,Ri),s=tx(l,s,Ri)}a.memoizedProps=a.pendingProps,s===null?kh(a):xt=s}function Ll(a,s,l,f){xi=xo=null,_p(s),kl=null,Jc=0;var m=s.return;try{if(aC(a,m,s,l,bt)){cr=1,xh(a,ta(l,a.current)),xt=null;return}}catch(v){if(m!==null)throw xt=m,v;cr=1,xh(a,ta(l,a.current)),xt=null;return}s.flags&32768?(Ut||f===1?a=!0:Ol||(bt&536870912)!==0?a=!1:(ss=a=!0,(f===2||f===9||f===3||f===6)&&(f=ia.current,f!==null&&f.tag===13&&(f.flags|=16384))),Ix(s,a)):kh(s)}function kh(a){var s=a;do{if((s.flags&32768)!==0){Ix(s,ss);return}a=s.return;var l=sC(s.alternate,s,Ri);if(l!==null){xt=l;return}if(s=s.sibling,s!==null){xt=s;return}xt=s=a}while(s!==null);cr===0&&(cr=5)}function Ix(a,s){do{var l=oC(a.alternate,a);if(l!==null){l.flags&=32767,xt=l;return}if(l=a.return,l!==null&&(l.flags|=32768,l.subtreeFlags=0,l.deletions=null),!s&&(a=a.sibling,a!==null)){xt=a;return}xt=a=l}while(a!==null);cr=6,xt=null}function Dx(a,s,l,f,m,v,b,L,J){a.cancelPendingCommit=null;do bh();while(Wr!==0);if((zt&6)!==0)throw Error(n(327));if(s!==null){if(s===a.current)throw Error(n(177));if(v=s.lanes|s.childLanes,v|=Xd,Na(a,l,v,b,L,J),a===Zt&&(xt=Zt=null,bt=0),Fl=s,cs=a,Pl=l,Zp=v,Jp=m,Ex=f,(s.subtreeFlags&10256)!==0||(s.flags&10256)!==0?(a.callbackNode=null,a.callbackPriority=0,xC(rr,function(){return Mx(),null})):(a.callbackNode=null,a.callbackPriority=0),f=(s.flags&13878)!==0,(s.subtreeFlags&13878)!==0||f){f=ne.T,ne.T=null,m=oe.p,oe.p=2,b=zt,zt|=4;try{lC(a,s,l)}finally{zt=b,oe.p=m,ne.T=f}}Wr=1,Ox(),Nx(),Fx()}}function Ox(){if(Wr===1){Wr=0;var a=cs,s=Fl,l=(s.flags&13878)!==0;if((s.subtreeFlags&13878)!==0||l){l=ne.T,ne.T=null;var f=oe.p;oe.p=2;var m=zt;zt|=4;try{px(s,a);var v=mm,b=yv(a.containerInfo),L=v.focusedElem,J=v.selectionRange;if(b!==L&&L&&L.ownerDocument&&xv(L.ownerDocument.documentElement,L)){if(J!==null&&zd(L)){var pe=J.start,Ae=J.end;if(Ae===void 0&&(Ae=pe),"selectionStart"in L)L.selectionStart=pe,L.selectionEnd=Math.min(Ae,L.value.length);else{var Re=L.ownerDocument||document,ve=Re&&Re.defaultView||window;if(ve.getSelection){var _e=ve.getSelection(),it=L.textContent.length,Qe=Math.min(J.start,it),Yt=J.end===void 0?Qe:Math.min(J.end,it);!_e.extend&&Qe>Yt&&(b=Yt,Yt=Qe,Qe=b);var le=_v(L,Qe),ae=_v(L,Yt);if(le&&ae&&(_e.rangeCount!==1||_e.anchorNode!==le.node||_e.anchorOffset!==le.offset||_e.focusNode!==ae.node||_e.focusOffset!==ae.offset)){var he=Re.createRange();he.setStart(le.node,le.offset),_e.removeAllRanges(),Qe>Yt?(_e.addRange(he),_e.extend(ae.node,ae.offset)):(he.setEnd(ae.node,ae.offset),_e.addRange(he))}}}}for(Re=[],_e=L;_e=_e.parentNode;)_e.nodeType===1&&Re.push({element:_e,left:_e.scrollLeft,top:_e.scrollTop});for(typeof L.focus=="function"&&L.focus(),L=0;L<Re.length;L++){var Se=Re[L];Se.element.scrollLeft=Se.left,Se.element.scrollTop=Se.top}}jh=!!pm,mm=pm=null}finally{zt=m,oe.p=f,ne.T=l}}a.current=s,Wr=2}}function Nx(){if(Wr===2){Wr=0;var a=cs,s=Fl,l=(s.flags&8772)!==0;if((s.subtreeFlags&8772)!==0||l){l=ne.T,ne.T=null;var f=oe.p;oe.p=2;var m=zt;zt|=4;try{ux(a,s.alternate,s)}finally{zt=m,oe.p=f,ne.T=l}}Wr=3}}function Fx(){if(Wr===4||Wr===3){Wr=0,Be();var a=cs,s=Fl,l=Pl,f=Ex;(s.subtreeFlags&10256)!==0||(s.flags&10256)!==0?Wr=5:(Wr=0,Fl=cs=null,Px(a,a.pendingLanes));var m=a.pendingLanes;if(m===0&&(ls=null),Xi(l),s=s.stateNode,Je&&typeof Je.onCommitFiberRoot=="function")try{Je.onCommitFiberRoot(Ze,s,void 0,(s.current.flags&128)===128)}catch{}if(f!==null){s=ne.T,m=oe.p,oe.p=2,ne.T=null;try{for(var v=a.onRecoverableError,b=0;b<f.length;b++){var L=f[b];v(L.value,{componentStack:L.stack})}}finally{ne.T=s,oe.p=m}}(Pl&3)!==0&&bh(),Ya(a),m=a.pendingLanes,(l&4194090)!==0&&(m&42)!==0?a===em?lu++:(lu=0,em=a):lu=0,cu(0)}}function Px(a,s){(a.pooledCacheLanes&=s)===0&&(s=a.pooledCache,s!=null&&(a.pooledCache=null,zc(s)))}function bh(a){return Ox(),Nx(),Fx(),Mx()}function Mx(){if(Wr!==5)return!1;var a=cs,s=Zp;Zp=0;var l=Xi(Pl),f=ne.T,m=oe.p;try{oe.p=32>l?32:l,ne.T=null,l=Jp,Jp=null;var v=cs,b=Pl;if(Wr=0,Fl=cs=null,Pl=0,(zt&6)!==0)throw Error(n(331));var L=zt;if(zt|=4,xx(v.current),gx(v,v.current,b,l),zt=L,cu(0,!1),Je&&typeof Je.onPostCommitFiberRoot=="function")try{Je.onPostCommitFiberRoot(Ze,v)}catch{}return!0}finally{oe.p=m,ne.T=f,Px(a,s)}}function Lx(a,s,l){s=ta(l,s),s=Op(a.stateNode,s,2),a=Ji(a,s,2),a!==null&&(xa(a,2),Ya(a))}function $t(a,s,l){if(a.tag===3)Lx(a,a,l);else for(;s!==null;){if(s.tag===3){Lx(s,a,l);break}else if(s.tag===1){var f=s.stateNode;if(typeof s.type.getDerivedStateFromError=="function"||typeof f.componentDidCatch=="function"&&(ls===null||!ls.has(f))){a=ta(l,a),l=j_(2),f=Ji(s,l,2),f!==null&&(z_(l,f,s,a),xa(f,2),Ya(f));break}}s=s.return}}function am(a,s,l){var f=a.pingCache;if(f===null){f=a.pingCache=new fC;var m=new Set;f.set(s,m)}else m=f.get(s),m===void 0&&(m=new Set,f.set(s,m));m.has(l)||(Wp=!0,m.add(l),a=gC.bind(null,a,s,l),s.then(a,a))}function gC(a,s,l){var f=a.pingCache;f!==null&&f.delete(s),a.pingedLanes|=a.suspendedLanes&l,a.warmLanes&=~l,Zt===a&&(bt&l)===l&&(cr===4||cr===3&&(bt&62914560)===bt&&300>Ne()-Qp?(zt&2)===0&&Ml(a,0):Yp|=l,Nl===bt&&(Nl=0)),Ya(a)}function Vx(a,s){s===0&&(s=Ki()),a=_l(a,s),a!==null&&(xa(a,s),Ya(a))}function vC(a){var s=a.memoizedState,l=0;s!==null&&(l=s.retryLane),Vx(a,l)}function _C(a,s){var l=0;switch(a.tag){case 13:var f=a.stateNode,m=a.memoizedState;m!==null&&(l=m.retryLane);break;case 19:f=a.stateNode;break;case 22:f=a.stateNode._retryCache;break;default:throw Error(n(314))}f!==null&&f.delete(s),Vx(a,l)}function xC(a,s){return nt(a,s)}var Ih=null,Vl=null,im=!1,Dh=!1,sm=!1,Co=0;function Ya(a){a!==Vl&&a.next===null&&(Vl===null?Ih=Vl=a:Vl=Vl.next=a),Dh=!0,im||(im=!0,EC())}function cu(a,s){if(!sm&&Dh){sm=!0;do for(var l=!1,f=Ih;f!==null;){if(a!==0){var m=f.pendingLanes;if(m===0)var v=0;else{var b=f.suspendedLanes,L=f.pingedLanes;v=(1<<31-Lt(42|a)+1)-1,v&=m&~(b&~L),v=v&201326741?v&201326741|1:v?v|2:0}v!==0&&(l=!0,zx(f,v))}else v=bt,v=Hi(f,f===Zt?v:0,f.cancelPendingCommit!==null||f.timeoutHandle!==-1),(v&3)===0||li(f,v)||(l=!0,zx(f,v));f=f.next}while(l);sm=!1}}function yC(){Ux()}function Ux(){Dh=im=!1;var a=0;Co!==0&&(bC()&&(a=Co),Co=0);for(var s=Ne(),l=null,f=Ih;f!==null;){var m=f.next,v=Bx(f,s);v===0?(f.next=null,l===null?Ih=m:l.next=m,m===null&&(Vl=l)):(l=f,(a!==0||(v&3)!==0)&&(Dh=!0)),f=m}cu(a)}function Bx(a,s){for(var l=a.suspendedLanes,f=a.pingedLanes,m=a.expirationTimes,v=a.pendingLanes&-62914561;0<v;){var b=31-Lt(v),L=1<<b,J=m[b];J===-1?((L&l)===0||(L&f)!==0)&&(m[b]=Gi(L,s)):J<=s&&(a.expiredLanes|=L),v&=~L}if(s=Zt,l=bt,l=Hi(a,a===s?l:0,a.cancelPendingCommit!==null||a.timeoutHandle!==-1),f=a.callbackNode,l===0||a===s&&(Ht===2||Ht===9)||a.cancelPendingCommit!==null)return f!==null&&f!==null&&Ge(f),a.callbackNode=null,a.callbackPriority=0;if((l&3)===0||li(a,l)){if(s=l&-l,s===a.callbackPriority)return s;switch(f!==null&&Ge(f),Xi(l)){case 2:case 8:l=_t;break;case 32:l=rr;break;case 268435456:l=fr;break;default:l=rr}return f=jx.bind(null,a),l=nt(l,f),a.callbackPriority=s,a.callbackNode=l,s}return f!==null&&f!==null&&Ge(f),a.callbackPriority=2,a.callbackNode=null,2}function jx(a,s){if(Wr!==0&&Wr!==5)return a.callbackNode=null,a.callbackPriority=0,null;var l=a.callbackNode;if(bh()&&a.callbackNode!==l)return null;var f=bt;return f=Hi(a,a===Zt?f:0,a.cancelPendingCommit!==null||a.timeoutHandle!==-1),f===0?null:(Ax(a,f,s),Bx(a,Ne()),a.callbackNode!=null&&a.callbackNode===l?jx.bind(null,a):null)}function zx(a,s){if(bh())return null;Ax(a,s,!0)}function EC(){DC(function(){(zt&6)!==0?nt(ut,yC):Ux()})}function om(){return Co===0&&(Co=qi()),Co}function Hx(a){return a==null||typeof a=="symbol"||typeof a=="boolean"?null:typeof a=="function"?a:sl(""+a)}function Gx(a,s){var l=s.ownerDocument.createElement("input");return l.name=s.name,l.value=s.value,a.id&&l.setAttribute("form",a.id),s.parentNode.insertBefore(l,s),a=new FormData(a),l.parentNode.removeChild(l),a}function TC(a,s,l,f,m){if(s==="submit"&&l&&l.stateNode===m){var v=Hx((m[nr]||null).action),b=f.submitter;b&&(s=(s=b[nr]||null)?Hx(s.formAction):b.getAttribute("formAction"),s!==null&&(v=s,b=null));var L=new ol("action","action",null,f,m);a.push({event:L,listeners:[{instance:null,listener:function(){if(f.defaultPrevented){if(Co!==0){var J=b?Gx(m,b):new FormData(m);Rp(l,{pending:!0,data:J,method:m.method,action:v},null,J)}}else typeof v=="function"&&(L.preventDefault(),J=b?Gx(m,b):new FormData(m),Rp(l,{pending:!0,data:J,method:m.method,action:v},v,J))},currentTarget:m}]})}}for(var lm=0;lm<Kd.length;lm++){var cm=Kd[lm],AC=cm.toLowerCase(),wC=cm[0].toUpperCase()+cm.slice(1);Ea(AC,"on"+wC)}Ea(Av,"onAnimationEnd"),Ea(wv,"onAnimationIteration"),Ea(Sv,"onAnimationStart"),Ea("dblclick","onDoubleClick"),Ea("focusin","onFocus"),Ea("focusout","onBlur"),Ea(j4,"onTransitionRun"),Ea(z4,"onTransitionStart"),Ea(H4,"onTransitionCancel"),Ea(Cv,"onTransitionEnd"),Le("onMouseEnter",["mouseout","mouseover"]),Le("onMouseLeave",["mouseout","mouseover"]),Le("onPointerEnter",["pointerout","pointerover"]),Le("onPointerLeave",["pointerout","pointerover"]),Oe("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Oe("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Oe("onBeforeInput",["compositionend","keypress","textInput","paste"]),Oe("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Oe("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Oe("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var uu="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),SC=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(uu));function qx(a,s){s=(s&4)!==0;for(var l=0;l<a.length;l++){var f=a[l],m=f.event;f=f.listeners;e:{var v=void 0;if(s)for(var b=f.length-1;0<=b;b--){var L=f[b],J=L.instance,pe=L.currentTarget;if(L=L.listener,J!==v&&m.isPropagationStopped())break e;v=L,m.currentTarget=pe;try{v(m)}catch(Ae){_h(Ae)}m.currentTarget=null,v=J}else for(b=0;b<f.length;b++){if(L=f[b],J=L.instance,pe=L.currentTarget,L=L.listener,J!==v&&m.isPropagationStopped())break e;v=L,m.currentTarget=pe;try{v(m)}catch(Ae){_h(Ae)}m.currentTarget=null,v=J}}}}function yt(a,s){var l=s[Js];l===void 0&&(l=s[Js]=new Set);var f=a+"__bubble";l.has(f)||(Kx(s,a,2,!1),l.add(f))}function um(a,s,l){var f=0;s&&(f|=4),Kx(l,a,f,s)}var Oh="_reactListening"+Math.random().toString(36).slice(2);function fm(a){if(!a[Oh]){a[Oh]=!0,me.forEach(function(l){l!=="selectionchange"&&(SC.has(l)||um(l,!1,a),um(l,!0,a))});var s=a.nodeType===9?a:a.ownerDocument;s===null||s[Oh]||(s[Oh]=!0,um("selectionchange",!1,s))}}function Kx(a,s,l,f){switch(gy(s)){case 2:var m=ZC;break;case 8:m=JC;break;default:m=Sm}l=m.bind(null,s,l,a),m=void 0,!Jn||s!=="touchstart"&&s!=="touchmove"&&s!=="wheel"||(m=!0),f?m!==void 0?a.addEventListener(s,l,{capture:!0,passive:m}):a.addEventListener(s,l,!0):m!==void 0?a.addEventListener(s,l,{passive:m}):a.addEventListener(s,l,!1)}function hm(a,s,l,f,m){var v=f;if((s&1)===0&&(s&2)===0&&f!==null)e:for(;;){if(f===null)return;var b=f.tag;if(b===3||b===4){var L=f.stateNode.containerInfo;if(L===m)break;if(b===4)for(b=f.return;b!==null;){var J=b.tag;if((J===3||J===4)&&b.stateNode.containerInfo===m)return;b=b.return}for(;L!==null;){if(b=H(L),b===null)return;if(J=b.tag,J===5||J===6||J===26||J===27){f=v=b;continue e}L=L.parentNode}}f=f.return}Ff(function(){var pe=v,Ae=Zn(l),Re=[];e:{var ve=Rv.get(a);if(ve!==void 0){var _e=ol,it=a;switch(a){case"keypress":if(Ba(l)===0)break e;case"keydown":case"keyup":_e=dl;break;case"focusin":it="focus",_e=ul;break;case"focusout":it="blur",_e=ul;break;case"beforeblur":case"afterblur":_e=ul;break;case"click":if(l.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":_e=ea;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":_e=Vd;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":_e=zf;break;case Av:case wv:case Sv:_e=fl;break;case Cv:_e=Gf;break;case"scroll":case"scrollend":_e=Pf;break;case"wheel":_e=pl;break;case"copy":case"cut":case"paste":_e=hl;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":_e=Fc;break;case"toggle":case"beforetoggle":_e=Kf}var Qe=(s&4)!==0,Yt=!Qe&&(a==="scroll"||a==="scrollend"),le=Qe?ve!==null?ve+"Capture":null:ve;Qe=[];for(var ae=pe,he;ae!==null;){var Se=ae;if(he=Se.stateNode,Se=Se.tag,Se!==5&&Se!==26&&Se!==27||he===null||le===null||(Se=ao(ae,le),Se!=null&&Qe.push(fu(ae,Se,he))),Yt)break;ae=ae.return}0<Qe.length&&(ve=new _e(ve,it,null,l,Ae),Re.push({event:ve,listeners:Qe}))}}if((s&7)===0){e:{if(ve=a==="mouseover"||a==="pointerover",_e=a==="mouseout"||a==="pointerout",ve&&l!==ui&&(it=l.relatedTarget||l.fromElement)&&(H(it)||it[Rn]))break e;if((_e||ve)&&(ve=Ae.window===Ae?Ae:(ve=Ae.ownerDocument)?ve.defaultView||ve.parentWindow:window,_e?(it=l.relatedTarget||l.toElement,_e=pe,it=it?H(it):null,it!==null&&(Yt=o(it),Qe=it.tag,it!==Yt||Qe!==5&&Qe!==27&&Qe!==6)&&(it=null)):(_e=null,it=pe),_e!==it)){if(Qe=ea,Se="onMouseLeave",le="onMouseEnter",ae="mouse",(a==="pointerout"||a==="pointerover")&&(Qe=Fc,Se="onPointerLeave",le="onPointerEnter",ae="pointer"),Yt=_e==null?ve:de(_e),he=it==null?ve:de(it),ve=new Qe(Se,ae+"leave",_e,l,Ae),ve.target=Yt,ve.relatedTarget=he,Se=null,H(Ae)===pe&&(Qe=new Qe(le,ae+"enter",it,l,Ae),Qe.target=he,Qe.relatedTarget=Yt,Se=Qe),Yt=Se,_e&&it)t:{for(Qe=_e,le=it,ae=0,he=Qe;he;he=Ul(he))ae++;for(he=0,Se=le;Se;Se=Ul(Se))he++;for(;0<ae-he;)Qe=Ul(Qe),ae--;for(;0<he-ae;)le=Ul(le),he--;for(;ae--;){if(Qe===le||le!==null&&Qe===le.alternate)break t;Qe=Ul(Qe),le=Ul(le)}Qe=null}else Qe=null;_e!==null&&Xx(Re,ve,_e,Qe,!1),it!==null&&Yt!==null&&Xx(Re,Yt,it,Qe,!0)}}e:{if(ve=pe?de(pe):window,_e=ve.nodeName&&ve.nodeName.toLowerCase(),_e==="select"||_e==="input"&&ve.type==="file")var qe=hv;else if(br(ve))if(dv)qe=V4;else{qe=M4;var gt=P4}else _e=ve.nodeName,!_e||_e.toLowerCase()!=="input"||ve.type!=="checkbox"&&ve.type!=="radio"?pe&&Rc(pe.elementType)&&(qe=hv):qe=L4;if(qe&&(qe=qe(a,pe))){mi(Re,qe,l,Ae);break e}gt&&gt(a,ve,pe),a==="focusout"&&pe&&ve.type==="number"&&pe.memoizedProps.value!=null&&Wi(ve,"number",ve.value)}switch(gt=pe?de(pe):window,a){case"focusin":(br(gt)||gt.contentEditable==="true")&&(ml=gt,Hd=pe,Lc=null);break;case"focusout":Lc=Hd=ml=null;break;case"mousedown":Gd=!0;break;case"contextmenu":case"mouseup":case"dragend":Gd=!1,Ev(Re,l,Ae);break;case"selectionchange":if(B4)break;case"keydown":case"keyup":Ev(Re,l,Ae)}var We;if(Ha)e:{switch(a){case"compositionstart":var et="onCompositionStart";break e;case"compositionend":et="onCompositionEnd";break e;case"compositionupdate":et="onCompositionUpdate";break e}et=void 0}else Rt?ye(a,l)&&(et="onCompositionEnd"):a==="keydown"&&l.keyCode===229&&(et="onCompositionStart");et&&(R&&l.locale!=="ko"&&(Rt||et!=="onCompositionStart"?et==="onCompositionEnd"&&Rt&&(We=bc()):(Ua=Ae,Yi="value"in Ua?Ua.value:Ua.textContent,Rt=!0)),gt=Nh(pe,et),0<gt.length&&(et=new Oc(et,a,null,l,Ae),Re.push({event:et,listeners:gt}),We?et.data=We:(We=Ve(l),We!==null&&(et.data=We)))),(We=y?kr(a,l):kt(a,l))&&(et=Nh(pe,"onBeforeInput"),0<et.length&&(gt=new Oc("onBeforeInput","beforeinput",null,l,Ae),Re.push({event:gt,listeners:et}),gt.data=We)),TC(Re,a,pe,l,Ae)}qx(Re,s)})}function fu(a,s,l){return{instance:a,listener:s,currentTarget:l}}function Nh(a,s){for(var l=s+"Capture",f=[];a!==null;){var m=a,v=m.stateNode;if(m=m.tag,m!==5&&m!==26&&m!==27||v===null||(m=ao(a,l),m!=null&&f.unshift(fu(a,m,v)),m=ao(a,s),m!=null&&f.push(fu(a,m,v))),a.tag===3)return f;a=a.return}return[]}function Ul(a){if(a===null)return null;do a=a.return;while(a&&a.tag!==5&&a.tag!==27);return a||null}function Xx(a,s,l,f,m){for(var v=s._reactName,b=[];l!==null&&l!==f;){var L=l,J=L.alternate,pe=L.stateNode;if(L=L.tag,J!==null&&J===f)break;L!==5&&L!==26&&L!==27||pe===null||(J=pe,m?(pe=ao(l,v),pe!=null&&b.unshift(fu(l,pe,J))):m||(pe=ao(l,v),pe!=null&&b.push(fu(l,pe,J)))),l=l.return}b.length!==0&&a.push({event:s,listeners:b})}var CC=/\r\n?/g,RC=/\u0000|\uFFFD/g;function Wx(a){return(typeof a=="string"?a:""+a).replace(CC,`
`).replace(RC,"")}function Yx(a,s){return s=Wx(s),Wx(a)===s}function Fh(){}function Wt(a,s,l,f,m,v){switch(l){case"children":typeof f=="string"?s==="body"||s==="textarea"&&f===""||Qn(a,f):(typeof f=="number"||typeof f=="bigint")&&s!=="body"&&Qn(a,""+f);break;case"className":St(a,"class",f);break;case"tabIndex":St(a,"tabindex",f);break;case"dir":case"role":case"viewBox":case"width":case"height":St(a,l,f);break;case"style":Cc(a,f,v);break;case"data":if(s!=="object"){St(a,"data",f);break}case"src":case"href":if(f===""&&(s!=="a"||l!=="href")){a.removeAttribute(l);break}if(f==null||typeof f=="function"||typeof f=="symbol"||typeof f=="boolean"){a.removeAttribute(l);break}f=sl(""+f),a.setAttribute(l,f);break;case"action":case"formAction":if(typeof f=="function"){a.setAttribute(l,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof v=="function"&&(l==="formAction"?(s!=="input"&&Wt(a,s,"name",m.name,m,null),Wt(a,s,"formEncType",m.formEncType,m,null),Wt(a,s,"formMethod",m.formMethod,m,null),Wt(a,s,"formTarget",m.formTarget,m,null)):(Wt(a,s,"encType",m.encType,m,null),Wt(a,s,"method",m.method,m,null),Wt(a,s,"target",m.target,m,null)));if(f==null||typeof f=="symbol"||typeof f=="boolean"){a.removeAttribute(l);break}f=sl(""+f),a.setAttribute(l,f);break;case"onClick":f!=null&&(a.onclick=Fh);break;case"onScroll":f!=null&&yt("scroll",a);break;case"onScrollEnd":f!=null&&yt("scrollend",a);break;case"dangerouslySetInnerHTML":if(f!=null){if(typeof f!="object"||!("__html"in f))throw Error(n(61));if(l=f.__html,l!=null){if(m.children!=null)throw Error(n(60));a.innerHTML=l}}break;case"multiple":a.multiple=f&&typeof f!="function"&&typeof f!="symbol";break;case"muted":a.muted=f&&typeof f!="function"&&typeof f!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(f==null||typeof f=="function"||typeof f=="boolean"||typeof f=="symbol"){a.removeAttribute("xlink:href");break}l=sl(""+f),a.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",l);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":f!=null&&typeof f!="function"&&typeof f!="symbol"?a.setAttribute(l,""+f):a.removeAttribute(l);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":f&&typeof f!="function"&&typeof f!="symbol"?a.setAttribute(l,""):a.removeAttribute(l);break;case"capture":case"download":f===!0?a.setAttribute(l,""):f!==!1&&f!=null&&typeof f!="function"&&typeof f!="symbol"?a.setAttribute(l,f):a.removeAttribute(l);break;case"cols":case"rows":case"size":case"span":f!=null&&typeof f!="function"&&typeof f!="symbol"&&!isNaN(f)&&1<=f?a.setAttribute(l,f):a.removeAttribute(l);break;case"rowSpan":case"start":f==null||typeof f=="function"||typeof f=="symbol"||isNaN(f)?a.removeAttribute(l):a.setAttribute(l,f);break;case"popover":yt("beforetoggle",a),yt("toggle",a),Pt(a,"popover",f);break;case"xlinkActuate":Ct(a,"http://www.w3.org/1999/xlink","xlink:actuate",f);break;case"xlinkArcrole":Ct(a,"http://www.w3.org/1999/xlink","xlink:arcrole",f);break;case"xlinkRole":Ct(a,"http://www.w3.org/1999/xlink","xlink:role",f);break;case"xlinkShow":Ct(a,"http://www.w3.org/1999/xlink","xlink:show",f);break;case"xlinkTitle":Ct(a,"http://www.w3.org/1999/xlink","xlink:title",f);break;case"xlinkType":Ct(a,"http://www.w3.org/1999/xlink","xlink:type",f);break;case"xmlBase":Ct(a,"http://www.w3.org/XML/1998/namespace","xml:base",f);break;case"xmlLang":Ct(a,"http://www.w3.org/XML/1998/namespace","xml:lang",f);break;case"xmlSpace":Ct(a,"http://www.w3.org/XML/1998/namespace","xml:space",f);break;case"is":Pt(a,"is",f);break;case"innerText":case"textContent":break;default:(!(2<l.length)||l[0]!=="o"&&l[0]!=="O"||l[1]!=="n"&&l[1]!=="N")&&(l=Md.get(l)||l,Pt(a,l,f))}}function dm(a,s,l,f,m,v){switch(l){case"style":Cc(a,f,v);break;case"dangerouslySetInnerHTML":if(f!=null){if(typeof f!="object"||!("__html"in f))throw Error(n(61));if(l=f.__html,l!=null){if(m.children!=null)throw Error(n(60));a.innerHTML=l}}break;case"children":typeof f=="string"?Qn(a,f):(typeof f=="number"||typeof f=="bigint")&&Qn(a,""+f);break;case"onScroll":f!=null&&yt("scroll",a);break;case"onScrollEnd":f!=null&&yt("scrollend",a);break;case"onClick":f!=null&&(a.onclick=Fh);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!ge.hasOwnProperty(l))e:{if(l[0]==="o"&&l[1]==="n"&&(m=l.endsWith("Capture"),s=l.slice(2,m?l.length-7:void 0),v=a[nr]||null,v=v!=null?v[l]:null,typeof v=="function"&&a.removeEventListener(s,v,m),typeof f=="function")){typeof v!="function"&&v!==null&&(l in a?a[l]=null:a.hasAttribute(l)&&a.removeAttribute(l)),a.addEventListener(s,f,m);break e}l in a?a[l]=f:f===!0?a.setAttribute(l,""):Pt(a,l,f)}}}function Yr(a,s,l){switch(s){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":yt("error",a),yt("load",a);var f=!1,m=!1,v;for(v in l)if(l.hasOwnProperty(v)){var b=l[v];if(b!=null)switch(v){case"src":f=!0;break;case"srcSet":m=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(n(137,s));default:Wt(a,s,v,b,l,null)}}m&&Wt(a,s,"srcSet",l.srcSet,l,null),f&&Wt(a,s,"src",l.src,l,null);return;case"input":yt("invalid",a);var L=v=b=m=null,J=null,pe=null;for(f in l)if(l.hasOwnProperty(f)){var Ae=l[f];if(Ae!=null)switch(f){case"name":m=Ae;break;case"type":b=Ae;break;case"checked":J=Ae;break;case"defaultChecked":pe=Ae;break;case"value":v=Ae;break;case"defaultValue":L=Ae;break;case"children":case"dangerouslySetInnerHTML":if(Ae!=null)throw Error(n(137,s));break;default:Wt(a,s,f,Ae,l,null)}}to(a,v,L,J,pe,b,m,!1),il(a);return;case"select":yt("invalid",a),f=b=v=null;for(m in l)if(l.hasOwnProperty(m)&&(L=l[m],L!=null))switch(m){case"value":v=L;break;case"defaultValue":b=L;break;case"multiple":f=L;default:Wt(a,s,m,L,l,null)}s=v,l=b,a.multiple=!!f,s!=null?ci(a,!!f,s,!1):l!=null&&ci(a,!!f,l,!0);return;case"textarea":yt("invalid",a),v=m=f=null;for(b in l)if(l.hasOwnProperty(b)&&(L=l[b],L!=null))switch(b){case"value":f=L;break;case"defaultValue":m=L;break;case"children":v=L;break;case"dangerouslySetInnerHTML":if(L!=null)throw Error(n(91));break;default:Wt(a,s,b,L,l,null)}ro(a,f,m,v),il(a);return;case"option":for(J in l)if(l.hasOwnProperty(J)&&(f=l[J],f!=null))switch(J){case"selected":a.selected=f&&typeof f!="function"&&typeof f!="symbol";break;default:Wt(a,s,J,f,l,null)}return;case"dialog":yt("beforetoggle",a),yt("toggle",a),yt("cancel",a),yt("close",a);break;case"iframe":case"object":yt("load",a);break;case"video":case"audio":for(f=0;f<uu.length;f++)yt(uu[f],a);break;case"image":yt("error",a),yt("load",a);break;case"details":yt("toggle",a);break;case"embed":case"source":case"link":yt("error",a),yt("load",a);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(pe in l)if(l.hasOwnProperty(pe)&&(f=l[pe],f!=null))switch(pe){case"children":case"dangerouslySetInnerHTML":throw Error(n(137,s));default:Wt(a,s,pe,f,l,null)}return;default:if(Rc(s)){for(Ae in l)l.hasOwnProperty(Ae)&&(f=l[Ae],f!==void 0&&dm(a,s,Ae,f,l,void 0));return}}for(L in l)l.hasOwnProperty(L)&&(f=l[L],f!=null&&Wt(a,s,L,f,l,null))}function kC(a,s,l,f){switch(s){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var m=null,v=null,b=null,L=null,J=null,pe=null,Ae=null;for(_e in l){var Re=l[_e];if(l.hasOwnProperty(_e)&&Re!=null)switch(_e){case"checked":break;case"value":break;case"defaultValue":J=Re;default:f.hasOwnProperty(_e)||Wt(a,s,_e,null,f,Re)}}for(var ve in f){var _e=f[ve];if(Re=l[ve],f.hasOwnProperty(ve)&&(_e!=null||Re!=null))switch(ve){case"type":v=_e;break;case"name":m=_e;break;case"checked":pe=_e;break;case"defaultChecked":Ae=_e;break;case"value":b=_e;break;case"defaultValue":L=_e;break;case"children":case"dangerouslySetInnerHTML":if(_e!=null)throw Error(n(137,s));break;default:_e!==Re&&Wt(a,s,ve,_e,f,Re)}}Mn(a,b,L,J,pe,Ae,v,m);return;case"select":_e=b=L=ve=null;for(v in l)if(J=l[v],l.hasOwnProperty(v)&&J!=null)switch(v){case"value":break;case"multiple":_e=J;default:f.hasOwnProperty(v)||Wt(a,s,v,null,f,J)}for(m in f)if(v=f[m],J=l[m],f.hasOwnProperty(m)&&(v!=null||J!=null))switch(m){case"value":ve=v;break;case"defaultValue":L=v;break;case"multiple":b=v;default:v!==J&&Wt(a,s,m,v,f,J)}s=L,l=b,f=_e,ve!=null?ci(a,!!l,ve,!1):!!f!=!!l&&(s!=null?ci(a,!!l,s,!0):ci(a,!!l,l?[]:"",!1));return;case"textarea":_e=ve=null;for(L in l)if(m=l[L],l.hasOwnProperty(L)&&m!=null&&!f.hasOwnProperty(L))switch(L){case"value":break;case"children":break;default:Wt(a,s,L,null,f,m)}for(b in f)if(m=f[b],v=l[b],f.hasOwnProperty(b)&&(m!=null||v!=null))switch(b){case"value":ve=m;break;case"defaultValue":_e=m;break;case"children":break;case"dangerouslySetInnerHTML":if(m!=null)throw Error(n(91));break;default:m!==v&&Wt(a,s,b,m,f,v)}Kt(a,ve,_e);return;case"option":for(var it in l)if(ve=l[it],l.hasOwnProperty(it)&&ve!=null&&!f.hasOwnProperty(it))switch(it){case"selected":a.selected=!1;break;default:Wt(a,s,it,null,f,ve)}for(J in f)if(ve=f[J],_e=l[J],f.hasOwnProperty(J)&&ve!==_e&&(ve!=null||_e!=null))switch(J){case"selected":a.selected=ve&&typeof ve!="function"&&typeof ve!="symbol";break;default:Wt(a,s,J,ve,f,_e)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Qe in l)ve=l[Qe],l.hasOwnProperty(Qe)&&ve!=null&&!f.hasOwnProperty(Qe)&&Wt(a,s,Qe,null,f,ve);for(pe in f)if(ve=f[pe],_e=l[pe],f.hasOwnProperty(pe)&&ve!==_e&&(ve!=null||_e!=null))switch(pe){case"children":case"dangerouslySetInnerHTML":if(ve!=null)throw Error(n(137,s));break;default:Wt(a,s,pe,ve,f,_e)}return;default:if(Rc(s)){for(var Yt in l)ve=l[Yt],l.hasOwnProperty(Yt)&&ve!==void 0&&!f.hasOwnProperty(Yt)&&dm(a,s,Yt,void 0,f,ve);for(Ae in f)ve=f[Ae],_e=l[Ae],!f.hasOwnProperty(Ae)||ve===_e||ve===void 0&&_e===void 0||dm(a,s,Ae,ve,f,_e);return}}for(var le in l)ve=l[le],l.hasOwnProperty(le)&&ve!=null&&!f.hasOwnProperty(le)&&Wt(a,s,le,null,f,ve);for(Re in f)ve=f[Re],_e=l[Re],!f.hasOwnProperty(Re)||ve===_e||ve==null&&_e==null||Wt(a,s,Re,ve,f,_e)}var pm=null,mm=null;function Ph(a){return a.nodeType===9?a:a.ownerDocument}function $x(a){switch(a){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function Qx(a,s){if(a===0)switch(s){case"svg":return 1;case"math":return 2;default:return 0}return a===1&&s==="foreignObject"?0:a}function gm(a,s){return a==="textarea"||a==="noscript"||typeof s.children=="string"||typeof s.children=="number"||typeof s.children=="bigint"||typeof s.dangerouslySetInnerHTML=="object"&&s.dangerouslySetInnerHTML!==null&&s.dangerouslySetInnerHTML.__html!=null}var vm=null;function bC(){var a=window.event;return a&&a.type==="popstate"?a===vm?!1:(vm=a,!0):(vm=null,!1)}var Zx=typeof setTimeout=="function"?setTimeout:void 0,IC=typeof clearTimeout=="function"?clearTimeout:void 0,Jx=typeof Promise=="function"?Promise:void 0,DC=typeof queueMicrotask=="function"?queueMicrotask:typeof Jx<"u"?function(a){return Jx.resolve(null).then(a).catch(OC)}:Zx;function OC(a){setTimeout(function(){throw a})}function fs(a){return a==="head"}function ey(a,s){var l=s,f=0,m=0;do{var v=l.nextSibling;if(a.removeChild(l),v&&v.nodeType===8)if(l=v.data,l==="/$"){if(0<f&&8>f){l=f;var b=a.ownerDocument;if(l&1&&hu(b.documentElement),l&2&&hu(b.body),l&4)for(l=b.head,hu(l),b=l.firstChild;b;){var L=b.nextSibling,J=b.nodeName;b[U]||J==="SCRIPT"||J==="STYLE"||J==="LINK"&&b.rel.toLowerCase()==="stylesheet"||l.removeChild(b),b=L}}if(m===0){a.removeChild(v),yu(s);return}m--}else l==="$"||l==="$?"||l==="$!"?m++:f=l.charCodeAt(0)-48;else f=0;l=v}while(l);yu(s)}function _m(a){var s=a.firstChild;for(s&&s.nodeType===10&&(s=s.nextSibling);s;){var l=s;switch(s=s.nextSibling,l.nodeName){case"HTML":case"HEAD":case"BODY":_m(l),B(l);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(l.rel.toLowerCase()==="stylesheet")continue}a.removeChild(l)}}function NC(a,s,l,f){for(;a.nodeType===1;){var m=l;if(a.nodeName.toLowerCase()!==s.toLowerCase()){if(!f&&(a.nodeName!=="INPUT"||a.type!=="hidden"))break}else if(f){if(!a[U])switch(s){case"meta":if(!a.hasAttribute("itemprop"))break;return a;case"link":if(v=a.getAttribute("rel"),v==="stylesheet"&&a.hasAttribute("data-precedence"))break;if(v!==m.rel||a.getAttribute("href")!==(m.href==null||m.href===""?null:m.href)||a.getAttribute("crossorigin")!==(m.crossOrigin==null?null:m.crossOrigin)||a.getAttribute("title")!==(m.title==null?null:m.title))break;return a;case"style":if(a.hasAttribute("data-precedence"))break;return a;case"script":if(v=a.getAttribute("src"),(v!==(m.src==null?null:m.src)||a.getAttribute("type")!==(m.type==null?null:m.type)||a.getAttribute("crossorigin")!==(m.crossOrigin==null?null:m.crossOrigin))&&v&&a.hasAttribute("async")&&!a.hasAttribute("itemprop"))break;return a;default:return a}}else if(s==="input"&&a.type==="hidden"){var v=m.name==null?null:""+m.name;if(m.type==="hidden"&&a.getAttribute("name")===v)return a}else return a;if(a=Aa(a.nextSibling),a===null)break}return null}function FC(a,s,l){if(s==="")return null;for(;a.nodeType!==3;)if((a.nodeType!==1||a.nodeName!=="INPUT"||a.type!=="hidden")&&!l||(a=Aa(a.nextSibling),a===null))return null;return a}function xm(a){return a.data==="$!"||a.data==="$?"&&a.ownerDocument.readyState==="complete"}function PC(a,s){var l=a.ownerDocument;if(a.data!=="$?"||l.readyState==="complete")s();else{var f=function(){s(),l.removeEventListener("DOMContentLoaded",f)};l.addEventListener("DOMContentLoaded",f),a._reactRetry=f}}function Aa(a){for(;a!=null;a=a.nextSibling){var s=a.nodeType;if(s===1||s===3)break;if(s===8){if(s=a.data,s==="$"||s==="$!"||s==="$?"||s==="F!"||s==="F")break;if(s==="/$")return null}}return a}var ym=null;function ty(a){a=a.previousSibling;for(var s=0;a;){if(a.nodeType===8){var l=a.data;if(l==="$"||l==="$!"||l==="$?"){if(s===0)return a;s--}else l==="/$"&&s++}a=a.previousSibling}return null}function ry(a,s,l){switch(s=Ph(l),a){case"html":if(a=s.documentElement,!a)throw Error(n(452));return a;case"head":if(a=s.head,!a)throw Error(n(453));return a;case"body":if(a=s.body,!a)throw Error(n(454));return a;default:throw Error(n(451))}}function hu(a){for(var s=a.attributes;s.length;)a.removeAttributeNode(s[0]);B(a)}var oa=new Map,ny=new Set;function Mh(a){return typeof a.getRootNode=="function"?a.getRootNode():a.nodeType===9?a:a.ownerDocument}var ki=oe.d;oe.d={f:MC,r:LC,D:VC,C:UC,L:BC,m:jC,X:HC,S:zC,M:GC};function MC(){var a=ki.f(),s=Rh();return a||s}function LC(a){var s=X(a);s!==null&&s.tag===5&&s.type==="form"?A_(s):ki.r(a)}var Bl=typeof document>"u"?null:document;function ay(a,s,l){var f=Bl;if(f&&typeof s=="string"&&s){var m=xr(s);m='link[rel="'+a+'"][href="'+m+'"]',typeof l=="string"&&(m+='[crossorigin="'+l+'"]'),ny.has(m)||(ny.add(m),a={rel:a,crossOrigin:l,href:s},f.querySelector(m)===null&&(s=f.createElement("link"),Yr(s,"link",a),ce(s),f.head.appendChild(s)))}}function VC(a){ki.D(a),ay("dns-prefetch",a,null)}function UC(a,s){ki.C(a,s),ay("preconnect",a,s)}function BC(a,s,l){ki.L(a,s,l);var f=Bl;if(f&&a&&s){var m='link[rel="preload"][as="'+xr(s)+'"]';s==="image"&&l&&l.imageSrcSet?(m+='[imagesrcset="'+xr(l.imageSrcSet)+'"]',typeof l.imageSizes=="string"&&(m+='[imagesizes="'+xr(l.imageSizes)+'"]')):m+='[href="'+xr(a)+'"]';var v=m;switch(s){case"style":v=jl(a);break;case"script":v=zl(a)}oa.has(v)||(a=g({rel:"preload",href:s==="image"&&l&&l.imageSrcSet?void 0:a,as:s},l),oa.set(v,a),f.querySelector(m)!==null||s==="style"&&f.querySelector(du(v))||s==="script"&&f.querySelector(pu(v))||(s=f.createElement("link"),Yr(s,"link",a),ce(s),f.head.appendChild(s)))}}function jC(a,s){ki.m(a,s);var l=Bl;if(l&&a){var f=s&&typeof s.as=="string"?s.as:"script",m='link[rel="modulepreload"][as="'+xr(f)+'"][href="'+xr(a)+'"]',v=m;switch(f){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":v=zl(a)}if(!oa.has(v)&&(a=g({rel:"modulepreload",href:a},s),oa.set(v,a),l.querySelector(m)===null)){switch(f){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(l.querySelector(pu(v)))return}f=l.createElement("link"),Yr(f,"link",a),ce(f),l.head.appendChild(f)}}}function zC(a,s,l){ki.S(a,s,l);var f=Bl;if(f&&a){var m=xe(f).hoistableStyles,v=jl(a);s=s||"default";var b=m.get(v);if(!b){var L={loading:0,preload:null};if(b=f.querySelector(du(v)))L.loading=5;else{a=g({rel:"stylesheet",href:a,"data-precedence":s},l),(l=oa.get(v))&&Em(a,l);var J=b=f.createElement("link");ce(J),Yr(J,"link",a),J._p=new Promise(function(pe,Ae){J.onload=pe,J.onerror=Ae}),J.addEventListener("load",function(){L.loading|=1}),J.addEventListener("error",function(){L.loading|=2}),L.loading|=4,Lh(b,s,f)}b={type:"stylesheet",instance:b,count:1,state:L},m.set(v,b)}}}function HC(a,s){ki.X(a,s);var l=Bl;if(l&&a){var f=xe(l).hoistableScripts,m=zl(a),v=f.get(m);v||(v=l.querySelector(pu(m)),v||(a=g({src:a,async:!0},s),(s=oa.get(m))&&Tm(a,s),v=l.createElement("script"),ce(v),Yr(v,"link",a),l.head.appendChild(v)),v={type:"script",instance:v,count:1,state:null},f.set(m,v))}}function GC(a,s){ki.M(a,s);var l=Bl;if(l&&a){var f=xe(l).hoistableScripts,m=zl(a),v=f.get(m);v||(v=l.querySelector(pu(m)),v||(a=g({src:a,async:!0,type:"module"},s),(s=oa.get(m))&&Tm(a,s),v=l.createElement("script"),ce(v),Yr(v,"link",a),l.head.appendChild(v)),v={type:"script",instance:v,count:1,state:null},f.set(m,v))}}function iy(a,s,l,f){var m=(m=ue.current)?Mh(m):null;if(!m)throw Error(n(446));switch(a){case"meta":case"title":return null;case"style":return typeof l.precedence=="string"&&typeof l.href=="string"?(s=jl(l.href),l=xe(m).hoistableStyles,f=l.get(s),f||(f={type:"style",instance:null,count:0,state:null},l.set(s,f)),f):{type:"void",instance:null,count:0,state:null};case"link":if(l.rel==="stylesheet"&&typeof l.href=="string"&&typeof l.precedence=="string"){a=jl(l.href);var v=xe(m).hoistableStyles,b=v.get(a);if(b||(m=m.ownerDocument||m,b={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},v.set(a,b),(v=m.querySelector(du(a)))&&!v._p&&(b.instance=v,b.state.loading=5),oa.has(a)||(l={rel:"preload",as:"style",href:l.href,crossOrigin:l.crossOrigin,integrity:l.integrity,media:l.media,hrefLang:l.hrefLang,referrerPolicy:l.referrerPolicy},oa.set(a,l),v||qC(m,a,l,b.state))),s&&f===null)throw Error(n(528,""));return b}if(s&&f!==null)throw Error(n(529,""));return null;case"script":return s=l.async,l=l.src,typeof l=="string"&&s&&typeof s!="function"&&typeof s!="symbol"?(s=zl(l),l=xe(m).hoistableScripts,f=l.get(s),f||(f={type:"script",instance:null,count:0,state:null},l.set(s,f)),f):{type:"void",instance:null,count:0,state:null};default:throw Error(n(444,a))}}function jl(a){return'href="'+xr(a)+'"'}function du(a){return'link[rel="stylesheet"]['+a+"]"}function sy(a){return g({},a,{"data-precedence":a.precedence,precedence:null})}function qC(a,s,l,f){a.querySelector('link[rel="preload"][as="style"]['+s+"]")?f.loading=1:(s=a.createElement("link"),f.preload=s,s.addEventListener("load",function(){return f.loading|=1}),s.addEventListener("error",function(){return f.loading|=2}),Yr(s,"link",l),ce(s),a.head.appendChild(s))}function zl(a){return'[src="'+xr(a)+'"]'}function pu(a){return"script[async]"+a}function oy(a,s,l){if(s.count++,s.instance===null)switch(s.type){case"style":var f=a.querySelector('style[data-href~="'+xr(l.href)+'"]');if(f)return s.instance=f,ce(f),f;var m=g({},l,{"data-href":l.href,"data-precedence":l.precedence,href:null,precedence:null});return f=(a.ownerDocument||a).createElement("style"),ce(f),Yr(f,"style",m),Lh(f,l.precedence,a),s.instance=f;case"stylesheet":m=jl(l.href);var v=a.querySelector(du(m));if(v)return s.state.loading|=4,s.instance=v,ce(v),v;f=sy(l),(m=oa.get(m))&&Em(f,m),v=(a.ownerDocument||a).createElement("link"),ce(v);var b=v;return b._p=new Promise(function(L,J){b.onload=L,b.onerror=J}),Yr(v,"link",f),s.state.loading|=4,Lh(v,l.precedence,a),s.instance=v;case"script":return v=zl(l.src),(m=a.querySelector(pu(v)))?(s.instance=m,ce(m),m):(f=l,(m=oa.get(v))&&(f=g({},l),Tm(f,m)),a=a.ownerDocument||a,m=a.createElement("script"),ce(m),Yr(m,"link",f),a.head.appendChild(m),s.instance=m);case"void":return null;default:throw Error(n(443,s.type))}else s.type==="stylesheet"&&(s.state.loading&4)===0&&(f=s.instance,s.state.loading|=4,Lh(f,l.precedence,a));return s.instance}function Lh(a,s,l){for(var f=l.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),m=f.length?f[f.length-1]:null,v=m,b=0;b<f.length;b++){var L=f[b];if(L.dataset.precedence===s)v=L;else if(v!==m)break}v?v.parentNode.insertBefore(a,v.nextSibling):(s=l.nodeType===9?l.head:l,s.insertBefore(a,s.firstChild))}function Em(a,s){a.crossOrigin==null&&(a.crossOrigin=s.crossOrigin),a.referrerPolicy==null&&(a.referrerPolicy=s.referrerPolicy),a.title==null&&(a.title=s.title)}function Tm(a,s){a.crossOrigin==null&&(a.crossOrigin=s.crossOrigin),a.referrerPolicy==null&&(a.referrerPolicy=s.referrerPolicy),a.integrity==null&&(a.integrity=s.integrity)}var Vh=null;function ly(a,s,l){if(Vh===null){var f=new Map,m=Vh=new Map;m.set(l,f)}else m=Vh,f=m.get(l),f||(f=new Map,m.set(l,f));if(f.has(a))return f;for(f.set(a,null),l=l.getElementsByTagName(a),m=0;m<l.length;m++){var v=l[m];if(!(v[U]||v[hr]||a==="link"&&v.getAttribute("rel")==="stylesheet")&&v.namespaceURI!=="http://www.w3.org/2000/svg"){var b=v.getAttribute(s)||"";b=a+b;var L=f.get(b);L?L.push(v):f.set(b,[v])}}return f}function cy(a,s,l){a=a.ownerDocument||a,a.head.insertBefore(l,s==="title"?a.querySelector("head > title"):null)}function KC(a,s,l){if(l===1||s.itemProp!=null)return!1;switch(a){case"meta":case"title":return!0;case"style":if(typeof s.precedence!="string"||typeof s.href!="string"||s.href==="")break;return!0;case"link":if(typeof s.rel!="string"||typeof s.href!="string"||s.href===""||s.onLoad||s.onError)break;switch(s.rel){case"stylesheet":return a=s.disabled,typeof s.precedence=="string"&&a==null;default:return!0}case"script":if(s.async&&typeof s.async!="function"&&typeof s.async!="symbol"&&!s.onLoad&&!s.onError&&s.src&&typeof s.src=="string")return!0}return!1}function uy(a){return!(a.type==="stylesheet"&&(a.state.loading&3)===0)}var mu=null;function XC(){}function WC(a,s,l){if(mu===null)throw Error(n(475));var f=mu;if(s.type==="stylesheet"&&(typeof l.media!="string"||matchMedia(l.media).matches!==!1)&&(s.state.loading&4)===0){if(s.instance===null){var m=jl(l.href),v=a.querySelector(du(m));if(v){a=v._p,a!==null&&typeof a=="object"&&typeof a.then=="function"&&(f.count++,f=Uh.bind(f),a.then(f,f)),s.state.loading|=4,s.instance=v,ce(v);return}v=a.ownerDocument||a,l=sy(l),(m=oa.get(m))&&Em(l,m),v=v.createElement("link"),ce(v);var b=v;b._p=new Promise(function(L,J){b.onload=L,b.onerror=J}),Yr(v,"link",l),s.instance=v}f.stylesheets===null&&(f.stylesheets=new Map),f.stylesheets.set(s,a),(a=s.state.preload)&&(s.state.loading&3)===0&&(f.count++,s=Uh.bind(f),a.addEventListener("load",s),a.addEventListener("error",s))}}function YC(){if(mu===null)throw Error(n(475));var a=mu;return a.stylesheets&&a.count===0&&Am(a,a.stylesheets),0<a.count?function(s){var l=setTimeout(function(){if(a.stylesheets&&Am(a,a.stylesheets),a.unsuspend){var f=a.unsuspend;a.unsuspend=null,f()}},6e4);return a.unsuspend=s,function(){a.unsuspend=null,clearTimeout(l)}}:null}function Uh(){if(this.count--,this.count===0){if(this.stylesheets)Am(this,this.stylesheets);else if(this.unsuspend){var a=this.unsuspend;this.unsuspend=null,a()}}}var Bh=null;function Am(a,s){a.stylesheets=null,a.unsuspend!==null&&(a.count++,Bh=new Map,s.forEach($C,a),Bh=null,Uh.call(a))}function $C(a,s){if(!(s.state.loading&4)){var l=Bh.get(a);if(l)var f=l.get(null);else{l=new Map,Bh.set(a,l);for(var m=a.querySelectorAll("link[data-precedence],style[data-precedence]"),v=0;v<m.length;v++){var b=m[v];(b.nodeName==="LINK"||b.getAttribute("media")!=="not all")&&(l.set(b.dataset.precedence,b),f=b)}f&&l.set(null,f)}m=s.instance,b=m.getAttribute("data-precedence"),v=l.get(b)||f,v===f&&l.set(null,m),l.set(b,m),this.count++,f=Uh.bind(this),m.addEventListener("load",f),m.addEventListener("error",f),v?v.parentNode.insertBefore(m,v.nextSibling):(a=a.nodeType===9?a.head:a,a.insertBefore(m,a.firstChild)),s.state.loading|=4}}var gu={$$typeof:P,Provider:null,Consumer:null,_currentValue:be,_currentValue2:be,_threadCount:0};function QC(a,s,l,f,m,v,b,L){this.tag=1,this.containerInfo=a,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=_a(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=_a(0),this.hiddenUpdates=_a(null),this.identifierPrefix=f,this.onUncaughtError=m,this.onCaughtError=v,this.onRecoverableError=b,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=L,this.incompleteTransitions=new Map}function fy(a,s,l,f,m,v,b,L,J,pe,Ae,Re){return a=new QC(a,s,l,b,L,J,pe,Re),s=1,v===!0&&(s|=24),v=Vn(3,null,null,s),a.current=v,v.stateNode=a,s=ap(),s.refCount++,a.pooledCache=s,s.refCount++,v.memoizedState={element:f,isDehydrated:l,cache:s},lp(v),a}function hy(a){return a?(a=xl,a):xl}function dy(a,s,l,f,m,v){m=hy(m),f.context===null?f.context=m:f.pendingContext=m,f=Zi(s),f.payload={element:l},v=v===void 0?null:v,v!==null&&(f.callback=v),l=Ji(a,f,s),l!==null&&(Hn(l,a,s),Kc(l,a,s))}function py(a,s){if(a=a.memoizedState,a!==null&&a.dehydrated!==null){var l=a.retryLane;a.retryLane=l!==0&&l<s?l:s}}function wm(a,s){py(a,s),(a=a.alternate)&&py(a,s)}function my(a){if(a.tag===13){var s=_l(a,67108864);s!==null&&Hn(s,a,67108864),wm(a,67108864)}}var jh=!0;function ZC(a,s,l,f){var m=ne.T;ne.T=null;var v=oe.p;try{oe.p=2,Sm(a,s,l,f)}finally{oe.p=v,ne.T=m}}function JC(a,s,l,f){var m=ne.T;ne.T=null;var v=oe.p;try{oe.p=8,Sm(a,s,l,f)}finally{oe.p=v,ne.T=m}}function Sm(a,s,l,f){if(jh){var m=Cm(f);if(m===null)hm(a,s,f,zh,l),vy(a,f);else if(tR(m,a,s,l,f))f.stopPropagation();else if(vy(a,f),s&4&&-1<eR.indexOf(a)){for(;m!==null;){var v=X(m);if(v!==null)switch(v.tag){case 3:if(v=v.stateNode,v.current.memoizedState.isDehydrated){var b=Cn(v.pendingLanes);if(b!==0){var L=v;for(L.pendingLanes|=2,L.entangledLanes|=2;b;){var J=1<<31-Lt(b);L.entanglements[1]|=J,b&=~J}Ya(v),(zt&6)===0&&(Sh=Ne()+500,cu(0))}}break;case 13:L=_l(v,2),L!==null&&Hn(L,v,2),Rh(),wm(v,2)}if(v=Cm(f),v===null&&hm(a,s,f,zh,l),v===m)break;m=v}m!==null&&f.stopPropagation()}else hm(a,s,f,null,l)}}function Cm(a){return a=Zn(a),Rm(a)}var zh=null;function Rm(a){if(zh=null,a=H(a),a!==null){var s=o(a);if(s===null)a=null;else{var l=s.tag;if(l===13){if(a=c(s),a!==null)return a;a=null}else if(l===3){if(s.stateNode.current.memoizedState.isDehydrated)return s.tag===3?s.stateNode.containerInfo:null;a=null}else s!==a&&(a=null)}}return zh=a,null}function gy(a){switch(a){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Ye()){case ut:return 2;case _t:return 8;case rr:case _r:return 32;case fr:return 268435456;default:return 32}default:return 32}}var km=!1,hs=null,ds=null,ps=null,vu=new Map,_u=new Map,ms=[],eR="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function vy(a,s){switch(a){case"focusin":case"focusout":hs=null;break;case"dragenter":case"dragleave":ds=null;break;case"mouseover":case"mouseout":ps=null;break;case"pointerover":case"pointerout":vu.delete(s.pointerId);break;case"gotpointercapture":case"lostpointercapture":_u.delete(s.pointerId)}}function xu(a,s,l,f,m,v){return a===null||a.nativeEvent!==v?(a={blockedOn:s,domEventName:l,eventSystemFlags:f,nativeEvent:v,targetContainers:[m]},s!==null&&(s=X(s),s!==null&&my(s)),a):(a.eventSystemFlags|=f,s=a.targetContainers,m!==null&&s.indexOf(m)===-1&&s.push(m),a)}function tR(a,s,l,f,m){switch(s){case"focusin":return hs=xu(hs,a,s,l,f,m),!0;case"dragenter":return ds=xu(ds,a,s,l,f,m),!0;case"mouseover":return ps=xu(ps,a,s,l,f,m),!0;case"pointerover":var v=m.pointerId;return vu.set(v,xu(vu.get(v)||null,a,s,l,f,m)),!0;case"gotpointercapture":return v=m.pointerId,_u.set(v,xu(_u.get(v)||null,a,s,l,f,m)),!0}return!1}function _y(a){var s=H(a.target);if(s!==null){var l=o(s);if(l!==null){if(s=l.tag,s===13){if(s=c(l),s!==null){a.blockedOn=s,nl(a.priority,function(){if(l.tag===13){var f=zn();f=Fa(f);var m=_l(l,f);m!==null&&Hn(m,l,f),wm(l,f)}});return}}else if(s===3&&l.stateNode.current.memoizedState.isDehydrated){a.blockedOn=l.tag===3?l.stateNode.containerInfo:null;return}}}a.blockedOn=null}function Hh(a){if(a.blockedOn!==null)return!1;for(var s=a.targetContainers;0<s.length;){var l=Cm(a.nativeEvent);if(l===null){l=a.nativeEvent;var f=new l.constructor(l.type,l);ui=f,l.target.dispatchEvent(f),ui=null}else return s=X(l),s!==null&&my(s),a.blockedOn=l,!1;s.shift()}return!0}function xy(a,s,l){Hh(a)&&l.delete(s)}function rR(){km=!1,hs!==null&&Hh(hs)&&(hs=null),ds!==null&&Hh(ds)&&(ds=null),ps!==null&&Hh(ps)&&(ps=null),vu.forEach(xy),_u.forEach(xy)}function Gh(a,s){a.blockedOn===s&&(a.blockedOn=null,km||(km=!0,t.unstable_scheduleCallback(t.unstable_NormalPriority,rR)))}var qh=null;function yy(a){qh!==a&&(qh=a,t.unstable_scheduleCallback(t.unstable_NormalPriority,function(){qh===a&&(qh=null);for(var s=0;s<a.length;s+=3){var l=a[s],f=a[s+1],m=a[s+2];if(typeof f!="function"){if(Rm(f||l)===null)continue;break}var v=X(l);v!==null&&(a.splice(s,3),s-=3,Rp(v,{pending:!0,data:m,method:l.method,action:f},f,m))}}))}function yu(a){function s(J){return Gh(J,a)}hs!==null&&Gh(hs,a),ds!==null&&Gh(ds,a),ps!==null&&Gh(ps,a),vu.forEach(s),_u.forEach(s);for(var l=0;l<ms.length;l++){var f=ms[l];f.blockedOn===a&&(f.blockedOn=null)}for(;0<ms.length&&(l=ms[0],l.blockedOn===null);)_y(l),l.blockedOn===null&&ms.shift();if(l=(a.ownerDocument||a).$$reactFormReplay,l!=null)for(f=0;f<l.length;f+=3){var m=l[f],v=l[f+1],b=m[nr]||null;if(typeof v=="function")b||yy(l);else if(b){var L=null;if(v&&v.hasAttribute("formAction")){if(m=v,b=v[nr]||null)L=b.formAction;else if(Rm(m)!==null)continue}else L=b.action;typeof L=="function"?l[f+1]=L:(l.splice(f,3),f-=3),yy(l)}}}function bm(a){this._internalRoot=a}Kh.prototype.render=bm.prototype.render=function(a){var s=this._internalRoot;if(s===null)throw Error(n(409));var l=s.current,f=zn();dy(l,f,a,s,null,null)},Kh.prototype.unmount=bm.prototype.unmount=function(){var a=this._internalRoot;if(a!==null){this._internalRoot=null;var s=a.containerInfo;dy(a.current,2,null,a,null,null),Rh(),s[Rn]=null}};function Kh(a){this._internalRoot=a}Kh.prototype.unstable_scheduleHydration=function(a){if(a){var s=Pa();a={blockedOn:null,target:a,priority:s};for(var l=0;l<ms.length&&s!==0&&s<ms[l].priority;l++);ms.splice(l,0,a),l===0&&_y(a)}};var Ey=e.version;if(Ey!=="19.1.0")throw Error(n(527,Ey,"19.1.0"));oe.findDOMNode=function(a){var s=a._reactInternals;if(s===void 0)throw typeof a.render=="function"?Error(n(188)):(a=Object.keys(a).join(","),Error(n(268,a)));return a=h(s),a=a!==null?d(a):null,a=a===null?null:a.stateNode,a};var nR={bundleType:0,version:"19.1.0",rendererPackageName:"react-dom",currentDispatcherRef:ne,reconcilerVersion:"19.1.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Xh=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Xh.isDisabled&&Xh.supportsFiber)try{Ze=Xh.inject(nR),Je=Xh}catch{}}return Tu.createRoot=function(a,s){if(!i(a))throw Error(n(299));var l=!1,f="",m=L_,v=V_,b=U_,L=null;return s!=null&&(s.unstable_strictMode===!0&&(l=!0),s.identifierPrefix!==void 0&&(f=s.identifierPrefix),s.onUncaughtError!==void 0&&(m=s.onUncaughtError),s.onCaughtError!==void 0&&(v=s.onCaughtError),s.onRecoverableError!==void 0&&(b=s.onRecoverableError),s.unstable_transitionCallbacks!==void 0&&(L=s.unstable_transitionCallbacks)),s=fy(a,1,!1,null,null,l,f,m,v,b,L,null),a[Rn]=s.current,fm(a),new bm(s)},Tu.hydrateRoot=function(a,s,l){if(!i(a))throw Error(n(299));var f=!1,m="",v=L_,b=V_,L=U_,J=null,pe=null;return l!=null&&(l.unstable_strictMode===!0&&(f=!0),l.identifierPrefix!==void 0&&(m=l.identifierPrefix),l.onUncaughtError!==void 0&&(v=l.onUncaughtError),l.onCaughtError!==void 0&&(b=l.onCaughtError),l.onRecoverableError!==void 0&&(L=l.onRecoverableError),l.unstable_transitionCallbacks!==void 0&&(J=l.unstable_transitionCallbacks),l.formState!==void 0&&(pe=l.formState)),s=fy(a,1,!0,s,l??null,f,m,v,b,L,J,pe),s.context=hy(null),l=s.current,f=zn(),f=Fa(f),m=Zi(f),m.callback=null,Ji(l,m,f),l=f,s.current.lanes=l,xa(s,l),Ya(s),a[Rn]=s.current,fm(a),new Kh(s)},Tu.version="19.1.0",Tu}var Dy;function pR(){if(Dy)return Om.exports;Dy=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}return t(),Om.exports=dR(),Om.exports}var mR=pR();const gR=zg(mR);v2();/**
 * @remix-run/router v1.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Wu(){return Wu=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Wu.apply(this,arguments)}var ws;(function(t){t.Pop="POP",t.Push="PUSH",t.Replace="REPLACE"})(ws||(ws={}));const Oy="popstate";function vR(t){t===void 0&&(t={});function e(i,o){let{pathname:c="/",search:u="",hash:h=""}=Go(i.location.hash.substr(1));return!c.startsWith("/")&&!c.startsWith(".")&&(c="/"+c),ag("",{pathname:c,search:u,hash:h},o.state&&o.state.usr||null,o.state&&o.state.key||"default")}function r(i,o){let c=i.document.querySelector("base"),u="";if(c&&c.getAttribute("href")){let h=i.location.href,d=h.indexOf("#");u=d===-1?h:h.slice(0,d)}return u+"#"+(typeof o=="string"?o:T0(o))}function n(i,o){Gg(i.pathname.charAt(0)==="/","relative pathnames are not supported in hash history.push("+JSON.stringify(o)+")")}return xR(e,r,n,t)}function vr(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function Gg(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function _R(){return Math.random().toString(36).substr(2,8)}function Ny(t,e){return{usr:t.state,key:t.key,idx:e}}function ag(t,e,r,n){return r===void 0&&(r=null),Wu({pathname:typeof t=="string"?t:t.pathname,search:"",hash:""},typeof e=="string"?Go(e):e,{state:r,key:e&&e.key||n||_R()})}function T0(t){let{pathname:e="/",search:r="",hash:n=""}=t;return r&&r!=="?"&&(e+=r.charAt(0)==="?"?r:"?"+r),n&&n!=="#"&&(e+=n.charAt(0)==="#"?n:"#"+n),e}function Go(t){let e={};if(t){let r=t.indexOf("#");r>=0&&(e.hash=t.substr(r),t=t.substr(0,r));let n=t.indexOf("?");n>=0&&(e.search=t.substr(n),t=t.substr(0,n)),t&&(e.pathname=t)}return e}function xR(t,e,r,n){n===void 0&&(n={});let{window:i=document.defaultView,v5Compat:o=!1}=n,c=i.history,u=ws.Pop,h=null,d=g();d==null&&(d=0,c.replaceState(Wu({},c.state,{idx:d}),""));function g(){return(c.state||{idx:null}).idx}function _(){u=ws.Pop;let C=g(),z=C==null?null:C-d;d=C,h&&h({action:u,location:S.location,delta:z})}function x(C,z){u=ws.Push;let W=ag(S.location,C,z);r&&r(W,C),d=g()+1;let P=Ny(W,d),re=S.createHref(W);try{c.pushState(P,"",re)}catch(Q){if(Q instanceof DOMException&&Q.name==="DataCloneError")throw Q;i.location.assign(re)}o&&h&&h({action:u,location:S.location,delta:1})}function A(C,z){u=ws.Replace;let W=ag(S.location,C,z);r&&r(W,C),d=g();let P=Ny(W,d),re=S.createHref(W);c.replaceState(P,"",re),o&&h&&h({action:u,location:S.location,delta:0})}function w(C){let z=i.location.origin!=="null"?i.location.origin:i.location.href,W=typeof C=="string"?C:T0(C);return W=W.replace(/ $/,"%20"),vr(z,"No window.location.(origin|href) available to create URL for href: "+W),new URL(W,z)}let S={get action(){return u},get location(){return t(i,c)},listen(C){if(h)throw new Error("A history only accepts one active listener");return i.addEventListener(Oy,_),h=C,()=>{i.removeEventListener(Oy,_),h=null}},createHref(C){return e(i,C)},createURL:w,encodeLocation(C){let z=w(C);return{pathname:z.pathname,search:z.search,hash:z.hash}},push:x,replace:A,go(C){return c.go(C)}};return S}var Fy;(function(t){t.data="data",t.deferred="deferred",t.redirect="redirect",t.error="error"})(Fy||(Fy={}));function yR(t,e,r){return r===void 0&&(r="/"),ER(t,e,r)}function ER(t,e,r,n){let i=typeof e=="string"?Go(e):e,o=qg(i.pathname||"/",r);if(o==null)return null;let c=_2(t);TR(c);let u=null;for(let h=0;u==null&&h<c.length;++h){let d=FR(o);u=DR(c[h],d)}return u}function _2(t,e,r,n){e===void 0&&(e=[]),r===void 0&&(r=[]),n===void 0&&(n="");let i=(o,c,u)=>{let h={relativePath:u===void 0?o.path||"":u,caseSensitive:o.caseSensitive===!0,childrenIndex:c,route:o};h.relativePath.startsWith("/")&&(vr(h.relativePath.startsWith(n),'Absolute route path "'+h.relativePath+'" nested under path '+('"'+n+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),h.relativePath=h.relativePath.slice(n.length));let d=ks([n,h.relativePath]),g=r.concat(h);o.children&&o.children.length>0&&(vr(o.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+d+'".')),_2(o.children,e,g,d)),!(o.path==null&&!o.index)&&e.push({path:d,score:bR(d,o.index),routesMeta:g})};return t.forEach((o,c)=>{var u;if(o.path===""||!((u=o.path)!=null&&u.includes("?")))i(o,c);else for(let h of x2(o.path))i(o,c,h)}),e}function x2(t){let e=t.split("/");if(e.length===0)return[];let[r,...n]=e,i=r.endsWith("?"),o=r.replace(/\?$/,"");if(n.length===0)return i?[o,""]:[o];let c=x2(n.join("/")),u=[];return u.push(...c.map(h=>h===""?o:[o,h].join("/"))),i&&u.push(...c),u.map(h=>t.startsWith("/")&&h===""?"/":h)}function TR(t){t.sort((e,r)=>e.score!==r.score?r.score-e.score:IR(e.routesMeta.map(n=>n.childrenIndex),r.routesMeta.map(n=>n.childrenIndex)))}const AR=/^:[\w-]+$/,wR=3,SR=2,CR=1,RR=10,kR=-2,Py=t=>t==="*";function bR(t,e){let r=t.split("/"),n=r.length;return r.some(Py)&&(n+=kR),e&&(n+=SR),r.filter(i=>!Py(i)).reduce((i,o)=>i+(AR.test(o)?wR:o===""?CR:RR),n)}function IR(t,e){return t.length===e.length&&t.slice(0,-1).every((n,i)=>n===e[i])?t[t.length-1]-e[e.length-1]:0}function DR(t,e,r){let{routesMeta:n}=t,i={},o="/",c=[];for(let u=0;u<n.length;++u){let h=n[u],d=u===n.length-1,g=o==="/"?e:e.slice(o.length)||"/",_=OR({path:h.relativePath,caseSensitive:h.caseSensitive,end:d},g),x=h.route;if(!_)return null;Object.assign(i,_.params),c.push({params:i,pathname:ks([o,_.pathname]),pathnameBase:VR(ks([o,_.pathnameBase])),route:x}),_.pathnameBase!=="/"&&(o=ks([o,_.pathnameBase]))}return c}function OR(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[r,n]=NR(t.path,t.caseSensitive,t.end),i=e.match(r);if(!i)return null;let o=i[0],c=o.replace(/(.)\/+$/,"$1"),u=i.slice(1);return{params:n.reduce((d,g,_)=>{let{paramName:x,isOptional:A}=g;if(x==="*"){let S=u[_]||"";c=o.slice(0,o.length-S.length).replace(/(.)\/+$/,"$1")}const w=u[_];return A&&!w?d[x]=void 0:d[x]=(w||"").replace(/%2F/g,"/"),d},{}),pathname:o,pathnameBase:c,pattern:t}}function NR(t,e,r){e===void 0&&(e=!1),r===void 0&&(r=!0),Gg(t==="*"||!t.endsWith("*")||t.endsWith("/*"),'Route path "'+t+'" will be treated as if it were '+('"'+t.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+t.replace(/\*$/,"/*")+'".'));let n=[],i="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(c,u,h)=>(n.push({paramName:u,isOptional:h!=null}),h?"/?([^\\/]+)?":"/([^\\/]+)"));return t.endsWith("*")?(n.push({paramName:"*"}),i+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?i+="\\/*$":t!==""&&t!=="/"&&(i+="(?:(?=\\/|$))"),[new RegExp(i,e?void 0:"i"),n]}function FR(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return Gg(!1,'The URL path "'+t+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),t}}function qg(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let r=e.endsWith("/")?e.length-1:e.length,n=t.charAt(r);return n&&n!=="/"?null:t.slice(r)||"/"}function PR(t,e){e===void 0&&(e="/");let{pathname:r,search:n="",hash:i=""}=typeof t=="string"?Go(t):t;return{pathname:r?r.startsWith("/")?r:MR(r,e):e,search:UR(n),hash:BR(i)}}function MR(t,e){let r=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(i=>{i===".."?r.length>1&&r.pop():i!=="."&&r.push(i)}),r.length>1?r.join("/"):"/"}function Mm(t,e,r,n){return"Cannot include a '"+t+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(n)+"].  Please separate it out to the ")+("`to."+r+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function LR(t){return t.filter((e,r)=>r===0||e.route.path&&e.route.path.length>0)}function Kg(t,e){let r=LR(t);return e?r.map((n,i)=>i===r.length-1?n.pathname:n.pathnameBase):r.map(n=>n.pathnameBase)}function Xg(t,e,r,n){n===void 0&&(n=!1);let i;typeof t=="string"?i=Go(t):(i=Wu({},t),vr(!i.pathname||!i.pathname.includes("?"),Mm("?","pathname","search",i)),vr(!i.pathname||!i.pathname.includes("#"),Mm("#","pathname","hash",i)),vr(!i.search||!i.search.includes("#"),Mm("#","search","hash",i)));let o=t===""||i.pathname==="",c=o?"/":i.pathname,u;if(c==null)u=r;else{let _=e.length-1;if(!n&&c.startsWith("..")){let x=c.split("/");for(;x[0]==="..";)x.shift(),_-=1;i.pathname=x.join("/")}u=_>=0?e[_]:"/"}let h=PR(i,u),d=c&&c!=="/"&&c.endsWith("/"),g=(o||c===".")&&r.endsWith("/");return!h.pathname.endsWith("/")&&(d||g)&&(h.pathname+="/"),h}const ks=t=>t.join("/").replace(/\/\/+/g,"/"),VR=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),UR=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,BR=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function jR(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}const y2=["post","put","patch","delete"];new Set(y2);const zR=["get",...y2];new Set(zR);/**
 * React Router v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Yu(){return Yu=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Yu.apply(this,arguments)}const Wg=Pe.createContext(null),HR=Pe.createContext(null),Xs=Pe.createContext(null),ed=Pe.createContext(null),Ws=Pe.createContext({outlet:null,matches:[],isDataRoute:!1}),E2=Pe.createContext(null);function GR(t,e){let{relative:r}=e===void 0?{}:e;pc()||vr(!1);let{basename:n,navigator:i}=Pe.useContext(Xs),{hash:o,pathname:c,search:u}=A2(t,{relative:r}),h=c;return n!=="/"&&(h=c==="/"?n:ks([n,c])),i.createHref({pathname:h,search:u,hash:o})}function pc(){return Pe.useContext(ed)!=null}function mf(){return pc()||vr(!1),Pe.useContext(ed).location}function T2(t){Pe.useContext(Xs).static||Pe.useLayoutEffect(t)}function Yg(){let{isDataRoute:t}=Pe.useContext(Ws);return t?nk():qR()}function qR(){pc()||vr(!1);let t=Pe.useContext(Wg),{basename:e,future:r,navigator:n}=Pe.useContext(Xs),{matches:i}=Pe.useContext(Ws),{pathname:o}=mf(),c=JSON.stringify(Kg(i,r.v7_relativeSplatPath)),u=Pe.useRef(!1);return T2(()=>{u.current=!0}),Pe.useCallback(function(d,g){if(g===void 0&&(g={}),!u.current)return;if(typeof d=="number"){n.go(d);return}let _=Xg(d,JSON.parse(c),o,g.relative==="path");t==null&&e!=="/"&&(_.pathname=_.pathname==="/"?e:ks([e,_.pathname])),(g.replace?n.replace:n.push)(_,g.state,g)},[e,n,c,o,t])}function A2(t,e){let{relative:r}=e===void 0?{}:e,{future:n}=Pe.useContext(Xs),{matches:i}=Pe.useContext(Ws),{pathname:o}=mf(),c=JSON.stringify(Kg(i,n.v7_relativeSplatPath));return Pe.useMemo(()=>Xg(t,JSON.parse(c),o,r==="path"),[t,c,o,r])}function KR(t,e){return XR(t,e)}function XR(t,e,r,n){pc()||vr(!1);let{navigator:i}=Pe.useContext(Xs),{matches:o}=Pe.useContext(Ws),c=o[o.length-1],u=c?c.params:{};c&&c.pathname;let h=c?c.pathnameBase:"/";c&&c.route;let d=mf(),g;if(e){var _;let C=typeof e=="string"?Go(e):e;h==="/"||(_=C.pathname)!=null&&_.startsWith(h)||vr(!1),g=C}else g=d;let x=g.pathname||"/",A=x;if(h!=="/"){let C=h.replace(/^\//,"").split("/");A="/"+x.replace(/^\//,"").split("/").slice(C.length).join("/")}let w=yR(t,{pathname:A}),S=ZR(w&&w.map(C=>Object.assign({},C,{params:Object.assign({},u,C.params),pathname:ks([h,i.encodeLocation?i.encodeLocation(C.pathname).pathname:C.pathname]),pathnameBase:C.pathnameBase==="/"?h:ks([h,i.encodeLocation?i.encodeLocation(C.pathnameBase).pathname:C.pathnameBase])})),o,r,n);return e&&S?Pe.createElement(ed.Provider,{value:{location:Yu({pathname:"/",search:"",hash:"",state:null,key:"default"},g),navigationType:ws.Pop}},S):S}function WR(){let t=rk(),e=jR(t)?t.status+" "+t.statusText:t instanceof Error?t.message:JSON.stringify(t),r=t instanceof Error?t.stack:null,i={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return Pe.createElement(Pe.Fragment,null,Pe.createElement("h2",null,"Unexpected Application Error!"),Pe.createElement("h3",{style:{fontStyle:"italic"}},e),r?Pe.createElement("pre",{style:i},r):null,null)}const YR=Pe.createElement(WR,null);class $R extends Pe.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,r){return r.location!==e.location||r.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:r.error,location:r.location,revalidation:e.revalidation||r.revalidation}}componentDidCatch(e,r){console.error("React Router caught the following error during render",e,r)}render(){return this.state.error!==void 0?Pe.createElement(Ws.Provider,{value:this.props.routeContext},Pe.createElement(E2.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function QR(t){let{routeContext:e,match:r,children:n}=t,i=Pe.useContext(Wg);return i&&i.static&&i.staticContext&&(r.route.errorElement||r.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=r.route.id),Pe.createElement(Ws.Provider,{value:e},n)}function ZR(t,e,r,n){var i;if(e===void 0&&(e=[]),r===void 0&&(r=null),n===void 0&&(n=null),t==null){var o;if(!r)return null;if(r.errors)t=r.matches;else if((o=n)!=null&&o.v7_partialHydration&&e.length===0&&!r.initialized&&r.matches.length>0)t=r.matches;else return null}let c=t,u=(i=r)==null?void 0:i.errors;if(u!=null){let g=c.findIndex(_=>_.route.id&&u?.[_.route.id]!==void 0);g>=0||vr(!1),c=c.slice(0,Math.min(c.length,g+1))}let h=!1,d=-1;if(r&&n&&n.v7_partialHydration)for(let g=0;g<c.length;g++){let _=c[g];if((_.route.HydrateFallback||_.route.hydrateFallbackElement)&&(d=g),_.route.id){let{loaderData:x,errors:A}=r,w=_.route.loader&&x[_.route.id]===void 0&&(!A||A[_.route.id]===void 0);if(_.route.lazy||w){h=!0,d>=0?c=c.slice(0,d+1):c=[c[0]];break}}}return c.reduceRight((g,_,x)=>{let A,w=!1,S=null,C=null;r&&(A=u&&_.route.id?u[_.route.id]:void 0,S=_.route.errorElement||YR,h&&(d<0&&x===0?(ak("route-fallback"),w=!0,C=null):d===x&&(w=!0,C=_.route.hydrateFallbackElement||null)));let z=e.concat(c.slice(0,x+1)),W=()=>{let P;return A?P=S:w?P=C:_.route.Component?P=Pe.createElement(_.route.Component,null):_.route.element?P=_.route.element:P=g,Pe.createElement(QR,{match:_,routeContext:{outlet:g,matches:z,isDataRoute:r!=null},children:P})};return r&&(_.route.ErrorBoundary||_.route.errorElement||x===0)?Pe.createElement($R,{location:r.location,revalidation:r.revalidation,component:S,error:A,children:W(),routeContext:{outlet:null,matches:z,isDataRoute:!0}}):W()},null)}var w2=function(t){return t.UseBlocker="useBlocker",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t}(w2||{}),S2=function(t){return t.UseBlocker="useBlocker",t.UseLoaderData="useLoaderData",t.UseActionData="useActionData",t.UseRouteError="useRouteError",t.UseNavigation="useNavigation",t.UseRouteLoaderData="useRouteLoaderData",t.UseMatches="useMatches",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t.UseRouteId="useRouteId",t}(S2||{});function JR(t){let e=Pe.useContext(Wg);return e||vr(!1),e}function ek(t){let e=Pe.useContext(HR);return e||vr(!1),e}function tk(t){let e=Pe.useContext(Ws);return e||vr(!1),e}function C2(t){let e=tk(),r=e.matches[e.matches.length-1];return r.route.id||vr(!1),r.route.id}function rk(){var t;let e=Pe.useContext(E2),r=ek(),n=C2();return e!==void 0?e:(t=r.errors)==null?void 0:t[n]}function nk(){let{router:t}=JR(w2.UseNavigateStable),e=C2(S2.UseNavigateStable),r=Pe.useRef(!1);return T2(()=>{r.current=!0}),Pe.useCallback(function(i,o){o===void 0&&(o={}),r.current&&(typeof i=="number"?t.navigate(i):t.navigate(i,Yu({fromRouteId:e},o)))},[t,e])}const My={};function ak(t,e,r){My[t]||(My[t]=!0)}function ik(t,e){t?.v7_startTransition,t?.v7_relativeSplatPath}function R2(t){let{to:e,replace:r,state:n,relative:i}=t;pc()||vr(!1);let{future:o,static:c}=Pe.useContext(Xs),{matches:u}=Pe.useContext(Ws),{pathname:h}=mf(),d=Yg(),g=Xg(e,Kg(u,o.v7_relativeSplatPath),h,i==="path"),_=JSON.stringify(g);return Pe.useEffect(()=>d(JSON.parse(_),{replace:r,state:n,relative:i}),[d,_,i,r,n]),null}function Ro(t){vr(!1)}function sk(t){let{basename:e="/",children:r=null,location:n,navigationType:i=ws.Pop,navigator:o,static:c=!1,future:u}=t;pc()&&vr(!1);let h=e.replace(/^\/*/,"/"),d=Pe.useMemo(()=>({basename:h,navigator:o,static:c,future:Yu({v7_relativeSplatPath:!1},u)}),[h,u,o,c]);typeof n=="string"&&(n=Go(n));let{pathname:g="/",search:_="",hash:x="",state:A=null,key:w="default"}=n,S=Pe.useMemo(()=>{let C=qg(g,h);return C==null?null:{location:{pathname:C,search:_,hash:x,state:A,key:w},navigationType:i}},[h,g,_,x,A,w,i]);return S==null?null:Pe.createElement(Xs.Provider,{value:d},Pe.createElement(ed.Provider,{children:r,value:S}))}function ok(t){let{children:e,location:r}=t;return KR(ig(e),r)}new Promise(()=>{});function ig(t,e){e===void 0&&(e=[]);let r=[];return Pe.Children.forEach(t,(n,i)=>{if(!Pe.isValidElement(n))return;let o=[...e,i];if(n.type===Pe.Fragment){r.push.apply(r,ig(n.props.children,o));return}n.type!==Ro&&vr(!1),!n.props.index||!n.props.children||vr(!1);let c={id:n.props.id||o.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,loader:n.props.loader,action:n.props.action,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(c.children=ig(n.props.children,o)),r.push(c)}),r}/**
 * React Router DOM v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function sg(){return sg=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},sg.apply(this,arguments)}function lk(t,e){if(t==null)return{};var r={},n=Object.keys(t),i,o;for(o=0;o<n.length;o++)i=n[o],!(e.indexOf(i)>=0)&&(r[i]=t[i]);return r}function ck(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function uk(t,e){return t.button===0&&(!e||e==="_self")&&!ck(t)}const fk=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],hk="6";try{window.__reactRouterVersion=hk}catch{}const dk="startTransition",Ly=cR[dk];function pk(t){let{basename:e,children:r,future:n,window:i}=t,o=Pe.useRef();o.current==null&&(o.current=vR({window:i,v5Compat:!0}));let c=o.current,[u,h]=Pe.useState({action:c.action,location:c.location}),{v7_startTransition:d}=n||{},g=Pe.useCallback(_=>{d&&Ly?Ly(()=>h(_)):h(_)},[h,d]);return Pe.useLayoutEffect(()=>c.listen(g),[c,g]),Pe.useEffect(()=>ik(n),[n]),Pe.createElement(sk,{basename:e,children:r,location:u.location,navigationType:u.action,navigator:c,future:n})}const mk=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",gk=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,xs=Pe.forwardRef(function(e,r){let{onClick:n,relative:i,reloadDocument:o,replace:c,state:u,target:h,to:d,preventScrollReset:g,viewTransition:_}=e,x=lk(e,fk),{basename:A}=Pe.useContext(Xs),w,S=!1;if(typeof d=="string"&&gk.test(d)&&(w=d,mk))try{let P=new URL(window.location.href),re=d.startsWith("//")?new URL(P.protocol+d):new URL(d),Q=qg(re.pathname,A);re.origin===P.origin&&Q!=null?d=Q+re.search+re.hash:S=!0}catch{}let C=GR(d,{relative:i}),z=vk(d,{replace:c,state:u,target:h,preventScrollReset:g,relative:i,viewTransition:_});function W(P){n&&n(P),P.defaultPrevented||z(P)}return Pe.createElement("a",sg({},x,{href:w||C,onClick:S||o?n:W,ref:r,target:h}))});var Vy;(function(t){t.UseScrollRestoration="useScrollRestoration",t.UseSubmit="useSubmit",t.UseSubmitFetcher="useSubmitFetcher",t.UseFetcher="useFetcher",t.useViewTransitionState="useViewTransitionState"})(Vy||(Vy={}));var Uy;(function(t){t.UseFetcher="useFetcher",t.UseFetchers="useFetchers",t.UseScrollRestoration="useScrollRestoration"})(Uy||(Uy={}));function vk(t,e){let{target:r,replace:n,state:i,preventScrollReset:o,relative:c,viewTransition:u}=e===void 0?{}:e,h=Yg(),d=mf(),g=A2(t,{relative:c});return Pe.useCallback(_=>{if(uk(_,r)){_.preventDefault();let x=n!==void 0?n:T0(d)===T0(g);h(t,{replace:x,state:i,preventScrollReset:o,relative:c,viewTransition:u})}},[d,h,g,n,i,r,t,o,c,u])}const _k=()=>{};var By={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const k2=function(t){const e=[];let r=0;for(let n=0;n<t.length;n++){let i=t.charCodeAt(n);i<128?e[r++]=i:i<2048?(e[r++]=i>>6|192,e[r++]=i&63|128):(i&64512)===55296&&n+1<t.length&&(t.charCodeAt(n+1)&64512)===56320?(i=65536+((i&1023)<<10)+(t.charCodeAt(++n)&1023),e[r++]=i>>18|240,e[r++]=i>>12&63|128,e[r++]=i>>6&63|128,e[r++]=i&63|128):(e[r++]=i>>12|224,e[r++]=i>>6&63|128,e[r++]=i&63|128)}return e},xk=function(t){const e=[];let r=0,n=0;for(;r<t.length;){const i=t[r++];if(i<128)e[n++]=String.fromCharCode(i);else if(i>191&&i<224){const o=t[r++];e[n++]=String.fromCharCode((i&31)<<6|o&63)}else if(i>239&&i<365){const o=t[r++],c=t[r++],u=t[r++],h=((i&7)<<18|(o&63)<<12|(c&63)<<6|u&63)-65536;e[n++]=String.fromCharCode(55296+(h>>10)),e[n++]=String.fromCharCode(56320+(h&1023))}else{const o=t[r++],c=t[r++];e[n++]=String.fromCharCode((i&15)<<12|(o&63)<<6|c&63)}}return e.join("")},b2={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const r=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,n=[];for(let i=0;i<t.length;i+=3){const o=t[i],c=i+1<t.length,u=c?t[i+1]:0,h=i+2<t.length,d=h?t[i+2]:0,g=o>>2,_=(o&3)<<4|u>>4;let x=(u&15)<<2|d>>6,A=d&63;h||(A=64,c||(x=64)),n.push(r[g],r[_],r[x],r[A])}return n.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(k2(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):xk(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const r=e?this.charToByteMapWebSafe_:this.charToByteMap_,n=[];for(let i=0;i<t.length;){const o=r[t.charAt(i++)],u=i<t.length?r[t.charAt(i)]:0;++i;const d=i<t.length?r[t.charAt(i)]:64;++i;const _=i<t.length?r[t.charAt(i)]:64;if(++i,o==null||u==null||d==null||_==null)throw new yk;const x=o<<2|u>>4;if(n.push(x),d!==64){const A=u<<4&240|d>>2;if(n.push(A),_!==64){const w=d<<6&192|_;n.push(w)}}}return n},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class yk extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const Ek=function(t){const e=k2(t);return b2.encodeByteArray(e,!0)},A0=function(t){return Ek(t).replace(/\./g,"")},I2=function(t){try{return b2.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Tk(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ak=()=>Tk().__FIREBASE_DEFAULTS__,wk=()=>{if(typeof process>"u"||typeof By>"u")return;const t=By.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},Sk=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&I2(t[1]);return e&&JSON.parse(e)},td=()=>{try{return _k()||Ak()||wk()||Sk()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},D2=t=>{var e,r;return(r=(e=td())===null||e===void 0?void 0:e.emulatorHosts)===null||r===void 0?void 0:r[t]},Ck=t=>{const e=D2(t);if(!e)return;const r=e.lastIndexOf(":");if(r<=0||r+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const n=parseInt(e.substring(r+1),10);return e[0]==="["?[e.substring(1,r-1),n]:[e.substring(0,r),n]},O2=()=>{var t;return(t=td())===null||t===void 0?void 0:t.config},N2=t=>{var e;return(e=td())===null||e===void 0?void 0:e[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rk{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,r)=>{this.resolve=e,this.reject=r})}wrapCallback(e){return(r,n)=>{r?this.reject(r):this.resolve(n),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(r):e(r,n))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mc(t){try{return(t.startsWith("http://")||t.startsWith("https://")?new URL(t).hostname:t).endsWith(".cloudworkstations.dev")}catch{return!1}}async function F2(t){return(await fetch(t,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kk(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const r={alg:"none",type:"JWT"},n=e||"demo-project",i=t.iat||0,o=t.sub||t.user_id;if(!o)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const c=Object.assign({iss:`https://securetoken.google.com/${n}`,aud:n,iat:i,exp:i+3600,auth_time:i,sub:o,user_id:o,firebase:{sign_in_provider:"custom",identities:{}}},t);return[A0(JSON.stringify(r)),A0(JSON.stringify(c)),""].join(".")}const Nu={};function bk(){const t={prod:[],emulator:[]};for(const e of Object.keys(Nu))Nu[e]?t.emulator.push(e):t.prod.push(e);return t}function Ik(t){let e=document.getElementById(t),r=!1;return e||(e=document.createElement("div"),e.setAttribute("id",t),r=!0),{created:r,element:e}}let jy=!1;function P2(t,e){if(typeof window>"u"||typeof document>"u"||!mc(window.location.host)||Nu[t]===e||Nu[t]||jy)return;Nu[t]=e;function r(x){return`__firebase__banner__${x}`}const n="__firebase__banner",o=bk().prod.length>0;function c(){const x=document.getElementById(n);x&&x.remove()}function u(x){x.style.display="flex",x.style.background="#7faaf0",x.style.position="fixed",x.style.bottom="5px",x.style.left="5px",x.style.padding=".5em",x.style.borderRadius="5px",x.style.alignItems="center"}function h(x,A){x.setAttribute("width","24"),x.setAttribute("id",A),x.setAttribute("height","24"),x.setAttribute("viewBox","0 0 24 24"),x.setAttribute("fill","none"),x.style.marginLeft="-6px"}function d(){const x=document.createElement("span");return x.style.cursor="pointer",x.style.marginLeft="16px",x.style.fontSize="24px",x.innerHTML=" &times;",x.onclick=()=>{jy=!0,c()},x}function g(x,A){x.setAttribute("id",A),x.innerText="Learn more",x.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",x.setAttribute("target","__blank"),x.style.paddingLeft="5px",x.style.textDecoration="underline"}function _(){const x=Ik(n),A=r("text"),w=document.getElementById(A)||document.createElement("span"),S=r("learnmore"),C=document.getElementById(S)||document.createElement("a"),z=r("preprendIcon"),W=document.getElementById(z)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(x.created){const P=x.element;u(P),g(C,S);const re=d();h(W,z),P.append(W,w,C,re),document.body.appendChild(P)}o?(w.innerText="Preview backend disconnected.",W.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(W.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,w.innerText="Preview backend running in this workspace."),w.setAttribute("id",A)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",_):_()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pn(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function Dk(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(pn())}function Ok(){var t;const e=(t=td())===null||t===void 0?void 0:t.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function Nk(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function Fk(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function Pk(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function Mk(){const t=pn();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function Lk(){return!Ok()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function Vk(){try{return typeof indexedDB=="object"}catch{return!1}}function Uk(){return new Promise((t,e)=>{try{let r=!0;const n="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(n);i.onsuccess=()=>{i.result.close(),r||self.indexedDB.deleteDatabase(n),t(!0)},i.onupgradeneeded=()=>{r=!1},i.onerror=()=>{var o;e(((o=i.error)===null||o===void 0?void 0:o.message)||"")}}catch(r){e(r)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Bk="FirebaseError";class ji extends Error{constructor(e,r,n){super(r),this.code=e,this.customData=n,this.name=Bk,Object.setPrototypeOf(this,ji.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,gf.prototype.create)}}class gf{constructor(e,r,n){this.service=e,this.serviceName=r,this.errors=n}create(e,...r){const n=r[0]||{},i=`${this.service}/${e}`,o=this.errors[e],c=o?jk(o,n):"Error",u=`${this.serviceName}: ${c} (${i}).`;return new ji(i,u,n)}}function jk(t,e){return t.replace(zk,(r,n)=>{const i=e[n];return i!=null?String(i):`<${n}?>`})}const zk=/\{\$([^}]+)}/g;function Hk(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function Mo(t,e){if(t===e)return!0;const r=Object.keys(t),n=Object.keys(e);for(const i of r){if(!n.includes(i))return!1;const o=t[i],c=e[i];if(zy(o)&&zy(c)){if(!Mo(o,c))return!1}else if(o!==c)return!1}for(const i of n)if(!r.includes(i))return!1;return!0}function zy(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vf(t){const e=[];for(const[r,n]of Object.entries(t))Array.isArray(n)?n.forEach(i=>{e.push(encodeURIComponent(r)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(r)+"="+encodeURIComponent(n));return e.length?"&"+e.join("&"):""}function Au(t){const e={};return t.replace(/^\?/,"").split("&").forEach(n=>{if(n){const[i,o]=n.split("=");e[decodeURIComponent(i)]=decodeURIComponent(o)}}),e}function wu(t){const e=t.indexOf("?");if(!e)return"";const r=t.indexOf("#",e);return t.substring(e,r>0?r:void 0)}function Gk(t,e){const r=new qk(t,e);return r.subscribe.bind(r)}class qk{constructor(e,r){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=r,this.task.then(()=>{e(this)}).catch(n=>{this.error(n)})}next(e){this.forEachObserver(r=>{r.next(e)})}error(e){this.forEachObserver(r=>{r.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,r,n){let i;if(e===void 0&&r===void 0&&n===void 0)throw new Error("Missing Observer.");Kk(e,["next","error","complete"])?i=e:i={next:e,error:r,complete:n},i.next===void 0&&(i.next=Lm),i.error===void 0&&(i.error=Lm),i.complete===void 0&&(i.complete=Lm);const o=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),o}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let r=0;r<this.observers.length;r++)this.sendOne(r,e)}sendOne(e,r){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{r(this.observers[e])}catch(n){typeof console<"u"&&console.error&&console.error(n)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function Kk(t,e){if(typeof t!="object"||t===null)return!1;for(const r of e)if(r in t&&typeof t[r]=="function")return!0;return!1}function Lm(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tn(t){return t&&t._delegate?t._delegate:t}class Lo{constructor(e,r,n){this.name=e,this.instanceFactory=r,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ko="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xk{constructor(e,r){this.name=e,this.container=r,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const r=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(r)){const n=new Rk;if(this.instancesDeferred.set(r,n),this.isInitialized(r)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:r});i&&n.resolve(i)}catch{}}return this.instancesDeferred.get(r).promise}getImmediate(e){var r;const n=this.normalizeInstanceIdentifier(e?.identifier),i=(r=e?.optional)!==null&&r!==void 0?r:!1;if(this.isInitialized(n)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:n})}catch(o){if(i)return null;throw o}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(Yk(e))try{this.getOrInitializeService({instanceIdentifier:ko})}catch{}for(const[r,n]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(r);try{const o=this.getOrInitializeService({instanceIdentifier:i});n.resolve(o)}catch{}}}}clearInstance(e=ko){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(r=>"INTERNAL"in r).map(r=>r.INTERNAL.delete()),...e.filter(r=>"_delete"in r).map(r=>r._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=ko){return this.instances.has(e)}getOptions(e=ko){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:r={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:n,options:r});for(const[o,c]of this.instancesDeferred.entries()){const u=this.normalizeInstanceIdentifier(o);n===u&&c.resolve(i)}return i}onInit(e,r){var n;const i=this.normalizeInstanceIdentifier(r),o=(n=this.onInitCallbacks.get(i))!==null&&n!==void 0?n:new Set;o.add(e),this.onInitCallbacks.set(i,o);const c=this.instances.get(i);return c&&e(c,i),()=>{o.delete(e)}}invokeOnInitCallbacks(e,r){const n=this.onInitCallbacks.get(r);if(n)for(const i of n)try{i(e,r)}catch{}}getOrInitializeService({instanceIdentifier:e,options:r={}}){let n=this.instances.get(e);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:Wk(e),options:r}),this.instances.set(e,n),this.instancesOptions.set(e,r),this.invokeOnInitCallbacks(n,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,n)}catch{}return n||null}normalizeInstanceIdentifier(e=ko){return this.component?this.component.multipleInstances?e:ko:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function Wk(t){return t===ko?void 0:t}function Yk(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $k{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const r=this.getProvider(e.name);if(r.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);r.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const r=new Xk(e,this);return this.providers.set(e,r),r}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Tt;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(Tt||(Tt={}));const Qk={debug:Tt.DEBUG,verbose:Tt.VERBOSE,info:Tt.INFO,warn:Tt.WARN,error:Tt.ERROR,silent:Tt.SILENT},Zk=Tt.INFO,Jk={[Tt.DEBUG]:"log",[Tt.VERBOSE]:"log",[Tt.INFO]:"info",[Tt.WARN]:"warn",[Tt.ERROR]:"error"},eb=(t,e,...r)=>{if(e<t.logLevel)return;const n=new Date().toISOString(),i=Jk[e];if(i)console[i](`[${n}]  ${t.name}:`,...r);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class $g{constructor(e){this.name=e,this._logLevel=Zk,this._logHandler=eb,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Tt))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?Qk[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Tt.DEBUG,...e),this._logHandler(this,Tt.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Tt.VERBOSE,...e),this._logHandler(this,Tt.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Tt.INFO,...e),this._logHandler(this,Tt.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Tt.WARN,...e),this._logHandler(this,Tt.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Tt.ERROR,...e),this._logHandler(this,Tt.ERROR,...e)}}const tb=(t,e)=>e.some(r=>t instanceof r);let Hy,Gy;function rb(){return Hy||(Hy=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function nb(){return Gy||(Gy=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const M2=new WeakMap,og=new WeakMap,L2=new WeakMap,Vm=new WeakMap,Qg=new WeakMap;function ab(t){const e=new Promise((r,n)=>{const i=()=>{t.removeEventListener("success",o),t.removeEventListener("error",c)},o=()=>{r(bs(t.result)),i()},c=()=>{n(t.error),i()};t.addEventListener("success",o),t.addEventListener("error",c)});return e.then(r=>{r instanceof IDBCursor&&M2.set(r,t)}).catch(()=>{}),Qg.set(e,t),e}function ib(t){if(og.has(t))return;const e=new Promise((r,n)=>{const i=()=>{t.removeEventListener("complete",o),t.removeEventListener("error",c),t.removeEventListener("abort",c)},o=()=>{r(),i()},c=()=>{n(t.error||new DOMException("AbortError","AbortError")),i()};t.addEventListener("complete",o),t.addEventListener("error",c),t.addEventListener("abort",c)});og.set(t,e)}let lg={get(t,e,r){if(t instanceof IDBTransaction){if(e==="done")return og.get(t);if(e==="objectStoreNames")return t.objectStoreNames||L2.get(t);if(e==="store")return r.objectStoreNames[1]?void 0:r.objectStore(r.objectStoreNames[0])}return bs(t[e])},set(t,e,r){return t[e]=r,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function sb(t){lg=t(lg)}function ob(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...r){const n=t.call(Um(this),e,...r);return L2.set(n,e.sort?e.sort():[e]),bs(n)}:nb().includes(t)?function(...e){return t.apply(Um(this),e),bs(M2.get(this))}:function(...e){return bs(t.apply(Um(this),e))}}function lb(t){return typeof t=="function"?ob(t):(t instanceof IDBTransaction&&ib(t),tb(t,rb())?new Proxy(t,lg):t)}function bs(t){if(t instanceof IDBRequest)return ab(t);if(Vm.has(t))return Vm.get(t);const e=lb(t);return e!==t&&(Vm.set(t,e),Qg.set(e,t)),e}const Um=t=>Qg.get(t);function cb(t,e,{blocked:r,upgrade:n,blocking:i,terminated:o}={}){const c=indexedDB.open(t,e),u=bs(c);return n&&c.addEventListener("upgradeneeded",h=>{n(bs(c.result),h.oldVersion,h.newVersion,bs(c.transaction),h)}),r&&c.addEventListener("blocked",h=>r(h.oldVersion,h.newVersion,h)),u.then(h=>{o&&h.addEventListener("close",()=>o()),i&&h.addEventListener("versionchange",d=>i(d.oldVersion,d.newVersion,d))}).catch(()=>{}),u}const ub=["get","getKey","getAll","getAllKeys","count"],fb=["put","add","delete","clear"],Bm=new Map;function qy(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(Bm.get(e))return Bm.get(e);const r=e.replace(/FromIndex$/,""),n=e!==r,i=fb.includes(r);if(!(r in(n?IDBIndex:IDBObjectStore).prototype)||!(i||ub.includes(r)))return;const o=async function(c,...u){const h=this.transaction(c,i?"readwrite":"readonly");let d=h.store;return n&&(d=d.index(u.shift())),(await Promise.all([d[r](...u),i&&h.done]))[0]};return Bm.set(e,o),o}sb(t=>({...t,get:(e,r,n)=>qy(e,r)||t.get(e,r,n),has:(e,r)=>!!qy(e,r)||t.has(e,r)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hb{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(r=>{if(db(r)){const n=r.getImmediate();return`${n.library}/${n.version}`}else return null}).filter(r=>r).join(" ")}}function db(t){const e=t.getComponent();return e?.type==="VERSION"}const cg="@firebase/app",Ky="0.13.2";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Li=new $g("@firebase/app"),pb="@firebase/app-compat",mb="@firebase/analytics-compat",gb="@firebase/analytics",vb="@firebase/app-check-compat",_b="@firebase/app-check",xb="@firebase/auth",yb="@firebase/auth-compat",Eb="@firebase/database",Tb="@firebase/data-connect",Ab="@firebase/database-compat",wb="@firebase/functions",Sb="@firebase/functions-compat",Cb="@firebase/installations",Rb="@firebase/installations-compat",kb="@firebase/messaging",bb="@firebase/messaging-compat",Ib="@firebase/performance",Db="@firebase/performance-compat",Ob="@firebase/remote-config",Nb="@firebase/remote-config-compat",Fb="@firebase/storage",Pb="@firebase/storage-compat",Mb="@firebase/firestore",Lb="@firebase/ai",Vb="@firebase/firestore-compat",Ub="firebase",Bb="11.10.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ug="[DEFAULT]",jb={[cg]:"fire-core",[pb]:"fire-core-compat",[gb]:"fire-analytics",[mb]:"fire-analytics-compat",[_b]:"fire-app-check",[vb]:"fire-app-check-compat",[xb]:"fire-auth",[yb]:"fire-auth-compat",[Eb]:"fire-rtdb",[Tb]:"fire-data-connect",[Ab]:"fire-rtdb-compat",[wb]:"fire-fn",[Sb]:"fire-fn-compat",[Cb]:"fire-iid",[Rb]:"fire-iid-compat",[kb]:"fire-fcm",[bb]:"fire-fcm-compat",[Ib]:"fire-perf",[Db]:"fire-perf-compat",[Ob]:"fire-rc",[Nb]:"fire-rc-compat",[Fb]:"fire-gcs",[Pb]:"fire-gcs-compat",[Mb]:"fire-fst",[Vb]:"fire-fst-compat",[Lb]:"fire-vertex","fire-js":"fire-js",[Ub]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const w0=new Map,zb=new Map,fg=new Map;function Xy(t,e){try{t.container.addComponent(e)}catch(r){Li.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,r)}}function ic(t){const e=t.name;if(fg.has(e))return Li.debug(`There were multiple attempts to register component ${e}.`),!1;fg.set(e,t);for(const r of w0.values())Xy(r,t);for(const r of zb.values())Xy(r,t);return!0}function Zg(t,e){const r=t.container.getProvider("heartbeat").getImmediate({optional:!0});return r&&r.triggerHeartbeat(),t.container.getProvider(e)}function fa(t){return t==null?!1:t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hb={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Is=new gf("app","Firebase",Hb);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gb{constructor(e,r,n){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},r),this._name=r.name,this._automaticDataCollectionEnabled=r.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new Lo("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Is.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gc=Bb;function V2(t,e={}){let r=t;typeof e!="object"&&(e={name:e});const n=Object.assign({name:ug,automaticDataCollectionEnabled:!0},e),i=n.name;if(typeof i!="string"||!i)throw Is.create("bad-app-name",{appName:String(i)});if(r||(r=O2()),!r)throw Is.create("no-options");const o=w0.get(i);if(o){if(Mo(r,o.options)&&Mo(n,o.config))return o;throw Is.create("duplicate-app",{appName:i})}const c=new $k(i);for(const h of fg.values())c.addComponent(h);const u=new Gb(r,n,c);return w0.set(i,u),u}function U2(t=ug){const e=w0.get(t);if(!e&&t===ug&&O2())return V2();if(!e)throw Is.create("no-app",{appName:t});return e}function Ds(t,e,r){var n;let i=(n=jb[t])!==null&&n!==void 0?n:t;r&&(i+=`-${r}`);const o=i.match(/\s|\//),c=e.match(/\s|\//);if(o||c){const u=[`Unable to register library "${i}" with version "${e}":`];o&&u.push(`library name "${i}" contains illegal characters (whitespace or "/")`),o&&c&&u.push("and"),c&&u.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Li.warn(u.join(" "));return}ic(new Lo(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qb="firebase-heartbeat-database",Kb=1,$u="firebase-heartbeat-store";let jm=null;function B2(){return jm||(jm=cb(qb,Kb,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore($u)}catch(r){console.warn(r)}}}}).catch(t=>{throw Is.create("idb-open",{originalErrorMessage:t.message})})),jm}async function Xb(t){try{const r=(await B2()).transaction($u),n=await r.objectStore($u).get(j2(t));return await r.done,n}catch(e){if(e instanceof ji)Li.warn(e.message);else{const r=Is.create("idb-get",{originalErrorMessage:e?.message});Li.warn(r.message)}}}async function Wy(t,e){try{const n=(await B2()).transaction($u,"readwrite");await n.objectStore($u).put(e,j2(t)),await n.done}catch(r){if(r instanceof ji)Li.warn(r.message);else{const n=Is.create("idb-set",{originalErrorMessage:r?.message});Li.warn(n.message)}}}function j2(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wb=1024,Yb=30;class $b{constructor(e){this.container=e,this._heartbeatsCache=null;const r=this.container.getProvider("app").getImmediate();this._storage=new Zb(r),this._heartbeatsCachePromise=this._storage.read().then(n=>(this._heartbeatsCache=n,n))}async triggerHeartbeat(){var e,r;try{const i=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),o=Yy();if(((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((r=this._heartbeatsCache)===null||r===void 0?void 0:r.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===o||this._heartbeatsCache.heartbeats.some(c=>c.date===o))return;if(this._heartbeatsCache.heartbeats.push({date:o,agent:i}),this._heartbeatsCache.heartbeats.length>Yb){const c=Jb(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(c,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(n){Li.warn(n)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const r=Yy(),{heartbeatsToSend:n,unsentEntries:i}=Qb(this._heartbeatsCache.heartbeats),o=A0(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=r,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),o}catch(r){return Li.warn(r),""}}}function Yy(){return new Date().toISOString().substring(0,10)}function Qb(t,e=Wb){const r=[];let n=t.slice();for(const i of t){const o=r.find(c=>c.agent===i.agent);if(o){if(o.dates.push(i.date),$y(r)>e){o.dates.pop();break}}else if(r.push({agent:i.agent,dates:[i.date]}),$y(r)>e){r.pop();break}n=n.slice(1)}return{heartbeatsToSend:r,unsentEntries:n}}class Zb{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return Vk()?Uk().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const r=await Xb(this.app);return r?.heartbeats?r:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var r;if(await this._canUseIndexedDBPromise){const i=await this.read();return Wy(this.app,{lastSentHeartbeatDate:(r=e.lastSentHeartbeatDate)!==null&&r!==void 0?r:i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var r;if(await this._canUseIndexedDBPromise){const i=await this.read();return Wy(this.app,{lastSentHeartbeatDate:(r=e.lastSentHeartbeatDate)!==null&&r!==void 0?r:i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return}}function $y(t){return A0(JSON.stringify({version:2,heartbeats:t})).length}function Jb(t){if(t.length===0)return-1;let e=0,r=t[0].date;for(let n=1;n<t.length;n++)t[n].date<r&&(r=t[n].date,e=n);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function eI(t){ic(new Lo("platform-logger",e=>new hb(e),"PRIVATE")),ic(new Lo("heartbeat",e=>new $b(e),"PRIVATE")),Ds(cg,Ky,t),Ds(cg,Ky,"esm2017"),Ds("fire-js","")}eI("");function Jg(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(t);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(t,n[i])&&(r[n[i]]=t[n[i]]);return r}function z2(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const tI=z2,H2=new gf("auth","Firebase",z2());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const S0=new $g("@firebase/auth");function rI(t,...e){S0.logLevel<=Tt.WARN&&S0.warn(`Auth (${gc}): ${t}`,...e)}function f0(t,...e){S0.logLevel<=Tt.ERROR&&S0.error(`Auth (${gc}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ma(t,...e){throw t1(t,...e)}function Da(t,...e){return t1(t,...e)}function e1(t,e,r){const n=Object.assign(Object.assign({},tI()),{[e]:r});return new gf("auth","Firebase",n).create(e,{appName:t.name})}function Os(t){return e1(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function nI(t,e,r){const n=r;if(!(e instanceof n))throw n.name!==e.constructor.name&&ma(t,"argument-error"),e1(t,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function t1(t,...e){if(typeof t!="string"){const r=e[0],n=[...e.slice(1)];return n[0]&&(n[0].appName=t.name),t._errorFactory.create(r,...n)}return H2.create(t,...e)}function tt(t,e,...r){if(!t)throw t1(e,...r)}function Ii(t){const e="INTERNAL ASSERTION FAILED: "+t;throw f0(e),new Error(e)}function Vi(t,e){t||Ii(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hg(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.href)||""}function aI(){return Qy()==="http:"||Qy()==="https:"}function Qy(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function iI(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(aI()||Fk()||"connection"in navigator)?navigator.onLine:!0}function sI(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _f{constructor(e,r){this.shortDelay=e,this.longDelay=r,Vi(r>e,"Short delay should be less than long delay!"),this.isMobile=Dk()||Pk()}get(){return iI()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function r1(t,e){Vi(t.emulator,"Emulator should always be set here");const{url:r}=t.emulator;return e?`${r}${e.startsWith("/")?e.slice(1):e}`:r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class G2{static initialize(e,r,n){this.fetchImpl=e,r&&(this.headersImpl=r),n&&(this.responseImpl=n)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Ii("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Ii("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Ii("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oI={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lI=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],cI=new _f(3e4,6e4);function qo(t,e){return t.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:t.tenantId}):e}async function Ys(t,e,r,n,i={}){return q2(t,i,async()=>{let o={},c={};n&&(e==="GET"?c=n:o={body:JSON.stringify(n)});const u=vf(Object.assign({key:t.config.apiKey},c)).slice(1),h=await t._getAdditionalHeaders();h["Content-Type"]="application/json",t.languageCode&&(h["X-Firebase-Locale"]=t.languageCode);const d=Object.assign({method:e,headers:h},o);return Nk()||(d.referrerPolicy="no-referrer"),t.emulatorConfig&&mc(t.emulatorConfig.host)&&(d.credentials="include"),G2.fetch()(await K2(t,t.config.apiHost,r,u),d)})}async function q2(t,e,r){t._canInitEmulator=!1;const n=Object.assign(Object.assign({},oI),e);try{const i=new fI(t),o=await Promise.race([r(),i.promise]);i.clearNetworkTimeout();const c=await o.json();if("needConfirmation"in c)throw Wh(t,"account-exists-with-different-credential",c);if(o.ok&&!("errorMessage"in c))return c;{const u=o.ok?c.errorMessage:c.error.message,[h,d]=u.split(" : ");if(h==="FEDERATED_USER_ID_ALREADY_LINKED")throw Wh(t,"credential-already-in-use",c);if(h==="EMAIL_EXISTS")throw Wh(t,"email-already-in-use",c);if(h==="USER_DISABLED")throw Wh(t,"user-disabled",c);const g=n[h]||h.toLowerCase().replace(/[_\s]+/g,"-");if(d)throw e1(t,g,d);ma(t,g)}}catch(i){if(i instanceof ji)throw i;ma(t,"network-request-failed",{message:String(i)})}}async function rd(t,e,r,n,i={}){const o=await Ys(t,e,r,n,i);return"mfaPendingCredential"in o&&ma(t,"multi-factor-auth-required",{_serverResponse:o}),o}async function K2(t,e,r,n){const i=`${e}${r}?${n}`,o=t,c=o.config.emulator?r1(t.config,i):`${t.config.apiScheme}://${i}`;return lI.includes(r)&&(await o._persistenceManagerAvailable,o._getPersistenceType()==="COOKIE")?o._getPersistence()._getFinalTarget(c).toString():c}function uI(t){switch(t){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class fI{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((r,n)=>{this.timer=setTimeout(()=>n(Da(this.auth,"network-request-failed")),cI.get())})}}function Wh(t,e,r){const n={appName:t.name};r.email&&(n.email=r.email),r.phoneNumber&&(n.phoneNumber=r.phoneNumber);const i=Da(t,e,n);return i.customData._tokenResponse=r,i}function Zy(t){return t!==void 0&&t.enterprise!==void 0}class hI{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const r of this.recaptchaEnforcementState)if(r.provider&&r.provider===e)return uI(r.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function dI(t,e){return Ys(t,"GET","/v2/recaptchaConfig",qo(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function pI(t,e){return Ys(t,"POST","/v1/accounts:delete",e)}async function C0(t,e){return Ys(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fu(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function mI(t,e=!1){const r=tn(t),n=await r.getIdToken(e),i=n1(n);tt(i&&i.exp&&i.auth_time&&i.iat,r.auth,"internal-error");const o=typeof i.firebase=="object"?i.firebase:void 0,c=o?.sign_in_provider;return{claims:i,token:n,authTime:Fu(zm(i.auth_time)),issuedAtTime:Fu(zm(i.iat)),expirationTime:Fu(zm(i.exp)),signInProvider:c||null,signInSecondFactor:o?.sign_in_second_factor||null}}function zm(t){return Number(t)*1e3}function n1(t){const[e,r,n]=t.split(".");if(e===void 0||r===void 0||n===void 0)return f0("JWT malformed, contained fewer than 3 sections"),null;try{const i=I2(r);return i?JSON.parse(i):(f0("Failed to decode base64 JWT payload"),null)}catch(i){return f0("Caught error parsing JWT payload as JSON",i?.toString()),null}}function Jy(t){const e=n1(t);return tt(e,"internal-error"),tt(typeof e.exp<"u","internal-error"),tt(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Qu(t,e,r=!1){if(r)return e;try{return await e}catch(n){throw n instanceof ji&&gI(n)&&t.auth.currentUser===t&&await t.auth.signOut(),n}}function gI({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vI{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var r;if(e){const n=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),n}else{this.errorBackoff=3e4;const i=((r=this.user.stsTokenManager.expirationTime)!==null&&r!==void 0?r:0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;const r=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},r)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dg{constructor(e,r){this.createdAt=e,this.lastLoginAt=r,this._initializeTime()}_initializeTime(){this.lastSignInTime=Fu(this.lastLoginAt),this.creationTime=Fu(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function R0(t){var e;const r=t.auth,n=await t.getIdToken(),i=await Qu(t,C0(r,{idToken:n}));tt(i?.users.length,r,"internal-error");const o=i.users[0];t._notifyReloadListener(o);const c=!((e=o.providerUserInfo)===null||e===void 0)&&e.length?X2(o.providerUserInfo):[],u=xI(t.providerData,c),h=t.isAnonymous,d=!(t.email&&o.passwordHash)&&!u?.length,g=h?d:!1,_={uid:o.localId,displayName:o.displayName||null,photoURL:o.photoUrl||null,email:o.email||null,emailVerified:o.emailVerified||!1,phoneNumber:o.phoneNumber||null,tenantId:o.tenantId||null,providerData:u,metadata:new dg(o.createdAt,o.lastLoginAt),isAnonymous:g};Object.assign(t,_)}async function _I(t){const e=tn(t);await R0(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function xI(t,e){return[...t.filter(n=>!e.some(i=>i.providerId===n.providerId)),...e]}function X2(t){return t.map(e=>{var{providerId:r}=e,n=Jg(e,["providerId"]);return{providerId:r,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function yI(t,e){const r=await q2(t,{},async()=>{const n=vf({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:o}=t.config,c=await K2(t,i,"/v1/token",`key=${o}`),u=await t._getAdditionalHeaders();u["Content-Type"]="application/x-www-form-urlencoded";const h={method:"POST",headers:u,body:n};return t.emulatorConfig&&mc(t.emulatorConfig.host)&&(h.credentials="include"),G2.fetch()(c,h)});return{accessToken:r.access_token,expiresIn:r.expires_in,refreshToken:r.refresh_token}}async function EI(t,e){return Ys(t,"POST","/v2/accounts:revokeToken",qo(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ql{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){tt(e.idToken,"internal-error"),tt(typeof e.idToken<"u","internal-error"),tt(typeof e.refreshToken<"u","internal-error");const r="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):Jy(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,r)}updateFromIdToken(e){tt(e.length!==0,"internal-error");const r=Jy(e);this.updateTokensAndExpiration(e,null,r)}async getToken(e,r=!1){return!r&&this.accessToken&&!this.isExpired?this.accessToken:(tt(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,r){const{accessToken:n,refreshToken:i,expiresIn:o}=await yI(e,r);this.updateTokensAndExpiration(n,i,Number(o))}updateTokensAndExpiration(e,r,n){this.refreshToken=r||null,this.accessToken=e||null,this.expirationTime=Date.now()+n*1e3}static fromJSON(e,r){const{refreshToken:n,accessToken:i,expirationTime:o}=r,c=new Ql;return n&&(tt(typeof n=="string","internal-error",{appName:e}),c.refreshToken=n),i&&(tt(typeof i=="string","internal-error",{appName:e}),c.accessToken=i),o&&(tt(typeof o=="number","internal-error",{appName:e}),c.expirationTime=o),c}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Ql,this.toJSON())}_performRefresh(){return Ii("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vs(t,e){tt(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class Ra{constructor(e){var{uid:r,auth:n,stsTokenManager:i}=e,o=Jg(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new vI(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=r,this.auth=n,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=o.displayName||null,this.email=o.email||null,this.emailVerified=o.emailVerified||!1,this.phoneNumber=o.phoneNumber||null,this.photoURL=o.photoURL||null,this.isAnonymous=o.isAnonymous||!1,this.tenantId=o.tenantId||null,this.providerData=o.providerData?[...o.providerData]:[],this.metadata=new dg(o.createdAt||void 0,o.lastLoginAt||void 0)}async getIdToken(e){const r=await Qu(this,this.stsTokenManager.getToken(this.auth,e));return tt(r,this.auth,"internal-error"),this.accessToken!==r&&(this.accessToken=r,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),r}getIdTokenResult(e){return mI(this,e)}reload(){return _I(this)}_assign(e){this!==e&&(tt(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(r=>Object.assign({},r)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const r=new Ra(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return r.metadata._copy(this.metadata),r}_onReload(e){tt(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,r=!1){let n=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),n=!0),r&&await R0(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(fa(this.auth.app))return Promise.reject(Os(this.auth));const e=await this.getIdToken();return await Qu(this,pI(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,r){var n,i,o,c,u,h,d,g;const _=(n=r.displayName)!==null&&n!==void 0?n:void 0,x=(i=r.email)!==null&&i!==void 0?i:void 0,A=(o=r.phoneNumber)!==null&&o!==void 0?o:void 0,w=(c=r.photoURL)!==null&&c!==void 0?c:void 0,S=(u=r.tenantId)!==null&&u!==void 0?u:void 0,C=(h=r._redirectEventId)!==null&&h!==void 0?h:void 0,z=(d=r.createdAt)!==null&&d!==void 0?d:void 0,W=(g=r.lastLoginAt)!==null&&g!==void 0?g:void 0,{uid:P,emailVerified:re,isAnonymous:Q,providerData:ee,stsTokenManager:k}=r;tt(P&&k,e,"internal-error");const T=Ql.fromJSON(this.name,k);tt(typeof P=="string",e,"internal-error"),vs(_,e.name),vs(x,e.name),tt(typeof re=="boolean",e,"internal-error"),tt(typeof Q=="boolean",e,"internal-error"),vs(A,e.name),vs(w,e.name),vs(S,e.name),vs(C,e.name),vs(z,e.name),vs(W,e.name);const E=new Ra({uid:P,auth:e,email:x,emailVerified:re,displayName:_,isAnonymous:Q,photoURL:w,phoneNumber:A,tenantId:S,stsTokenManager:T,createdAt:z,lastLoginAt:W});return ee&&Array.isArray(ee)&&(E.providerData=ee.map(I=>Object.assign({},I))),C&&(E._redirectEventId=C),E}static async _fromIdTokenResponse(e,r,n=!1){const i=new Ql;i.updateFromServerResponse(r);const o=new Ra({uid:r.localId,auth:e,stsTokenManager:i,isAnonymous:n});return await R0(o),o}static async _fromGetAccountInfoResponse(e,r,n){const i=r.users[0];tt(i.localId!==void 0,"internal-error");const o=i.providerUserInfo!==void 0?X2(i.providerUserInfo):[],c=!(i.email&&i.passwordHash)&&!o?.length,u=new Ql;u.updateFromIdToken(n);const h=new Ra({uid:i.localId,auth:e,stsTokenManager:u,isAnonymous:c}),d={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:o,metadata:new dg(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!o?.length};return Object.assign(h,d),h}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eE=new Map;function Di(t){Vi(t instanceof Function,"Expected a class definition");let e=eE.get(t);return e?(Vi(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,eE.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class W2{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,r){this.storage[e]=r}async _get(e){const r=this.storage[e];return r===void 0?null:r}async _remove(e){delete this.storage[e]}_addListener(e,r){}_removeListener(e,r){}}W2.type="NONE";const tE=W2;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function h0(t,e,r){return`firebase:${t}:${e}:${r}`}class Zl{constructor(e,r,n){this.persistence=e,this.auth=r,this.userKey=n;const{config:i,name:o}=this.auth;this.fullUserKey=h0(this.userKey,i.apiKey,o),this.fullPersistenceKey=h0("persistence",i.apiKey,o),this.boundEventHandler=r._onStorageEvent.bind(r),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const r=await C0(this.auth,{idToken:e}).catch(()=>{});return r?Ra._fromGetAccountInfoResponse(this.auth,r,e):null}return Ra._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const r=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,r)return this.setCurrentUser(r)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,r,n="authUser"){if(!r.length)return new Zl(Di(tE),e,n);const i=(await Promise.all(r.map(async d=>{if(await d._isAvailable())return d}))).filter(d=>d);let o=i[0]||Di(tE);const c=h0(n,e.config.apiKey,e.name);let u=null;for(const d of r)try{const g=await d._get(c);if(g){let _;if(typeof g=="string"){const x=await C0(e,{idToken:g}).catch(()=>{});if(!x)break;_=await Ra._fromGetAccountInfoResponse(e,x,g)}else _=Ra._fromJSON(e,g);d!==o&&(u=_),o=d;break}}catch{}const h=i.filter(d=>d._shouldAllowMigration);return!o._shouldAllowMigration||!h.length?new Zl(o,e,n):(o=h[0],u&&await o._set(c,u.toJSON()),await Promise.all(r.map(async d=>{if(d!==o)try{await d._remove(c)}catch{}})),new Zl(o,e,n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rE(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(Z2(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(Y2(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(eA(e))return"Blackberry";if(tA(e))return"Webos";if($2(e))return"Safari";if((e.includes("chrome/")||Q2(e))&&!e.includes("edge/"))return"Chrome";if(J2(e))return"Android";{const r=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=t.match(r);if(n?.length===2)return n[1]}return"Other"}function Y2(t=pn()){return/firefox\//i.test(t)}function $2(t=pn()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function Q2(t=pn()){return/crios\//i.test(t)}function Z2(t=pn()){return/iemobile/i.test(t)}function J2(t=pn()){return/android/i.test(t)}function eA(t=pn()){return/blackberry/i.test(t)}function tA(t=pn()){return/webos/i.test(t)}function a1(t=pn()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function TI(t=pn()){var e;return a1(t)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function AI(){return Mk()&&document.documentMode===10}function rA(t=pn()){return a1(t)||J2(t)||tA(t)||eA(t)||/windows phone/i.test(t)||Z2(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nA(t,e=[]){let r;switch(t){case"Browser":r=rE(pn());break;case"Worker":r=`${rE(pn())}-${t}`;break;default:r=t}const n=e.length?e.join(","):"FirebaseCore-web";return`${r}/JsCore/${gc}/${n}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wI{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,r){const n=o=>new Promise((c,u)=>{try{const h=e(o);c(h)}catch(h){u(h)}});n.onAbort=r,this.queue.push(n);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const r=[];try{for(const n of this.queue)await n(e),n.onAbort&&r.push(n.onAbort)}catch(n){r.reverse();for(const i of r)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:n?.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function SI(t,e={}){return Ys(t,"GET","/v2/passwordPolicy",qo(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const CI=6;class RI{constructor(e){var r,n,i,o;const c=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(r=c.minPasswordLength)!==null&&r!==void 0?r:CI,c.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=c.maxPasswordLength),c.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=c.containsLowercaseCharacter),c.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=c.containsUppercaseCharacter),c.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=c.containsNumericCharacter),c.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=c.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(i=(n=e.allowedNonAlphanumericCharacters)===null||n===void 0?void 0:n.join(""))!==null&&i!==void 0?i:"",this.forceUpgradeOnSignin=(o=e.forceUpgradeOnSignin)!==null&&o!==void 0?o:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var r,n,i,o,c,u;const h={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,h),this.validatePasswordCharacterOptions(e,h),h.isValid&&(h.isValid=(r=h.meetsMinPasswordLength)!==null&&r!==void 0?r:!0),h.isValid&&(h.isValid=(n=h.meetsMaxPasswordLength)!==null&&n!==void 0?n:!0),h.isValid&&(h.isValid=(i=h.containsLowercaseLetter)!==null&&i!==void 0?i:!0),h.isValid&&(h.isValid=(o=h.containsUppercaseLetter)!==null&&o!==void 0?o:!0),h.isValid&&(h.isValid=(c=h.containsNumericCharacter)!==null&&c!==void 0?c:!0),h.isValid&&(h.isValid=(u=h.containsNonAlphanumericCharacter)!==null&&u!==void 0?u:!0),h}validatePasswordLengthOptions(e,r){const n=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;n&&(r.meetsMinPasswordLength=e.length>=n),i&&(r.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,r){this.updatePasswordCharacterOptionsStatuses(r,!1,!1,!1,!1);let n;for(let i=0;i<e.length;i++)n=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(r,n>="a"&&n<="z",n>="A"&&n<="Z",n>="0"&&n<="9",this.allowedNonAlphanumericCharacters.includes(n))}updatePasswordCharacterOptionsStatuses(e,r,n,i,o){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=r)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=n)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=o))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kI{constructor(e,r,n,i){this.app=e,this.heartbeatServiceProvider=r,this.appCheckServiceProvider=n,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new nE(this),this.idTokenSubscription=new nE(this),this.beforeStateQueue=new wI(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=H2,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion,this._persistenceManagerAvailable=new Promise(o=>this._resolvePersistenceManagerAvailable=o)}_initializeWithPersistence(e,r){return r&&(this._popupRedirectResolver=Di(r)),this._initializationPromise=this.queue(async()=>{var n,i,o;if(!this._deleted&&(this.persistenceManager=await Zl.create(this,e),(n=this._resolvePersistenceManagerAvailable)===null||n===void 0||n.call(this),!this._deleted)){if(!((i=this._popupRedirectResolver)===null||i===void 0)&&i._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(r),this.lastNotifiedUid=((o=this.currentUser)===null||o===void 0?void 0:o.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const r=await C0(this,{idToken:e}),n=await Ra._fromGetAccountInfoResponse(this,r,e);await this.directlySetCurrentUser(n)}catch(r){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",r),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var r;if(fa(this.app)){const c=this.app.settings.authIdToken;return c?new Promise(u=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(c).then(u,u))}):this.directlySetCurrentUser(null)}const n=await this.assertedPersistence.getCurrentUser();let i=n,o=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const c=(r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId,u=i?._redirectEventId,h=await this.tryRedirectSignIn(e);(!c||c===u)&&h?.user&&(i=h.user,o=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(o)try{await this.beforeStateQueue.runMiddleware(i)}catch(c){i=n,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(c))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return tt(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(e){let r=null;try{r=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return r}async reloadAndSetCurrentUserOrClear(e){try{await R0(e)}catch(r){if(r?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=sI()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(fa(this.app))return Promise.reject(Os(this));const r=e?tn(e):null;return r&&tt(r.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(r&&r._clone(this))}async _updateCurrentUser(e,r=!1){if(!this._deleted)return e&&tt(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),r||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return fa(this.app)?Promise.reject(Os(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return fa(this.app)?Promise.reject(Os(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Di(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const r=this._getPasswordPolicyInternal();return r.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):r.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await SI(this),r=new RI(e);this.tenantId===null?this._projectPasswordPolicy=r:this._tenantPasswordPolicies[this.tenantId]=r}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new gf("auth","Firebase",e())}onAuthStateChanged(e,r,n){return this.registerStateListener(this.authStateSubscription,e,r,n)}beforeAuthStateChanged(e,r){return this.beforeStateQueue.pushCallback(e,r)}onIdTokenChanged(e,r,n){return this.registerStateListener(this.idTokenSubscription,e,r,n)}authStateReady(){return new Promise((e,r)=>{if(this.currentUser)e();else{const n=this.onAuthStateChanged(()=>{n(),e()},r)}})}async revokeAccessToken(e){if(this.currentUser){const r=await this.currentUser.getIdToken(),n={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:r};this.tenantId!=null&&(n.tenantId=this.tenantId),await EI(this,n)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,r){const n=await this.getOrInitRedirectPersistenceManager(r);return e===null?n.removeCurrentUser():n.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const r=e&&Di(e)||this._popupRedirectResolver;tt(r,this,"argument-error"),this.redirectPersistenceManager=await Zl.create(this,[Di(r._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var r,n;return this._isInitialized&&await this.queue(async()=>{}),((r=this._currentUser)===null||r===void 0?void 0:r._redirectEventId)===e?this._currentUser:((n=this.redirectUser)===null||n===void 0?void 0:n._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,r;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const n=(r=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&r!==void 0?r:null;this.lastNotifiedUid!==n&&(this.lastNotifiedUid=n,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,r,n,i){if(this._deleted)return()=>{};const o=typeof r=="function"?r:r.next.bind(r);let c=!1;const u=this._isInitialized?Promise.resolve():this._initializationPromise;if(tt(u,this,"internal-error"),u.then(()=>{c||o(this.currentUser)}),typeof r=="function"){const h=e.addObserver(r,n,i);return()=>{c=!0,h()}}else{const h=e.addObserver(r);return()=>{c=!0,h()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return tt(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=nA(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const r={"X-Client-Version":this.clientVersion};this.app.options.appId&&(r["X-Firebase-gmpid"]=this.app.options.appId);const n=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());n&&(r["X-Firebase-Client"]=n);const i=await this._getAppCheckToken();return i&&(r["X-Firebase-AppCheck"]=i),r}async _getAppCheckToken(){var e;if(fa(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const r=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return r?.error&&rI(`Error while retrieving App Check token: ${r.error}`),r?.token}}function Ko(t){return tn(t)}class nE{constructor(e){this.auth=e,this.observer=null,this.addObserver=Gk(r=>this.observer=r)}get next(){return tt(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let nd={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function bI(t){nd=t}function aA(t){return nd.loadJS(t)}function II(){return nd.recaptchaEnterpriseScript}function DI(){return nd.gapiScript}function OI(t){return`__${t}${Math.floor(Math.random()*1e6)}`}class NI{constructor(){this.enterprise=new FI}ready(e){e()}execute(e,r){return Promise.resolve("token")}render(e,r){return""}}class FI{ready(e){e()}execute(e,r){return Promise.resolve("token")}render(e,r){return""}}const PI="recaptcha-enterprise",iA="NO_RECAPTCHA";class MI{constructor(e){this.type=PI,this.auth=Ko(e)}async verify(e="verify",r=!1){async function n(o){if(!r){if(o.tenantId==null&&o._agentRecaptchaConfig!=null)return o._agentRecaptchaConfig.siteKey;if(o.tenantId!=null&&o._tenantRecaptchaConfigs[o.tenantId]!==void 0)return o._tenantRecaptchaConfigs[o.tenantId].siteKey}return new Promise(async(c,u)=>{dI(o,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(h=>{if(h.recaptchaKey===void 0)u(new Error("recaptcha Enterprise site key undefined"));else{const d=new hI(h);return o.tenantId==null?o._agentRecaptchaConfig=d:o._tenantRecaptchaConfigs[o.tenantId]=d,c(d.siteKey)}}).catch(h=>{u(h)})})}function i(o,c,u){const h=window.grecaptcha;Zy(h)?h.enterprise.ready(()=>{h.enterprise.execute(o,{action:e}).then(d=>{c(d)}).catch(()=>{c(iA)})}):u(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new NI().execute("siteKey",{action:"verify"}):new Promise((o,c)=>{n(this.auth).then(u=>{if(!r&&Zy(window.grecaptcha))i(u,o,c);else{if(typeof window>"u"){c(new Error("RecaptchaVerifier is only supported in browser"));return}let h=II();h.length!==0&&(h+=u),aA(h).then(()=>{i(u,o,c)}).catch(d=>{c(d)})}}).catch(u=>{c(u)})})}}async function aE(t,e,r,n=!1,i=!1){const o=new MI(t);let c;if(i)c=iA;else try{c=await o.verify(r)}catch{c=await o.verify(r,!0)}const u=Object.assign({},e);if(r==="mfaSmsEnrollment"||r==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in u){const h=u.phoneEnrollmentInfo.phoneNumber,d=u.phoneEnrollmentInfo.recaptchaToken;Object.assign(u,{phoneEnrollmentInfo:{phoneNumber:h,recaptchaToken:d,captchaResponse:c,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in u){const h=u.phoneSignInInfo.recaptchaToken;Object.assign(u,{phoneSignInInfo:{recaptchaToken:h,captchaResponse:c,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return u}return n?Object.assign(u,{captchaResp:c}):Object.assign(u,{captchaResponse:c}),Object.assign(u,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(u,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),u}async function iE(t,e,r,n,i){var o;if(!((o=t._getRecaptchaConfig())===null||o===void 0)&&o.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const c=await aE(t,e,r,r==="getOobCode");return n(t,c)}else return n(t,e).catch(async c=>{if(c.code==="auth/missing-recaptcha-token"){console.log(`${r} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const u=await aE(t,e,r,r==="getOobCode");return n(t,u)}else return Promise.reject(c)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function LI(t,e){const r=Zg(t,"auth");if(r.isInitialized()){const i=r.getImmediate(),o=r.getOptions();if(Mo(o,e??{}))return i;ma(i,"already-initialized")}return r.initialize({options:e})}function VI(t,e){const r=e?.persistence||[],n=(Array.isArray(r)?r:[r]).map(Di);e?.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(n,e?.popupRedirectResolver)}function UI(t,e,r){const n=Ko(t);tt(/^https?:\/\//.test(e),n,"invalid-emulator-scheme");const i=!1,o=sA(e),{host:c,port:u}=BI(e),h=u===null?"":`:${u}`,d={url:`${o}//${c}${h}/`},g=Object.freeze({host:c,port:u,protocol:o.replace(":",""),options:Object.freeze({disableWarnings:i})});if(!n._canInitEmulator){tt(n.config.emulator&&n.emulatorConfig,n,"emulator-config-failed"),tt(Mo(d,n.config.emulator)&&Mo(g,n.emulatorConfig),n,"emulator-config-failed");return}n.config.emulator=d,n.emulatorConfig=g,n.settings.appVerificationDisabledForTesting=!0,mc(c)?(F2(`${o}//${c}${h}`),P2("Auth",!0)):jI()}function sA(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function BI(t){const e=sA(t),r=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!r)return{host:"",port:null};const n=r[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(n);if(i){const o=i[1];return{host:o,port:sE(n.substr(o.length+1))}}else{const[o,c]=n.split(":");return{host:o,port:sE(c)}}}function sE(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function jI(){function t(){const e=document.createElement("p"),r=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",r.position="fixed",r.width="100%",r.backgroundColor="#ffffff",r.border=".1em solid #000000",r.color="#b50000",r.bottom="0px",r.left="0px",r.margin="0px",r.zIndex="10000",r.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class i1{constructor(e,r){this.providerId=e,this.signInMethod=r}toJSON(){return Ii("not implemented")}_getIdTokenResponse(e){return Ii("not implemented")}_linkToIdToken(e,r){return Ii("not implemented")}_getReauthenticationResolver(e){return Ii("not implemented")}}async function zI(t,e){return Ys(t,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function HI(t,e){return rd(t,"POST","/v1/accounts:signInWithPassword",qo(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function GI(t,e){return rd(t,"POST","/v1/accounts:signInWithEmailLink",qo(t,e))}async function qI(t,e){return rd(t,"POST","/v1/accounts:signInWithEmailLink",qo(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zu extends i1{constructor(e,r,n,i=null){super("password",n),this._email=e,this._password=r,this._tenantId=i}static _fromEmailAndPassword(e,r){return new Zu(e,r,"password")}static _fromEmailAndCode(e,r,n=null){return new Zu(e,r,"emailLink",n)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const r=typeof e=="string"?JSON.parse(e):e;if(r?.email&&r?.password){if(r.signInMethod==="password")return this._fromEmailAndPassword(r.email,r.password);if(r.signInMethod==="emailLink")return this._fromEmailAndCode(r.email,r.password,r.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const r={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return iE(e,r,"signInWithPassword",HI);case"emailLink":return GI(e,{email:this._email,oobCode:this._password});default:ma(e,"internal-error")}}async _linkToIdToken(e,r){switch(this.signInMethod){case"password":const n={idToken:r,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return iE(e,n,"signUpPassword",zI);case"emailLink":return qI(e,{idToken:r,email:this._email,oobCode:this._password});default:ma(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Jl(t,e){return rd(t,"POST","/v1/accounts:signInWithIdp",qo(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const KI="http://localhost";class Vo extends i1{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const r=new Vo(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(r.idToken=e.idToken),e.accessToken&&(r.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(r.nonce=e.nonce),e.pendingToken&&(r.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(r.accessToken=e.oauthToken,r.secret=e.oauthTokenSecret):ma("argument-error"),r}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const r=typeof e=="string"?JSON.parse(e):e,{providerId:n,signInMethod:i}=r,o=Jg(r,["providerId","signInMethod"]);if(!n||!i)return null;const c=new Vo(n,i);return c.idToken=o.idToken||void 0,c.accessToken=o.accessToken||void 0,c.secret=o.secret,c.nonce=o.nonce,c.pendingToken=o.pendingToken||null,c}_getIdTokenResponse(e){const r=this.buildRequest();return Jl(e,r)}_linkToIdToken(e,r){const n=this.buildRequest();return n.idToken=r,Jl(e,n)}_getReauthenticationResolver(e){const r=this.buildRequest();return r.autoCreate=!1,Jl(e,r)}buildRequest(){const e={requestUri:KI,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const r={};this.idToken&&(r.id_token=this.idToken),this.accessToken&&(r.access_token=this.accessToken),this.secret&&(r.oauth_token_secret=this.secret),r.providerId=this.providerId,this.nonce&&!this.pendingToken&&(r.nonce=this.nonce),e.postBody=vf(r)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function XI(t){switch(t){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function WI(t){const e=Au(wu(t)).link,r=e?Au(wu(e)).deep_link_id:null,n=Au(wu(t)).deep_link_id;return(n?Au(wu(n)).link:null)||n||r||e||t}class s1{constructor(e){var r,n,i,o,c,u;const h=Au(wu(e)),d=(r=h.apiKey)!==null&&r!==void 0?r:null,g=(n=h.oobCode)!==null&&n!==void 0?n:null,_=XI((i=h.mode)!==null&&i!==void 0?i:null);tt(d&&g&&_,"argument-error"),this.apiKey=d,this.operation=_,this.code=g,this.continueUrl=(o=h.continueUrl)!==null&&o!==void 0?o:null,this.languageCode=(c=h.lang)!==null&&c!==void 0?c:null,this.tenantId=(u=h.tenantId)!==null&&u!==void 0?u:null}static parseLink(e){const r=WI(e);try{return new s1(r)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vc{constructor(){this.providerId=vc.PROVIDER_ID}static credential(e,r){return Zu._fromEmailAndPassword(e,r)}static credentialWithLink(e,r){const n=s1.parseLink(r);return tt(n,"argument-error"),Zu._fromEmailAndCode(e,n.code,n.tenantId)}}vc.PROVIDER_ID="password";vc.EMAIL_PASSWORD_SIGN_IN_METHOD="password";vc.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class o1{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xf extends o1{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ys extends xf{constructor(){super("facebook.com")}static credential(e){return Vo._fromParams({providerId:ys.PROVIDER_ID,signInMethod:ys.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return ys.credentialFromTaggedObject(e)}static credentialFromError(e){return ys.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return ys.credential(e.oauthAccessToken)}catch{return null}}}ys.FACEBOOK_SIGN_IN_METHOD="facebook.com";ys.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bi extends xf{constructor(){super("google.com"),this.addScope("profile")}static credential(e,r){return Vo._fromParams({providerId:bi.PROVIDER_ID,signInMethod:bi.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:r})}static credentialFromResult(e){return bi.credentialFromTaggedObject(e)}static credentialFromError(e){return bi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:r,oauthAccessToken:n}=e;if(!r&&!n)return null;try{return bi.credential(r,n)}catch{return null}}}bi.GOOGLE_SIGN_IN_METHOD="google.com";bi.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Es extends xf{constructor(){super("github.com")}static credential(e){return Vo._fromParams({providerId:Es.PROVIDER_ID,signInMethod:Es.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Es.credentialFromTaggedObject(e)}static credentialFromError(e){return Es.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Es.credential(e.oauthAccessToken)}catch{return null}}}Es.GITHUB_SIGN_IN_METHOD="github.com";Es.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ts extends xf{constructor(){super("twitter.com")}static credential(e,r){return Vo._fromParams({providerId:Ts.PROVIDER_ID,signInMethod:Ts.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:r})}static credentialFromResult(e){return Ts.credentialFromTaggedObject(e)}static credentialFromError(e){return Ts.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:r,oauthTokenSecret:n}=e;if(!r||!n)return null;try{return Ts.credential(r,n)}catch{return null}}}Ts.TWITTER_SIGN_IN_METHOD="twitter.com";Ts.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sc{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,r,n,i=!1){const o=await Ra._fromIdTokenResponse(e,n,i),c=oE(n);return new sc({user:o,providerId:c,_tokenResponse:n,operationType:r})}static async _forOperation(e,r,n){await e._updateTokensIfNecessary(n,!0);const i=oE(n);return new sc({user:e,providerId:i,_tokenResponse:n,operationType:r})}}function oE(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class k0 extends ji{constructor(e,r,n,i){var o;super(r.code,r.message),this.operationType=n,this.user=i,Object.setPrototypeOf(this,k0.prototype),this.customData={appName:e.name,tenantId:(o=e.tenantId)!==null&&o!==void 0?o:void 0,_serverResponse:r.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(e,r,n,i){return new k0(e,r,n,i)}}function oA(t,e,r,n){return(e==="reauthenticate"?r._getReauthenticationResolver(t):r._getIdTokenResponse(t)).catch(o=>{throw o.code==="auth/multi-factor-auth-required"?k0._fromErrorAndOperation(t,o,e,n):o})}async function YI(t,e,r=!1){const n=await Qu(t,e._linkToIdToken(t.auth,await t.getIdToken()),r);return sc._forOperation(t,"link",n)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function $I(t,e,r=!1){const{auth:n}=t;if(fa(n.app))return Promise.reject(Os(n));const i="reauthenticate";try{const o=await Qu(t,oA(n,i,e,t),r);tt(o.idToken,n,"internal-error");const c=n1(o.idToken);tt(c,n,"internal-error");const{sub:u}=c;return tt(t.uid===u,n,"user-mismatch"),sc._forOperation(t,i,o)}catch(o){throw o?.code==="auth/user-not-found"&&ma(n,"user-mismatch"),o}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function lA(t,e,r=!1){if(fa(t.app))return Promise.reject(Os(t));const n="signIn",i=await oA(t,n,e),o=await sc._fromIdTokenResponse(t,n,i);return r||await t._updateCurrentUser(o.user),o}async function QI(t,e){return lA(Ko(t),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ZI(t){const e=Ko(t);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}function JI(t,e,r){return fa(t.app)?Promise.reject(Os(t)):QI(tn(t),vc.credential(e,r)).catch(async n=>{throw n.code==="auth/password-does-not-meet-requirements"&&ZI(t),n})}function e3(t,e,r,n){return tn(t).onIdTokenChanged(e,r,n)}function t3(t,e,r){return tn(t).beforeAuthStateChanged(e,r)}function r3(t,e,r,n){return tn(t).onAuthStateChanged(e,r,n)}function n3(t){return tn(t).signOut()}const b0="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cA{constructor(e,r){this.storageRetriever=e,this.type=r}_isAvailable(){try{return this.storage?(this.storage.setItem(b0,"1"),this.storage.removeItem(b0),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,r){return this.storage.setItem(e,JSON.stringify(r)),Promise.resolve()}_get(e){const r=this.storage.getItem(e);return Promise.resolve(r?JSON.parse(r):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const a3=1e3,i3=10;class uA extends cA{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,r)=>this.onStorageEvent(e,r),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=rA(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const r of Object.keys(this.listeners)){const n=this.storage.getItem(r),i=this.localCache[r];n!==i&&e(r,i,n)}}onStorageEvent(e,r=!1){if(!e.key){this.forAllChangedKeys((c,u,h)=>{this.notifyListeners(c,h)});return}const n=e.key;r?this.detachListener():this.stopPolling();const i=()=>{const c=this.storage.getItem(n);!r&&this.localCache[n]===c||this.notifyListeners(n,c)},o=this.storage.getItem(n);AI()&&o!==e.newValue&&e.newValue!==e.oldValue?setTimeout(i,i3):i()}notifyListeners(e,r){this.localCache[e]=r;const n=this.listeners[e];if(n)for(const i of Array.from(n))i(r&&JSON.parse(r))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,r,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:r,newValue:n}),!0)})},a3)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,r){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,r){await super._set(e,r),this.localCache[e]=JSON.stringify(r)}async _get(e){const r=await super._get(e);return this.localCache[e]=JSON.stringify(r),r}async _remove(e){await super._remove(e),delete this.localCache[e]}}uA.type="LOCAL";const s3=uA;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fA extends cA{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,r){}_removeListener(e,r){}}fA.type="SESSION";const hA=fA;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function o3(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(r){return{fulfilled:!1,reason:r}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ad{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const r=this.receivers.find(i=>i.isListeningto(e));if(r)return r;const n=new ad(e);return this.receivers.push(n),n}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const r=e,{eventId:n,eventType:i,data:o}=r.data,c=this.handlersMap[i];if(!c?.size)return;r.ports[0].postMessage({status:"ack",eventId:n,eventType:i});const u=Array.from(c).map(async d=>d(r.origin,o)),h=await o3(u);r.ports[0].postMessage({status:"done",eventId:n,eventType:i,response:h})}_subscribe(e,r){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(r)}_unsubscribe(e,r){this.handlersMap[e]&&r&&this.handlersMap[e].delete(r),(!r||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}ad.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function l1(t="",e=10){let r="";for(let n=0;n<e;n++)r+=Math.floor(Math.random()*10);return t+r}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class l3{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,r,n=50){const i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let o,c;return new Promise((u,h)=>{const d=l1("",20);i.port1.start();const g=setTimeout(()=>{h(new Error("unsupported_event"))},n);c={messageChannel:i,onMessage(_){const x=_;if(x.data.eventId===d)switch(x.data.status){case"ack":clearTimeout(g),o=setTimeout(()=>{h(new Error("timeout"))},3e3);break;case"done":clearTimeout(o),u(x.data.response);break;default:clearTimeout(g),clearTimeout(o),h(new Error("invalid_response"));break}}},this.handlers.add(c),i.port1.addEventListener("message",c.onMessage),this.target.postMessage({eventType:e,eventId:d,data:r},[i.port2])}).finally(()=>{c&&this.removeMessageHandler(c)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ja(){return window}function c3(t){Ja().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dA(){return typeof Ja().WorkerGlobalScope<"u"&&typeof Ja().importScripts=="function"}async function u3(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function f3(){var t;return((t=navigator?.serviceWorker)===null||t===void 0?void 0:t.controller)||null}function h3(){return dA()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pA="firebaseLocalStorageDb",d3=1,I0="firebaseLocalStorage",mA="fbase_key";class yf{constructor(e){this.request=e}toPromise(){return new Promise((e,r)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{r(this.request.error)})})}}function id(t,e){return t.transaction([I0],e?"readwrite":"readonly").objectStore(I0)}function p3(){const t=indexedDB.deleteDatabase(pA);return new yf(t).toPromise()}function pg(){const t=indexedDB.open(pA,d3);return new Promise((e,r)=>{t.addEventListener("error",()=>{r(t.error)}),t.addEventListener("upgradeneeded",()=>{const n=t.result;try{n.createObjectStore(I0,{keyPath:mA})}catch(i){r(i)}}),t.addEventListener("success",async()=>{const n=t.result;n.objectStoreNames.contains(I0)?e(n):(n.close(),await p3(),e(await pg()))})})}async function lE(t,e,r){const n=id(t,!0).put({[mA]:e,value:r});return new yf(n).toPromise()}async function m3(t,e){const r=id(t,!1).get(e),n=await new yf(r).toPromise();return n===void 0?null:n.value}function cE(t,e){const r=id(t,!0).delete(e);return new yf(r).toPromise()}const g3=800,v3=3;class gA{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await pg(),this.db)}async _withRetries(e){let r=0;for(;;)try{const n=await this._openDb();return await e(n)}catch(n){if(r++>v3)throw n;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return dA()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=ad._getInstance(h3()),this.receiver._subscribe("keyChanged",async(e,r)=>({keyProcessed:(await this._poll()).includes(r.key)})),this.receiver._subscribe("ping",async(e,r)=>["keyChanged"])}async initializeSender(){var e,r;if(this.activeServiceWorker=await u3(),!this.activeServiceWorker)return;this.sender=new l3(this.activeServiceWorker);const n=await this.sender._send("ping",{},800);n&&!((e=n[0])===null||e===void 0)&&e.fulfilled&&!((r=n[0])===null||r===void 0)&&r.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||f3()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await pg();return await lE(e,b0,"1"),await cE(e,b0),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,r){return this._withPendingWrite(async()=>(await this._withRetries(n=>lE(n,e,r)),this.localCache[e]=r,this.notifyServiceWorker(e)))}async _get(e){const r=await this._withRetries(n=>m3(n,e));return this.localCache[e]=r,r}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(r=>cE(r,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(i=>{const o=id(i,!1).getAll();return new yf(o).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const r=[],n=new Set;if(e.length!==0)for(const{fbase_key:i,value:o}of e)n.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(o)&&(this.notifyListeners(i,o),r.push(i));for(const i of Object.keys(this.localCache))this.localCache[i]&&!n.has(i)&&(this.notifyListeners(i,null),r.push(i));return r}notifyListeners(e,r){this.localCache[e]=r;const n=this.listeners[e];if(n)for(const i of Array.from(n))i(r)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),g3)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,r){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}gA.type="LOCAL";const _3=gA;new _f(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vA(t,e){return e?Di(e):(tt(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class c1 extends i1{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Jl(e,this._buildIdpRequest())}_linkToIdToken(e,r){return Jl(e,this._buildIdpRequest(r))}_getReauthenticationResolver(e){return Jl(e,this._buildIdpRequest())}_buildIdpRequest(e){const r={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(r.idToken=e),r}}function x3(t){return lA(t.auth,new c1(t),t.bypassAuthState)}function y3(t){const{auth:e,user:r}=t;return tt(r,e,"internal-error"),$I(r,new c1(t),t.bypassAuthState)}async function E3(t){const{auth:e,user:r}=t;return tt(r,e,"internal-error"),YI(r,new c1(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _A{constructor(e,r,n,i,o=!1){this.auth=e,this.resolver=n,this.user=i,this.bypassAuthState=o,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(r)?r:[r]}execute(){return new Promise(async(e,r)=>{this.pendingPromise={resolve:e,reject:r};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(n){this.reject(n)}})}async onAuthEvent(e){const{urlResponse:r,sessionId:n,postBody:i,tenantId:o,error:c,type:u}=e;if(c){this.reject(c);return}const h={auth:this.auth,requestUri:r,sessionId:n,tenantId:o||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(u)(h))}catch(d){this.reject(d)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return x3;case"linkViaPopup":case"linkViaRedirect":return E3;case"reauthViaPopup":case"reauthViaRedirect":return y3;default:ma(this.auth,"internal-error")}}resolve(e){Vi(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Vi(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const T3=new _f(2e3,1e4);async function A3(t,e,r){if(fa(t.app))return Promise.reject(Da(t,"operation-not-supported-in-this-environment"));const n=Ko(t);nI(t,e,o1);const i=vA(n,r);return new Io(n,"signInViaPopup",e,i).executeNotNull()}class Io extends _A{constructor(e,r,n,i,o){super(e,r,i,o),this.provider=n,this.authWindow=null,this.pollId=null,Io.currentPopupAction&&Io.currentPopupAction.cancel(),Io.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return tt(e,this.auth,"internal-error"),e}async onExecution(){Vi(this.filter.length===1,"Popup operations only handle one event");const e=l1();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(r=>{this.reject(r)}),this.resolver._isIframeWebStorageSupported(this.auth,r=>{r||this.reject(Da(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(Da(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Io.currentPopupAction=null}pollUserCancellation(){const e=()=>{var r,n;if(!((n=(r=this.authWindow)===null||r===void 0?void 0:r.window)===null||n===void 0)&&n.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Da(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,T3.get())};e()}}Io.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const w3="pendingRedirect",d0=new Map;class S3 extends _A{constructor(e,r,n=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],r,void 0,n),this.eventId=null}async execute(){let e=d0.get(this.auth._key());if(!e){try{const n=await C3(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(n)}catch(r){e=()=>Promise.reject(r)}d0.set(this.auth._key(),e)}return this.bypassAuthState||d0.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const r=await this.auth._redirectUserForId(e.eventId);if(r)return this.user=r,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function C3(t,e){const r=b3(e),n=k3(t);if(!await n._isAvailable())return!1;const i=await n._get(r)==="true";return await n._remove(r),i}function R3(t,e){d0.set(t._key(),e)}function k3(t){return Di(t._redirectPersistence)}function b3(t){return h0(w3,t.config.apiKey,t.name)}async function I3(t,e,r=!1){if(fa(t.app))return Promise.reject(Os(t));const n=Ko(t),i=vA(n,e),c=await new S3(n,i,r).execute();return c&&!r&&(delete c.user._redirectEventId,await n._persistUserIfCurrent(c.user),await n._setRedirectUser(null,e)),c}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const D3=10*60*1e3;class O3{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let r=!1;return this.consumers.forEach(n=>{this.isEventForConsumer(e,n)&&(r=!0,this.sendToConsumer(e,n),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!N3(e)||(this.hasHandledPotentialRedirect=!0,r||(this.queuedRedirectEvent=e,r=!0)),r}sendToConsumer(e,r){var n;if(e.error&&!xA(e)){const i=((n=e.error.code)===null||n===void 0?void 0:n.split("auth/")[1])||"internal-error";r.onError(Da(this.auth,i))}else r.onAuthEvent(e)}isEventForConsumer(e,r){const n=r.eventId===null||!!e.eventId&&e.eventId===r.eventId;return r.filter.includes(e.type)&&n}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=D3&&this.cachedEventUids.clear(),this.cachedEventUids.has(uE(e))}saveEventToCache(e){this.cachedEventUids.add(uE(e)),this.lastProcessedEventTime=Date.now()}}function uE(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function xA({type:t,error:e}){return t==="unknown"&&e?.code==="auth/no-auth-event"}function N3(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return xA(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function F3(t,e={}){return Ys(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const P3=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,M3=/^https?/;async function L3(t){if(t.config.emulator)return;const{authorizedDomains:e}=await F3(t);for(const r of e)try{if(V3(r))return}catch{}ma(t,"unauthorized-domain")}function V3(t){const e=hg(),{protocol:r,hostname:n}=new URL(e);if(t.startsWith("chrome-extension://")){const c=new URL(t);return c.hostname===""&&n===""?r==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):r==="chrome-extension:"&&c.hostname===n}if(!M3.test(r))return!1;if(P3.test(t))return n===t;const i=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(n)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const U3=new _f(3e4,6e4);function fE(){const t=Ja().___jsl;if(t?.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let r=0;r<t.CP.length;r++)t.CP[r]=null}}function B3(t){return new Promise((e,r)=>{var n,i,o;function c(){fE(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{fE(),r(Da(t,"network-request-failed"))},timeout:U3.get()})}if(!((i=(n=Ja().gapi)===null||n===void 0?void 0:n.iframes)===null||i===void 0)&&i.Iframe)e(gapi.iframes.getContext());else if(!((o=Ja().gapi)===null||o===void 0)&&o.load)c();else{const u=OI("iframefcb");return Ja()[u]=()=>{gapi.load?c():r(Da(t,"network-request-failed"))},aA(`${DI()}?onload=${u}`).catch(h=>r(h))}}).catch(e=>{throw p0=null,e})}let p0=null;function j3(t){return p0=p0||B3(t),p0}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const z3=new _f(5e3,15e3),H3="__/auth/iframe",G3="emulator/auth/iframe",q3={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},K3=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function X3(t){const e=t.config;tt(e.authDomain,t,"auth-domain-config-required");const r=e.emulator?r1(e,G3):`https://${t.config.authDomain}/${H3}`,n={apiKey:e.apiKey,appName:t.name,v:gc},i=K3.get(t.config.apiHost);i&&(n.eid=i);const o=t._getFrameworks();return o.length&&(n.fw=o.join(",")),`${r}?${vf(n).slice(1)}`}async function W3(t){const e=await j3(t),r=Ja().gapi;return tt(r,t,"internal-error"),e.open({where:document.body,url:X3(t),messageHandlersFilter:r.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:q3,dontclear:!0},n=>new Promise(async(i,o)=>{await n.restyle({setHideOnLeave:!1});const c=Da(t,"network-request-failed"),u=Ja().setTimeout(()=>{o(c)},z3.get());function h(){Ja().clearTimeout(u),i(n)}n.ping(h).then(h,()=>{o(c)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Y3={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},$3=500,Q3=600,Z3="_blank",J3="http://localhost";class hE{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function eD(t,e,r,n=$3,i=Q3){const o=Math.max((window.screen.availHeight-i)/2,0).toString(),c=Math.max((window.screen.availWidth-n)/2,0).toString();let u="";const h=Object.assign(Object.assign({},Y3),{width:n.toString(),height:i.toString(),top:o,left:c}),d=pn().toLowerCase();r&&(u=Q2(d)?Z3:r),Y2(d)&&(e=e||J3,h.scrollbars="yes");const g=Object.entries(h).reduce((x,[A,w])=>`${x}${A}=${w},`,"");if(TI(d)&&u!=="_self")return tD(e||"",u),new hE(null);const _=window.open(e||"",u,g);tt(_,t,"popup-blocked");try{_.focus()}catch{}return new hE(_)}function tD(t,e){const r=document.createElement("a");r.href=t,r.target=e;const n=document.createEvent("MouseEvent");n.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),r.dispatchEvent(n)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rD="__/auth/handler",nD="emulator/auth/handler",aD=encodeURIComponent("fac");async function dE(t,e,r,n,i,o){tt(t.config.authDomain,t,"auth-domain-config-required"),tt(t.config.apiKey,t,"invalid-api-key");const c={apiKey:t.config.apiKey,appName:t.name,authType:r,redirectUrl:n,v:gc,eventId:i};if(e instanceof o1){e.setDefaultLanguage(t.languageCode),c.providerId=e.providerId||"",Hk(e.getCustomParameters())||(c.customParameters=JSON.stringify(e.getCustomParameters()));for(const[g,_]of Object.entries({}))c[g]=_}if(e instanceof xf){const g=e.getScopes().filter(_=>_!=="");g.length>0&&(c.scopes=g.join(","))}t.tenantId&&(c.tid=t.tenantId);const u=c;for(const g of Object.keys(u))u[g]===void 0&&delete u[g];const h=await t._getAppCheckToken(),d=h?`#${aD}=${encodeURIComponent(h)}`:"";return`${iD(t)}?${vf(u).slice(1)}${d}`}function iD({config:t}){return t.emulator?r1(t,nD):`https://${t.authDomain}/${rD}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hm="webStorageSupport";class sD{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=hA,this._completeRedirectFn=I3,this._overrideRedirectResult=R3}async _openPopup(e,r,n,i){var o;Vi((o=this.eventManagers[e._key()])===null||o===void 0?void 0:o.manager,"_initialize() not called before _openPopup()");const c=await dE(e,r,n,hg(),i);return eD(e,c,l1())}async _openRedirect(e,r,n,i){await this._originValidation(e);const o=await dE(e,r,n,hg(),i);return c3(o),new Promise(()=>{})}_initialize(e){const r=e._key();if(this.eventManagers[r]){const{manager:i,promise:o}=this.eventManagers[r];return i?Promise.resolve(i):(Vi(o,"If manager is not set, promise should be"),o)}const n=this.initAndGetManager(e);return this.eventManagers[r]={promise:n},n.catch(()=>{delete this.eventManagers[r]}),n}async initAndGetManager(e){const r=await W3(e),n=new O3(e);return r.register("authEvent",i=>(tt(i?.authEvent,e,"invalid-auth-event"),{status:n.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:n},this.iframes[e._key()]=r,n}_isIframeWebStorageSupported(e,r){this.iframes[e._key()].send(Hm,{type:Hm},i=>{var o;const c=(o=i?.[0])===null||o===void 0?void 0:o[Hm];c!==void 0&&r(!!c),ma(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const r=e._key();return this.originValidationPromises[r]||(this.originValidationPromises[r]=L3(e)),this.originValidationPromises[r]}get _shouldInitProactively(){return rA()||$2()||a1()}}const oD=sD;var pE="@firebase/auth",mE="1.10.8";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lD{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const r=this.auth.onIdTokenChanged(n=>{e(n?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,r),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const r=this.internalListeners.get(e);r&&(this.internalListeners.delete(e),r(),this.updateProactiveRefresh())}assertAuthConfigured(){tt(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cD(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function uD(t){ic(new Lo("auth",(e,{options:r})=>{const n=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),o=e.getProvider("app-check-internal"),{apiKey:c,authDomain:u}=n.options;tt(c&&!c.includes(":"),"invalid-api-key",{appName:n.name});const h={apiKey:c,authDomain:u,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:nA(t)},d=new kI(n,i,o,h);return VI(d,r),d},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,r,n)=>{e.getProvider("auth-internal").initialize()})),ic(new Lo("auth-internal",e=>{const r=Ko(e.getProvider("auth").getImmediate());return(n=>new lD(n))(r)},"PRIVATE").setInstantiationMode("EXPLICIT")),Ds(pE,mE,cD(t)),Ds(pE,mE,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fD=5*60,hD=N2("authIdTokenMaxAge")||fD;let gE=null;const dD=t=>async e=>{const r=e&&await e.getIdTokenResult(),n=r&&(new Date().getTime()-Date.parse(r.issuedAtTime))/1e3;if(n&&n>hD)return;const i=r?.token;gE!==i&&(gE=i,await fetch(t,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))};function pD(t=U2()){const e=Zg(t,"auth");if(e.isInitialized())return e.getImmediate();const r=LI(t,{popupRedirectResolver:oD,persistence:[_3,s3,hA]}),n=N2("authTokenSyncURL");if(n&&typeof isSecureContext=="boolean"&&isSecureContext){const o=new URL(n,location.origin);if(location.origin===o.origin){const c=dD(o.toString());t3(r,c,()=>c(r.currentUser)),e3(r,u=>c(u))}}const i=D2("auth");return i&&UI(r,`http://${i}`),r}function mD(){var t,e;return(e=(t=document.getElementsByTagName("head"))===null||t===void 0?void 0:t[0])!==null&&e!==void 0?e:document}bI({loadJS(t){return new Promise((e,r)=>{const n=document.createElement("script");n.setAttribute("src",t),n.onload=e,n.onerror=i=>{const o=Da("internal-error");o.customData=i,r(o)},n.type="text/javascript",n.charset="UTF-8",mD().appendChild(n)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});uD("Browser");var vE=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Ns,yA;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(k,T){function E(){}E.prototype=T.prototype,k.D=T.prototype,k.prototype=new E,k.prototype.constructor=k,k.C=function(I,O,D){for(var F=Array(arguments.length-2),Fe=2;Fe<arguments.length;Fe++)F[Fe-2]=arguments[Fe];return T.prototype[O].apply(I,F)}}function r(){this.blockSize=-1}function n(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(n,r),n.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(k,T,E){E||(E=0);var I=Array(16);if(typeof T=="string")for(var O=0;16>O;++O)I[O]=T.charCodeAt(E++)|T.charCodeAt(E++)<<8|T.charCodeAt(E++)<<16|T.charCodeAt(E++)<<24;else for(O=0;16>O;++O)I[O]=T[E++]|T[E++]<<8|T[E++]<<16|T[E++]<<24;T=k.g[0],E=k.g[1],O=k.g[2];var D=k.g[3],F=T+(D^E&(O^D))+I[0]+3614090360&4294967295;T=E+(F<<7&4294967295|F>>>25),F=D+(O^T&(E^O))+I[1]+3905402710&4294967295,D=T+(F<<12&4294967295|F>>>20),F=O+(E^D&(T^E))+I[2]+606105819&4294967295,O=D+(F<<17&4294967295|F>>>15),F=E+(T^O&(D^T))+I[3]+3250441966&4294967295,E=O+(F<<22&4294967295|F>>>10),F=T+(D^E&(O^D))+I[4]+4118548399&4294967295,T=E+(F<<7&4294967295|F>>>25),F=D+(O^T&(E^O))+I[5]+1200080426&4294967295,D=T+(F<<12&4294967295|F>>>20),F=O+(E^D&(T^E))+I[6]+2821735955&4294967295,O=D+(F<<17&4294967295|F>>>15),F=E+(T^O&(D^T))+I[7]+4249261313&4294967295,E=O+(F<<22&4294967295|F>>>10),F=T+(D^E&(O^D))+I[8]+1770035416&4294967295,T=E+(F<<7&4294967295|F>>>25),F=D+(O^T&(E^O))+I[9]+2336552879&4294967295,D=T+(F<<12&4294967295|F>>>20),F=O+(E^D&(T^E))+I[10]+4294925233&4294967295,O=D+(F<<17&4294967295|F>>>15),F=E+(T^O&(D^T))+I[11]+2304563134&4294967295,E=O+(F<<22&4294967295|F>>>10),F=T+(D^E&(O^D))+I[12]+1804603682&4294967295,T=E+(F<<7&4294967295|F>>>25),F=D+(O^T&(E^O))+I[13]+4254626195&4294967295,D=T+(F<<12&4294967295|F>>>20),F=O+(E^D&(T^E))+I[14]+2792965006&4294967295,O=D+(F<<17&4294967295|F>>>15),F=E+(T^O&(D^T))+I[15]+1236535329&4294967295,E=O+(F<<22&4294967295|F>>>10),F=T+(O^D&(E^O))+I[1]+4129170786&4294967295,T=E+(F<<5&4294967295|F>>>27),F=D+(E^O&(T^E))+I[6]+3225465664&4294967295,D=T+(F<<9&4294967295|F>>>23),F=O+(T^E&(D^T))+I[11]+643717713&4294967295,O=D+(F<<14&4294967295|F>>>18),F=E+(D^T&(O^D))+I[0]+3921069994&4294967295,E=O+(F<<20&4294967295|F>>>12),F=T+(O^D&(E^O))+I[5]+3593408605&4294967295,T=E+(F<<5&4294967295|F>>>27),F=D+(E^O&(T^E))+I[10]+38016083&4294967295,D=T+(F<<9&4294967295|F>>>23),F=O+(T^E&(D^T))+I[15]+3634488961&4294967295,O=D+(F<<14&4294967295|F>>>18),F=E+(D^T&(O^D))+I[4]+3889429448&4294967295,E=O+(F<<20&4294967295|F>>>12),F=T+(O^D&(E^O))+I[9]+568446438&4294967295,T=E+(F<<5&4294967295|F>>>27),F=D+(E^O&(T^E))+I[14]+3275163606&4294967295,D=T+(F<<9&4294967295|F>>>23),F=O+(T^E&(D^T))+I[3]+4107603335&4294967295,O=D+(F<<14&4294967295|F>>>18),F=E+(D^T&(O^D))+I[8]+1163531501&4294967295,E=O+(F<<20&4294967295|F>>>12),F=T+(O^D&(E^O))+I[13]+2850285829&4294967295,T=E+(F<<5&4294967295|F>>>27),F=D+(E^O&(T^E))+I[2]+4243563512&4294967295,D=T+(F<<9&4294967295|F>>>23),F=O+(T^E&(D^T))+I[7]+1735328473&4294967295,O=D+(F<<14&4294967295|F>>>18),F=E+(D^T&(O^D))+I[12]+2368359562&4294967295,E=O+(F<<20&4294967295|F>>>12),F=T+(E^O^D)+I[5]+4294588738&4294967295,T=E+(F<<4&4294967295|F>>>28),F=D+(T^E^O)+I[8]+2272392833&4294967295,D=T+(F<<11&4294967295|F>>>21),F=O+(D^T^E)+I[11]+1839030562&4294967295,O=D+(F<<16&4294967295|F>>>16),F=E+(O^D^T)+I[14]+4259657740&4294967295,E=O+(F<<23&4294967295|F>>>9),F=T+(E^O^D)+I[1]+2763975236&4294967295,T=E+(F<<4&4294967295|F>>>28),F=D+(T^E^O)+I[4]+1272893353&4294967295,D=T+(F<<11&4294967295|F>>>21),F=O+(D^T^E)+I[7]+4139469664&4294967295,O=D+(F<<16&4294967295|F>>>16),F=E+(O^D^T)+I[10]+3200236656&4294967295,E=O+(F<<23&4294967295|F>>>9),F=T+(E^O^D)+I[13]+681279174&4294967295,T=E+(F<<4&4294967295|F>>>28),F=D+(T^E^O)+I[0]+3936430074&4294967295,D=T+(F<<11&4294967295|F>>>21),F=O+(D^T^E)+I[3]+3572445317&4294967295,O=D+(F<<16&4294967295|F>>>16),F=E+(O^D^T)+I[6]+76029189&4294967295,E=O+(F<<23&4294967295|F>>>9),F=T+(E^O^D)+I[9]+3654602809&4294967295,T=E+(F<<4&4294967295|F>>>28),F=D+(T^E^O)+I[12]+3873151461&4294967295,D=T+(F<<11&4294967295|F>>>21),F=O+(D^T^E)+I[15]+530742520&4294967295,O=D+(F<<16&4294967295|F>>>16),F=E+(O^D^T)+I[2]+3299628645&4294967295,E=O+(F<<23&4294967295|F>>>9),F=T+(O^(E|~D))+I[0]+4096336452&4294967295,T=E+(F<<6&4294967295|F>>>26),F=D+(E^(T|~O))+I[7]+1126891415&4294967295,D=T+(F<<10&4294967295|F>>>22),F=O+(T^(D|~E))+I[14]+2878612391&4294967295,O=D+(F<<15&4294967295|F>>>17),F=E+(D^(O|~T))+I[5]+4237533241&4294967295,E=O+(F<<21&4294967295|F>>>11),F=T+(O^(E|~D))+I[12]+1700485571&4294967295,T=E+(F<<6&4294967295|F>>>26),F=D+(E^(T|~O))+I[3]+2399980690&4294967295,D=T+(F<<10&4294967295|F>>>22),F=O+(T^(D|~E))+I[10]+4293915773&4294967295,O=D+(F<<15&4294967295|F>>>17),F=E+(D^(O|~T))+I[1]+2240044497&4294967295,E=O+(F<<21&4294967295|F>>>11),F=T+(O^(E|~D))+I[8]+1873313359&4294967295,T=E+(F<<6&4294967295|F>>>26),F=D+(E^(T|~O))+I[15]+4264355552&4294967295,D=T+(F<<10&4294967295|F>>>22),F=O+(T^(D|~E))+I[6]+2734768916&4294967295,O=D+(F<<15&4294967295|F>>>17),F=E+(D^(O|~T))+I[13]+1309151649&4294967295,E=O+(F<<21&4294967295|F>>>11),F=T+(O^(E|~D))+I[4]+4149444226&4294967295,T=E+(F<<6&4294967295|F>>>26),F=D+(E^(T|~O))+I[11]+3174756917&4294967295,D=T+(F<<10&4294967295|F>>>22),F=O+(T^(D|~E))+I[2]+718787259&4294967295,O=D+(F<<15&4294967295|F>>>17),F=E+(D^(O|~T))+I[9]+3951481745&4294967295,k.g[0]=k.g[0]+T&4294967295,k.g[1]=k.g[1]+(O+(F<<21&4294967295|F>>>11))&4294967295,k.g[2]=k.g[2]+O&4294967295,k.g[3]=k.g[3]+D&4294967295}n.prototype.u=function(k,T){T===void 0&&(T=k.length);for(var E=T-this.blockSize,I=this.B,O=this.h,D=0;D<T;){if(O==0)for(;D<=E;)i(this,k,D),D+=this.blockSize;if(typeof k=="string"){for(;D<T;)if(I[O++]=k.charCodeAt(D++),O==this.blockSize){i(this,I),O=0;break}}else for(;D<T;)if(I[O++]=k[D++],O==this.blockSize){i(this,I),O=0;break}}this.h=O,this.o+=T},n.prototype.v=function(){var k=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);k[0]=128;for(var T=1;T<k.length-8;++T)k[T]=0;var E=8*this.o;for(T=k.length-8;T<k.length;++T)k[T]=E&255,E/=256;for(this.u(k),k=Array(16),T=E=0;4>T;++T)for(var I=0;32>I;I+=8)k[E++]=this.g[T]>>>I&255;return k};function o(k,T){var E=u;return Object.prototype.hasOwnProperty.call(E,k)?E[k]:E[k]=T(k)}function c(k,T){this.h=T;for(var E=[],I=!0,O=k.length-1;0<=O;O--){var D=k[O]|0;I&&D==T||(E[O]=D,I=!1)}this.g=E}var u={};function h(k){return-128<=k&&128>k?o(k,function(T){return new c([T|0],0>T?-1:0)}):new c([k|0],0>k?-1:0)}function d(k){if(isNaN(k)||!isFinite(k))return _;if(0>k)return C(d(-k));for(var T=[],E=1,I=0;k>=E;I++)T[I]=k/E|0,E*=4294967296;return new c(T,0)}function g(k,T){if(k.length==0)throw Error("number format error: empty string");if(T=T||10,2>T||36<T)throw Error("radix out of range: "+T);if(k.charAt(0)=="-")return C(g(k.substring(1),T));if(0<=k.indexOf("-"))throw Error('number format error: interior "-" character');for(var E=d(Math.pow(T,8)),I=_,O=0;O<k.length;O+=8){var D=Math.min(8,k.length-O),F=parseInt(k.substring(O,O+D),T);8>D?(D=d(Math.pow(T,D)),I=I.j(D).add(d(F))):(I=I.j(E),I=I.add(d(F)))}return I}var _=h(0),x=h(1),A=h(16777216);t=c.prototype,t.m=function(){if(S(this))return-C(this).m();for(var k=0,T=1,E=0;E<this.g.length;E++){var I=this.i(E);k+=(0<=I?I:4294967296+I)*T,T*=4294967296}return k},t.toString=function(k){if(k=k||10,2>k||36<k)throw Error("radix out of range: "+k);if(w(this))return"0";if(S(this))return"-"+C(this).toString(k);for(var T=d(Math.pow(k,6)),E=this,I="";;){var O=re(E,T).g;E=z(E,O.j(T));var D=((0<E.g.length?E.g[0]:E.h)>>>0).toString(k);if(E=O,w(E))return D+I;for(;6>D.length;)D="0"+D;I=D+I}},t.i=function(k){return 0>k?0:k<this.g.length?this.g[k]:this.h};function w(k){if(k.h!=0)return!1;for(var T=0;T<k.g.length;T++)if(k.g[T]!=0)return!1;return!0}function S(k){return k.h==-1}t.l=function(k){return k=z(this,k),S(k)?-1:w(k)?0:1};function C(k){for(var T=k.g.length,E=[],I=0;I<T;I++)E[I]=~k.g[I];return new c(E,~k.h).add(x)}t.abs=function(){return S(this)?C(this):this},t.add=function(k){for(var T=Math.max(this.g.length,k.g.length),E=[],I=0,O=0;O<=T;O++){var D=I+(this.i(O)&65535)+(k.i(O)&65535),F=(D>>>16)+(this.i(O)>>>16)+(k.i(O)>>>16);I=F>>>16,D&=65535,F&=65535,E[O]=F<<16|D}return new c(E,E[E.length-1]&-2147483648?-1:0)};function z(k,T){return k.add(C(T))}t.j=function(k){if(w(this)||w(k))return _;if(S(this))return S(k)?C(this).j(C(k)):C(C(this).j(k));if(S(k))return C(this.j(C(k)));if(0>this.l(A)&&0>k.l(A))return d(this.m()*k.m());for(var T=this.g.length+k.g.length,E=[],I=0;I<2*T;I++)E[I]=0;for(I=0;I<this.g.length;I++)for(var O=0;O<k.g.length;O++){var D=this.i(I)>>>16,F=this.i(I)&65535,Fe=k.i(O)>>>16,Ce=k.i(O)&65535;E[2*I+2*O]+=F*Ce,W(E,2*I+2*O),E[2*I+2*O+1]+=D*Ce,W(E,2*I+2*O+1),E[2*I+2*O+1]+=F*Fe,W(E,2*I+2*O+1),E[2*I+2*O+2]+=D*Fe,W(E,2*I+2*O+2)}for(I=0;I<T;I++)E[I]=E[2*I+1]<<16|E[2*I];for(I=T;I<2*T;I++)E[I]=0;return new c(E,0)};function W(k,T){for(;(k[T]&65535)!=k[T];)k[T+1]+=k[T]>>>16,k[T]&=65535,T++}function P(k,T){this.g=k,this.h=T}function re(k,T){if(w(T))throw Error("division by zero");if(w(k))return new P(_,_);if(S(k))return T=re(C(k),T),new P(C(T.g),C(T.h));if(S(T))return T=re(k,C(T)),new P(C(T.g),T.h);if(30<k.g.length){if(S(k)||S(T))throw Error("slowDivide_ only works with positive integers.");for(var E=x,I=T;0>=I.l(k);)E=Q(E),I=Q(I);var O=ee(E,1),D=ee(I,1);for(I=ee(I,2),E=ee(E,2);!w(I);){var F=D.add(I);0>=F.l(k)&&(O=O.add(E),D=F),I=ee(I,1),E=ee(E,1)}return T=z(k,O.j(T)),new P(O,T)}for(O=_;0<=k.l(T);){for(E=Math.max(1,Math.floor(k.m()/T.m())),I=Math.ceil(Math.log(E)/Math.LN2),I=48>=I?1:Math.pow(2,I-48),D=d(E),F=D.j(T);S(F)||0<F.l(k);)E-=I,D=d(E),F=D.j(T);w(D)&&(D=x),O=O.add(D),k=z(k,F)}return new P(O,k)}t.A=function(k){return re(this,k).h},t.and=function(k){for(var T=Math.max(this.g.length,k.g.length),E=[],I=0;I<T;I++)E[I]=this.i(I)&k.i(I);return new c(E,this.h&k.h)},t.or=function(k){for(var T=Math.max(this.g.length,k.g.length),E=[],I=0;I<T;I++)E[I]=this.i(I)|k.i(I);return new c(E,this.h|k.h)},t.xor=function(k){for(var T=Math.max(this.g.length,k.g.length),E=[],I=0;I<T;I++)E[I]=this.i(I)^k.i(I);return new c(E,this.h^k.h)};function Q(k){for(var T=k.g.length+1,E=[],I=0;I<T;I++)E[I]=k.i(I)<<1|k.i(I-1)>>>31;return new c(E,k.h)}function ee(k,T){var E=T>>5;T%=32;for(var I=k.g.length-E,O=[],D=0;D<I;D++)O[D]=0<T?k.i(D+E)>>>T|k.i(D+E+1)<<32-T:k.i(D+E);return new c(O,k.h)}n.prototype.digest=n.prototype.v,n.prototype.reset=n.prototype.s,n.prototype.update=n.prototype.u,yA=n,c.prototype.add=c.prototype.add,c.prototype.multiply=c.prototype.j,c.prototype.modulo=c.prototype.A,c.prototype.compare=c.prototype.l,c.prototype.toNumber=c.prototype.m,c.prototype.toString=c.prototype.toString,c.prototype.getBits=c.prototype.i,c.fromNumber=d,c.fromString=g,Ns=c}).apply(typeof vE<"u"?vE:typeof self<"u"?self:typeof window<"u"?window:{});var Yh=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var EA,Su,TA,m0,mg,AA,wA,SA;(function(){var t,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(p,y,R){return p==Array.prototype||p==Object.prototype||(p[y]=R.value),p};function r(p){p=[typeof globalThis=="object"&&globalThis,p,typeof window=="object"&&window,typeof self=="object"&&self,typeof Yh=="object"&&Yh];for(var y=0;y<p.length;++y){var R=p[y];if(R&&R.Math==Math)return R}throw Error("Cannot find global object")}var n=r(this);function i(p,y){if(y)e:{var R=n;p=p.split(".");for(var V=0;V<p.length-1;V++){var fe=p[V];if(!(fe in R))break e;R=R[fe]}p=p[p.length-1],V=R[p],y=y(V),y!=V&&y!=null&&e(R,p,{configurable:!0,writable:!0,value:y})}}function o(p,y){p instanceof String&&(p+="");var R=0,V=!1,fe={next:function(){if(!V&&R<p.length){var ye=R++;return{value:y(ye,p[ye]),done:!1}}return V=!0,{done:!0,value:void 0}}};return fe[Symbol.iterator]=function(){return fe},fe}i("Array.prototype.values",function(p){return p||function(){return o(this,function(y,R){return R})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var c=c||{},u=this||self;function h(p){var y=typeof p;return y=y!="object"?y:p?Array.isArray(p)?"array":y:"null",y=="array"||y=="object"&&typeof p.length=="number"}function d(p){var y=typeof p;return y=="object"&&p!=null||y=="function"}function g(p,y,R){return p.call.apply(p.bind,arguments)}function _(p,y,R){if(!p)throw Error();if(2<arguments.length){var V=Array.prototype.slice.call(arguments,2);return function(){var fe=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(fe,V),p.apply(y,fe)}}return function(){return p.apply(y,arguments)}}function x(p,y,R){return x=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?g:_,x.apply(null,arguments)}function A(p,y){var R=Array.prototype.slice.call(arguments,1);return function(){var V=R.slice();return V.push.apply(V,arguments),p.apply(this,V)}}function w(p,y){function R(){}R.prototype=y.prototype,p.aa=y.prototype,p.prototype=new R,p.prototype.constructor=p,p.Qb=function(V,fe,ye){for(var Ve=Array(arguments.length-2),Rt=2;Rt<arguments.length;Rt++)Ve[Rt-2]=arguments[Rt];return y.prototype[fe].apply(V,Ve)}}function S(p){const y=p.length;if(0<y){const R=Array(y);for(let V=0;V<y;V++)R[V]=p[V];return R}return[]}function C(p,y){for(let R=1;R<arguments.length;R++){const V=arguments[R];if(h(V)){const fe=p.length||0,ye=V.length||0;p.length=fe+ye;for(let Ve=0;Ve<ye;Ve++)p[fe+Ve]=V[Ve]}else p.push(V)}}class z{constructor(y,R){this.i=y,this.j=R,this.h=0,this.g=null}get(){let y;return 0<this.h?(this.h--,y=this.g,this.g=y.next,y.next=null):y=this.i(),y}}function W(p){return/^[\s\xa0]*$/.test(p)}function P(){var p=u.navigator;return p&&(p=p.userAgent)?p:""}function re(p){return re[" "](p),p}re[" "]=function(){};var Q=P().indexOf("Gecko")!=-1&&!(P().toLowerCase().indexOf("webkit")!=-1&&P().indexOf("Edge")==-1)&&!(P().indexOf("Trident")!=-1||P().indexOf("MSIE")!=-1)&&P().indexOf("Edge")==-1;function ee(p,y,R){for(const V in p)y.call(R,p[V],V,p)}function k(p,y){for(const R in p)y.call(void 0,p[R],R,p)}function T(p){const y={};for(const R in p)y[R]=p[R];return y}const E="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function I(p,y){let R,V;for(let fe=1;fe<arguments.length;fe++){V=arguments[fe];for(R in V)p[R]=V[R];for(let ye=0;ye<E.length;ye++)R=E[ye],Object.prototype.hasOwnProperty.call(V,R)&&(p[R]=V[R])}}function O(p){var y=1;p=p.split(":");const R=[];for(;0<y&&p.length;)R.push(p.shift()),y--;return p.length&&R.push(p.join(":")),R}function D(p){u.setTimeout(()=>{throw p},0)}function F(){var p=te;let y=null;return p.g&&(y=p.g,p.g=p.g.next,p.g||(p.h=null),y.next=null),y}class Fe{constructor(){this.h=this.g=null}add(y,R){const V=Ce.get();V.set(y,R),this.h?this.h.next=V:this.g=V,this.h=V}}var Ce=new z(()=>new ne,p=>p.reset());class ne{constructor(){this.next=this.g=this.h=null}set(y,R){this.h=y,this.g=R,this.next=null}reset(){this.next=this.g=this.h=null}}let oe,be=!1,te=new Fe,G=()=>{const p=u.Promise.resolve(void 0);oe=()=>{p.then(se)}};var se=()=>{for(var p;p=F();){try{p.h.call(p.g)}catch(R){D(R)}var y=Ce;y.j(p),100>y.h&&(y.h++,p.next=y.g,y.g=p)}be=!1};function M(){this.s=this.s,this.C=this.C}M.prototype.s=!1,M.prototype.ma=function(){this.s||(this.s=!0,this.N())},M.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function j(p,y){this.type=p,this.g=this.target=y,this.defaultPrevented=!1}j.prototype.h=function(){this.defaultPrevented=!0};var Y=function(){if(!u.addEventListener||!Object.defineProperty)return!1;var p=!1,y=Object.defineProperty({},"passive",{get:function(){p=!0}});try{const R=()=>{};u.addEventListener("test",R,y),u.removeEventListener("test",R,y)}catch{}return p}();function Z(p,y){if(j.call(this,p?p.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,p){var R=this.type=p.type,V=p.changedTouches&&p.changedTouches.length?p.changedTouches[0]:null;if(this.target=p.target||p.srcElement,this.g=y,y=p.relatedTarget){if(Q){e:{try{re(y.nodeName);var fe=!0;break e}catch{}fe=!1}fe||(y=null)}}else R=="mouseover"?y=p.fromElement:R=="mouseout"&&(y=p.toElement);this.relatedTarget=y,V?(this.clientX=V.clientX!==void 0?V.clientX:V.pageX,this.clientY=V.clientY!==void 0?V.clientY:V.pageY,this.screenX=V.screenX||0,this.screenY=V.screenY||0):(this.clientX=p.clientX!==void 0?p.clientX:p.pageX,this.clientY=p.clientY!==void 0?p.clientY:p.pageY,this.screenX=p.screenX||0,this.screenY=p.screenY||0),this.button=p.button,this.key=p.key||"",this.ctrlKey=p.ctrlKey,this.altKey=p.altKey,this.shiftKey=p.shiftKey,this.metaKey=p.metaKey,this.pointerId=p.pointerId||0,this.pointerType=typeof p.pointerType=="string"?p.pointerType:ue[p.pointerType]||"",this.state=p.state,this.i=p,p.defaultPrevented&&Z.aa.h.call(this)}}w(Z,j);var ue={2:"touch",3:"pen",4:"mouse"};Z.prototype.h=function(){Z.aa.h.call(this);var p=this.i;p.preventDefault?p.preventDefault():p.returnValue=!1};var Ie="closure_listenable_"+(1e6*Math.random()|0),Ee=0;function we(p,y,R,V,fe){this.listener=p,this.proxy=null,this.src=y,this.type=R,this.capture=!!V,this.ha=fe,this.key=++Ee,this.da=this.fa=!1}function Te(p){p.da=!0,p.listener=null,p.proxy=null,p.src=null,p.ha=null}function Ue(p){this.src=p,this.g={},this.h=0}Ue.prototype.add=function(p,y,R,V,fe){var ye=p.toString();p=this.g[ye],p||(p=this.g[ye]=[],this.h++);var Ve=nt(p,y,V,fe);return-1<Ve?(y=p[Ve],R||(y.fa=!1)):(y=new we(y,this.src,ye,!!V,fe),y.fa=R,p.push(y)),y};function K(p,y){var R=y.type;if(R in p.g){var V=p.g[R],fe=Array.prototype.indexOf.call(V,y,void 0),ye;(ye=0<=fe)&&Array.prototype.splice.call(V,fe,1),ye&&(Te(y),p.g[R].length==0&&(delete p.g[R],p.h--))}}function nt(p,y,R,V){for(var fe=0;fe<p.length;++fe){var ye=p[fe];if(!ye.da&&ye.listener==y&&ye.capture==!!R&&ye.ha==V)return fe}return-1}var Ge="closure_lm_"+(1e6*Math.random()|0),Ke={};function Be(p,y,R,V,fe){if(Array.isArray(y)){for(var ye=0;ye<y.length;ye++)Be(p,y[ye],R,V,fe);return null}return R=er(R),p&&p[Ie]?p.K(y,R,d(V)?!!V.capture:!1,fe):Ne(p,y,R,!1,V,fe)}function Ne(p,y,R,V,fe,ye){if(!y)throw Error("Invalid event type");var Ve=d(fe)?!!fe.capture:!!fe,Rt=fr(p);if(Rt||(p[Ge]=Rt=new Ue(p)),R=Rt.add(y,R,V,Ve,ye),R.proxy)return R;if(V=Ye(),R.proxy=V,V.src=p,V.listener=R,p.addEventListener)Y||(fe=Ve),fe===void 0&&(fe=!1),p.addEventListener(y.toString(),V,fe);else if(p.attachEvent)p.attachEvent(rr(y.toString()),V);else if(p.addListener&&p.removeListener)p.addListener(V);else throw Error("addEventListener and attachEvent are unavailable.");return R}function Ye(){function p(R){return y.call(p.src,p.listener,R)}const y=_r;return p}function ut(p,y,R,V,fe){if(Array.isArray(y))for(var ye=0;ye<y.length;ye++)ut(p,y[ye],R,V,fe);else V=d(V)?!!V.capture:!!V,R=er(R),p&&p[Ie]?(p=p.i,y=String(y).toString(),y in p.g&&(ye=p.g[y],R=nt(ye,R,V,fe),-1<R&&(Te(ye[R]),Array.prototype.splice.call(ye,R,1),ye.length==0&&(delete p.g[y],p.h--)))):p&&(p=fr(p))&&(y=p.g[y.toString()],p=-1,y&&(p=nt(y,R,V,fe)),(R=-1<p?y[p]:null)&&_t(R))}function _t(p){if(typeof p!="number"&&p&&!p.da){var y=p.src;if(y&&y[Ie])K(y.i,p);else{var R=p.type,V=p.proxy;y.removeEventListener?y.removeEventListener(R,V,p.capture):y.detachEvent?y.detachEvent(rr(R),V):y.addListener&&y.removeListener&&y.removeListener(V),(R=fr(y))?(K(R,p),R.h==0&&(R.src=null,y[Ge]=null)):Te(p)}}}function rr(p){return p in Ke?Ke[p]:Ke[p]="on"+p}function _r(p,y){if(p.da)p=!0;else{y=new Z(y,this);var R=p.listener,V=p.ha||p.src;p.fa&&_t(p),p=R.call(V,y)}return p}function fr(p){return p=p[Ge],p instanceof Ue?p:null}var Et="__closure_events_fn_"+(1e9*Math.random()>>>0);function er(p){return typeof p=="function"?p:(p[Et]||(p[Et]=function(y){return p.handleEvent(y)}),p[Et])}function Ze(){M.call(this),this.i=new Ue(this),this.M=this,this.F=null}w(Ze,M),Ze.prototype[Ie]=!0,Ze.prototype.removeEventListener=function(p,y,R,V){ut(this,p,y,R,V)};function Je(p,y){var R,V=p.F;if(V)for(R=[];V;V=V.F)R.push(V);if(p=p.M,V=y.type||y,typeof y=="string")y=new j(y,p);else if(y instanceof j)y.target=y.target||p;else{var fe=y;y=new j(V,p),I(y,fe)}if(fe=!0,R)for(var ye=R.length-1;0<=ye;ye--){var Ve=y.g=R[ye];fe=dt(Ve,V,!0,y)&&fe}if(Ve=y.g=p,fe=dt(Ve,V,!0,y)&&fe,fe=dt(Ve,V,!1,y)&&fe,R)for(ye=0;ye<R.length;ye++)Ve=y.g=R[ye],fe=dt(Ve,V,!1,y)&&fe}Ze.prototype.N=function(){if(Ze.aa.N.call(this),this.i){var p=this.i,y;for(y in p.g){for(var R=p.g[y],V=0;V<R.length;V++)Te(R[V]);delete p.g[y],p.h--}}this.F=null},Ze.prototype.K=function(p,y,R,V){return this.i.add(String(p),y,!1,R,V)},Ze.prototype.L=function(p,y,R,V){return this.i.add(String(p),y,!0,R,V)};function dt(p,y,R,V){if(y=p.i.g[String(y)],!y)return!0;y=y.concat();for(var fe=!0,ye=0;ye<y.length;++ye){var Ve=y[ye];if(Ve&&!Ve.da&&Ve.capture==R){var Rt=Ve.listener,kr=Ve.ha||Ve.src;Ve.fa&&K(p.i,Ve),fe=Rt.call(kr,V)!==!1&&fe}}return fe&&!V.defaultPrevented}function Lt(p,y,R){if(typeof p=="function")R&&(p=x(p,R));else if(p&&typeof p.handleEvent=="function")p=x(p.handleEvent,p);else throw Error("Invalid listener argument");return 2147483647<Number(y)?-1:u.setTimeout(p,y||0)}function ot(p){p.g=Lt(()=>{p.g=null,p.i&&(p.i=!1,ot(p))},p.l);const y=p.h;p.h=null,p.m.apply(null,y)}class Ft extends M{constructor(y,R){super(),this.m=y,this.l=R,this.h=null,this.i=!1,this.g=null}j(y){this.h=arguments,this.g?this.i=!0:ot(this)}N(){super.N(),this.g&&(u.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Vt(p){M.call(this),this.h=p,this.g={}}w(Vt,M);var Ot=[];function Lr(p){ee(p.g,function(y,R){this.g.hasOwnProperty(R)&&_t(y)},p),p.g={}}Vt.prototype.N=function(){Vt.aa.N.call(this),Lr(this)},Vt.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Cn=u.JSON.stringify,Hi=u.JSON.parse,li=class{stringify(p){return u.JSON.stringify(p,void 0)}parse(p){return u.JSON.parse(p,void 0)}};function Gi(){}Gi.prototype.h=null;function qi(p){return p.h||(p.h=p.i())}function Ki(){}var _a={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function xa(){j.call(this,"d")}w(xa,j);function Na(){j.call(this,"c")}w(Na,j);var $n={},Zs=null;function Fa(){return Zs=Zs||new Ze}$n.La="serverreachability";function Xi(p){j.call(this,$n.La,p)}w(Xi,j);function Pa(p){const y=Fa();Je(y,new Xi(y))}$n.STAT_EVENT="statevent";function nl(p,y){j.call(this,$n.STAT_EVENT,p),this.stat=y}w(nl,j);function Qt(p){const y=Fa();Je(y,new nl(y,p))}$n.Ma="timingevent";function hr(p,y){j.call(this,$n.Ma,p),this.size=y}w(hr,j);function nr(p,y){if(typeof p!="function")throw Error("Fn must not be null and must be a function");return u.setTimeout(function(){p()},y)}function Rn(){this.g=!0}Rn.prototype.xa=function(){this.g=!1};function Js(p,y,R,V,fe,ye){p.info(function(){if(p.g)if(ye)for(var Ve="",Rt=ye.split("&"),kr=0;kr<Rt.length;kr++){var kt=Rt[kr].split("=");if(1<kt.length){var Ur=kt[0];kt=kt[1];var br=Ur.split("_");Ve=2<=br.length&&br[1]=="type"?Ve+(Ur+"="+kt+"&"):Ve+(Ur+"=redacted&")}}else Ve=null;else Ve=ye;return"XMLHTTP REQ ("+V+") [attempt "+fe+"]: "+y+`
`+R+`
`+Ve})}function Ac(p,y,R,V,fe,ye,Ve){p.info(function(){return"XMLHTTP RESP ("+V+") [ attempt "+fe+"]: "+y+`
`+R+`
`+ye+" "+Ve})}function N(p,y,R,V){p.info(function(){return"XMLHTTP TEXT ("+y+"): "+U(p,R)+(V?" "+V:"")})}function q(p,y){p.info(function(){return"TIMEOUT: "+y})}Rn.prototype.info=function(){};function U(p,y){if(!p.g)return y;if(!y)return null;try{var R=JSON.parse(y);if(R){for(p=0;p<R.length;p++)if(Array.isArray(R[p])){var V=R[p];if(!(2>V.length)){var fe=V[1];if(Array.isArray(fe)&&!(1>fe.length)){var ye=fe[0];if(ye!="noop"&&ye!="stop"&&ye!="close")for(var Ve=1;Ve<fe.length;Ve++)fe[Ve]=""}}}}return Cn(R)}catch{return y}}var B={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},H={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},X;function de(){}w(de,Gi),de.prototype.g=function(){return new XMLHttpRequest},de.prototype.i=function(){return{}},X=new de;function xe(p,y,R,V){this.j=p,this.i=y,this.l=R,this.R=V||1,this.U=new Vt(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new ce}function ce(){this.i=null,this.g="",this.h=!1}var me={},ge={};function Oe(p,y,R){p.L=1,p.v=ro(Mn(y)),p.m=R,p.P=!0,Le(p,null)}function Le(p,y){p.F=Date.now(),je(p),p.A=Mn(p.v);var R=p.A,V=p.R;Array.isArray(V)||(V=[String(V)]),kc(R.i,"t",V),p.C=0,R=p.j.J,p.h=new ce,p.g=Gf(p.j,R?y:null,!p.m),0<p.O&&(p.M=new Ft(x(p.Y,p,p.g),p.O)),y=p.U,R=p.g,V=p.ca;var fe="readystatechange";Array.isArray(fe)||(fe&&(Ot[0]=fe.toString()),fe=Ot);for(var ye=0;ye<fe.length;ye++){var Ve=Be(R,fe[ye],V||y.handleEvent,!1,y.h||y);if(!Ve)break;y.g[Ve.key]=Ve}y=p.H?T(p.H):{},p.m?(p.u||(p.u="POST"),y["Content-Type"]="application/x-www-form-urlencoded",p.g.ea(p.A,p.u,p.m,y)):(p.u="GET",p.g.ea(p.A,p.u,null,y)),Pa(),Js(p.i,p.u,p.A,p.l,p.R,p.m)}xe.prototype.ca=function(p){p=p.target;const y=this.M;y&&ea(p)==3?y.j():this.Y(p)},xe.prototype.Y=function(p){try{if(p==this.g)e:{const br=ea(this.g);var y=this.g.Ba();const mi=this.g.Z();if(!(3>br)&&(br!=3||this.g&&(this.h.h||this.g.oa()||Mf(this.g)))){this.J||br!=4||y==7||(y==8||0>=mi?Pa(3):Pa(2)),Pt(this);var R=this.g.Z();this.X=R;t:if(ze(this)){var V=Mf(this.g);p="";var fe=V.length,ye=ea(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){Ct(this),St(this);var Ve="";break t}this.h.i=new u.TextDecoder}for(y=0;y<fe;y++)this.h.h=!0,p+=this.h.i.decode(V[y],{stream:!(ye&&y==fe-1)});V.length=0,this.h.g+=p,this.C=0,Ve=this.h.g}else Ve=this.g.oa();if(this.o=R==200,Ac(this.i,this.u,this.A,this.l,this.R,br,R),this.o){if(this.T&&!this.K){t:{if(this.g){var Rt,kr=this.g;if((Rt=kr.g?kr.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!W(Rt)){var kt=Rt;break t}}kt=null}if(R=kt)N(this.i,this.l,R,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Pn(this,R);else{this.o=!1,this.s=3,Qt(12),Ct(this),St(this);break e}}if(this.P){R=!0;let Kr;for(;!this.J&&this.C<Ve.length;)if(Kr=Me(this,Ve),Kr==ge){br==4&&(this.s=4,Qt(14),R=!1),N(this.i,this.l,null,"[Incomplete Response]");break}else if(Kr==me){this.s=4,Qt(15),N(this.i,this.l,Ve,"[Invalid Chunk]"),R=!1;break}else N(this.i,this.l,Kr,null),Pn(this,Kr);if(ze(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),br!=4||Ve.length!=0||this.h.h||(this.s=1,Qt(16),R=!1),this.o=this.o&&R,!R)N(this.i,this.l,Ve,"[Invalid Chunked Response]"),Ct(this),St(this);else if(0<Ve.length&&!this.W){this.W=!0;var Ur=this.j;Ur.g==this&&Ur.ba&&!Ur.M&&(Ur.j.info("Great, no buffering proxy detected. Bytes received: "+Ve.length),uo(Ur),Ur.M=!0,Qt(11))}}else N(this.i,this.l,Ve,null),Pn(this,Ve);br==4&&Ct(this),this.o&&!this.J&&(br==4?jf(this.j,this):(this.o=!1,je(this)))}else Vd(this.g),R==400&&0<Ve.indexOf("Unknown SID")?(this.s=3,Qt(12)):(this.s=0,Qt(13)),Ct(this),St(this)}}}catch{}finally{}};function ze(p){return p.g?p.u=="GET"&&p.L!=2&&p.j.Ca:!1}function Me(p,y){var R=p.C,V=y.indexOf(`
`,R);return V==-1?ge:(R=Number(y.substring(R,V)),isNaN(R)?me:(V+=1,V+R>y.length?ge:(y=y.slice(V,V+R),p.C=V+R,y)))}xe.prototype.cancel=function(){this.J=!0,Ct(this)};function je(p){p.S=Date.now()+p.I,at(p,p.I)}function at(p,y){if(p.B!=null)throw Error("WatchDog timer not null");p.B=nr(x(p.ba,p),y)}function Pt(p){p.B&&(u.clearTimeout(p.B),p.B=null)}xe.prototype.ba=function(){this.B=null;const p=Date.now();0<=p-this.S?(q(this.i,this.A),this.L!=2&&(Pa(),Qt(17)),Ct(this),this.s=2,St(this)):at(this,this.S-p)};function St(p){p.j.G==0||p.J||jf(p.j,p)}function Ct(p){Pt(p);var y=p.M;y&&typeof y.ma=="function"&&y.ma(),p.M=null,Lr(p.U),p.g&&(y=p.g,p.g=null,y.abort(),y.ma())}function Pn(p,y){try{var R=p.j;if(R.G!=0&&(R.g==p||_n(R.h,p))){if(!p.K&&_n(R.h,p)&&R.G==3){try{var V=R.Da.g.parse(y)}catch{V=null}if(Array.isArray(V)&&V.length==3){var fe=V;if(fe[0]==0){e:if(!R.u){if(R.g)if(R.g.F+3e3<p.F)dl(R),fl(R);else break e;Nc(R),Qt(18)}}else R.za=fe[1],0<R.za-R.T&&37500>fe[2]&&R.F&&R.v==0&&!R.C&&(R.C=nr(x(R.Za,R),6e3));if(1>=La(R.h)&&R.ca){try{R.ca()}catch{}R.ca=void 0}}else pi(R,11)}else if((p.K||R.g==p)&&dl(R),!W(y))for(fe=R.Da.g.parse(y),y=0;y<fe.length;y++){let kt=fe[y];if(R.T=kt[0],kt=kt[1],R.G==2)if(kt[0]=="c"){R.K=kt[1],R.ia=kt[2];const Ur=kt[3];Ur!=null&&(R.la=Ur,R.j.info("VER="+R.la));const br=kt[4];br!=null&&(R.Aa=br,R.j.info("SVER="+R.Aa));const mi=kt[5];mi!=null&&typeof mi=="number"&&0<mi&&(V=1.5*mi,R.L=V,R.j.info("backChannelRequestTimeoutMs_="+V)),V=R;const Kr=p.g;if(Kr){const Ga=Kr.g?Kr.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Ga){var ye=V.h;ye.g||Ga.indexOf("spdy")==-1&&Ga.indexOf("quic")==-1&&Ga.indexOf("h2")==-1||(ye.j=ye.l,ye.g=new Set,ye.h&&(al(ye,ye.h),ye.h=null))}if(V.D){const Pc=Kr.g?Kr.g.getResponseHeader("X-HTTP-Session-Id"):null;Pc&&(V.ya=Pc,Kt(V.I,V.D,Pc))}}R.G=3,R.l&&R.l.ua(),R.ba&&(R.R=Date.now()-p.F,R.j.info("Handshake RTT: "+R.R+"ms")),V=R;var Ve=p;if(V.qa=Hf(V,V.J?V.ia:null,V.W),Ve.K){xn(V.h,Ve);var Rt=Ve,kr=V.L;kr&&(Rt.I=kr),Rt.B&&(Pt(Rt),je(Rt)),V.g=Ve}else Uf(V);0<R.i.length&&hl(R)}else kt[0]!="stop"&&kt[0]!="close"||pi(R,7);else R.G==3&&(kt[0]=="stop"||kt[0]=="close"?kt[0]=="stop"?pi(R,7):Dc(R):kt[0]!="noop"&&R.l&&R.l.ta(kt),R.v=0)}}Pa(4)}catch{}}var Ma=class{constructor(p,y){this.g=p,this.map=y}};function vn(p){this.l=p||10,u.PerformanceNavigationTiming?(p=u.performance.getEntriesByType("navigation"),p=0<p.length&&(p[0].nextHopProtocol=="hq"||p[0].nextHopProtocol=="h2")):p=!!(u.chrome&&u.chrome.loadTimes&&u.chrome.loadTimes()&&u.chrome.loadTimes().wasFetchedViaSpdy),this.j=p?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function kn(p){return p.h?!0:p.g?p.g.size>=p.j:!1}function La(p){return p.h?1:p.g?p.g.size:0}function _n(p,y){return p.h?p.h==y:p.g?p.g.has(y):!1}function al(p,y){p.g?p.g.add(y):p.h=y}function xn(p,y){p.h&&p.h==y?p.h=null:p.g&&p.g.has(y)&&p.g.delete(y)}vn.prototype.cancel=function(){if(this.i=wc(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const p of this.g.values())p.cancel();this.g.clear()}};function wc(p){if(p.h!=null)return p.i.concat(p.h.D);if(p.g!=null&&p.g.size!==0){let y=p.i;for(const R of p.g.values())y=y.concat(R.D);return y}return S(p.i)}function Fd(p){if(p.V&&typeof p.V=="function")return p.V();if(typeof Map<"u"&&p instanceof Map||typeof Set<"u"&&p instanceof Set)return Array.from(p.values());if(typeof p=="string")return p.split("");if(h(p)){for(var y=[],R=p.length,V=0;V<R;V++)y.push(p[V]);return y}y=[],R=0;for(V in p)y[R++]=p[V];return y}function il(p){if(p.na&&typeof p.na=="function")return p.na();if(!p.V||typeof p.V!="function"){if(typeof Map<"u"&&p instanceof Map)return Array.from(p.keys());if(!(typeof Set<"u"&&p instanceof Set)){if(h(p)||typeof p=="string"){var y=[];p=p.length;for(var R=0;R<p;R++)y.push(R);return y}y=[],R=0;for(const V in p)y[R++]=V;return y}}}function Sc(p,y){if(p.forEach&&typeof p.forEach=="function")p.forEach(y,void 0);else if(h(p)||typeof p=="string")Array.prototype.forEach.call(p,y,void 0);else for(var R=il(p),V=Fd(p),fe=V.length,ye=0;ye<fe;ye++)y.call(void 0,V[ye],R&&R[ye],p)}var eo=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Pd(p,y){if(p){p=p.split("&");for(var R=0;R<p.length;R++){var V=p[R].indexOf("="),fe=null;if(0<=V){var ye=p[R].substring(0,V);fe=p[R].substring(V+1)}else ye=p[R];y(ye,fe?decodeURIComponent(fe.replace(/\+/g," ")):"")}}}function xr(p){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,p instanceof xr){this.h=p.h,to(this,p.j),this.o=p.o,this.g=p.g,Wi(this,p.s),this.l=p.l;var y=p.i,R=new ui;R.i=y.i,y.g&&(R.g=new Map(y.g),R.h=y.h),ci(this,R),this.m=p.m}else p&&(y=String(p).match(eo))?(this.h=!1,to(this,y[1]||"",!0),this.o=Qn(y[2]||""),this.g=Qn(y[3]||"",!0),Wi(this,y[4]),this.l=Qn(y[5]||"",!0),ci(this,y[6]||"",!0),this.m=Qn(y[7]||"")):(this.h=!1,this.i=new ui(null,this.h))}xr.prototype.toString=function(){var p=[],y=this.j;y&&p.push(no(y,Cc,!0),":");var R=this.g;return(R||y=="file")&&(p.push("//"),(y=this.o)&&p.push(no(y,Cc,!0),"@"),p.push(encodeURIComponent(String(R)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),R=this.s,R!=null&&p.push(":",String(R))),(R=this.l)&&(this.g&&R.charAt(0)!="/"&&p.push("/"),p.push(no(R,R.charAt(0)=="/"?Md:Rc,!0))),(R=this.i.toString())&&p.push("?",R),(R=this.m)&&p.push("#",no(R,sl)),p.join("")};function Mn(p){return new xr(p)}function to(p,y,R){p.j=R?Qn(y,!0):y,p.j&&(p.j=p.j.replace(/:$/,""))}function Wi(p,y){if(y){if(y=Number(y),isNaN(y)||0>y)throw Error("Bad port number "+y);p.s=y}else p.s=null}function ci(p,y,R){y instanceof ui?(p.i=y,Ff(p.i,p.h)):(R||(y=no(y,Ld)),p.i=new ui(y,p.h))}function Kt(p,y,R){p.i.set(y,R)}function ro(p){return Kt(p,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),p}function Qn(p,y){return p?y?decodeURI(p.replace(/%25/g,"%2525")):decodeURIComponent(p):""}function no(p,y,R){return typeof p=="string"?(p=encodeURI(p).replace(y,Nf),R&&(p=p.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),p):null}function Nf(p){return p=p.charCodeAt(0),"%"+(p>>4&15).toString(16)+(p&15).toString(16)}var Cc=/[#\/\?@]/g,Rc=/[#\?:]/g,Md=/[#\?]/g,Ld=/[#\?@]/g,sl=/#/g;function ui(p,y){this.h=this.g=null,this.i=p||null,this.j=!!y}function Zn(p){p.g||(p.g=new Map,p.h=0,p.i&&Pd(p.i,function(y,R){p.add(decodeURIComponent(y.replace(/\+/g," ")),R)}))}t=ui.prototype,t.add=function(p,y){Zn(this),this.i=null,p=Va(this,p);var R=this.g.get(p);return R||this.g.set(p,R=[]),R.push(y),this.h+=1,this};function fi(p,y){Zn(p),y=Va(p,y),p.g.has(y)&&(p.i=null,p.h-=p.g.get(y).length,p.g.delete(y))}function hi(p,y){return Zn(p),y=Va(p,y),p.g.has(y)}t.forEach=function(p,y){Zn(this),this.g.forEach(function(R,V){R.forEach(function(fe){p.call(y,fe,V,this)},this)},this)},t.na=function(){Zn(this);const p=Array.from(this.g.values()),y=Array.from(this.g.keys()),R=[];for(let V=0;V<y.length;V++){const fe=p[V];for(let ye=0;ye<fe.length;ye++)R.push(y[V])}return R},t.V=function(p){Zn(this);let y=[];if(typeof p=="string")hi(this,p)&&(y=y.concat(this.g.get(Va(this,p))));else{p=Array.from(this.g.values());for(let R=0;R<p.length;R++)y=y.concat(p[R])}return y},t.set=function(p,y){return Zn(this),this.i=null,p=Va(this,p),hi(this,p)&&(this.h-=this.g.get(p).length),this.g.set(p,[y]),this.h+=1,this},t.get=function(p,y){return p?(p=this.V(p),0<p.length?String(p[0]):y):y};function kc(p,y,R){fi(p,y),0<R.length&&(p.i=null,p.g.set(Va(p,y),S(R)),p.h+=R.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const p=[],y=Array.from(this.g.keys());for(var R=0;R<y.length;R++){var V=y[R];const ye=encodeURIComponent(String(V)),Ve=this.V(V);for(V=0;V<Ve.length;V++){var fe=ye;Ve[V]!==""&&(fe+="="+encodeURIComponent(String(Ve[V]))),p.push(fe)}}return this.i=p.join("&")};function Va(p,y){return y=String(y),p.j&&(y=y.toLowerCase()),y}function Ff(p,y){y&&!p.j&&(Zn(p),p.i=null,p.g.forEach(function(R,V){var fe=V.toLowerCase();V!=fe&&(fi(this,V),kc(this,fe,R))},p)),p.j=y}function ao(p,y){const R=new Rn;if(u.Image){const V=new Image;V.onload=A(Jn,R,"TestLoadImage: loaded",!0,y,V),V.onerror=A(Jn,R,"TestLoadImage: error",!1,y,V),V.onabort=A(Jn,R,"TestLoadImage: abort",!1,y,V),V.ontimeout=A(Jn,R,"TestLoadImage: timeout",!1,y,V),u.setTimeout(function(){V.ontimeout&&V.ontimeout()},1e4),V.src=p}else y(!1)}function ya(p,y){const R=new Rn,V=new AbortController,fe=setTimeout(()=>{V.abort(),Jn(R,"TestPingServer: timeout",!1,y)},1e4);fetch(p,{signal:V.signal}).then(ye=>{clearTimeout(fe),ye.ok?Jn(R,"TestPingServer: ok",!0,y):Jn(R,"TestPingServer: server error",!1,y)}).catch(()=>{clearTimeout(fe),Jn(R,"TestPingServer: error",!1,y)})}function Jn(p,y,R,V,fe){try{fe&&(fe.onload=null,fe.onerror=null,fe.onabort=null,fe.ontimeout=null),V(R)}catch{}}function io(){this.g=new li}function Ua(p,y,R){const V=R||"";try{Sc(p,function(fe,ye){let Ve=fe;d(fe)&&(Ve=Cn(fe)),y.push(V+ye+"="+encodeURIComponent(Ve))})}catch(fe){throw y.push(V+"type="+encodeURIComponent("_badmap")),fe}}function Yi(p){this.l=p.Ub||null,this.j=p.eb||!1}w(Yi,Gi),Yi.prototype.g=function(){return new di(this.l,this.j)},Yi.prototype.i=function(p){return function(){return p}}({});function di(p,y){Ze.call(this),this.D=p,this.o=y,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}w(di,Ze),t=di.prototype,t.open=function(p,y){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=p,this.A=y,this.readyState=1,ja(this)},t.send=function(p){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const y={headers:this.u,method:this.B,credentials:this.m,cache:void 0};p&&(y.body=p),(this.D||u).fetch(new Request(this.A,y)).then(this.Sa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Ba(this)),this.readyState=0},t.Sa=function(p){if(this.g&&(this.l=p,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=p.headers,this.readyState=2,ja(this)),this.g&&(this.readyState=3,ja(this),this.g)))if(this.responseType==="arraybuffer")p.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof u.ReadableStream<"u"&&"body"in p){if(this.j=p.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;bc(this)}else p.text().then(this.Ra.bind(this),this.ga.bind(this))};function bc(p){p.j.read().then(p.Pa.bind(p)).catch(p.ga.bind(p))}t.Pa=function(p){if(this.g){if(this.o&&p.value)this.response.push(p.value);else if(!this.o){var y=p.value?p.value:new Uint8Array(0);(y=this.v.decode(y,{stream:!p.done}))&&(this.response=this.responseText+=y)}p.done?Ba(this):ja(this),this.readyState==3&&bc(this)}},t.Ra=function(p){this.g&&(this.response=this.responseText=p,Ba(this))},t.Qa=function(p){this.g&&(this.response=p,Ba(this))},t.ga=function(){this.g&&Ba(this)};function Ba(p){p.readyState=4,p.l=null,p.j=null,p.v=null,ja(p)}t.setRequestHeader=function(p,y){this.u.append(p,y)},t.getResponseHeader=function(p){return this.h&&this.h.get(p.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const p=[],y=this.h.entries();for(var R=y.next();!R.done;)R=R.value,p.push(R[0]+": "+R[1]),R=y.next();return p.join(`\r
`)};function ja(p){p.onreadystatechange&&p.onreadystatechange.call(p)}Object.defineProperty(di.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(p){this.m=p?"include":"same-origin"}});function Ic(p){let y="";return ee(p,function(R,V){y+=V,y+=":",y+=R,y+=`\r
`}),y}function Vr(p,y,R){e:{for(V in R){var V=!1;break e}V=!0}V||(R=Ic(R),typeof p=="string"?R!=null&&encodeURIComponent(String(R)):Kt(p,y,R))}function Bt(p){Ze.call(this),this.headers=new Map,this.o=p||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}w(Bt,Ze);var ol=/^https?$/i,so=["POST","PUT"];t=Bt.prototype,t.Ha=function(p){this.J=p},t.ea=function(p,y,R,V){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+p);y=y?y.toUpperCase():"GET",this.D=p,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():X.g(),this.v=this.o?qi(this.o):qi(X),this.g.onreadystatechange=x(this.Ea,this);try{this.B=!0,this.g.open(y,String(p),!0),this.B=!1}catch(ye){Pf(this,ye);return}if(p=R||"",R=new Map(this.headers),V)if(Object.getPrototypeOf(V)===Object.prototype)for(var fe in V)R.set(fe,V[fe]);else if(typeof V.keys=="function"&&typeof V.get=="function")for(const ye of V.keys())R.set(ye,V.get(ye));else throw Error("Unknown input type for opt_headers: "+String(V));V=Array.from(R.keys()).find(ye=>ye.toLowerCase()=="content-type"),fe=u.FormData&&p instanceof u.FormData,!(0<=Array.prototype.indexOf.call(so,y,void 0))||V||fe||R.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[ye,Ve]of R)this.g.setRequestHeader(ye,Ve);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{oo(this),this.u=!0,this.g.send(p),this.u=!1}catch(ye){Pf(this,ye)}};function Pf(p,y){p.h=!1,p.g&&(p.j=!0,p.g.abort(),p.j=!1),p.l=y,p.m=5,ll(p),za(p)}function ll(p){p.A||(p.A=!0,Je(p,"complete"),Je(p,"error"))}t.abort=function(p){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=p||7,Je(this,"complete"),Je(this,"abort"),za(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),za(this,!0)),Bt.aa.N.call(this)},t.Ea=function(){this.s||(this.B||this.u||this.j?cl(this):this.bb())},t.bb=function(){cl(this)};function cl(p){if(p.h&&typeof c<"u"&&(!p.v[1]||ea(p)!=4||p.Z()!=2)){if(p.u&&ea(p)==4)Lt(p.Ea,0,p);else if(Je(p,"readystatechange"),ea(p)==4){p.h=!1;try{const Ve=p.Z();e:switch(Ve){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var y=!0;break e;default:y=!1}var R;if(!(R=y)){var V;if(V=Ve===0){var fe=String(p.D).match(eo)[1]||null;!fe&&u.self&&u.self.location&&(fe=u.self.location.protocol.slice(0,-1)),V=!ol.test(fe?fe.toLowerCase():"")}R=V}if(R)Je(p,"complete"),Je(p,"success");else{p.m=6;try{var ye=2<ea(p)?p.g.statusText:""}catch{ye=""}p.l=ye+" ["+p.Z()+"]",ll(p)}}finally{za(p)}}}}function za(p,y){if(p.g){oo(p);const R=p.g,V=p.v[0]?()=>{}:null;p.g=null,p.v=null,y||Je(p,"ready");try{R.onreadystatechange=V}catch{}}}function oo(p){p.I&&(u.clearTimeout(p.I),p.I=null)}t.isActive=function(){return!!this.g};function ea(p){return p.g?p.g.readyState:0}t.Z=function(){try{return 2<ea(this)?this.g.status:-1}catch{return-1}},t.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.Oa=function(p){if(this.g){var y=this.g.responseText;return p&&y.indexOf(p)==0&&(y=y.substring(p.length)),Hi(y)}};function Mf(p){try{if(!p.g)return null;if("response"in p.g)return p.g.response;switch(p.H){case"":case"text":return p.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in p.g)return p.g.mozResponseArrayBuffer}return null}catch{return null}}function Vd(p){const y={};p=(p.g&&2<=ea(p)&&p.g.getAllResponseHeaders()||"").split(`\r
`);for(let V=0;V<p.length;V++){if(W(p[V]))continue;var R=O(p[V]);const fe=R[0];if(R=R[1],typeof R!="string")continue;R=R.trim();const ye=y[fe]||[];y[fe]=ye,ye.push(R)}k(y,function(V){return V.join(", ")})}t.Ba=function(){return this.m},t.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function lo(p,y,R){return R&&R.internalChannelParams&&R.internalChannelParams[p]||y}function ul(p){this.Aa=0,this.i=[],this.j=new Rn,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=lo("failFast",!1,p),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=lo("baseRetryDelayMs",5e3,p),this.cb=lo("retryDelaySeedMs",1e4,p),this.Wa=lo("forwardChannelMaxRetries",2,p),this.wa=lo("forwardChannelRequestTimeoutMs",2e4,p),this.pa=p&&p.xmlHttpFactory||void 0,this.Xa=p&&p.Tb||void 0,this.Ca=p&&p.useFetchStreams||!1,this.L=void 0,this.J=p&&p.supportsCrossDomainXhr||!1,this.K="",this.h=new vn(p&&p.concurrentRequestLimit),this.Da=new io,this.P=p&&p.fastHandshake||!1,this.O=p&&p.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=p&&p.Rb||!1,p&&p.xa&&this.j.xa(),p&&p.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&p&&p.detectBufferingProxy||!1,this.ja=void 0,p&&p.longPollingTimeout&&0<p.longPollingTimeout&&(this.ja=p.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}t=ul.prototype,t.la=8,t.G=1,t.connect=function(p,y,R,V){Qt(0),this.W=p,this.H=y||{},R&&V!==void 0&&(this.H.OSID=R,this.H.OAID=V),this.F=this.X,this.I=Hf(this,null,this.W),hl(this)};function Dc(p){if(Lf(p),p.G==3){var y=p.U++,R=Mn(p.I);if(Kt(R,"SID",p.K),Kt(R,"RID",y),Kt(R,"TYPE","terminate"),co(p,R),y=new xe(p,p.j,y),y.L=2,y.v=ro(Mn(R)),R=!1,u.navigator&&u.navigator.sendBeacon)try{R=u.navigator.sendBeacon(y.v.toString(),"")}catch{}!R&&u.Image&&(new Image().src=y.v,R=!0),R||(y.g=Gf(y.j,null),y.g.ea(y.v)),y.F=Date.now(),je(y)}zf(p)}function fl(p){p.g&&(uo(p),p.g.cancel(),p.g=null)}function Lf(p){fl(p),p.u&&(u.clearTimeout(p.u),p.u=null),dl(p),p.h.cancel(),p.s&&(typeof p.s=="number"&&u.clearTimeout(p.s),p.s=null)}function hl(p){if(!kn(p.h)&&!p.s){p.s=!0;var y=p.Ga;oe||G(),be||(oe(),be=!0),te.add(y,p),p.B=0}}function Ud(p,y){return La(p.h)>=p.h.j-(p.s?1:0)?!1:p.s?(p.i=y.D.concat(p.i),!0):p.G==1||p.G==2||p.B>=(p.Va?0:p.Wa)?!1:(p.s=nr(x(p.Ga,p,y),Fc(p,p.B)),p.B++,!0)}t.Ga=function(p){if(this.s)if(this.s=null,this.G==1){if(!p){this.U=Math.floor(1e5*Math.random()),p=this.U++;const fe=new xe(this,this.j,p);let ye=this.o;if(this.S&&(ye?(ye=T(ye),I(ye,this.S)):ye=this.S),this.m!==null||this.O||(fe.H=ye,ye=null),this.P)e:{for(var y=0,R=0;R<this.i.length;R++){t:{var V=this.i[R];if("__data__"in V.map&&(V=V.map.__data__,typeof V=="string")){V=V.length;break t}V=void 0}if(V===void 0)break;if(y+=V,4096<y){y=R;break e}if(y===4096||R===this.i.length-1){y=R+1;break e}}y=1e3}else y=1e3;y=Vf(this,fe,y),R=Mn(this.I),Kt(R,"RID",p),Kt(R,"CVER",22),this.D&&Kt(R,"X-HTTP-Session-Id",this.D),co(this,R),ye&&(this.O?y="headers="+encodeURIComponent(String(Ic(ye)))+"&"+y:this.m&&Vr(R,this.m,ye)),al(this.h,fe),this.Ua&&Kt(R,"TYPE","init"),this.P?(Kt(R,"$req",y),Kt(R,"SID","null"),fe.T=!0,Oe(fe,R,null)):Oe(fe,R,y),this.G=2}}else this.G==3&&(p?Oc(this,p):this.i.length==0||kn(this.h)||Oc(this))};function Oc(p,y){var R;y?R=y.l:R=p.U++;const V=Mn(p.I);Kt(V,"SID",p.K),Kt(V,"RID",R),Kt(V,"AID",p.T),co(p,V),p.m&&p.o&&Vr(V,p.m,p.o),R=new xe(p,p.j,R,p.B+1),p.m===null&&(R.H=p.o),y&&(p.i=y.D.concat(p.i)),y=Vf(p,R,1e3),R.I=Math.round(.5*p.wa)+Math.round(.5*p.wa*Math.random()),al(p.h,R),Oe(R,V,y)}function co(p,y){p.H&&ee(p.H,function(R,V){Kt(y,V,R)}),p.l&&Sc({},function(R,V){Kt(y,V,R)})}function Vf(p,y,R){R=Math.min(p.i.length,R);var V=p.l?x(p.l.Na,p.l,p):null;e:{var fe=p.i;let ye=-1;for(;;){const Ve=["count="+R];ye==-1?0<R?(ye=fe[0].g,Ve.push("ofs="+ye)):ye=0:Ve.push("ofs="+ye);let Rt=!0;for(let kr=0;kr<R;kr++){let kt=fe[kr].g;const Ur=fe[kr].map;if(kt-=ye,0>kt)ye=Math.max(0,fe[kr].g-100),Rt=!1;else try{Ua(Ur,Ve,"req"+kt+"_")}catch{V&&V(Ur)}}if(Rt){V=Ve.join("&");break e}}}return p=p.i.splice(0,R),y.D=p,V}function Uf(p){if(!p.g&&!p.u){p.Y=1;var y=p.Fa;oe||G(),be||(oe(),be=!0),te.add(y,p),p.v=0}}function Nc(p){return p.g||p.u||3<=p.v?!1:(p.Y++,p.u=nr(x(p.Fa,p),Fc(p,p.v)),p.v++,!0)}t.Fa=function(){if(this.u=null,Bf(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var p=2*this.R;this.j.info("BP detection timer enabled: "+p),this.A=nr(x(this.ab,this),p)}},t.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,Qt(10),fl(this),Bf(this))};function uo(p){p.A!=null&&(u.clearTimeout(p.A),p.A=null)}function Bf(p){p.g=new xe(p,p.j,"rpc",p.Y),p.m===null&&(p.g.H=p.o),p.g.O=0;var y=Mn(p.qa);Kt(y,"RID","rpc"),Kt(y,"SID",p.K),Kt(y,"AID",p.T),Kt(y,"CI",p.F?"0":"1"),!p.F&&p.ja&&Kt(y,"TO",p.ja),Kt(y,"TYPE","xmlhttp"),co(p,y),p.m&&p.o&&Vr(y,p.m,p.o),p.L&&(p.g.I=p.L);var R=p.g;p=p.ia,R.L=1,R.v=ro(Mn(y)),R.m=null,R.P=!0,Le(R,p)}t.Za=function(){this.C!=null&&(this.C=null,fl(this),Nc(this),Qt(19))};function dl(p){p.C!=null&&(u.clearTimeout(p.C),p.C=null)}function jf(p,y){var R=null;if(p.g==y){dl(p),uo(p),p.g=null;var V=2}else if(_n(p.h,y))R=y.D,xn(p.h,y),V=1;else return;if(p.G!=0){if(y.o)if(V==1){R=y.m?y.m.length:0,y=Date.now()-y.F;var fe=p.B;V=Fa(),Je(V,new hr(V,R)),hl(p)}else Uf(p);else if(fe=y.s,fe==3||fe==0&&0<y.X||!(V==1&&Ud(p,y)||V==2&&Nc(p)))switch(R&&0<R.length&&(y=p.h,y.i=y.i.concat(R)),fe){case 1:pi(p,5);break;case 4:pi(p,10);break;case 3:pi(p,6);break;default:pi(p,2)}}}function Fc(p,y){let R=p.Ta+Math.floor(Math.random()*p.cb);return p.isActive()||(R*=2),R*y}function pi(p,y){if(p.j.info("Error code "+y),y==2){var R=x(p.fb,p),V=p.Xa;const fe=!V;V=new xr(V||"//www.google.com/images/cleardot.gif"),u.location&&u.location.protocol=="http"||to(V,"https"),ro(V),fe?ao(V.toString(),R):ya(V.toString(),R)}else Qt(2);p.G=0,p.l&&p.l.sa(y),zf(p),Lf(p)}t.fb=function(p){p?(this.j.info("Successfully pinged google.com"),Qt(2)):(this.j.info("Failed to ping google.com"),Qt(1))};function zf(p){if(p.G=0,p.ka=[],p.l){const y=wc(p.h);(y.length!=0||p.i.length!=0)&&(C(p.ka,y),C(p.ka,p.i),p.h.i.length=0,S(p.i),p.i.length=0),p.l.ra()}}function Hf(p,y,R){var V=R instanceof xr?Mn(R):new xr(R);if(V.g!="")y&&(V.g=y+"."+V.g),Wi(V,V.s);else{var fe=u.location;V=fe.protocol,y=y?y+"."+fe.hostname:fe.hostname,fe=+fe.port;var ye=new xr(null);V&&to(ye,V),y&&(ye.g=y),fe&&Wi(ye,fe),R&&(ye.l=R),V=ye}return R=p.D,y=p.ya,R&&y&&Kt(V,R,y),Kt(V,"VER",p.la),co(p,V),V}function Gf(p,y,R){if(y&&!p.J)throw Error("Can't create secondary domain capable XhrIo object.");return y=p.Ca&&!p.pa?new Bt(new Yi({eb:R})):new Bt(p.pa),y.Ha(p.J),y}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function qf(){}t=qf.prototype,t.ua=function(){},t.ta=function(){},t.sa=function(){},t.ra=function(){},t.isActive=function(){return!0},t.Na=function(){};function pl(){}pl.prototype.g=function(p,y){return new yn(p,y)};function yn(p,y){Ze.call(this),this.g=new ul(y),this.l=p,this.h=y&&y.messageUrlParams||null,p=y&&y.messageHeaders||null,y&&y.clientProtocolHeaderRequired&&(p?p["X-Client-Protocol"]="webchannel":p={"X-Client-Protocol":"webchannel"}),this.g.o=p,p=y&&y.initMessageHeaders||null,y&&y.messageContentType&&(p?p["X-WebChannel-Content-Type"]=y.messageContentType:p={"X-WebChannel-Content-Type":y.messageContentType}),y&&y.va&&(p?p["X-WebChannel-Client-Profile"]=y.va:p={"X-WebChannel-Client-Profile":y.va}),this.g.S=p,(p=y&&y.Sb)&&!W(p)&&(this.g.m=p),this.v=y&&y.supportsCrossDomainXhr||!1,this.u=y&&y.sendRawJson||!1,(y=y&&y.httpSessionIdParam)&&!W(y)&&(this.g.D=y,p=this.h,p!==null&&y in p&&(p=this.h,y in p&&delete p[y])),this.j=new Ha(this)}w(yn,Ze),yn.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},yn.prototype.close=function(){Dc(this.g)},yn.prototype.o=function(p){var y=this.g;if(typeof p=="string"){var R={};R.__data__=p,p=R}else this.u&&(R={},R.__data__=Cn(p),p=R);y.i.push(new Ma(y.Ya++,p)),y.G==3&&hl(y)},yn.prototype.N=function(){this.g.l=null,delete this.j,Dc(this.g),delete this.g,yn.aa.N.call(this)};function Kf(p){xa.call(this),p.__headers__&&(this.headers=p.__headers__,this.statusCode=p.__status__,delete p.__headers__,delete p.__status__);var y=p.__sm__;if(y){e:{for(const R in y){p=R;break e}p=void 0}(this.i=p)&&(p=this.i,y=y!==null&&p in y?y[p]:void 0),this.data=y}else this.data=p}w(Kf,xa);function Xf(){Na.call(this),this.status=1}w(Xf,Na);function Ha(p){this.g=p}w(Ha,qf),Ha.prototype.ua=function(){Je(this.g,"a")},Ha.prototype.ta=function(p){Je(this.g,new Kf(p))},Ha.prototype.sa=function(p){Je(this.g,new Xf)},Ha.prototype.ra=function(){Je(this.g,"b")},pl.prototype.createWebChannel=pl.prototype.g,yn.prototype.send=yn.prototype.o,yn.prototype.open=yn.prototype.m,yn.prototype.close=yn.prototype.close,SA=function(){return new pl},wA=function(){return Fa()},AA=$n,mg={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},B.NO_ERROR=0,B.TIMEOUT=8,B.HTTP_ERROR=6,m0=B,H.COMPLETE="complete",TA=H,Ki.EventType=_a,_a.OPEN="a",_a.CLOSE="b",_a.ERROR="c",_a.MESSAGE="d",Ze.prototype.listen=Ze.prototype.K,Su=Ki,Bt.prototype.listenOnce=Bt.prototype.L,Bt.prototype.getLastError=Bt.prototype.Ka,Bt.prototype.getLastErrorCode=Bt.prototype.Ba,Bt.prototype.getStatus=Bt.prototype.Z,Bt.prototype.getResponseJson=Bt.prototype.Oa,Bt.prototype.getResponseText=Bt.prototype.oa,Bt.prototype.send=Bt.prototype.ea,Bt.prototype.setWithCredentials=Bt.prototype.Ha,EA=Bt}).apply(typeof Yh<"u"?Yh:typeof self<"u"?self:typeof window<"u"?window:{});const _E="@firebase/firestore",xE="4.8.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ln{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}ln.UNAUTHENTICATED=new ln(null),ln.GOOGLE_CREDENTIALS=new ln("google-credentials-uid"),ln.FIRST_PARTY=new ln("first-party-uid"),ln.MOCK_USER=new ln("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let _c="11.10.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Uo=new $g("@firebase/firestore");function ql(){return Uo.logLevel}function He(t,...e){if(Uo.logLevel<=Tt.DEBUG){const r=e.map(u1);Uo.debug(`Firestore (${_c}): ${t}`,...r)}}function Ui(t,...e){if(Uo.logLevel<=Tt.ERROR){const r=e.map(u1);Uo.error(`Firestore (${_c}): ${t}`,...r)}}function Ms(t,...e){if(Uo.logLevel<=Tt.WARN){const r=e.map(u1);Uo.warn(`Firestore (${_c}): ${t}`,...r)}}function u1(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(r){return JSON.stringify(r)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rt(t,e,r){let n="Unexpected state";typeof e=="string"?n=e:r=e,CA(t,n,r)}function CA(t,e,r){let n=`FIRESTORE (${_c}) INTERNAL ASSERTION FAILED: ${e} (ID: ${t.toString(16)})`;if(r!==void 0)try{n+=" CONTEXT: "+JSON.stringify(r)}catch{n+=" CONTEXT: "+r}throw Ui(n),new Error(n)}function jt(t,e,r,n){let i="Unexpected state";typeof r=="string"?i=r:n=r,t||CA(e,i,n)}function ct(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const De={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Xe extends ji{constructor(e,r){super(e,r),this.code=e,this.message=r,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ni{constructor(){this.promise=new Promise((e,r)=>{this.resolve=e,this.reject=r})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RA{constructor(e,r){this.user=r,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class gD{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,r){e.enqueueRetryable(()=>r(ln.UNAUTHENTICATED))}shutdown(){}}class vD{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,r){this.changeListener=r,e.enqueueRetryable(()=>r(this.token.user))}shutdown(){this.changeListener=null}}class _D{constructor(e){this.t=e,this.currentUser=ln.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,r){jt(this.o===void 0,42304);let n=this.i;const i=h=>this.i!==n?(n=this.i,r(h)):Promise.resolve();let o=new Ni;this.o=()=>{this.i++,this.currentUser=this.u(),o.resolve(),o=new Ni,e.enqueueRetryable(()=>i(this.currentUser))};const c=()=>{const h=o;e.enqueueRetryable(async()=>{await h.promise,await i(this.currentUser)})},u=h=>{He("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=h,this.o&&(this.auth.addAuthTokenListener(this.o),c())};this.t.onInit(h=>u(h)),setTimeout(()=>{if(!this.auth){const h=this.t.getImmediate({optional:!0});h?u(h):(He("FirebaseAuthCredentialsProvider","Auth not yet detected"),o.resolve(),o=new Ni)}},0),c()}getToken(){const e=this.i,r=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(r).then(n=>this.i!==e?(He("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):n?(jt(typeof n.accessToken=="string",31837,{l:n}),new RA(n.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return jt(e===null||typeof e=="string",2055,{h:e}),new ln(e)}}class xD{constructor(e,r,n){this.P=e,this.T=r,this.I=n,this.type="FirstParty",this.user=ln.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class yD{constructor(e,r,n){this.P=e,this.T=r,this.I=n}getToken(){return Promise.resolve(new xD(this.P,this.T,this.I))}start(e,r){e.enqueueRetryable(()=>r(ln.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class yE{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class ED{constructor(e,r){this.V=r,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,fa(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,r){jt(this.o===void 0,3512);const n=o=>{o.error!=null&&He("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${o.error.message}`);const c=o.token!==this.m;return this.m=o.token,He("FirebaseAppCheckTokenProvider",`Received ${c?"new":"existing"} token.`),c?r(o.token):Promise.resolve()};this.o=o=>{e.enqueueRetryable(()=>n(o))};const i=o=>{He("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=o,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(o=>i(o)),setTimeout(()=>{if(!this.appCheck){const o=this.V.getImmediate({optional:!0});o?i(o):He("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new yE(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(r=>r?(jt(typeof r.token=="string",44558,{tokenResult:r}),this.m=r.token,new yE(r.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function TD(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),r=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(r);else for(let n=0;n<t;n++)r[n]=Math.floor(256*Math.random());return r}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kA(){return new TextEncoder}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class f1{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",r=62*Math.floor(4.129032258064516);let n="";for(;n.length<20;){const i=TD(40);for(let o=0;o<i.length;++o)n.length<20&&i[o]<r&&(n+=e.charAt(i[o]%62))}return n}}function mt(t,e){return t<e?-1:t>e?1:0}function gg(t,e){let r=0;for(;r<t.length&&r<e.length;){const n=t.codePointAt(r),i=e.codePointAt(r);if(n!==i){if(n<128&&i<128)return mt(n,i);{const o=kA(),c=AD(o.encode(EE(t,r)),o.encode(EE(e,r)));return c!==0?c:mt(n,i)}}r+=n>65535?2:1}return mt(t.length,e.length)}function EE(t,e){return t.codePointAt(e)>65535?t.substring(e,e+2):t.substring(e,e+1)}function AD(t,e){for(let r=0;r<t.length&&r<e.length;++r)if(t[r]!==e[r])return mt(t[r],e[r]);return mt(t.length,e.length)}function oc(t,e,r){return t.length===e.length&&t.every((n,i)=>r(n,e[i]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const TE="__name__";class Za{constructor(e,r,n){r===void 0?r=0:r>e.length&&rt(637,{offset:r,range:e.length}),n===void 0?n=e.length-r:n>e.length-r&&rt(1746,{length:n,range:e.length-r}),this.segments=e,this.offset=r,this.len=n}get length(){return this.len}isEqual(e){return Za.comparator(this,e)===0}child(e){const r=this.segments.slice(this.offset,this.limit());return e instanceof Za?e.forEach(n=>{r.push(n)}):r.push(e),this.construct(r)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==e.get(r))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==e.get(r))return!1;return!0}forEach(e){for(let r=this.offset,n=this.limit();r<n;r++)e(this.segments[r])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,r){const n=Math.min(e.length,r.length);for(let i=0;i<n;i++){const o=Za.compareSegments(e.get(i),r.get(i));if(o!==0)return o}return mt(e.length,r.length)}static compareSegments(e,r){const n=Za.isNumericId(e),i=Za.isNumericId(r);return n&&!i?-1:!n&&i?1:n&&i?Za.extractNumericId(e).compare(Za.extractNumericId(r)):gg(e,r)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return Ns.fromString(e.substring(4,e.length-2))}}class tr extends Za{construct(e,r,n){return new tr(e,r,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const r=[];for(const n of e){if(n.indexOf("//")>=0)throw new Xe(De.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);r.push(...n.split("/").filter(i=>i.length>0))}return new tr(r)}static emptyPath(){return new tr([])}}const wD=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Zr extends Za{construct(e,r,n){return new Zr(e,r,n)}static isValidIdentifier(e){return wD.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Zr.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===TE}static keyField(){return new Zr([TE])}static fromServerFormat(e){const r=[];let n="",i=0;const o=()=>{if(n.length===0)throw new Xe(De.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);r.push(n),n=""};let c=!1;for(;i<e.length;){const u=e[i];if(u==="\\"){if(i+1===e.length)throw new Xe(De.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const h=e[i+1];if(h!=="\\"&&h!=="."&&h!=="`")throw new Xe(De.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=h,i+=2}else u==="`"?(c=!c,i++):u!=="."||c?(n+=u,i++):(o(),i++)}if(o(),c)throw new Xe(De.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Zr(r)}static emptyPath(){return new Zr([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $e{constructor(e){this.path=e}static fromPath(e){return new $e(tr.fromString(e))}static fromName(e){return new $e(tr.fromString(e).popFirst(5))}static empty(){return new $e(tr.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&tr.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,r){return tr.comparator(e.path,r.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new $e(new tr(e.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bA(t,e,r){if(!r)throw new Xe(De.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function SD(t,e,r,n){if(e===!0&&n===!0)throw new Xe(De.INVALID_ARGUMENT,`${t} and ${r} cannot be used together.`)}function AE(t){if(!$e.isDocumentKey(t))throw new Xe(De.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function wE(t){if($e.isDocumentKey(t))throw new Xe(De.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function IA(t){return typeof t=="object"&&t!==null&&(Object.getPrototypeOf(t)===Object.prototype||Object.getPrototypeOf(t)===null)}function h1(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(n){return n.constructor?n.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":rt(12329,{type:typeof t})}function Oa(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new Xe(De.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const r=h1(t);throw new Xe(De.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${r}`)}}return t}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Cr(t,e){const r={typeString:t};return e&&(r.value=e),r}function Ef(t,e){if(!IA(t))throw new Xe(De.INVALID_ARGUMENT,"JSON must be an object");let r;for(const n in e)if(e[n]){const i=e[n].typeString,o="value"in e[n]?{value:e[n].value}:void 0;if(!(n in t)){r=`JSON missing required field: '${n}'`;break}const c=t[n];if(i&&typeof c!==i){r=`JSON field '${n}' must be a ${i}.`;break}if(o!==void 0&&c!==o.value){r=`Expected '${n}' field to equal '${o.value}'`;break}}if(r)throw new Xe(De.INVALID_ARGUMENT,r);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const SE=-62135596800,CE=1e6;class Gt{static now(){return Gt.fromMillis(Date.now())}static fromDate(e){return Gt.fromMillis(e.getTime())}static fromMillis(e){const r=Math.floor(e/1e3),n=Math.floor((e-1e3*r)*CE);return new Gt(r,n)}constructor(e,r){if(this.seconds=e,this.nanoseconds=r,r<0)throw new Xe(De.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(r>=1e9)throw new Xe(De.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(e<SE)throw new Xe(De.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Xe(De.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/CE}_compareTo(e){return this.seconds===e.seconds?mt(this.nanoseconds,e.nanoseconds):mt(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:Gt._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(Ef(e,Gt._jsonSchema))return new Gt(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-SE;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}Gt._jsonSchemaVersion="firestore/timestamp/1.0",Gt._jsonSchema={type:Cr("string",Gt._jsonSchemaVersion),seconds:Cr("number"),nanoseconds:Cr("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lt{static fromTimestamp(e){return new lt(e)}static min(){return new lt(new Gt(0,0))}static max(){return new lt(new Gt(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ju=-1;function CD(t,e){const r=t.toTimestamp().seconds,n=t.toTimestamp().nanoseconds+1,i=lt.fromTimestamp(n===1e9?new Gt(r+1,0):new Gt(r,n));return new Ls(i,$e.empty(),e)}function RD(t){return new Ls(t.readTime,t.key,Ju)}class Ls{constructor(e,r,n){this.readTime=e,this.documentKey=r,this.largestBatchId=n}static min(){return new Ls(lt.min(),$e.empty(),Ju)}static max(){return new Ls(lt.max(),$e.empty(),Ju)}}function kD(t,e){let r=t.readTime.compareTo(e.readTime);return r!==0?r:(r=$e.comparator(t.documentKey,e.documentKey),r!==0?r:mt(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bD="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class ID{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function xc(t){if(t.code!==De.FAILED_PRECONDITION||t.message!==bD)throw t;He("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ke{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(r=>{this.isDone=!0,this.result=r,this.nextCallback&&this.nextCallback(r)},r=>{this.isDone=!0,this.error=r,this.catchCallback&&this.catchCallback(r)})}catch(e){return this.next(void 0,e)}next(e,r){return this.callbackAttached&&rt(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(r,this.error):this.wrapSuccess(e,this.result):new ke((n,i)=>{this.nextCallback=o=>{this.wrapSuccess(e,o).next(n,i)},this.catchCallback=o=>{this.wrapFailure(r,o).next(n,i)}})}toPromise(){return new Promise((e,r)=>{this.next(e,r)})}wrapUserFunction(e){try{const r=e();return r instanceof ke?r:ke.resolve(r)}catch(r){return ke.reject(r)}}wrapSuccess(e,r){return e?this.wrapUserFunction(()=>e(r)):ke.resolve(r)}wrapFailure(e,r){return e?this.wrapUserFunction(()=>e(r)):ke.reject(r)}static resolve(e){return new ke((r,n)=>{r(e)})}static reject(e){return new ke((r,n)=>{n(e)})}static waitFor(e){return new ke((r,n)=>{let i=0,o=0,c=!1;e.forEach(u=>{++i,u.next(()=>{++o,c&&o===i&&r()},h=>n(h))}),c=!0,o===i&&r()})}static or(e){let r=ke.resolve(!1);for(const n of e)r=r.next(i=>i?ke.resolve(i):n());return r}static forEach(e,r){const n=[];return e.forEach((i,o)=>{n.push(r.call(this,i,o))}),this.waitFor(n)}static mapArray(e,r){return new ke((n,i)=>{const o=e.length,c=new Array(o);let u=0;for(let h=0;h<o;h++){const d=h;r(e[d]).next(g=>{c[d]=g,++u,u===o&&n(c)},g=>i(g))}})}static doWhile(e,r){return new ke((n,i)=>{const o=()=>{e()===!0?r().next(()=>{o()},i):n()};o()})}}function DD(t){const e=t.match(/Android ([\d.]+)/i),r=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(r)}function yc(t){return t.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sd{constructor(e,r){this.previousValue=e,r&&(r.sequenceNumberHandler=n=>this._e(n),this.ae=n=>r.writeSequenceNumber(n))}_e(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ae&&this.ae(e),e}}sd.ue=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const d1=-1;function od(t){return t==null}function D0(t){return t===0&&1/t==-1/0}function OD(t){return typeof t=="number"&&Number.isInteger(t)&&!D0(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DA="";function ND(t){let e="";for(let r=0;r<t.length;r++)e.length>0&&(e=RE(e)),e=FD(t.get(r),e);return RE(e)}function FD(t,e){let r=e;const n=t.length;for(let i=0;i<n;i++){const o=t.charAt(i);switch(o){case"\0":r+="";break;case DA:r+="";break;default:r+=o}}return r}function RE(t){return t+DA+""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kE(t){let e=0;for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&e++;return e}function $s(t,e){for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&e(r,t[r])}function OA(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class or{constructor(e,r){this.comparator=e,this.root=r||$r.EMPTY}insert(e,r){return new or(this.comparator,this.root.insert(e,r,this.comparator).copy(null,null,$r.BLACK,null,null))}remove(e){return new or(this.comparator,this.root.remove(e,this.comparator).copy(null,null,$r.BLACK,null,null))}get(e){let r=this.root;for(;!r.isEmpty();){const n=this.comparator(e,r.key);if(n===0)return r.value;n<0?r=r.left:n>0&&(r=r.right)}return null}indexOf(e){let r=0,n=this.root;for(;!n.isEmpty();){const i=this.comparator(e,n.key);if(i===0)return r+n.left.size;i<0?n=n.left:(r+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((r,n)=>(e(r,n),!1))}toString(){const e=[];return this.inorderTraversal((r,n)=>(e.push(`${r}:${n}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new $h(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new $h(this.root,e,this.comparator,!1)}getReverseIterator(){return new $h(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new $h(this.root,e,this.comparator,!0)}}class $h{constructor(e,r,n,i){this.isReverse=i,this.nodeStack=[];let o=1;for(;!e.isEmpty();)if(o=r?n(e.key,r):1,r&&i&&(o*=-1),o<0)e=this.isReverse?e.left:e.right;else{if(o===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const r={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return r}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class $r{constructor(e,r,n,i,o){this.key=e,this.value=r,this.color=n??$r.RED,this.left=i??$r.EMPTY,this.right=o??$r.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,r,n,i,o){return new $r(e??this.key,r??this.value,n??this.color,i??this.left,o??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,r,n){let i=this;const o=n(e,i.key);return i=o<0?i.copy(null,null,null,i.left.insert(e,r,n),null):o===0?i.copy(null,r,null,null,null):i.copy(null,null,null,null,i.right.insert(e,r,n)),i.fixUp()}removeMin(){if(this.left.isEmpty())return $r.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,r){let n,i=this;if(r(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,r),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),r(e,i.key)===0){if(i.right.isEmpty())return $r.EMPTY;n=i.right.min(),i=i.copy(n.key,n.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,r))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,$r.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,$r.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),r=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,r)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw rt(43730,{key:this.key,value:this.value});if(this.right.isRed())throw rt(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw rt(27949);return e+(this.isRed()?0:1)}}$r.EMPTY=null,$r.RED=!0,$r.BLACK=!1;$r.EMPTY=new class{constructor(){this.size=0}get key(){throw rt(57766)}get value(){throw rt(16141)}get color(){throw rt(16727)}get left(){throw rt(29726)}get right(){throw rt(36894)}copy(e,r,n,i,o){return this}insert(e,r,n){return new $r(e,r)}remove(e,r){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pr{constructor(e){this.comparator=e,this.data=new or(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((r,n)=>(e(r),!1))}forEachInRange(e,r){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const i=n.getNext();if(this.comparator(i.key,e[1])>=0)return;r(i.key)}}forEachWhile(e,r){let n;for(n=r!==void 0?this.data.getIteratorFrom(r):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const r=this.data.getIteratorFrom(e);return r.hasNext()?r.getNext().key:null}getIterator(){return new bE(this.data.getIterator())}getIteratorFrom(e){return new bE(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let r=this;return r.size<e.size&&(r=e,e=this),e.forEach(n=>{r=r.add(n)}),r}isEqual(e){if(!(e instanceof Pr)||this.size!==e.size)return!1;const r=this.data.getIterator(),n=e.data.getIterator();for(;r.hasNext();){const i=r.getNext().key,o=n.getNext().key;if(this.comparator(i,o)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(r=>{e.push(r)}),e}toString(){const e=[];return this.forEach(r=>e.push(r)),"SortedSet("+e.toString()+")"}copy(e){const r=new Pr(this.comparator);return r.data=e,r}}class bE{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kn{constructor(e){this.fields=e,e.sort(Zr.comparator)}static empty(){return new Kn([])}unionWith(e){let r=new Pr(Zr.comparator);for(const n of this.fields)r=r.add(n);for(const n of e)r=r.add(n);return new Kn(r.toArray())}covers(e){for(const r of this.fields)if(r.isPrefixOf(e))return!0;return!1}isEqual(e){return oc(this.fields,e.fields,(r,n)=>r.isEqual(n))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NA extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rn{constructor(e){this.binaryString=e}static fromBase64String(e){const r=function(i){try{return atob(i)}catch(o){throw typeof DOMException<"u"&&o instanceof DOMException?new NA("Invalid base64 string: "+o):o}}(e);return new rn(r)}static fromUint8Array(e){const r=function(i){let o="";for(let c=0;c<i.length;++c)o+=String.fromCharCode(i[c]);return o}(e);return new rn(r)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(r){return btoa(r)}(this.binaryString)}toUint8Array(){return function(r){const n=new Uint8Array(r.length);for(let i=0;i<r.length;i++)n[i]=r.charCodeAt(i);return n}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return mt(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}rn.EMPTY_BYTE_STRING=new rn("");const PD=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Vs(t){if(jt(!!t,39018),typeof t=="string"){let e=0;const r=PD.exec(t);if(jt(!!r,46558,{timestamp:t}),r[1]){let i=r[1];i=(i+"000000000").substr(0,9),e=Number(i)}const n=new Date(t);return{seconds:Math.floor(n.getTime()/1e3),nanos:e}}return{seconds:gr(t.seconds),nanos:gr(t.nanos)}}function gr(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function Us(t){return typeof t=="string"?rn.fromBase64String(t):rn.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const FA="server_timestamp",PA="__type__",MA="__previous_value__",LA="__local_write_time__";function p1(t){var e,r;return((r=(((e=t?.mapValue)===null||e===void 0?void 0:e.fields)||{})[PA])===null||r===void 0?void 0:r.stringValue)===FA}function ld(t){const e=t.mapValue.fields[MA];return p1(e)?ld(e):e}function ef(t){const e=Vs(t.mapValue.fields[LA].timestampValue);return new Gt(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MD{constructor(e,r,n,i,o,c,u,h,d,g){this.databaseId=e,this.appId=r,this.persistenceKey=n,this.host=i,this.ssl=o,this.forceLongPolling=c,this.autoDetectLongPolling=u,this.longPollingOptions=h,this.useFetchStreams=d,this.isUsingEmulator=g}}const O0="(default)";class tf{constructor(e,r){this.projectId=e,this.database=r||O0}static empty(){return new tf("","")}get isDefaultDatabase(){return this.database===O0}isEqual(e){return e instanceof tf&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const VA="__type__",LD="__max__",Qh={mapValue:{}},UA="__vector__",N0="value";function Bs(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?p1(t)?4:UD(t)?9007199254740991:VD(t)?10:11:rt(28295,{value:t})}function ai(t,e){if(t===e)return!0;const r=Bs(t);if(r!==Bs(e))return!1;switch(r){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return ef(t).isEqual(ef(e));case 3:return function(i,o){if(typeof i.timestampValue=="string"&&typeof o.timestampValue=="string"&&i.timestampValue.length===o.timestampValue.length)return i.timestampValue===o.timestampValue;const c=Vs(i.timestampValue),u=Vs(o.timestampValue);return c.seconds===u.seconds&&c.nanos===u.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(i,o){return Us(i.bytesValue).isEqual(Us(o.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(i,o){return gr(i.geoPointValue.latitude)===gr(o.geoPointValue.latitude)&&gr(i.geoPointValue.longitude)===gr(o.geoPointValue.longitude)}(t,e);case 2:return function(i,o){if("integerValue"in i&&"integerValue"in o)return gr(i.integerValue)===gr(o.integerValue);if("doubleValue"in i&&"doubleValue"in o){const c=gr(i.doubleValue),u=gr(o.doubleValue);return c===u?D0(c)===D0(u):isNaN(c)&&isNaN(u)}return!1}(t,e);case 9:return oc(t.arrayValue.values||[],e.arrayValue.values||[],ai);case 10:case 11:return function(i,o){const c=i.mapValue.fields||{},u=o.mapValue.fields||{};if(kE(c)!==kE(u))return!1;for(const h in c)if(c.hasOwnProperty(h)&&(u[h]===void 0||!ai(c[h],u[h])))return!1;return!0}(t,e);default:return rt(52216,{left:t})}}function rf(t,e){return(t.values||[]).find(r=>ai(r,e))!==void 0}function lc(t,e){if(t===e)return 0;const r=Bs(t),n=Bs(e);if(r!==n)return mt(r,n);switch(r){case 0:case 9007199254740991:return 0;case 1:return mt(t.booleanValue,e.booleanValue);case 2:return function(o,c){const u=gr(o.integerValue||o.doubleValue),h=gr(c.integerValue||c.doubleValue);return u<h?-1:u>h?1:u===h?0:isNaN(u)?isNaN(h)?0:-1:1}(t,e);case 3:return IE(t.timestampValue,e.timestampValue);case 4:return IE(ef(t),ef(e));case 5:return gg(t.stringValue,e.stringValue);case 6:return function(o,c){const u=Us(o),h=Us(c);return u.compareTo(h)}(t.bytesValue,e.bytesValue);case 7:return function(o,c){const u=o.split("/"),h=c.split("/");for(let d=0;d<u.length&&d<h.length;d++){const g=mt(u[d],h[d]);if(g!==0)return g}return mt(u.length,h.length)}(t.referenceValue,e.referenceValue);case 8:return function(o,c){const u=mt(gr(o.latitude),gr(c.latitude));return u!==0?u:mt(gr(o.longitude),gr(c.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return DE(t.arrayValue,e.arrayValue);case 10:return function(o,c){var u,h,d,g;const _=o.fields||{},x=c.fields||{},A=(u=_[N0])===null||u===void 0?void 0:u.arrayValue,w=(h=x[N0])===null||h===void 0?void 0:h.arrayValue,S=mt(((d=A?.values)===null||d===void 0?void 0:d.length)||0,((g=w?.values)===null||g===void 0?void 0:g.length)||0);return S!==0?S:DE(A,w)}(t.mapValue,e.mapValue);case 11:return function(o,c){if(o===Qh.mapValue&&c===Qh.mapValue)return 0;if(o===Qh.mapValue)return 1;if(c===Qh.mapValue)return-1;const u=o.fields||{},h=Object.keys(u),d=c.fields||{},g=Object.keys(d);h.sort(),g.sort();for(let _=0;_<h.length&&_<g.length;++_){const x=gg(h[_],g[_]);if(x!==0)return x;const A=lc(u[h[_]],d[g[_]]);if(A!==0)return A}return mt(h.length,g.length)}(t.mapValue,e.mapValue);default:throw rt(23264,{le:r})}}function IE(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return mt(t,e);const r=Vs(t),n=Vs(e),i=mt(r.seconds,n.seconds);return i!==0?i:mt(r.nanos,n.nanos)}function DE(t,e){const r=t.values||[],n=e.values||[];for(let i=0;i<r.length&&i<n.length;++i){const o=lc(r[i],n[i]);if(o)return o}return mt(r.length,n.length)}function cc(t){return vg(t)}function vg(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(r){const n=Vs(r);return`time(${n.seconds},${n.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(r){return Us(r).toBase64()}(t.bytesValue):"referenceValue"in t?function(r){return $e.fromName(r).toString()}(t.referenceValue):"geoPointValue"in t?function(r){return`geo(${r.latitude},${r.longitude})`}(t.geoPointValue):"arrayValue"in t?function(r){let n="[",i=!0;for(const o of r.values||[])i?i=!1:n+=",",n+=vg(o);return n+"]"}(t.arrayValue):"mapValue"in t?function(r){const n=Object.keys(r.fields||{}).sort();let i="{",o=!0;for(const c of n)o?o=!1:i+=",",i+=`${c}:${vg(r.fields[c])}`;return i+"}"}(t.mapValue):rt(61005,{value:t})}function g0(t){switch(Bs(t)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=ld(t);return e?16+g0(e):16;case 5:return 2*t.stringValue.length;case 6:return Us(t.bytesValue).approximateByteSize();case 7:return t.referenceValue.length;case 9:return function(n){return(n.values||[]).reduce((i,o)=>i+g0(o),0)}(t.arrayValue);case 10:case 11:return function(n){let i=0;return $s(n.fields,(o,c)=>{i+=o.length+g0(c)}),i}(t.mapValue);default:throw rt(13486,{value:t})}}function _g(t){return!!t&&"integerValue"in t}function m1(t){return!!t&&"arrayValue"in t}function OE(t){return!!t&&"nullValue"in t}function NE(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function v0(t){return!!t&&"mapValue"in t}function VD(t){var e,r;return((r=(((e=t?.mapValue)===null||e===void 0?void 0:e.fields)||{})[VA])===null||r===void 0?void 0:r.stringValue)===UA}function Pu(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return $s(t.mapValue.fields,(r,n)=>e.mapValue.fields[r]=Pu(n)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let r=0;r<(t.arrayValue.values||[]).length;++r)e.arrayValue.values[r]=Pu(t.arrayValue.values[r]);return e}return Object.assign({},t)}function UD(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue===LD}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fn{constructor(e){this.value=e}static empty(){return new Fn({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let r=this.value;for(let n=0;n<e.length-1;++n)if(r=(r.mapValue.fields||{})[e.get(n)],!v0(r))return null;return r=(r.mapValue.fields||{})[e.lastSegment()],r||null}}set(e,r){this.getFieldsMap(e.popLast())[e.lastSegment()]=Pu(r)}setAll(e){let r=Zr.emptyPath(),n={},i=[];e.forEach((c,u)=>{if(!r.isImmediateParentOf(u)){const h=this.getFieldsMap(r);this.applyChanges(h,n,i),n={},i=[],r=u.popLast()}c?n[u.lastSegment()]=Pu(c):i.push(u.lastSegment())});const o=this.getFieldsMap(r);this.applyChanges(o,n,i)}delete(e){const r=this.field(e.popLast());v0(r)&&r.mapValue.fields&&delete r.mapValue.fields[e.lastSegment()]}isEqual(e){return ai(this.value,e.value)}getFieldsMap(e){let r=this.value;r.mapValue.fields||(r.mapValue={fields:{}});for(let n=0;n<e.length;++n){let i=r.mapValue.fields[e.get(n)];v0(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},r.mapValue.fields[e.get(n)]=i),r=i}return r.mapValue.fields}applyChanges(e,r,n){$s(r,(i,o)=>e[i]=o);for(const i of n)delete e[i]}clone(){return new Fn(Pu(this.value))}}function BA(t){const e=[];return $s(t.fields,(r,n)=>{const i=new Zr([r]);if(v0(n)){const o=BA(n.mapValue).fields;if(o.length===0)e.push(i);else for(const c of o)e.push(i.child(c))}else e.push(i)}),new Kn(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class un{constructor(e,r,n,i,o,c,u){this.key=e,this.documentType=r,this.version=n,this.readTime=i,this.createTime=o,this.data=c,this.documentState=u}static newInvalidDocument(e){return new un(e,0,lt.min(),lt.min(),lt.min(),Fn.empty(),0)}static newFoundDocument(e,r,n,i){return new un(e,1,r,lt.min(),n,i,0)}static newNoDocument(e,r){return new un(e,2,r,lt.min(),lt.min(),Fn.empty(),0)}static newUnknownDocument(e,r){return new un(e,3,r,lt.min(),lt.min(),Fn.empty(),2)}convertToFoundDocument(e,r){return!this.createTime.isEqual(lt.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=r,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Fn.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Fn.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=lt.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof un&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new un(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class F0{constructor(e,r){this.position=e,this.inclusive=r}}function FE(t,e,r){let n=0;for(let i=0;i<t.position.length;i++){const o=e[i],c=t.position[i];if(o.field.isKeyField()?n=$e.comparator($e.fromName(c.referenceValue),r.key):n=lc(c,r.data.field(o.field)),o.dir==="desc"&&(n*=-1),n!==0)break}return n}function PE(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let r=0;r<t.position.length;r++)if(!ai(t.position[r],e.position[r]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class P0{constructor(e,r="asc"){this.field=e,this.dir=r}}function BD(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jA{}class Nr extends jA{constructor(e,r,n){super(),this.field=e,this.op=r,this.value=n}static create(e,r,n){return e.isKeyField()?r==="in"||r==="not-in"?this.createKeyFieldInFilter(e,r,n):new zD(e,r,n):r==="array-contains"?new qD(e,n):r==="in"?new KD(e,n):r==="not-in"?new XD(e,n):r==="array-contains-any"?new WD(e,n):new Nr(e,r,n)}static createKeyFieldInFilter(e,r,n){return r==="in"?new HD(e,n):new GD(e,n)}matches(e){const r=e.data.field(this.field);return this.op==="!="?r!==null&&r.nullValue===void 0&&this.matchesComparison(lc(r,this.value)):r!==null&&Bs(this.value)===Bs(r)&&this.matchesComparison(lc(r,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return rt(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class ii extends jA{constructor(e,r){super(),this.filters=e,this.op=r,this.he=null}static create(e,r){return new ii(e,r)}matches(e){return zA(this)?this.filters.find(r=>!r.matches(e))===void 0:this.filters.find(r=>r.matches(e))!==void 0}getFlattenedFilters(){return this.he!==null||(this.he=this.filters.reduce((e,r)=>e.concat(r.getFlattenedFilters()),[])),this.he}getFilters(){return Object.assign([],this.filters)}}function zA(t){return t.op==="and"}function HA(t){return jD(t)&&zA(t)}function jD(t){for(const e of t.filters)if(e instanceof ii)return!1;return!0}function xg(t){if(t instanceof Nr)return t.field.canonicalString()+t.op.toString()+cc(t.value);if(HA(t))return t.filters.map(e=>xg(e)).join(",");{const e=t.filters.map(r=>xg(r)).join(",");return`${t.op}(${e})`}}function GA(t,e){return t instanceof Nr?function(n,i){return i instanceof Nr&&n.op===i.op&&n.field.isEqual(i.field)&&ai(n.value,i.value)}(t,e):t instanceof ii?function(n,i){return i instanceof ii&&n.op===i.op&&n.filters.length===i.filters.length?n.filters.reduce((o,c,u)=>o&&GA(c,i.filters[u]),!0):!1}(t,e):void rt(19439)}function qA(t){return t instanceof Nr?function(r){return`${r.field.canonicalString()} ${r.op} ${cc(r.value)}`}(t):t instanceof ii?function(r){return r.op.toString()+" {"+r.getFilters().map(qA).join(" ,")+"}"}(t):"Filter"}class zD extends Nr{constructor(e,r,n){super(e,r,n),this.key=$e.fromName(n.referenceValue)}matches(e){const r=$e.comparator(e.key,this.key);return this.matchesComparison(r)}}class HD extends Nr{constructor(e,r){super(e,"in",r),this.keys=KA("in",r)}matches(e){return this.keys.some(r=>r.isEqual(e.key))}}class GD extends Nr{constructor(e,r){super(e,"not-in",r),this.keys=KA("not-in",r)}matches(e){return!this.keys.some(r=>r.isEqual(e.key))}}function KA(t,e){var r;return(((r=e.arrayValue)===null||r===void 0?void 0:r.values)||[]).map(n=>$e.fromName(n.referenceValue))}class qD extends Nr{constructor(e,r){super(e,"array-contains",r)}matches(e){const r=e.data.field(this.field);return m1(r)&&rf(r.arrayValue,this.value)}}class KD extends Nr{constructor(e,r){super(e,"in",r)}matches(e){const r=e.data.field(this.field);return r!==null&&rf(this.value.arrayValue,r)}}class XD extends Nr{constructor(e,r){super(e,"not-in",r)}matches(e){if(rf(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const r=e.data.field(this.field);return r!==null&&r.nullValue===void 0&&!rf(this.value.arrayValue,r)}}class WD extends Nr{constructor(e,r){super(e,"array-contains-any",r)}matches(e){const r=e.data.field(this.field);return!(!m1(r)||!r.arrayValue.values)&&r.arrayValue.values.some(n=>rf(this.value.arrayValue,n))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YD{constructor(e,r=null,n=[],i=[],o=null,c=null,u=null){this.path=e,this.collectionGroup=r,this.orderBy=n,this.filters=i,this.limit=o,this.startAt=c,this.endAt=u,this.Pe=null}}function ME(t,e=null,r=[],n=[],i=null,o=null,c=null){return new YD(t,e,r,n,i,o,c)}function g1(t){const e=ct(t);if(e.Pe===null){let r=e.path.canonicalString();e.collectionGroup!==null&&(r+="|cg:"+e.collectionGroup),r+="|f:",r+=e.filters.map(n=>xg(n)).join(","),r+="|ob:",r+=e.orderBy.map(n=>function(o){return o.field.canonicalString()+o.dir}(n)).join(","),od(e.limit)||(r+="|l:",r+=e.limit),e.startAt&&(r+="|lb:",r+=e.startAt.inclusive?"b:":"a:",r+=e.startAt.position.map(n=>cc(n)).join(",")),e.endAt&&(r+="|ub:",r+=e.endAt.inclusive?"a:":"b:",r+=e.endAt.position.map(n=>cc(n)).join(",")),e.Pe=r}return e.Pe}function v1(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let r=0;r<t.orderBy.length;r++)if(!BD(t.orderBy[r],e.orderBy[r]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let r=0;r<t.filters.length;r++)if(!GA(t.filters[r],e.filters[r]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!PE(t.startAt,e.startAt)&&PE(t.endAt,e.endAt)}function yg(t){return $e.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cd{constructor(e,r=null,n=[],i=[],o=null,c="F",u=null,h=null){this.path=e,this.collectionGroup=r,this.explicitOrderBy=n,this.filters=i,this.limit=o,this.limitType=c,this.startAt=u,this.endAt=h,this.Te=null,this.Ie=null,this.de=null,this.startAt,this.endAt}}function $D(t,e,r,n,i,o,c,u){return new cd(t,e,r,n,i,o,c,u)}function _1(t){return new cd(t)}function LE(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function QD(t){return t.collectionGroup!==null}function Mu(t){const e=ct(t);if(e.Te===null){e.Te=[];const r=new Set;for(const o of e.explicitOrderBy)e.Te.push(o),r.add(o.field.canonicalString());const n=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(c){let u=new Pr(Zr.comparator);return c.filters.forEach(h=>{h.getFlattenedFilters().forEach(d=>{d.isInequality()&&(u=u.add(d.field))})}),u})(e).forEach(o=>{r.has(o.canonicalString())||o.isKeyField()||e.Te.push(new P0(o,n))}),r.has(Zr.keyField().canonicalString())||e.Te.push(new P0(Zr.keyField(),n))}return e.Te}function ei(t){const e=ct(t);return e.Ie||(e.Ie=ZD(e,Mu(t))),e.Ie}function ZD(t,e){if(t.limitType==="F")return ME(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(i=>{const o=i.dir==="desc"?"asc":"desc";return new P0(i.field,o)});const r=t.endAt?new F0(t.endAt.position,t.endAt.inclusive):null,n=t.startAt?new F0(t.startAt.position,t.startAt.inclusive):null;return ME(t.path,t.collectionGroup,e,t.filters,t.limit,r,n)}}function Eg(t,e,r){return new cd(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,r,t.startAt,t.endAt)}function ud(t,e){return v1(ei(t),ei(e))&&t.limitType===e.limitType}function XA(t){return`${g1(ei(t))}|lt:${t.limitType}`}function Kl(t){return`Query(target=${function(r){let n=r.path.canonicalString();return r.collectionGroup!==null&&(n+=" collectionGroup="+r.collectionGroup),r.filters.length>0&&(n+=`, filters: [${r.filters.map(i=>qA(i)).join(", ")}]`),od(r.limit)||(n+=", limit: "+r.limit),r.orderBy.length>0&&(n+=`, orderBy: [${r.orderBy.map(i=>function(c){return`${c.field.canonicalString()} (${c.dir})`}(i)).join(", ")}]`),r.startAt&&(n+=", startAt: ",n+=r.startAt.inclusive?"b:":"a:",n+=r.startAt.position.map(i=>cc(i)).join(",")),r.endAt&&(n+=", endAt: ",n+=r.endAt.inclusive?"a:":"b:",n+=r.endAt.position.map(i=>cc(i)).join(",")),`Target(${n})`}(ei(t))}; limitType=${t.limitType})`}function fd(t,e){return e.isFoundDocument()&&function(n,i){const o=i.key.path;return n.collectionGroup!==null?i.key.hasCollectionId(n.collectionGroup)&&n.path.isPrefixOf(o):$e.isDocumentKey(n.path)?n.path.isEqual(o):n.path.isImmediateParentOf(o)}(t,e)&&function(n,i){for(const o of Mu(n))if(!o.field.isKeyField()&&i.data.field(o.field)===null)return!1;return!0}(t,e)&&function(n,i){for(const o of n.filters)if(!o.matches(i))return!1;return!0}(t,e)&&function(n,i){return!(n.startAt&&!function(c,u,h){const d=FE(c,u,h);return c.inclusive?d<=0:d<0}(n.startAt,Mu(n),i)||n.endAt&&!function(c,u,h){const d=FE(c,u,h);return c.inclusive?d>=0:d>0}(n.endAt,Mu(n),i))}(t,e)}function JD(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function WA(t){return(e,r)=>{let n=!1;for(const i of Mu(t)){const o=eO(i,e,r);if(o!==0)return o;n=n||i.field.isKeyField()}return 0}}function eO(t,e,r){const n=t.field.isKeyField()?$e.comparator(e.key,r.key):function(o,c,u){const h=c.data.field(o),d=u.data.field(o);return h!==null&&d!==null?lc(h,d):rt(42886)}(t.field,e,r);switch(t.dir){case"asc":return n;case"desc":return-1*n;default:return rt(19790,{direction:t.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xo{constructor(e,r){this.mapKeyFn=e,this.equalsFn=r,this.inner={},this.innerSize=0}get(e){const r=this.mapKeyFn(e),n=this.inner[r];if(n!==void 0){for(const[i,o]of n)if(this.equalsFn(i,e))return o}}has(e){return this.get(e)!==void 0}set(e,r){const n=this.mapKeyFn(e),i=this.inner[n];if(i===void 0)return this.inner[n]=[[e,r]],void this.innerSize++;for(let o=0;o<i.length;o++)if(this.equalsFn(i[o][0],e))return void(i[o]=[e,r]);i.push([e,r]),this.innerSize++}delete(e){const r=this.mapKeyFn(e),n=this.inner[r];if(n===void 0)return!1;for(let i=0;i<n.length;i++)if(this.equalsFn(n[i][0],e))return n.length===1?delete this.inner[r]:n.splice(i,1),this.innerSize--,!0;return!1}forEach(e){$s(this.inner,(r,n)=>{for(const[i,o]of n)e(i,o)})}isEmpty(){return OA(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tO=new or($e.comparator);function Bi(){return tO}const YA=new or($e.comparator);function Cu(...t){let e=YA;for(const r of t)e=e.insert(r.key,r);return e}function $A(t){let e=YA;return t.forEach((r,n)=>e=e.insert(r,n.overlayedDocument)),e}function Do(){return Lu()}function QA(){return Lu()}function Lu(){return new Xo(t=>t.toString(),(t,e)=>t.isEqual(e))}const rO=new or($e.comparator),nO=new Pr($e.comparator);function At(...t){let e=nO;for(const r of t)e=e.add(r);return e}const aO=new Pr(mt);function iO(){return aO}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function x1(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:D0(e)?"-0":e}}function ZA(t){return{integerValue:""+t}}function sO(t,e){return OD(e)?ZA(e):x1(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hd{constructor(){this._=void 0}}function oO(t,e,r){return t instanceof M0?function(i,o){const c={fields:{[PA]:{stringValue:FA},[LA]:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return o&&p1(o)&&(o=ld(o)),o&&(c.fields[MA]=o),{mapValue:c}}(r,e):t instanceof nf?ew(t,e):t instanceof af?tw(t,e):function(i,o){const c=JA(i,o),u=VE(c)+VE(i.Ee);return _g(c)&&_g(i.Ee)?ZA(u):x1(i.serializer,u)}(t,e)}function lO(t,e,r){return t instanceof nf?ew(t,e):t instanceof af?tw(t,e):r}function JA(t,e){return t instanceof L0?function(n){return _g(n)||function(o){return!!o&&"doubleValue"in o}(n)}(e)?e:{integerValue:0}:null}class M0 extends hd{}class nf extends hd{constructor(e){super(),this.elements=e}}function ew(t,e){const r=rw(e);for(const n of t.elements)r.some(i=>ai(i,n))||r.push(n);return{arrayValue:{values:r}}}class af extends hd{constructor(e){super(),this.elements=e}}function tw(t,e){let r=rw(e);for(const n of t.elements)r=r.filter(i=>!ai(i,n));return{arrayValue:{values:r}}}class L0 extends hd{constructor(e,r){super(),this.serializer=e,this.Ee=r}}function VE(t){return gr(t.integerValue||t.doubleValue)}function rw(t){return m1(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}function cO(t,e){return t.field.isEqual(e.field)&&function(n,i){return n instanceof nf&&i instanceof nf||n instanceof af&&i instanceof af?oc(n.elements,i.elements,ai):n instanceof L0&&i instanceof L0?ai(n.Ee,i.Ee):n instanceof M0&&i instanceof M0}(t.transform,e.transform)}class uO{constructor(e,r){this.version=e,this.transformResults=r}}class da{constructor(e,r){this.updateTime=e,this.exists=r}static none(){return new da}static exists(e){return new da(void 0,e)}static updateTime(e){return new da(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function _0(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class dd{}function nw(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new y1(t.key,da.none()):new Tf(t.key,t.data,da.none());{const r=t.data,n=Fn.empty();let i=new Pr(Zr.comparator);for(let o of e.fields)if(!i.has(o)){let c=r.field(o);c===null&&o.length>1&&(o=o.popLast(),c=r.field(o)),c===null?n.delete(o):n.set(o,c),i=i.add(o)}return new Qs(t.key,n,new Kn(i.toArray()),da.none())}}function fO(t,e,r){t instanceof Tf?function(i,o,c){const u=i.value.clone(),h=BE(i.fieldTransforms,o,c.transformResults);u.setAll(h),o.convertToFoundDocument(c.version,u).setHasCommittedMutations()}(t,e,r):t instanceof Qs?function(i,o,c){if(!_0(i.precondition,o))return void o.convertToUnknownDocument(c.version);const u=BE(i.fieldTransforms,o,c.transformResults),h=o.data;h.setAll(aw(i)),h.setAll(u),o.convertToFoundDocument(c.version,h).setHasCommittedMutations()}(t,e,r):function(i,o,c){o.convertToNoDocument(c.version).setHasCommittedMutations()}(0,e,r)}function Vu(t,e,r,n){return t instanceof Tf?function(o,c,u,h){if(!_0(o.precondition,c))return u;const d=o.value.clone(),g=jE(o.fieldTransforms,h,c);return d.setAll(g),c.convertToFoundDocument(c.version,d).setHasLocalMutations(),null}(t,e,r,n):t instanceof Qs?function(o,c,u,h){if(!_0(o.precondition,c))return u;const d=jE(o.fieldTransforms,h,c),g=c.data;return g.setAll(aw(o)),g.setAll(d),c.convertToFoundDocument(c.version,g).setHasLocalMutations(),u===null?null:u.unionWith(o.fieldMask.fields).unionWith(o.fieldTransforms.map(_=>_.field))}(t,e,r,n):function(o,c,u){return _0(o.precondition,c)?(c.convertToNoDocument(c.version).setHasLocalMutations(),null):u}(t,e,r)}function hO(t,e){let r=null;for(const n of t.fieldTransforms){const i=e.data.field(n.field),o=JA(n.transform,i||null);o!=null&&(r===null&&(r=Fn.empty()),r.set(n.field,o))}return r||null}function UE(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(n,i){return n===void 0&&i===void 0||!(!n||!i)&&oc(n,i,(o,c)=>cO(o,c))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class Tf extends dd{constructor(e,r,n,i=[]){super(),this.key=e,this.value=r,this.precondition=n,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class Qs extends dd{constructor(e,r,n,i,o=[]){super(),this.key=e,this.data=r,this.fieldMask=n,this.precondition=i,this.fieldTransforms=o,this.type=1}getFieldMask(){return this.fieldMask}}function aw(t){const e=new Map;return t.fieldMask.fields.forEach(r=>{if(!r.isEmpty()){const n=t.data.field(r);e.set(r,n)}}),e}function BE(t,e,r){const n=new Map;jt(t.length===r.length,32656,{Ae:r.length,Re:t.length});for(let i=0;i<r.length;i++){const o=t[i],c=o.transform,u=e.data.field(o.field);n.set(o.field,lO(c,u,r[i]))}return n}function jE(t,e,r){const n=new Map;for(const i of t){const o=i.transform,c=r.data.field(i.field);n.set(i.field,oO(o,c,e))}return n}class y1 extends dd{constructor(e,r){super(),this.key=e,this.precondition=r,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class dO extends dd{constructor(e,r){super(),this.key=e,this.precondition=r,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pO{constructor(e,r,n,i){this.batchId=e,this.localWriteTime=r,this.baseMutations=n,this.mutations=i}applyToRemoteDocument(e,r){const n=r.mutationResults;for(let i=0;i<this.mutations.length;i++){const o=this.mutations[i];o.key.isEqual(e.key)&&fO(o,e,n[i])}}applyToLocalView(e,r){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(r=Vu(n,e,r,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(r=Vu(n,e,r,this.localWriteTime));return r}applyToLocalDocumentSet(e,r){const n=QA();return this.mutations.forEach(i=>{const o=e.get(i.key),c=o.overlayedDocument;let u=this.applyToLocalView(c,o.mutatedFields);u=r.has(i.key)?null:u;const h=nw(c,u);h!==null&&n.set(i.key,h),c.isValidDocument()||c.convertToNoDocument(lt.min())}),n}keys(){return this.mutations.reduce((e,r)=>e.add(r.key),At())}isEqual(e){return this.batchId===e.batchId&&oc(this.mutations,e.mutations,(r,n)=>UE(r,n))&&oc(this.baseMutations,e.baseMutations,(r,n)=>UE(r,n))}}class E1{constructor(e,r,n,i){this.batch=e,this.commitVersion=r,this.mutationResults=n,this.docVersions=i}static from(e,r,n){jt(e.mutations.length===n.length,58842,{Ve:e.mutations.length,me:n.length});let i=function(){return rO}();const o=e.mutations;for(let c=0;c<o.length;c++)i=i.insert(o[c].key,n[c].version);return new E1(e,r,n,i)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mO{constructor(e,r){this.largestBatchId=e,this.mutation=r}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gO{constructor(e,r){this.count=e,this.unchangedNames=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ar,It;function vO(t){switch(t){case De.OK:return rt(64938);case De.CANCELLED:case De.UNKNOWN:case De.DEADLINE_EXCEEDED:case De.RESOURCE_EXHAUSTED:case De.INTERNAL:case De.UNAVAILABLE:case De.UNAUTHENTICATED:return!1;case De.INVALID_ARGUMENT:case De.NOT_FOUND:case De.ALREADY_EXISTS:case De.PERMISSION_DENIED:case De.FAILED_PRECONDITION:case De.ABORTED:case De.OUT_OF_RANGE:case De.UNIMPLEMENTED:case De.DATA_LOSS:return!0;default:return rt(15467,{code:t})}}function iw(t){if(t===void 0)return Ui("GRPC error has no .code"),De.UNKNOWN;switch(t){case Ar.OK:return De.OK;case Ar.CANCELLED:return De.CANCELLED;case Ar.UNKNOWN:return De.UNKNOWN;case Ar.DEADLINE_EXCEEDED:return De.DEADLINE_EXCEEDED;case Ar.RESOURCE_EXHAUSTED:return De.RESOURCE_EXHAUSTED;case Ar.INTERNAL:return De.INTERNAL;case Ar.UNAVAILABLE:return De.UNAVAILABLE;case Ar.UNAUTHENTICATED:return De.UNAUTHENTICATED;case Ar.INVALID_ARGUMENT:return De.INVALID_ARGUMENT;case Ar.NOT_FOUND:return De.NOT_FOUND;case Ar.ALREADY_EXISTS:return De.ALREADY_EXISTS;case Ar.PERMISSION_DENIED:return De.PERMISSION_DENIED;case Ar.FAILED_PRECONDITION:return De.FAILED_PRECONDITION;case Ar.ABORTED:return De.ABORTED;case Ar.OUT_OF_RANGE:return De.OUT_OF_RANGE;case Ar.UNIMPLEMENTED:return De.UNIMPLEMENTED;case Ar.DATA_LOSS:return De.DATA_LOSS;default:return rt(39323,{code:t})}}(It=Ar||(Ar={}))[It.OK=0]="OK",It[It.CANCELLED=1]="CANCELLED",It[It.UNKNOWN=2]="UNKNOWN",It[It.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",It[It.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",It[It.NOT_FOUND=5]="NOT_FOUND",It[It.ALREADY_EXISTS=6]="ALREADY_EXISTS",It[It.PERMISSION_DENIED=7]="PERMISSION_DENIED",It[It.UNAUTHENTICATED=16]="UNAUTHENTICATED",It[It.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",It[It.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",It[It.ABORTED=10]="ABORTED",It[It.OUT_OF_RANGE=11]="OUT_OF_RANGE",It[It.UNIMPLEMENTED=12]="UNIMPLEMENTED",It[It.INTERNAL=13]="INTERNAL",It[It.UNAVAILABLE=14]="UNAVAILABLE",It[It.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _O=new Ns([4294967295,4294967295],0);function zE(t){const e=kA().encode(t),r=new yA;return r.update(e),new Uint8Array(r.digest())}function HE(t){const e=new DataView(t.buffer),r=e.getUint32(0,!0),n=e.getUint32(4,!0),i=e.getUint32(8,!0),o=e.getUint32(12,!0);return[new Ns([r,n],0),new Ns([i,o],0)]}class T1{constructor(e,r,n){if(this.bitmap=e,this.padding=r,this.hashCount=n,r<0||r>=8)throw new Ru(`Invalid padding: ${r}`);if(n<0)throw new Ru(`Invalid hash count: ${n}`);if(e.length>0&&this.hashCount===0)throw new Ru(`Invalid hash count: ${n}`);if(e.length===0&&r!==0)throw new Ru(`Invalid padding when bitmap length is 0: ${r}`);this.fe=8*e.length-r,this.ge=Ns.fromNumber(this.fe)}pe(e,r,n){let i=e.add(r.multiply(Ns.fromNumber(n)));return i.compare(_O)===1&&(i=new Ns([i.getBits(0),i.getBits(1)],0)),i.modulo(this.ge).toNumber()}ye(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.fe===0)return!1;const r=zE(e),[n,i]=HE(r);for(let o=0;o<this.hashCount;o++){const c=this.pe(n,i,o);if(!this.ye(c))return!1}return!0}static create(e,r,n){const i=e%8==0?0:8-e%8,o=new Uint8Array(Math.ceil(e/8)),c=new T1(o,i,r);return n.forEach(u=>c.insert(u)),c}insert(e){if(this.fe===0)return;const r=zE(e),[n,i]=HE(r);for(let o=0;o<this.hashCount;o++){const c=this.pe(n,i,o);this.we(c)}}we(e){const r=Math.floor(e/8),n=e%8;this.bitmap[r]|=1<<n}}class Ru extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pd{constructor(e,r,n,i,o){this.snapshotVersion=e,this.targetChanges=r,this.targetMismatches=n,this.documentUpdates=i,this.resolvedLimboDocuments=o}static createSynthesizedRemoteEventForCurrentChange(e,r,n){const i=new Map;return i.set(e,Af.createSynthesizedTargetChangeForCurrentChange(e,r,n)),new pd(lt.min(),i,new or(mt),Bi(),At())}}class Af{constructor(e,r,n,i,o){this.resumeToken=e,this.current=r,this.addedDocuments=n,this.modifiedDocuments=i,this.removedDocuments=o}static createSynthesizedTargetChangeForCurrentChange(e,r,n){return new Af(n,r,At(),At(),At())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class x0{constructor(e,r,n,i){this.Se=e,this.removedTargetIds=r,this.key=n,this.be=i}}class sw{constructor(e,r){this.targetId=e,this.De=r}}class ow{constructor(e,r,n=rn.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=r,this.resumeToken=n,this.cause=i}}class GE{constructor(){this.ve=0,this.Ce=qE(),this.Fe=rn.EMPTY_BYTE_STRING,this.Me=!1,this.xe=!0}get current(){return this.Me}get resumeToken(){return this.Fe}get Oe(){return this.ve!==0}get Ne(){return this.xe}Be(e){e.approximateByteSize()>0&&(this.xe=!0,this.Fe=e)}Le(){let e=At(),r=At(),n=At();return this.Ce.forEach((i,o)=>{switch(o){case 0:e=e.add(i);break;case 2:r=r.add(i);break;case 1:n=n.add(i);break;default:rt(38017,{changeType:o})}}),new Af(this.Fe,this.Me,e,r,n)}ke(){this.xe=!1,this.Ce=qE()}qe(e,r){this.xe=!0,this.Ce=this.Ce.insert(e,r)}Qe(e){this.xe=!0,this.Ce=this.Ce.remove(e)}$e(){this.ve+=1}Ue(){this.ve-=1,jt(this.ve>=0,3241,{ve:this.ve})}Ke(){this.xe=!0,this.Me=!0}}class xO{constructor(e){this.We=e,this.Ge=new Map,this.ze=Bi(),this.je=Zh(),this.Je=Zh(),this.He=new or(mt)}Ye(e){for(const r of e.Se)e.be&&e.be.isFoundDocument()?this.Ze(r,e.be):this.Xe(r,e.key,e.be);for(const r of e.removedTargetIds)this.Xe(r,e.key,e.be)}et(e){this.forEachTarget(e,r=>{const n=this.tt(r);switch(e.state){case 0:this.nt(r)&&n.Be(e.resumeToken);break;case 1:n.Ue(),n.Oe||n.ke(),n.Be(e.resumeToken);break;case 2:n.Ue(),n.Oe||this.removeTarget(r);break;case 3:this.nt(r)&&(n.Ke(),n.Be(e.resumeToken));break;case 4:this.nt(r)&&(this.rt(r),n.Be(e.resumeToken));break;default:rt(56790,{state:e.state})}})}forEachTarget(e,r){e.targetIds.length>0?e.targetIds.forEach(r):this.Ge.forEach((n,i)=>{this.nt(i)&&r(i)})}it(e){const r=e.targetId,n=e.De.count,i=this.st(r);if(i){const o=i.target;if(yg(o))if(n===0){const c=new $e(o.path);this.Xe(r,c,un.newNoDocument(c,lt.min()))}else jt(n===1,20013,{expectedCount:n});else{const c=this.ot(r);if(c!==n){const u=this._t(e),h=u?this.ut(u,e,c):1;if(h!==0){this.rt(r);const d=h===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.He=this.He.insert(r,d)}}}}}_t(e){const r=e.De.unchangedNames;if(!r||!r.bits)return null;const{bits:{bitmap:n="",padding:i=0},hashCount:o=0}=r;let c,u;try{c=Us(n).toUint8Array()}catch(h){if(h instanceof NA)return Ms("Decoding the base64 bloom filter in existence filter failed ("+h.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw h}try{u=new T1(c,i,o)}catch(h){return Ms(h instanceof Ru?"BloomFilter error: ":"Applying bloom filter failed: ",h),null}return u.fe===0?null:u}ut(e,r,n){return r.De.count===n-this.ht(e,r.targetId)?0:2}ht(e,r){const n=this.We.getRemoteKeysForTarget(r);let i=0;return n.forEach(o=>{const c=this.We.lt(),u=`projects/${c.projectId}/databases/${c.database}/documents/${o.path.canonicalString()}`;e.mightContain(u)||(this.Xe(r,o,null),i++)}),i}Pt(e){const r=new Map;this.Ge.forEach((o,c)=>{const u=this.st(c);if(u){if(o.current&&yg(u.target)){const h=new $e(u.target.path);this.Tt(h).has(c)||this.It(c,h)||this.Xe(c,h,un.newNoDocument(h,e))}o.Ne&&(r.set(c,o.Le()),o.ke())}});let n=At();this.Je.forEach((o,c)=>{let u=!0;c.forEachWhile(h=>{const d=this.st(h);return!d||d.purpose==="TargetPurposeLimboResolution"||(u=!1,!1)}),u&&(n=n.add(o))}),this.ze.forEach((o,c)=>c.setReadTime(e));const i=new pd(e,r,this.He,this.ze,n);return this.ze=Bi(),this.je=Zh(),this.Je=Zh(),this.He=new or(mt),i}Ze(e,r){if(!this.nt(e))return;const n=this.It(e,r.key)?2:0;this.tt(e).qe(r.key,n),this.ze=this.ze.insert(r.key,r),this.je=this.je.insert(r.key,this.Tt(r.key).add(e)),this.Je=this.Je.insert(r.key,this.dt(r.key).add(e))}Xe(e,r,n){if(!this.nt(e))return;const i=this.tt(e);this.It(e,r)?i.qe(r,1):i.Qe(r),this.Je=this.Je.insert(r,this.dt(r).delete(e)),this.Je=this.Je.insert(r,this.dt(r).add(e)),n&&(this.ze=this.ze.insert(r,n))}removeTarget(e){this.Ge.delete(e)}ot(e){const r=this.tt(e).Le();return this.We.getRemoteKeysForTarget(e).size+r.addedDocuments.size-r.removedDocuments.size}$e(e){this.tt(e).$e()}tt(e){let r=this.Ge.get(e);return r||(r=new GE,this.Ge.set(e,r)),r}dt(e){let r=this.Je.get(e);return r||(r=new Pr(mt),this.Je=this.Je.insert(e,r)),r}Tt(e){let r=this.je.get(e);return r||(r=new Pr(mt),this.je=this.je.insert(e,r)),r}nt(e){const r=this.st(e)!==null;return r||He("WatchChangeAggregator","Detected inactive target",e),r}st(e){const r=this.Ge.get(e);return r&&r.Oe?null:this.We.Et(e)}rt(e){this.Ge.set(e,new GE),this.We.getRemoteKeysForTarget(e).forEach(r=>{this.Xe(e,r,null)})}It(e,r){return this.We.getRemoteKeysForTarget(e).has(r)}}function Zh(){return new or($e.comparator)}function qE(){return new or($e.comparator)}const yO={asc:"ASCENDING",desc:"DESCENDING"},EO={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},TO={and:"AND",or:"OR"};class AO{constructor(e,r){this.databaseId=e,this.useProto3Json=r}}function Tg(t,e){return t.useProto3Json||od(e)?e:{value:e}}function V0(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function lw(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function wO(t,e){return V0(t,e.toTimestamp())}function ti(t){return jt(!!t,49232),lt.fromTimestamp(function(r){const n=Vs(r);return new Gt(n.seconds,n.nanos)}(t))}function A1(t,e){return Ag(t,e).canonicalString()}function Ag(t,e){const r=function(i){return new tr(["projects",i.projectId,"databases",i.database])}(t).child("documents");return e===void 0?r:r.child(e)}function cw(t){const e=tr.fromString(t);return jt(pw(e),10190,{key:e.toString()}),e}function wg(t,e){return A1(t.databaseId,e.path)}function Gm(t,e){const r=cw(e);if(r.get(1)!==t.databaseId.projectId)throw new Xe(De.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+r.get(1)+" vs "+t.databaseId.projectId);if(r.get(3)!==t.databaseId.database)throw new Xe(De.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+r.get(3)+" vs "+t.databaseId.database);return new $e(fw(r))}function uw(t,e){return A1(t.databaseId,e)}function SO(t){const e=cw(t);return e.length===4?tr.emptyPath():fw(e)}function Sg(t){return new tr(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function fw(t){return jt(t.length>4&&t.get(4)==="documents",29091,{key:t.toString()}),t.popFirst(5)}function KE(t,e,r){return{name:wg(t,e),fields:r.value.mapValue.fields}}function CO(t,e){let r;if("targetChange"in e){e.targetChange;const n=function(d){return d==="NO_CHANGE"?0:d==="ADD"?1:d==="REMOVE"?2:d==="CURRENT"?3:d==="RESET"?4:rt(39313,{state:d})}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],o=function(d,g){return d.useProto3Json?(jt(g===void 0||typeof g=="string",58123),rn.fromBase64String(g||"")):(jt(g===void 0||g instanceof Buffer||g instanceof Uint8Array,16193),rn.fromUint8Array(g||new Uint8Array))}(t,e.targetChange.resumeToken),c=e.targetChange.cause,u=c&&function(d){const g=d.code===void 0?De.UNKNOWN:iw(d.code);return new Xe(g,d.message||"")}(c);r=new ow(n,i,o,u||null)}else if("documentChange"in e){e.documentChange;const n=e.documentChange;n.document,n.document.name,n.document.updateTime;const i=Gm(t,n.document.name),o=ti(n.document.updateTime),c=n.document.createTime?ti(n.document.createTime):lt.min(),u=new Fn({mapValue:{fields:n.document.fields}}),h=un.newFoundDocument(i,o,c,u),d=n.targetIds||[],g=n.removedTargetIds||[];r=new x0(d,g,h.key,h)}else if("documentDelete"in e){e.documentDelete;const n=e.documentDelete;n.document;const i=Gm(t,n.document),o=n.readTime?ti(n.readTime):lt.min(),c=un.newNoDocument(i,o),u=n.removedTargetIds||[];r=new x0([],u,c.key,c)}else if("documentRemove"in e){e.documentRemove;const n=e.documentRemove;n.document;const i=Gm(t,n.document),o=n.removedTargetIds||[];r=new x0([],o,i,null)}else{if(!("filter"in e))return rt(11601,{At:e});{e.filter;const n=e.filter;n.targetId;const{count:i=0,unchangedNames:o}=n,c=new gO(i,o),u=n.targetId;r=new sw(u,c)}}return r}function RO(t,e){let r;if(e instanceof Tf)r={update:KE(t,e.key,e.value)};else if(e instanceof y1)r={delete:wg(t,e.key)};else if(e instanceof Qs)r={update:KE(t,e.key,e.data),updateMask:MO(e.fieldMask)};else{if(!(e instanceof dO))return rt(16599,{Rt:e.type});r={verify:wg(t,e.key)}}return e.fieldTransforms.length>0&&(r.updateTransforms=e.fieldTransforms.map(n=>function(o,c){const u=c.transform;if(u instanceof M0)return{fieldPath:c.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(u instanceof nf)return{fieldPath:c.field.canonicalString(),appendMissingElements:{values:u.elements}};if(u instanceof af)return{fieldPath:c.field.canonicalString(),removeAllFromArray:{values:u.elements}};if(u instanceof L0)return{fieldPath:c.field.canonicalString(),increment:u.Ee};throw rt(20930,{transform:c.transform})}(0,n))),e.precondition.isNone||(r.currentDocument=function(i,o){return o.updateTime!==void 0?{updateTime:wO(i,o.updateTime)}:o.exists!==void 0?{exists:o.exists}:rt(27497)}(t,e.precondition)),r}function kO(t,e){return t&&t.length>0?(jt(e!==void 0,14353),t.map(r=>function(i,o){let c=i.updateTime?ti(i.updateTime):ti(o);return c.isEqual(lt.min())&&(c=ti(o)),new uO(c,i.transformResults||[])}(r,e))):[]}function bO(t,e){return{documents:[uw(t,e.path)]}}function IO(t,e){const r={structuredQuery:{}},n=e.path;let i;e.collectionGroup!==null?(i=n,r.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=n.popLast(),r.structuredQuery.from=[{collectionId:n.lastSegment()}]),r.parent=uw(t,i);const o=function(d){if(d.length!==0)return dw(ii.create(d,"and"))}(e.filters);o&&(r.structuredQuery.where=o);const c=function(d){if(d.length!==0)return d.map(g=>function(x){return{field:Xl(x.field),direction:NO(x.dir)}}(g))}(e.orderBy);c&&(r.structuredQuery.orderBy=c);const u=Tg(t,e.limit);return u!==null&&(r.structuredQuery.limit=u),e.startAt&&(r.structuredQuery.startAt=function(d){return{before:d.inclusive,values:d.position}}(e.startAt)),e.endAt&&(r.structuredQuery.endAt=function(d){return{before:!d.inclusive,values:d.position}}(e.endAt)),{Vt:r,parent:i}}function DO(t){let e=SO(t.parent);const r=t.structuredQuery,n=r.from?r.from.length:0;let i=null;if(n>0){jt(n===1,65062);const g=r.from[0];g.allDescendants?i=g.collectionId:e=e.child(g.collectionId)}let o=[];r.where&&(o=function(_){const x=hw(_);return x instanceof ii&&HA(x)?x.getFilters():[x]}(r.where));let c=[];r.orderBy&&(c=function(_){return _.map(x=>function(w){return new P0(Wl(w.field),function(C){switch(C){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(w.direction))}(x))}(r.orderBy));let u=null;r.limit&&(u=function(_){let x;return x=typeof _=="object"?_.value:_,od(x)?null:x}(r.limit));let h=null;r.startAt&&(h=function(_){const x=!!_.before,A=_.values||[];return new F0(A,x)}(r.startAt));let d=null;return r.endAt&&(d=function(_){const x=!_.before,A=_.values||[];return new F0(A,x)}(r.endAt)),$D(e,i,c,o,u,"F",h,d)}function OO(t,e){const r=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return rt(28987,{purpose:i})}}(e.purpose);return r==null?null:{"goog-listen-tags":r}}function hw(t){return t.unaryFilter!==void 0?function(r){switch(r.unaryFilter.op){case"IS_NAN":const n=Wl(r.unaryFilter.field);return Nr.create(n,"==",{doubleValue:NaN});case"IS_NULL":const i=Wl(r.unaryFilter.field);return Nr.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const o=Wl(r.unaryFilter.field);return Nr.create(o,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const c=Wl(r.unaryFilter.field);return Nr.create(c,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return rt(61313);default:return rt(60726)}}(t):t.fieldFilter!==void 0?function(r){return Nr.create(Wl(r.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return rt(58110);default:return rt(50506)}}(r.fieldFilter.op),r.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(r){return ii.create(r.compositeFilter.filters.map(n=>hw(n)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return rt(1026)}}(r.compositeFilter.op))}(t):rt(30097,{filter:t})}function NO(t){return yO[t]}function FO(t){return EO[t]}function PO(t){return TO[t]}function Xl(t){return{fieldPath:t.canonicalString()}}function Wl(t){return Zr.fromServerFormat(t.fieldPath)}function dw(t){return t instanceof Nr?function(r){if(r.op==="=="){if(NE(r.value))return{unaryFilter:{field:Xl(r.field),op:"IS_NAN"}};if(OE(r.value))return{unaryFilter:{field:Xl(r.field),op:"IS_NULL"}}}else if(r.op==="!="){if(NE(r.value))return{unaryFilter:{field:Xl(r.field),op:"IS_NOT_NAN"}};if(OE(r.value))return{unaryFilter:{field:Xl(r.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Xl(r.field),op:FO(r.op),value:r.value}}}(t):t instanceof ii?function(r){const n=r.getFilters().map(i=>dw(i));return n.length===1?n[0]:{compositeFilter:{op:PO(r.op),filters:n}}}(t):rt(54877,{filter:t})}function MO(t){const e=[];return t.fields.forEach(r=>e.push(r.canonicalString())),{fieldPaths:e}}function pw(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ss{constructor(e,r,n,i,o=lt.min(),c=lt.min(),u=rn.EMPTY_BYTE_STRING,h=null){this.target=e,this.targetId=r,this.purpose=n,this.sequenceNumber=i,this.snapshotVersion=o,this.lastLimboFreeSnapshotVersion=c,this.resumeToken=u,this.expectedCount=h}withSequenceNumber(e){return new Ss(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,r){return new Ss(this.target,this.targetId,this.purpose,this.sequenceNumber,r,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Ss(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Ss(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LO{constructor(e){this.gt=e}}function VO(t){const e=DO({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?Eg(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UO{constructor(){this.Dn=new BO}addToCollectionParentIndex(e,r){return this.Dn.add(r),ke.resolve()}getCollectionParents(e,r){return ke.resolve(this.Dn.getEntries(r))}addFieldIndex(e,r){return ke.resolve()}deleteFieldIndex(e,r){return ke.resolve()}deleteAllFieldIndexes(e){return ke.resolve()}createTargetIndexes(e,r){return ke.resolve()}getDocumentsMatchingTarget(e,r){return ke.resolve(null)}getIndexType(e,r){return ke.resolve(0)}getFieldIndexes(e,r){return ke.resolve([])}getNextCollectionGroupToUpdate(e){return ke.resolve(null)}getMinOffset(e,r){return ke.resolve(Ls.min())}getMinOffsetFromCollectionGroup(e,r){return ke.resolve(Ls.min())}updateCollectionGroup(e,r,n){return ke.resolve()}updateIndexEntries(e,r){return ke.resolve()}}class BO{constructor(){this.index={}}add(e){const r=e.lastSegment(),n=e.popLast(),i=this.index[r]||new Pr(tr.comparator),o=!i.has(n);return this.index[r]=i.add(n),o}has(e){const r=e.lastSegment(),n=e.popLast(),i=this.index[r];return i&&i.has(n)}getEntries(e){return(this.index[e]||new Pr(tr.comparator)).toArray()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const XE={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},mw=41943040;class Nn{static withCacheSize(e){return new Nn(e,Nn.DEFAULT_COLLECTION_PERCENTILE,Nn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,r,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=r,this.maximumSequenceNumbersToCollect=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Nn.DEFAULT_COLLECTION_PERCENTILE=10,Nn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Nn.DEFAULT=new Nn(mw,Nn.DEFAULT_COLLECTION_PERCENTILE,Nn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Nn.DISABLED=new Nn(-1,0,0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uc{constructor(e){this._r=e}next(){return this._r+=2,this._r}static ar(){return new uc(0)}static ur(){return new uc(-1)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WE="LruGarbageCollector",jO=1048576;function YE([t,e],[r,n]){const i=mt(t,r);return i===0?mt(e,n):i}class zO{constructor(e){this.Tr=e,this.buffer=new Pr(YE),this.Ir=0}dr(){return++this.Ir}Er(e){const r=[e,this.dr()];if(this.buffer.size<this.Tr)this.buffer=this.buffer.add(r);else{const n=this.buffer.last();YE(r,n)<0&&(this.buffer=this.buffer.delete(n).add(r))}}get maxValue(){return this.buffer.last()[0]}}class HO{constructor(e,r,n){this.garbageCollector=e,this.asyncQueue=r,this.localStore=n,this.Ar=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Rr(6e4)}stop(){this.Ar&&(this.Ar.cancel(),this.Ar=null)}get started(){return this.Ar!==null}Rr(e){He(WE,`Garbage collection scheduled in ${e}ms`),this.Ar=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Ar=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(r){yc(r)?He(WE,"Ignoring IndexedDB error during garbage collection: ",r):await xc(r)}await this.Rr(3e5)})}}class GO{constructor(e,r){this.Vr=e,this.params=r}calculateTargetCount(e,r){return this.Vr.mr(e).next(n=>Math.floor(r/100*n))}nthSequenceNumber(e,r){if(r===0)return ke.resolve(sd.ue);const n=new zO(r);return this.Vr.forEachTarget(e,i=>n.Er(i.sequenceNumber)).next(()=>this.Vr.gr(e,i=>n.Er(i))).next(()=>n.maxValue)}removeTargets(e,r,n){return this.Vr.removeTargets(e,r,n)}removeOrphanedDocuments(e,r){return this.Vr.removeOrphanedDocuments(e,r)}collect(e,r){return this.params.cacheSizeCollectionThreshold===-1?(He("LruGarbageCollector","Garbage collection skipped; disabled"),ke.resolve(XE)):this.getCacheSize(e).next(n=>n<this.params.cacheSizeCollectionThreshold?(He("LruGarbageCollector",`Garbage collection skipped; Cache size ${n} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),XE):this.pr(e,r))}getCacheSize(e){return this.Vr.getCacheSize(e)}pr(e,r){let n,i,o,c,u,h,d;const g=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(_=>(_>this.params.maximumSequenceNumbersToCollect?(He("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${_}`),i=this.params.maximumSequenceNumbersToCollect):i=_,c=Date.now(),this.nthSequenceNumber(e,i))).next(_=>(n=_,u=Date.now(),this.removeTargets(e,n,r))).next(_=>(o=_,h=Date.now(),this.removeOrphanedDocuments(e,n))).next(_=>(d=Date.now(),ql()<=Tt.DEBUG&&He("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${c-g}ms
	Determined least recently used ${i} in `+(u-c)+`ms
	Removed ${o} targets in `+(h-u)+`ms
	Removed ${_} documents in `+(d-h)+`ms
Total Duration: ${d-g}ms`),ke.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:o,documentsRemoved:_})))}}function qO(t,e){return new GO(t,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KO{constructor(){this.changes=new Xo(e=>e.toString(),(e,r)=>e.isEqual(r)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,r){this.assertNotApplied(),this.changes.set(e,un.newInvalidDocument(e).setReadTime(r))}getEntry(e,r){this.assertNotApplied();const n=this.changes.get(r);return n!==void 0?ke.resolve(n):this.getFromCache(e,r)}getEntries(e,r){return this.getAllFromCache(e,r)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XO{constructor(e,r){this.overlayedDocument=e,this.mutatedFields=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WO{constructor(e,r,n,i){this.remoteDocumentCache=e,this.mutationQueue=r,this.documentOverlayCache=n,this.indexManager=i}getDocument(e,r){let n=null;return this.documentOverlayCache.getOverlay(e,r).next(i=>(n=i,this.remoteDocumentCache.getEntry(e,r))).next(i=>(n!==null&&Vu(n.mutation,i,Kn.empty(),Gt.now()),i))}getDocuments(e,r){return this.remoteDocumentCache.getEntries(e,r).next(n=>this.getLocalViewOfDocuments(e,n,At()).next(()=>n))}getLocalViewOfDocuments(e,r,n=At()){const i=Do();return this.populateOverlays(e,i,r).next(()=>this.computeViews(e,r,i,n).next(o=>{let c=Cu();return o.forEach((u,h)=>{c=c.insert(u,h.overlayedDocument)}),c}))}getOverlayedDocuments(e,r){const n=Do();return this.populateOverlays(e,n,r).next(()=>this.computeViews(e,r,n,At()))}populateOverlays(e,r,n){const i=[];return n.forEach(o=>{r.has(o)||i.push(o)}),this.documentOverlayCache.getOverlays(e,i).next(o=>{o.forEach((c,u)=>{r.set(c,u)})})}computeViews(e,r,n,i){let o=Bi();const c=Lu(),u=function(){return Lu()}();return r.forEach((h,d)=>{const g=n.get(d.key);i.has(d.key)&&(g===void 0||g.mutation instanceof Qs)?o=o.insert(d.key,d):g!==void 0?(c.set(d.key,g.mutation.getFieldMask()),Vu(g.mutation,d,g.mutation.getFieldMask(),Gt.now())):c.set(d.key,Kn.empty())}),this.recalculateAndSaveOverlays(e,o).next(h=>(h.forEach((d,g)=>c.set(d,g)),r.forEach((d,g)=>{var _;return u.set(d,new XO(g,(_=c.get(d))!==null&&_!==void 0?_:null))}),u))}recalculateAndSaveOverlays(e,r){const n=Lu();let i=new or((c,u)=>c-u),o=At();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,r).next(c=>{for(const u of c)u.keys().forEach(h=>{const d=r.get(h);if(d===null)return;let g=n.get(h)||Kn.empty();g=u.applyToLocalView(d,g),n.set(h,g);const _=(i.get(u.batchId)||At()).add(h);i=i.insert(u.batchId,_)})}).next(()=>{const c=[],u=i.getReverseIterator();for(;u.hasNext();){const h=u.getNext(),d=h.key,g=h.value,_=QA();g.forEach(x=>{if(!o.has(x)){const A=nw(r.get(x),n.get(x));A!==null&&_.set(x,A),o=o.add(x)}}),c.push(this.documentOverlayCache.saveOverlays(e,d,_))}return ke.waitFor(c)}).next(()=>n)}recalculateAndSaveOverlaysForDocumentKeys(e,r){return this.remoteDocumentCache.getEntries(e,r).next(n=>this.recalculateAndSaveOverlays(e,n))}getDocumentsMatchingQuery(e,r,n,i){return function(c){return $e.isDocumentKey(c.path)&&c.collectionGroup===null&&c.filters.length===0}(r)?this.getDocumentsMatchingDocumentQuery(e,r.path):QD(r)?this.getDocumentsMatchingCollectionGroupQuery(e,r,n,i):this.getDocumentsMatchingCollectionQuery(e,r,n,i)}getNextDocuments(e,r,n,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,r,n,i).next(o=>{const c=i-o.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,r,n.largestBatchId,i-o.size):ke.resolve(Do());let u=Ju,h=o;return c.next(d=>ke.forEach(d,(g,_)=>(u<_.largestBatchId&&(u=_.largestBatchId),o.get(g)?ke.resolve():this.remoteDocumentCache.getEntry(e,g).next(x=>{h=h.insert(g,x)}))).next(()=>this.populateOverlays(e,d,o)).next(()=>this.computeViews(e,h,d,At())).next(g=>({batchId:u,changes:$A(g)})))})}getDocumentsMatchingDocumentQuery(e,r){return this.getDocument(e,new $e(r)).next(n=>{let i=Cu();return n.isFoundDocument()&&(i=i.insert(n.key,n)),i})}getDocumentsMatchingCollectionGroupQuery(e,r,n,i){const o=r.collectionGroup;let c=Cu();return this.indexManager.getCollectionParents(e,o).next(u=>ke.forEach(u,h=>{const d=function(_,x){return new cd(x,null,_.explicitOrderBy.slice(),_.filters.slice(),_.limit,_.limitType,_.startAt,_.endAt)}(r,h.child(o));return this.getDocumentsMatchingCollectionQuery(e,d,n,i).next(g=>{g.forEach((_,x)=>{c=c.insert(_,x)})})}).next(()=>c))}getDocumentsMatchingCollectionQuery(e,r,n,i){let o;return this.documentOverlayCache.getOverlaysForCollection(e,r.path,n.largestBatchId).next(c=>(o=c,this.remoteDocumentCache.getDocumentsMatchingQuery(e,r,n,o,i))).next(c=>{o.forEach((h,d)=>{const g=d.getKey();c.get(g)===null&&(c=c.insert(g,un.newInvalidDocument(g)))});let u=Cu();return c.forEach((h,d)=>{const g=o.get(h);g!==void 0&&Vu(g.mutation,d,Kn.empty(),Gt.now()),fd(r,d)&&(u=u.insert(h,d))}),u})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YO{constructor(e){this.serializer=e,this.Br=new Map,this.Lr=new Map}getBundleMetadata(e,r){return ke.resolve(this.Br.get(r))}saveBundleMetadata(e,r){return this.Br.set(r.id,function(i){return{id:i.id,version:i.version,createTime:ti(i.createTime)}}(r)),ke.resolve()}getNamedQuery(e,r){return ke.resolve(this.Lr.get(r))}saveNamedQuery(e,r){return this.Lr.set(r.name,function(i){return{name:i.name,query:VO(i.bundledQuery),readTime:ti(i.readTime)}}(r)),ke.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $O{constructor(){this.overlays=new or($e.comparator),this.kr=new Map}getOverlay(e,r){return ke.resolve(this.overlays.get(r))}getOverlays(e,r){const n=Do();return ke.forEach(r,i=>this.getOverlay(e,i).next(o=>{o!==null&&n.set(i,o)})).next(()=>n)}saveOverlays(e,r,n){return n.forEach((i,o)=>{this.wt(e,r,o)}),ke.resolve()}removeOverlaysForBatchId(e,r,n){const i=this.kr.get(n);return i!==void 0&&(i.forEach(o=>this.overlays=this.overlays.remove(o)),this.kr.delete(n)),ke.resolve()}getOverlaysForCollection(e,r,n){const i=Do(),o=r.length+1,c=new $e(r.child("")),u=this.overlays.getIteratorFrom(c);for(;u.hasNext();){const h=u.getNext().value,d=h.getKey();if(!r.isPrefixOf(d.path))break;d.path.length===o&&h.largestBatchId>n&&i.set(h.getKey(),h)}return ke.resolve(i)}getOverlaysForCollectionGroup(e,r,n,i){let o=new or((d,g)=>d-g);const c=this.overlays.getIterator();for(;c.hasNext();){const d=c.getNext().value;if(d.getKey().getCollectionGroup()===r&&d.largestBatchId>n){let g=o.get(d.largestBatchId);g===null&&(g=Do(),o=o.insert(d.largestBatchId,g)),g.set(d.getKey(),d)}}const u=Do(),h=o.getIterator();for(;h.hasNext()&&(h.getNext().value.forEach((d,g)=>u.set(d,g)),!(u.size()>=i)););return ke.resolve(u)}wt(e,r,n){const i=this.overlays.get(n.key);if(i!==null){const c=this.kr.get(i.largestBatchId).delete(n.key);this.kr.set(i.largestBatchId,c)}this.overlays=this.overlays.insert(n.key,new mO(r,n));let o=this.kr.get(r);o===void 0&&(o=At(),this.kr.set(r,o)),this.kr.set(r,o.add(n.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QO{constructor(){this.sessionToken=rn.EMPTY_BYTE_STRING}getSessionToken(e){return ke.resolve(this.sessionToken)}setSessionToken(e,r){return this.sessionToken=r,ke.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class w1{constructor(){this.qr=new Pr(Hr.Qr),this.$r=new Pr(Hr.Ur)}isEmpty(){return this.qr.isEmpty()}addReference(e,r){const n=new Hr(e,r);this.qr=this.qr.add(n),this.$r=this.$r.add(n)}Kr(e,r){e.forEach(n=>this.addReference(n,r))}removeReference(e,r){this.Wr(new Hr(e,r))}Gr(e,r){e.forEach(n=>this.removeReference(n,r))}zr(e){const r=new $e(new tr([])),n=new Hr(r,e),i=new Hr(r,e+1),o=[];return this.$r.forEachInRange([n,i],c=>{this.Wr(c),o.push(c.key)}),o}jr(){this.qr.forEach(e=>this.Wr(e))}Wr(e){this.qr=this.qr.delete(e),this.$r=this.$r.delete(e)}Jr(e){const r=new $e(new tr([])),n=new Hr(r,e),i=new Hr(r,e+1);let o=At();return this.$r.forEachInRange([n,i],c=>{o=o.add(c.key)}),o}containsKey(e){const r=new Hr(e,0),n=this.qr.firstAfterOrEqual(r);return n!==null&&e.isEqual(n.key)}}class Hr{constructor(e,r){this.key=e,this.Hr=r}static Qr(e,r){return $e.comparator(e.key,r.key)||mt(e.Hr,r.Hr)}static Ur(e,r){return mt(e.Hr,r.Hr)||$e.comparator(e.key,r.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZO{constructor(e,r){this.indexManager=e,this.referenceDelegate=r,this.mutationQueue=[],this.er=1,this.Yr=new Pr(Hr.Qr)}checkEmpty(e){return ke.resolve(this.mutationQueue.length===0)}addMutationBatch(e,r,n,i){const o=this.er;this.er++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const c=new pO(o,r,n,i);this.mutationQueue.push(c);for(const u of i)this.Yr=this.Yr.add(new Hr(u.key,o)),this.indexManager.addToCollectionParentIndex(e,u.key.path.popLast());return ke.resolve(c)}lookupMutationBatch(e,r){return ke.resolve(this.Zr(r))}getNextMutationBatchAfterBatchId(e,r){const n=r+1,i=this.Xr(n),o=i<0?0:i;return ke.resolve(this.mutationQueue.length>o?this.mutationQueue[o]:null)}getHighestUnacknowledgedBatchId(){return ke.resolve(this.mutationQueue.length===0?d1:this.er-1)}getAllMutationBatches(e){return ke.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,r){const n=new Hr(r,0),i=new Hr(r,Number.POSITIVE_INFINITY),o=[];return this.Yr.forEachInRange([n,i],c=>{const u=this.Zr(c.Hr);o.push(u)}),ke.resolve(o)}getAllMutationBatchesAffectingDocumentKeys(e,r){let n=new Pr(mt);return r.forEach(i=>{const o=new Hr(i,0),c=new Hr(i,Number.POSITIVE_INFINITY);this.Yr.forEachInRange([o,c],u=>{n=n.add(u.Hr)})}),ke.resolve(this.ei(n))}getAllMutationBatchesAffectingQuery(e,r){const n=r.path,i=n.length+1;let o=n;$e.isDocumentKey(o)||(o=o.child(""));const c=new Hr(new $e(o),0);let u=new Pr(mt);return this.Yr.forEachWhile(h=>{const d=h.key.path;return!!n.isPrefixOf(d)&&(d.length===i&&(u=u.add(h.Hr)),!0)},c),ke.resolve(this.ei(u))}ei(e){const r=[];return e.forEach(n=>{const i=this.Zr(n);i!==null&&r.push(i)}),r}removeMutationBatch(e,r){jt(this.ti(r.batchId,"removed")===0,55003),this.mutationQueue.shift();let n=this.Yr;return ke.forEach(r.mutations,i=>{const o=new Hr(i.key,r.batchId);return n=n.delete(o),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.Yr=n})}rr(e){}containsKey(e,r){const n=new Hr(r,0),i=this.Yr.firstAfterOrEqual(n);return ke.resolve(r.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,ke.resolve()}ti(e,r){return this.Xr(e)}Xr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Zr(e){const r=this.Xr(e);return r<0||r>=this.mutationQueue.length?null:this.mutationQueue[r]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JO{constructor(e){this.ni=e,this.docs=function(){return new or($e.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,r){const n=r.key,i=this.docs.get(n),o=i?i.size:0,c=this.ni(r);return this.docs=this.docs.insert(n,{document:r.mutableCopy(),size:c}),this.size+=c-o,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const r=this.docs.get(e);r&&(this.docs=this.docs.remove(e),this.size-=r.size)}getEntry(e,r){const n=this.docs.get(r);return ke.resolve(n?n.document.mutableCopy():un.newInvalidDocument(r))}getEntries(e,r){let n=Bi();return r.forEach(i=>{const o=this.docs.get(i);n=n.insert(i,o?o.document.mutableCopy():un.newInvalidDocument(i))}),ke.resolve(n)}getDocumentsMatchingQuery(e,r,n,i){let o=Bi();const c=r.path,u=new $e(c.child("__id-9223372036854775808__")),h=this.docs.getIteratorFrom(u);for(;h.hasNext();){const{key:d,value:{document:g}}=h.getNext();if(!c.isPrefixOf(d.path))break;d.path.length>c.length+1||kD(RD(g),n)<=0||(i.has(g.key)||fd(r,g))&&(o=o.insert(g.key,g.mutableCopy()))}return ke.resolve(o)}getAllFromCollectionGroup(e,r,n,i){rt(9500)}ri(e,r){return ke.forEach(this.docs,n=>r(n))}newChangeBuffer(e){return new e6(this)}getSize(e){return ke.resolve(this.size)}}class e6 extends KO{constructor(e){super(),this.Or=e}applyChanges(e){const r=[];return this.changes.forEach((n,i)=>{i.isValidDocument()?r.push(this.Or.addEntry(e,i)):this.Or.removeEntry(n)}),ke.waitFor(r)}getFromCache(e,r){return this.Or.getEntry(e,r)}getAllFromCache(e,r){return this.Or.getEntries(e,r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class t6{constructor(e){this.persistence=e,this.ii=new Xo(r=>g1(r),v1),this.lastRemoteSnapshotVersion=lt.min(),this.highestTargetId=0,this.si=0,this.oi=new w1,this.targetCount=0,this._i=uc.ar()}forEachTarget(e,r){return this.ii.forEach((n,i)=>r(i)),ke.resolve()}getLastRemoteSnapshotVersion(e){return ke.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return ke.resolve(this.si)}allocateTargetId(e){return this.highestTargetId=this._i.next(),ke.resolve(this.highestTargetId)}setTargetsMetadata(e,r,n){return n&&(this.lastRemoteSnapshotVersion=n),r>this.si&&(this.si=r),ke.resolve()}hr(e){this.ii.set(e.target,e);const r=e.targetId;r>this.highestTargetId&&(this._i=new uc(r),this.highestTargetId=r),e.sequenceNumber>this.si&&(this.si=e.sequenceNumber)}addTargetData(e,r){return this.hr(r),this.targetCount+=1,ke.resolve()}updateTargetData(e,r){return this.hr(r),ke.resolve()}removeTargetData(e,r){return this.ii.delete(r.target),this.oi.zr(r.targetId),this.targetCount-=1,ke.resolve()}removeTargets(e,r,n){let i=0;const o=[];return this.ii.forEach((c,u)=>{u.sequenceNumber<=r&&n.get(u.targetId)===null&&(this.ii.delete(c),o.push(this.removeMatchingKeysForTargetId(e,u.targetId)),i++)}),ke.waitFor(o).next(()=>i)}getTargetCount(e){return ke.resolve(this.targetCount)}getTargetData(e,r){const n=this.ii.get(r)||null;return ke.resolve(n)}addMatchingKeys(e,r,n){return this.oi.Kr(r,n),ke.resolve()}removeMatchingKeys(e,r,n){this.oi.Gr(r,n);const i=this.persistence.referenceDelegate,o=[];return i&&r.forEach(c=>{o.push(i.markPotentiallyOrphaned(e,c))}),ke.waitFor(o)}removeMatchingKeysForTargetId(e,r){return this.oi.zr(r),ke.resolve()}getMatchingKeysForTargetId(e,r){const n=this.oi.Jr(r);return ke.resolve(n)}containsKey(e,r){return ke.resolve(this.oi.containsKey(r))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gw{constructor(e,r){this.ai={},this.overlays={},this.ui=new sd(0),this.ci=!1,this.ci=!0,this.li=new QO,this.referenceDelegate=e(this),this.hi=new t6(this),this.indexManager=new UO,this.remoteDocumentCache=function(i){return new JO(i)}(n=>this.referenceDelegate.Pi(n)),this.serializer=new LO(r),this.Ti=new YO(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.ci=!1,Promise.resolve()}get started(){return this.ci}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let r=this.overlays[e.toKey()];return r||(r=new $O,this.overlays[e.toKey()]=r),r}getMutationQueue(e,r){let n=this.ai[e.toKey()];return n||(n=new ZO(r,this.referenceDelegate),this.ai[e.toKey()]=n),n}getGlobalsCache(){return this.li}getTargetCache(){return this.hi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ti}runTransaction(e,r,n){He("MemoryPersistence","Starting transaction:",e);const i=new r6(this.ui.next());return this.referenceDelegate.Ii(),n(i).next(o=>this.referenceDelegate.di(i).next(()=>o)).toPromise().then(o=>(i.raiseOnCommittedEvent(),o))}Ei(e,r){return ke.or(Object.values(this.ai).map(n=>()=>n.containsKey(e,r)))}}class r6 extends ID{constructor(e){super(),this.currentSequenceNumber=e}}class S1{constructor(e){this.persistence=e,this.Ai=new w1,this.Ri=null}static Vi(e){return new S1(e)}get mi(){if(this.Ri)return this.Ri;throw rt(60996)}addReference(e,r,n){return this.Ai.addReference(n,r),this.mi.delete(n.toString()),ke.resolve()}removeReference(e,r,n){return this.Ai.removeReference(n,r),this.mi.add(n.toString()),ke.resolve()}markPotentiallyOrphaned(e,r){return this.mi.add(r.toString()),ke.resolve()}removeTarget(e,r){this.Ai.zr(r.targetId).forEach(i=>this.mi.add(i.toString()));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,r.targetId).next(i=>{i.forEach(o=>this.mi.add(o.toString()))}).next(()=>n.removeTargetData(e,r))}Ii(){this.Ri=new Set}di(e){const r=this.persistence.getRemoteDocumentCache().newChangeBuffer();return ke.forEach(this.mi,n=>{const i=$e.fromPath(n);return this.fi(e,i).next(o=>{o||r.removeEntry(i,lt.min())})}).next(()=>(this.Ri=null,r.apply(e)))}updateLimboDocument(e,r){return this.fi(e,r).next(n=>{n?this.mi.delete(r.toString()):this.mi.add(r.toString())})}Pi(e){return 0}fi(e,r){return ke.or([()=>ke.resolve(this.Ai.containsKey(r)),()=>this.persistence.getTargetCache().containsKey(e,r),()=>this.persistence.Ei(e,r)])}}class U0{constructor(e,r){this.persistence=e,this.gi=new Xo(n=>ND(n.path),(n,i)=>n.isEqual(i)),this.garbageCollector=qO(this,r)}static Vi(e,r){return new U0(e,r)}Ii(){}di(e){return ke.resolve()}forEachTarget(e,r){return this.persistence.getTargetCache().forEachTarget(e,r)}mr(e){const r=this.yr(e);return this.persistence.getTargetCache().getTargetCount(e).next(n=>r.next(i=>n+i))}yr(e){let r=0;return this.gr(e,n=>{r++}).next(()=>r)}gr(e,r){return ke.forEach(this.gi,(n,i)=>this.Sr(e,n,i).next(o=>o?ke.resolve():r(i)))}removeTargets(e,r,n){return this.persistence.getTargetCache().removeTargets(e,r,n)}removeOrphanedDocuments(e,r){let n=0;const i=this.persistence.getRemoteDocumentCache(),o=i.newChangeBuffer();return i.ri(e,c=>this.Sr(e,c,r).next(u=>{u||(n++,o.removeEntry(c,lt.min()))})).next(()=>o.apply(e)).next(()=>n)}markPotentiallyOrphaned(e,r){return this.gi.set(r,e.currentSequenceNumber),ke.resolve()}removeTarget(e,r){const n=r.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,n)}addReference(e,r,n){return this.gi.set(n,e.currentSequenceNumber),ke.resolve()}removeReference(e,r,n){return this.gi.set(n,e.currentSequenceNumber),ke.resolve()}updateLimboDocument(e,r){return this.gi.set(r,e.currentSequenceNumber),ke.resolve()}Pi(e){let r=e.key.toString().length;return e.isFoundDocument()&&(r+=g0(e.data.value)),r}Sr(e,r,n){return ke.or([()=>this.persistence.Ei(e,r),()=>this.persistence.getTargetCache().containsKey(e,r),()=>{const i=this.gi.get(r);return ke.resolve(i!==void 0&&i>n)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class C1{constructor(e,r,n,i){this.targetId=e,this.fromCache=r,this.Is=n,this.ds=i}static Es(e,r){let n=At(),i=At();for(const o of r.docChanges)switch(o.type){case 0:n=n.add(o.doc.key);break;case 1:i=i.add(o.doc.key)}return new C1(e,r.fromCache,n,i)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class n6{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class a6{constructor(){this.As=!1,this.Rs=!1,this.Vs=100,this.fs=function(){return Lk()?8:DD(pn())>0?6:4}()}initialize(e,r){this.gs=e,this.indexManager=r,this.As=!0}getDocumentsMatchingQuery(e,r,n,i){const o={result:null};return this.ps(e,r).next(c=>{o.result=c}).next(()=>{if(!o.result)return this.ys(e,r,i,n).next(c=>{o.result=c})}).next(()=>{if(o.result)return;const c=new n6;return this.ws(e,r,c).next(u=>{if(o.result=u,this.Rs)return this.Ss(e,r,c,u.size)})}).next(()=>o.result)}Ss(e,r,n,i){return n.documentReadCount<this.Vs?(ql()<=Tt.DEBUG&&He("QueryEngine","SDK will not create cache indexes for query:",Kl(r),"since it only creates cache indexes for collection contains","more than or equal to",this.Vs,"documents"),ke.resolve()):(ql()<=Tt.DEBUG&&He("QueryEngine","Query:",Kl(r),"scans",n.documentReadCount,"local documents and returns",i,"documents as results."),n.documentReadCount>this.fs*i?(ql()<=Tt.DEBUG&&He("QueryEngine","The SDK decides to create cache indexes for query:",Kl(r),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,ei(r))):ke.resolve())}ps(e,r){if(LE(r))return ke.resolve(null);let n=ei(r);return this.indexManager.getIndexType(e,n).next(i=>i===0?null:(r.limit!==null&&i===1&&(r=Eg(r,null,"F"),n=ei(r)),this.indexManager.getDocumentsMatchingTarget(e,n).next(o=>{const c=At(...o);return this.gs.getDocuments(e,c).next(u=>this.indexManager.getMinOffset(e,n).next(h=>{const d=this.bs(r,u);return this.Ds(r,d,c,h.readTime)?this.ps(e,Eg(r,null,"F")):this.vs(e,d,r,h)}))})))}ys(e,r,n,i){return LE(r)||i.isEqual(lt.min())?ke.resolve(null):this.gs.getDocuments(e,n).next(o=>{const c=this.bs(r,o);return this.Ds(r,c,n,i)?ke.resolve(null):(ql()<=Tt.DEBUG&&He("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),Kl(r)),this.vs(e,c,r,CD(i,Ju)).next(u=>u))})}bs(e,r){let n=new Pr(WA(e));return r.forEach((i,o)=>{fd(e,o)&&(n=n.add(o))}),n}Ds(e,r,n,i){if(e.limit===null)return!1;if(n.size!==r.size)return!0;const o=e.limitType==="F"?r.last():r.first();return!!o&&(o.hasPendingWrites||o.version.compareTo(i)>0)}ws(e,r,n){return ql()<=Tt.DEBUG&&He("QueryEngine","Using full collection scan to execute query:",Kl(r)),this.gs.getDocumentsMatchingQuery(e,r,Ls.min(),n)}vs(e,r,n,i){return this.gs.getDocumentsMatchingQuery(e,n,i).next(o=>(r.forEach(c=>{o=o.insert(c.key,c)}),o))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const R1="LocalStore",i6=3e8;class s6{constructor(e,r,n,i){this.persistence=e,this.Cs=r,this.serializer=i,this.Fs=new or(mt),this.Ms=new Xo(o=>g1(o),v1),this.xs=new Map,this.Os=e.getRemoteDocumentCache(),this.hi=e.getTargetCache(),this.Ti=e.getBundleCache(),this.Ns(n)}Ns(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new WO(this.Os,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Os.setIndexManager(this.indexManager),this.Cs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",r=>e.collect(r,this.Fs))}}function o6(t,e,r,n){return new s6(t,e,r,n)}async function vw(t,e){const r=ct(t);return await r.persistence.runTransaction("Handle user change","readonly",n=>{let i;return r.mutationQueue.getAllMutationBatches(n).next(o=>(i=o,r.Ns(e),r.mutationQueue.getAllMutationBatches(n))).next(o=>{const c=[],u=[];let h=At();for(const d of i){c.push(d.batchId);for(const g of d.mutations)h=h.add(g.key)}for(const d of o){u.push(d.batchId);for(const g of d.mutations)h=h.add(g.key)}return r.localDocuments.getDocuments(n,h).next(d=>({Bs:d,removedBatchIds:c,addedBatchIds:u}))})})}function l6(t,e){const r=ct(t);return r.persistence.runTransaction("Acknowledge batch","readwrite-primary",n=>{const i=e.batch.keys(),o=r.Os.newChangeBuffer({trackRemovals:!0});return function(u,h,d,g){const _=d.batch,x=_.keys();let A=ke.resolve();return x.forEach(w=>{A=A.next(()=>g.getEntry(h,w)).next(S=>{const C=d.docVersions.get(w);jt(C!==null,48541),S.version.compareTo(C)<0&&(_.applyToRemoteDocument(S,d),S.isValidDocument()&&(S.setReadTime(d.commitVersion),g.addEntry(S)))})}),A.next(()=>u.mutationQueue.removeMutationBatch(h,_))}(r,n,e,o).next(()=>o.apply(n)).next(()=>r.mutationQueue.performConsistencyCheck(n)).next(()=>r.documentOverlayCache.removeOverlaysForBatchId(n,i,e.batch.batchId)).next(()=>r.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(n,function(u){let h=At();for(let d=0;d<u.mutationResults.length;++d)u.mutationResults[d].transformResults.length>0&&(h=h.add(u.batch.mutations[d].key));return h}(e))).next(()=>r.localDocuments.getDocuments(n,i))})}function _w(t){const e=ct(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",r=>e.hi.getLastRemoteSnapshotVersion(r))}function c6(t,e){const r=ct(t),n=e.snapshotVersion;let i=r.Fs;return r.persistence.runTransaction("Apply remote event","readwrite-primary",o=>{const c=r.Os.newChangeBuffer({trackRemovals:!0});i=r.Fs;const u=[];e.targetChanges.forEach((g,_)=>{const x=i.get(_);if(!x)return;u.push(r.hi.removeMatchingKeys(o,g.removedDocuments,_).next(()=>r.hi.addMatchingKeys(o,g.addedDocuments,_)));let A=x.withSequenceNumber(o.currentSequenceNumber);e.targetMismatches.get(_)!==null?A=A.withResumeToken(rn.EMPTY_BYTE_STRING,lt.min()).withLastLimboFreeSnapshotVersion(lt.min()):g.resumeToken.approximateByteSize()>0&&(A=A.withResumeToken(g.resumeToken,n)),i=i.insert(_,A),function(S,C,z){return S.resumeToken.approximateByteSize()===0||C.snapshotVersion.toMicroseconds()-S.snapshotVersion.toMicroseconds()>=i6?!0:z.addedDocuments.size+z.modifiedDocuments.size+z.removedDocuments.size>0}(x,A,g)&&u.push(r.hi.updateTargetData(o,A))});let h=Bi(),d=At();if(e.documentUpdates.forEach(g=>{e.resolvedLimboDocuments.has(g)&&u.push(r.persistence.referenceDelegate.updateLimboDocument(o,g))}),u.push(u6(o,c,e.documentUpdates).next(g=>{h=g.Ls,d=g.ks})),!n.isEqual(lt.min())){const g=r.hi.getLastRemoteSnapshotVersion(o).next(_=>r.hi.setTargetsMetadata(o,o.currentSequenceNumber,n));u.push(g)}return ke.waitFor(u).next(()=>c.apply(o)).next(()=>r.localDocuments.getLocalViewOfDocuments(o,h,d)).next(()=>h)}).then(o=>(r.Fs=i,o))}function u6(t,e,r){let n=At(),i=At();return r.forEach(o=>n=n.add(o)),e.getEntries(t,n).next(o=>{let c=Bi();return r.forEach((u,h)=>{const d=o.get(u);h.isFoundDocument()!==d.isFoundDocument()&&(i=i.add(u)),h.isNoDocument()&&h.version.isEqual(lt.min())?(e.removeEntry(u,h.readTime),c=c.insert(u,h)):!d.isValidDocument()||h.version.compareTo(d.version)>0||h.version.compareTo(d.version)===0&&d.hasPendingWrites?(e.addEntry(h),c=c.insert(u,h)):He(R1,"Ignoring outdated watch update for ",u,". Current version:",d.version," Watch version:",h.version)}),{Ls:c,ks:i}})}function f6(t,e){const r=ct(t);return r.persistence.runTransaction("Get next mutation batch","readonly",n=>(e===void 0&&(e=d1),r.mutationQueue.getNextMutationBatchAfterBatchId(n,e)))}function h6(t,e){const r=ct(t);return r.persistence.runTransaction("Allocate target","readwrite",n=>{let i;return r.hi.getTargetData(n,e).next(o=>o?(i=o,ke.resolve(i)):r.hi.allocateTargetId(n).next(c=>(i=new Ss(e,c,"TargetPurposeListen",n.currentSequenceNumber),r.hi.addTargetData(n,i).next(()=>i))))}).then(n=>{const i=r.Fs.get(n.targetId);return(i===null||n.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(r.Fs=r.Fs.insert(n.targetId,n),r.Ms.set(e,n.targetId)),n})}async function Cg(t,e,r){const n=ct(t),i=n.Fs.get(e),o=r?"readwrite":"readwrite-primary";try{r||await n.persistence.runTransaction("Release target",o,c=>n.persistence.referenceDelegate.removeTarget(c,i))}catch(c){if(!yc(c))throw c;He(R1,`Failed to update sequence numbers for target ${e}: ${c}`)}n.Fs=n.Fs.remove(e),n.Ms.delete(i.target)}function $E(t,e,r){const n=ct(t);let i=lt.min(),o=At();return n.persistence.runTransaction("Execute query","readwrite",c=>function(h,d,g){const _=ct(h),x=_.Ms.get(g);return x!==void 0?ke.resolve(_.Fs.get(x)):_.hi.getTargetData(d,g)}(n,c,ei(e)).next(u=>{if(u)return i=u.lastLimboFreeSnapshotVersion,n.hi.getMatchingKeysForTargetId(c,u.targetId).next(h=>{o=h})}).next(()=>n.Cs.getDocumentsMatchingQuery(c,e,r?i:lt.min(),r?o:At())).next(u=>(d6(n,JD(e),u),{documents:u,qs:o})))}function d6(t,e,r){let n=t.xs.get(e)||lt.min();r.forEach((i,o)=>{o.readTime.compareTo(n)>0&&(n=o.readTime)}),t.xs.set(e,n)}class QE{constructor(){this.activeTargetIds=iO()}Gs(e){this.activeTargetIds=this.activeTargetIds.add(e)}zs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Ws(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class p6{constructor(){this.Fo=new QE,this.Mo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,r,n){}addLocalQueryTarget(e,r=!0){return r&&this.Fo.Gs(e),this.Mo[e]||"not-current"}updateQueryState(e,r,n){this.Mo[e]=r}removeLocalQueryTarget(e){this.Fo.zs(e)}isLocalQueryTarget(e){return this.Fo.activeTargetIds.has(e)}clearQueryState(e){delete this.Mo[e]}getAllActiveQueryTargets(){return this.Fo.activeTargetIds}isActiveQueryTarget(e){return this.Fo.activeTargetIds.has(e)}start(){return this.Fo=new QE,Promise.resolve()}handleUserChange(e,r,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class m6{xo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ZE="ConnectivityMonitor";class JE{constructor(){this.Oo=()=>this.No(),this.Bo=()=>this.Lo(),this.ko=[],this.qo()}xo(e){this.ko.push(e)}shutdown(){window.removeEventListener("online",this.Oo),window.removeEventListener("offline",this.Bo)}qo(){window.addEventListener("online",this.Oo),window.addEventListener("offline",this.Bo)}No(){He(ZE,"Network connectivity changed: AVAILABLE");for(const e of this.ko)e(0)}Lo(){He(ZE,"Network connectivity changed: UNAVAILABLE");for(const e of this.ko)e(1)}static C(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Jh=null;function Rg(){return Jh===null?Jh=function(){return 268435456+Math.round(2147483648*Math.random())}():Jh++,"0x"+Jh.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qm="RestConnection",g6={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class v6{get Qo(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const r=e.ssl?"https":"http",n=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.$o=r+"://"+e.host,this.Uo=`projects/${n}/databases/${i}`,this.Ko=this.databaseId.database===O0?`project_id=${n}`:`project_id=${n}&database_id=${i}`}Wo(e,r,n,i,o){const c=Rg(),u=this.Go(e,r.toUriEncodedString());He(qm,`Sending RPC '${e}' ${c}:`,u,n);const h={"google-cloud-resource-prefix":this.Uo,"x-goog-request-params":this.Ko};this.zo(h,i,o);const{host:d}=new URL(u),g=mc(d);return this.jo(e,u,h,n,g).then(_=>(He(qm,`Received RPC '${e}' ${c}: `,_),_),_=>{throw Ms(qm,`RPC '${e}' ${c} failed with error: `,_,"url: ",u,"request:",n),_})}Jo(e,r,n,i,o,c){return this.Wo(e,r,n,i,o)}zo(e,r,n){e["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+_c}(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((i,o)=>e[o]=i),n&&n.headers.forEach((i,o)=>e[o]=i)}Go(e,r){const n=g6[e];return`${this.$o}/v1/${r}:${n}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _6{constructor(e){this.Ho=e.Ho,this.Yo=e.Yo}Zo(e){this.Xo=e}e_(e){this.t_=e}n_(e){this.r_=e}onMessage(e){this.i_=e}close(){this.Yo()}send(e){this.Ho(e)}s_(){this.Xo()}o_(){this.t_()}__(e){this.r_(e)}a_(e){this.i_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sn="WebChannelConnection";class x6 extends v6{constructor(e){super(e),this.u_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}jo(e,r,n,i,o){const c=Rg();return new Promise((u,h)=>{const d=new EA;d.setWithCredentials(!0),d.listenOnce(TA.COMPLETE,()=>{try{switch(d.getLastErrorCode()){case m0.NO_ERROR:const _=d.getResponseJson();He(sn,`XHR for RPC '${e}' ${c} received:`,JSON.stringify(_)),u(_);break;case m0.TIMEOUT:He(sn,`RPC '${e}' ${c} timed out`),h(new Xe(De.DEADLINE_EXCEEDED,"Request time out"));break;case m0.HTTP_ERROR:const x=d.getStatus();if(He(sn,`RPC '${e}' ${c} failed with status:`,x,"response text:",d.getResponseText()),x>0){let A=d.getResponseJson();Array.isArray(A)&&(A=A[0]);const w=A?.error;if(w&&w.status&&w.message){const S=function(z){const W=z.toLowerCase().replace(/_/g,"-");return Object.values(De).indexOf(W)>=0?W:De.UNKNOWN}(w.status);h(new Xe(S,w.message))}else h(new Xe(De.UNKNOWN,"Server responded with status "+d.getStatus()))}else h(new Xe(De.UNAVAILABLE,"Connection failed."));break;default:rt(9055,{c_:e,streamId:c,l_:d.getLastErrorCode(),h_:d.getLastError()})}}finally{He(sn,`RPC '${e}' ${c} completed.`)}});const g=JSON.stringify(i);He(sn,`RPC '${e}' ${c} sending request:`,i),d.send(r,"POST",g,n,15)})}P_(e,r,n){const i=Rg(),o=[this.$o,"/","google.firestore.v1.Firestore","/",e,"/channel"],c=SA(),u=wA(),h={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},d=this.longPollingOptions.timeoutSeconds;d!==void 0&&(h.longPollingTimeout=Math.round(1e3*d)),this.useFetchStreams&&(h.useFetchStreams=!0),this.zo(h.initMessageHeaders,r,n),h.encodeInitMessageHeaders=!0;const g=o.join("");He(sn,`Creating RPC '${e}' stream ${i}: ${g}`,h);const _=c.createWebChannel(g,h);this.T_(_);let x=!1,A=!1;const w=new _6({Ho:C=>{A?He(sn,`Not sending because RPC '${e}' stream ${i} is closed:`,C):(x||(He(sn,`Opening RPC '${e}' stream ${i} transport.`),_.open(),x=!0),He(sn,`RPC '${e}' stream ${i} sending:`,C),_.send(C))},Yo:()=>_.close()}),S=(C,z,W)=>{C.listen(z,P=>{try{W(P)}catch(re){setTimeout(()=>{throw re},0)}})};return S(_,Su.EventType.OPEN,()=>{A||(He(sn,`RPC '${e}' stream ${i} transport opened.`),w.s_())}),S(_,Su.EventType.CLOSE,()=>{A||(A=!0,He(sn,`RPC '${e}' stream ${i} transport closed`),w.__(),this.I_(_))}),S(_,Su.EventType.ERROR,C=>{A||(A=!0,Ms(sn,`RPC '${e}' stream ${i} transport errored. Name:`,C.name,"Message:",C.message),w.__(new Xe(De.UNAVAILABLE,"The operation could not be completed")))}),S(_,Su.EventType.MESSAGE,C=>{var z;if(!A){const W=C.data[0];jt(!!W,16349);const P=W,re=P?.error||((z=P[0])===null||z===void 0?void 0:z.error);if(re){He(sn,`RPC '${e}' stream ${i} received error:`,re);const Q=re.status;let ee=function(E){const I=Ar[E];if(I!==void 0)return iw(I)}(Q),k=re.message;ee===void 0&&(ee=De.INTERNAL,k="Unknown error status: "+Q+" with message "+re.message),A=!0,w.__(new Xe(ee,k)),_.close()}else He(sn,`RPC '${e}' stream ${i} received:`,W),w.a_(W)}}),S(u,AA.STAT_EVENT,C=>{C.stat===mg.PROXY?He(sn,`RPC '${e}' stream ${i} detected buffering proxy`):C.stat===mg.NOPROXY&&He(sn,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{w.o_()},0),w}terminate(){this.u_.forEach(e=>e.close()),this.u_=[]}T_(e){this.u_.push(e)}I_(e){this.u_=this.u_.filter(r=>r===e)}}function Km(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function md(t){return new AO(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xw{constructor(e,r,n=1e3,i=1.5,o=6e4){this.Fi=e,this.timerId=r,this.d_=n,this.E_=i,this.A_=o,this.R_=0,this.V_=null,this.m_=Date.now(),this.reset()}reset(){this.R_=0}f_(){this.R_=this.A_}g_(e){this.cancel();const r=Math.floor(this.R_+this.p_()),n=Math.max(0,Date.now()-this.m_),i=Math.max(0,r-n);i>0&&He("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.R_} ms, delay with jitter: ${r} ms, last attempt: ${n} ms ago)`),this.V_=this.Fi.enqueueAfterDelay(this.timerId,i,()=>(this.m_=Date.now(),e())),this.R_*=this.E_,this.R_<this.d_&&(this.R_=this.d_),this.R_>this.A_&&(this.R_=this.A_)}y_(){this.V_!==null&&(this.V_.skipDelay(),this.V_=null)}cancel(){this.V_!==null&&(this.V_.cancel(),this.V_=null)}p_(){return(Math.random()-.5)*this.R_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eT="PersistentStream";class yw{constructor(e,r,n,i,o,c,u,h){this.Fi=e,this.w_=n,this.S_=i,this.connection=o,this.authCredentialsProvider=c,this.appCheckCredentialsProvider=u,this.listener=h,this.state=0,this.b_=0,this.D_=null,this.v_=null,this.stream=null,this.C_=0,this.F_=new xw(e,r)}M_(){return this.state===1||this.state===5||this.x_()}x_(){return this.state===2||this.state===3}start(){this.C_=0,this.state!==4?this.auth():this.O_()}async stop(){this.M_()&&await this.close(0)}N_(){this.state=0,this.F_.reset()}B_(){this.x_()&&this.D_===null&&(this.D_=this.Fi.enqueueAfterDelay(this.w_,6e4,()=>this.L_()))}k_(e){this.q_(),this.stream.send(e)}async L_(){if(this.x_())return this.close(0)}q_(){this.D_&&(this.D_.cancel(),this.D_=null)}Q_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,r){this.q_(),this.Q_(),this.F_.cancel(),this.b_++,e!==4?this.F_.reset():r&&r.code===De.RESOURCE_EXHAUSTED?(Ui(r.toString()),Ui("Using maximum backoff delay to prevent overloading the backend."),this.F_.f_()):r&&r.code===De.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.U_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.n_(r)}U_(){}auth(){this.state=1;const e=this.K_(this.b_),r=this.b_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([n,i])=>{this.b_===r&&this.W_(n,i)},n=>{e(()=>{const i=new Xe(De.UNKNOWN,"Fetching auth token failed: "+n.message);return this.G_(i)})})}W_(e,r){const n=this.K_(this.b_);this.stream=this.z_(e,r),this.stream.Zo(()=>{n(()=>this.listener.Zo())}),this.stream.e_(()=>{n(()=>(this.state=2,this.v_=this.Fi.enqueueAfterDelay(this.S_,1e4,()=>(this.x_()&&(this.state=3),Promise.resolve())),this.listener.e_()))}),this.stream.n_(i=>{n(()=>this.G_(i))}),this.stream.onMessage(i=>{n(()=>++this.C_==1?this.j_(i):this.onNext(i))})}O_(){this.state=5,this.F_.g_(async()=>{this.state=0,this.start()})}G_(e){return He(eT,`close with error: ${e}`),this.stream=null,this.close(4,e)}K_(e){return r=>{this.Fi.enqueueAndForget(()=>this.b_===e?r():(He(eT,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class y6 extends yw{constructor(e,r,n,i,o,c){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",r,n,i,c),this.serializer=o}z_(e,r){return this.connection.P_("Listen",e,r)}j_(e){return this.onNext(e)}onNext(e){this.F_.reset();const r=CO(this.serializer,e),n=function(o){if(!("targetChange"in o))return lt.min();const c=o.targetChange;return c.targetIds&&c.targetIds.length?lt.min():c.readTime?ti(c.readTime):lt.min()}(e);return this.listener.J_(r,n)}H_(e){const r={};r.database=Sg(this.serializer),r.addTarget=function(o,c){let u;const h=c.target;if(u=yg(h)?{documents:bO(o,h)}:{query:IO(o,h).Vt},u.targetId=c.targetId,c.resumeToken.approximateByteSize()>0){u.resumeToken=lw(o,c.resumeToken);const d=Tg(o,c.expectedCount);d!==null&&(u.expectedCount=d)}else if(c.snapshotVersion.compareTo(lt.min())>0){u.readTime=V0(o,c.snapshotVersion.toTimestamp());const d=Tg(o,c.expectedCount);d!==null&&(u.expectedCount=d)}return u}(this.serializer,e);const n=OO(this.serializer,e);n&&(r.labels=n),this.k_(r)}Y_(e){const r={};r.database=Sg(this.serializer),r.removeTarget=e,this.k_(r)}}class E6 extends yw{constructor(e,r,n,i,o,c){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",r,n,i,c),this.serializer=o}get Z_(){return this.C_>0}start(){this.lastStreamToken=void 0,super.start()}U_(){this.Z_&&this.X_([])}z_(e,r){return this.connection.P_("Write",e,r)}j_(e){return jt(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,jt(!e.writeResults||e.writeResults.length===0,55816),this.listener.ea()}onNext(e){jt(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.F_.reset();const r=kO(e.writeResults,e.commitTime),n=ti(e.commitTime);return this.listener.ta(n,r)}na(){const e={};e.database=Sg(this.serializer),this.k_(e)}X_(e){const r={streamToken:this.lastStreamToken,writes:e.map(n=>RO(this.serializer,n))};this.k_(r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class T6{}class A6 extends T6{constructor(e,r,n,i){super(),this.authCredentials=e,this.appCheckCredentials=r,this.connection=n,this.serializer=i,this.ra=!1}ia(){if(this.ra)throw new Xe(De.FAILED_PRECONDITION,"The client has already been terminated.")}Wo(e,r,n,i){return this.ia(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,c])=>this.connection.Wo(e,Ag(r,n),i,o,c)).catch(o=>{throw o.name==="FirebaseError"?(o.code===De.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new Xe(De.UNKNOWN,o.toString())})}Jo(e,r,n,i,o){return this.ia(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([c,u])=>this.connection.Jo(e,Ag(r,n),i,c,u,o)).catch(c=>{throw c.name==="FirebaseError"?(c.code===De.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),c):new Xe(De.UNKNOWN,c.toString())})}terminate(){this.ra=!0,this.connection.terminate()}}class w6{constructor(e,r){this.asyncQueue=e,this.onlineStateHandler=r,this.state="Unknown",this.sa=0,this.oa=null,this._a=!0}aa(){this.sa===0&&(this.ua("Unknown"),this.oa=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.oa=null,this.ca("Backend didn't respond within 10 seconds."),this.ua("Offline"),Promise.resolve())))}la(e){this.state==="Online"?this.ua("Unknown"):(this.sa++,this.sa>=1&&(this.ha(),this.ca(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ua("Offline")))}set(e){this.ha(),this.sa=0,e==="Online"&&(this._a=!1),this.ua(e)}ua(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}ca(e){const r=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this._a?(Ui(r),this._a=!1):He("OnlineStateTracker",r)}ha(){this.oa!==null&&(this.oa.cancel(),this.oa=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Bo="RemoteStore";class S6{constructor(e,r,n,i,o){this.localStore=e,this.datastore=r,this.asyncQueue=n,this.remoteSyncer={},this.Pa=[],this.Ta=new Map,this.Ia=new Set,this.da=[],this.Ea=o,this.Ea.xo(c=>{n.enqueueAndForget(async()=>{Wo(this)&&(He(Bo,"Restarting streams for network reachability change."),await async function(h){const d=ct(h);d.Ia.add(4),await wf(d),d.Aa.set("Unknown"),d.Ia.delete(4),await gd(d)}(this))})}),this.Aa=new w6(n,i)}}async function gd(t){if(Wo(t))for(const e of t.da)await e(!0)}async function wf(t){for(const e of t.da)await e(!1)}function Ew(t,e){const r=ct(t);r.Ta.has(e.targetId)||(r.Ta.set(e.targetId,e),D1(r)?I1(r):Ec(r).x_()&&b1(r,e))}function k1(t,e){const r=ct(t),n=Ec(r);r.Ta.delete(e),n.x_()&&Tw(r,e),r.Ta.size===0&&(n.x_()?n.B_():Wo(r)&&r.Aa.set("Unknown"))}function b1(t,e){if(t.Ra.$e(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(lt.min())>0){const r=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(r)}Ec(t).H_(e)}function Tw(t,e){t.Ra.$e(e),Ec(t).Y_(e)}function I1(t){t.Ra=new xO({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),Et:e=>t.Ta.get(e)||null,lt:()=>t.datastore.serializer.databaseId}),Ec(t).start(),t.Aa.aa()}function D1(t){return Wo(t)&&!Ec(t).M_()&&t.Ta.size>0}function Wo(t){return ct(t).Ia.size===0}function Aw(t){t.Ra=void 0}async function C6(t){t.Aa.set("Online")}async function R6(t){t.Ta.forEach((e,r)=>{b1(t,e)})}async function k6(t,e){Aw(t),D1(t)?(t.Aa.la(e),I1(t)):t.Aa.set("Unknown")}async function b6(t,e,r){if(t.Aa.set("Online"),e instanceof ow&&e.state===2&&e.cause)try{await async function(i,o){const c=o.cause;for(const u of o.targetIds)i.Ta.has(u)&&(await i.remoteSyncer.rejectListen(u,c),i.Ta.delete(u),i.Ra.removeTarget(u))}(t,e)}catch(n){He(Bo,"Failed to remove targets %s: %s ",e.targetIds.join(","),n),await B0(t,n)}else if(e instanceof x0?t.Ra.Ye(e):e instanceof sw?t.Ra.it(e):t.Ra.et(e),!r.isEqual(lt.min()))try{const n=await _w(t.localStore);r.compareTo(n)>=0&&await function(o,c){const u=o.Ra.Pt(c);return u.targetChanges.forEach((h,d)=>{if(h.resumeToken.approximateByteSize()>0){const g=o.Ta.get(d);g&&o.Ta.set(d,g.withResumeToken(h.resumeToken,c))}}),u.targetMismatches.forEach((h,d)=>{const g=o.Ta.get(h);if(!g)return;o.Ta.set(h,g.withResumeToken(rn.EMPTY_BYTE_STRING,g.snapshotVersion)),Tw(o,h);const _=new Ss(g.target,h,d,g.sequenceNumber);b1(o,_)}),o.remoteSyncer.applyRemoteEvent(u)}(t,r)}catch(n){He(Bo,"Failed to raise snapshot:",n),await B0(t,n)}}async function B0(t,e,r){if(!yc(e))throw e;t.Ia.add(1),await wf(t),t.Aa.set("Offline"),r||(r=()=>_w(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{He(Bo,"Retrying IndexedDB access"),await r(),t.Ia.delete(1),await gd(t)})}function ww(t,e){return e().catch(r=>B0(t,r,e))}async function vd(t){const e=ct(t),r=js(e);let n=e.Pa.length>0?e.Pa[e.Pa.length-1].batchId:d1;for(;I6(e);)try{const i=await f6(e.localStore,n);if(i===null){e.Pa.length===0&&r.B_();break}n=i.batchId,D6(e,i)}catch(i){await B0(e,i)}Sw(e)&&Cw(e)}function I6(t){return Wo(t)&&t.Pa.length<10}function D6(t,e){t.Pa.push(e);const r=js(t);r.x_()&&r.Z_&&r.X_(e.mutations)}function Sw(t){return Wo(t)&&!js(t).M_()&&t.Pa.length>0}function Cw(t){js(t).start()}async function O6(t){js(t).na()}async function N6(t){const e=js(t);for(const r of t.Pa)e.X_(r.mutations)}async function F6(t,e,r){const n=t.Pa.shift(),i=E1.from(n,e,r);await ww(t,()=>t.remoteSyncer.applySuccessfulWrite(i)),await vd(t)}async function P6(t,e){e&&js(t).Z_&&await async function(n,i){if(function(c){return vO(c)&&c!==De.ABORTED}(i.code)){const o=n.Pa.shift();js(n).N_(),await ww(n,()=>n.remoteSyncer.rejectFailedWrite(o.batchId,i)),await vd(n)}}(t,e),Sw(t)&&Cw(t)}async function tT(t,e){const r=ct(t);r.asyncQueue.verifyOperationInProgress(),He(Bo,"RemoteStore received new credentials");const n=Wo(r);r.Ia.add(3),await wf(r),n&&r.Aa.set("Unknown"),await r.remoteSyncer.handleCredentialChange(e),r.Ia.delete(3),await gd(r)}async function M6(t,e){const r=ct(t);e?(r.Ia.delete(2),await gd(r)):e||(r.Ia.add(2),await wf(r),r.Aa.set("Unknown"))}function Ec(t){return t.Va||(t.Va=function(r,n,i){const o=ct(r);return o.ia(),new y6(n,o.connection,o.authCredentials,o.appCheckCredentials,o.serializer,i)}(t.datastore,t.asyncQueue,{Zo:C6.bind(null,t),e_:R6.bind(null,t),n_:k6.bind(null,t),J_:b6.bind(null,t)}),t.da.push(async e=>{e?(t.Va.N_(),D1(t)?I1(t):t.Aa.set("Unknown")):(await t.Va.stop(),Aw(t))})),t.Va}function js(t){return t.ma||(t.ma=function(r,n,i){const o=ct(r);return o.ia(),new E6(n,o.connection,o.authCredentials,o.appCheckCredentials,o.serializer,i)}(t.datastore,t.asyncQueue,{Zo:()=>Promise.resolve(),e_:O6.bind(null,t),n_:P6.bind(null,t),ea:N6.bind(null,t),ta:F6.bind(null,t)}),t.da.push(async e=>{e?(t.ma.N_(),await vd(t)):(await t.ma.stop(),t.Pa.length>0&&(He(Bo,`Stopping write stream with ${t.Pa.length} pending writes`),t.Pa=[]))})),t.ma}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class O1{constructor(e,r,n,i,o){this.asyncQueue=e,this.timerId=r,this.targetTimeMs=n,this.op=i,this.removalCallback=o,this.deferred=new Ni,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(c=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,r,n,i,o){const c=Date.now()+n,u=new O1(e,r,c,i,o);return u.start(n),u}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new Xe(De.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function N1(t,e){if(Ui("AsyncQueue",`${e}: ${t}`),yc(t))return new Xe(De.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ec{static emptySet(e){return new ec(e.comparator)}constructor(e){this.comparator=e?(r,n)=>e(r,n)||$e.comparator(r.key,n.key):(r,n)=>$e.comparator(r.key,n.key),this.keyedMap=Cu(),this.sortedSet=new or(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const r=this.keyedMap.get(e);return r?this.sortedSet.indexOf(r):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((r,n)=>(e(r),!1))}add(e){const r=this.delete(e.key);return r.copy(r.keyedMap.insert(e.key,e),r.sortedSet.insert(e,null))}delete(e){const r=this.get(e);return r?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(r)):this}isEqual(e){if(!(e instanceof ec)||this.size!==e.size)return!1;const r=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;r.hasNext();){const i=r.getNext().key,o=n.getNext().key;if(!i.isEqual(o))return!1}return!0}toString(){const e=[];return this.forEach(r=>{e.push(r.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,r){const n=new ec;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=r,n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rT{constructor(){this.fa=new or($e.comparator)}track(e){const r=e.doc.key,n=this.fa.get(r);n?e.type!==0&&n.type===3?this.fa=this.fa.insert(r,e):e.type===3&&n.type!==1?this.fa=this.fa.insert(r,{type:n.type,doc:e.doc}):e.type===2&&n.type===2?this.fa=this.fa.insert(r,{type:2,doc:e.doc}):e.type===2&&n.type===0?this.fa=this.fa.insert(r,{type:0,doc:e.doc}):e.type===1&&n.type===0?this.fa=this.fa.remove(r):e.type===1&&n.type===2?this.fa=this.fa.insert(r,{type:1,doc:n.doc}):e.type===0&&n.type===1?this.fa=this.fa.insert(r,{type:2,doc:e.doc}):rt(63341,{At:e,ga:n}):this.fa=this.fa.insert(r,e)}pa(){const e=[];return this.fa.inorderTraversal((r,n)=>{e.push(n)}),e}}class fc{constructor(e,r,n,i,o,c,u,h,d){this.query=e,this.docs=r,this.oldDocs=n,this.docChanges=i,this.mutatedKeys=o,this.fromCache=c,this.syncStateChanged=u,this.excludesMetadataChanges=h,this.hasCachedResults=d}static fromInitialDocuments(e,r,n,i,o){const c=[];return r.forEach(u=>{c.push({type:0,doc:u})}),new fc(e,r,ec.emptySet(r),c,n,i,!0,!1,o)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&ud(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const r=this.docChanges,n=e.docChanges;if(r.length!==n.length)return!1;for(let i=0;i<r.length;i++)if(r[i].type!==n[i].type||!r[i].doc.isEqual(n[i].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class L6{constructor(){this.ya=void 0,this.wa=[]}Sa(){return this.wa.some(e=>e.ba())}}class V6{constructor(){this.queries=nT(),this.onlineState="Unknown",this.Da=new Set}terminate(){(function(r,n){const i=ct(r),o=i.queries;i.queries=nT(),o.forEach((c,u)=>{for(const h of u.wa)h.onError(n)})})(this,new Xe(De.ABORTED,"Firestore shutting down"))}}function nT(){return new Xo(t=>XA(t),ud)}async function Rw(t,e){const r=ct(t);let n=3;const i=e.query;let o=r.queries.get(i);o?!o.Sa()&&e.ba()&&(n=2):(o=new L6,n=e.ba()?0:1);try{switch(n){case 0:o.ya=await r.onListen(i,!0);break;case 1:o.ya=await r.onListen(i,!1);break;case 2:await r.onFirstRemoteStoreListen(i)}}catch(c){const u=N1(c,`Initialization of query '${Kl(e.query)}' failed`);return void e.onError(u)}r.queries.set(i,o),o.wa.push(e),e.va(r.onlineState),o.ya&&e.Ca(o.ya)&&F1(r)}async function kw(t,e){const r=ct(t),n=e.query;let i=3;const o=r.queries.get(n);if(o){const c=o.wa.indexOf(e);c>=0&&(o.wa.splice(c,1),o.wa.length===0?i=e.ba()?0:1:!o.Sa()&&e.ba()&&(i=2))}switch(i){case 0:return r.queries.delete(n),r.onUnlisten(n,!0);case 1:return r.queries.delete(n),r.onUnlisten(n,!1);case 2:return r.onLastRemoteStoreUnlisten(n);default:return}}function U6(t,e){const r=ct(t);let n=!1;for(const i of e){const o=i.query,c=r.queries.get(o);if(c){for(const u of c.wa)u.Ca(i)&&(n=!0);c.ya=i}}n&&F1(r)}function B6(t,e,r){const n=ct(t),i=n.queries.get(e);if(i)for(const o of i.wa)o.onError(r);n.queries.delete(e)}function F1(t){t.Da.forEach(e=>{e.next()})}var kg,aT;(aT=kg||(kg={})).Fa="default",aT.Cache="cache";class bw{constructor(e,r,n){this.query=e,this.Ma=r,this.xa=!1,this.Oa=null,this.onlineState="Unknown",this.options=n||{}}Ca(e){if(!this.options.includeMetadataChanges){const n=[];for(const i of e.docChanges)i.type!==3&&n.push(i);e=new fc(e.query,e.docs,e.oldDocs,n,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let r=!1;return this.xa?this.Na(e)&&(this.Ma.next(e),r=!0):this.Ba(e,this.onlineState)&&(this.La(e),r=!0),this.Oa=e,r}onError(e){this.Ma.error(e)}va(e){this.onlineState=e;let r=!1;return this.Oa&&!this.xa&&this.Ba(this.Oa,e)&&(this.La(this.Oa),r=!0),r}Ba(e,r){if(!e.fromCache||!this.ba())return!0;const n=r!=="Offline";return(!this.options.ka||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||r==="Offline")}Na(e){if(e.docChanges.length>0)return!0;const r=this.Oa&&this.Oa.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!r)&&this.options.includeMetadataChanges===!0}La(e){e=fc.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.xa=!0,this.Ma.next(e)}ba(){return this.options.source!==kg.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Iw{constructor(e){this.key=e}}class Dw{constructor(e){this.key=e}}class j6{constructor(e,r){this.query=e,this.Ha=r,this.Ya=null,this.hasCachedResults=!1,this.current=!1,this.Za=At(),this.mutatedKeys=At(),this.Xa=WA(e),this.eu=new ec(this.Xa)}get tu(){return this.Ha}nu(e,r){const n=r?r.ru:new rT,i=r?r.eu:this.eu;let o=r?r.mutatedKeys:this.mutatedKeys,c=i,u=!1;const h=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,d=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((g,_)=>{const x=i.get(g),A=fd(this.query,_)?_:null,w=!!x&&this.mutatedKeys.has(x.key),S=!!A&&(A.hasLocalMutations||this.mutatedKeys.has(A.key)&&A.hasCommittedMutations);let C=!1;x&&A?x.data.isEqual(A.data)?w!==S&&(n.track({type:3,doc:A}),C=!0):this.iu(x,A)||(n.track({type:2,doc:A}),C=!0,(h&&this.Xa(A,h)>0||d&&this.Xa(A,d)<0)&&(u=!0)):!x&&A?(n.track({type:0,doc:A}),C=!0):x&&!A&&(n.track({type:1,doc:x}),C=!0,(h||d)&&(u=!0)),C&&(A?(c=c.add(A),o=S?o.add(g):o.delete(g)):(c=c.delete(g),o=o.delete(g)))}),this.query.limit!==null)for(;c.size>this.query.limit;){const g=this.query.limitType==="F"?c.last():c.first();c=c.delete(g.key),o=o.delete(g.key),n.track({type:1,doc:g})}return{eu:c,ru:n,Ds:u,mutatedKeys:o}}iu(e,r){return e.hasLocalMutations&&r.hasCommittedMutations&&!r.hasLocalMutations}applyChanges(e,r,n,i){const o=this.eu;this.eu=e.eu,this.mutatedKeys=e.mutatedKeys;const c=e.ru.pa();c.sort((g,_)=>function(A,w){const S=C=>{switch(C){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return rt(20277,{At:C})}};return S(A)-S(w)}(g.type,_.type)||this.Xa(g.doc,_.doc)),this.su(n),i=i!=null&&i;const u=r&&!i?this.ou():[],h=this.Za.size===0&&this.current&&!i?1:0,d=h!==this.Ya;return this.Ya=h,c.length!==0||d?{snapshot:new fc(this.query,e.eu,o,c,e.mutatedKeys,h===0,d,!1,!!n&&n.resumeToken.approximateByteSize()>0),_u:u}:{_u:u}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({eu:this.eu,ru:new rT,mutatedKeys:this.mutatedKeys,Ds:!1},!1)):{_u:[]}}au(e){return!this.Ha.has(e)&&!!this.eu.has(e)&&!this.eu.get(e).hasLocalMutations}su(e){e&&(e.addedDocuments.forEach(r=>this.Ha=this.Ha.add(r)),e.modifiedDocuments.forEach(r=>{}),e.removedDocuments.forEach(r=>this.Ha=this.Ha.delete(r)),this.current=e.current)}ou(){if(!this.current)return[];const e=this.Za;this.Za=At(),this.eu.forEach(n=>{this.au(n.key)&&(this.Za=this.Za.add(n.key))});const r=[];return e.forEach(n=>{this.Za.has(n)||r.push(new Dw(n))}),this.Za.forEach(n=>{e.has(n)||r.push(new Iw(n))}),r}uu(e){this.Ha=e.qs,this.Za=At();const r=this.nu(e.documents);return this.applyChanges(r,!0)}cu(){return fc.fromInitialDocuments(this.query,this.eu,this.mutatedKeys,this.Ya===0,this.hasCachedResults)}}const P1="SyncEngine";class z6{constructor(e,r,n){this.query=e,this.targetId=r,this.view=n}}class H6{constructor(e){this.key=e,this.lu=!1}}class G6{constructor(e,r,n,i,o,c){this.localStore=e,this.remoteStore=r,this.eventManager=n,this.sharedClientState=i,this.currentUser=o,this.maxConcurrentLimboResolutions=c,this.hu={},this.Pu=new Xo(u=>XA(u),ud),this.Tu=new Map,this.Iu=new Set,this.du=new or($e.comparator),this.Eu=new Map,this.Au=new w1,this.Ru={},this.Vu=new Map,this.mu=uc.ur(),this.onlineState="Unknown",this.fu=void 0}get isPrimaryClient(){return this.fu===!0}}async function q6(t,e,r=!0){const n=Lw(t);let i;const o=n.Pu.get(e);return o?(n.sharedClientState.addLocalQueryTarget(o.targetId),i=o.view.cu()):i=await Ow(n,e,r,!0),i}async function K6(t,e){const r=Lw(t);await Ow(r,e,!0,!1)}async function Ow(t,e,r,n){const i=await h6(t.localStore,ei(e)),o=i.targetId,c=t.sharedClientState.addLocalQueryTarget(o,r);let u;return n&&(u=await X6(t,e,o,c==="current",i.resumeToken)),t.isPrimaryClient&&r&&Ew(t.remoteStore,i),u}async function X6(t,e,r,n,i){t.gu=(_,x,A)=>async function(S,C,z,W){let P=C.view.nu(z);P.Ds&&(P=await $E(S.localStore,C.query,!1).then(({documents:k})=>C.view.nu(k,P)));const re=W&&W.targetChanges.get(C.targetId),Q=W&&W.targetMismatches.get(C.targetId)!=null,ee=C.view.applyChanges(P,S.isPrimaryClient,re,Q);return sT(S,C.targetId,ee._u),ee.snapshot}(t,_,x,A);const o=await $E(t.localStore,e,!0),c=new j6(e,o.qs),u=c.nu(o.documents),h=Af.createSynthesizedTargetChangeForCurrentChange(r,n&&t.onlineState!=="Offline",i),d=c.applyChanges(u,t.isPrimaryClient,h);sT(t,r,d._u);const g=new z6(e,r,c);return t.Pu.set(e,g),t.Tu.has(r)?t.Tu.get(r).push(e):t.Tu.set(r,[e]),d.snapshot}async function W6(t,e,r){const n=ct(t),i=n.Pu.get(e),o=n.Tu.get(i.targetId);if(o.length>1)return n.Tu.set(i.targetId,o.filter(c=>!ud(c,e))),void n.Pu.delete(e);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(i.targetId),n.sharedClientState.isActiveQueryTarget(i.targetId)||await Cg(n.localStore,i.targetId,!1).then(()=>{n.sharedClientState.clearQueryState(i.targetId),r&&k1(n.remoteStore,i.targetId),bg(n,i.targetId)}).catch(xc)):(bg(n,i.targetId),await Cg(n.localStore,i.targetId,!0))}async function Y6(t,e){const r=ct(t),n=r.Pu.get(e),i=r.Tu.get(n.targetId);r.isPrimaryClient&&i.length===1&&(r.sharedClientState.removeLocalQueryTarget(n.targetId),k1(r.remoteStore,n.targetId))}async function $6(t,e,r){const n=nN(t);try{const i=await function(c,u){const h=ct(c),d=Gt.now(),g=u.reduce((A,w)=>A.add(w.key),At());let _,x;return h.persistence.runTransaction("Locally write mutations","readwrite",A=>{let w=Bi(),S=At();return h.Os.getEntries(A,g).next(C=>{w=C,w.forEach((z,W)=>{W.isValidDocument()||(S=S.add(z))})}).next(()=>h.localDocuments.getOverlayedDocuments(A,w)).next(C=>{_=C;const z=[];for(const W of u){const P=hO(W,_.get(W.key).overlayedDocument);P!=null&&z.push(new Qs(W.key,P,BA(P.value.mapValue),da.exists(!0)))}return h.mutationQueue.addMutationBatch(A,d,z,u)}).next(C=>{x=C;const z=C.applyToLocalDocumentSet(_,S);return h.documentOverlayCache.saveOverlays(A,C.batchId,z)})}).then(()=>({batchId:x.batchId,changes:$A(_)}))}(n.localStore,e);n.sharedClientState.addPendingMutation(i.batchId),function(c,u,h){let d=c.Ru[c.currentUser.toKey()];d||(d=new or(mt)),d=d.insert(u,h),c.Ru[c.currentUser.toKey()]=d}(n,i.batchId,r),await Sf(n,i.changes),await vd(n.remoteStore)}catch(i){const o=N1(i,"Failed to persist write");r.reject(o)}}async function Nw(t,e){const r=ct(t);try{const n=await c6(r.localStore,e);e.targetChanges.forEach((i,o)=>{const c=r.Eu.get(o);c&&(jt(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1,22616),i.addedDocuments.size>0?c.lu=!0:i.modifiedDocuments.size>0?jt(c.lu,14607):i.removedDocuments.size>0&&(jt(c.lu,42227),c.lu=!1))}),await Sf(r,n,e)}catch(n){await xc(n)}}function iT(t,e,r){const n=ct(t);if(n.isPrimaryClient&&r===0||!n.isPrimaryClient&&r===1){const i=[];n.Pu.forEach((o,c)=>{const u=c.view.va(e);u.snapshot&&i.push(u.snapshot)}),function(c,u){const h=ct(c);h.onlineState=u;let d=!1;h.queries.forEach((g,_)=>{for(const x of _.wa)x.va(u)&&(d=!0)}),d&&F1(h)}(n.eventManager,e),i.length&&n.hu.J_(i),n.onlineState=e,n.isPrimaryClient&&n.sharedClientState.setOnlineState(e)}}async function Q6(t,e,r){const n=ct(t);n.sharedClientState.updateQueryState(e,"rejected",r);const i=n.Eu.get(e),o=i&&i.key;if(o){let c=new or($e.comparator);c=c.insert(o,un.newNoDocument(o,lt.min()));const u=At().add(o),h=new pd(lt.min(),new Map,new or(mt),c,u);await Nw(n,h),n.du=n.du.remove(o),n.Eu.delete(e),M1(n)}else await Cg(n.localStore,e,!1).then(()=>bg(n,e,r)).catch(xc)}async function Z6(t,e){const r=ct(t),n=e.batch.batchId;try{const i=await l6(r.localStore,e);Pw(r,n,null),Fw(r,n),r.sharedClientState.updateMutationState(n,"acknowledged"),await Sf(r,i)}catch(i){await xc(i)}}async function J6(t,e,r){const n=ct(t);try{const i=await function(c,u){const h=ct(c);return h.persistence.runTransaction("Reject batch","readwrite-primary",d=>{let g;return h.mutationQueue.lookupMutationBatch(d,u).next(_=>(jt(_!==null,37113),g=_.keys(),h.mutationQueue.removeMutationBatch(d,_))).next(()=>h.mutationQueue.performConsistencyCheck(d)).next(()=>h.documentOverlayCache.removeOverlaysForBatchId(d,g,u)).next(()=>h.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(d,g)).next(()=>h.localDocuments.getDocuments(d,g))})}(n.localStore,e);Pw(n,e,r),Fw(n,e),n.sharedClientState.updateMutationState(e,"rejected",r),await Sf(n,i)}catch(i){await xc(i)}}function Fw(t,e){(t.Vu.get(e)||[]).forEach(r=>{r.resolve()}),t.Vu.delete(e)}function Pw(t,e,r){const n=ct(t);let i=n.Ru[n.currentUser.toKey()];if(i){const o=i.get(e);o&&(r?o.reject(r):o.resolve(),i=i.remove(e)),n.Ru[n.currentUser.toKey()]=i}}function bg(t,e,r=null){t.sharedClientState.removeLocalQueryTarget(e);for(const n of t.Tu.get(e))t.Pu.delete(n),r&&t.hu.pu(n,r);t.Tu.delete(e),t.isPrimaryClient&&t.Au.zr(e).forEach(n=>{t.Au.containsKey(n)||Mw(t,n)})}function Mw(t,e){t.Iu.delete(e.path.canonicalString());const r=t.du.get(e);r!==null&&(k1(t.remoteStore,r),t.du=t.du.remove(e),t.Eu.delete(r),M1(t))}function sT(t,e,r){for(const n of r)n instanceof Iw?(t.Au.addReference(n.key,e),eN(t,n)):n instanceof Dw?(He(P1,"Document no longer in limbo: "+n.key),t.Au.removeReference(n.key,e),t.Au.containsKey(n.key)||Mw(t,n.key)):rt(19791,{yu:n})}function eN(t,e){const r=e.key,n=r.path.canonicalString();t.du.get(r)||t.Iu.has(n)||(He(P1,"New document in limbo: "+r),t.Iu.add(n),M1(t))}function M1(t){for(;t.Iu.size>0&&t.du.size<t.maxConcurrentLimboResolutions;){const e=t.Iu.values().next().value;t.Iu.delete(e);const r=new $e(tr.fromString(e)),n=t.mu.next();t.Eu.set(n,new H6(r)),t.du=t.du.insert(r,n),Ew(t.remoteStore,new Ss(ei(_1(r.path)),n,"TargetPurposeLimboResolution",sd.ue))}}async function Sf(t,e,r){const n=ct(t),i=[],o=[],c=[];n.Pu.isEmpty()||(n.Pu.forEach((u,h)=>{c.push(n.gu(h,e,r).then(d=>{var g;if((d||r)&&n.isPrimaryClient){const _=d?!d.fromCache:(g=r?.targetChanges.get(h.targetId))===null||g===void 0?void 0:g.current;n.sharedClientState.updateQueryState(h.targetId,_?"current":"not-current")}if(d){i.push(d);const _=C1.Es(h.targetId,d);o.push(_)}}))}),await Promise.all(c),n.hu.J_(i),await async function(h,d){const g=ct(h);try{await g.persistence.runTransaction("notifyLocalViewChanges","readwrite",_=>ke.forEach(d,x=>ke.forEach(x.Is,A=>g.persistence.referenceDelegate.addReference(_,x.targetId,A)).next(()=>ke.forEach(x.ds,A=>g.persistence.referenceDelegate.removeReference(_,x.targetId,A)))))}catch(_){if(!yc(_))throw _;He(R1,"Failed to update sequence numbers: "+_)}for(const _ of d){const x=_.targetId;if(!_.fromCache){const A=g.Fs.get(x),w=A.snapshotVersion,S=A.withLastLimboFreeSnapshotVersion(w);g.Fs=g.Fs.insert(x,S)}}}(n.localStore,o))}async function tN(t,e){const r=ct(t);if(!r.currentUser.isEqual(e)){He(P1,"User change. New user:",e.toKey());const n=await vw(r.localStore,e);r.currentUser=e,function(o,c){o.Vu.forEach(u=>{u.forEach(h=>{h.reject(new Xe(De.CANCELLED,c))})}),o.Vu.clear()}(r,"'waitForPendingWrites' promise is rejected due to a user change."),r.sharedClientState.handleUserChange(e,n.removedBatchIds,n.addedBatchIds),await Sf(r,n.Bs)}}function rN(t,e){const r=ct(t),n=r.Eu.get(e);if(n&&n.lu)return At().add(n.key);{let i=At();const o=r.Tu.get(e);if(!o)return i;for(const c of o){const u=r.Pu.get(c);i=i.unionWith(u.view.tu)}return i}}function Lw(t){const e=ct(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=Nw.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=rN.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=Q6.bind(null,e),e.hu.J_=U6.bind(null,e.eventManager),e.hu.pu=B6.bind(null,e.eventManager),e}function nN(t){const e=ct(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=Z6.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=J6.bind(null,e),e}class j0{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=md(e.databaseInfo.databaseId),this.sharedClientState=this.bu(e),this.persistence=this.Du(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Cu(e,this.localStore),this.indexBackfillerScheduler=this.Fu(e,this.localStore)}Cu(e,r){return null}Fu(e,r){return null}vu(e){return o6(this.persistence,new a6,e.initialUser,this.serializer)}Du(e){return new gw(S1.Vi,this.serializer)}bu(e){return new p6}async terminate(){var e,r;(e=this.gcScheduler)===null||e===void 0||e.stop(),(r=this.indexBackfillerScheduler)===null||r===void 0||r.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}j0.provider={build:()=>new j0};class aN extends j0{constructor(e){super(),this.cacheSizeBytes=e}Cu(e,r){jt(this.persistence.referenceDelegate instanceof U0,46915);const n=this.persistence.referenceDelegate.garbageCollector;return new HO(n,e.asyncQueue,r)}Du(e){const r=this.cacheSizeBytes!==void 0?Nn.withCacheSize(this.cacheSizeBytes):Nn.DEFAULT;return new gw(n=>U0.Vi(n,r),this.serializer)}}class Ig{async initialize(e,r){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(r),this.remoteStore=this.createRemoteStore(r),this.eventManager=this.createEventManager(r),this.syncEngine=this.createSyncEngine(r,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=n=>iT(this.syncEngine,n,1),this.remoteStore.remoteSyncer.handleCredentialChange=tN.bind(null,this.syncEngine),await M6(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new V6}()}createDatastore(e){const r=md(e.databaseInfo.databaseId),n=function(o){return new x6(o)}(e.databaseInfo);return function(o,c,u,h){return new A6(o,c,u,h)}(e.authCredentials,e.appCheckCredentials,n,r)}createRemoteStore(e){return function(n,i,o,c,u){return new S6(n,i,o,c,u)}(this.localStore,this.datastore,e.asyncQueue,r=>iT(this.syncEngine,r,0),function(){return JE.C()?new JE:new m6}())}createSyncEngine(e,r){return function(i,o,c,u,h,d,g){const _=new G6(i,o,c,u,h,d);return g&&(_.fu=!0),_}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,r)}async terminate(){var e,r;await async function(i){const o=ct(i);He(Bo,"RemoteStore shutting down."),o.Ia.add(5),await wf(o),o.Ea.shutdown(),o.Aa.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(r=this.eventManager)===null||r===void 0||r.terminate()}}Ig.provider={build:()=>new Ig};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vw{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.xu(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.xu(this.observer.error,e):Ui("Uncaught Error in snapshot listener:",e.toString()))}Ou(){this.muted=!0}xu(e,r){setTimeout(()=>{this.muted||e(r)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zs="FirestoreClient";class iN{constructor(e,r,n,i,o){this.authCredentials=e,this.appCheckCredentials=r,this.asyncQueue=n,this.databaseInfo=i,this.user=ln.UNAUTHENTICATED,this.clientId=f1.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=o,this.authCredentials.start(n,async c=>{He(zs,"Received user=",c.uid),await this.authCredentialListener(c),this.user=c}),this.appCheckCredentials.start(n,c=>(He(zs,"Received new app check token=",c),this.appCheckCredentialListener(c,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Ni;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(r){const n=N1(r,"Failed to shutdown persistence");e.reject(n)}}),e.promise}}async function Xm(t,e){t.asyncQueue.verifyOperationInProgress(),He(zs,"Initializing OfflineComponentProvider");const r=t.configuration;await e.initialize(r);let n=r.initialUser;t.setCredentialChangeListener(async i=>{n.isEqual(i)||(await vw(e.localStore,i),n=i)}),e.persistence.setDatabaseDeletedListener(()=>{Ms("Terminating Firestore due to IndexedDb database deletion"),t.terminate().then(()=>{He("Terminating Firestore due to IndexedDb database deletion completed successfully")}).catch(i=>{Ms("Terminating Firestore due to IndexedDb database deletion failed",i)})}),t._offlineComponents=e}async function oT(t,e){t.asyncQueue.verifyOperationInProgress();const r=await sN(t);He(zs,"Initializing OnlineComponentProvider"),await e.initialize(r,t.configuration),t.setCredentialChangeListener(n=>tT(e.remoteStore,n)),t.setAppCheckTokenChangeListener((n,i)=>tT(e.remoteStore,i)),t._onlineComponents=e}async function sN(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){He(zs,"Using user provided OfflineComponentProvider");try{await Xm(t,t._uninitializedComponentsProvider._offline)}catch(e){const r=e;if(!function(i){return i.name==="FirebaseError"?i.code===De.FAILED_PRECONDITION||i.code===De.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11}(r))throw r;Ms("Error using user provided cache. Falling back to memory cache: "+r),await Xm(t,new j0)}}else He(zs,"Using default OfflineComponentProvider"),await Xm(t,new aN(void 0));return t._offlineComponents}async function Uw(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(He(zs,"Using user provided OnlineComponentProvider"),await oT(t,t._uninitializedComponentsProvider._online)):(He(zs,"Using default OnlineComponentProvider"),await oT(t,new Ig))),t._onlineComponents}function oN(t){return Uw(t).then(e=>e.syncEngine)}async function Bw(t){const e=await Uw(t),r=e.eventManager;return r.onListen=q6.bind(null,e.syncEngine),r.onUnlisten=W6.bind(null,e.syncEngine),r.onFirstRemoteStoreListen=K6.bind(null,e.syncEngine),r.onLastRemoteStoreUnlisten=Y6.bind(null,e.syncEngine),r}function lN(t,e,r={}){const n=new Ni;return t.asyncQueue.enqueueAndForget(async()=>function(o,c,u,h,d){const g=new Vw({next:x=>{g.Ou(),c.enqueueAndForget(()=>kw(o,_));const A=x.docs.has(u);!A&&x.fromCache?d.reject(new Xe(De.UNAVAILABLE,"Failed to get document because the client is offline.")):A&&x.fromCache&&h&&h.source==="server"?d.reject(new Xe(De.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):d.resolve(x)},error:x=>d.reject(x)}),_=new bw(_1(u.path),g,{includeMetadataChanges:!0,ka:!0});return Rw(o,_)}(await Bw(t),t.asyncQueue,e,r,n)),n.promise}function cN(t,e,r={}){const n=new Ni;return t.asyncQueue.enqueueAndForget(async()=>function(o,c,u,h,d){const g=new Vw({next:x=>{g.Ou(),c.enqueueAndForget(()=>kw(o,_)),x.fromCache&&h.source==="server"?d.reject(new Xe(De.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):d.resolve(x)},error:x=>d.reject(x)}),_=new bw(u,g,{includeMetadataChanges:!0,ka:!0});return Rw(o,_)}(await Bw(t),t.asyncQueue,e,r,n)),n.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jw(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lT=new Map;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zw="firestore.googleapis.com",cT=!0;class uT{constructor(e){var r,n;if(e.host===void 0){if(e.ssl!==void 0)throw new Xe(De.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=zw,this.ssl=cT}else this.host=e.host,this.ssl=(r=e.ssl)!==null&&r!==void 0?r:cT;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=mw;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<jO)throw new Xe(De.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}SD("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=jw((n=e.experimentalLongPollingOptions)!==null&&n!==void 0?n:{}),function(o){if(o.timeoutSeconds!==void 0){if(isNaN(o.timeoutSeconds))throw new Xe(De.INVALID_ARGUMENT,`invalid long polling timeout: ${o.timeoutSeconds} (must not be NaN)`);if(o.timeoutSeconds<5)throw new Xe(De.INVALID_ARGUMENT,`invalid long polling timeout: ${o.timeoutSeconds} (minimum allowed value is 5)`);if(o.timeoutSeconds>30)throw new Xe(De.INVALID_ARGUMENT,`invalid long polling timeout: ${o.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(n,i){return n.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class _d{constructor(e,r,n,i){this._authCredentials=e,this._appCheckCredentials=r,this._databaseId=n,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new uT({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new Xe(De.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new Xe(De.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new uT(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=function(n){if(!n)return new gD;switch(n.type){case"firstParty":return new yD(n.sessionIndex||"0",n.iamToken||null,n.authTokenFactory||null);case"provider":return n.client;default:throw new Xe(De.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(r){const n=lT.get(r);n&&(He("ComponentProvider","Removing Datastore"),lT.delete(r),n.terminate())}(this),Promise.resolve()}}function uN(t,e,r,n={}){var i;t=Oa(t,_d);const o=mc(e),c=t._getSettings(),u=Object.assign(Object.assign({},c),{emulatorOptions:t._getEmulatorOptions()}),h=`${e}:${r}`;o&&(F2(`https://${h}`),P2("Firestore",!0)),c.host!==zw&&c.host!==h&&Ms("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const d=Object.assign(Object.assign({},c),{host:h,ssl:o,emulatorOptions:n});if(!Mo(d,u)&&(t._setSettings(d),n.mockUserToken)){let g,_;if(typeof n.mockUserToken=="string")g=n.mockUserToken,_=ln.MOCK_USER;else{g=kk(n.mockUserToken,(i=t._app)===null||i===void 0?void 0:i.options.projectId);const x=n.mockUserToken.sub||n.mockUserToken.user_id;if(!x)throw new Xe(De.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");_=new ln(x)}t._authCredentials=new vD(new RA(g,_))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xd{constructor(e,r,n){this.converter=r,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new xd(this.firestore,e,this._query)}}class Rr{constructor(e,r,n){this.converter=r,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Fs(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Rr(this.firestore,e,this._key)}toJSON(){return{type:Rr._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,r,n){if(Ef(r,Rr._jsonSchema))return new Rr(e,n||null,new $e(tr.fromString(r.referencePath)))}}Rr._jsonSchemaVersion="firestore/documentReference/1.0",Rr._jsonSchema={type:Cr("string",Rr._jsonSchemaVersion),referencePath:Cr("string")};class Fs extends xd{constructor(e,r,n){super(e,r,_1(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Rr(this.firestore,null,new $e(e))}withConverter(e){return new Fs(this.firestore,e,this._path)}}function Hs(t,e,...r){if(t=tn(t),bA("collection","path",e),t instanceof _d){const n=tr.fromString(e,...r);return wE(n),new Fs(t,null,n)}{if(!(t instanceof Rr||t instanceof Fs))throw new Xe(De.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=t._path.child(tr.fromString(e,...r));return wE(n),new Fs(t.firestore,null,n)}}function pa(t,e,...r){if(t=tn(t),arguments.length===1&&(e=f1.newId()),bA("doc","path",e),t instanceof _d){const n=tr.fromString(e,...r);return AE(n),new Rr(t,null,new $e(n))}{if(!(t instanceof Rr||t instanceof Fs))throw new Xe(De.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=t._path.child(tr.fromString(e,...r));return AE(n),new Rr(t.firestore,t instanceof Fs?t.converter:null,new $e(n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fT="AsyncQueue";class hT{constructor(e=Promise.resolve()){this.Zu=[],this.Xu=!1,this.ec=[],this.tc=null,this.nc=!1,this.rc=!1,this.sc=[],this.F_=new xw(this,"async_queue_retry"),this.oc=()=>{const n=Km();n&&He(fT,"Visibility state changed to "+n.visibilityState),this.F_.y_()},this._c=e;const r=Km();r&&typeof r.addEventListener=="function"&&r.addEventListener("visibilitychange",this.oc)}get isShuttingDown(){return this.Xu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.ac(),this.uc(e)}enterRestrictedMode(e){if(!this.Xu){this.Xu=!0,this.rc=e||!1;const r=Km();r&&typeof r.removeEventListener=="function"&&r.removeEventListener("visibilitychange",this.oc)}}enqueue(e){if(this.ac(),this.Xu)return new Promise(()=>{});const r=new Ni;return this.uc(()=>this.Xu&&this.rc?Promise.resolve():(e().then(r.resolve,r.reject),r.promise)).then(()=>r.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Zu.push(e),this.cc()))}async cc(){if(this.Zu.length!==0){try{await this.Zu[0](),this.Zu.shift(),this.F_.reset()}catch(e){if(!yc(e))throw e;He(fT,"Operation failed with retryable error: "+e)}this.Zu.length>0&&this.F_.g_(()=>this.cc())}}uc(e){const r=this._c.then(()=>(this.nc=!0,e().catch(n=>{throw this.tc=n,this.nc=!1,Ui("INTERNAL UNHANDLED ERROR: ",dT(n)),n}).then(n=>(this.nc=!1,n))));return this._c=r,r}enqueueAfterDelay(e,r,n){this.ac(),this.sc.indexOf(e)>-1&&(r=0);const i=O1.createAndSchedule(this,e,r,n,o=>this.lc(o));return this.ec.push(i),i}ac(){this.tc&&rt(47125,{hc:dT(this.tc)})}verifyOperationInProgress(){}async Pc(){let e;do e=this._c,await e;while(e!==this._c)}Tc(e){for(const r of this.ec)if(r.timerId===e)return!0;return!1}Ic(e){return this.Pc().then(()=>{this.ec.sort((r,n)=>r.targetTimeMs-n.targetTimeMs);for(const r of this.ec)if(r.skipDelay(),e!=="all"&&r.timerId===e)break;return this.Pc()})}dc(e){this.sc.push(e)}lc(e){const r=this.ec.indexOf(e);this.ec.splice(r,1)}}function dT(t){let e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+`
`+t.stack),e}class Yo extends _d{constructor(e,r,n,i){super(e,r,n,i),this.type="firestore",this._queue=new hT,this._persistenceKey=i?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new hT(e),this._firestoreClient=void 0,await e}}}function fN(t,e){const r=typeof t=="object"?t:U2(),n=typeof t=="string"?t:O0,i=Zg(r,"firestore").getImmediate({identifier:n});if(!i._initialized){const o=Ck("firestore");o&&uN(i,...o)}return i}function L1(t){if(t._terminated)throw new Xe(De.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||hN(t),t._firestoreClient}function hN(t){var e,r,n;const i=t._freezeSettings(),o=function(u,h,d,g){return new MD(u,h,d,g.host,g.ssl,g.experimentalForceLongPolling,g.experimentalAutoDetectLongPolling,jw(g.experimentalLongPollingOptions),g.useFetchStreams,g.isUsingEmulator)}(t._databaseId,((e=t._app)===null||e===void 0?void 0:e.options.appId)||"",t._persistenceKey,i);t._componentsProvider||!((r=i.localCache)===null||r===void 0)&&r._offlineComponentProvider&&(!((n=i.localCache)===null||n===void 0)&&n._onlineComponentProvider)&&(t._componentsProvider={_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider}),t._firestoreClient=new iN(t._authCredentials,t._appCheckCredentials,t._queue,o,t._componentsProvider&&function(u){const h=u?._online.build();return{_offline:u?._offline.build(h),_online:h}}(t._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ha{constructor(e){this._byteString=e}static fromBase64String(e){try{return new ha(rn.fromBase64String(e))}catch(r){throw new Xe(De.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+r)}}static fromUint8Array(e){return new ha(rn.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:ha._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(Ef(e,ha._jsonSchema))return ha.fromBase64String(e.bytes)}}ha._jsonSchemaVersion="firestore/bytes/1.0",ha._jsonSchema={type:Cr("string",ha._jsonSchemaVersion),bytes:Cr("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yd{constructor(...e){for(let r=0;r<e.length;++r)if(e[r].length===0)throw new Xe(De.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Zr(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class V1{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ri{constructor(e,r){if(!isFinite(e)||e<-90||e>90)throw new Xe(De.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(r)||r<-180||r>180)throw new Xe(De.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+r);this._lat=e,this._long=r}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return mt(this._lat,e._lat)||mt(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:ri._jsonSchemaVersion}}static fromJSON(e){if(Ef(e,ri._jsonSchema))return new ri(e.latitude,e.longitude)}}ri._jsonSchemaVersion="firestore/geoPoint/1.0",ri._jsonSchema={type:Cr("string",ri._jsonSchemaVersion),latitude:Cr("number"),longitude:Cr("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ni{constructor(e){this._values=(e||[]).map(r=>r)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(n,i){if(n.length!==i.length)return!1;for(let o=0;o<n.length;++o)if(n[o]!==i[o])return!1;return!0}(this._values,e._values)}toJSON(){return{type:ni._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(Ef(e,ni._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every(r=>typeof r=="number"))return new ni(e.vectorValues);throw new Xe(De.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}ni._jsonSchemaVersion="firestore/vectorValue/1.0",ni._jsonSchema={type:Cr("string",ni._jsonSchemaVersion),vectorValues:Cr("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dN=/^__.*__$/;class pN{constructor(e,r,n){this.data=e,this.fieldMask=r,this.fieldTransforms=n}toMutation(e,r){return this.fieldMask!==null?new Qs(e,this.data,this.fieldMask,r,this.fieldTransforms):new Tf(e,this.data,r,this.fieldTransforms)}}class Hw{constructor(e,r,n){this.data=e,this.fieldMask=r,this.fieldTransforms=n}toMutation(e,r){return new Qs(e,this.data,this.fieldMask,r,this.fieldTransforms)}}function Gw(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw rt(40011,{Ec:t})}}class U1{constructor(e,r,n,i,o,c){this.settings=e,this.databaseId=r,this.serializer=n,this.ignoreUndefinedProperties=i,o===void 0&&this.Ac(),this.fieldTransforms=o||[],this.fieldMask=c||[]}get path(){return this.settings.path}get Ec(){return this.settings.Ec}Rc(e){return new U1(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Vc(e){var r;const n=(r=this.path)===null||r===void 0?void 0:r.child(e),i=this.Rc({path:n,mc:!1});return i.fc(e),i}gc(e){var r;const n=(r=this.path)===null||r===void 0?void 0:r.child(e),i=this.Rc({path:n,mc:!1});return i.Ac(),i}yc(e){return this.Rc({path:void 0,mc:!0})}wc(e){return z0(e,this.settings.methodName,this.settings.Sc||!1,this.path,this.settings.bc)}contains(e){return this.fieldMask.find(r=>e.isPrefixOf(r))!==void 0||this.fieldTransforms.find(r=>e.isPrefixOf(r.field))!==void 0}Ac(){if(this.path)for(let e=0;e<this.path.length;e++)this.fc(this.path.get(e))}fc(e){if(e.length===0)throw this.wc("Document fields must not be empty");if(Gw(this.Ec)&&dN.test(e))throw this.wc('Document fields cannot begin and end with "__"')}}class mN{constructor(e,r,n){this.databaseId=e,this.ignoreUndefinedProperties=r,this.serializer=n||md(e)}Dc(e,r,n,i=!1){return new U1({Ec:e,methodName:r,bc:n,path:Zr.emptyPath(),mc:!1,Sc:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function B1(t){const e=t._freezeSettings(),r=md(t._databaseId);return new mN(t._databaseId,!!e.ignoreUndefinedProperties,r)}function qw(t,e,r,n,i,o={}){const c=t.Dc(o.merge||o.mergeFields?2:0,e,r,i);j1("Data must be an object, but it was:",c,n);const u=Kw(n,c);let h,d;if(o.merge)h=new Kn(c.fieldMask),d=c.fieldTransforms;else if(o.mergeFields){const g=[];for(const _ of o.mergeFields){const x=Dg(e,_,r);if(!c.contains(x))throw new Xe(De.INVALID_ARGUMENT,`Field '${x}' is specified in your field mask but missing from your input data.`);Ww(g,x)||g.push(x)}h=new Kn(g),d=c.fieldTransforms.filter(_=>h.covers(_.field))}else h=null,d=c.fieldTransforms;return new pN(new Fn(u),h,d)}class Ed extends V1{_toFieldTransform(e){if(e.Ec!==2)throw e.Ec===1?e.wc(`${this._methodName}() can only appear at the top level of your update data`):e.wc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Ed}}function gN(t,e,r,n){const i=t.Dc(1,e,r);j1("Data must be an object, but it was:",i,n);const o=[],c=Fn.empty();$s(n,(h,d)=>{const g=z1(e,h,r);d=tn(d);const _=i.gc(g);if(d instanceof Ed)o.push(g);else{const x=Td(d,_);x!=null&&(o.push(g),c.set(g,x))}});const u=new Kn(o);return new Hw(c,u,i.fieldTransforms)}function vN(t,e,r,n,i,o){const c=t.Dc(1,e,r),u=[Dg(e,n,r)],h=[i];if(o.length%2!=0)throw new Xe(De.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let x=0;x<o.length;x+=2)u.push(Dg(e,o[x])),h.push(o[x+1]);const d=[],g=Fn.empty();for(let x=u.length-1;x>=0;--x)if(!Ww(d,u[x])){const A=u[x];let w=h[x];w=tn(w);const S=c.gc(A);if(w instanceof Ed)d.push(A);else{const C=Td(w,S);C!=null&&(d.push(A),g.set(A,C))}}const _=new Kn(d);return new Hw(g,_,c.fieldTransforms)}function Td(t,e){if(Xw(t=tn(t)))return j1("Unsupported field value:",e,t),Kw(t,e);if(t instanceof V1)return function(n,i){if(!Gw(i.Ec))throw i.wc(`${n._methodName}() can only be used with update() and set()`);if(!i.path)throw i.wc(`${n._methodName}() is not currently supported inside arrays`);const o=n._toFieldTransform(i);o&&i.fieldTransforms.push(o)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.mc&&e.Ec!==4)throw e.wc("Nested arrays are not supported");return function(n,i){const o=[];let c=0;for(const u of n){let h=Td(u,i.yc(c));h==null&&(h={nullValue:"NULL_VALUE"}),o.push(h),c++}return{arrayValue:{values:o}}}(t,e)}return function(n,i){if((n=tn(n))===null)return{nullValue:"NULL_VALUE"};if(typeof n=="number")return sO(i.serializer,n);if(typeof n=="boolean")return{booleanValue:n};if(typeof n=="string")return{stringValue:n};if(n instanceof Date){const o=Gt.fromDate(n);return{timestampValue:V0(i.serializer,o)}}if(n instanceof Gt){const o=new Gt(n.seconds,1e3*Math.floor(n.nanoseconds/1e3));return{timestampValue:V0(i.serializer,o)}}if(n instanceof ri)return{geoPointValue:{latitude:n.latitude,longitude:n.longitude}};if(n instanceof ha)return{bytesValue:lw(i.serializer,n._byteString)};if(n instanceof Rr){const o=i.databaseId,c=n.firestore._databaseId;if(!c.isEqual(o))throw i.wc(`Document reference is for database ${c.projectId}/${c.database} but should be for database ${o.projectId}/${o.database}`);return{referenceValue:A1(n.firestore._databaseId||i.databaseId,n._key.path)}}if(n instanceof ni)return function(c,u){return{mapValue:{fields:{[VA]:{stringValue:UA},[N0]:{arrayValue:{values:c.toArray().map(d=>{if(typeof d!="number")throw u.wc("VectorValues must only contain numeric values.");return x1(u.serializer,d)})}}}}}}(n,i);throw i.wc(`Unsupported field value: ${h1(n)}`)}(t,e)}function Kw(t,e){const r={};return OA(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):$s(t,(n,i)=>{const o=Td(i,e.Vc(n));o!=null&&(r[n]=o)}),{mapValue:{fields:r}}}function Xw(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof Gt||t instanceof ri||t instanceof ha||t instanceof Rr||t instanceof V1||t instanceof ni)}function j1(t,e,r){if(!Xw(r)||!IA(r)){const n=h1(r);throw n==="an object"?e.wc(t+" a custom object"):e.wc(t+" "+n)}}function Dg(t,e,r){if((e=tn(e))instanceof yd)return e._internalPath;if(typeof e=="string")return z1(t,e);throw z0("Field path arguments must be of type string or ",t,!1,void 0,r)}const _N=new RegExp("[~\\*/\\[\\]]");function z1(t,e,r){if(e.search(_N)>=0)throw z0(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,r);try{return new yd(...e.split("."))._internalPath}catch{throw z0(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,r)}}function z0(t,e,r,n,i){const o=n&&!n.isEmpty(),c=i!==void 0;let u=`Function ${e}() called with invalid data`;r&&(u+=" (via `toFirestore()`)"),u+=". ";let h="";return(o||c)&&(h+=" (found",o&&(h+=` in field ${n}`),c&&(h+=` in document ${i}`),h+=")"),new Xe(De.INVALID_ARGUMENT,u+t+h)}function Ww(t,e){return t.some(r=>r.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yw{constructor(e,r,n,i,o){this._firestore=e,this._userDataWriter=r,this._key=n,this._document=i,this._converter=o}get id(){return this._key.path.lastSegment()}get ref(){return new Rr(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new xN(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const r=this._document.data.field($w("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r)}}}class xN extends Yw{data(){return super.data()}}function $w(t,e){return typeof e=="string"?z1(t,e):e instanceof yd?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yN(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new Xe(De.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class EN{convertValue(e,r="none"){switch(Bs(e)){case 0:return null;case 1:return e.booleanValue;case 2:return gr(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,r);case 5:return e.stringValue;case 6:return this.convertBytes(Us(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,r);case 11:return this.convertObject(e.mapValue,r);case 10:return this.convertVectorValue(e.mapValue);default:throw rt(62114,{value:e})}}convertObject(e,r){return this.convertObjectMap(e.fields,r)}convertObjectMap(e,r="none"){const n={};return $s(e,(i,o)=>{n[i]=this.convertValue(o,r)}),n}convertVectorValue(e){var r,n,i;const o=(i=(n=(r=e.fields)===null||r===void 0?void 0:r[N0].arrayValue)===null||n===void 0?void 0:n.values)===null||i===void 0?void 0:i.map(c=>gr(c.doubleValue));return new ni(o)}convertGeoPoint(e){return new ri(gr(e.latitude),gr(e.longitude))}convertArray(e,r){return(e.values||[]).map(n=>this.convertValue(n,r))}convertServerTimestamp(e,r){switch(r){case"previous":const n=ld(e);return n==null?null:this.convertValue(n,r);case"estimate":return this.convertTimestamp(ef(e));default:return null}}convertTimestamp(e){const r=Vs(e);return new Gt(r.seconds,r.nanos)}convertDocumentKey(e,r){const n=tr.fromString(e);jt(pw(n),9688,{name:e});const i=new tf(n.get(1),n.get(3)),o=new $e(n.popFirst(5));return i.isEqual(r)||Ui(`Document ${o} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${r.projectId}/${r.database}) instead.`),o}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Qw(t,e,r){let n;return n=t?t.toFirestore(e):e,n}class ku{constructor(e,r){this.hasPendingWrites=e,this.fromCache=r}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class No extends Yw{constructor(e,r,n,i,o,c){super(e,r,n,i,c),this._firestore=e,this._firestoreImpl=e,this.metadata=o}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const r=new y0(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(r,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,r={}){if(this._document){const n=this._document.data.field($w("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n,r.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new Xe(De.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,r={};return r.type=No._jsonSchemaVersion,r.bundle="",r.bundleSource="DocumentSnapshot",r.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?r:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),r.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),r)}}No._jsonSchemaVersion="firestore/documentSnapshot/1.0",No._jsonSchema={type:Cr("string",No._jsonSchemaVersion),bundleSource:Cr("string","DocumentSnapshot"),bundleName:Cr("string"),bundle:Cr("string")};class y0 extends No{data(e={}){return super.data(e)}}class tc{constructor(e,r,n,i){this._firestore=e,this._userDataWriter=r,this._snapshot=i,this.metadata=new ku(i.hasPendingWrites,i.fromCache),this.query=n}get docs(){const e=[];return this.forEach(r=>e.push(r)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,r){this._snapshot.docs.forEach(n=>{e.call(r,new y0(this._firestore,this._userDataWriter,n.key,n,new ku(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const r=!!e.includeMetadataChanges;if(r&&this._snapshot.excludesMetadataChanges)throw new Xe(De.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===r||(this._cachedChanges=function(i,o){if(i._snapshot.oldDocs.isEmpty()){let c=0;return i._snapshot.docChanges.map(u=>{const h=new y0(i._firestore,i._userDataWriter,u.doc.key,u.doc,new ku(i._snapshot.mutatedKeys.has(u.doc.key),i._snapshot.fromCache),i.query.converter);return u.doc,{type:"added",doc:h,oldIndex:-1,newIndex:c++}})}{let c=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(u=>o||u.type!==3).map(u=>{const h=new y0(i._firestore,i._userDataWriter,u.doc.key,u.doc,new ku(i._snapshot.mutatedKeys.has(u.doc.key),i._snapshot.fromCache),i.query.converter);let d=-1,g=-1;return u.type!==0&&(d=c.indexOf(u.doc.key),c=c.delete(u.doc.key)),u.type!==1&&(c=c.add(u.doc),g=c.indexOf(u.doc.key)),{type:TN(u.type),doc:h,oldIndex:d,newIndex:g}})}}(this,r),this._cachedChangesIncludeMetadataChanges=r),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new Xe(De.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=tc._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=f1.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const r=[],n=[],i=[];return this.docs.forEach(o=>{o._document!==null&&(r.push(o._document),n.push(this._userDataWriter.convertObjectMap(o._document.data.value.mapValue.fields,"previous")),i.push(o.ref.path))}),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function TN(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return rt(61501,{type:t})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Zw(t){t=Oa(t,Rr);const e=Oa(t.firestore,Yo);return lN(L1(e),t._key).then(r=>wN(e,t,r))}tc._jsonSchemaVersion="firestore/querySnapshot/1.0",tc._jsonSchema={type:Cr("string",tc._jsonSchemaVersion),bundleSource:Cr("string","QuerySnapshot"),bundleName:Cr("string"),bundle:Cr("string")};class Jw extends EN{constructor(e){super(),this.firestore=e}convertBytes(e){return new ha(e)}convertReference(e){const r=this.convertDocumentKey(e,this.firestore._databaseId);return new Rr(this.firestore,null,r)}}function Ad(t){t=Oa(t,xd);const e=Oa(t.firestore,Yo),r=L1(e),n=new Jw(e);return yN(t._query),cN(r,t._query).then(i=>new tc(e,n,t,i))}function AN(t,e,r){t=Oa(t,Rr);const n=Oa(t.firestore,Yo),i=Qw(t.converter,e);return Rd(n,[qw(B1(n),"setDoc",t._key,i,t.converter!==null,r).toMutation(t._key,da.none())])}function wd(t,e,r,...n){t=Oa(t,Rr);const i=Oa(t.firestore,Yo),o=B1(i);let c;return c=typeof(e=tn(e))=="string"||e instanceof yd?vN(o,"updateDoc",t._key,e,r,n):gN(o,"updateDoc",t._key,e),Rd(i,[c.toMutation(t._key,da.exists(!0))])}function Sd(t){return Rd(Oa(t.firestore,Yo),[new y1(t._key,da.none())])}function Cd(t,e){const r=Oa(t.firestore,Yo),n=pa(t),i=Qw(t.converter,e);return Rd(r,[qw(B1(t.firestore),"addDoc",n._key,i,t.converter!==null,{}).toMutation(n._key,da.exists(!1))]).then(()=>n)}function Rd(t,e){return function(n,i){const o=new Ni;return n.asyncQueue.enqueueAndForget(async()=>$6(await oN(n),i,o)),o.promise}(L1(t),e)}function wN(t,e,r){const n=r.docs.get(e._key),i=new Jw(t);return new No(t,i,e._key,n,new ku(r.hasPendingWrites,r.fromCache),e.converter)}(function(e,r=!0){(function(i){_c=i})(gc),ic(new Lo("firestore",(n,{instanceIdentifier:i,options:o})=>{const c=n.getProvider("app").getImmediate(),u=new Yo(new _D(n.getProvider("auth-internal")),new ED(c,n.getProvider("app-check-internal")),function(d,g){if(!Object.prototype.hasOwnProperty.apply(d.options,["projectId"]))throw new Xe(De.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new tf(d.options.projectId,g)}(c,i),c);return o=Object.assign({useFetchStreams:r},o),u._setSettings(o),u},"PUBLIC").setMultipleInstances(!0)),Ds(_E,xE,e),Ds(_E,xE,"esm2017")})();var SN="firebase",CN="11.10.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Ds(SN,CN,"app");const RN={apiKey:"AIzaSyAADvft0ne-CpB00qBPOkJMcFqCGe-tOaU",authDomain:"evalstage2-lucas2025.firebaseapp.com",projectId:"evalstage2-lucas2025",storageBucket:"evalstage2-lucas2025.appspot.com",messagingSenderId:"1074657513257",appId:"1:1074657513257:web:f3fcc8ec7a421801277138"},eS=V2(RN),e0=pD(eS),Fr=fN(eS),tS=Pe.createContext(void 0),kd=()=>{const t=Pe.useContext(tS);if(t===void 0)throw new Error("useAuth must be used within an AuthProvider");return t},kN=({children:t})=>{const[e,r]=Pe.useState(null),[n,i]=Pe.useState(null),[o,c]=Pe.useState(!0);Pe.useEffect(()=>r3(e0,async x=>{if(i(x),x)try{const A=await Zw(pa(Fr,"users",x.uid));if(A.exists()){const w=A.data(),S=w.createdAt?.toDate?.()||new Date(w.createdAt)||new Date;r({id:x.uid,email:w.email||x.email||"",nom:w.nom||"Utilisateur",prenom:w.prenom||"Test",role:w.role||"professeur",createdAt:S}),console.log(" Connexion russie:",w)}else{const w={id:x.uid,email:x.email||"",nom:"Utilisateur",prenom:"Test",role:"professeur",createdAt:new Date};await AN(pa(Fr,"users",x.uid),w),r(w),console.log(" Document utilisateur cr:",w)}}catch(A){console.error(" Erreur utilisateur:",A);const w={id:x.uid,email:x.email||"",nom:"Utilisateur",prenom:"Test",role:"professeur",createdAt:new Date};r(w)}else r(null),console.log(" Utilisateur dconnect");c(!1)}),[]);const g={currentUser:e,firebaseUser:n,loading:o,login:async(_,x)=>{try{await JI(e0,_,x)}catch(A){throw A}},loginWithGoogle:async()=>{const _=new bi;try{await A3(e0,_)}catch(x){throw x}},logout:async()=>{try{await n3(e0)}catch(_){throw _}}};return ie.jsx(tS.Provider,{value:g,children:t})},bN=({onToggleTheme:t,isDarkMode:e})=>{const[r,n]=Pe.useState(!1),{currentUser:i,logout:o}=kd(),c=async()=>{try{await o(),n(!1)}catch(h){console.error("Erreur lors de la dconnexion:",h)}},u=()=>{n(!r)};return ie.jsx("nav",{className:"navigation",children:ie.jsxs("div",{className:"nav-container",children:[ie.jsx("button",{className:"menu-toggle",onClick:u,"aria-label":"Menu",children:""}),ie.jsx("div",{className:`nav-menu ${r?"open":""}`,children:i&&ie.jsxs(ie.Fragment,{children:[ie.jsxs("div",{className:"user-info",children:[ie.jsx("p",{children:"Connect en tant que :"}),ie.jsxs("strong",{children:[i.prenom," ",i.nom]}),ie.jsxs("span",{className:"user-role",children:["(",i.role,")"]})]}),ie.jsxs("div",{className:"nav-links",children:[ie.jsx(xs,{to:"/",className:"nav-link",onClick:()=>n(!1),children:"Accueil"}),i.role==="admin"&&ie.jsx(xs,{to:"/classes",className:"nav-link",onClick:()=>n(!1),children:"Grer les classes"}),ie.jsx(xs,{to:"/eleves",className:"nav-link",onClick:()=>n(!1),children:"Grer les lves"}),ie.jsx(xs,{to:"/periodes-stage",className:"nav-link",onClick:()=>n(!1),children:"Priodes de stage"}),ie.jsx(xs,{to:"/evaluations",className:"nav-link",onClick:()=>n(!1),children:"valuer un lve"}),ie.jsx(xs,{to:"/rapports",className:"nav-link",onClick:()=>n(!1),children:"Exporter rapports"}),i.role==="admin"&&ie.jsx(xs,{to:"/comptes",className:"nav-link",onClick:()=>n(!1),children:"Gestion des comptes"})]}),ie.jsxs("div",{className:"nav-actions",children:[ie.jsx("button",{className:"theme-toggle",onClick:t,children:e?"":""}),ie.jsx("button",{onClick:c,className:"logout-button",children:"Se dconnecter"})]})]})})]})})},IN=()=>{const[t,e]=Pe.useState(""),[r,n]=Pe.useState(""),[i,o]=Pe.useState(""),[c,u]=Pe.useState(!1),{login:h,loginWithGoogle:d}=kd(),g=Yg(),_=async A=>{if(A.preventDefault(),!t||!r){o("Veuillez remplir tous les champs");return}try{o(""),u(!0),await h(t,r),g("/")}catch(w){o("Email ou mot de passe incorrect"),console.error("Erreur de connexion:",w)}finally{u(!1)}},x=async()=>{try{o(""),u(!0),await d(),g("/")}catch(A){console.error("Erreur Google Auth:",A),o("La connexion Google a chou")}finally{u(!1)}};return ie.jsx("div",{className:"login-container",children:ie.jsxs("div",{className:"login-card",children:[ie.jsxs("div",{className:"login-header",children:[ie.jsx("h1",{children:"evalstage2"}),ie.jsx("p",{children:"Connexion"})]}),i&&ie.jsx("div",{className:"error-message",children:i}),ie.jsxs("form",{onSubmit:_,className:"login-form",children:[ie.jsxs("div",{className:"form-group",children:[ie.jsx("label",{htmlFor:"email",children:"Email"}),ie.jsx("input",{type:"email",id:"email",value:t,onChange:A=>e(A.target.value),placeholder:"votre.email@exemple.com",required:!0})]}),ie.jsxs("div",{className:"form-group",children:[ie.jsx("label",{htmlFor:"password",children:"Mot de passe"}),ie.jsx("input",{type:"password",id:"password",value:r,onChange:A=>n(A.target.value),placeholder:"Votre mot de passe",required:!0})]}),ie.jsx("button",{type:"submit",className:"login-button",disabled:c,children:c?"Connexion...":"Se connecter"}),ie.jsx("button",{type:"button",className:"google-button",onClick:x,disabled:c,children:"Se connecter avec Google"})]}),ie.jsx("div",{className:"login-footer",children:ie.jsx("p",{children:"Application d'valuation des stages"})})]})})},DN=()=>{const[t,e]=Pe.useState([]),[r,n]=Pe.useState(!0),[i,o]=Pe.useState(!1),[c,u]=Pe.useState(null),[h,d]=Pe.useState({nom:"",annee:new Date().getFullYear().toString(),effectif:0,professeurPrincipal:""});Pe.useEffect(()=>{g()},[]);const g=async()=>{try{const S=(await Ad(Hs(Fr,"classes"))).docs.map(C=>({id:C.id,...C.data(),createdAt:C.data().createdAt?.toDate()||new Date}));e(S)}catch(w){console.error("Erreur lors du chargement des classes:",w)}finally{n(!1)}},_=async w=>{w.preventDefault();try{c?(await wd(pa(Fr,"classes",c.id),{...h,updatedAt:new Date}),u(null)):await Cd(Hs(Fr,"classes"),{...h,createdAt:new Date}),d({nom:"",annee:new Date().getFullYear().toString(),effectif:0,professeurPrincipal:""}),o(!1),g()}catch(S){console.error("Erreur lors de la sauvegarde:",S)}},x=w=>{u(w),d({nom:w.nom,annee:w.annee,effectif:w.effectif,professeurPrincipal:w.professeurPrincipal}),o(!0)},A=async w=>{if(window.confirm("tes-vous sr de vouloir supprimer cette classe ?"))try{await Sd(pa(Fr,"classes",w)),g()}catch(S){console.error("Erreur lors de la suppression:",S)}};return r?ie.jsx("div",{className:"loading",children:"Chargement des classes..."}):ie.jsxs("div",{className:"gestion-classes",children:[ie.jsxs("div",{className:"header",children:[ie.jsx("h1",{children:"Gestion des Classes"}),ie.jsx("button",{className:"btn-primary",onClick:()=>{o(!0),u(null),d({nom:"",annee:new Date().getFullYear().toString(),effectif:0,professeurPrincipal:""})},children:"Ajouter une classe"})]}),i&&ie.jsx("div",{className:"form-overlay",children:ie.jsxs("div",{className:"form-container",children:[ie.jsx("h2",{children:c?"Modifier la classe":"Nouvelle classe"}),ie.jsxs("form",{onSubmit:_,children:[ie.jsxs("div",{className:"form-group",children:[ie.jsx("label",{children:"Nom de la classe:"}),ie.jsx("input",{type:"text",value:h.nom,onChange:w=>d({...h,nom:w.target.value}),required:!0})]}),ie.jsxs("div",{className:"form-group",children:[ie.jsx("label",{children:"Anne scolaire:"}),ie.jsx("input",{type:"text",value:h.annee,onChange:w=>d({...h,annee:w.target.value}),required:!0})]}),ie.jsxs("div",{className:"form-group",children:[ie.jsx("label",{children:"Effectif:"}),ie.jsx("input",{type:"number",value:h.effectif,onChange:w=>d({...h,effectif:parseInt(w.target.value)}),required:!0})]}),ie.jsxs("div",{className:"form-group",children:[ie.jsx("label",{children:"Professeur principal:"}),ie.jsx("input",{type:"text",value:h.professeurPrincipal,onChange:w=>d({...h,professeurPrincipal:w.target.value}),required:!0})]}),ie.jsxs("div",{className:"form-actions",children:[ie.jsx("button",{type:"submit",className:"btn-primary",children:c?"Modifier":"Ajouter"}),ie.jsx("button",{type:"button",className:"btn-secondary",onClick:()=>{o(!1),u(null)},children:"Annuler"})]})]})]})}),ie.jsx("div",{className:"classes-grid",children:t.map(w=>ie.jsxs("div",{className:"class-card",children:[ie.jsxs("div",{className:"class-header",children:[ie.jsx("h3",{children:w.nom}),ie.jsxs("div",{className:"class-actions",children:[ie.jsx("button",{className:"btn-edit",onClick:()=>x(w),children:""}),ie.jsx("button",{className:"btn-delete",onClick:()=>A(w.id),children:""})]})]}),ie.jsxs("div",{className:"class-info",children:[ie.jsxs("p",{children:[ie.jsx("strong",{children:"Anne:"})," ",w.annee]}),ie.jsxs("p",{children:[ie.jsx("strong",{children:"Effectif:"})," ",w.effectif," lves"]}),ie.jsxs("p",{children:[ie.jsx("strong",{children:"Professeur:"})," ",w.professeurPrincipal]}),ie.jsxs("p",{children:[ie.jsx("strong",{children:"Cre le:"})," ",w.createdAt.toLocaleDateString()]})]})]},w.id))}),t.length===0&&ie.jsxs("div",{className:"empty-state",children:[ie.jsx("p",{children:"Aucune classe enregistre"}),ie.jsx("button",{className:"btn-primary",onClick:()=>o(!0),children:"Crer la premire classe"})]})]})},Hl={async getAllEleves(){return(await Ad(Hs(Fr,"eleves"))).docs.map(e=>{const r=e.data();return{id:e.id,nom:r.nom,prenom:r.prenom,classeId:r.classeId,email:r.email||"",dateNaissance:r.dateNaissance||"",createdAt:r.createdAt?.toDate?r.createdAt.toDate():new Date(r.createdAt)}})},async createEleve(t){await Cd(Hs(Fr,"eleves"),{...t,createdAt:new Date})},async updateEleve(t,e){await wd(pa(Fr,"eleves",t),e)},async deleteEleve(t){await Sd(pa(Fr,"eleves",t))}};class ON{collectionName="classes";async getClasseById(e){try{const r=await Zw(pa(Fr,this.collectionName,e));if(r.exists()){const n=r.data();return{...n,id:r.id,createdAt:n.createdAt instanceof Gt?n.createdAt.toDate():new Date(n.createdAt),updatedAt:n.updatedAt instanceof Gt?n.updatedAt.toDate():new Date(n.updatedAt)}}return null}catch(r){throw console.error("Erreur lors de la rcupration de la classe:",r),r}}async getAllClasses(){try{return(await Ad(Hs(Fr,this.collectionName))).docs.map(r=>{const n=r.data();return{...n,id:r.id,createdAt:n.createdAt instanceof Gt?n.createdAt.toDate():new Date(n.createdAt),updatedAt:n.updatedAt instanceof Gt?n.updatedAt.toDate():new Date(n.updatedAt)}})}catch(e){throw console.error("Erreur lors de la rcupration des classes:",e),e}}async createClasse(e){try{const r=new Date;return(await Cd(Hs(Fr,this.collectionName),{...e,createdAt:r,updatedAt:r})).id}catch(r){throw console.error("Erreur lors de la cration de la classe:",r),r}}async updateClasse(e,r){try{await wd(pa(Fr,this.collectionName,e),{...r,updatedAt:new Date})}catch(n){throw console.error("Erreur lors de la mise  jour de la classe:",n),n}}async deleteClasse(e){try{await Sd(pa(Fr,this.collectionName,e))}catch(r){throw console.error("Erreur lors de la suppression de la classe:",r),r}}}const NN=new ON;/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var rS=1252,FN=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],H1={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},G1=function(t){FN.indexOf(t)!=-1&&(rS=H1[0]=t)};function PN(){G1(1252)}var ka=function(t){G1(t)};function nS(){ka(1200),PN()}function pT(t){for(var e=[],r=0,n=t.length;r<n;++r)e[r]=t.charCodeAt(r);return e}function MN(t){for(var e=[],r=0;r<t.length>>1;++r)e[r]=String.fromCharCode(t.charCodeAt(2*r)+(t.charCodeAt(2*r+1)<<8));return e.join("")}function aS(t){for(var e=[],r=0;r<t.length>>1;++r)e[r]=String.fromCharCode(t.charCodeAt(2*r+1)+(t.charCodeAt(2*r)<<8));return e.join("")}var bu=function(t){var e=t.charCodeAt(0),r=t.charCodeAt(1);return e==255&&r==254?MN(t.slice(2)):e==254&&r==255?aS(t.slice(2)):e==65279?t.slice(1):t},t0=function(e){return String.fromCharCode(e)},mT=function(e){return String.fromCharCode(e)},sf,Cs="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function gT(t){for(var e="",r=0,n=0,i=0,o=0,c=0,u=0,h=0,d=0;d<t.length;)r=t.charCodeAt(d++),o=r>>2,n=t.charCodeAt(d++),c=(r&3)<<4|n>>4,i=t.charCodeAt(d++),u=(n&15)<<2|i>>6,h=i&63,isNaN(n)?u=h=64:isNaN(i)&&(h=64),e+=Cs.charAt(o)+Cs.charAt(c)+Cs.charAt(u)+Cs.charAt(h);return e}function Wn(t){var e="",r=0,n=0,i=0,o=0,c=0,u=0,h=0;t=t.replace(/[^\w\+\/\=]/g,"");for(var d=0;d<t.length;)o=Cs.indexOf(t.charAt(d++)),c=Cs.indexOf(t.charAt(d++)),r=o<<2|c>>4,e+=String.fromCharCode(r),u=Cs.indexOf(t.charAt(d++)),n=(c&15)<<4|u>>2,u!==64&&(e+=String.fromCharCode(n)),h=Cs.indexOf(t.charAt(d++)),i=(u&3)<<6|h,h!==64&&(e+=String.fromCharCode(i));return e}var wt=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),$o=function(){if(typeof Buffer<"u"){var t=!Buffer.from;if(!t)try{Buffer.from("foo","utf8")}catch{t=!0}return t?function(e,r){return r?new Buffer(e,r):new Buffer(e)}:Buffer.from.bind(Buffer)}return function(){}}();function Gs(t){return wt?Buffer.alloc?Buffer.alloc(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}function vT(t){return wt?Buffer.allocUnsafe?Buffer.allocUnsafe(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}var Ca=function(e){return wt?$o(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)&255})};function Qo(t){if(Array.isArray(t))return t.map(function(n){return String.fromCharCode(n)}).join("");for(var e=[],r=0;r<t.length;++r)e[r]=String.fromCharCode(t[r]);return e.join("")}function q1(t){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(t instanceof ArrayBuffer)return q1(new Uint8Array(t));for(var e=new Array(t.length),r=0;r<t.length;++r)e[r]=t[r];return e}var As=wt?function(t){return Buffer.concat(t.map(function(e){return Buffer.isBuffer(e)?e:$o(e)}))}:function(t){if(typeof Uint8Array<"u"){var e=0,r=0;for(e=0;e<t.length;++e)r+=t[e].length;var n=new Uint8Array(r),i=0;for(e=0,r=0;e<t.length;r+=i,++e)if(i=t[e].length,t[e]instanceof Uint8Array)n.set(t[e],r);else{if(typeof t[e]=="string")throw"wtf";n.set(new Uint8Array(t[e]),r)}return n}return[].concat.apply([],t.map(function(o){return Array.isArray(o)?o:[].slice.call(o)}))};function LN(t){for(var e=[],r=0,n=t.length+250,i=Gs(t.length+255),o=0;o<t.length;++o){var c=t.charCodeAt(o);if(c<128)i[r++]=c;else if(c<2048)i[r++]=192|c>>6&31,i[r++]=128|c&63;else if(c>=55296&&c<57344){c=(c&1023)+64;var u=t.charCodeAt(++o)&1023;i[r++]=240|c>>8&7,i[r++]=128|c>>2&63,i[r++]=128|u>>6&15|(c&3)<<4,i[r++]=128|u&63}else i[r++]=224|c>>12&15,i[r++]=128|c>>6&63,i[r++]=128|c&63;r>n&&(e.push(i.slice(0,r)),r=0,i=Gs(65535),n=65530)}return e.push(i.slice(0,r)),As(e)}var Sn=/\u0000/g,Iu=/[\u0001-\u0006]/g;function rc(t){for(var e="",r=t.length-1;r>=0;)e+=t.charAt(r--);return e}function ba(t,e){var r=""+t;return r.length>=e?r:ur("0",e-r.length)+r}function K1(t,e){var r=""+t;return r.length>=e?r:ur(" ",e-r.length)+r}function H0(t,e){var r=""+t;return r.length>=e?r:r+ur(" ",e-r.length)}function VN(t,e){var r=""+Math.round(t);return r.length>=e?r:ur("0",e-r.length)+r}function UN(t,e){var r=""+t;return r.length>=e?r:ur("0",e-r.length)+r}var _T=Math.pow(2,32);function Gl(t,e){if(t>_T||t<-_T)return VN(t,e);var r=Math.round(t);return UN(r,e)}function G0(t,e){return e=e||0,t.length>=7+e&&(t.charCodeAt(e)|32)===103&&(t.charCodeAt(e+1)|32)===101&&(t.charCodeAt(e+2)|32)===110&&(t.charCodeAt(e+3)|32)===101&&(t.charCodeAt(e+4)|32)===114&&(t.charCodeAt(e+5)|32)===97&&(t.charCodeAt(e+6)|32)===108}var xT=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],Wm=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function BN(t){return t||(t={}),t[0]="General",t[1]="0",t[2]="0.00",t[3]="#,##0",t[4]="#,##0.00",t[9]="0%",t[10]="0.00%",t[11]="0.00E+00",t[12]="# ?/?",t[13]="# ??/??",t[14]="m/d/yy",t[15]="d-mmm-yy",t[16]="d-mmm",t[17]="mmm-yy",t[18]="h:mm AM/PM",t[19]="h:mm:ss AM/PM",t[20]="h:mm",t[21]="h:mm:ss",t[22]="m/d/yy h:mm",t[37]="#,##0 ;(#,##0)",t[38]="#,##0 ;[Red](#,##0)",t[39]="#,##0.00;(#,##0.00)",t[40]="#,##0.00;[Red](#,##0.00)",t[45]="mm:ss",t[46]="[h]:mm:ss",t[47]="mmss.0",t[48]="##0.0E+0",t[49]="@",t[56]='"/ "hh""mm""ss" "',t}var ht={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},yT={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},jN={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function q0(t,e,r){for(var n=t<0?-1:1,i=t*n,o=0,c=1,u=0,h=1,d=0,g=0,_=Math.floor(i);d<e&&(_=Math.floor(i),u=_*c+o,g=_*d+h,!(i-_<5e-8));)i=1/(i-_),o=c,c=u,h=d,d=g;if(g>e&&(d>e?(g=h,u=o):(g=d,u=c)),!r)return[0,n*u,g];var x=Math.floor(n*u/g);return[x,n*u-x*g,g]}function Oo(t,e,r){if(t>2958465||t<0)return null;var n=t|0,i=Math.floor(86400*(t-n)),o=0,c=[],u={D:n,T:i,u:86400*(t-n)-i,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(u.u)<1e-6&&(u.u=0),e&&e.date1904&&(n+=1462),u.u>.9999&&(u.u=0,++i==86400&&(u.T=i=0,++n,++u.D)),n===60)c=r?[1317,10,29]:[1900,2,29],o=3;else if(n===0)c=r?[1317,8,29]:[1900,1,0],o=6;else{n>60&&--n;var h=new Date(1900,0,1);h.setDate(h.getDate()+n-1),c=[h.getFullYear(),h.getMonth()+1,h.getDate()],o=h.getDay(),n<60&&(o=(o+6)%7),r&&(o=XN(h,c))}return u.y=c[0],u.m=c[1],u.d=c[2],u.S=i%60,i=Math.floor(i/60),u.M=i%60,i=Math.floor(i/60),u.H=i,u.q=o,u}var iS=new Date(1899,11,31,0,0,0),zN=iS.getTime(),HN=new Date(1900,2,1,0,0,0);function sS(t,e){var r=t.getTime();return e?r-=1461*24*60*60*1e3:t>=HN&&(r+=24*60*60*1e3),(r-(zN+(t.getTimezoneOffset()-iS.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function X1(t){return t.indexOf(".")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function GN(t){return t.indexOf("E")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function qN(t){var e=t<0?12:11,r=X1(t.toFixed(12));return r.length<=e||(r=t.toPrecision(10),r.length<=e)?r:t.toExponential(5)}function KN(t){var e=X1(t.toFixed(11));return e.length>(t<0?12:11)||e==="0"||e==="-0"?t.toPrecision(6):e}function of(t){var e=Math.floor(Math.log(Math.abs(t))*Math.LOG10E),r;return e>=-4&&e<=-1?r=t.toPrecision(10+e):Math.abs(e)<=9?r=qN(t):e===10?r=t.toFixed(10).substr(0,12):r=KN(t),X1(GN(r.toUpperCase()))}function jo(t,e){switch(typeof t){case"string":return t;case"boolean":return t?"TRUE":"FALSE";case"number":return(t|0)===t?t.toString(10):of(t);case"undefined":return"";case"object":if(t==null)return"";if(t instanceof Date)return ga(14,sS(t,e&&e.date1904),e)}throw new Error("unsupported value in General format: "+t)}function XN(t,e){e[0]-=581;var r=t.getDay();return t<60&&(r=(r+6)%7),r}function WN(t,e,r,n){var i="",o=0,c=0,u=r.y,h,d=0;switch(t){case 98:u=r.y+543;case 121:switch(e.length){case 1:case 2:h=u%100,d=2;break;default:h=u%1e4,d=4;break}break;case 109:switch(e.length){case 1:case 2:h=r.m,d=e.length;break;case 3:return Wm[r.m-1][1];case 5:return Wm[r.m-1][0];default:return Wm[r.m-1][2]}break;case 100:switch(e.length){case 1:case 2:h=r.d,d=e.length;break;case 3:return xT[r.q][0];default:return xT[r.q][1]}break;case 104:switch(e.length){case 1:case 2:h=1+(r.H+11)%12,d=e.length;break;default:throw"bad hour format: "+e}break;case 72:switch(e.length){case 1:case 2:h=r.H,d=e.length;break;default:throw"bad hour format: "+e}break;case 77:switch(e.length){case 1:case 2:h=r.M,d=e.length;break;default:throw"bad minute format: "+e}break;case 115:if(e!="s"&&e!="ss"&&e!=".0"&&e!=".00"&&e!=".000")throw"bad second format: "+e;return r.u===0&&(e=="s"||e=="ss")?ba(r.S,e.length):(n>=2?c=n===3?1e3:100:c=n===1?10:1,o=Math.round(c*(r.S+r.u)),o>=60*c&&(o=0),e==="s"?o===0?"0":""+o/c:(i=ba(o,2+n),e==="ss"?i.substr(0,2):"."+i.substr(2,e.length-1)));case 90:switch(e){case"[h]":case"[hh]":h=r.D*24+r.H;break;case"[m]":case"[mm]":h=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":h=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+e}d=e.length===3?1:2;break;case 101:h=u,d=1;break}var g=d>0?ba(h,d):"";return g}function Rs(t){var e=3;if(t.length<=e)return t;for(var r=t.length%e,n=t.substr(0,r);r!=t.length;r+=e)n+=(n.length>0?",":"")+t.substr(r,e);return n}var oS=/%/g;function YN(t,e,r){var n=e.replace(oS,""),i=e.length-n.length;return Fi(t,n,r*Math.pow(10,2*i))+ur("%",i)}function $N(t,e,r){for(var n=e.length-1;e.charCodeAt(n-1)===44;)--n;return Fi(t,e.substr(0,n),r/Math.pow(10,3*(e.length-n)))}function lS(t,e){var r,n=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+lS(t,-e);var i=t.indexOf(".");i===-1&&(i=t.indexOf("E"));var o=Math.floor(Math.log(e)*Math.LOG10E)%i;if(o<0&&(o+=i),r=(e/Math.pow(10,o)).toPrecision(n+1+(i+o)%i),r.indexOf("e")===-1){var c=Math.floor(Math.log(e)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(c-r.length+o):r+="E+"+(c-o);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,i)+"."+r.substr(2+i),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(u,h,d,g){return h+d+g.substr(0,(i+o)%i)+"."+g.substr(o)+"E"})}else r=e.toExponential(n);return t.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),t.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var cS=/# (\?+)( ?)\/( ?)(\d+)/;function QN(t,e,r){var n=parseInt(t[4],10),i=Math.round(e*n),o=Math.floor(i/n),c=i-o*n,u=n;return r+(o===0?"":""+o)+" "+(c===0?ur(" ",t[1].length+1+t[4].length):K1(c,t[1].length)+t[2]+"/"+t[3]+ba(u,t[4].length))}function ZN(t,e,r){return r+(e===0?"":""+e)+ur(" ",t[1].length+2+t[4].length)}var uS=/^#*0*\.([0#]+)/,fS=/\).*[0#]/,hS=/\(###\) ###\\?-####/;function Tn(t){for(var e="",r,n=0;n!=t.length;++n)switch(r=t.charCodeAt(n)){case 35:break;case 63:e+=" ";break;case 48:e+="0";break;default:e+=String.fromCharCode(r)}return e}function ET(t,e){var r=Math.pow(10,e);return""+Math.round(t*r)/r}function TT(t,e){var r=t-Math.floor(t),n=Math.pow(10,e);return e<(""+Math.round(r*n)).length?0:Math.round(r*n)}function JN(t,e){return e<(""+Math.round((t-Math.floor(t))*Math.pow(10,e))).length?1:0}function eF(t){return t<2147483647&&t>-2147483648?""+(t>=0?t|0:t-1|0):""+Math.floor(t)}function ca(t,e,r){if(t.charCodeAt(0)===40&&!e.match(fS)){var n=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?ca("n",n,r):"("+ca("n",n,-r)+")"}if(e.charCodeAt(e.length-1)===44)return $N(t,e,r);if(e.indexOf("%")!==-1)return YN(t,e,r);if(e.indexOf("E")!==-1)return lS(e,r);if(e.charCodeAt(0)===36)return"$"+ca(t,e.substr(e.charAt(1)==" "?2:1),r);var i,o,c,u,h=Math.abs(r),d=r<0?"-":"";if(e.match(/^00+$/))return d+Gl(h,e.length);if(e.match(/^[#?]+$/))return i=Gl(r,0),i==="0"&&(i=""),i.length>e.length?i:Tn(e.substr(0,e.length-i.length))+i;if(o=e.match(cS))return QN(o,h,d);if(e.match(/^#+0+$/))return d+Gl(h,e.length-e.indexOf("0"));if(o=e.match(uS))return i=ET(r,o[1].length).replace(/^([^\.]+)$/,"$1."+Tn(o[1])).replace(/\.$/,"."+Tn(o[1])).replace(/\.(\d*)$/,function(w,S){return"."+S+ur("0",Tn(o[1]).length-S.length)}),e.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),o=e.match(/^(0*)\.(#*)$/))return d+ET(h,o[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,o[1].length?"0.":".");if(o=e.match(/^#{1,3},##0(\.?)$/))return d+Rs(Gl(h,0));if(o=e.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+ca(t,e,-r):Rs(""+(Math.floor(r)+JN(r,o[1].length)))+"."+ba(TT(r,o[1].length),o[1].length);if(o=e.match(/^#,#*,#0/))return ca(t,e.replace(/^#,#*,/,""),r);if(o=e.match(/^([0#]+)(\\?-([0#]+))+$/))return i=rc(ca(t,e.replace(/[\\-]/g,""),r)),c=0,rc(rc(e.replace(/\\/g,"")).replace(/[0#]/g,function(w){return c<i.length?i.charAt(c++):w==="0"?"0":""}));if(e.match(hS))return i=ca(t,"##########",r),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var g="";if(o=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return c=Math.min(o[4].length,7),u=q0(h,Math.pow(10,c)-1,!1),i=""+d,g=Fi("n",o[1],u[1]),g.charAt(g.length-1)==" "&&(g=g.substr(0,g.length-1)+"0"),i+=g+o[2]+"/"+o[3],g=H0(u[2],c),g.length<o[4].length&&(g=Tn(o[4].substr(o[4].length-g.length))+g),i+=g,i;if(o=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return c=Math.min(Math.max(o[1].length,o[4].length),7),u=q0(h,Math.pow(10,c)-1,!0),d+(u[0]||(u[1]?"":"0"))+" "+(u[1]?K1(u[1],c)+o[2]+"/"+o[3]+H0(u[2],c):ur(" ",2*c+1+o[2].length+o[3].length));if(o=e.match(/^[#0?]+$/))return i=Gl(r,0),e.length<=i.length?i:Tn(e.substr(0,e.length-i.length))+i;if(o=e.match(/^([#0?]+)\.([#0]+)$/)){i=""+r.toFixed(Math.min(o[2].length,10)).replace(/([^0])0+$/,"$1"),c=i.indexOf(".");var _=e.indexOf(".")-c,x=e.length-i.length-_;return Tn(e.substr(0,_)+i+e.substr(e.length-x))}if(o=e.match(/^00,000\.([#0]*0)$/))return c=TT(r,o[1].length),r<0?"-"+ca(t,e,-r):Rs(eF(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(w){return"00,"+(w.length<3?ba(0,3-w.length):"")+w})+"."+ba(c,o[1].length);switch(e){case"###,##0.00":return ca(t,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var A=Rs(Gl(h,0));return A!=="0"?d+A:"";case"###,###.00":return ca(t,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return ca(t,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+e+"|")}function tF(t,e,r){for(var n=e.length-1;e.charCodeAt(n-1)===44;)--n;return Fi(t,e.substr(0,n),r/Math.pow(10,3*(e.length-n)))}function rF(t,e,r){var n=e.replace(oS,""),i=e.length-n.length;return Fi(t,n,r*Math.pow(10,2*i))+ur("%",i)}function dS(t,e){var r,n=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+dS(t,-e);var i=t.indexOf(".");i===-1&&(i=t.indexOf("E"));var o=Math.floor(Math.log(e)*Math.LOG10E)%i;if(o<0&&(o+=i),r=(e/Math.pow(10,o)).toPrecision(n+1+(i+o)%i),!r.match(/[Ee]/)){var c=Math.floor(Math.log(e)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(c-r.length+o):r+="E+"+(c-o),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(u,h,d,g){return h+d+g.substr(0,(i+o)%i)+"."+g.substr(o)+"E"})}else r=e.toExponential(n);return t.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),t.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function Qa(t,e,r){if(t.charCodeAt(0)===40&&!e.match(fS)){var n=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Qa("n",n,r):"("+Qa("n",n,-r)+")"}if(e.charCodeAt(e.length-1)===44)return tF(t,e,r);if(e.indexOf("%")!==-1)return rF(t,e,r);if(e.indexOf("E")!==-1)return dS(e,r);if(e.charCodeAt(0)===36)return"$"+Qa(t,e.substr(e.charAt(1)==" "?2:1),r);var i,o,c,u,h=Math.abs(r),d=r<0?"-":"";if(e.match(/^00+$/))return d+ba(h,e.length);if(e.match(/^[#?]+$/))return i=""+r,r===0&&(i=""),i.length>e.length?i:Tn(e.substr(0,e.length-i.length))+i;if(o=e.match(cS))return ZN(o,h,d);if(e.match(/^#+0+$/))return d+ba(h,e.length-e.indexOf("0"));if(o=e.match(uS))return i=(""+r).replace(/^([^\.]+)$/,"$1."+Tn(o[1])).replace(/\.$/,"."+Tn(o[1])),i=i.replace(/\.(\d*)$/,function(w,S){return"."+S+ur("0",Tn(o[1]).length-S.length)}),e.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),o=e.match(/^(0*)\.(#*)$/))return d+(""+h).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,o[1].length?"0.":".");if(o=e.match(/^#{1,3},##0(\.?)$/))return d+Rs(""+h);if(o=e.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Qa(t,e,-r):Rs(""+r)+"."+ur("0",o[1].length);if(o=e.match(/^#,#*,#0/))return Qa(t,e.replace(/^#,#*,/,""),r);if(o=e.match(/^([0#]+)(\\?-([0#]+))+$/))return i=rc(Qa(t,e.replace(/[\\-]/g,""),r)),c=0,rc(rc(e.replace(/\\/g,"")).replace(/[0#]/g,function(w){return c<i.length?i.charAt(c++):w==="0"?"0":""}));if(e.match(hS))return i=Qa(t,"##########",r),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var g="";if(o=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return c=Math.min(o[4].length,7),u=q0(h,Math.pow(10,c)-1,!1),i=""+d,g=Fi("n",o[1],u[1]),g.charAt(g.length-1)==" "&&(g=g.substr(0,g.length-1)+"0"),i+=g+o[2]+"/"+o[3],g=H0(u[2],c),g.length<o[4].length&&(g=Tn(o[4].substr(o[4].length-g.length))+g),i+=g,i;if(o=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return c=Math.min(Math.max(o[1].length,o[4].length),7),u=q0(h,Math.pow(10,c)-1,!0),d+(u[0]||(u[1]?"":"0"))+" "+(u[1]?K1(u[1],c)+o[2]+"/"+o[3]+H0(u[2],c):ur(" ",2*c+1+o[2].length+o[3].length));if(o=e.match(/^[#0?]+$/))return i=""+r,e.length<=i.length?i:Tn(e.substr(0,e.length-i.length))+i;if(o=e.match(/^([#0]+)\.([#0]+)$/)){i=""+r.toFixed(Math.min(o[2].length,10)).replace(/([^0])0+$/,"$1"),c=i.indexOf(".");var _=e.indexOf(".")-c,x=e.length-i.length-_;return Tn(e.substr(0,_)+i+e.substr(e.length-x))}if(o=e.match(/^00,000\.([#0]*0)$/))return r<0?"-"+Qa(t,e,-r):Rs(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(w){return"00,"+(w.length<3?ba(0,3-w.length):"")+w})+"."+ba(0,o[1].length);switch(e){case"###,###":case"##,###":case"#,###":var A=Rs(""+h);return A!=="0"?d+A:"";default:if(e.match(/\.[0#?]*$/))return Qa(t,e.slice(0,e.lastIndexOf(".")),r)+Tn(e.slice(e.lastIndexOf(".")))}throw new Error("unsupported format |"+e+"|")}function Fi(t,e,r){return(r|0)===r?Qa(t,e,r):ca(t,e,r)}function nF(t){for(var e=[],r=!1,n=0,i=0;n<t.length;++n)switch(t.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:e[e.length]=t.substr(i,n-i),i=n+1}if(e[e.length]=t.substr(i),r===!0)throw new Error("Format |"+t+"| unterminated string ");return e}var pS=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function Tc(t){for(var e=0,r="",n="";e<t.length;)switch(r=t.charAt(e)){case"G":G0(t,e)&&(e+=6),e++;break;case'"':for(;t.charCodeAt(++e)!==34&&e<t.length;);++e;break;case"\\":e+=2;break;case"_":e+=2;break;case"@":++e;break;case"B":case"b":if(t.charAt(e+1)==="1"||t.charAt(e+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(t.substr(e,3).toUpperCase()==="A/P"||t.substr(e,5).toUpperCase()==="AM/PM"||t.substr(e,5).toUpperCase()==="/")return!0;++e;break;case"[":for(n=r;t.charAt(e++)!=="]"&&e<t.length;)n+=t.charAt(e);if(n.match(pS))return!0;break;case".":case"0":case"#":for(;e<t.length&&("0#?.,E+-%".indexOf(r=t.charAt(++e))>-1||r=="\\"&&t.charAt(e+1)=="-"&&"0#".indexOf(t.charAt(e+2))>-1););break;case"?":for(;t.charAt(++e)===r;);break;case"*":++e,(t.charAt(e)==" "||t.charAt(e)=="*")&&++e;break;case"(":case")":++e;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;e<t.length&&"0123456789".indexOf(t.charAt(++e))>-1;);break;case" ":++e;break;default:++e;break}return!1}function aF(t,e,r,n){for(var i=[],o="",c=0,u="",h="t",d,g,_,x="H";c<t.length;)switch(u=t.charAt(c)){case"G":if(!G0(t,c))throw new Error("unrecognized character "+u+" in "+t);i[i.length]={t:"G",v:"General"},c+=7;break;case'"':for(o="";(_=t.charCodeAt(++c))!==34&&c<t.length;)o+=String.fromCharCode(_);i[i.length]={t:"t",v:o},++c;break;case"\\":var A=t.charAt(++c),w=A==="("||A===")"?A:"t";i[i.length]={t:w,v:A},++c;break;case"_":i[i.length]={t:"t",v:" "},c+=2;break;case"@":i[i.length]={t:"T",v:e},++c;break;case"B":case"b":if(t.charAt(c+1)==="1"||t.charAt(c+1)==="2"){if(d==null&&(d=Oo(e,r,t.charAt(c+1)==="2"),d==null))return"";i[i.length]={t:"X",v:t.substr(c,2)},h=u,c+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":u=u.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(e<0||d==null&&(d=Oo(e,r),d==null))return"";for(o=u;++c<t.length&&t.charAt(c).toLowerCase()===u;)o+=u;u==="m"&&h.toLowerCase()==="h"&&(u="M"),u==="h"&&(u=x),i[i.length]={t:u,v:o},h=u;break;case"A":case"a":case"":var S={t:u,v:u};if(d==null&&(d=Oo(e,r)),t.substr(c,3).toUpperCase()==="A/P"?(d!=null&&(S.v=d.H>=12?"P":"A"),S.t="T",x="h",c+=3):t.substr(c,5).toUpperCase()==="AM/PM"?(d!=null&&(S.v=d.H>=12?"PM":"AM"),S.t="T",c+=5,x="h"):t.substr(c,5).toUpperCase()==="/"?(d!=null&&(S.v=d.H>=12?"":""),S.t="T",c+=5,x="h"):(S.t="t",++c),d==null&&S.t==="T")return"";i[i.length]=S,h=u;break;case"[":for(o=u;t.charAt(c++)!=="]"&&c<t.length;)o+=t.charAt(c);if(o.slice(-1)!=="]")throw'unterminated "[" block: |'+o+"|";if(o.match(pS)){if(d==null&&(d=Oo(e,r),d==null))return"";i[i.length]={t:"Z",v:o.toLowerCase()},h=o.charAt(1)}else o.indexOf("$")>-1&&(o=(o.match(/\$([^-\[\]]*)/)||[])[1]||"$",Tc(t)||(i[i.length]={t:"t",v:o}));break;case".":if(d!=null){for(o=u;++c<t.length&&(u=t.charAt(c))==="0";)o+=u;i[i.length]={t:"s",v:o};break}case"0":case"#":for(o=u;++c<t.length&&"0#?.,E+-%".indexOf(u=t.charAt(c))>-1;)o+=u;i[i.length]={t:"n",v:o};break;case"?":for(o=u;t.charAt(++c)===u;)o+=u;i[i.length]={t:u,v:o},h=u;break;case"*":++c,(t.charAt(c)==" "||t.charAt(c)=="*")&&++c;break;case"(":case")":i[i.length]={t:n===1?"t":u,v:u},++c;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(o=u;c<t.length&&"0123456789".indexOf(t.charAt(++c))>-1;)o+=t.charAt(c);i[i.length]={t:"D",v:o};break;case" ":i[i.length]={t:u,v:u},++c;break;case"$":i[i.length]={t:"t",v:"$"},++c;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(u)===-1)throw new Error("unrecognized character "+u+" in "+t);i[i.length]={t:"t",v:u},++c;break}var C=0,z=0,W;for(c=i.length-1,h="t";c>=0;--c)switch(i[c].t){case"h":case"H":i[c].t=x,h="h",C<1&&(C=1);break;case"s":(W=i[c].v.match(/\.0+$/))&&(z=Math.max(z,W[0].length-1)),C<3&&(C=3);case"d":case"y":case"M":case"e":h=i[c].t;break;case"m":h==="s"&&(i[c].t="M",C<2&&(C=2));break;case"X":break;case"Z":C<1&&i[c].v.match(/[Hh]/)&&(C=1),C<2&&i[c].v.match(/[Mm]/)&&(C=2),C<3&&i[c].v.match(/[Ss]/)&&(C=3)}switch(C){case 0:break;case 1:d.u>=.5&&(d.u=0,++d.S),d.S>=60&&(d.S=0,++d.M),d.M>=60&&(d.M=0,++d.H);break;case 2:d.u>=.5&&(d.u=0,++d.S),d.S>=60&&(d.S=0,++d.M);break}var P="",re;for(c=0;c<i.length;++c)switch(i[c].t){case"t":case"T":case" ":case"D":break;case"X":i[c].v="",i[c].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":i[c].v=WN(i[c].t.charCodeAt(0),i[c].v,d,z),i[c].t="t";break;case"n":case"?":for(re=c+1;i[re]!=null&&((u=i[re].t)==="?"||u==="D"||(u===" "||u==="t")&&i[re+1]!=null&&(i[re+1].t==="?"||i[re+1].t==="t"&&i[re+1].v==="/")||i[c].t==="("&&(u===" "||u==="n"||u===")")||u==="t"&&(i[re].v==="/"||i[re].v===" "&&i[re+1]!=null&&i[re+1].t=="?"));)i[c].v+=i[re].v,i[re]={v:"",t:";"},++re;P+=i[c].v,c=re-1;break;case"G":i[c].t="t",i[c].v=jo(e,r);break}var Q="",ee,k;if(P.length>0){P.charCodeAt(0)==40?(ee=e<0&&P.charCodeAt(0)===45?-e:e,k=Fi("n",P,ee)):(ee=e<0&&n>1?-e:e,k=Fi("n",P,ee),ee<0&&i[0]&&i[0].t=="t"&&(k=k.substr(1),i[0].v="-"+i[0].v)),re=k.length-1;var T=i.length;for(c=0;c<i.length;++c)if(i[c]!=null&&i[c].t!="t"&&i[c].v.indexOf(".")>-1){T=c;break}var E=i.length;if(T===i.length&&k.indexOf("E")===-1){for(c=i.length-1;c>=0;--c)i[c]==null||"n?".indexOf(i[c].t)===-1||(re>=i[c].v.length-1?(re-=i[c].v.length,i[c].v=k.substr(re+1,i[c].v.length)):re<0?i[c].v="":(i[c].v=k.substr(0,re+1),re=-1),i[c].t="t",E=c);re>=0&&E<i.length&&(i[E].v=k.substr(0,re+1)+i[E].v)}else if(T!==i.length&&k.indexOf("E")===-1){for(re=k.indexOf(".")-1,c=T;c>=0;--c)if(!(i[c]==null||"n?".indexOf(i[c].t)===-1)){for(g=i[c].v.indexOf(".")>-1&&c===T?i[c].v.indexOf(".")-1:i[c].v.length-1,Q=i[c].v.substr(g+1);g>=0;--g)re>=0&&(i[c].v.charAt(g)==="0"||i[c].v.charAt(g)==="#")&&(Q=k.charAt(re--)+Q);i[c].v=Q,i[c].t="t",E=c}for(re>=0&&E<i.length&&(i[E].v=k.substr(0,re+1)+i[E].v),re=k.indexOf(".")+1,c=T;c<i.length;++c)if(!(i[c]==null||"n?(".indexOf(i[c].t)===-1&&c!==T)){for(g=i[c].v.indexOf(".")>-1&&c===T?i[c].v.indexOf(".")+1:0,Q=i[c].v.substr(0,g);g<i[c].v.length;++g)re<k.length&&(Q+=k.charAt(re++));i[c].v=Q,i[c].t="t",E=c}}}for(c=0;c<i.length;++c)i[c]!=null&&"n?".indexOf(i[c].t)>-1&&(ee=n>1&&e<0&&c>0&&i[c-1].v==="-"?-e:e,i[c].v=Fi(i[c].t,i[c].v,ee),i[c].t="t");var I="";for(c=0;c!==i.length;++c)i[c]!=null&&(I+=i[c].v);return I}var AT=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function wT(t,e){if(e==null)return!1;var r=parseFloat(e[2]);switch(e[1]){case"=":if(t==r)return!0;break;case">":if(t>r)return!0;break;case"<":if(t<r)return!0;break;case"<>":if(t!=r)return!0;break;case">=":if(t>=r)return!0;break;case"<=":if(t<=r)return!0;break}return!1}function iF(t,e){var r=nF(t),n=r.length,i=r[n-1].indexOf("@");if(n<4&&i>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof e!="number")return[4,r.length===4||i>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=i>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=i>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=i>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var o=e>0?r[0]:e<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,o];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var c=r[0].match(AT),u=r[1].match(AT);return wT(e,c)?[n,r[0]]:wT(e,u)?[n,r[1]]:[n,r[c!=null&&u!=null?2:1]]}return[n,o]}function ga(t,e,r){r==null&&(r={});var n="";switch(typeof t){case"string":t=="m/d/yy"&&r.dateNF?n=r.dateNF:n=t;break;case"number":t==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:ht)[t],n==null&&(n=r.table&&r.table[yT[t]]||ht[yT[t]]),n==null&&(n=jN[t]||"General");break}if(G0(n,0))return jo(e,r);e instanceof Date&&(e=sS(e,r.date1904));var i=iF(n,e);if(G0(i[1]))return jo(e,r);if(e===!0)e="TRUE";else if(e===!1)e="FALSE";else if(e===""||e==null)return"";return aF(i[1],e,r,i[0])}function Fo(t,e){if(typeof e!="number"){e=+e||-1;for(var r=0;r<392;++r){if(ht[r]==null){e<0&&(e=r);continue}if(ht[r]==t){e=r;break}}e<0&&(e=391)}return ht[e]=t,e}function mS(){ht=BN()}var sF={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},gS=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function oF(t){var e=typeof t=="number"?ht[t]:t;return e=e.replace(gS,"(\\d+)"),new RegExp("^"+e+"$")}function lF(t,e,r){var n=-1,i=-1,o=-1,c=-1,u=-1,h=-1;(e.match(gS)||[]).forEach(function(_,x){var A=parseInt(r[x+1],10);switch(_.toLowerCase().charAt(0)){case"y":n=A;break;case"d":o=A;break;case"h":c=A;break;case"s":h=A;break;case"m":c>=0?u=A:i=A;break}}),h>=0&&u==-1&&i>=0&&(u=i,i=-1);var d=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(i>=1?i:1)).slice(-2)+"-"+("00"+(o>=1?o:1)).slice(-2);d.length==7&&(d="0"+d),d.length==8&&(d="20"+d);var g=("00"+(c>=0?c:0)).slice(-2)+":"+("00"+(u>=0?u:0)).slice(-2)+":"+("00"+(h>=0?h:0)).slice(-2);return c==-1&&u==-1&&h==-1?d:n==-1&&i==-1&&o==-1?g:d+"T"+g}var cF=function(){var t={};t.version="1.2.0";function e(){for(var k=0,T=new Array(256),E=0;E!=256;++E)k=E,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,T[E]=k;return typeof Int32Array<"u"?new Int32Array(T):T}var r=e();function n(k){var T=0,E=0,I=0,O=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(I=0;I!=256;++I)O[I]=k[I];for(I=0;I!=256;++I)for(E=k[I],T=256+I;T<4096;T+=256)E=O[T]=E>>>8^k[E&255];var D=[];for(I=1;I!=16;++I)D[I-1]=typeof Int32Array<"u"?O.subarray(I*256,I*256+256):O.slice(I*256,I*256+256);return D}var i=n(r),o=i[0],c=i[1],u=i[2],h=i[3],d=i[4],g=i[5],_=i[6],x=i[7],A=i[8],w=i[9],S=i[10],C=i[11],z=i[12],W=i[13],P=i[14];function re(k,T){for(var E=T^-1,I=0,O=k.length;I<O;)E=E>>>8^r[(E^k.charCodeAt(I++))&255];return~E}function Q(k,T){for(var E=T^-1,I=k.length-15,O=0;O<I;)E=P[k[O++]^E&255]^W[k[O++]^E>>8&255]^z[k[O++]^E>>16&255]^C[k[O++]^E>>>24]^S[k[O++]]^w[k[O++]]^A[k[O++]]^x[k[O++]]^_[k[O++]]^g[k[O++]]^d[k[O++]]^h[k[O++]]^u[k[O++]]^c[k[O++]]^o[k[O++]]^r[k[O++]];for(I+=15;O<I;)E=E>>>8^r[(E^k[O++])&255];return~E}function ee(k,T){for(var E=T^-1,I=0,O=k.length,D=0,F=0;I<O;)D=k.charCodeAt(I++),D<128?E=E>>>8^r[(E^D)&255]:D<2048?(E=E>>>8^r[(E^(192|D>>6&31))&255],E=E>>>8^r[(E^(128|D&63))&255]):D>=55296&&D<57344?(D=(D&1023)+64,F=k.charCodeAt(I++)&1023,E=E>>>8^r[(E^(240|D>>8&7))&255],E=E>>>8^r[(E^(128|D>>2&63))&255],E=E>>>8^r[(E^(128|F>>6&15|(D&3)<<4))&255],E=E>>>8^r[(E^(128|F&63))&255]):(E=E>>>8^r[(E^(224|D>>12&15))&255],E=E>>>8^r[(E^(128|D>>6&63))&255],E=E>>>8^r[(E^(128|D&63))&255]);return~E}return t.table=r,t.bstr=re,t.buf=Q,t.str=ee,t}(),Dt=function(){var e={};e.version="1.2.1";function r(N,q){for(var U=N.split("/"),B=q.split("/"),H=0,X=0,de=Math.min(U.length,B.length);H<de;++H){if(X=U[H].length-B[H].length)return X;if(U[H]!=B[H])return U[H]<B[H]?-1:1}return U.length-B.length}function n(N){if(N.charAt(N.length-1)=="/")return N.slice(0,-1).indexOf("/")===-1?N:n(N.slice(0,-1));var q=N.lastIndexOf("/");return q===-1?N:N.slice(0,q+1)}function i(N){if(N.charAt(N.length-1)=="/")return i(N.slice(0,-1));var q=N.lastIndexOf("/");return q===-1?N:N.slice(q+1)}function o(N,q){typeof q=="string"&&(q=new Date(q));var U=q.getHours();U=U<<6|q.getMinutes(),U=U<<5|q.getSeconds()>>>1,N.write_shift(2,U);var B=q.getFullYear()-1980;B=B<<4|q.getMonth()+1,B=B<<5|q.getDate(),N.write_shift(2,B)}function c(N){var q=N.read_shift(2)&65535,U=N.read_shift(2)&65535,B=new Date,H=U&31;U>>>=5;var X=U&15;U>>>=4,B.setMilliseconds(0),B.setFullYear(U+1980),B.setMonth(X-1),B.setDate(H);var de=q&31;q>>>=5;var xe=q&63;return q>>>=6,B.setHours(q),B.setMinutes(xe),B.setSeconds(de<<1),B}function u(N){Qr(N,0);for(var q={},U=0;N.l<=N.length-4;){var B=N.read_shift(2),H=N.read_shift(2),X=N.l+H,de={};switch(B){case 21589:U=N.read_shift(1),U&1&&(de.mtime=N.read_shift(4)),H>5&&(U&2&&(de.atime=N.read_shift(4)),U&4&&(de.ctime=N.read_shift(4))),de.mtime&&(de.mt=new Date(de.mtime*1e3));break}N.l=X,q[B]=de}return q}var h;function d(){return h||(h={})}function g(N,q){if(N[0]==80&&N[1]==75)return Ki(N,q);if((N[0]|32)==109&&(N[1]|32)==105)return nl(N,q);if(N.length<512)throw new Error("CFB file size "+N.length+" < 512");var U=3,B=512,H=0,X=0,de=0,xe=0,ce=0,me=[],ge=N.slice(0,512);Qr(ge,0);var Oe=_(ge);switch(U=Oe[0],U){case 3:B=512;break;case 4:B=4096;break;case 0:if(Oe[1]==0)return Ki(N,q);default:throw new Error("Major Version: Expected 3 or 4 saw "+U)}B!==512&&(ge=N.slice(0,B),Qr(ge,28));var Le=N.slice(0,B);x(ge,U);var ze=ge.read_shift(4,"i");if(U===3&&ze!==0)throw new Error("# Directory Sectors: Expected 0 saw "+ze);ge.l+=4,de=ge.read_shift(4,"i"),ge.l+=4,ge.chk("00100000","Mini Stream Cutoff Size: "),xe=ge.read_shift(4,"i"),H=ge.read_shift(4,"i"),ce=ge.read_shift(4,"i"),X=ge.read_shift(4,"i");for(var Me=-1,je=0;je<109&&(Me=ge.read_shift(4,"i"),!(Me<0));++je)me[je]=Me;var at=A(N,B);C(ce,X,at,B,me);var Pt=W(at,de,me,B);Pt[de].name="!Directory",H>0&&xe!==F&&(Pt[xe].name="!MiniFAT"),Pt[me[0]].name="!FAT",Pt.fat_addrs=me,Pt.ssz=B;var St={},Ct=[],Pn=[],Ma=[];P(de,Pt,at,Ct,H,St,Pn,xe),w(Pn,Ma,Ct),Ct.shift();var vn={FileIndex:Pn,FullPaths:Ma};return q&&q.raw&&(vn.raw={header:Le,sectors:at}),vn}function _(N){if(N[N.l]==80&&N[N.l+1]==75)return[0,0];N.chk(Fe,"Header Signature: "),N.l+=16;var q=N.read_shift(2,"u");return[N.read_shift(2,"u"),q]}function x(N,q){var U=9;switch(N.l+=2,U=N.read_shift(2)){case 9:if(q!=3)throw new Error("Sector Shift: Expected 9 saw "+U);break;case 12:if(q!=4)throw new Error("Sector Shift: Expected 12 saw "+U);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+U)}N.chk("0600","Mini Sector Shift: "),N.chk("000000000000","Reserved: ")}function A(N,q){for(var U=Math.ceil(N.length/q)-1,B=[],H=1;H<U;++H)B[H-1]=N.slice(H*q,(H+1)*q);return B[U-1]=N.slice(U*q),B}function w(N,q,U){for(var B=0,H=0,X=0,de=0,xe=0,ce=U.length,me=[],ge=[];B<ce;++B)me[B]=ge[B]=B,q[B]=U[B];for(;xe<ge.length;++xe)B=ge[xe],H=N[B].L,X=N[B].R,de=N[B].C,me[B]===B&&(H!==-1&&me[H]!==H&&(me[B]=me[H]),X!==-1&&me[X]!==X&&(me[B]=me[X])),de!==-1&&(me[de]=B),H!==-1&&B!=me[B]&&(me[H]=me[B],ge.lastIndexOf(H)<xe&&ge.push(H)),X!==-1&&B!=me[B]&&(me[X]=me[B],ge.lastIndexOf(X)<xe&&ge.push(X));for(B=1;B<ce;++B)me[B]===B&&(X!==-1&&me[X]!==X?me[B]=me[X]:H!==-1&&me[H]!==H&&(me[B]=me[H]));for(B=1;B<ce;++B)if(N[B].type!==0){if(xe=B,xe!=me[xe])do xe=me[xe],q[B]=q[xe]+"/"+q[B];while(xe!==0&&me[xe]!==-1&&xe!=me[xe]);me[B]=-1}for(q[0]+="/",B=1;B<ce;++B)N[B].type!==2&&(q[B]+="/")}function S(N,q,U){for(var B=N.start,H=N.size,X=[],de=B;U&&H>0&&de>=0;)X.push(q.slice(de*D,de*D+D)),H-=D,de=bo(U,de*4);return X.length===0?Or(0):As(X).slice(0,N.size)}function C(N,q,U,B,H){var X=F;if(N===F){if(q!==0)throw new Error("DIFAT chain shorter than expected")}else if(N!==-1){var de=U[N],xe=(B>>>2)-1;if(!de)return;for(var ce=0;ce<xe&&(X=bo(de,ce*4))!==F;++ce)H.push(X);C(bo(de,B-4),q-1,U,B,H)}}function z(N,q,U,B,H){var X=[],de=[];H||(H=[]);var xe=B-1,ce=0,me=0;for(ce=q;ce>=0;){H[ce]=!0,X[X.length]=ce,de.push(N[ce]);var ge=U[Math.floor(ce*4/B)];if(me=ce*4&xe,B<4+me)throw new Error("FAT boundary crossed: "+ce+" 4 "+B);if(!N[ge])break;ce=bo(N[ge],me)}return{nodes:X,data:FT([de])}}function W(N,q,U,B){var H=N.length,X=[],de=[],xe=[],ce=[],me=B-1,ge=0,Oe=0,Le=0,ze=0;for(ge=0;ge<H;++ge)if(xe=[],Le=ge+q,Le>=H&&(Le-=H),!de[Le]){ce=[];var Me=[];for(Oe=Le;Oe>=0;){Me[Oe]=!0,de[Oe]=!0,xe[xe.length]=Oe,ce.push(N[Oe]);var je=U[Math.floor(Oe*4/B)];if(ze=Oe*4&me,B<4+ze)throw new Error("FAT boundary crossed: "+Oe+" 4 "+B);if(!N[je]||(Oe=bo(N[je],ze),Me[Oe]))break}X[Le]={nodes:xe,data:FT([ce])}}return X}function P(N,q,U,B,H,X,de,xe){for(var ce=0,me=B.length?2:0,ge=q[N].data,Oe=0,Le=0,ze;Oe<ge.length;Oe+=128){var Me=ge.slice(Oe,Oe+128);Qr(Me,64),Le=Me.read_shift(2),ze=Q1(Me,0,Le-me),B.push(ze);var je={name:ze,type:Me.read_shift(1),color:Me.read_shift(1),L:Me.read_shift(4,"i"),R:Me.read_shift(4,"i"),C:Me.read_shift(4,"i"),clsid:Me.read_shift(16),state:Me.read_shift(4,"i"),start:0,size:0},at=Me.read_shift(2)+Me.read_shift(2)+Me.read_shift(2)+Me.read_shift(2);at!==0&&(je.ct=re(Me,Me.l-8));var Pt=Me.read_shift(2)+Me.read_shift(2)+Me.read_shift(2)+Me.read_shift(2);Pt!==0&&(je.mt=re(Me,Me.l-8)),je.start=Me.read_shift(4,"i"),je.size=Me.read_shift(4,"i"),je.size<0&&je.start<0&&(je.size=je.type=0,je.start=F,je.name=""),je.type===5?(ce=je.start,H>0&&ce!==F&&(q[ce].name="!StreamData")):je.size>=4096?(je.storage="fat",q[je.start]===void 0&&(q[je.start]=z(U,je.start,q.fat_addrs,q.ssz)),q[je.start].name=je.name,je.content=q[je.start].data.slice(0,je.size)):(je.storage="minifat",je.size<0?je.size=0:ce!==F&&je.start!==F&&q[ce]&&(je.content=S(je,q[ce].data,(q[xe]||{}).data))),je.content&&Qr(je.content,0),X[ze]=je,de.push(je)}}function re(N,q){return new Date((Gn(N,q+4)/1e7*Math.pow(2,32)+Gn(N,q)/1e7-11644473600)*1e3)}function Q(N,q){return d(),g(h.readFileSync(N),q)}function ee(N,q){var U=q&&q.type;switch(U||wt&&Buffer.isBuffer(N)&&(U="buffer"),U||"base64"){case"file":return Q(N,q);case"base64":return g(Ca(Wn(N)),q);case"binary":return g(Ca(N),q)}return g(N,q)}function k(N,q){var U=q||{},B=U.root||"Root Entry";if(N.FullPaths||(N.FullPaths=[]),N.FileIndex||(N.FileIndex=[]),N.FullPaths.length!==N.FileIndex.length)throw new Error("inconsistent CFB structure");N.FullPaths.length===0&&(N.FullPaths[0]=B+"/",N.FileIndex[0]={name:B,type:5}),U.CLSID&&(N.FileIndex[0].clsid=U.CLSID),T(N)}function T(N){var q="Sh33tJ5";if(!Dt.find(N,"/"+q)){var U=Or(4);U[0]=55,U[1]=U[3]=50,U[2]=54,N.FileIndex.push({name:q,type:2,content:U,size:4,L:69,R:69,C:69}),N.FullPaths.push(N.FullPaths[0]+q),E(N)}}function E(N,q){k(N);for(var U=!1,B=!1,H=N.FullPaths.length-1;H>=0;--H){var X=N.FileIndex[H];switch(X.type){case 0:B?U=!0:(N.FileIndex.pop(),N.FullPaths.pop());break;case 1:case 2:case 5:B=!0,isNaN(X.R*X.L*X.C)&&(U=!0),X.R>-1&&X.L>-1&&X.R==X.L&&(U=!0);break;default:U=!0;break}}if(!(!U&&!q)){var de=new Date(1987,1,19),xe=0,ce=Object.create?Object.create(null):{},me=[];for(H=0;H<N.FullPaths.length;++H)ce[N.FullPaths[H]]=!0,N.FileIndex[H].type!==0&&me.push([N.FullPaths[H],N.FileIndex[H]]);for(H=0;H<me.length;++H){var ge=n(me[H][0]);B=ce[ge],B||(me.push([ge,{name:i(ge).replace("/",""),type:1,clsid:ne,ct:de,mt:de,content:null}]),ce[ge]=!0)}for(me.sort(function(ze,Me){return r(ze[0],Me[0])}),N.FullPaths=[],N.FileIndex=[],H=0;H<me.length;++H)N.FullPaths[H]=me[H][0],N.FileIndex[H]=me[H][1];for(H=0;H<me.length;++H){var Oe=N.FileIndex[H],Le=N.FullPaths[H];if(Oe.name=i(Le).replace("/",""),Oe.L=Oe.R=Oe.C=-(Oe.color=1),Oe.size=Oe.content?Oe.content.length:0,Oe.start=0,Oe.clsid=Oe.clsid||ne,H===0)Oe.C=me.length>1?1:-1,Oe.size=0,Oe.type=5;else if(Le.slice(-1)=="/"){for(xe=H+1;xe<me.length&&n(N.FullPaths[xe])!=Le;++xe);for(Oe.C=xe>=me.length?-1:xe,xe=H+1;xe<me.length&&n(N.FullPaths[xe])!=n(Le);++xe);Oe.R=xe>=me.length?-1:xe,Oe.type=1}else n(N.FullPaths[H+1]||"")==n(Le)&&(Oe.R=H+1),Oe.type=2}}}function I(N,q){var U=q||{};if(U.fileType=="mad")return Qt(N,U);switch(E(N),U.fileType){case"zip":return xa(N,U)}var B=function(ze){for(var Me=0,je=0,at=0;at<ze.FileIndex.length;++at){var Pt=ze.FileIndex[at];if(Pt.content){var St=Pt.content.length;St>0&&(St<4096?Me+=St+63>>6:je+=St+511>>9)}}for(var Ct=ze.FullPaths.length+3>>2,Pn=Me+7>>3,Ma=Me+127>>7,vn=Pn+je+Ct+Ma,kn=vn+127>>7,La=kn<=109?0:Math.ceil((kn-109)/127);vn+kn+La+127>>7>kn;)La=++kn<=109?0:Math.ceil((kn-109)/127);var _n=[1,La,kn,Ma,Ct,je,Me,0];return ze.FileIndex[0].size=Me<<6,_n[7]=(ze.FileIndex[0].start=_n[0]+_n[1]+_n[2]+_n[3]+_n[4]+_n[5])+(_n[6]+7>>3),_n}(N),H=Or(B[7]<<9),X=0,de=0;{for(X=0;X<8;++X)H.write_shift(1,Ce[X]);for(X=0;X<8;++X)H.write_shift(2,0);for(H.write_shift(2,62),H.write_shift(2,3),H.write_shift(2,65534),H.write_shift(2,9),H.write_shift(2,6),X=0;X<3;++X)H.write_shift(2,0);for(H.write_shift(4,0),H.write_shift(4,B[2]),H.write_shift(4,B[0]+B[1]+B[2]+B[3]-1),H.write_shift(4,0),H.write_shift(4,4096),H.write_shift(4,B[3]?B[0]+B[1]+B[2]-1:F),H.write_shift(4,B[3]),H.write_shift(-4,B[1]?B[0]-1:F),H.write_shift(4,B[1]),X=0;X<109;++X)H.write_shift(-4,X<B[2]?B[1]+X:-1)}if(B[1])for(de=0;de<B[1];++de){for(;X<236+de*127;++X)H.write_shift(-4,X<B[2]?B[1]+X:-1);H.write_shift(-4,de===B[1]-1?F:de+1)}var xe=function(ze){for(de+=ze;X<de-1;++X)H.write_shift(-4,X+1);ze&&(++X,H.write_shift(-4,F))};for(de=X=0,de+=B[1];X<de;++X)H.write_shift(-4,oe.DIFSECT);for(de+=B[2];X<de;++X)H.write_shift(-4,oe.FATSECT);xe(B[3]),xe(B[4]);for(var ce=0,me=0,ge=N.FileIndex[0];ce<N.FileIndex.length;++ce)ge=N.FileIndex[ce],ge.content&&(me=ge.content.length,!(me<4096)&&(ge.start=de,xe(me+511>>9)));for(xe(B[6]+7>>3);H.l&511;)H.write_shift(-4,oe.ENDOFCHAIN);for(de=X=0,ce=0;ce<N.FileIndex.length;++ce)ge=N.FileIndex[ce],ge.content&&(me=ge.content.length,!(!me||me>=4096)&&(ge.start=de,xe(me+63>>6)));for(;H.l&511;)H.write_shift(-4,oe.ENDOFCHAIN);for(X=0;X<B[4]<<2;++X){var Oe=N.FullPaths[X];if(!Oe||Oe.length===0){for(ce=0;ce<17;++ce)H.write_shift(4,0);for(ce=0;ce<3;++ce)H.write_shift(4,-1);for(ce=0;ce<12;++ce)H.write_shift(4,0);continue}ge=N.FileIndex[X],X===0&&(ge.start=ge.size?ge.start-1:F);var Le=X===0&&U.root||ge.name;if(me=2*(Le.length+1),H.write_shift(64,Le,"utf16le"),H.write_shift(2,me),H.write_shift(1,ge.type),H.write_shift(1,ge.color),H.write_shift(-4,ge.L),H.write_shift(-4,ge.R),H.write_shift(-4,ge.C),ge.clsid)H.write_shift(16,ge.clsid,"hex");else for(ce=0;ce<4;++ce)H.write_shift(4,0);H.write_shift(4,ge.state||0),H.write_shift(4,0),H.write_shift(4,0),H.write_shift(4,0),H.write_shift(4,0),H.write_shift(4,ge.start),H.write_shift(4,ge.size),H.write_shift(4,0)}for(X=1;X<N.FileIndex.length;++X)if(ge=N.FileIndex[X],ge.size>=4096)if(H.l=ge.start+1<<9,wt&&Buffer.isBuffer(ge.content))ge.content.copy(H,H.l,0,ge.size),H.l+=ge.size+511&-512;else{for(ce=0;ce<ge.size;++ce)H.write_shift(1,ge.content[ce]);for(;ce&511;++ce)H.write_shift(1,0)}for(X=1;X<N.FileIndex.length;++X)if(ge=N.FileIndex[X],ge.size>0&&ge.size<4096)if(wt&&Buffer.isBuffer(ge.content))ge.content.copy(H,H.l,0,ge.size),H.l+=ge.size+63&-64;else{for(ce=0;ce<ge.size;++ce)H.write_shift(1,ge.content[ce]);for(;ce&63;++ce)H.write_shift(1,0)}if(wt)H.l=H.length;else for(;H.l<H.length;)H.write_shift(1,0);return H}function O(N,q){var U=N.FullPaths.map(function(ce){return ce.toUpperCase()}),B=U.map(function(ce){var me=ce.split("/");return me[me.length-(ce.slice(-1)=="/"?2:1)]}),H=!1;q.charCodeAt(0)===47?(H=!0,q=U[0].slice(0,-1)+q):H=q.indexOf("/")!==-1;var X=q.toUpperCase(),de=H===!0?U.indexOf(X):B.indexOf(X);if(de!==-1)return N.FileIndex[de];var xe=!X.match(Iu);for(X=X.replace(Sn,""),xe&&(X=X.replace(Iu,"!")),de=0;de<U.length;++de)if((xe?U[de].replace(Iu,"!"):U[de]).replace(Sn,"")==X||(xe?B[de].replace(Iu,"!"):B[de]).replace(Sn,"")==X)return N.FileIndex[de];return null}var D=64,F=-2,Fe="d0cf11e0a1b11ae1",Ce=[208,207,17,224,161,177,26,225],ne="00000000000000000000000000000000",oe={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:F,FREESECT:-1,HEADER_SIGNATURE:Fe,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:ne,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function be(N,q,U){d();var B=I(N,U);h.writeFileSync(q,B)}function te(N){for(var q=new Array(N.length),U=0;U<N.length;++U)q[U]=String.fromCharCode(N[U]);return q.join("")}function G(N,q){var U=I(N,q);switch(q&&q.type||"buffer"){case"file":return d(),h.writeFileSync(q.filename,U),U;case"binary":return typeof U=="string"?U:te(U);case"base64":return gT(typeof U=="string"?U:te(U));case"buffer":if(wt)return Buffer.isBuffer(U)?U:$o(U);case"array":return typeof U=="string"?Ca(U):U}return U}var se;function M(N){try{var q=N.InflateRaw,U=new q;if(U._processChunk(new Uint8Array([3,0]),U._finishFlushFlag),U.bytesRead)se=N;else throw new Error("zlib does not expose bytesRead")}catch(B){console.error("cannot use native zlib: "+(B.message||B))}}function j(N,q){if(!se)return Gi(N,q);var U=se.InflateRaw,B=new U,H=B._processChunk(N.slice(N.l),B._finishFlushFlag);return N.l+=B.bytesRead,H}function Y(N){return se?se.deflateRawSync(N):ot(N)}var Z=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],ue=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],Ie=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function Ee(N){var q=(N<<1|N<<11)&139536|(N<<5|N<<15)&558144;return(q>>16|q>>8|q)&255}for(var we=typeof Uint8Array<"u",Te=we?new Uint8Array(256):[],Ue=0;Ue<256;++Ue)Te[Ue]=Ee(Ue);function K(N,q){var U=Te[N&255];return q<=8?U>>>8-q:(U=U<<8|Te[N>>8&255],q<=16?U>>>16-q:(U=U<<8|Te[N>>16&255],U>>>24-q))}function nt(N,q){var U=q&7,B=q>>>3;return(N[B]|(U<=6?0:N[B+1]<<8))>>>U&3}function Ge(N,q){var U=q&7,B=q>>>3;return(N[B]|(U<=5?0:N[B+1]<<8))>>>U&7}function Ke(N,q){var U=q&7,B=q>>>3;return(N[B]|(U<=4?0:N[B+1]<<8))>>>U&15}function Be(N,q){var U=q&7,B=q>>>3;return(N[B]|(U<=3?0:N[B+1]<<8))>>>U&31}function Ne(N,q){var U=q&7,B=q>>>3;return(N[B]|(U<=1?0:N[B+1]<<8))>>>U&127}function Ye(N,q,U){var B=q&7,H=q>>>3,X=(1<<U)-1,de=N[H]>>>B;return U<8-B||(de|=N[H+1]<<8-B,U<16-B)||(de|=N[H+2]<<16-B,U<24-B)||(de|=N[H+3]<<24-B),de&X}function ut(N,q,U){var B=q&7,H=q>>>3;return B<=5?N[H]|=(U&7)<<B:(N[H]|=U<<B&255,N[H+1]=(U&7)>>8-B),q+3}function _t(N,q,U){var B=q&7,H=q>>>3;return U=(U&1)<<B,N[H]|=U,q+1}function rr(N,q,U){var B=q&7,H=q>>>3;return U<<=B,N[H]|=U&255,U>>>=8,N[H+1]=U,q+8}function _r(N,q,U){var B=q&7,H=q>>>3;return U<<=B,N[H]|=U&255,U>>>=8,N[H+1]=U&255,N[H+2]=U>>>8,q+16}function fr(N,q){var U=N.length,B=2*U>q?2*U:q+5,H=0;if(U>=q)return N;if(wt){var X=vT(B);if(N.copy)N.copy(X);else for(;H<N.length;++H)X[H]=N[H];return X}else if(we){var de=new Uint8Array(B);if(de.set)de.set(N);else for(;H<U;++H)de[H]=N[H];return de}return N.length=B,N}function Et(N){for(var q=new Array(N),U=0;U<N;++U)q[U]=0;return q}function er(N,q,U){var B=1,H=0,X=0,de=0,xe=0,ce=N.length,me=we?new Uint16Array(32):Et(32);for(X=0;X<32;++X)me[X]=0;for(X=ce;X<U;++X)N[X]=0;ce=N.length;var ge=we?new Uint16Array(ce):Et(ce);for(X=0;X<ce;++X)me[H=N[X]]++,B<H&&(B=H),ge[X]=0;for(me[0]=0,X=1;X<=B;++X)me[X+16]=xe=xe+me[X-1]<<1;for(X=0;X<ce;++X)xe=N[X],xe!=0&&(ge[X]=me[xe+16]++);var Oe=0;for(X=0;X<ce;++X)if(Oe=N[X],Oe!=0)for(xe=K(ge[X],B)>>B-Oe,de=(1<<B+4-Oe)-1;de>=0;--de)q[xe|de<<Oe]=Oe&15|X<<4;return B}var Ze=we?new Uint16Array(512):Et(512),Je=we?new Uint16Array(32):Et(32);if(!we){for(var dt=0;dt<512;++dt)Ze[dt]=0;for(dt=0;dt<32;++dt)Je[dt]=0}(function(){for(var N=[],q=0;q<32;q++)N.push(5);er(N,Je,32);var U=[];for(q=0;q<=143;q++)U.push(8);for(;q<=255;q++)U.push(9);for(;q<=279;q++)U.push(7);for(;q<=287;q++)U.push(8);er(U,Ze,288)})();var Lt=function(){for(var q=we?new Uint8Array(32768):[],U=0,B=0;U<Ie.length-1;++U)for(;B<Ie[U+1];++B)q[B]=U;for(;B<32768;++B)q[B]=29;var H=we?new Uint8Array(259):[];for(U=0,B=0;U<ue.length-1;++U)for(;B<ue[U+1];++B)H[B]=U;function X(xe,ce){for(var me=0;me<xe.length;){var ge=Math.min(65535,xe.length-me),Oe=me+ge==xe.length;for(ce.write_shift(1,+Oe),ce.write_shift(2,ge),ce.write_shift(2,~ge&65535);ge-- >0;)ce[ce.l++]=xe[me++]}return ce.l}function de(xe,ce){for(var me=0,ge=0,Oe=we?new Uint16Array(32768):[];ge<xe.length;){var Le=Math.min(65535,xe.length-ge);if(Le<10){for(me=ut(ce,me,+(ge+Le==xe.length)),me&7&&(me+=8-(me&7)),ce.l=me/8|0,ce.write_shift(2,Le),ce.write_shift(2,~Le&65535);Le-- >0;)ce[ce.l++]=xe[ge++];me=ce.l*8;continue}me=ut(ce,me,+(ge+Le==xe.length)+2);for(var ze=0;Le-- >0;){var Me=xe[ge];ze=(ze<<5^Me)&32767;var je=-1,at=0;if((je=Oe[ze])&&(je|=ge&-32768,je>ge&&(je-=32768),je<ge))for(;xe[je+at]==xe[ge+at]&&at<250;)++at;if(at>2){Me=H[at],Me<=22?me=rr(ce,me,Te[Me+1]>>1)-1:(rr(ce,me,3),me+=5,rr(ce,me,Te[Me-23]>>5),me+=3);var Pt=Me<8?0:Me-4>>2;Pt>0&&(_r(ce,me,at-ue[Me]),me+=Pt),Me=q[ge-je],me=rr(ce,me,Te[Me]>>3),me-=3;var St=Me<4?0:Me-2>>1;St>0&&(_r(ce,me,ge-je-Ie[Me]),me+=St);for(var Ct=0;Ct<at;++Ct)Oe[ze]=ge&32767,ze=(ze<<5^xe[ge])&32767,++ge;Le-=at-1}else Me<=143?Me=Me+48:me=_t(ce,me,1),me=rr(ce,me,Te[Me]),Oe[ze]=ge&32767,++ge}me=rr(ce,me,0)-1}return ce.l=(me+7)/8|0,ce.l}return function(ce,me){return ce.length<8?X(ce,me):de(ce,me)}}();function ot(N){var q=Or(50+Math.floor(N.length*1.1)),U=Lt(N,q);return q.slice(0,U)}var Ft=we?new Uint16Array(32768):Et(32768),Vt=we?new Uint16Array(32768):Et(32768),Ot=we?new Uint16Array(128):Et(128),Lr=1,Cn=1;function Hi(N,q){var U=Be(N,q)+257;q+=5;var B=Be(N,q)+1;q+=5;var H=Ke(N,q)+4;q+=4;for(var X=0,de=we?new Uint8Array(19):Et(19),xe=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],ce=1,me=we?new Uint8Array(8):Et(8),ge=we?new Uint8Array(8):Et(8),Oe=de.length,Le=0;Le<H;++Le)de[Z[Le]]=X=Ge(N,q),ce<X&&(ce=X),me[X]++,q+=3;var ze=0;for(me[0]=0,Le=1;Le<=ce;++Le)ge[Le]=ze=ze+me[Le-1]<<1;for(Le=0;Le<Oe;++Le)(ze=de[Le])!=0&&(xe[Le]=ge[ze]++);var Me=0;for(Le=0;Le<Oe;++Le)if(Me=de[Le],Me!=0){ze=Te[xe[Le]]>>8-Me;for(var je=(1<<7-Me)-1;je>=0;--je)Ot[ze|je<<Me]=Me&7|Le<<3}var at=[];for(ce=1;at.length<U+B;)switch(ze=Ot[Ne(N,q)],q+=ze&7,ze>>>=3){case 16:for(X=3+nt(N,q),q+=2,ze=at[at.length-1];X-- >0;)at.push(ze);break;case 17:for(X=3+Ge(N,q),q+=3;X-- >0;)at.push(0);break;case 18:for(X=11+Ne(N,q),q+=7;X-- >0;)at.push(0);break;default:at.push(ze),ce<ze&&(ce=ze);break}var Pt=at.slice(0,U),St=at.slice(U);for(Le=U;Le<286;++Le)Pt[Le]=0;for(Le=B;Le<30;++Le)St[Le]=0;return Lr=er(Pt,Ft,286),Cn=er(St,Vt,30),q}function li(N,q){if(N[0]==3&&!(N[1]&3))return[Gs(q),2];for(var U=0,B=0,H=vT(q||1<<18),X=0,de=H.length>>>0,xe=0,ce=0;(B&1)==0;){if(B=Ge(N,U),U+=3,B>>>1)B>>1==1?(xe=9,ce=5):(U=Hi(N,U),xe=Lr,ce=Cn);else{U&7&&(U+=8-(U&7));var me=N[U>>>3]|N[(U>>>3)+1]<<8;if(U+=32,me>0)for(!q&&de<X+me&&(H=fr(H,X+me),de=H.length);me-- >0;)H[X++]=N[U>>>3],U+=8;continue}for(;;){!q&&de<X+32767&&(H=fr(H,X+32767),de=H.length);var ge=Ye(N,U,xe),Oe=B>>>1==1?Ze[ge]:Ft[ge];if(U+=Oe&15,Oe>>>=4,(Oe>>>8&255)===0)H[X++]=Oe;else{if(Oe==256)break;Oe-=257;var Le=Oe<8?0:Oe-4>>2;Le>5&&(Le=0);var ze=X+ue[Oe];Le>0&&(ze+=Ye(N,U,Le),U+=Le),ge=Ye(N,U,ce),Oe=B>>>1==1?Je[ge]:Vt[ge],U+=Oe&15,Oe>>>=4;var Me=Oe<4?0:Oe-2>>1,je=Ie[Oe];for(Me>0&&(je+=Ye(N,U,Me),U+=Me),!q&&de<ze&&(H=fr(H,ze+100),de=H.length);X<ze;)H[X]=H[X-je],++X}}}return q?[H,U+7>>>3]:[H.slice(0,X),U+7>>>3]}function Gi(N,q){var U=N.slice(N.l||0),B=li(U,q);return N.l+=B[1],B[0]}function qi(N,q){if(N)typeof console<"u"&&console.error(q);else throw new Error(q)}function Ki(N,q){var U=N;Qr(U,0);var B=[],H=[],X={FileIndex:B,FullPaths:H};k(X,{root:q.root});for(var de=U.length-4;(U[de]!=80||U[de+1]!=75||U[de+2]!=5||U[de+3]!=6)&&de>=0;)--de;U.l=de+4,U.l+=4;var xe=U.read_shift(2);U.l+=6;var ce=U.read_shift(4);for(U.l=ce,de=0;de<xe;++de){U.l+=20;var me=U.read_shift(4),ge=U.read_shift(4),Oe=U.read_shift(2),Le=U.read_shift(2),ze=U.read_shift(2);U.l+=8;var Me=U.read_shift(4),je=u(U.slice(U.l+Oe,U.l+Oe+Le));U.l+=Oe+Le+ze;var at=U.l;U.l=Me+4,_a(U,me,ge,X,je),U.l=at}return X}function _a(N,q,U,B,H){N.l+=2;var X=N.read_shift(2),de=N.read_shift(2),xe=c(N);if(X&8257)throw new Error("Unsupported ZIP encryption");for(var ce=N.read_shift(4),me=N.read_shift(4),ge=N.read_shift(4),Oe=N.read_shift(2),Le=N.read_shift(2),ze="",Me=0;Me<Oe;++Me)ze+=String.fromCharCode(N[N.l++]);if(Le){var je=u(N.slice(N.l,N.l+Le));(je[21589]||{}).mt&&(xe=je[21589].mt),((H||{})[21589]||{}).mt&&(xe=H[21589].mt)}N.l+=Le;var at=N.slice(N.l,N.l+me);switch(de){case 8:at=j(N,ge);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+de)}var Pt=!1;X&8&&(ce=N.read_shift(4),ce==134695760&&(ce=N.read_shift(4),Pt=!0),me=N.read_shift(4),ge=N.read_shift(4)),me!=q&&qi(Pt,"Bad compressed size: "+q+" != "+me),ge!=U&&qi(Pt,"Bad uncompressed size: "+U+" != "+ge),nr(B,ze,at,{unsafe:!0,mt:xe})}function xa(N,q){var U=q||{},B=[],H=[],X=Or(1),de=U.compression?8:0,xe=0,ce=0,me=0,ge=0,Oe=0,Le=N.FullPaths[0],ze=Le,Me=N.FileIndex[0],je=[],at=0;for(ce=1;ce<N.FullPaths.length;++ce)if(ze=N.FullPaths[ce].slice(Le.length),Me=N.FileIndex[ce],!(!Me.size||!Me.content||ze=="Sh33tJ5")){var Pt=ge,St=Or(ze.length);for(me=0;me<ze.length;++me)St.write_shift(1,ze.charCodeAt(me)&127);St=St.slice(0,St.l),je[Oe]=cF.buf(Me.content,0);var Ct=Me.content;de==8&&(Ct=Y(Ct)),X=Or(30),X.write_shift(4,67324752),X.write_shift(2,20),X.write_shift(2,xe),X.write_shift(2,de),Me.mt?o(X,Me.mt):X.write_shift(4,0),X.write_shift(-4,je[Oe]),X.write_shift(4,Ct.length),X.write_shift(4,Me.content.length),X.write_shift(2,St.length),X.write_shift(2,0),ge+=X.length,B.push(X),ge+=St.length,B.push(St),ge+=Ct.length,B.push(Ct),X=Or(46),X.write_shift(4,33639248),X.write_shift(2,0),X.write_shift(2,20),X.write_shift(2,xe),X.write_shift(2,de),X.write_shift(4,0),X.write_shift(-4,je[Oe]),X.write_shift(4,Ct.length),X.write_shift(4,Me.content.length),X.write_shift(2,St.length),X.write_shift(2,0),X.write_shift(2,0),X.write_shift(2,0),X.write_shift(2,0),X.write_shift(4,0),X.write_shift(4,Pt),at+=X.l,H.push(X),at+=St.length,H.push(St),++Oe}return X=Or(22),X.write_shift(4,101010256),X.write_shift(2,0),X.write_shift(2,0),X.write_shift(2,Oe),X.write_shift(2,Oe),X.write_shift(4,at),X.write_shift(4,ge),X.write_shift(2,0),As([As(B),As(H),X])}var Na={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function $n(N,q){if(N.ctype)return N.ctype;var U=N.name||"",B=U.match(/\.([^\.]+)$/);return B&&Na[B[1]]||q&&(B=(U=q).match(/[\.\\]([^\.\\])+$/),B&&Na[B[1]])?Na[B[1]]:"application/octet-stream"}function Zs(N){for(var q=gT(N),U=[],B=0;B<q.length;B+=76)U.push(q.slice(B,B+76));return U.join(`\r
`)+`\r
`}function Fa(N){var q=N.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(me){var ge=me.charCodeAt(0).toString(16).toUpperCase();return"="+(ge.length==1?"0"+ge:ge)});q=q.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),q.charAt(0)==`
`&&(q="=0D"+q.slice(1)),q=q.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var U=[],B=q.split(`\r
`),H=0;H<B.length;++H){var X=B[H];if(X.length==0){U.push("");continue}for(var de=0;de<X.length;){var xe=76,ce=X.slice(de,de+xe);ce.charAt(xe-1)=="="?xe--:ce.charAt(xe-2)=="="?xe-=2:ce.charAt(xe-3)=="="&&(xe-=3),ce=X.slice(de,de+xe),de+=xe,de<X.length&&(ce+="="),U.push(ce)}}return U.join(`\r
`)}function Xi(N){for(var q=[],U=0;U<N.length;++U){for(var B=N[U];U<=N.length&&B.charAt(B.length-1)=="=";)B=B.slice(0,B.length-1)+N[++U];q.push(B)}for(var H=0;H<q.length;++H)q[H]=q[H].replace(/[=][0-9A-Fa-f]{2}/g,function(X){return String.fromCharCode(parseInt(X.slice(1),16))});return Ca(q.join(`\r
`))}function Pa(N,q,U){for(var B="",H="",X="",de,xe=0;xe<10;++xe){var ce=q[xe];if(!ce||ce.match(/^\s*$/))break;var me=ce.match(/^(.*?):\s*([^\s].*)$/);if(me)switch(me[1].toLowerCase()){case"content-location":B=me[2].trim();break;case"content-type":X=me[2].trim();break;case"content-transfer-encoding":H=me[2].trim();break}}switch(++xe,H.toLowerCase()){case"base64":de=Ca(Wn(q.slice(xe).join("")));break;case"quoted-printable":de=Xi(q.slice(xe));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+H)}var ge=nr(N,B.slice(U.length),de,{unsafe:!0});X&&(ge.ctype=X)}function nl(N,q){if(te(N.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var U=q&&q.root||"",B=(wt&&Buffer.isBuffer(N)?N.toString("binary"):te(N)).split(`\r
`),H=0,X="";for(H=0;H<B.length;++H)if(X=B[H],!!/^Content-Location:/i.test(X)&&(X=X.slice(X.indexOf("file")),U||(U=X.slice(0,X.lastIndexOf("/")+1)),X.slice(0,U.length)!=U))for(;U.length>0&&(U=U.slice(0,U.length-1),U=U.slice(0,U.lastIndexOf("/")+1),X.slice(0,U.length)!=U););var de=(B[1]||"").match(/boundary="(.*?)"/);if(!de)throw new Error("MAD cannot find boundary");var xe="--"+(de[1]||""),ce=[],me=[],ge={FileIndex:ce,FullPaths:me};k(ge);var Oe,Le=0;for(H=0;H<B.length;++H){var ze=B[H];ze!==xe&&ze!==xe+"--"||(Le++&&Pa(ge,B.slice(Oe,H),U),Oe=H)}return ge}function Qt(N,q){var U=q||{},B=U.boundary||"SheetJS";B="------="+B;for(var H=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+B.slice(2)+'"',"","",""],X=N.FullPaths[0],de=X,xe=N.FileIndex[0],ce=1;ce<N.FullPaths.length;++ce)if(de=N.FullPaths[ce].slice(X.length),xe=N.FileIndex[ce],!(!xe.size||!xe.content||de=="Sh33tJ5")){de=de.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(at){return"_x"+at.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(at){return"_u"+at.charCodeAt(0).toString(16)+"_"});for(var me=xe.content,ge=wt&&Buffer.isBuffer(me)?me.toString("binary"):te(me),Oe=0,Le=Math.min(1024,ge.length),ze=0,Me=0;Me<=Le;++Me)(ze=ge.charCodeAt(Me))>=32&&ze<128&&++Oe;var je=Oe>=Le*4/5;H.push(B),H.push("Content-Location: "+(U.root||"file:///C:/SheetJS/")+de),H.push("Content-Transfer-Encoding: "+(je?"quoted-printable":"base64")),H.push("Content-Type: "+$n(xe,de)),H.push(""),H.push(je?Fa(ge):Zs(ge))}return H.push(B+`--\r
`),H.join(`\r
`)}function hr(N){var q={};return k(q,N),q}function nr(N,q,U,B){var H=B&&B.unsafe;H||k(N);var X=!H&&Dt.find(N,q);if(!X){var de=N.FullPaths[0];q.slice(0,de.length)==de?de=q:(de.slice(-1)!="/"&&(de+="/"),de=(de+q).replace("//","/")),X={name:i(q),type:2},N.FileIndex.push(X),N.FullPaths.push(de),H||Dt.utils.cfb_gc(N)}return X.content=U,X.size=U?U.length:0,B&&(B.CLSID&&(X.clsid=B.CLSID),B.mt&&(X.mt=B.mt),B.ct&&(X.ct=B.ct)),X}function Rn(N,q){k(N);var U=Dt.find(N,q);if(U){for(var B=0;B<N.FileIndex.length;++B)if(N.FileIndex[B]==U)return N.FileIndex.splice(B,1),N.FullPaths.splice(B,1),!0}return!1}function Js(N,q,U){k(N);var B=Dt.find(N,q);if(B){for(var H=0;H<N.FileIndex.length;++H)if(N.FileIndex[H]==B)return N.FileIndex[H].name=i(U),N.FullPaths[H]=U,!0}return!1}function Ac(N){E(N,!0)}return e.find=O,e.read=ee,e.parse=g,e.write=G,e.writeFile=be,e.utils={cfb_new:hr,cfb_add:nr,cfb_del:Rn,cfb_mov:Js,cfb_gc:Ac,ReadShift:Uu,CheckField:VS,prep_blob:Qr,bconcat:As,use_zlib:M,_deflateRaw:ot,_inflateRaw:Gi,consts:oe},e}();function uF(t){if(typeof Deno<"u")return Deno.readFileSync(t);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var e=File(t);e.open("r"),e.encoding="binary";var r=e.read();return e.close(),r}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+t)}function qs(t){for(var e=Object.keys(t),r=[],n=0;n<e.length;++n)Object.prototype.hasOwnProperty.call(t,e[n])&&r.push(e[n]);return r}function W1(t){for(var e=[],r=qs(t),n=0;n!==r.length;++n)e[t[r[n]]]=r[n];return e}var K0=new Date(1899,11,30,0,0,0);function Yn(t,e){var r=t.getTime(),n=K0.getTime()+(t.getTimezoneOffset()-K0.getTimezoneOffset())*6e4;return(r-n)/(24*60*60*1e3)}var vS=new Date,fF=K0.getTime()+(vS.getTimezoneOffset()-K0.getTimezoneOffset())*6e4,ST=vS.getTimezoneOffset();function bd(t){var e=new Date;return e.setTime(t*24*60*60*1e3+fF),e.getTimezoneOffset()!==ST&&e.setTime(e.getTime()+(e.getTimezoneOffset()-ST)*6e4),e}function hF(t){var e=0,r=0,n=!1,i=t.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!i)throw new Error("|"+t+"| is not an ISO8601 Duration");for(var o=1;o!=i.length;++o)if(i[o]){switch(r=1,o>3&&(n=!0),i[o].slice(i[o].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+i[o].slice(i[o].length-1));case"D":r*=24;case"H":r*=60;case"M":if(n)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}e+=r*parseInt(i[o],10)}return e}var CT=new Date("2017-02-19T19:06:09.000Z"),_S=isNaN(CT.getFullYear())?new Date("2/19/17"):CT,dF=_S.getFullYear()==2017;function Jr(t,e){var r=new Date(t);if(dF)return e>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):e<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(t instanceof Date)return t;if(_S.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return t.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var i=t.match(/\d+/g)||["2017","2","19","0","0","0"],o=new Date(+i[0],+i[1]-1,+i[2],+i[3]||0,+i[4]||0,+i[5]||0);return t.indexOf("Z")>-1&&(o=new Date(o.getTime()-o.getTimezoneOffset()*60*1e3)),o}function zo(t,e){if(wt&&Buffer.isBuffer(t)){if(e){if(t[0]==255&&t[1]==254)return Ou(t.slice(2).toString("utf16le"));if(t[1]==254&&t[2]==255)return Ou(aS(t.slice(2).toString("binary")))}return t.toString("binary")}if(typeof TextDecoder<"u")try{if(e){if(t[0]==255&&t[1]==254)return Ou(new TextDecoder("utf-16le").decode(t.slice(2)));if(t[0]==254&&t[1]==255)return Ou(new TextDecoder("utf-16be").decode(t.slice(2)))}var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(t)&&(t=new Uint8Array(t)),new TextDecoder("latin1").decode(t).replace(/[]/g,function(o){return r[o]||o})}catch{}for(var n=[],i=0;i!=t.length;++i)n.push(String.fromCharCode(t[i]));return n.join("")}function en(t){if(typeof JSON<"u"&&!Array.isArray(t))return JSON.parse(JSON.stringify(t));if(typeof t!="object"||t==null)return t;if(t instanceof Date)return new Date(t.getTime());var e={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=en(t[r]));return e}function ur(t,e){for(var r="";r.length<e;)r+=t;return r}function Pi(t){var e=Number(t);if(!isNaN(e))return isFinite(e)?e:NaN;if(!/\d/.test(t))return e;var r=1,n=t.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(e=Number(n))||(n=n.replace(/[(](.*)[)]/,function(i,o){return r=-r,o}),!isNaN(e=Number(n)))?e/r:e}var pF=["january","february","march","april","may","june","july","august","september","october","november","december"];function lf(t){var e=new Date(t),r=new Date(NaN),n=e.getYear(),i=e.getMonth(),o=e.getDate();if(isNaN(o))return r;var c=t.toLowerCase();if(c.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(c=c.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),c.length>3&&pF.indexOf(c)==-1)return r}else if(c.match(/[a-z]/))return r;return n<0||n>8099?r:(i>0||o>1)&&n!=101?e:t.match(/[^-0-9:,\/\\]/)?r:e}var mF=function(){var t="abacaba".split(/(:?b)/i).length==5;return function(r,n,i){if(t||typeof n=="string")return r.split(n);for(var o=r.split(n),c=[o[0]],u=1;u<o.length;++u)c.push(i),c.push(o[u]);return c}}();function xS(t){return t?t.content&&t.type?zo(t.content,!0):t.data?bu(t.data):t.asNodeBuffer&&wt?bu(t.asNodeBuffer().toString("binary")):t.asBinary?bu(t.asBinary()):t._data&&t._data.getContent?bu(zo(Array.prototype.slice.call(t._data.getContent(),0))):null:null}function yS(t){if(!t)return null;if(t.data)return pT(t.data);if(t.asNodeBuffer&&wt)return t.asNodeBuffer();if(t._data&&t._data.getContent){var e=t._data.getContent();return typeof e=="string"?pT(e):Array.prototype.slice.call(e)}return t.content&&t.type?t.content:null}function gF(t){return t&&t.name.slice(-4)===".bin"?yS(t):xS(t)}function ua(t,e){for(var r=t.FullPaths||qs(t.files),n=e.toLowerCase().replace(/[\/]/g,"\\"),i=n.replace(/\\/g,"/"),o=0;o<r.length;++o){var c=r[o].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==c||i==c)return t.files?t.files[r[o]]:t.FileIndex[o]}return null}function Y1(t,e){var r=ua(t,e);if(r==null)throw new Error("Cannot find file "+e+" in zip");return r}function wr(t,e,r){if(!r)return gF(Y1(t,e));if(!e)return null;try{return wr(t,e)}catch{return null}}function qn(t,e,r){if(!r)return xS(Y1(t,e));if(!e)return null;try{return qn(t,e)}catch{return null}}function vF(t,e,r){return yS(Y1(t,e))}function RT(t){for(var e=t.FullPaths||qs(t.files),r=[],n=0;n<e.length;++n)e[n].slice(-1)!="/"&&r.push(e[n].replace(/^Root Entry[\/]/,""));return r.sort()}function _F(t,e,r){if(t.FullPaths){if(typeof r=="string"){var n;return wt?n=$o(r):n=LN(r),Dt.utils.cfb_add(t,e,n)}Dt.utils.cfb_add(t,e,r)}else t.file(e,r)}function ES(t,e){switch(e.type){case"base64":return Dt.read(t,{type:"base64"});case"binary":return Dt.read(t,{type:"binary"});case"buffer":case"array":return Dt.read(t,{type:"buffer"})}throw new Error("Unrecognized type "+e.type)}function Du(t,e){if(t.charAt(0)=="/")return t.slice(1);var r=e.split("/");e.slice(-1)!="/"&&r.pop();for(var n=t.split("/");n.length!==0;){var i=n.shift();i===".."?r.pop():i!=="."&&r.push(i)}return r.join("/")}var TS=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,xF=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,kT=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,yF=/<[^>]*>/g,gn=TS.match(kT)?kT:yF,EF=/<\w*:/,TF=/<(\/?)\w+:/;function st(t,e,r){for(var n={},i=0,o=0;i!==t.length&&!((o=t.charCodeAt(i))===32||o===10||o===13);++i);if(e||(n[0]=t.slice(0,i)),i===t.length)return n;var c=t.match(xF),u=0,h="",d=0,g="",_="",x=1;if(c)for(d=0;d!=c.length;++d){for(_=c[d],o=0;o!=_.length&&_.charCodeAt(o)!==61;++o);for(g=_.slice(0,o).trim();_.charCodeAt(o+1)==32;)++o;for(x=(i=_.charCodeAt(o+1))==34||i==39?1:0,h=_.slice(o+1+x,_.length-x),u=0;u!=g.length&&g.charCodeAt(u)!==58;++u);if(u===g.length)g.indexOf("_")>0&&(g=g.slice(0,g.indexOf("_"))),n[g]=h,n[g.toLowerCase()]=h;else{var A=(u===5&&g.slice(0,5)==="xmlns"?"xmlns":"")+g.slice(u+1);if(n[A]&&g.slice(u-3,u)=="ext")continue;n[A]=h,n[A.toLowerCase()]=h}}return n}function si(t){return t.replace(TF,"<$1")}var AS={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},AF=W1(AS),Nt=function(){var t=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,e=/_x([\da-fA-F]{4})_/ig;return function r(n){var i=n+"",o=i.indexOf("<![CDATA[");if(o==-1)return i.replace(t,function(u,h){return AS[u]||String.fromCharCode(parseInt(h,u.indexOf("x")>-1?16:10))||u}).replace(e,function(u,h){return String.fromCharCode(parseInt(h,16))});var c=i.indexOf("]]>");return r(i.slice(0,o))+i.slice(o+9,c)+r(i.slice(c+3))}}(),wF=/[&<>'"]/g,SF=/[\u0000-\u001f]/g;function wS(t){var e=t+"";return e.replace(wF,function(r){return AF[r]}).replace(/\n/g,"<br/>").replace(SF,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}var bT=function(){var t=/&#(\d+);/g;function e(r,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(t,e)}}();function ir(t){switch(t){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function Ym(t){for(var e="",r=0,n=0,i=0,o=0,c=0,u=0;r<t.length;){if(n=t.charCodeAt(r++),n<128){e+=String.fromCharCode(n);continue}if(i=t.charCodeAt(r++),n>191&&n<224){c=(n&31)<<6,c|=i&63,e+=String.fromCharCode(c);continue}if(o=t.charCodeAt(r++),n<240){e+=String.fromCharCode((n&15)<<12|(i&63)<<6|o&63);continue}c=t.charCodeAt(r++),u=((n&7)<<18|(i&63)<<12|(o&63)<<6|c&63)-65536,e+=String.fromCharCode(55296+(u>>>10&1023)),e+=String.fromCharCode(56320+(u&1023))}return e}function IT(t){var e=Gs(2*t.length),r,n,i=1,o=0,c=0,u;for(n=0;n<t.length;n+=i)i=1,(u=t.charCodeAt(n))<128?r=u:u<224?(r=(u&31)*64+(t.charCodeAt(n+1)&63),i=2):u<240?(r=(u&15)*4096+(t.charCodeAt(n+1)&63)*64+(t.charCodeAt(n+2)&63),i=3):(i=4,r=(u&7)*262144+(t.charCodeAt(n+1)&63)*4096+(t.charCodeAt(n+2)&63)*64+(t.charCodeAt(n+3)&63),r-=65536,c=55296+(r>>>10&1023),r=56320+(r&1023)),c!==0&&(e[o++]=c&255,e[o++]=c>>>8,c=0),e[o++]=r%256,e[o++]=r>>>8;return e.slice(0,o).toString("ucs2")}function DT(t){return $o(t,"binary").toString("utf8")}var r0="foo bar baz",Jt=wt&&(DT(r0)==Ym(r0)&&DT||IT(r0)==Ym(r0)&&IT)||Ym,Ou=wt?function(t){return $o(t,"utf8").toString("binary")}:function(t){for(var e=[],r=0,n=0,i=0;r<t.length;)switch(n=t.charCodeAt(r++),!0){case n<128:e.push(String.fromCharCode(n));break;case n<2048:e.push(String.fromCharCode(192+(n>>6))),e.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,i=t.charCodeAt(r++)-56320+(n<<10),e.push(String.fromCharCode(240+(i>>18&7))),e.push(String.fromCharCode(144+(i>>12&63))),e.push(String.fromCharCode(128+(i>>6&63))),e.push(String.fromCharCode(128+(i&63)));break;default:e.push(String.fromCharCode(224+(n>>12))),e.push(String.fromCharCode(128+(n>>6&63))),e.push(String.fromCharCode(128+(n&63)))}return e.join("")},cf=function(){var t={};return function(r,n){var i=r+"|"+(n||"");return t[i]?t[i]:t[i]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",n||"")}}(),CF=function(){var t=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(e){return[new RegExp("&"+e[0]+";","ig"),e[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),i=0;i<t.length;++i)n=n.replace(t[i][0],t[i][1]);return n}}(),RF=function(){var t={};return function(r){return t[r]!==void 0?t[r]:t[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}}(),kF=/<\/?(?:vt:)?variant>/g,bF=/<(?:vt:)([^>]*)>([\s\S]*)</;function OT(t,e){var r=st(t),n=t.match(RF(r.baseType))||[],i=[];if(n.length!=r.size){if(e.WTF)throw new Error("unexpected vector length "+n.length+" != "+r.size);return i}return n.forEach(function(o){var c=o.replace(kF,"").match(bF);c&&i.push({v:Jt(c[2]),t:c[1]})}),i}function $1(t){if(wt&&Buffer.isBuffer(t))return t.toString("utf8");if(typeof t=="string")return t;if(typeof Uint8Array<"u"&&t instanceof Uint8Array)return Jt(Qo(q1(t)));throw new Error("Bad input format: expected Buffer or string")}var uf=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,IF={CT:"http://schemas.openxmlformats.org/package/2006/content-types"},DF=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"];function OF(t,e){for(var r=1-2*(t[e+7]>>>7),n=((t[e+7]&127)<<4)+(t[e+6]>>>4&15),i=t[e+6]&15,o=5;o>=0;--o)i=i*256+t[e+o];return n==2047?i==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,i+=Math.pow(2,52)),r*Math.pow(2,n-52)*i)}function NF(t,e,r){var n=(e<0||1/e==-1/0?1:0)<<7,i=0,o=0,c=n?-e:e;isFinite(c)?c==0?i=o=0:(i=Math.floor(Math.log(c)/Math.LN2),o=c*Math.pow(2,52-i),i<=-1023&&(!isFinite(o)||o<Math.pow(2,52))?i=-1022:(o-=Math.pow(2,52),i+=1023)):(i=2047,o=isNaN(e)?26985:0);for(var u=0;u<=5;++u,o/=256)t[r+u]=o&255;t[r+6]=(i&15)<<4|o&15,t[r+7]=i>>4|n}var NT=function(t){for(var e=[],r=10240,n=0;n<t[0].length;++n)if(t[0][n])for(var i=0,o=t[0][n].length;i<o;i+=r)e.push.apply(e,t[0][n].slice(i,i+r));return e},FT=wt?function(t){return t[0].length>0&&Buffer.isBuffer(t[0][0])?Buffer.concat(t[0].map(function(e){return Buffer.isBuffer(e)?e:$o(e)})):NT(t)}:NT,PT=function(t,e,r){for(var n=[],i=e;i<r;i+=2)n.push(String.fromCharCode(Oi(t,i)));return n.join("").replace(Sn,"")},Q1=wt?function(t,e,r){return Buffer.isBuffer(t)?t.toString("utf16le",e,r).replace(Sn,""):PT(t,e,r)}:PT,MT=function(t,e,r){for(var n=[],i=e;i<e+r;++i)n.push(("0"+t[i].toString(16)).slice(-2));return n.join("")},SS=wt?function(t,e,r){return Buffer.isBuffer(t)?t.toString("hex",e,e+r):MT(t,e,r)}:MT,LT=function(t,e,r){for(var n=[],i=e;i<r;i++)n.push(String.fromCharCode(Yl(t,i)));return n.join("")},Cf=wt?function(e,r,n){return Buffer.isBuffer(e)?e.toString("utf8",r,n):LT(e,r,n)}:LT,CS=function(t,e){var r=Gn(t,e);return r>0?Cf(t,e+4,e+4+r-1):""},RS=CS,kS=function(t,e){var r=Gn(t,e);return r>0?Cf(t,e+4,e+4+r-1):""},bS=kS,IS=function(t,e){var r=2*Gn(t,e);return r>0?Cf(t,e+4,e+4+r-1):""},DS=IS,OS=function(e,r){var n=Gn(e,r);return n>0?Q1(e,r+4,r+4+n):""},NS=OS,FS=function(t,e){var r=Gn(t,e);return r>0?Cf(t,e+4,e+4+r):""},PS=FS,MS=function(t,e){return OF(t,e)},X0=MS,LS=function(e){return Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array};wt&&(RS=function(e,r){if(!Buffer.isBuffer(e))return CS(e,r);var n=e.readUInt32LE(r);return n>0?e.toString("utf8",r+4,r+4+n-1):""},bS=function(e,r){if(!Buffer.isBuffer(e))return kS(e,r);var n=e.readUInt32LE(r);return n>0?e.toString("utf8",r+4,r+4+n-1):""},DS=function(e,r){if(!Buffer.isBuffer(e))return IS(e,r);var n=2*e.readUInt32LE(r);return e.toString("utf16le",r+4,r+4+n-1)},NS=function(e,r){if(!Buffer.isBuffer(e))return OS(e,r);var n=e.readUInt32LE(r);return e.toString("utf16le",r+4,r+4+n)},PS=function(e,r){if(!Buffer.isBuffer(e))return FS(e,r);var n=e.readUInt32LE(r);return e.toString("utf8",r+4,r+4+n)},X0=function(e,r){return Buffer.isBuffer(e)?e.readDoubleLE(r):MS(e,r)},LS=function(e){return Buffer.isBuffer(e)||Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array});var Yl=function(t,e){return t[e]},Oi=function(t,e){return t[e+1]*256+t[e]},FF=function(t,e){var r=t[e+1]*256+t[e];return r<32768?r:(65535-r+1)*-1},Gn=function(t,e){return t[e+3]*(1<<24)+(t[e+2]<<16)+(t[e+1]<<8)+t[e]},bo=function(t,e){return t[e+3]<<24|t[e+2]<<16|t[e+1]<<8|t[e]},PF=function(t,e){return t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3]};function Uu(t,e){var r="",n,i,o=[],c,u,h,d;switch(e){case"dbcs":if(d=this.l,wt&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*t).toString("utf16le");else for(h=0;h<t;++h)r+=String.fromCharCode(Oi(this,d)),d+=2;t*=2;break;case"utf8":r=Cf(this,this.l,this.l+t);break;case"utf16le":t*=2,r=Q1(this,this.l,this.l+t);break;case"wstr":return Uu.call(this,t,"dbcs");case"lpstr-ansi":r=RS(this,this.l),t=4+Gn(this,this.l);break;case"lpstr-cp":r=bS(this,this.l),t=4+Gn(this,this.l);break;case"lpwstr":r=DS(this,this.l),t=4+2*Gn(this,this.l);break;case"lpp4":t=4+Gn(this,this.l),r=NS(this,this.l),t&2&&(t+=2);break;case"8lpp4":t=4+Gn(this,this.l),r=PS(this,this.l),t&3&&(t+=4-(t&3));break;case"cstr":for(t=0,r="";(c=Yl(this,this.l+t++))!==0;)o.push(t0(c));r=o.join("");break;case"_wstr":for(t=0,r="";(c=Oi(this,this.l+t))!==0;)o.push(t0(c)),t+=2;t+=2,r=o.join("");break;case"dbcs-cont":for(r="",d=this.l,h=0;h<t;++h){if(this.lens&&this.lens.indexOf(d)!==-1)return c=Yl(this,d),this.l=d+1,u=Uu.call(this,t-h,c?"dbcs-cont":"sbcs-cont"),o.join("")+u;o.push(t0(Oi(this,d))),d+=2}r=o.join(""),t*=2;break;case"cpstr":case"sbcs-cont":for(r="",d=this.l,h=0;h!=t;++h){if(this.lens&&this.lens.indexOf(d)!==-1)return c=Yl(this,d),this.l=d+1,u=Uu.call(this,t-h,c?"dbcs-cont":"sbcs-cont"),o.join("")+u;o.push(t0(Yl(this,d))),d+=1}r=o.join("");break;default:switch(t){case 1:return n=Yl(this,this.l),this.l++,n;case 2:return n=(e==="i"?FF:Oi)(this,this.l),this.l+=2,n;case 4:case-4:return e==="i"||(this[this.l+3]&128)===0?(n=(t>0?bo:PF)(this,this.l),this.l+=4,n):(i=Gn(this,this.l),this.l+=4,i);case 8:case-8:if(e==="f")return t==8?i=X0(this,this.l):i=X0([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,i;t=8;case 16:r=SS(this,this.l,t);break}}return this.l+=t,r}var MF=function(t,e,r){t[r]=e&255,t[r+1]=e>>>8&255,t[r+2]=e>>>16&255,t[r+3]=e>>>24&255},LF=function(t,e,r){t[r]=e&255,t[r+1]=e>>8&255,t[r+2]=e>>16&255,t[r+3]=e>>24&255},VF=function(t,e,r){t[r]=e&255,t[r+1]=e>>>8&255};function UF(t,e,r){var n=0,i=0;if(r==="dbcs"){for(i=0;i!=e.length;++i)VF(this,e.charCodeAt(i),this.l+2*i);n=2*e.length}else if(r==="sbcs"){for(e=e.replace(/[^\x00-\x7F]/g,"_"),i=0;i!=e.length;++i)this[this.l+i]=e.charCodeAt(i)&255;n=e.length}else if(r==="hex"){for(;i<t;++i)this[this.l++]=parseInt(e.slice(2*i,2*i+2),16)||0;return this}else if(r==="utf16le"){var o=Math.min(this.l+t,this.length);for(i=0;i<Math.min(e.length,t);++i){var c=e.charCodeAt(i);this[this.l++]=c&255,this[this.l++]=c>>8}for(;this.l<o;)this[this.l++]=0;return this}else switch(t){case 1:n=1,this[this.l]=e&255;break;case 2:n=2,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255;break;case 3:n=3,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255,e>>>=8,this[this.l+2]=e&255;break;case 4:n=4,MF(this,e,this.l);break;case 8:if(n=8,r==="f"){NF(this,e,this.l);break}case 16:break;case-4:n=4,LF(this,e,this.l);break}return this.l+=n,this}function VS(t,e){var r=SS(this,this.l,t.length>>1);if(r!==t)throw new Error(e+"Expected "+t+" saw "+r);this.l+=t.length>>1}function Qr(t,e){t.l=e,t.read_shift=Uu,t.chk=VS,t.write_shift=UF}function mn(t,e){t.l+=e}function Or(t){var e=Gs(t);return Qr(e,0),e}function zi(t,e,r){if(t){var n,i,o;Qr(t,t.l||0);for(var c=t.length,u=0,h=0;t.l<c;){u=t.read_shift(1),u&128&&(u=(u&127)+((t.read_shift(1)&127)<<7));var d=J0[u]||J0[65535];for(n=t.read_shift(1),o=n&127,i=1;i<4&&n&128;++i)o+=((n=t.read_shift(1))&127)<<7*i;h=t.l+o;var g=d.f&&d.f(t,o,r);if(t.l=h,e(g,d,u))return}}}function Og(){var t=[],e=wt?256:2048,r=function(d){var g=Or(d);return Qr(g,0),g},n=r(e),i=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&t.push(n),n=null)},o=function(d){return n&&d<n.length-n.l?n:(i(),n=r(Math.max(d+1,e)))},c=function(){return i(),As(t)},u=function(d){i(),n=d,n.l==null&&(n.l=n.length),o(e)};return{next:o,push:u,end:c,_bufs:t}}function Bu(t,e,r){var n=en(t);if(e.s?(n.cRel&&(n.c+=e.s.c),n.rRel&&(n.r+=e.s.r)):(n.cRel&&(n.c+=e.c),n.rRel&&(n.r+=e.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function VT(t,e,r){var n=en(t);return n.s=Bu(n.s,e.s,r),n.e=Bu(n.e,e.s,r),n}function ju(t,e){if(t.cRel&&t.c<0)for(t=en(t);t.c<0;)t.c+=e>8?16384:256;if(t.rRel&&t.r<0)for(t=en(t);t.r<0;)t.r+=e>8?1048576:e>5?65536:16384;var r=vt(t);return!t.cRel&&t.cRel!=null&&(r=zF(r)),!t.rRel&&t.rRel!=null&&(r=BF(r)),r}function $m(t,e){return t.s.r==0&&!t.s.rRel&&t.e.r==(e.biff>=12?1048575:e.biff>=8?65536:16384)&&!t.e.rRel?(t.s.cRel?"":"$")+wn(t.s.c)+":"+(t.e.cRel?"":"$")+wn(t.e.c):t.s.c==0&&!t.s.cRel&&t.e.c==(e.biff>=12?16383:255)&&!t.e.cRel?(t.s.rRel?"":"$")+Xn(t.s.r)+":"+(t.e.rRel?"":"$")+Xn(t.e.r):ju(t.s,e.biff)+":"+ju(t.e,e.biff)}function US(t){return parseInt(jF(t),10)-1}function Xn(t){return""+(t+1)}function BF(t){return t.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function jF(t){return t.replace(/\$(\d+)$/,"$1")}function BS(t){for(var e=HF(t),r=0,n=0;n!==e.length;++n)r=26*r+e.charCodeAt(n)-64;return r-1}function wn(t){if(t<0)throw new Error("invalid column "+t);var e="";for(++t;t;t=Math.floor((t-1)/26))e=String.fromCharCode((t-1)%26+65)+e;return e}function zF(t){return t.replace(/^([A-Z])/,"$$$1")}function HF(t){return t.replace(/^\$([A-Z])/,"$1")}function Ia(t){for(var e=0,r=0,n=0;n<t.length;++n){var i=t.charCodeAt(n);i>=48&&i<=57?e=10*e+(i-48):i>=65&&i<=90&&(r=26*r+(i-64))}return{c:r-1,r:e-1}}function vt(t){for(var e=t.c+1,r="";e;e=(e-1)/26|0)r=String.fromCharCode((e-1)%26+65)+r;return r+(t.r+1)}function Z1(t){var e=t.indexOf(":");return e==-1?{s:Ia(t),e:Ia(t)}:{s:Ia(t.slice(0,e)),e:Ia(t.slice(e+1))}}function qt(t,e){return typeof e>"u"||typeof e=="number"?qt(t.s,t.e):(typeof t!="string"&&(t=vt(t)),typeof e!="string"&&(e=vt(e)),t==e?t:t+":"+e)}function qr(t){var e={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,i=0,o=t.length;for(r=0;n<o&&!((i=t.charCodeAt(n)-64)<1||i>26);++n)r=26*r+i;for(e.s.c=--r,r=0;n<o&&!((i=t.charCodeAt(n)-48)<0||i>9);++n)r=10*r+i;if(e.s.r=--r,n===o||i!=10)return e.e.c=e.s.c,e.e.r=e.s.r,e;for(++n,r=0;n!=o&&!((i=t.charCodeAt(n)-64)<1||i>26);++n)r=26*r+i;for(e.e.c=--r,r=0;n!=o&&!((i=t.charCodeAt(n)-48)<0||i>9);++n)r=10*r+i;return e.e.r=--r,e}function UT(t,e){var r=t.t=="d"&&e instanceof Date;if(t.z!=null)try{return t.w=ga(t.z,r?Yn(e):e)}catch{}try{return t.w=ga((t.XF||{}).numFmtId||(r?14:0),r?Yn(e):e)}catch{return""+e}}function hc(t,e,r){return t==null||t.t==null||t.t=="z"?"":t.w!==void 0?t.w:(t.t=="d"&&!t.z&&r&&r.dateNF&&(t.z=r.dateNF),t.t=="e"?tl[t.v]||t.v:e==null?UT(t,t.v):UT(t,e))}function Zo(t,e){var r=e&&e.sheet?e.sheet:"Sheet1",n={};return n[r]=t,{SheetNames:[r],Sheets:n}}function GF(t,e,r){var n=r||{},i=t?Array.isArray(t):n.dense,o=t||(i?[]:{}),c=0,u=0;if(o&&n.origin!=null){if(typeof n.origin=="number")c=n.origin;else{var h=typeof n.origin=="string"?Ia(n.origin):n.origin;c=h.r,u=h.c}o["!ref"]||(o["!ref"]="A1:A1")}var d={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(o["!ref"]){var g=qr(o["!ref"]);d.s.c=g.s.c,d.s.r=g.s.r,d.e.c=Math.max(d.e.c,g.e.c),d.e.r=Math.max(d.e.r,g.e.r),c==-1&&(d.e.r=c=g.e.r+1)}for(var _=0;_!=e.length;++_)if(e[_]){if(!Array.isArray(e[_]))throw new Error("aoa_to_sheet expects an array of arrays");for(var x=0;x!=e[_].length;++x)if(!(typeof e[_][x]>"u")){var A={v:e[_][x]},w=c+_,S=u+x;if(d.s.r>w&&(d.s.r=w),d.s.c>S&&(d.s.c=S),d.e.r<w&&(d.e.r=w),d.e.c<S&&(d.e.c=S),e[_][x]&&typeof e[_][x]=="object"&&!Array.isArray(e[_][x])&&!(e[_][x]instanceof Date))A=e[_][x];else if(Array.isArray(A.v)&&(A.f=e[_][x][1],A.v=A.v[0]),A.v===null)if(A.f)A.t="n";else if(n.nullError)A.t="e",A.v=0;else if(n.sheetStubs)A.t="z";else continue;else typeof A.v=="number"?A.t="n":typeof A.v=="boolean"?A.t="b":A.v instanceof Date?(A.z=n.dateNF||ht[14],n.cellDates?(A.t="d",A.w=ga(A.z,Yn(A.v))):(A.t="n",A.v=Yn(A.v),A.w=ga(A.z,A.v))):A.t="s";if(i)o[w]||(o[w]=[]),o[w][S]&&o[w][S].z&&(A.z=o[w][S].z),o[w][S]=A;else{var C=vt({c:S,r:w});o[C]&&o[C].z&&(A.z=o[C].z),o[C]=A}}}return d.s.c<1e7&&(o["!ref"]=qt(d)),o}function Rf(t,e){return GF(null,t,e)}function qF(t){return t.read_shift(4,"i")}function dn(t){var e=t.read_shift(4);return e===0?"":t.read_shift(e,"dbcs")}function KF(t){return{ich:t.read_shift(2),ifnt:t.read_shift(2)}}function J1(t,e){var r=t.l,n=t.read_shift(1),i=dn(t),o=[],c={t:i,h:i};if((n&1)!==0){for(var u=t.read_shift(4),h=0;h!=u;++h)o.push(KF(t));c.r=o}else c.r=[{ich:0,ifnt:0}];return t.l=r+e,c}var XF=J1;function va(t){var e=t.read_shift(4),r=t.read_shift(2);return r+=t.read_shift(1)<<16,t.l++,{c:e,iStyleRef:r}}function Jo(t){var e=t.read_shift(2);return e+=t.read_shift(1)<<16,t.l++,{c:-1,iStyleRef:e}}var WF=dn;function ev(t){var e=t.read_shift(4);return e===0||e===4294967295?"":t.read_shift(e,"dbcs")}var YF=dn,Ng=ev;function tv(t){var e=t.slice(t.l,t.l+4),r=e[0]&1,n=e[0]&2;t.l+=4;var i=n===0?X0([0,0,0,0,e[0]&252,e[1],e[2],e[3]],0):bo(e,0)>>2;return r?i/100:i}function jS(t){var e={s:{},e:{}};return e.s.r=t.read_shift(4),e.e.r=t.read_shift(4),e.s.c=t.read_shift(4),e.e.c=t.read_shift(4),e}var el=jS;function fn(t){if(t.length-t.l<8)throw"XLS Xnum Buffer underflow";return t.read_shift(8,"f")}function $F(t){var e={},r=t.read_shift(1),n=r>>>1,i=t.read_shift(1),o=t.read_shift(2,"i"),c=t.read_shift(1),u=t.read_shift(1),h=t.read_shift(1);switch(t.l++,n){case 0:e.auto=1;break;case 1:e.index=i;var d=Po[i];d&&(e.rgb=hf(d));break;case 2:e.rgb=hf([c,u,h]);break;case 3:e.theme=i;break}return o!=0&&(e.tint=o>0?o/32767:o/32768),e}function QF(t){var e=t.read_shift(1);t.l++;var r={fBold:e&1,fItalic:e&2,fUnderline:e&4,fStrikeout:e&8,fOutline:e&16,fShadow:e&32,fCondense:e&64,fExtend:e&128};return r}function zS(t,e){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=t.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return r[t.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return t.l-=4,t.read_shift(0,e==1?"lpstr":"lpwstr")}function ZF(t){return zS(t,1)}function JF(t){return zS(t,2)}var rv=2,On=3,n0=11,BT=12,W0=19,a0=64,e8=65,t8=71,r8=4108,n8=4126,Gr=80,HS=81,a8=[Gr,HS],i8={1:{n:"CodePage",t:rv},2:{n:"Category",t:Gr},3:{n:"PresentationFormat",t:Gr},4:{n:"ByteCount",t:On},5:{n:"LineCount",t:On},6:{n:"ParagraphCount",t:On},7:{n:"SlideCount",t:On},8:{n:"NoteCount",t:On},9:{n:"HiddenCount",t:On},10:{n:"MultimediaClipCount",t:On},11:{n:"ScaleCrop",t:n0},12:{n:"HeadingPairs",t:r8},13:{n:"TitlesOfParts",t:n8},14:{n:"Manager",t:Gr},15:{n:"Company",t:Gr},16:{n:"LinksUpToDate",t:n0},17:{n:"CharacterCount",t:On},19:{n:"SharedDoc",t:n0},22:{n:"HyperlinksChanged",t:n0},23:{n:"AppVersion",t:On,p:"version"},24:{n:"DigSig",t:e8},26:{n:"ContentType",t:Gr},27:{n:"ContentStatus",t:Gr},28:{n:"Language",t:Gr},29:{n:"Version",t:Gr},255:{},2147483648:{n:"Locale",t:W0},2147483651:{n:"Behavior",t:W0},1919054434:{}},s8={1:{n:"CodePage",t:rv},2:{n:"Title",t:Gr},3:{n:"Subject",t:Gr},4:{n:"Author",t:Gr},5:{n:"Keywords",t:Gr},6:{n:"Comments",t:Gr},7:{n:"Template",t:Gr},8:{n:"LastAuthor",t:Gr},9:{n:"RevNumber",t:Gr},10:{n:"EditTime",t:a0},11:{n:"LastPrinted",t:a0},12:{n:"CreatedDate",t:a0},13:{n:"ModifiedDate",t:a0},14:{n:"PageCount",t:On},15:{n:"WordCount",t:On},16:{n:"CharCount",t:On},17:{n:"Thumbnail",t:t8},18:{n:"Application",t:Gr},19:{n:"DocSecurity",t:On},255:{},2147483648:{n:"Locale",t:W0},2147483651:{n:"Behavior",t:W0},1919054434:{}},jT={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},o8=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function l8(t){return t.map(function(e){return[e>>16&255,e>>8&255,e&255]})}var c8=l8([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Po=en(c8),tl={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},GS={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},zT={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"};function u8(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function f8(t){var e=u8();if(!t||!t.match)return e;var r={};if((t.match(gn)||[]).forEach(function(n){var i=st(n);switch(i[0].replace(EF,"<")){case"<?xml":break;case"<Types":e.xmlns=i["xmlns"+(i[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[i.Extension]=i.ContentType;break;case"<Override":e[zT[i.ContentType]]!==void 0&&e[zT[i.ContentType]].push(i.PartName);break}}),e.xmlns!==IF.CT)throw new Error("Unknown Namespace: "+e.xmlns);return e.calcchain=e.calcchains.length>0?e.calcchains[0]:"",e.sst=e.strs.length>0?e.strs[0]:"",e.style=e.styles.length>0?e.styles[0]:"",e.defaults=r,delete e.calcchains,e}var $l={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function Fg(t){var e=t.lastIndexOf("/");return t.slice(0,e+1)+"_rels/"+t.slice(e+1)+".rels"}function zu(t,e){var r={"!id":{}};if(!t)return r;e.charAt(0)!=="/"&&(e="/"+e);var n={};return(t.match(gn)||[]).forEach(function(i){var o=st(i);if(o[0]==="<Relationship"){var c={};c.Type=o.Type,c.Target=o.Target,c.Id=o.Id,o.TargetMode&&(c.TargetMode=o.TargetMode);var u=o.TargetMode==="External"?o.Target:Du(o.Target,e);r[u]=c,n[o.Id]=c}}),r["!id"]=n,r}var h8="application/vnd.oasis.opendocument.spreadsheet";function d8(t,e){for(var r=$1(t),n,i;n=uf.exec(r);)switch(n[3]){case"manifest":break;case"file-entry":if(i=st(n[0],!1),i.path=="/"&&i.type!==h8)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(e&&e.WTF)throw n}}var Hu=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],p8=function(){for(var t=new Array(Hu.length),e=0;e<Hu.length;++e){var r=Hu[e],n="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);t[e]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return t}();function qS(t){var e={};t=Jt(t);for(var r=0;r<Hu.length;++r){var n=Hu[r],i=t.match(p8[r]);i!=null&&i.length>0&&(e[n[1]]=Nt(i[1])),n[2]==="date"&&e[n[1]]&&(e[n[1]]=Jr(e[n[1]]))}return e}var m8=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]];function KS(t,e,r,n){var i=[];if(typeof t=="string")i=OT(t,n);else for(var o=0;o<t.length;++o)i=i.concat(t[o].map(function(g){return{v:g}}));var c=typeof e=="string"?OT(e,n).map(function(g){return g.v}):e,u=0,h=0;if(c.length>0)for(var d=0;d!==i.length;d+=2){switch(h=+i[d+1].v,i[d].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":r.Worksheets=h,r.SheetNames=c.slice(u,u+h);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":r.NamedRanges=h,r.DefinedNames=c.slice(u,u+h);break;case"Charts":case"Diagramme":r.Chartsheets=h,r.ChartNames=c.slice(u,u+h);break}u+=h}}function g8(t,e,r){var n={};return e||(e={}),t=Jt(t),m8.forEach(function(i){var o=(t.match(cf(i[0]))||[])[1];switch(i[2]){case"string":o&&(e[i[1]]=Nt(o));break;case"bool":e[i[1]]=o==="true";break;case"raw":var c=t.match(new RegExp("<"+i[0]+"[^>]*>([\\s\\S]*?)</"+i[0]+">"));c&&c.length>0&&(n[i[1]]=c[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&KS(n.HeadingPairs,n.TitlesOfParts,e,r),e}var v8=/<[^>]+>[^<]*/g;function _8(t,e){var r={},n="",i=t.match(v8);if(i)for(var o=0;o!=i.length;++o){var c=i[o],u=st(c);switch(u[0]){case"<?xml":break;case"<Properties":break;case"<property":n=Nt(u.name);break;case"</property>":n=null;break;default:if(c.indexOf("<vt:")===0){var h=c.split(">"),d=h[0].slice(4),g=h[1];switch(d){case"lpstr":case"bstr":case"lpwstr":r[n]=Nt(g);break;case"bool":r[n]=ir(g);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[n]=parseInt(g,10);break;case"r4":case"r8":case"decimal":r[n]=parseFloat(g);break;case"filetime":case"date":r[n]=Jr(g);break;case"cy":case"error":r[n]=Nt(g);break;default:if(d.slice(-1)=="/")break;e.WTF&&typeof console<"u"&&console.warn("Unexpected",c,d,h)}}else if(c.slice(0,2)!=="</"){if(e.WTF)throw new Error(c)}}}return r}var x8={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},Qm;function y8(t,e,r){Qm||(Qm=W1(x8)),e=Qm[e]||e,t[e]=r}function nv(t){var e=t.read_shift(4),r=t.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+e/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function XS(t,e,r){var n=t.l,i=t.read_shift(0,"lpstr-cp");if(r)for(;t.l-n&3;)++t.l;return i}function WS(t,e,r){var n=t.read_shift(0,"lpwstr");return n}function YS(t,e,r){return e===31?WS(t):XS(t,e,r)}function Pg(t,e,r){return YS(t,e,r===!1?0:4)}function E8(t,e){if(!e)throw new Error("VtUnalignedString must have positive length");return YS(t,e,0)}function T8(t){for(var e=t.read_shift(4),r=[],n=0;n!=e;++n){var i=t.l;r[n]=t.read_shift(0,"lpwstr").replace(Sn,""),t.l-i&2&&(t.l+=2)}return r}function A8(t){for(var e=t.read_shift(4),r=[],n=0;n!=e;++n)r[n]=t.read_shift(0,"lpstr-cp").replace(Sn,"");return r}function w8(t){var e=t.l,r=Y0(t,HS);t[t.l]==0&&t[t.l+1]==0&&t.l-e&2&&(t.l+=2);var n=Y0(t,On);return[r,n]}function S8(t){for(var e=t.read_shift(4),r=[],n=0;n<e/2;++n)r.push(w8(t));return r}function HT(t,e){for(var r=t.read_shift(4),n={},i=0;i!=r;++i){var o=t.read_shift(4),c=t.read_shift(4);n[o]=t.read_shift(c,e===1200?"utf16le":"utf8").replace(Sn,"").replace(Iu,"!"),e===1200&&c%2&&(t.l+=2)}return t.l&3&&(t.l=t.l>>3<<2),n}function $S(t){var e=t.read_shift(4),r=t.slice(t.l,t.l+e);return t.l+=e,(e&3)>0&&(t.l+=4-(e&3)&3),r}function C8(t){var e={};return e.Size=t.read_shift(4),t.l+=e.Size+3-(e.Size-1)%4,e}function Y0(t,e,r){var n=t.read_shift(2),i,o=r||{};if(t.l+=2,e!==BT&&n!==e&&a8.indexOf(e)===-1&&!((e&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+e+" saw "+n);switch(e===BT?n:e){case 2:return i=t.read_shift(2,"i"),o.raw||(t.l+=2),i;case 3:return i=t.read_shift(4,"i"),i;case 11:return t.read_shift(4)!==0;case 19:return i=t.read_shift(4),i;case 30:return XS(t,n,4).replace(Sn,"");case 31:return WS(t);case 64:return nv(t);case 65:return $S(t);case 71:return C8(t);case 80:return Pg(t,n,!o.raw).replace(Sn,"");case 81:return E8(t,n).replace(Sn,"");case 4108:return S8(t);case 4126:case 4127:return n==4127?T8(t):A8(t);default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+n)}}function GT(t,e){var r=t.l,n=t.read_shift(4),i=t.read_shift(4),o=[],c=0,u=0,h=-1,d={};for(c=0;c!=i;++c){var g=t.read_shift(4),_=t.read_shift(4);o[c]=[g,_+r]}o.sort(function(W,P){return W[1]-P[1]});var x={};for(c=0;c!=i;++c){if(t.l!==o[c][1]){var A=!0;if(c>0&&e)switch(e[o[c-1][0]].t){case 2:t.l+2===o[c][1]&&(t.l+=2,A=!1);break;case 80:t.l<=o[c][1]&&(t.l=o[c][1],A=!1);break;case 4108:t.l<=o[c][1]&&(t.l=o[c][1],A=!1);break}if((!e||c==0)&&t.l<=o[c][1]&&(A=!1,t.l=o[c][1]),A)throw new Error("Read Error: Expected address "+o[c][1]+" at "+t.l+" :"+c)}if(e){var w=e[o[c][0]];if(x[w.n]=Y0(t,w.t,{raw:!0}),w.p==="version"&&(x[w.n]=String(x[w.n]>>16)+"."+("0000"+String(x[w.n]&65535)).slice(-4)),w.n=="CodePage")switch(x[w.n]){case 0:x[w.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:ka(u=x[w.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+x[w.n])}}else if(o[c][0]===1){if(u=x.CodePage=Y0(t,rv),ka(u),h!==-1){var S=t.l;t.l=o[h][1],d=HT(t,u),t.l=S}}else if(o[c][0]===0){if(u===0){h=c,t.l=o[c+1][1];continue}d=HT(t,u)}else{var C=d[o[c][0]],z;switch(t[t.l]){case 65:t.l+=4,z=$S(t);break;case 30:t.l+=4,z=Pg(t,t[t.l-4]).replace(/\u0000+$/,"");break;case 31:t.l+=4,z=Pg(t,t[t.l-4]).replace(/\u0000+$/,"");break;case 3:t.l+=4,z=t.read_shift(4,"i");break;case 19:t.l+=4,z=t.read_shift(4);break;case 5:t.l+=4,z=t.read_shift(8,"f");break;case 11:t.l+=4,z=mr(t,4);break;case 64:t.l+=4,z=Jr(nv(t));break;default:throw new Error("unparsed value: "+t[t.l])}x[C]=z}}return t.l=r+n,x}function qT(t,e,r){var n=t.content;if(!n)return{};Qr(n,0);var i,o,c,u,h=0;n.chk("feff","Byte Order: "),n.read_shift(2);var d=n.read_shift(4),g=n.read_shift(16);if(g!==Dt.utils.consts.HEADER_CLSID&&g!==r)throw new Error("Bad PropertySet CLSID "+g);if(i=n.read_shift(4),i!==1&&i!==2)throw new Error("Unrecognized #Sets: "+i);if(o=n.read_shift(16),u=n.read_shift(4),i===1&&u!==n.l)throw new Error("Length mismatch: "+u+" !== "+n.l);i===2&&(c=n.read_shift(16),h=n.read_shift(4));var _=GT(n,e),x={SystemIdentifier:d};for(var A in _)x[A]=_[A];if(x.FMTID=o,i===1)return x;if(h-n.l==2&&(n.l+=2),n.l!==h)throw new Error("Length mismatch 2: "+n.l+" !== "+h);var w;try{w=GT(n,null)}catch{}for(A in w)x[A]=w[A];return x.FMTID=[o,c],x}function _s(t,e){return t.read_shift(e),null}function R8(t,e,r){for(var n=[],i=t.l+e;t.l<i;)n.push(r(t,i-t.l));if(i!==t.l)throw new Error("Slurp error");return n}function mr(t,e){return t.read_shift(e)===1}function Sr(t){return t.read_shift(2,"u")}function QS(t,e){return R8(t,e,Sr)}function k8(t){var e=t.read_shift(1),r=t.read_shift(1);return r===1?e:e===1}function kf(t,e,r){var n=t.read_shift(r&&r.biff>=12?2:1),i="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var o=t.read_shift(1);o&&(i="dbcs-cont")}else r.biff==12&&(i="wstr");r.biff>=2&&r.biff<=5&&(i="cpstr");var c=n?t.read_shift(n,i):"";return c}function b8(t){var e=t.read_shift(2),r=t.read_shift(1),n=r&4,i=r&8,o=1+(r&1),c=0,u,h={};i&&(c=t.read_shift(2)),n&&(u=t.read_shift(4));var d=o==2?"dbcs-cont":"sbcs-cont",g=e===0?"":t.read_shift(e,d);return i&&(t.l+=4*c),n&&(t.l+=u),h.t=g,i||(h.raw="<t>"+h.t+"</t>",h.r=h.t),h}function Ho(t,e,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return t.read_shift(e,"cpstr");if(r.biff>=12)return t.read_shift(e,"dbcs-cont")}var i=t.read_shift(1);return i===0?n=t.read_shift(e,"sbcs-cont"):n=t.read_shift(e,"dbcs-cont"),n}function bf(t,e,r){var n=t.read_shift(r&&r.biff==2?1:2);return n===0?(t.l++,""):Ho(t,n,r)}function rl(t,e,r){if(r.biff>5)return bf(t,e,r);var n=t.read_shift(1);return n===0?(t.l++,""):t.read_shift(n,r.biff<=4||!t.lens?"cpstr":"sbcs-cont")}function I8(t){var e=t.read_shift(1);t.l++;var r=t.read_shift(2);return t.l+=2,[e,r]}function D8(t){var e=t.read_shift(4),r=t.l,n=!1;e>24&&(t.l+=e-24,t.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),t.l=r);var i=t.read_shift((n?e-24:e)>>1,"utf16le").replace(Sn,"");return n&&(t.l+=24),i}function O8(t){for(var e=t.read_shift(2),r="";e-- >0;)r+="../";var n=t.read_shift(0,"lpstr-ansi");if(t.l+=2,t.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var i=t.read_shift(4);if(i===0)return r+n.replace(/\\/g,"/");var o=t.read_shift(4);if(t.read_shift(2)!=3)throw new Error("Bad FileMoniker");var c=t.read_shift(o>>1,"utf16le").replace(Sn,"");return r+c}function N8(t,e){var r=t.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return D8(t);case"0303000000000000c000000000000046":return O8(t);default:throw new Error("Unsupported Moniker "+r)}}function i0(t){var e=t.read_shift(4),r=e>0?t.read_shift(e,"utf16le").replace(Sn,""):"";return r}function F8(t,e){var r=t.l+e,n=t.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var i=t.read_shift(2);t.l+=2;var o,c,u,h,d="",g,_;i&16&&(o=i0(t,r-t.l)),i&128&&(c=i0(t,r-t.l)),(i&257)===257&&(u=i0(t,r-t.l)),(i&257)===1&&(h=N8(t,r-t.l)),i&8&&(d=i0(t,r-t.l)),i&32&&(g=t.read_shift(16)),i&64&&(_=nv(t)),t.l=r;var x=c||u||h||"";x&&d&&(x+="#"+d),x||(x="#"+d),i&2&&x.charAt(0)=="/"&&x.charAt(1)!="/"&&(x="file://"+x);var A={Target:x};return g&&(A.guid=g),_&&(A.time=_),o&&(A.Tooltip=o),A}function ZS(t){var e=t.read_shift(1),r=t.read_shift(1),n=t.read_shift(1),i=t.read_shift(1);return[e,r,n,i]}function JS(t,e){var r=ZS(t);return r[3]=0,r}function oi(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2);return{r:e,c:r,ixfe:n}}function P8(t){var e=t.read_shift(2),r=t.read_shift(2);return t.l+=8,{type:e,flags:r}}function M8(t,e,r){return e===0?"":rl(t,e,r)}function L8(t,e,r){var n=r.biff>8?4:2,i=t.read_shift(n),o=t.read_shift(n,"i"),c=t.read_shift(n,"i");return[i,o,c]}function e4(t){var e=t.read_shift(2),r=tv(t);return[e,r]}function V8(t,e,r){t.l+=4,e-=4;var n=t.l+e,i=kf(t,e,r),o=t.read_shift(2);if(n-=t.l,o!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+o);return t.l+=o,i}function Id(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2),i=t.read_shift(2);return{s:{c:n,r:e},e:{c:i,r}}}function t4(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(1),i=t.read_shift(1);return{s:{c:n,r:e},e:{c:i,r}}}var U8=t4;function r4(t){t.l+=4;var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2);return t.l+=12,[r,e,n]}function B8(t){var e={};return t.l+=4,t.l+=16,e.fSharedNote=t.read_shift(2),t.l+=4,e}function j8(t){var e={};return t.l+=4,t.cf=t.read_shift(2),e}function on(t){t.l+=2,t.l+=t.read_shift(2)}var z8={0:on,4:on,5:on,6:on,7:j8,8:on,9:on,10:on,11:on,12:on,13:B8,14:on,15:on,16:on,17:on,18:on,19:on,20:on,21:r4};function H8(t,e){for(var r=t.l+e,n=[];t.l<r;){var i=t.read_shift(2);t.l-=2;try{n.push(z8[i](t,r-t.l))}catch{return t.l=r,n}}return t.l!=r&&(t.l=r),n}function s0(t,e){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=t.read_shift(2),e-=2,e>=2&&(r.dt=t.read_shift(2),t.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(e>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return t.read_shift(e),r}function G8(t,e){return e===0||t.read_shift(2),1200}function q8(t,e,r){if(r.enc)return t.l+=e,"";var n=t.l,i=rl(t,0,r);return t.read_shift(e+n-t.l),i}function K8(t,e,r){var n=r&&r.biff==8||e==2?t.read_shift(2):(t.l+=e,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function X8(t,e,r){var n=t.read_shift(4),i=t.read_shift(1)&3,o=t.read_shift(1);switch(o){case 0:o="Worksheet";break;case 1:o="Macrosheet";break;case 2:o="Chartsheet";break;case 6:o="VBAModule";break}var c=kf(t,0,r);return c.length===0&&(c="Sheet1"),{pos:n,hs:i,dt:o,name:c}}function W8(t,e){for(var r=t.l+e,n=t.read_shift(4),i=t.read_shift(4),o=[],c=0;c!=i&&t.l<r;++c)o.push(b8(t));return o.Count=n,o.Unique=i,o}function Y8(t,e){var r={};return r.dsst=t.read_shift(2),t.l+=e-2,r}function $8(t){var e={};e.r=t.read_shift(2),e.c=t.read_shift(2),e.cnt=t.read_shift(2)-e.c;var r=t.read_shift(2);t.l+=4;var n=t.read_shift(1);return t.l+=3,n&7&&(e.level=n&7),n&32&&(e.hidden=!0),n&64&&(e.hpt=r/20),e}function Q8(t){var e=P8(t);if(e.type!=2211)throw new Error("Invalid Future Record "+e.type);var r=t.read_shift(4);return r!==0}function Z8(t){return t.read_shift(2),t.read_shift(4)}function KT(t,e,r){var n=0;r&&r.biff==2||(n=t.read_shift(2));var i=t.read_shift(2);r&&r.biff==2&&(n=1-(i>>15),i&=32767);var o={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[o,i]}function J8(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2),i=t.read_shift(2),o=t.read_shift(2),c=t.read_shift(2),u=t.read_shift(2),h=t.read_shift(2),d=t.read_shift(2);return{Pos:[e,r],Dim:[n,i],Flags:o,CurTab:c,FirstTab:u,Selected:h,TabRatio:d}}function eP(t,e,r){if(r&&r.biff>=2&&r.biff<5)return{};var n=t.read_shift(2);return{RTL:n&64}}function tP(){}function rP(t,e,r){var n={dyHeight:t.read_shift(2),fl:t.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:t.l+=2;break;default:t.l+=10;break}return n.name=kf(t,0,r),n}function nP(t){var e=oi(t);return e.isst=t.read_shift(4),e}function aP(t,e,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=t.l+e,i=oi(t);r.biff==2&&t.l++;var o=bf(t,n-t.l,r);return i.val=o,i}function iP(t,e,r){var n=t.read_shift(2),i=rl(t,0,r);return[n,i]}var sP=rl;function XT(t,e,r){var n=t.l+e,i=r.biff==8||!r.biff?4:2,o=t.read_shift(i),c=t.read_shift(i),u=t.read_shift(2),h=t.read_shift(2);return t.l=n,{s:{r:o,c:u},e:{r:c,c:h}}}function oP(t){var e=t.read_shift(2),r=t.read_shift(2),n=e4(t);return{r:e,c:r,ixfe:n[0],rknum:n[1]}}function lP(t,e){for(var r=t.l+e-2,n=t.read_shift(2),i=t.read_shift(2),o=[];t.l<r;)o.push(e4(t));if(t.l!==r)throw new Error("MulRK read error");var c=t.read_shift(2);if(o.length!=c-i+1)throw new Error("MulRK length mismatch");return{r:n,c:i,C:c,rkrec:o}}function cP(t,e){for(var r=t.l+e-2,n=t.read_shift(2),i=t.read_shift(2),o=[];t.l<r;)o.push(t.read_shift(2));if(t.l!==r)throw new Error("MulBlank read error");var c=t.read_shift(2);if(o.length!=c-i+1)throw new Error("MulBlank length mismatch");return{r:n,c:i,C:c,ixfe:o}}function uP(t,e,r,n){var i={},o=t.read_shift(4),c=t.read_shift(4),u=t.read_shift(4),h=t.read_shift(2);return i.patternType=o8[u>>26],n.cellStyles&&(i.alc=o&7,i.fWrap=o>>3&1,i.alcV=o>>4&7,i.fJustLast=o>>7&1,i.trot=o>>8&255,i.cIndent=o>>16&15,i.fShrinkToFit=o>>20&1,i.iReadOrder=o>>22&2,i.fAtrNum=o>>26&1,i.fAtrFnt=o>>27&1,i.fAtrAlc=o>>28&1,i.fAtrBdr=o>>29&1,i.fAtrPat=o>>30&1,i.fAtrProt=o>>31&1,i.dgLeft=c&15,i.dgRight=c>>4&15,i.dgTop=c>>8&15,i.dgBottom=c>>12&15,i.icvLeft=c>>16&127,i.icvRight=c>>23&127,i.grbitDiag=c>>30&3,i.icvTop=u&127,i.icvBottom=u>>7&127,i.icvDiag=u>>14&127,i.dgDiag=u>>21&15,i.icvFore=h&127,i.icvBack=h>>7&127,i.fsxButton=h>>14&1),i}function fP(t,e,r){var n={};return n.ifnt=t.read_shift(2),n.numFmtId=t.read_shift(2),n.flags=t.read_shift(2),n.fStyle=n.flags>>2&1,e-=6,n.data=uP(t,e,n.fStyle,r),n}function hP(t){t.l+=4;var e=[t.read_shift(2),t.read_shift(2)];if(e[0]!==0&&e[0]--,e[1]!==0&&e[1]--,e[0]>7||e[1]>7)throw new Error("Bad Gutters: "+e.join("|"));return e}function WT(t,e,r){var n=oi(t);(r.biff==2||e==9)&&++t.l;var i=k8(t);return n.val=i,n.t=i===!0||i===!1?"b":"e",n}function dP(t,e,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=oi(t),i=fn(t);return n.val=i,n}var YT=M8;function pP(t,e,r){var n=t.l+e,i=t.read_shift(2),o=t.read_shift(2);if(r.sbcch=o,o==1025||o==14849)return[o,i];if(o<1||o>255)throw new Error("Unexpected SupBook type: "+o);for(var c=Ho(t,o),u=[];n>t.l;)u.push(bf(t));return[o,i,c,u]}function $T(t,e,r){var n=t.read_shift(2),i,o={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return r.sbcch===14849&&(i=V8(t,e-2,r)),o.body=i||t.read_shift(e-2),typeof i=="string"&&(o.Name=i),o}var mP=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function QT(t,e,r){var n=t.l+e,i=t.read_shift(2),o=t.read_shift(1),c=t.read_shift(1),u=t.read_shift(r&&r.biff==2?1:2),h=0;(!r||r.biff>=5)&&(r.biff!=5&&(t.l+=2),h=t.read_shift(2),r.biff==5&&(t.l+=2),t.l+=4);var d=Ho(t,c,r);i&32&&(d=mP[d.charCodeAt(0)]);var g=n-t.l;r&&r.biff==2&&--g;var _=n==t.l||u===0||!(g>0)?[]:$9(t,g,r,u);return{chKey:o,Name:d,itab:h,rgce:_}}function n4(t,e,r){if(r.biff<8)return gP(t,e,r);for(var n=[],i=t.l+e,o=t.read_shift(r.biff>8?4:2);o--!==0;)n.push(L8(t,r.biff>8?12:6,r));if(t.l!=i)throw new Error("Bad ExternSheet: "+t.l+" != "+i);return n}function gP(t,e,r){t[t.l+1]==3&&t[t.l]++;var n=kf(t,e,r);return n.charCodeAt(0)==3?n.slice(1):n}function vP(t,e,r){if(r.biff<8){t.l+=e;return}var n=t.read_shift(2),i=t.read_shift(2),o=Ho(t,n,r),c=Ho(t,i,r);return[o,c]}function _P(t,e,r){var n=t4(t);t.l++;var i=t.read_shift(1);return e-=8,[Q9(t,e,r),i,n]}function ZT(t,e,r){var n=U8(t);switch(r.biff){case 2:t.l++,e-=7;break;case 3:case 4:t.l+=2,e-=8;break;default:t.l+=6,e-=12}return[n,W9(t,e,r)]}function xP(t){var e=t.read_shift(4)!==0,r=t.read_shift(4)!==0,n=t.read_shift(4);return[e,r,n]}function yP(t,e,r){if(!(r.biff<8)){var n=t.read_shift(2),i=t.read_shift(2),o=t.read_shift(2),c=t.read_shift(2),u=rl(t,0,r);return r.biff<8&&t.read_shift(1),[{r:n,c:i},u,c,o]}}function EP(t,e,r){return yP(t,e,r)}function TP(t,e){for(var r=[],n=t.read_shift(2);n--;)r.push(Id(t));return r}function AP(t,e,r){if(r&&r.biff<8)return SP(t,e,r);var n=r4(t),i=H8(t,e-22,n[1]);return{cmo:n,ft:i}}var wP={8:function(t,e){var r=t.l+e;t.l+=10;var n=t.read_shift(2);t.l+=4,t.l+=2,t.l+=2,t.l+=2,t.l+=4;var i=t.read_shift(1);return t.l+=i,t.l=r,{fmt:n}}};function SP(t,e,r){t.l+=4;var n=t.read_shift(2),i=t.read_shift(2),o=t.read_shift(2);t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=6,e-=36;var c=[];return c.push((wP[n]||mn)(t,e,r)),{cmo:[i,n,o],ft:c}}function CP(t,e,r){var n=t.l,i="";try{t.l+=4;var o=(r.lastobj||{cmo:[0,0]}).cmo[1],c;[0,5,7,11,12,14].indexOf(o)==-1?t.l+=6:c=I8(t,6,r);var u=t.read_shift(2);t.read_shift(2),Sr(t,2);var h=t.read_shift(2);t.l+=h;for(var d=1;d<t.lens.length-1;++d){if(t.l-n!=t.lens[d])throw new Error("TxO: bad continue record");var g=t[t.l],_=Ho(t,t.lens[d+1]-t.lens[d]-1);if(i+=_,i.length>=(g?u:2*u))break}if(i.length!==u&&i.length!==u*2)throw new Error("cchText: "+u+" != "+i.length);return t.l=n+e,{t:i}}catch{return t.l=n+e,{t:i}}}function RP(t,e){var r=Id(t);t.l+=16;var n=F8(t,e-24);return[r,n]}function kP(t,e){t.read_shift(2);var r=Id(t),n=t.read_shift((e-10)/2,"dbcs-cont");return n=n.replace(Sn,""),[r,n]}function bP(t){var e=[0,0],r;return r=t.read_shift(2),e[0]=jT[r]||r,r=t.read_shift(2),e[1]=jT[r]||r,e}function IP(t){for(var e=t.read_shift(2),r=[];e-- >0;)r.push(JS(t));return r}function DP(t){for(var e=t.read_shift(2),r=[];e-- >0;)r.push(JS(t));return r}function OP(t){t.l+=2;var e={cxfs:0,crc:0};return e.cxfs=t.read_shift(2),e.crc=t.read_shift(4),e}function a4(t,e,r){if(!r.cellStyles)return mn(t,e);var n=r&&r.biff>=12?4:2,i=t.read_shift(n),o=t.read_shift(n),c=t.read_shift(n),u=t.read_shift(n),h=t.read_shift(2);n==2&&(t.l+=2);var d={s:i,e:o,w:c,ixfe:u,flags:h};return(r.biff>=5||!r.biff)&&(d.level=h>>8&7),d}function NP(t,e){var r={};return e<32||(t.l+=16,r.header=fn(t),r.footer=fn(t),t.l+=2),r}function FP(t,e,r){var n={area:!1};if(r.biff!=5)return t.l+=e,n;var i=t.read_shift(1);return t.l+=3,i&16&&(n.area=!0),n}var PP=oi,MP=QS,LP=bf;function VP(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(4),i={fmt:e,env:r,len:n,data:t.slice(t.l,t.l+n)};return t.l+=n,i}function UP(t,e,r){r.biffguess&&r.biff==5&&(r.biff=2);var n=oi(t);++t.l;var i=rl(t,e-7,r);return n.t="str",n.val=i,n}function BP(t){var e=oi(t);++t.l;var r=fn(t);return e.t="n",e.val=r,e}function jP(t){var e=oi(t);++t.l;var r=t.read_shift(2);return e.t="n",e.val=r,e}function zP(t){var e=t.read_shift(1);return e===0?(t.l++,""):t.read_shift(e,"sbcs-cont")}function HP(t,e){t.l+=6,t.l+=2,t.l+=1,t.l+=3,t.l+=1,t.l+=e-13}function GP(t,e,r){var n=t.l+e,i=oi(t),o=t.read_shift(2),c=Ho(t,o,r);return t.l=n,i.t="str",i.val=c,i}var qP=[2,3,48,49,131,139,140,245],JT=function(){var t={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},e=W1({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(u,h){var d=[],g=Gs(1);switch(h.type){case"base64":g=Ca(Wn(u));break;case"binary":g=Ca(u);break;case"buffer":case"array":g=u;break}Qr(g,0);var _=g.read_shift(1),x=!!(_&136),A=!1,w=!1;switch(_){case 2:break;case 3:break;case 48:A=!0,x=!0;break;case 49:A=!0,x=!0;break;case 131:break;case 139:break;case 140:w=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+_.toString(16))}var S=0,C=521;_==2&&(S=g.read_shift(2)),g.l+=3,_!=2&&(S=g.read_shift(4)),S>1048576&&(S=1e6),_!=2&&(C=g.read_shift(2));var z=g.read_shift(2),W=h.codepage||1252;_!=2&&(g.l+=16,g.read_shift(1),g[g.l]!==0&&(W=t[g[g.l]]),g.l+=1,g.l+=2),w&&(g.l+=36);for(var P=[],re={},Q=Math.min(g.length,_==2?521:C-10-(A?264:0)),ee=w?32:11;g.l<Q&&g[g.l]!=13;)switch(re={},re.name=sf.utils.decode(W,g.slice(g.l,g.l+ee)).replace(/[\u0000\r\n].*$/g,""),g.l+=ee,re.type=String.fromCharCode(g.read_shift(1)),_!=2&&!w&&(re.offset=g.read_shift(4)),re.len=g.read_shift(1),_==2&&(re.offset=g.read_shift(2)),re.dec=g.read_shift(1),re.name.length&&P.push(re),_!=2&&(g.l+=w?13:14),re.type){case"B":(!A||re.len!=8)&&h.WTF&&console.log("Skipping "+re.name+":"+re.type);break;case"G":case"P":h.WTF&&console.log("Skipping "+re.name+":"+re.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+re.type)}if(g[g.l]!==13&&(g.l=C-1),g.read_shift(1)!==13)throw new Error("DBF Terminator not found "+g.l+" "+g[g.l]);g.l=C;var k=0,T=0;for(d[0]=[],T=0;T!=P.length;++T)d[0][T]=P[T].name;for(;S-- >0;){if(g[g.l]===42){g.l+=z;continue}for(++g.l,d[++k]=[],T=0,T=0;T!=P.length;++T){var E=g.slice(g.l,g.l+P[T].len);g.l+=P[T].len,Qr(E,0);var I=sf.utils.decode(W,E);switch(P[T].type){case"C":I.trim().length&&(d[k][T]=I.replace(/\s+$/,""));break;case"D":I.length===8?d[k][T]=new Date(+I.slice(0,4),+I.slice(4,6)-1,+I.slice(6,8)):d[k][T]=I;break;case"F":d[k][T]=parseFloat(I.trim());break;case"+":case"I":d[k][T]=w?E.read_shift(-4,"i")^2147483648:E.read_shift(4,"i");break;case"L":switch(I.trim().toUpperCase()){case"Y":case"T":d[k][T]=!0;break;case"N":case"F":d[k][T]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+I+"|")}break;case"M":if(!x)throw new Error("DBF Unexpected MEMO for type "+_.toString(16));d[k][T]="##MEMO##"+(w?parseInt(I.trim(),10):E.read_shift(4));break;case"N":I=I.replace(/\u0000/g,"").trim(),I&&I!="."&&(d[k][T]=+I||0);break;case"@":d[k][T]=new Date(E.read_shift(-8,"f")-621356832e5);break;case"T":d[k][T]=new Date((E.read_shift(4)-2440588)*864e5+E.read_shift(4));break;case"Y":d[k][T]=E.read_shift(4,"i")/1e4+E.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":d[k][T]=-E.read_shift(-8,"f");break;case"B":if(A&&P[T].len==8){d[k][T]=E.read_shift(8,"f");break}case"G":case"P":E.l+=P[T].len;break;case"0":if(P[T].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+P[T].type)}}}if(_!=2&&g.l<g.length&&g[g.l++]!=26)throw new Error("DBF EOF Marker missing "+(g.l-1)+" of "+g.length+" "+g[g.l-1].toString(16));return h&&h.sheetRows&&(d=d.slice(0,h.sheetRows)),h.DBF=P,d}function n(u,h){var d=h||{};d.dateNF||(d.dateNF="yyyymmdd");var g=Rf(r(u,d),d);return g["!cols"]=d.DBF.map(function(_){return{wch:_.len,DBF:_}}),delete d.DBF,g}function i(u,h){try{return Zo(n(u,h),h)}catch(d){if(h&&h.WTF)throw d}return{SheetNames:[],Sheets:{}}}var o={B:8,C:250,L:1,D:8,"?":0,"":0};function c(u,h){var d=h||{};if(+d.codepage>=0&&ka(+d.codepage),d.type=="string")throw new Error("Cannot write DBF to JS string");var g=Og(),_=O4(u,{header:1,raw:!0,cellDates:!0}),x=_[0],A=_.slice(1),w=u["!cols"]||[],S=0,C=0,z=0,W=1;for(S=0;S<x.length;++S){if(((w[S]||{}).DBF||{}).name){x[S]=w[S].DBF.name,++z;continue}if(x[S]!=null){if(++z,typeof x[S]=="number"&&(x[S]=x[S].toString(10)),typeof x[S]!="string")throw new Error("DBF Invalid column name "+x[S]+" |"+typeof x[S]+"|");if(x.indexOf(x[S])!==S){for(C=0;C<1024;++C)if(x.indexOf(x[S]+"_"+C)==-1){x[S]+="_"+C;break}}}}var P=qr(u["!ref"]),re=[],Q=[],ee=[];for(S=0;S<=P.e.c-P.s.c;++S){var k="",T="",E=0,I=[];for(C=0;C<A.length;++C)A[C][S]!=null&&I.push(A[C][S]);if(I.length==0||x[S]==null){re[S]="?";continue}for(C=0;C<I.length;++C){switch(typeof I[C]){case"number":T="B";break;case"string":T="C";break;case"boolean":T="L";break;case"object":T=I[C]instanceof Date?"D":"C";break;default:T="C"}E=Math.max(E,String(I[C]).length),k=k&&k!=T?"C":T}E>250&&(E=250),T=((w[S]||{}).DBF||{}).type,T=="C"&&w[S].DBF.len>E&&(E=w[S].DBF.len),k=="B"&&T=="N"&&(k="N",ee[S]=w[S].DBF.dec,E=w[S].DBF.len),Q[S]=k=="C"||T=="N"?E:o[k]||0,W+=Q[S],re[S]=k}var O=g.next(32);for(O.write_shift(4,318902576),O.write_shift(4,A.length),O.write_shift(2,296+32*z),O.write_shift(2,W),S=0;S<4;++S)O.write_shift(4,0);for(O.write_shift(4,0|(+e[rS]||3)<<8),S=0,C=0;S<x.length;++S)if(x[S]!=null){var D=g.next(32),F=(x[S].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);D.write_shift(1,F,"sbcs"),D.write_shift(1,re[S]=="?"?"C":re[S],"sbcs"),D.write_shift(4,C),D.write_shift(1,Q[S]||o[re[S]]||0),D.write_shift(1,ee[S]||0),D.write_shift(1,2),D.write_shift(4,0),D.write_shift(1,0),D.write_shift(4,0),D.write_shift(4,0),C+=Q[S]||o[re[S]]||0}var Fe=g.next(264);for(Fe.write_shift(4,13),S=0;S<65;++S)Fe.write_shift(4,0);for(S=0;S<A.length;++S){var Ce=g.next(W);for(Ce.write_shift(1,0),C=0;C<x.length;++C)if(x[C]!=null)switch(re[C]){case"L":Ce.write_shift(1,A[S][C]==null?63:A[S][C]?84:70);break;case"B":Ce.write_shift(8,A[S][C]||0,"f");break;case"N":var ne="0";for(typeof A[S][C]=="number"&&(ne=A[S][C].toFixed(ee[C]||0)),z=0;z<Q[C]-ne.length;++z)Ce.write_shift(1,32);Ce.write_shift(1,ne,"sbcs");break;case"D":A[S][C]?(Ce.write_shift(4,("0000"+A[S][C].getFullYear()).slice(-4),"sbcs"),Ce.write_shift(2,("00"+(A[S][C].getMonth()+1)).slice(-2),"sbcs"),Ce.write_shift(2,("00"+A[S][C].getDate()).slice(-2),"sbcs")):Ce.write_shift(8,"00000000","sbcs");break;case"C":var oe=String(A[S][C]!=null?A[S][C]:"").slice(0,Q[C]);for(Ce.write_shift(1,oe,"sbcs"),z=0;z<Q[C]-oe.length;++z)Ce.write_shift(1,32);break}}return g.next(1).write_shift(1,26),g.end()}return{to_workbook:i,to_sheet:n,from_sheet:c}}(),KP=function(){var t={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},e=new RegExp("\x1BN("+qs(t).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(x,A){var w=t[A];return typeof w=="number"?mT(w):w},n=function(x,A,w){var S=A.charCodeAt(0)-32<<4|w.charCodeAt(0)-48;return S==59?x:mT(S)};t["|"]=254;function i(x,A){switch(A.type){case"base64":return o(Wn(x),A);case"binary":return o(x,A);case"buffer":return o(wt&&Buffer.isBuffer(x)?x.toString("binary"):Qo(x),A);case"array":return o(zo(x),A)}throw new Error("Unrecognized type "+A.type)}function o(x,A){var w=x.split(/[\n\r]+/),S=-1,C=-1,z=0,W=0,P=[],re=[],Q=null,ee={},k=[],T=[],E=[],I=0,O;for(+A.codepage>=0&&ka(+A.codepage);z!==w.length;++z){I=0;var D=w[z].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(e,r),F=D.replace(/;;/g,"\0").split(";").map(function(Z){return Z.replace(/\u0000/g,";")}),Fe=F[0],Ce;if(D.length>0)switch(Fe){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":F[1].charAt(0)=="P"&&re.push(D.slice(3).replace(/;;/g,";"));break;case"C":var ne=!1,oe=!1,be=!1,te=!1,G=-1,se=-1;for(W=1;W<F.length;++W)switch(F[W].charAt(0)){case"A":break;case"X":C=parseInt(F[W].slice(1))-1,oe=!0;break;case"Y":for(S=parseInt(F[W].slice(1))-1,oe||(C=0),O=P.length;O<=S;++O)P[O]=[];break;case"K":Ce=F[W].slice(1),Ce.charAt(0)==='"'?Ce=Ce.slice(1,Ce.length-1):Ce==="TRUE"?Ce=!0:Ce==="FALSE"?Ce=!1:isNaN(Pi(Ce))?isNaN(lf(Ce).getDate())||(Ce=Jr(Ce)):(Ce=Pi(Ce),Q!==null&&Tc(Q)&&(Ce=bd(Ce))),ne=!0;break;case"E":te=!0;var M=nc(F[W].slice(1),{r:S,c:C});P[S][C]=[P[S][C],M];break;case"S":be=!0,P[S][C]=[P[S][C],"S5S"];break;case"G":break;case"R":G=parseInt(F[W].slice(1))-1;break;case"C":se=parseInt(F[W].slice(1))-1;break;default:if(A&&A.WTF)throw new Error("SYLK bad record "+D)}if(ne&&(P[S][C]&&P[S][C].length==2?P[S][C][0]=Ce:P[S][C]=Ce,Q=null),be){if(te)throw new Error("SYLK shared formula cannot have own formula");var j=G>-1&&P[G][se];if(!j||!j[1])throw new Error("SYLK shared formula cannot find base");P[S][C][1]=p4(j[1],{r:S-G,c:C-se})}break;case"F":var Y=0;for(W=1;W<F.length;++W)switch(F[W].charAt(0)){case"X":C=parseInt(F[W].slice(1))-1,++Y;break;case"Y":for(S=parseInt(F[W].slice(1))-1,O=P.length;O<=S;++O)P[O]=[];break;case"M":I=parseInt(F[W].slice(1))/20;break;case"F":break;case"G":break;case"P":Q=re[parseInt(F[W].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(E=F[W].slice(1).split(" "),O=parseInt(E[0],10);O<=parseInt(E[1],10);++O)I=parseInt(E[2],10),T[O-1]=I===0?{hidden:!0}:{wch:I},dc(T[O-1]);break;case"C":C=parseInt(F[W].slice(1))-1,T[C]||(T[C]={});break;case"R":S=parseInt(F[W].slice(1))-1,k[S]||(k[S]={}),I>0?(k[S].hpt=I,k[S].hpx=df(I)):I===0&&(k[S].hidden=!0);break;default:if(A&&A.WTF)throw new Error("SYLK bad record "+D)}Y<1&&(Q=null);break;default:if(A&&A.WTF)throw new Error("SYLK bad record "+D)}}return k.length>0&&(ee["!rows"]=k),T.length>0&&(ee["!cols"]=T),A&&A.sheetRows&&(P=P.slice(0,A.sheetRows)),[P,ee]}function c(x,A){var w=i(x,A),S=w[0],C=w[1],z=Rf(S,A);return qs(C).forEach(function(W){z[W]=C[W]}),z}function u(x,A){return Zo(c(x,A),A)}function h(x,A,w,S){var C="C;Y"+(w+1)+";X"+(S+1)+";K";switch(x.t){case"n":C+=x.v||0,x.f&&!x.F&&(C+=";E"+O5(x.f,{r:w,c:S}));break;case"b":C+=x.v?"TRUE":"FALSE";break;case"e":C+=x.w||x.v;break;case"d":C+='"'+(x.w||x.v)+'"';break;case"s":C+='"'+x.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return C}function d(x,A){A.forEach(function(w,S){var C="F;W"+(S+1)+" "+(S+1)+" ";w.hidden?C+="0":(typeof w.width=="number"&&!w.wpx&&(w.wpx=Q0(w.width)),typeof w.wpx=="number"&&!w.wch&&(w.wch=Z0(w.wpx)),typeof w.wch=="number"&&(C+=Math.round(w.wch))),C.charAt(C.length-1)!=" "&&x.push(C)})}function g(x,A){A.forEach(function(w,S){var C="F;";w.hidden?C+="M0;":w.hpt?C+="M"+20*w.hpt+";":w.hpx&&(C+="M"+20*f4(w.hpx)+";"),C.length>2&&x.push(C+"R"+(S+1))})}function _(x,A){var w=["ID;PWXL;N;E"],S=[],C=qr(x["!ref"]),z,W=Array.isArray(x),P=`\r
`;w.push("P;PGeneral"),w.push("F;P0;DG0G8;M255"),x["!cols"]&&d(w,x["!cols"]),x["!rows"]&&g(w,x["!rows"]),w.push("B;Y"+(C.e.r-C.s.r+1)+";X"+(C.e.c-C.s.c+1)+";D"+[C.s.c,C.s.r,C.e.c,C.e.r].join(" "));for(var re=C.s.r;re<=C.e.r;++re)for(var Q=C.s.c;Q<=C.e.c;++Q){var ee=vt({r:re,c:Q});z=W?(x[re]||[])[Q]:x[ee],!(!z||z.v==null&&(!z.f||z.F))&&S.push(h(z,x,re,Q))}return w.join(P)+P+S.join(P)+P+"E"+P}return{to_workbook:u,to_sheet:c,from_sheet:_}}(),XP=function(){function t(o,c){switch(c.type){case"base64":return e(Wn(o),c);case"binary":return e(o,c);case"buffer":return e(wt&&Buffer.isBuffer(o)?o.toString("binary"):Qo(o),c);case"array":return e(zo(o),c)}throw new Error("Unrecognized type "+c.type)}function e(o,c){for(var u=o.split(`
`),h=-1,d=-1,g=0,_=[];g!==u.length;++g){if(u[g].trim()==="BOT"){_[++h]=[],d=0;continue}if(!(h<0)){var x=u[g].trim().split(","),A=x[0],w=x[1];++g;for(var S=u[g]||"";(S.match(/["]/g)||[]).length&1&&g<u.length-1;)S+=`
`+u[++g];switch(S=S.trim(),+A){case-1:if(S==="BOT"){_[++h]=[],d=0;continue}else if(S!=="EOD")throw new Error("Unrecognized DIF special command "+S);break;case 0:S==="TRUE"?_[h][d]=!0:S==="FALSE"?_[h][d]=!1:isNaN(Pi(w))?isNaN(lf(w).getDate())?_[h][d]=w:_[h][d]=Jr(w):_[h][d]=Pi(w),++d;break;case 1:S=S.slice(1,S.length-1),S=S.replace(/""/g,'"'),S&&S.match(/^=".*"$/)&&(S=S.slice(2,-1)),_[h][d++]=S!==""?S:null;break}if(S==="EOD")break}}return c&&c.sheetRows&&(_=_.slice(0,c.sheetRows)),_}function r(o,c){return Rf(t(o,c),c)}function n(o,c){return Zo(r(o,c),c)}var i=function(){var o=function(h,d,g,_,x){h.push(d),h.push(g+","+_),h.push('"'+x.replace(/"/g,'""')+'"')},c=function(h,d,g,_){h.push(d+","+g),h.push(d==1?'"'+_.replace(/"/g,'""')+'"':_)};return function(h){var d=[],g=qr(h["!ref"]),_,x=Array.isArray(h);o(d,"TABLE",0,1,"sheetjs"),o(d,"VECTORS",0,g.e.r-g.s.r+1,""),o(d,"TUPLES",0,g.e.c-g.s.c+1,""),o(d,"DATA",0,0,"");for(var A=g.s.r;A<=g.e.r;++A){c(d,-1,0,"BOT");for(var w=g.s.c;w<=g.e.c;++w){var S=vt({r:A,c:w});if(_=x?(h[A]||[])[w]:h[S],!_){c(d,1,0,"");continue}switch(_.t){case"n":var C=_.w;!C&&_.v!=null&&(C=_.v),C==null?_.f&&!_.F?c(d,1,0,"="+_.f):c(d,1,0,""):c(d,0,C,"V");break;case"b":c(d,0,_.v?1:0,_.v?"TRUE":"FALSE");break;case"s":c(d,1,0,isNaN(_.v)?_.v:'="'+_.v+'"');break;case"d":_.w||(_.w=ga(_.z||ht[14],Yn(Jr(_.v)))),c(d,0,_.w,"V");break;default:c(d,1,0,"")}}}c(d,-1,0,"EOD");var z=`\r
`,W=d.join(z);return W}}();return{to_workbook:n,to_sheet:r,from_sheet:i}}(),WP=function(){function t(_){return _.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function e(_){return _.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(_,x){for(var A=_.split(`
`),w=-1,S=-1,C=0,z=[];C!==A.length;++C){var W=A[C].trim().split(":");if(W[0]==="cell"){var P=Ia(W[1]);if(z.length<=P.r)for(w=z.length;w<=P.r;++w)z[w]||(z[w]=[]);switch(w=P.r,S=P.c,W[2]){case"t":z[w][S]=t(W[3]);break;case"v":z[w][S]=+W[3];break;case"vtf":var re=W[W.length-1];case"vtc":switch(W[3]){case"nl":z[w][S]=!!+W[4];break;default:z[w][S]=+W[4];break}W[2]=="vtf"&&(z[w][S]=[z[w][S],re])}}}return x&&x.sheetRows&&(z=z.slice(0,x.sheetRows)),z}function n(_,x){return Rf(r(_,x),x)}function i(_,x){return Zo(n(_,x),x)}var o=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),c=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,u=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),h="--SocialCalcSpreadsheetControlSave--";function d(_){if(!_||!_["!ref"])return"";for(var x=[],A=[],w,S="",C=Z1(_["!ref"]),z=Array.isArray(_),W=C.s.r;W<=C.e.r;++W)for(var P=C.s.c;P<=C.e.c;++P)if(S=vt({r:W,c:P}),w=z?(_[W]||[])[P]:_[S],!(!w||w.v==null||w.t==="z")){switch(A=["cell",S,"t"],w.t){case"s":case"str":A.push(e(w.v));break;case"n":w.f?(A[2]="vtf",A[3]="n",A[4]=w.v,A[5]=e(w.f)):(A[2]="v",A[3]=w.v);break;case"b":A[2]="vt"+(w.f?"f":"c"),A[3]="nl",A[4]=w.v?"1":"0",A[5]=e(w.f||(w.v?"TRUE":"FALSE"));break;case"d":var re=Yn(Jr(w.v));A[2]="vtc",A[3]="nd",A[4]=""+re,A[5]=w.w||ga(w.z||ht[14],re);break;case"e":continue}x.push(A.join(":"))}return x.push("sheet:c:"+(C.e.c-C.s.c+1)+":r:"+(C.e.r-C.s.r+1)+":tvf:1"),x.push("valueformat:1:text-wiki"),x.join(`
`)}function g(_){return[o,c,u,c,d(_),h].join(`
`)}return{to_workbook:i,to_sheet:n,from_sheet:g}}(),ff=function(){function t(g,_,x,A,w){w.raw?_[x][A]=g:g===""||(g==="TRUE"?_[x][A]=!0:g==="FALSE"?_[x][A]=!1:isNaN(Pi(g))?isNaN(lf(g).getDate())?_[x][A]=g:_[x][A]=Jr(g):_[x][A]=Pi(g))}function e(g,_){var x=_||{},A=[];if(!g||g.length===0)return A;for(var w=g.split(/[\r\n]/),S=w.length-1;S>=0&&w[S].length===0;)--S;for(var C=10,z=0,W=0;W<=S;++W)z=w[W].indexOf(" "),z==-1?z=w[W].length:z++,C=Math.max(C,z);for(W=0;W<=S;++W){A[W]=[];var P=0;for(t(w[W].slice(0,C).trim(),A,W,P,x),P=1;P<=(w[W].length-C)/10+1;++P)t(w[W].slice(C+(P-1)*10,C+P*10).trim(),A,W,P,x)}return x.sheetRows&&(A=A.slice(0,x.sheetRows)),A}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function i(g){for(var _={},x=!1,A=0,w=0;A<g.length;++A)(w=g.charCodeAt(A))==34?x=!x:!x&&w in r&&(_[w]=(_[w]||0)+1);w=[];for(A in _)Object.prototype.hasOwnProperty.call(_,A)&&w.push([_[A],A]);if(!w.length){_=n;for(A in _)Object.prototype.hasOwnProperty.call(_,A)&&w.push([_[A],A])}return w.sort(function(S,C){return S[0]-C[0]||n[S[1]]-n[C[1]]}),r[w.pop()[1]]||44}function o(g,_){var x=_||{},A="",w=x.dense?[]:{},S={s:{c:0,r:0},e:{c:0,r:0}};g.slice(0,4)=="sep="?g.charCodeAt(5)==13&&g.charCodeAt(6)==10?(A=g.charAt(4),g=g.slice(7)):g.charCodeAt(5)==13||g.charCodeAt(5)==10?(A=g.charAt(4),g=g.slice(6)):A=i(g.slice(0,1024)):x&&x.FS?A=x.FS:A=i(g.slice(0,1024));var C=0,z=0,W=0,P=0,re=0,Q=A.charCodeAt(0),ee=!1,k=0,T=g.charCodeAt(0);g=g.replace(/\r\n/mg,`
`);var E=x.dateNF!=null?oF(x.dateNF):null;function I(){var O=g.slice(P,re),D={};if(O.charAt(0)=='"'&&O.charAt(O.length-1)=='"'&&(O=O.slice(1,-1).replace(/""/g,'"')),O.length===0)D.t="z";else if(x.raw)D.t="s",D.v=O;else if(O.trim().length===0)D.t="s",D.v=O;else if(O.charCodeAt(0)==61)O.charCodeAt(1)==34&&O.charCodeAt(O.length-1)==34?(D.t="s",D.v=O.slice(2,-1).replace(/""/g,'"')):F5(O)?(D.t="n",D.f=O.slice(1)):(D.t="s",D.v=O);else if(O=="TRUE")D.t="b",D.v=!0;else if(O=="FALSE")D.t="b",D.v=!1;else if(!isNaN(W=Pi(O)))D.t="n",x.cellText!==!1&&(D.w=O),D.v=W;else if(!isNaN(lf(O).getDate())||E&&O.match(E)){D.z=x.dateNF||ht[14];var F=0;E&&O.match(E)&&(O=lF(O,x.dateNF,O.match(E)||[]),F=1),x.cellDates?(D.t="d",D.v=Jr(O,F)):(D.t="n",D.v=Yn(Jr(O,F))),x.cellText!==!1&&(D.w=ga(D.z,D.v instanceof Date?Yn(D.v):D.v)),x.cellNF||delete D.z}else D.t="s",D.v=O;if(D.t=="z"||(x.dense?(w[C]||(w[C]=[]),w[C][z]=D):w[vt({c:z,r:C})]=D),P=re+1,T=g.charCodeAt(P),S.e.c<z&&(S.e.c=z),S.e.r<C&&(S.e.r=C),k==Q)++z;else if(z=0,++C,x.sheetRows&&x.sheetRows<=C)return!0}e:for(;re<g.length;++re)switch(k=g.charCodeAt(re)){case 34:T===34&&(ee=!ee);break;case Q:case 10:case 13:if(!ee&&I())break e;break}return re-P>0&&I(),w["!ref"]=qt(S),w}function c(g,_){return!(_&&_.PRN)||_.FS||g.slice(0,4)=="sep="||g.indexOf("	")>=0||g.indexOf(",")>=0||g.indexOf(";")>=0?o(g,_):Rf(e(g,_),_)}function u(g,_){var x="",A=_.type=="string"?[0,0,0,0]:fv(g,_);switch(_.type){case"base64":x=Wn(g);break;case"binary":x=g;break;case"buffer":_.codepage==65001?x=g.toString("utf8"):_.codepage&&typeof sf<"u"||(x=wt&&Buffer.isBuffer(g)?g.toString("binary"):Qo(g));break;case"array":x=zo(g);break;case"string":x=g;break;default:throw new Error("Unrecognized type "+_.type)}return A[0]==239&&A[1]==187&&A[2]==191?x=Jt(x.slice(3)):_.type!="string"&&_.type!="buffer"&&_.codepage==65001?x=Jt(x):_.type=="binary"&&typeof sf<"u",x.slice(0,19)=="socialcalc:version:"?WP.to_sheet(_.type=="string"?x:Jt(x),_):c(x,_)}function h(g,_){return Zo(u(g,_),_)}function d(g){for(var _=[],x=qr(g["!ref"]),A,w=Array.isArray(g),S=x.s.r;S<=x.e.r;++S){for(var C=[],z=x.s.c;z<=x.e.c;++z){var W=vt({r:S,c:z});if(A=w?(g[S]||[])[z]:g[W],!A||A.v==null){C.push("          ");continue}for(var P=(A.w||(hc(A),A.w)||"").slice(0,10);P.length<10;)P+=" ";C.push(P+(z===0?" ":""))}_.push(C.join(""))}return _.join(`
`)}return{to_workbook:h,to_sheet:u,from_sheet:d}}();function YP(t,e){var r=e||{},n=!!r.WTF;r.WTF=!0;try{var i=KP.to_workbook(t,r);return r.WTF=n,i}catch(o){if(r.WTF=n,!o.message.match(/SYLK bad record ID/)&&n)throw o;return ff.to_workbook(t,e)}}var Gu=function(){function t(M,j,Y){if(M){Qr(M,M.l||0);for(var Z=Y.Enum||G;M.l<M.length;){var ue=M.read_shift(2),Ie=Z[ue]||Z[65535],Ee=M.read_shift(2),we=M.l+Ee,Te=Ie.f&&Ie.f(M,Ee,Y);if(M.l=we,j(Te,Ie,ue))return}}}function e(M,j){switch(j.type){case"base64":return r(Ca(Wn(M)),j);case"binary":return r(Ca(M),j);case"buffer":case"array":return r(M,j)}throw"Unsupported type "+j.type}function r(M,j){if(!M)return M;var Y=j||{},Z=Y.dense?[]:{},ue="Sheet1",Ie="",Ee=0,we={},Te=[],Ue=[],K={s:{r:0,c:0},e:{r:0,c:0}},nt=Y.sheetRows||0;if(M[2]==0&&(M[3]==8||M[3]==9)&&M.length>=16&&M[14]==5&&M[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(M[2]==2)Y.Enum=G,t(M,function(Ne,Ye,ut){switch(ut){case 0:Y.vers=Ne,Ne>=4096&&(Y.qpro=!0);break;case 6:K=Ne;break;case 204:Ne&&(Ie=Ne);break;case 222:Ie=Ne;break;case 15:case 51:Y.qpro||(Ne[1].v=Ne[1].v.slice(1));case 13:case 14:case 16:ut==14&&(Ne[2]&112)==112&&(Ne[2]&15)>1&&(Ne[2]&15)<15&&(Ne[1].z=Y.dateNF||ht[14],Y.cellDates&&(Ne[1].t="d",Ne[1].v=bd(Ne[1].v))),Y.qpro&&Ne[3]>Ee&&(Z["!ref"]=qt(K),we[ue]=Z,Te.push(ue),Z=Y.dense?[]:{},K={s:{r:0,c:0},e:{r:0,c:0}},Ee=Ne[3],ue=Ie||"Sheet"+(Ee+1),Ie="");var _t=Y.dense?(Z[Ne[0].r]||[])[Ne[0].c]:Z[vt(Ne[0])];if(_t){_t.t=Ne[1].t,_t.v=Ne[1].v,Ne[1].z!=null&&(_t.z=Ne[1].z),Ne[1].f!=null&&(_t.f=Ne[1].f);break}Y.dense?(Z[Ne[0].r]||(Z[Ne[0].r]=[]),Z[Ne[0].r][Ne[0].c]=Ne[1]):Z[vt(Ne[0])]=Ne[1];break}},Y);else if(M[2]==26||M[2]==14)Y.Enum=se,M[2]==14&&(Y.qpro=!0,M.l=0),t(M,function(Ne,Ye,ut){switch(ut){case 204:ue=Ne;break;case 22:Ne[1].v=Ne[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(Ne[3]>Ee&&(Z["!ref"]=qt(K),we[ue]=Z,Te.push(ue),Z=Y.dense?[]:{},K={s:{r:0,c:0},e:{r:0,c:0}},Ee=Ne[3],ue="Sheet"+(Ee+1)),nt>0&&Ne[0].r>=nt)break;Y.dense?(Z[Ne[0].r]||(Z[Ne[0].r]=[]),Z[Ne[0].r][Ne[0].c]=Ne[1]):Z[vt(Ne[0])]=Ne[1],K.e.c<Ne[0].c&&(K.e.c=Ne[0].c),K.e.r<Ne[0].r&&(K.e.r=Ne[0].r);break;case 27:Ne[14e3]&&(Ue[Ne[14e3][0]]=Ne[14e3][1]);break;case 1537:Ue[Ne[0]]=Ne[1],Ne[0]==Ee&&(ue=Ne[1]);break}},Y);else throw new Error("Unrecognized LOTUS BOF "+M[2]);if(Z["!ref"]=qt(K),we[Ie||ue]=Z,Te.push(Ie||ue),!Ue.length)return{SheetNames:Te,Sheets:we};for(var Ge={},Ke=[],Be=0;Be<Ue.length;++Be)we[Te[Be]]?(Ke.push(Ue[Be]||Te[Be]),Ge[Ue[Be]]=we[Ue[Be]]||we[Te[Be]]):(Ke.push(Ue[Be]),Ge[Ue[Be]]={"!ref":"A1"});return{SheetNames:Ke,Sheets:Ge}}function n(M,j){var Y=j||{};if(+Y.codepage>=0&&ka(+Y.codepage),Y.type=="string")throw new Error("Cannot write WK1 to JS string");var Z=Og(),ue=qr(M["!ref"]),Ie=Array.isArray(M),Ee=[];Sa(Z,0,o(1030)),Sa(Z,6,h(ue));for(var we=Math.min(ue.e.r,8191),Te=ue.s.r;Te<=we;++Te)for(var Ue=Xn(Te),K=ue.s.c;K<=ue.e.c;++K){Te===ue.s.r&&(Ee[K]=wn(K));var nt=Ee[K]+Ue,Ge=Ie?(M[Te]||[])[K]:M[nt];if(!(!Ge||Ge.t=="z"))if(Ge.t=="n")(Ge.v|0)==Ge.v&&Ge.v>=-32768&&Ge.v<=32767?Sa(Z,13,A(Te,K,Ge.v)):Sa(Z,14,S(Te,K,Ge.v));else{var Ke=hc(Ge);Sa(Z,15,_(Te,K,Ke.slice(0,239)))}}return Sa(Z,1),Z.end()}function i(M,j){var Y=j||{};if(+Y.codepage>=0&&ka(+Y.codepage),Y.type=="string")throw new Error("Cannot write WK3 to JS string");var Z=Og();Sa(Z,0,c(M));for(var ue=0,Ie=0;ue<M.SheetNames.length;++ue)(M.Sheets[M.SheetNames[ue]]||{})["!ref"]&&Sa(Z,27,te(M.SheetNames[ue],Ie++));var Ee=0;for(ue=0;ue<M.SheetNames.length;++ue){var we=M.Sheets[M.SheetNames[ue]];if(!(!we||!we["!ref"])){for(var Te=qr(we["!ref"]),Ue=Array.isArray(we),K=[],nt=Math.min(Te.e.r,8191),Ge=Te.s.r;Ge<=nt;++Ge)for(var Ke=Xn(Ge),Be=Te.s.c;Be<=Te.e.c;++Be){Ge===Te.s.r&&(K[Be]=wn(Be));var Ne=K[Be]+Ke,Ye=Ue?(we[Ge]||[])[Be]:we[Ne];if(!(!Ye||Ye.t=="z"))if(Ye.t=="n")Sa(Z,23,I(Ge,Be,Ee,Ye.v));else{var ut=hc(Ye);Sa(Z,22,k(Ge,Be,Ee,ut.slice(0,239)))}}++Ee}}return Sa(Z,1),Z.end()}function o(M){var j=Or(2);return j.write_shift(2,M),j}function c(M){var j=Or(26);j.write_shift(2,4096),j.write_shift(2,4),j.write_shift(4,0);for(var Y=0,Z=0,ue=0,Ie=0;Ie<M.SheetNames.length;++Ie){var Ee=M.SheetNames[Ie],we=M.Sheets[Ee];if(!(!we||!we["!ref"])){++ue;var Te=Z1(we["!ref"]);Y<Te.e.r&&(Y=Te.e.r),Z<Te.e.c&&(Z=Te.e.c)}}return Y>8191&&(Y=8191),j.write_shift(2,Y),j.write_shift(1,ue),j.write_shift(1,Z),j.write_shift(2,0),j.write_shift(2,0),j.write_shift(1,1),j.write_shift(1,2),j.write_shift(4,0),j.write_shift(4,0),j}function u(M,j,Y){var Z={s:{c:0,r:0},e:{c:0,r:0}};return j==8&&Y.qpro?(Z.s.c=M.read_shift(1),M.l++,Z.s.r=M.read_shift(2),Z.e.c=M.read_shift(1),M.l++,Z.e.r=M.read_shift(2),Z):(Z.s.c=M.read_shift(2),Z.s.r=M.read_shift(2),j==12&&Y.qpro&&(M.l+=2),Z.e.c=M.read_shift(2),Z.e.r=M.read_shift(2),j==12&&Y.qpro&&(M.l+=2),Z.s.c==65535&&(Z.s.c=Z.e.c=Z.s.r=Z.e.r=0),Z)}function h(M){var j=Or(8);return j.write_shift(2,M.s.c),j.write_shift(2,M.s.r),j.write_shift(2,M.e.c),j.write_shift(2,M.e.r),j}function d(M,j,Y){var Z=[{c:0,r:0},{t:"n",v:0},0,0];return Y.qpro&&Y.vers!=20768?(Z[0].c=M.read_shift(1),Z[3]=M.read_shift(1),Z[0].r=M.read_shift(2),M.l+=2):(Z[2]=M.read_shift(1),Z[0].c=M.read_shift(2),Z[0].r=M.read_shift(2)),Z}function g(M,j,Y){var Z=M.l+j,ue=d(M,j,Y);if(ue[1].t="s",Y.vers==20768){M.l++;var Ie=M.read_shift(1);return ue[1].v=M.read_shift(Ie,"utf8"),ue}return Y.qpro&&M.l++,ue[1].v=M.read_shift(Z-M.l,"cstr"),ue}function _(M,j,Y){var Z=Or(7+Y.length);Z.write_shift(1,255),Z.write_shift(2,j),Z.write_shift(2,M),Z.write_shift(1,39);for(var ue=0;ue<Z.length;++ue){var Ie=Y.charCodeAt(ue);Z.write_shift(1,Ie>=128?95:Ie)}return Z.write_shift(1,0),Z}function x(M,j,Y){var Z=d(M,j,Y);return Z[1].v=M.read_shift(2,"i"),Z}function A(M,j,Y){var Z=Or(7);return Z.write_shift(1,255),Z.write_shift(2,j),Z.write_shift(2,M),Z.write_shift(2,Y,"i"),Z}function w(M,j,Y){var Z=d(M,j,Y);return Z[1].v=M.read_shift(8,"f"),Z}function S(M,j,Y){var Z=Or(13);return Z.write_shift(1,255),Z.write_shift(2,j),Z.write_shift(2,M),Z.write_shift(8,Y,"f"),Z}function C(M,j,Y){var Z=M.l+j,ue=d(M,j,Y);if(ue[1].v=M.read_shift(8,"f"),Y.qpro)M.l=Z;else{var Ie=M.read_shift(2);re(M.slice(M.l,M.l+Ie),ue),M.l+=Ie}return ue}function z(M,j,Y){var Z=j&32768;return j&=-32769,j=(Z?M:0)+(j>=8192?j-16384:j),(Z?"":"$")+(Y?wn(j):Xn(j))}var W={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},P=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function re(M,j){Qr(M,0);for(var Y=[],Z=0,ue="",Ie="",Ee="",we="";M.l<M.length;){var Te=M[M.l++];switch(Te){case 0:Y.push(M.read_shift(8,"f"));break;case 1:Ie=z(j[0].c,M.read_shift(2),!0),ue=z(j[0].r,M.read_shift(2),!1),Y.push(Ie+ue);break;case 2:{var Ue=z(j[0].c,M.read_shift(2),!0),K=z(j[0].r,M.read_shift(2),!1);Ie=z(j[0].c,M.read_shift(2),!0),ue=z(j[0].r,M.read_shift(2),!1),Y.push(Ue+K+":"+Ie+ue)}break;case 3:if(M.l<M.length){console.error("WK1 premature formula end");return}break;case 4:Y.push("("+Y.pop()+")");break;case 5:Y.push(M.read_shift(2));break;case 6:{for(var nt="";Te=M[M.l++];)nt+=String.fromCharCode(Te);Y.push('"'+nt.replace(/"/g,'""')+'"')}break;case 8:Y.push("-"+Y.pop());break;case 23:Y.push("+"+Y.pop());break;case 22:Y.push("NOT("+Y.pop()+")");break;case 20:case 21:we=Y.pop(),Ee=Y.pop(),Y.push(["AND","OR"][Te-20]+"("+Ee+","+we+")");break;default:if(Te<32&&P[Te])we=Y.pop(),Ee=Y.pop(),Y.push(Ee+P[Te]+we);else if(W[Te]){if(Z=W[Te][1],Z==69&&(Z=M[M.l++]),Z>Y.length){console.error("WK1 bad formula parse 0x"+Te.toString(16)+":|"+Y.join("|")+"|");return}var Ge=Y.slice(-Z);Y.length-=Z,Y.push(W[Te][0]+"("+Ge.join(",")+")")}else return Te<=7?console.error("WK1 invalid opcode "+Te.toString(16)):Te<=24?console.error("WK1 unsupported op "+Te.toString(16)):Te<=30?console.error("WK1 invalid opcode "+Te.toString(16)):Te<=115?console.error("WK1 unsupported function opcode "+Te.toString(16)):console.error("WK1 unrecognized opcode "+Te.toString(16))}}Y.length==1?j[1].f=""+Y[0]:console.error("WK1 bad formula parse |"+Y.join("|")+"|")}function Q(M){var j=[{c:0,r:0},{t:"n",v:0},0];return j[0].r=M.read_shift(2),j[3]=M[M.l++],j[0].c=M[M.l++],j}function ee(M,j){var Y=Q(M);return Y[1].t="s",Y[1].v=M.read_shift(j-4,"cstr"),Y}function k(M,j,Y,Z){var ue=Or(6+Z.length);ue.write_shift(2,M),ue.write_shift(1,Y),ue.write_shift(1,j),ue.write_shift(1,39);for(var Ie=0;Ie<Z.length;++Ie){var Ee=Z.charCodeAt(Ie);ue.write_shift(1,Ee>=128?95:Ee)}return ue.write_shift(1,0),ue}function T(M,j){var Y=Q(M);Y[1].v=M.read_shift(2);var Z=Y[1].v>>1;if(Y[1].v&1)switch(Z&7){case 0:Z=(Z>>3)*5e3;break;case 1:Z=(Z>>3)*500;break;case 2:Z=(Z>>3)/20;break;case 3:Z=(Z>>3)/200;break;case 4:Z=(Z>>3)/2e3;break;case 5:Z=(Z>>3)/2e4;break;case 6:Z=(Z>>3)/16;break;case 7:Z=(Z>>3)/64;break}return Y[1].v=Z,Y}function E(M,j){var Y=Q(M),Z=M.read_shift(4),ue=M.read_shift(4),Ie=M.read_shift(2);if(Ie==65535)return Z===0&&ue===3221225472?(Y[1].t="e",Y[1].v=15):Z===0&&ue===3489660928?(Y[1].t="e",Y[1].v=42):Y[1].v=0,Y;var Ee=Ie&32768;return Ie=(Ie&32767)-16446,Y[1].v=(1-Ee*2)*(ue*Math.pow(2,Ie+32)+Z*Math.pow(2,Ie)),Y}function I(M,j,Y,Z){var ue=Or(14);if(ue.write_shift(2,M),ue.write_shift(1,Y),ue.write_shift(1,j),Z==0)return ue.write_shift(4,0),ue.write_shift(4,0),ue.write_shift(2,65535),ue;var Ie=0,Ee=0,we=0,Te=0;return Z<0&&(Ie=1,Z=-Z),Ee=Math.log2(Z)|0,Z/=Math.pow(2,Ee-31),Te=Z>>>0,(Te&2147483648)==0&&(Z/=2,++Ee,Te=Z>>>0),Z-=Te,Te|=2147483648,Te>>>=0,Z*=Math.pow(2,32),we=Z>>>0,ue.write_shift(4,we),ue.write_shift(4,Te),Ee+=16383+(Ie?32768:0),ue.write_shift(2,Ee),ue}function O(M,j){var Y=E(M);return M.l+=j-14,Y}function D(M,j){var Y=Q(M),Z=M.read_shift(4);return Y[1].v=Z>>6,Y}function F(M,j){var Y=Q(M),Z=M.read_shift(8,"f");return Y[1].v=Z,Y}function Fe(M,j){var Y=F(M);return M.l+=j-10,Y}function Ce(M,j){return M[M.l+j-1]==0?M.read_shift(j,"cstr"):""}function ne(M,j){var Y=M[M.l++];Y>j-1&&(Y=j-1);for(var Z="";Z.length<Y;)Z+=String.fromCharCode(M[M.l++]);return Z}function oe(M,j,Y){if(!(!Y.qpro||j<21)){var Z=M.read_shift(1);M.l+=17,M.l+=1,M.l+=2;var ue=M.read_shift(j-21,"cstr");return[Z,ue]}}function be(M,j){for(var Y={},Z=M.l+j;M.l<Z;){var ue=M.read_shift(2);if(ue==14e3){for(Y[ue]=[0,""],Y[ue][0]=M.read_shift(2);M[M.l];)Y[ue][1]+=String.fromCharCode(M[M.l]),M.l++;M.l++}}return Y}function te(M,j){var Y=Or(5+M.length);Y.write_shift(2,14e3),Y.write_shift(2,j);for(var Z=0;Z<M.length;++Z){var ue=M.charCodeAt(Z);Y[Y.l++]=ue>127?95:ue}return Y[Y.l++]=0,Y}var G={0:{n:"BOF",f:Sr},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:u},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:x},14:{n:"NUMBER",f:w},15:{n:"LABEL",f:g},16:{n:"FORMULA",f:C},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:g},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:Ce},222:{n:"SHEETNAMELP",f:ne},65535:{n:""}},se={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:ee},23:{n:"NUMBER17",f:E},24:{n:"NUMBER18",f:T},25:{n:"FORMULA19",f:O},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:be},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:D},38:{n:"??"},39:{n:"NUMBER27",f:F},40:{n:"FORMULA28",f:Fe},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:Ce},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:oe},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:i,to_workbook:e}}();function $P(t){var e={},r=t.match(gn),n=0,i=!1;if(r)for(;n!=r.length;++n){var o=st(r[n]);switch(o[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!o.val)break;case"<shadow>":case"<shadow/>":e.shadow=1;break;case"</shadow>":break;case"<charset":if(o.val=="1")break;e.cp=H1[parseInt(o.val,10)];break;case"<outline":if(!o.val)break;case"<outline>":case"<outline/>":e.outline=1;break;case"</outline>":break;case"<rFont":e.name=o.val;break;case"<sz":e.sz=o.val;break;case"<strike":if(!o.val)break;case"<strike>":case"<strike/>":e.strike=1;break;case"</strike>":break;case"<u":if(!o.val)break;switch(o.val){case"double":e.uval="double";break;case"singleAccounting":e.uval="single-accounting";break;case"doubleAccounting":e.uval="double-accounting";break}case"<u>":case"<u/>":e.u=1;break;case"</u>":break;case"<b":if(o.val=="0")break;case"<b>":case"<b/>":e.b=1;break;case"</b>":break;case"<i":if(o.val=="0")break;case"<i>":case"<i/>":e.i=1;break;case"</i>":break;case"<color":o.rgb&&(e.color=o.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":e.family=o.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":e.valign=o.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(o[0].charCodeAt(1)!==47&&!i)throw new Error("Unrecognized rich format "+o[0])}}return e}var QP=function(){var t=cf("t"),e=cf("rPr");function r(o){var c=o.match(t);if(!c)return{t:"s",v:""};var u={t:"s",v:Nt(c[1])},h=o.match(e);return h&&(u.s=$P(h[1])),u}var n=/<(?:\w+:)?r>/g,i=/<\/(?:\w+:)?r>/;return function(c){return c.replace(n,"").split(i).map(r).filter(function(u){return u.v})}}(),ZP=function(){var e=/(\r\n|\n)/g;function r(i,o,c){var u=[];i.u&&u.push("text-decoration: underline;"),i.uval&&u.push("text-underline-style:"+i.uval+";"),i.sz&&u.push("font-size:"+i.sz+"pt;"),i.outline&&u.push("text-effect: outline;"),i.shadow&&u.push("text-shadow: auto;"),o.push('<span style="'+u.join("")+'">'),i.b&&(o.push("<b>"),c.push("</b>")),i.i&&(o.push("<i>"),c.push("</i>")),i.strike&&(o.push("<s>"),c.push("</s>"));var h=i.valign||"";return h=="superscript"||h=="super"?h="sup":h=="subscript"&&(h="sub"),h!=""&&(o.push("<"+h+">"),c.push("</"+h+">")),c.push("</span>"),i}function n(i){var o=[[],i.v,[]];return i.v?(i.s&&r(i.s,o[0],o[2]),o[0].join("")+o[1].replace(e,"<br/>")+o[2].join("")):""}return function(o){return o.map(n).join("")}}(),JP=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,eM=/<(?:\w+:)?r>/,tM=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function av(t,e){var r=e?e.cellHTML:!0,n={};return t?(t.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=Nt(Jt(t.slice(t.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=Jt(t),r&&(n.h=wS(n.t))):t.match(eM)&&(n.r=Jt(t),n.t=Nt(Jt((t.replace(tM,"").match(JP)||[]).join("").replace(gn,""))),r&&(n.h=ZP(QP(n.r)))),n):{t:""}}var rM=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,nM=/<(?:\w+:)?(?:si|sstItem)>/g,aM=/<\/(?:\w+:)?(?:si|sstItem)>/;function iM(t,e){var r=[],n="";if(!t)return r;var i=t.match(rM);if(i){n=i[2].replace(nM,"").split(aM);for(var o=0;o!=n.length;++o){var c=av(n[o].trim(),e);c!=null&&(r[r.length]=c)}i=st(i[1]),r.Count=i.count,r.Unique=i.uniqueCount}return r}function sM(t){return[t.read_shift(4),t.read_shift(4)]}function oM(t,e){var r=[],n=!1;return zi(t,function(o,c,u){switch(u){case 159:r.Count=o[0],r.Unique=o[1];break;case 19:r.push(o);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(c.T,!n||e.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}),r}function i4(t){for(var e=[],r=t.split(""),n=0;n<r.length;++n)e[n]=r[n].charCodeAt(0);return e}function Mi(t,e){var r={};return r.Major=t.read_shift(2),r.Minor=t.read_shift(2),e>=4&&(t.l+=e-4),r}function lM(t){var e={};return e.id=t.read_shift(0,"lpp4"),e.R=Mi(t,4),e.U=Mi(t,4),e.W=Mi(t,4),e}function cM(t){for(var e=t.read_shift(4),r=t.l+e-4,n={},i=t.read_shift(4),o=[];i-- >0;)o.push({t:t.read_shift(4),v:t.read_shift(0,"lpp4")});if(n.name=t.read_shift(0,"lpp4"),n.comps=o,t.l!=r)throw new Error("Bad DataSpaceMapEntry: "+t.l+" != "+r);return n}function uM(t){var e=[];t.l+=4;for(var r=t.read_shift(4);r-- >0;)e.push(cM(t));return e}function fM(t){var e=[];t.l+=4;for(var r=t.read_shift(4);r-- >0;)e.push(t.read_shift(0,"lpp4"));return e}function hM(t){var e={};return t.read_shift(4),t.l+=4,e.id=t.read_shift(0,"lpp4"),e.name=t.read_shift(0,"lpp4"),e.R=Mi(t,4),e.U=Mi(t,4),e.W=Mi(t,4),e}function dM(t){var e=hM(t);if(e.ename=t.read_shift(0,"8lpp4"),e.blksz=t.read_shift(4),e.cmode=t.read_shift(4),t.read_shift(4)!=4)throw new Error("Bad !Primary record");return e}function s4(t,e){var r=t.l+e,n={};n.Flags=t.read_shift(4)&63,t.l+=4,n.AlgID=t.read_shift(4);var i=!1;switch(n.AlgID){case 26126:case 26127:case 26128:i=n.Flags==36;break;case 26625:i=n.Flags==4;break;case 0:i=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!i)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=t.read_shift(4),n.KeySize=t.read_shift(4),n.ProviderType=t.read_shift(4),t.l+=8,n.CSPName=t.read_shift(r-t.l>>1,"utf16le"),t.l=r,n}function o4(t,e){var r={},n=t.l+e;return t.l+=4,r.Salt=t.slice(t.l,t.l+16),t.l+=16,r.Verifier=t.slice(t.l,t.l+16),t.l+=16,t.read_shift(4),r.VerifierHash=t.slice(t.l,n),t.l=n,r}function pM(t){var e=Mi(t);switch(e.Minor){case 2:return[e.Minor,mM(t)];case 3:return[e.Minor,gM()];case 4:return[e.Minor,vM(t)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+e.Minor)}function mM(t){var e=t.read_shift(4);if((e&63)!=36)throw new Error("EncryptionInfo mismatch");var r=t.read_shift(4),n=s4(t,r),i=o4(t,t.length-t.l);return{t:"Std",h:n,v:i}}function gM(){throw new Error("File is password-protected: ECMA-376 Extensible")}function vM(t){var e=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];t.l+=4;var r=t.read_shift(t.length-t.l,"utf8"),n={};return r.replace(gn,function(o){var c=st(o);switch(si(c[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":e.forEach(function(u){n[u]=c[u]});break;case"<dataIntegrity":n.encryptedHmacKey=c.encryptedHmacKey,n.encryptedHmacValue=c.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=c.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(c);break;default:throw c[0]}}),n}function _M(t,e){var r={},n=r.EncryptionVersionInfo=Mi(t,4);if(e-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);r.Flags=t.read_shift(4),e-=4;var i=t.read_shift(4);return e-=4,r.EncryptionHeader=s4(t,i),e-=i,r.EncryptionVerifier=o4(t,e),r}function xM(t){var e={},r=e.EncryptionVersionInfo=Mi(t,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return e.Salt=t.read_shift(16),e.EncryptedVerifier=t.read_shift(16),e.EncryptedVerifierHash=t.read_shift(16),e}function yM(t){var e=0,r,n=i4(t),i=n.length+1,o,c,u,h,d;for(r=Gs(i),r[0]=n.length,o=1;o!=i;++o)r[o]=n[o-1];for(o=i-1;o>=0;--o)c=r[o],u=(e&16384)===0?0:1,h=e<<1&32767,d=u|h,e=d^c;return e^52811}var l4=function(){var t=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],e=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(c){return(c/2|c*128)&255},i=function(c,u){return n(c^u)},o=function(c){for(var u=e[c.length-1],h=104,d=c.length-1;d>=0;--d)for(var g=c[d],_=0;_!=7;++_)g&64&&(u^=r[h]),g*=2,--h;return u};return function(c){for(var u=i4(c),h=o(u),d=u.length,g=Gs(16),_=0;_!=16;++_)g[_]=0;var x,A,w;for((d&1)===1&&(x=h>>8,g[d]=i(t[0],x),--d,x=h&255,A=u[u.length-1],g[d]=i(A,x));d>0;)--d,x=h>>8,g[d]=i(u[d],x),--d,x=h&255,g[d]=i(u[d],x);for(d=15,w=15-u.length;w>0;)x=h>>8,g[d]=i(t[w],x),--d,--w,x=h&255,g[d]=i(u[d],x),--d,--w;return g}}(),EM=function(t,e,r,n,i){i||(i=e),n||(n=l4(t));var o,c;for(o=0;o!=e.length;++o)c=e[o],c^=n[r],c=(c>>5|c<<3)&255,i[o]=c,++r;return[i,r,n]},TM=function(t){var e=0,r=l4(t);return function(n){var i=EM("",n,e,r);return e=i[1],i[0]}};function AM(t,e,r,n){var i={key:Sr(t),verificationBytes:Sr(t)};return r.password&&(i.verifier=yM(r.password)),n.valid=i.verificationBytes===i.verifier,n.valid&&(n.insitu=TM(r.password)),i}function wM(t,e,r){var n=r||{};return n.Info=t.read_shift(2),t.l-=2,n.Info===1?n.Data=xM(t):n.Data=_M(t,e),n}function SM(t,e,r){var n={Type:r.biff>=8?t.read_shift(2):0};return n.Type?wM(t,e-2,n):AM(t,r.biff>=8?e:e-2,r,n),n}var CM=function(){function t(i,o){switch(o.type){case"base64":return e(Wn(i),o);case"binary":return e(i,o);case"buffer":return e(wt&&Buffer.isBuffer(i)?i.toString("binary"):Qo(i),o);case"array":return e(zo(i),o)}throw new Error("Unrecognized type "+o.type)}function e(i,o){var c=o||{},u=c.dense?[]:{},h=i.match(/\\trowd.*?\\row\b/g);if(!h.length)throw new Error("RTF missing table");var d={s:{c:0,r:0},e:{c:0,r:h.length-1}};return h.forEach(function(g,_){Array.isArray(u)&&(u[_]=[]);for(var x=/\\\w+\b/g,A=0,w,S=-1;w=x.exec(g);){switch(w[0]){case"\\cell":var C=g.slice(A,x.lastIndex-w[0].length);if(C[0]==" "&&(C=C.slice(1)),++S,C.length){var z={v:C,t:"s"};Array.isArray(u)?u[_][S]=z:u[vt({r:_,c:S})]=z}break}A=x.lastIndex}S>d.e.c&&(d.e.c=S)}),u["!ref"]=qt(d),u}function r(i,o){return Zo(t(i,o),o)}function n(i){for(var o=["{\\rtf1\\ansi"],c=qr(i["!ref"]),u,h=Array.isArray(i),d=c.s.r;d<=c.e.r;++d){o.push("\\trowd\\trautofit1");for(var g=c.s.c;g<=c.e.c;++g)o.push("\\cellx"+(g+1));for(o.push("\\pard\\intbl"),g=c.s.c;g<=c.e.c;++g){var _=vt({r:d,c:g});u=h?(i[d]||[])[g]:i[_],!(!u||u.v==null&&(!u.f||u.F))&&(o.push(" "+(u.w||(hc(u),u.w))),o.push("\\cell"))}o.push("\\pard\\intbl\\row")}return o.join("")+"}"}return{to_workbook:r,to_sheet:t,from_sheet:n}}();function RM(t){var e=t.slice(t[0]==="#"?1:0).slice(0,6);return[parseInt(e.slice(0,2),16),parseInt(e.slice(2,4),16),parseInt(e.slice(4,6),16)]}function hf(t){for(var e=0,r=1;e!=3;++e)r=r*256+(t[e]>255?255:t[e]<0?0:t[e]);return r.toString(16).toUpperCase().slice(1)}function kM(t){var e=t[0]/255,r=t[1]/255,n=t[2]/255,i=Math.max(e,r,n),o=Math.min(e,r,n),c=i-o;if(c===0)return[0,0,e];var u=0,h=0,d=i+o;switch(h=c/(d>1?2-d:d),i){case e:u=((r-n)/c+6)%6;break;case r:u=(n-e)/c+2;break;case n:u=(e-r)/c+4;break}return[u/6,h,d/2]}function bM(t){var e=t[0],r=t[1],n=t[2],i=r*2*(n<.5?n:1-n),o=n-i/2,c=[o,o,o],u=6*e,h;if(r!==0)switch(u|0){case 0:case 6:h=i*u,c[0]+=i,c[1]+=h;break;case 1:h=i*(2-u),c[0]+=h,c[1]+=i;break;case 2:h=i*(u-2),c[1]+=i,c[2]+=h;break;case 3:h=i*(4-u),c[1]+=h,c[2]+=i;break;case 4:h=i*(u-4),c[2]+=i,c[0]+=h;break;case 5:h=i*(6-u),c[2]+=h,c[0]+=i;break}for(var d=0;d!=3;++d)c[d]=Math.round(c[d]*255);return c}function $0(t,e){if(e===0)return t;var r=kM(RM(t));return e<0?r[2]=r[2]*(1+e):r[2]=1-(1-r[2])*(1-e),hf(bM(r))}var c4=6,IM=15,DM=1,An=c4;function Q0(t){return Math.floor((t+Math.round(128/An)/256)*An)}function Z0(t){return Math.floor((t-5)/An*100+.5)/100}function Mg(t){return Math.round((t*An+5)/An*256)/256}function Zm(t){return Mg(Z0(Q0(t)))}function iv(t){var e=Math.abs(t-Zm(t)),r=An;if(e>.005)for(An=DM;An<IM;++An)Math.abs(t-Zm(t))<=e&&(e=Math.abs(t-Zm(t)),r=An);An=r}function dc(t){t.width?(t.wpx=Q0(t.width),t.wch=Z0(t.wpx),t.MDW=An):t.wpx?(t.wch=Z0(t.wpx),t.width=Mg(t.wch),t.MDW=An):typeof t.wch=="number"&&(t.width=Mg(t.wch),t.wpx=Q0(t.width),t.MDW=An),t.customWidth&&delete t.customWidth}var OM=96,u4=OM;function f4(t){return t*96/u4}function df(t){return t*u4/96}var NM={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function FM(t,e,r,n){e.Borders=[];var i={},o=!1;(t[0].match(gn)||[]).forEach(function(c){var u=st(c);switch(si(u[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":i={},u.diagonalUp&&(i.diagonalUp=ir(u.diagonalUp)),u.diagonalDown&&(i.diagonalDown=ir(u.diagonalDown)),e.Borders.push(i);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":o=!0;break;case"</ext>":o=!1;break;default:if(n&&n.WTF&&!o)throw new Error("unrecognized "+u[0]+" in borders")}})}function PM(t,e,r,n){e.Fills=[];var i={},o=!1;(t[0].match(gn)||[]).forEach(function(c){var u=st(c);switch(si(u[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":i={},e.Fills.push(i);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":e.Fills.push(i),i={};break;case"<patternFill":case"<patternFill>":u.patternType&&(i.patternType=u.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":i.bgColor||(i.bgColor={}),u.indexed&&(i.bgColor.indexed=parseInt(u.indexed,10)),u.theme&&(i.bgColor.theme=parseInt(u.theme,10)),u.tint&&(i.bgColor.tint=parseFloat(u.tint)),u.rgb&&(i.bgColor.rgb=u.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":i.fgColor||(i.fgColor={}),u.theme&&(i.fgColor.theme=parseInt(u.theme,10)),u.tint&&(i.fgColor.tint=parseFloat(u.tint)),u.rgb!=null&&(i.fgColor.rgb=u.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":o=!0;break;case"</ext>":o=!1;break;default:if(n&&n.WTF&&!o)throw new Error("unrecognized "+u[0]+" in fills")}})}function MM(t,e,r,n){e.Fonts=[];var i={},o=!1;(t[0].match(gn)||[]).forEach(function(c){var u=st(c);switch(si(u[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":e.Fonts.push(i),i={};break;case"<name":u.val&&(i.name=Jt(u.val));break;case"<name/>":case"</name>":break;case"<b":i.bold=u.val?ir(u.val):1;break;case"<b/>":i.bold=1;break;case"<i":i.italic=u.val?ir(u.val):1;break;case"<i/>":i.italic=1;break;case"<u":switch(u.val){case"none":i.underline=0;break;case"single":i.underline=1;break;case"double":i.underline=2;break;case"singleAccounting":i.underline=33;break;case"doubleAccounting":i.underline=34;break}break;case"<u/>":i.underline=1;break;case"<strike":i.strike=u.val?ir(u.val):1;break;case"<strike/>":i.strike=1;break;case"<outline":i.outline=u.val?ir(u.val):1;break;case"<outline/>":i.outline=1;break;case"<shadow":i.shadow=u.val?ir(u.val):1;break;case"<shadow/>":i.shadow=1;break;case"<condense":i.condense=u.val?ir(u.val):1;break;case"<condense/>":i.condense=1;break;case"<extend":i.extend=u.val?ir(u.val):1;break;case"<extend/>":i.extend=1;break;case"<sz":u.val&&(i.sz=+u.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":u.val&&(i.vertAlign=u.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":u.val&&(i.family=parseInt(u.val,10));break;case"<family/>":case"</family>":break;case"<scheme":u.val&&(i.scheme=u.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(u.val=="1")break;u.codepage=H1[parseInt(u.val,10)];break;case"<color":if(i.color||(i.color={}),u.auto&&(i.color.auto=ir(u.auto)),u.rgb)i.color.rgb=u.rgb.slice(-6);else if(u.indexed){i.color.index=parseInt(u.indexed,10);var h=Po[i.color.index];i.color.index==81&&(h=Po[1]),h||(h=Po[1]),i.color.rgb=h[0].toString(16)+h[1].toString(16)+h[2].toString(16)}else u.theme&&(i.color.theme=parseInt(u.theme,10),u.tint&&(i.color.tint=parseFloat(u.tint)),u.theme&&r.themeElements&&r.themeElements.clrScheme&&(i.color.rgb=$0(r.themeElements.clrScheme[i.color.theme].rgb,i.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":o=!0;break;case"</AlternateContent>":o=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":o=!0;break;case"</ext>":o=!1;break;default:if(n&&n.WTF&&!o)throw new Error("unrecognized "+u[0]+" in fonts")}})}function LM(t,e,r){e.NumberFmt=[];for(var n=qs(ht),i=0;i<n.length;++i)e.NumberFmt[n[i]]=ht[n[i]];var o=t[0].match(gn);if(o)for(i=0;i<o.length;++i){var c=st(o[i]);switch(si(c[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var u=Nt(Jt(c.formatCode)),h=parseInt(c.numFmtId,10);if(e.NumberFmt[h]=u,h>0){if(h>392){for(h=392;h>60&&e.NumberFmt[h]!=null;--h);e.NumberFmt[h]=u}Fo(u,h)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+c[0]+" in numFmts")}}}var o0=["numFmtId","fillId","fontId","borderId","xfId"],l0=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function VM(t,e,r){e.CellXf=[];var n,i=!1;(t[0].match(gn)||[]).forEach(function(o){var c=st(o),u=0;switch(si(c[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=c,delete n[0],u=0;u<o0.length;++u)n[o0[u]]&&(n[o0[u]]=parseInt(n[o0[u]],10));for(u=0;u<l0.length;++u)n[l0[u]]&&(n[l0[u]]=ir(n[l0[u]]));if(e.NumberFmt&&n.numFmtId>392){for(u=392;u>60;--u)if(e.NumberFmt[n.numFmtId]==e.NumberFmt[u]){n.numFmtId=u;break}}e.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var h={};c.vertical&&(h.vertical=c.vertical),c.horizontal&&(h.horizontal=c.horizontal),c.textRotation!=null&&(h.textRotation=c.textRotation),c.indent&&(h.indent=c.indent),c.wrapText&&(h.wrapText=ir(c.wrapText)),n.alignment=h;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":i=!0;break;case"</AlternateContent>":i=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(r&&r.WTF&&!i)throw new Error("unrecognized "+c[0]+" in cellXfs")}})}var UM=function(){var e=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,i=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,o=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(u,h,d){var g={};if(!u)return g;u=u.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var _;return(_=u.match(e))&&LM(_,g,d),(_=u.match(i))&&MM(_,g,h,d),(_=u.match(n))&&PM(_,g,h,d),(_=u.match(o))&&FM(_,g,h,d),(_=u.match(r))&&VM(_,g,d),g}}();function BM(t,e){var r=t.read_shift(2),n=dn(t);return[r,n]}function jM(t,e,r){var n={};n.sz=t.read_shift(2)/20;var i=QF(t);i.fItalic&&(n.italic=1),i.fCondense&&(n.condense=1),i.fExtend&&(n.extend=1),i.fShadow&&(n.shadow=1),i.fOutline&&(n.outline=1),i.fStrikeout&&(n.strike=1);var o=t.read_shift(2);switch(o===700&&(n.bold=1),t.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var c=t.read_shift(1);c!=0&&(n.underline=c);var u=t.read_shift(1);u>0&&(n.family=u);var h=t.read_shift(1);switch(h>0&&(n.charset=h),t.l++,n.color=$F(t),t.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=dn(t),n}var zM=mn;function HM(t,e){var r=t.l+e,n=t.read_shift(2),i=t.read_shift(2);return t.l=r,{ixfe:n,numFmtId:i}}var GM=mn;function qM(t,e,r){var n={};n.NumberFmt=[];for(var i in ht)n.NumberFmt[i]=ht[i];n.CellXf=[],n.Fonts=[];var o=[],c=!1;return zi(t,function(h,d,g){switch(g){case 44:n.NumberFmt[h[0]]=h[1],Fo(h[1],h[0]);break;case 43:n.Fonts.push(h),h.color.theme!=null&&e&&e.themeElements&&e.themeElements.clrScheme&&(h.color.rgb=$0(e.themeElements.clrScheme[h.color.theme].rgb,h.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:o[o.length-1]==617&&n.CellXf.push(h);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:c=!0;break;case 36:c=!1;break;case 37:o.push(g),c=!0;break;case 38:o.pop(),c=!1;break;default:if(d.T>0)o.push(g);else if(d.T<0)o.pop();else if(!c||r.WTF&&o[o.length-1]!=37)throw new Error("Unexpected record 0x"+g.toString(16))}}),n}var KM=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function XM(t,e,r){e.themeElements.clrScheme=[];var n={};(t[0].match(gn)||[]).forEach(function(i){var o=st(i);switch(o[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=o.val;break;case"<a:sysClr":n.rgb=o.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":o[0].charAt(1)==="/"?(e.themeElements.clrScheme[KM.indexOf(o[0])]=n,n={}):n.name=o[0].slice(3,o[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+o[0]+" in clrScheme")}})}function WM(){}function YM(){}var $M=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,QM=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,ZM=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function JM(t,e,r){e.themeElements={};var n;[["clrScheme",$M,XM],["fontScheme",QM,WM],["fmtScheme",ZM,YM]].forEach(function(i){if(!(n=t.match(i[1])))throw new Error(i[0]+" not found in themeElements");i[2](n,e,r)})}var e5=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function h4(t,e){(!t||t.length===0)&&(t=t5());var r,n={};if(!(r=t.match(e5)))throw new Error("themeElements not found in theme");return JM(r[0],n,e),n.raw=t,n}function t5(t,e){var r=[TS];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function r5(t,e,r){var n=t.l+e,i=t.read_shift(4);if(i!==124226){if(!r.cellStyles){t.l=n;return}var o=t.slice(t.l);t.l=n;var c;try{c=ES(o,{type:"array"})}catch{return}var u=qn(c,"theme/theme/theme1.xml",!0);if(u)return h4(u,r)}}function n5(t){return t.read_shift(4)}function a5(t){var e={};switch(e.xclrType=t.read_shift(2),e.nTintShade=t.read_shift(2),e.xclrType){case 0:t.l+=4;break;case 1:e.xclrValue=i5(t,4);break;case 2:e.xclrValue=ZS(t);break;case 3:e.xclrValue=n5(t);break;case 4:t.l+=4;break}return t.l+=8,e}function i5(t,e){return mn(t,e)}function s5(t,e){return mn(t,e)}function o5(t){var e=t.read_shift(2),r=t.read_shift(2)-4,n=[e];switch(e){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=a5(t);break;case 6:n[1]=s5(t,r);break;case 14:case 15:n[1]=t.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+e+" "+r)}return n}function l5(t,e){var r=t.l+e;t.l+=2;var n=t.read_shift(2);t.l+=2;for(var i=t.read_shift(2),o=[];i-- >0;)o.push(o5(t,r-t.l));return{ixfe:n,ext:o}}function c5(t,e){e.forEach(function(r){r[0]})}function u5(t,e){return{flags:t.read_shift(4),version:t.read_shift(4),name:dn(t)}}function f5(t){for(var e=[],r=t.read_shift(4);r-- >0;)e.push([t.read_shift(4),t.read_shift(4)]);return e}function h5(t){return t.l+=4,t.read_shift(4)!=0}function d5(t,e,r){var n={Types:[],Cell:[],Value:[]},i=r||{},o=[],c=!1,u=2;return zi(t,function(h,d,g){switch(g){case 335:n.Types.push({name:h.name});break;case 51:h.forEach(function(_){u==1?n.Cell.push({type:n.Types[_[0]-1].name,index:_[1]}):u==0&&n.Value.push({type:n.Types[_[0]-1].name,index:_[1]})});break;case 337:u=h?1:0;break;case 338:u=2;break;case 35:o.push(g),c=!0;break;case 36:o.pop(),c=!1;break;default:if(!d.T){if(!c||i.WTF&&o[o.length-1]!=35)throw new Error("Unexpected record 0x"+g.toString(16))}}}),n}function p5(t,e,r){var n={Types:[],Cell:[],Value:[]};if(!t)return n;var i=!1,o=2,c;return t.replace(gn,function(u){var h=st(u);switch(si(h[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:h.name});break;case"</metadataType>":break;case"<futureMetadata":for(var d=0;d<n.Types.length;++d)n.Types[d].name==h.name&&(c=n.Types[d]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":o==1?n.Cell.push({type:n.Types[h.t-1].name,index:+h.v}):o==0&&n.Value.push({type:n.Types[h.t-1].name,index:+h.v});break;case"</rc>":break;case"<cellMetadata":o=1;break;case"</cellMetadata>":o=2;break;case"<valueMetadata":o=0;break;case"</valueMetadata>":o=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;case"<rvb":if(!c)break;c.offsets||(c.offsets=[]),c.offsets.push(+h.i);break;default:if(!i&&r.WTF)throw new Error("unrecognized "+h[0]+" in metadata")}return u}),n}function m5(t){var e=[];if(!t)return e;var r=1;return(t.match(gn)||[]).forEach(function(n){var i=st(n);switch(i[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete i[0],i.i?r=i.i:i.i=r,e.push(i);break}}),e}function g5(t){var e={};e.i=t.read_shift(4);var r={};r.r=t.read_shift(4),r.c=t.read_shift(4),e.r=vt(r);var n=t.read_shift(1);return n&2&&(e.l="1"),n&8&&(e.a="1"),e}function v5(t,e,r){var n=[];return zi(t,function(o,c,u){switch(u){case 63:n.push(o);break;default:if(!c.T)throw new Error("Unexpected record 0x"+u.toString(16))}}),n}function _5(t,e,r,n){if(!t)return t;var i=n||{},o=!1;zi(t,function(u,h,d){switch(d){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:o=!0;break;case 36:o=!1;break;default:if(!h.T){if(!o||i.WTF)throw new Error("Unexpected record 0x"+d.toString(16))}}},i)}function x5(t,e){if(!t)return"??";var r=(t.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return e["!id"][r].Target}function e2(t,e,r,n){var i=Array.isArray(t),o;e.forEach(function(c){var u=Ia(c.ref);if(i?(t[u.r]||(t[u.r]=[]),o=t[u.r][u.c]):o=t[c.ref],!o){o={t:"z"},i?t[u.r][u.c]=o:t[c.ref]=o;var h=qr(t["!ref"]||"BDWGO1000001:A1");h.s.r>u.r&&(h.s.r=u.r),h.e.r<u.r&&(h.e.r=u.r),h.s.c>u.c&&(h.s.c=u.c),h.e.c<u.c&&(h.e.c=u.c);var d=qt(h);d!==t["!ref"]&&(t["!ref"]=d)}o.c||(o.c=[]);var g={a:c.author,t:c.t,r:c.r,T:r};c.h&&(g.h=c.h);for(var _=o.c.length-1;_>=0;--_){if(!r&&o.c[_].T)return;r&&!o.c[_].T&&o.c.splice(_,1)}if(r&&n){for(_=0;_<n.length;++_)if(g.a==n[_].id){g.a=n[_].name||g.a;break}}o.c.push(g)})}function y5(t,e){if(t.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],n=[],i=t.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);i&&i[1]&&i[1].split(/<\/\w*:?author>/).forEach(function(c){if(!(c===""||c.trim()==="")){var u=c.match(/<(?:\w+:)?author[^>]*>(.*)/);u&&r.push(u[1])}});var o=t.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return o&&o[1]&&o[1].split(/<\/\w*:?comment>/).forEach(function(c){if(!(c===""||c.trim()==="")){var u=c.match(/<(?:\w+:)?comment[^>]*>/);if(u){var h=st(u[0]),d={author:h.authorId&&r[h.authorId]||"sheetjsghost",ref:h.ref,guid:h.guid},g=Ia(h.ref);if(!(e.sheetRows&&e.sheetRows<=g.r)){var _=c.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),x=!!_&&!!_[1]&&av(_[1])||{r:"",t:"",h:""};d.r=x.r,x.r=="<t></t>"&&(x.t=x.h=""),d.t=(x.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.cellHTML&&(d.h=x.h),n.push(d)}}}}),n}function E5(t,e){var r=[],n=!1,i={},o=0;return t.replace(gn,function(u,h){var d=st(u);switch(si(d[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":i={author:d.personId,guid:d.id,ref:d.ref,T:1};break;case"</threadedComment>":i.t!=null&&r.push(i);break;case"<text>":case"<text":o=h+u.length;break;case"</text>":i.t=t.slice(o,h).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&e.WTF)throw new Error("unrecognized "+d[0]+" in threaded comments")}return u}),r}function T5(t,e){var r=[],n=!1;return t.replace(gn,function(o){var c=st(o);switch(si(c[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:c.displayname,id:c.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&e.WTF)throw new Error("unrecognized "+c[0]+" in threaded comments")}return o}),r}function A5(t){var e={};e.iauthor=t.read_shift(4);var r=el(t);return e.rfx=r.s,e.ref=vt(r.s),t.l+=16,e}var w5=dn;function S5(t,e){var r=[],n=[],i={},o=!1;return zi(t,function(u,h,d){switch(d){case 632:n.push(u);break;case 635:i=u;break;case 637:i.t=u.t,i.h=u.h,i.r=u.r;break;case 636:if(i.author=n[i.iauthor],delete i.iauthor,e.sheetRows&&i.rfx&&e.sheetRows<=i.rfx.r)break;i.t||(i.t=""),delete i.rfx,r.push(i);break;case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:break;case 38:break;default:if(!h.T){if(!o||e.WTF)throw new Error("Unexpected record 0x"+d.toString(16))}}}),r}var C5="application/vnd.ms-office.vbaProject";function R5(t){var e=Dt.utils.cfb_new({root:"R"});return t.FullPaths.forEach(function(r,n){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var i=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");Dt.utils.cfb_add(e,i,t.FileIndex[n].content)}}),Dt.write(e)}function k5(){return{"!type":"dialog"}}function b5(){return{"!type":"dialog"}}function I5(){return{"!type":"macro"}}function D5(){return{"!type":"macro"}}var nc=function(){var t=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,e={r:0,c:0};function r(n,i,o,c){var u=!1,h=!1;o.length==0?h=!0:o.charAt(0)=="["&&(h=!0,o=o.slice(1,-1)),c.length==0?u=!0:c.charAt(0)=="["&&(u=!0,c=c.slice(1,-1));var d=o.length>0?parseInt(o,10)|0:0,g=c.length>0?parseInt(c,10)|0:0;return u?g+=e.c:--g,h?d+=e.r:--d,i+(u?"":"$")+wn(g)+(h?"":"$")+Xn(d)}return function(i,o){return e=o,i.replace(t,r)}}(),d4=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,O5=function(){return function(e,r){return e.replace(d4,function(n,i,o,c,u,h){var d=BS(c)-(o?0:r.c),g=US(h)-(u?0:r.r),_=g==0?"":u?g+1:"["+g+"]",x=d==0?"":o?d+1:"["+d+"]";return i+"R"+_+"C"+x})}}();function p4(t,e){return t.replace(d4,function(r,n,i,o,c,u){return n+(i=="$"?i+o:wn(BS(o)+e.c))+(c=="$"?c+u:Xn(US(u)+e.r))})}function N5(t,e,r){var n=Z1(e),i=n.s,o=Ia(r),c={r:o.r-i.r,c:o.c-i.c};return p4(t,c)}function F5(t){return t.length!=1}function t2(t){return t.replace(/_xlfn\./g,"")}function Tr(t){t.l+=1}function Ks(t,e){var r=t.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function m4(t,e,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return g4(t);r.biff==12&&(n=4)}var i=t.read_shift(n),o=t.read_shift(n),c=Ks(t),u=Ks(t);return{s:{r:i,c:c[0],cRel:c[1],rRel:c[2]},e:{r:o,c:u[0],cRel:u[1],rRel:u[2]}}}function g4(t){var e=Ks(t),r=Ks(t),n=t.read_shift(1),i=t.read_shift(1);return{s:{r:e[0],c:n,cRel:e[1],rRel:e[2]},e:{r:r[0],c:i,cRel:r[1],rRel:r[2]}}}function P5(t,e,r){if(r.biff<8)return g4(t);var n=t.read_shift(r.biff==12?4:2),i=t.read_shift(r.biff==12?4:2),o=Ks(t),c=Ks(t);return{s:{r:n,c:o[0],cRel:o[1],rRel:o[2]},e:{r:i,c:c[0],cRel:c[1],rRel:c[2]}}}function v4(t,e,r){if(r&&r.biff>=2&&r.biff<=5)return M5(t);var n=t.read_shift(r&&r.biff==12?4:2),i=Ks(t);return{r:n,c:i[0],cRel:i[1],rRel:i[2]}}function M5(t){var e=Ks(t),r=t.read_shift(1);return{r:e[0],c:r,cRel:e[1],rRel:e[2]}}function L5(t){var e=t.read_shift(2),r=t.read_shift(2);return{r:e,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function V5(t,e,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return U5(t);var i=t.read_shift(n>=12?4:2),o=t.read_shift(2),c=(o&16384)>>14,u=(o&32768)>>15;if(o&=16383,u==1)for(;i>524287;)i-=1048576;if(c==1)for(;o>8191;)o=o-16384;return{r:i,c:o,cRel:c,rRel:u}}function U5(t){var e=t.read_shift(2),r=t.read_shift(1),n=(e&32768)>>15,i=(e&16384)>>14;return e&=16383,n==1&&e>=8192&&(e=e-16384),i==1&&r>=128&&(r=r-256),{r:e,c:r,cRel:i,rRel:n}}function B5(t,e,r){var n=(t[t.l++]&96)>>5,i=m4(t,r.biff>=2&&r.biff<=5?6:8,r);return[n,i]}function j5(t,e,r){var n=(t[t.l++]&96)>>5,i=t.read_shift(2,"i"),o=8;if(r)switch(r.biff){case 5:t.l+=12,o=6;break;case 12:o=12;break}var c=m4(t,o,r);return[n,i,c]}function z5(t,e,r){var n=(t[t.l++]&96)>>5;return t.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function H5(t,e,r){var n=(t[t.l++]&96)>>5,i=t.read_shift(2),o=8;if(r)switch(r.biff){case 5:t.l+=12,o=6;break;case 12:o=12;break}return t.l+=o,[n,i]}function G5(t,e,r){var n=(t[t.l++]&96)>>5,i=P5(t,e-1,r);return[n,i]}function q5(t,e,r){var n=(t[t.l++]&96)>>5;return t.l+=r.biff==2?6:r.biff==12?14:7,[n]}function r2(t){var e=t[t.l+1]&1,r=1;return t.l+=4,[e,r]}function K5(t,e,r){t.l+=2;for(var n=t.read_shift(r&&r.biff==2?1:2),i=[],o=0;o<=n;++o)i.push(t.read_shift(r&&r.biff==2?1:2));return i}function X5(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=2,[n,t.read_shift(r&&r.biff==2?1:2)]}function W5(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=2,[n,t.read_shift(r&&r.biff==2?1:2)]}function Y5(t){var e=t[t.l+1]&255?1:0;return t.l+=2,[e,t.read_shift(2)]}function $5(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=r&&r.biff==2?3:4,[n]}function _4(t){var e=t.read_shift(1),r=t.read_shift(1);return[e,r]}function Q5(t){return t.read_shift(2),_4(t)}function Z5(t){return t.read_shift(2),_4(t)}function J5(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var i=v4(t,0,r);return[n,i]}function e9(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var i=V5(t,0,r);return[n,i]}function t9(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var i=t.read_shift(2);r&&r.biff==5&&(t.l+=12);var o=v4(t,0,r);return[n,i,o]}function r9(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var i=t.read_shift(r&&r.biff<=3?1:2);return[nL[i],E4[i],n]}function n9(t,e,r){var n=t[t.l++],i=t.read_shift(1),o=r&&r.biff<=3?[n==88?-1:0,t.read_shift(1)]:a9(t);return[i,(o[0]===0?E4:rL)[o[1]]]}function a9(t){return[t[t.l+1]>>7,t.read_shift(2)&32767]}function i9(t,e,r){t.l+=r&&r.biff==2?3:4}function s9(t,e,r){if(t.l++,r&&r.biff==12)return[t.read_shift(4,"i"),0];var n=t.read_shift(2),i=t.read_shift(r&&r.biff==2?1:2);return[n,i]}function o9(t){return t.l++,tl[t.read_shift(1)]}function l9(t){return t.l++,t.read_shift(2)}function c9(t){return t.l++,t.read_shift(1)!==0}function u9(t){return t.l++,fn(t)}function f9(t,e,r){return t.l++,kf(t,e-1,r)}function h9(t,e){var r=[t.read_shift(1)];if(e==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=mr(t,1)?"TRUE":"FALSE",e!=12&&(t.l+=7);break;case 37:case 16:r[1]=tl[t[t.l]],t.l+=e==12?4:8;break;case 0:t.l+=8;break;case 1:r[1]=fn(t);break;case 2:r[1]=rl(t,0,{biff:e>0&&e<8?2:e});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function d9(t,e,r){for(var n=t.read_shift(r.biff==12?4:2),i=[],o=0;o!=n;++o)i.push((r.biff==12?el:Id)(t));return i}function p9(t,e,r){var n=0,i=0;r.biff==12?(n=t.read_shift(4),i=t.read_shift(4)):(i=1+t.read_shift(1),n=1+t.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--i==0&&(i=256));for(var o=0,c=[];o!=n&&(c[o]=[]);++o)for(var u=0;u!=i;++u)c[o][u]=h9(t,r.biff);return c}function m9(t,e,r){var n=t.read_shift(1)>>>5&3,i=!r||r.biff>=8?4:2,o=t.read_shift(i);switch(r.biff){case 2:t.l+=5;break;case 3:case 4:t.l+=8;break;case 5:t.l+=12;break}return[n,0,o]}function g9(t,e,r){if(r.biff==5)return v9(t);var n=t.read_shift(1)>>>5&3,i=t.read_shift(2),o=t.read_shift(4);return[n,i,o]}function v9(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2,"i");t.l+=8;var n=t.read_shift(2);return t.l+=12,[e,r,n]}function _9(t,e,r){var n=t.read_shift(1)>>>5&3;t.l+=r&&r.biff==2?3:4;var i=t.read_shift(r&&r.biff==2?1:2);return[n,i]}function x9(t,e,r){var n=t.read_shift(1)>>>5&3,i=t.read_shift(r&&r.biff==2?1:2);return[n,i]}function y9(t,e,r){var n=t.read_shift(1)>>>5&3;return t.l+=4,r.biff<8&&t.l--,r.biff==12&&(t.l+=2),[n]}function E9(t,e,r){var n=(t[t.l++]&96)>>5,i=t.read_shift(2),o=4;if(r)switch(r.biff){case 5:o=15;break;case 12:o=6;break}return t.l+=o,[n,i]}var T9=mn,A9=mn,w9=mn;function If(t,e,r){return t.l+=2,[L5(t)]}function sv(t){return t.l+=6,[]}var S9=If,C9=sv,R9=sv,k9=If;function x4(t){return t.l+=2,[Sr(t),t.read_shift(2)&1]}var b9=If,I9=x4,D9=sv,O9=If,N9=If,F9=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function P9(t){t.l+=2;var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(4),i=t.read_shift(2),o=t.read_shift(2),c=F9[r>>2&31];return{ixti:e,coltype:r&3,rt:c,idx:n,c:i,C:o}}function M9(t){return t.l+=2,[t.read_shift(4)]}function L9(t,e,r){return t.l+=5,t.l+=2,t.l+=r.biff==2?1:4,["PTGSHEET"]}function V9(t,e,r){return t.l+=r.biff==2?4:5,["PTGENDSHEET"]}function U9(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2);return[e,r]}function B9(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2);return[e,r]}function j9(t){return t.l+=4,[0,0]}var n2={1:{n:"PtgExp",f:s9},2:{n:"PtgTbl",f:w9},3:{n:"PtgAdd",f:Tr},4:{n:"PtgSub",f:Tr},5:{n:"PtgMul",f:Tr},6:{n:"PtgDiv",f:Tr},7:{n:"PtgPower",f:Tr},8:{n:"PtgConcat",f:Tr},9:{n:"PtgLt",f:Tr},10:{n:"PtgLe",f:Tr},11:{n:"PtgEq",f:Tr},12:{n:"PtgGe",f:Tr},13:{n:"PtgGt",f:Tr},14:{n:"PtgNe",f:Tr},15:{n:"PtgIsect",f:Tr},16:{n:"PtgUnion",f:Tr},17:{n:"PtgRange",f:Tr},18:{n:"PtgUplus",f:Tr},19:{n:"PtgUminus",f:Tr},20:{n:"PtgPercent",f:Tr},21:{n:"PtgParen",f:Tr},22:{n:"PtgMissArg",f:Tr},23:{n:"PtgStr",f:f9},26:{n:"PtgSheet",f:L9},27:{n:"PtgEndSheet",f:V9},28:{n:"PtgErr",f:o9},29:{n:"PtgBool",f:c9},30:{n:"PtgInt",f:l9},31:{n:"PtgNum",f:u9},32:{n:"PtgArray",f:q5},33:{n:"PtgFunc",f:r9},34:{n:"PtgFuncVar",f:n9},35:{n:"PtgName",f:m9},36:{n:"PtgRef",f:J5},37:{n:"PtgArea",f:B5},38:{n:"PtgMemArea",f:_9},39:{n:"PtgMemErr",f:T9},40:{n:"PtgMemNoMem",f:A9},41:{n:"PtgMemFunc",f:x9},42:{n:"PtgRefErr",f:y9},43:{n:"PtgAreaErr",f:z5},44:{n:"PtgRefN",f:e9},45:{n:"PtgAreaN",f:G5},46:{n:"PtgMemAreaN",f:U9},47:{n:"PtgMemNoMemN",f:B9},57:{n:"PtgNameX",f:g9},58:{n:"PtgRef3d",f:t9},59:{n:"PtgArea3d",f:j5},60:{n:"PtgRefErr3d",f:E9},61:{n:"PtgAreaErr3d",f:H5},255:{}},z9={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},H9={1:{n:"PtgElfLel",f:x4},2:{n:"PtgElfRw",f:O9},3:{n:"PtgElfCol",f:S9},6:{n:"PtgElfRwV",f:N9},7:{n:"PtgElfColV",f:k9},10:{n:"PtgElfRadical",f:b9},11:{n:"PtgElfRadicalS",f:D9},13:{n:"PtgElfColS",f:C9},15:{n:"PtgElfColSV",f:R9},16:{n:"PtgElfRadicalLel",f:I9},25:{n:"PtgList",f:P9},29:{n:"PtgSxName",f:M9},255:{}},G9={0:{n:"PtgAttrNoop",f:j9},1:{n:"PtgAttrSemi",f:$5},2:{n:"PtgAttrIf",f:W5},4:{n:"PtgAttrChoose",f:K5},8:{n:"PtgAttrGoto",f:X5},16:{n:"PtgAttrSum",f:i9},32:{n:"PtgAttrBaxcel",f:r2},33:{n:"PtgAttrBaxcel",f:r2},64:{n:"PtgAttrSpace",f:Q5},65:{n:"PtgAttrSpaceSemi",f:Z5},128:{n:"PtgAttrIfError",f:Y5},255:{}};function Df(t,e,r,n){if(n.biff<8)return mn(t,e);for(var i=t.l+e,o=[],c=0;c!==r.length;++c)switch(r[c][0]){case"PtgArray":r[c][1]=p9(t,0,n),o.push(r[c][1]);break;case"PtgMemArea":r[c][2]=d9(t,r[c][1],n),o.push(r[c][2]);break;case"PtgExp":n&&n.biff==12&&(r[c][1][1]=t.read_shift(4),o.push(r[c][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[c][0]}return e=i-t.l,e!==0&&o.push(mn(t,e)),o}function Of(t,e,r){for(var n=t.l+e,i,o,c=[];n!=t.l;)e=n-t.l,o=t[t.l],i=n2[o]||n2[z9[o]],(o===24||o===25)&&(i=(o===24?H9:G9)[t[t.l+1]]),!i||!i.f?mn(t,e):c.push([i.n,i.f(t,e,r)]);return c}function q9(t){for(var e=[],r=0;r<t.length;++r){for(var n=t[r],i=[],o=0;o<n.length;++o){var c=n[o];if(c)switch(c[0]){case 2:i.push('"'+c[1].replace(/"/g,'""')+'"');break;default:i.push(c[1])}else i.push("")}e.push(i.join(","))}return e.join(";")}var K9={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function X9(t,e){if(!t&&!(e&&e.biff<=5&&e.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(t)?"'"+t+"'":t}function y4(t,e,r){if(!t)return"SH33TJSERR0";if(r.biff>8&&(!t.XTI||!t.XTI[e]))return t.SheetNames[e];if(!t.XTI)return"SH33TJSERR6";var n=t.XTI[e];if(r.biff<8)return e>1e4&&(e-=65536),e<0&&(e=-e),e==0?"":t.XTI[e-1];if(!n)return"SH33TJSERR1";var i="";if(r.biff>8)switch(t[n[0]][0]){case 357:return i=n[1]==-1?"#REF":t.SheetNames[n[1]],n[1]==n[2]?i:i+":"+t.SheetNames[n[2]];case 358:return r.SID!=null?t.SheetNames[r.SID]:"SH33TJSSAME"+t[n[0]][0];case 355:default:return"SH33TJSSRC"+t[n[0]][0]}switch(t[n[0]][0][0]){case 1025:return i=n[1]==-1?"#REF":t.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?i:i+":"+t.SheetNames[n[2]];case 14849:return t[n[0]].slice(1).map(function(o){return o.Name}).join(";;");default:return t[n[0]][0][3]?(i=n[1]==-1?"#REF":t[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?i:i+":"+t[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function a2(t,e,r){var n=y4(t,e,r);return n=="#REF"?n:X9(n,r)}function cn(t,e,r,n,i){var o=i&&i.biff||8,c={s:{c:0,r:0}},u=[],h,d,g,_=0,x=0,A,w="";if(!t[0]||!t[0][0])return"";for(var S=-1,C="",z=0,W=t[0].length;z<W;++z){var P=t[0][z];switch(P[0]){case"PtgUminus":u.push("-"+u.pop());break;case"PtgUplus":u.push("+"+u.pop());break;case"PtgPercent":u.push(u.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(h=u.pop(),d=u.pop(),S>=0){switch(t[0][S][1][0]){case 0:C=ur(" ",t[0][S][1][1]);break;case 1:C=ur("\r",t[0][S][1][1]);break;default:if(C="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][S][1][0])}d=d+C,S=-1}u.push(d+K9[P[0]]+h);break;case"PtgIsect":h=u.pop(),d=u.pop(),u.push(d+" "+h);break;case"PtgUnion":h=u.pop(),d=u.pop(),u.push(d+","+h);break;case"PtgRange":h=u.pop(),d=u.pop(),u.push(d+":"+h);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":g=Bu(P[1][1],c,i),u.push(ju(g,o));break;case"PtgRefN":g=r?Bu(P[1][1],r,i):P[1][1],u.push(ju(g,o));break;case"PtgRef3d":_=P[1][1],g=Bu(P[1][2],c,i),w=a2(n,_,i),u.push(w+"!"+ju(g,o));break;case"PtgFunc":case"PtgFuncVar":var re=P[1][0],Q=P[1][1];re||(re=0),re&=127;var ee=re==0?[]:u.slice(-re);u.length-=re,Q==="User"&&(Q=ee.shift()),u.push(Q+"("+ee.join(",")+")");break;case"PtgBool":u.push(P[1]?"TRUE":"FALSE");break;case"PtgInt":u.push(P[1]);break;case"PtgNum":u.push(String(P[1]));break;case"PtgStr":u.push('"'+P[1].replace(/"/g,'""')+'"');break;case"PtgErr":u.push(P[1]);break;case"PtgAreaN":A=VT(P[1][1],r?{s:r}:c,i),u.push($m(A,i));break;case"PtgArea":A=VT(P[1][1],c,i),u.push($m(A,i));break;case"PtgArea3d":_=P[1][1],A=P[1][2],w=a2(n,_,i),u.push(w+"!"+$m(A,i));break;case"PtgAttrSum":u.push("SUM("+u.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":x=P[1][2];var k=(n.names||[])[x-1]||(n[0]||[])[x],T=k?k.Name:"SH33TJSNAME"+String(x);T&&T.slice(0,6)=="_xlfn."&&!i.xlfn&&(T=T.slice(6)),u.push(T);break;case"PtgNameX":var E=P[1][1];x=P[1][2];var I;if(i.biff<=5)E<0&&(E=-E),n[E]&&(I=n[E][x]);else{var O="";if(((n[E]||[])[0]||[])[0]==14849||(((n[E]||[])[0]||[])[0]==1025?n[E][x]&&n[E][x].itab>0&&(O=n.SheetNames[n[E][x].itab-1]+"!"):O=n.SheetNames[x-1]+"!"),n[E]&&n[E][x])O+=n[E][x].Name;else if(n[0]&&n[0][x])O+=n[0][x].Name;else{var D=(y4(n,E,i)||"").split(";;");D[x-1]?O=D[x-1]:O+="SH33TJSERRX"}u.push(O);break}I||(I={Name:"SH33TJSERRY"}),u.push(I.Name);break;case"PtgParen":var F="(",Fe=")";if(S>=0){switch(C="",t[0][S][1][0]){case 2:F=ur(" ",t[0][S][1][1])+F;break;case 3:F=ur("\r",t[0][S][1][1])+F;break;case 4:Fe=ur(" ",t[0][S][1][1])+Fe;break;case 5:Fe=ur("\r",t[0][S][1][1])+Fe;break;default:if(i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][S][1][0])}S=-1}u.push(F+u.pop()+Fe);break;case"PtgRefErr":u.push("#REF!");break;case"PtgRefErr3d":u.push("#REF!");break;case"PtgExp":g={c:P[1][1],r:P[1][0]};var Ce={c:r.c,r:r.r};if(n.sharedf[vt(g)]){var ne=n.sharedf[vt(g)];u.push(cn(ne,c,Ce,n,i))}else{var oe=!1;for(h=0;h!=n.arrayf.length;++h)if(d=n.arrayf[h],!(g.c<d[0].s.c||g.c>d[0].e.c)&&!(g.r<d[0].s.r||g.r>d[0].e.r)){u.push(cn(d[1],c,Ce,n,i)),oe=!0;break}oe||u.push(P[1])}break;case"PtgArray":u.push("{"+q9(P[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":S=z;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":u.push("");break;case"PtgAreaErr":u.push("#REF!");break;case"PtgAreaErr3d":u.push("#REF!");break;case"PtgList":u.push("Table"+P[1].idx+"[#"+P[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(P));default:throw new Error("Unrecognized Formula Token: "+String(P))}var be=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(i.biff!=3&&S>=0&&be.indexOf(t[0][z][0])==-1){P=t[0][S];var te=!0;switch(P[1][0]){case 4:te=!1;case 0:C=ur(" ",P[1][1]);break;case 5:te=!1;case 1:C=ur("\r",P[1][1]);break;default:if(C="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+P[1][0])}u.push((te?C:"")+u.pop()+(te?"":C)),S=-1}}if(u.length>1&&i.WTF)throw new Error("bad formula stack");return u[0]}function W9(t,e,r){var n=t.l+e,i=r.biff==2?1:2,o,c=t.read_shift(i);if(c==65535)return[[],mn(t,e-2)];var u=Of(t,c,r);return e!==c+i&&(o=Df(t,e-c-i,u,r)),t.l=n,[u,o]}function Y9(t,e,r){var n=t.l+e,i=r.biff==2?1:2,o,c=t.read_shift(i);if(c==65535)return[[],mn(t,e-2)];var u=Of(t,c,r);return e!==c+i&&(o=Df(t,e-c-i,u,r)),t.l=n,[u,o]}function $9(t,e,r,n){var i=t.l+e,o=Of(t,n,r),c;return i!==t.l&&(c=Df(t,i-t.l,o,r)),[o,c]}function Q9(t,e,r){var n=t.l+e,i,o=t.read_shift(2),c=Of(t,o,r);return o==65535?[[],mn(t,e-2)]:(e!==o+2&&(i=Df(t,n-o-2,c,r)),[c,i])}function Z9(t){var e;if(Oi(t,t.l+6)!==65535)return[fn(t),"n"];switch(t[t.l]){case 0:return t.l+=8,["String","s"];case 1:return e=t[t.l+2]===1,t.l+=8,[e,"b"];case 2:return e=t[t.l+2],t.l+=8,[e,"e"];case 3:return t.l+=8,["","s"]}return[]}function Jm(t,e,r){var n=t.l+e,i=oi(t);r.biff==2&&++t.l;var o=Z9(t),c=t.read_shift(1);r.biff!=2&&(t.read_shift(1),r.biff>=5&&t.read_shift(4));var u=Y9(t,n-t.l,r);return{cell:i,val:o[0],formula:u,shared:c>>3&1,tt:o[1]}}function Dd(t,e,r){var n=t.read_shift(4),i=Of(t,n,r),o=t.read_shift(4),c=o>0?Df(t,o,i,r):null;return[i,c]}var J9=Dd,Od=Dd,eL=Dd,tL=Dd,rL={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},E4={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},nL={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function i2(t){return t.slice(0,3)=="of:"&&(t=t.slice(3)),t.charCodeAt(0)==61&&(t=t.slice(1),t.charCodeAt(0)==61&&(t=t.slice(1))),t=t.replace(/COM\.MICROSOFT\./g,""),t=t.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(e,r){return r.replace(/\./g,"")}),t=t.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),t.replace(/[;~]/g,",").replace(/\|/g,";")}function eg(t){var e=t.split(":"),r=e[0].split(".")[0];return[r,e[0].split(".")[1]+(e.length>1?":"+(e[1].split(".")[1]||e[1].split(".")[0]):"")]}var qu={},ac={};function Ku(t,e){if(t){var r=[.7,.7,.75,.75,.3,.3];e=="xlml"&&(r=[1,1,1,1,.5,.5]),t.left==null&&(t.left=r[0]),t.right==null&&(t.right=r[1]),t.top==null&&(t.top=r[2]),t.bottom==null&&(t.bottom=r[3]),t.header==null&&(t.header=r[4]),t.footer==null&&(t.footer=r[5])}}function T4(t,e,r,n,i,o){try{n.cellNF&&(t.z=ht[e])}catch(u){if(n.WTF)throw u}if(!(t.t==="z"&&!n.cellStyles)){if(t.t==="d"&&typeof t.v=="string"&&(t.v=Jr(t.v)),(!n||n.cellText!==!1)&&t.t!=="z")try{if(ht[e]==null&&Fo(sF[e]||"General",e),t.t==="e")t.w=t.w||tl[t.v];else if(e===0)if(t.t==="n")(t.v|0)===t.v?t.w=t.v.toString(10):t.w=of(t.v);else if(t.t==="d"){var c=Yn(t.v);(c|0)===c?t.w=c.toString(10):t.w=of(c)}else{if(t.v===void 0)return"";t.w=jo(t.v,ac)}else t.t==="d"?t.w=ga(e,Yn(t.v),ac):t.w=ga(e,t.v,ac)}catch(u){if(n.WTF)throw u}if(n.cellStyles&&r!=null)try{t.s=o.Fills[r],t.s.fgColor&&t.s.fgColor.theme&&!t.s.fgColor.rgb&&(t.s.fgColor.rgb=$0(i.themeElements.clrScheme[t.s.fgColor.theme].rgb,t.s.fgColor.tint||0),n.WTF&&(t.s.fgColor.raw_rgb=i.themeElements.clrScheme[t.s.fgColor.theme].rgb)),t.s.bgColor&&t.s.bgColor.theme&&(t.s.bgColor.rgb=$0(i.themeElements.clrScheme[t.s.bgColor.theme].rgb,t.s.bgColor.tint||0),n.WTF&&(t.s.bgColor.raw_rgb=i.themeElements.clrScheme[t.s.bgColor.theme].rgb))}catch(u){if(n.WTF&&o.Fills)throw u}}}function aL(t,e){var r=qr(e);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(t["!ref"]=qt(r))}var iL=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,sL=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,oL=/<(?:\w:)?hyperlink [^>]*>/mg,lL=/"(\w*:\w*)"/,cL=/<(?:\w:)?col\b[^>]*[\/]?>/g,uL=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,fL=/<(?:\w:)?pageMargins[^>]*\/>/g,A4=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,hL=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,dL=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function pL(t,e,r,n,i,o,c){if(!t)return t;n||(n={"!id":{}});var u=e.dense?[]:{},h={s:{r:2e6,c:2e6},e:{r:0,c:0}},d="",g="",_=t.match(sL);_?(d=t.slice(0,_.index),g=t.slice(_.index+_[0].length)):d=g=t;var x=d.match(A4);x?ov(x[0],u,i,r):(x=d.match(hL))&&mL(x[0],x[1]||"",u,i,r);var A=(d.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(A>0){var w=d.slice(A,A+50).match(lL);w&&aL(u,w[1])}var S=d.match(dL);S&&S[1]&&EL(S[1],i);var C=[];if(e.cellStyles){var z=d.match(cL);z&&_L(C,z)}_&&TL(_[1],u,e,h,o,c);var W=g.match(uL);W&&(u["!autofilter"]=xL(W[0]));var P=[],re=g.match(iL);if(re)for(A=0;A!=re.length;++A)P[A]=qr(re[A].slice(re[A].indexOf('"')+1));var Q=g.match(oL);Q&&gL(u,Q,n);var ee=g.match(fL);if(ee&&(u["!margins"]=vL(st(ee[0]))),!u["!ref"]&&h.e.c>=h.s.c&&h.e.r>=h.s.r&&(u["!ref"]=qt(h)),e.sheetRows>0&&u["!ref"]){var k=qr(u["!ref"]);e.sheetRows<=+k.e.r&&(k.e.r=e.sheetRows-1,k.e.r>h.e.r&&(k.e.r=h.e.r),k.e.r<k.s.r&&(k.s.r=k.e.r),k.e.c>h.e.c&&(k.e.c=h.e.c),k.e.c<k.s.c&&(k.s.c=k.e.c),u["!fullref"]=u["!ref"],u["!ref"]=qt(k))}return C.length>0&&(u["!cols"]=C),P.length>0&&(u["!merges"]=P),u}function ov(t,e,r,n){var i=st(t);r.Sheets[n]||(r.Sheets[n]={}),i.codeName&&(r.Sheets[n].CodeName=Nt(Jt(i.codeName)))}function mL(t,e,r,n,i){ov(t.slice(0,t.indexOf(">")),r,n,i)}function gL(t,e,r){for(var n=Array.isArray(t),i=0;i!=e.length;++i){var o=st(Jt(e[i]),!0);if(!o.ref)return;var c=((r||{})["!id"]||[])[o.id];c?(o.Target=c.Target,o.location&&(o.Target+="#"+Nt(o.location))):(o.Target="#"+Nt(o.location),c={Target:o.Target,TargetMode:"Internal"}),o.Rel=c,o.tooltip&&(o.Tooltip=o.tooltip,delete o.tooltip);for(var u=qr(o.ref),h=u.s.r;h<=u.e.r;++h)for(var d=u.s.c;d<=u.e.c;++d){var g=vt({c:d,r:h});n?(t[h]||(t[h]=[]),t[h][d]||(t[h][d]={t:"z",v:void 0}),t[h][d].l=o):(t[g]||(t[g]={t:"z",v:void 0}),t[g].l=o)}}}function vL(t){var e={};return["left","right","top","bottom","header","footer"].forEach(function(r){t[r]&&(e[r]=parseFloat(t[r]))}),e}function _L(t,e){for(var r=!1,n=0;n!=e.length;++n){var i=st(e[n],!0);i.hidden&&(i.hidden=ir(i.hidden));var o=parseInt(i.min,10)-1,c=parseInt(i.max,10)-1;for(i.outlineLevel&&(i.level=+i.outlineLevel||0),delete i.min,delete i.max,i.width=+i.width,!r&&i.width&&(r=!0,iv(i.width)),dc(i);o<=c;)t[o++]=en(i)}}function xL(t){var e={ref:(t.match(/ref="([^"]*)"/)||[])[1]};return e}var yL=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function EL(t,e){e.Views||(e.Views=[{}]),(t.match(yL)||[]).forEach(function(r,n){var i=st(r);e.Views[n]||(e.Views[n]={}),+i.zoomScale&&(e.Views[n].zoom=+i.zoomScale),ir(i.rightToLeft)&&(e.Views[n].RTL=!0)})}var TL=function(){var t=/<(?:\w+:)?c[ \/>]/,e=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,i=/ref=["']([^"']*)["']/,o=cf("v"),c=cf("f");return function(h,d,g,_,x,A){for(var w=0,S="",C=[],z=[],W=0,P=0,re=0,Q="",ee,k,T=0,E=0,I,O,D=0,F=0,Fe=Array.isArray(A.CellXf),Ce,ne=[],oe=[],be=Array.isArray(d),te=[],G={},se=!1,M=!!g.sheetStubs,j=h.split(e),Y=0,Z=j.length;Y!=Z;++Y){S=j[Y].trim();var ue=S.length;if(ue!==0){var Ie=0;e:for(w=0;w<ue;++w)switch(S[w]){case">":if(S[w-1]!="/"){++w;break e}if(g&&g.cellStyles){if(k=st(S.slice(Ie,w),!0),T=k.r!=null?parseInt(k.r,10):T+1,E=-1,g.sheetRows&&g.sheetRows<T)continue;G={},se=!1,k.ht&&(se=!0,G.hpt=parseFloat(k.ht),G.hpx=df(G.hpt)),k.hidden=="1"&&(se=!0,G.hidden=!0),k.outlineLevel!=null&&(se=!0,G.level=+k.outlineLevel),se&&(te[T-1]=G)}break;case"<":Ie=w;break}if(Ie>=w)break;if(k=st(S.slice(Ie,w),!0),T=k.r!=null?parseInt(k.r,10):T+1,E=-1,!(g.sheetRows&&g.sheetRows<T)){_.s.r>T-1&&(_.s.r=T-1),_.e.r<T-1&&(_.e.r=T-1),g&&g.cellStyles&&(G={},se=!1,k.ht&&(se=!0,G.hpt=parseFloat(k.ht),G.hpx=df(G.hpt)),k.hidden=="1"&&(se=!0,G.hidden=!0),k.outlineLevel!=null&&(se=!0,G.level=+k.outlineLevel),se&&(te[T-1]=G)),C=S.slice(w).split(t);for(var Ee=0;Ee!=C.length&&C[Ee].trim().charAt(0)=="<";++Ee);for(C=C.slice(Ee),w=0;w!=C.length;++w)if(S=C[w].trim(),S.length!==0){if(z=S.match(r),W=w,P=0,re=0,S="<c "+(S.slice(0,1)=="<"?">":"")+S,z!=null&&z.length===2){for(W=0,Q=z[1],P=0;P!=Q.length&&!((re=Q.charCodeAt(P)-64)<1||re>26);++P)W=26*W+re;--W,E=W}else++E;for(P=0;P!=S.length&&S.charCodeAt(P)!==62;++P);if(++P,k=st(S.slice(0,P),!0),k.r||(k.r=vt({r:T-1,c:E})),Q=S.slice(P),ee={t:""},(z=Q.match(o))!=null&&z[1]!==""&&(ee.v=Nt(z[1])),g.cellFormula){if((z=Q.match(c))!=null&&z[1]!==""){if(ee.f=Nt(Jt(z[1])).replace(/\r\n/g,`
`),g.xlfn||(ee.f=t2(ee.f)),z[0].indexOf('t="array"')>-1)ee.F=(Q.match(i)||[])[1],ee.F.indexOf(":")>-1&&ne.push([qr(ee.F),ee.F]);else if(z[0].indexOf('t="shared"')>-1){O=st(z[0]);var we=Nt(Jt(z[1]));g.xlfn||(we=t2(we)),oe[parseInt(O.si,10)]=[O,we,k.r]}}else(z=Q.match(/<f[^>]*\/>/))&&(O=st(z[0]),oe[O.si]&&(ee.f=N5(oe[O.si][1],oe[O.si][2],k.r)));var Te=Ia(k.r);for(P=0;P<ne.length;++P)Te.r>=ne[P][0].s.r&&Te.r<=ne[P][0].e.r&&Te.c>=ne[P][0].s.c&&Te.c<=ne[P][0].e.c&&(ee.F=ne[P][1])}if(k.t==null&&ee.v===void 0)if(ee.f||ee.F)ee.v=0,ee.t="n";else if(M)ee.t="z";else continue;else ee.t=k.t||"n";switch(_.s.c>E&&(_.s.c=E),_.e.c<E&&(_.e.c=E),ee.t){case"n":if(ee.v==""||ee.v==null){if(!M)continue;ee.t="z"}else ee.v=parseFloat(ee.v);break;case"s":if(typeof ee.v>"u"){if(!M)continue;ee.t="z"}else I=qu[parseInt(ee.v,10)],ee.v=I.t,ee.r=I.r,g.cellHTML&&(ee.h=I.h);break;case"str":ee.t="s",ee.v=ee.v!=null?Jt(ee.v):"",g.cellHTML&&(ee.h=wS(ee.v));break;case"inlineStr":z=Q.match(n),ee.t="s",z!=null&&(I=av(z[1]))?(ee.v=I.t,g.cellHTML&&(ee.h=I.h)):ee.v="";break;case"b":ee.v=ir(ee.v);break;case"d":g.cellDates?ee.v=Jr(ee.v,1):(ee.v=Yn(Jr(ee.v,1)),ee.t="n");break;case"e":(!g||g.cellText!==!1)&&(ee.w=ee.v),ee.v=GS[ee.v];break}if(D=F=0,Ce=null,Fe&&k.s!==void 0&&(Ce=A.CellXf[k.s],Ce!=null&&(Ce.numFmtId!=null&&(D=Ce.numFmtId),g.cellStyles&&Ce.fillId!=null&&(F=Ce.fillId))),T4(ee,D,F,g,x,A),g.cellDates&&Fe&&ee.t=="n"&&Tc(ht[D])&&(ee.t="d",ee.v=bd(ee.v)),k.cm&&g.xlmeta){var Ue=(g.xlmeta.Cell||[])[+k.cm-1];Ue&&Ue.type=="XLDAPR"&&(ee.D=!0)}if(be){var K=Ia(k.r);d[K.r]||(d[K.r]=[]),d[K.r][K.c]=ee}else d[k.r]=ee}}}}te.length>0&&(d["!rows"]=te)}}();function AL(t,e){var r={},n=t.l+e;r.r=t.read_shift(4),t.l+=4;var i=t.read_shift(2);t.l+=1;var o=t.read_shift(1);return t.l=n,o&7&&(r.level=o&7),o&16&&(r.hidden=!0),o&32&&(r.hpt=i/20),r}var wL=el;function SL(){}function CL(t,e){var r={},n=t[t.l];return++t.l,r.above=!(n&64),r.left=!(n&128),t.l+=18,r.name=WF(t),r}function RL(t){var e=va(t);return[e]}function kL(t){var e=Jo(t);return[e]}function bL(t){var e=va(t),r=t.read_shift(1);return[e,r,"b"]}function IL(t){var e=Jo(t),r=t.read_shift(1);return[e,r,"b"]}function DL(t){var e=va(t),r=t.read_shift(1);return[e,r,"e"]}function OL(t){var e=Jo(t),r=t.read_shift(1);return[e,r,"e"]}function NL(t){var e=va(t),r=t.read_shift(4);return[e,r,"s"]}function FL(t){var e=Jo(t),r=t.read_shift(4);return[e,r,"s"]}function PL(t){var e=va(t),r=fn(t);return[e,r,"n"]}function w4(t){var e=Jo(t),r=fn(t);return[e,r,"n"]}function ML(t){var e=va(t),r=tv(t);return[e,r,"n"]}function LL(t){var e=Jo(t),r=tv(t);return[e,r,"n"]}function VL(t){var e=va(t),r=J1(t);return[e,r,"is"]}function UL(t){var e=va(t),r=dn(t);return[e,r,"str"]}function BL(t){var e=Jo(t),r=dn(t);return[e,r,"str"]}function jL(t,e,r){var n=t.l+e,i=va(t);i.r=r["!row"];var o=t.read_shift(1),c=[i,o,"b"];if(r.cellFormula){t.l+=2;var u=Od(t,n-t.l,r);c[3]=cn(u,null,i,r.supbooks,r)}else t.l=n;return c}function zL(t,e,r){var n=t.l+e,i=va(t);i.r=r["!row"];var o=t.read_shift(1),c=[i,o,"e"];if(r.cellFormula){t.l+=2;var u=Od(t,n-t.l,r);c[3]=cn(u,null,i,r.supbooks,r)}else t.l=n;return c}function HL(t,e,r){var n=t.l+e,i=va(t);i.r=r["!row"];var o=fn(t),c=[i,o,"n"];if(r.cellFormula){t.l+=2;var u=Od(t,n-t.l,r);c[3]=cn(u,null,i,r.supbooks,r)}else t.l=n;return c}function GL(t,e,r){var n=t.l+e,i=va(t);i.r=r["!row"];var o=dn(t),c=[i,o,"str"];if(r.cellFormula){t.l+=2;var u=Od(t,n-t.l,r);c[3]=cn(u,null,i,r.supbooks,r)}else t.l=n;return c}var qL=el;function KL(t,e){var r=t.l+e,n=el(t),i=ev(t),o=dn(t),c=dn(t),u=dn(t);t.l=r;var h={rfx:n,relId:i,loc:o,display:u};return c&&(h.Tooltip=c),h}function XL(){}function WL(t,e,r){var n=t.l+e,i=jS(t),o=t.read_shift(1),c=[i];if(c[2]=o,r.cellFormula){var u=J9(t,n-t.l,r);c[1]=u}else t.l=n;return c}function YL(t,e,r){var n=t.l+e,i=el(t),o=[i];if(r.cellFormula){var c=tL(t,n-t.l,r);o[1]=c,t.l=n}else t.l=n;return o}var $L=["left","right","top","bottom","header","footer"];function QL(t){var e={};return $L.forEach(function(r){e[r]=fn(t)}),e}function ZL(t){var e=t.read_shift(2);return t.l+=28,{RTL:e&32}}function JL(){}function e7(){}function t7(t,e,r,n,i,o,c){if(!t)return t;var u=e||{};n||(n={"!id":{}});var h=u.dense?[]:{},d,g={s:{r:2e6,c:2e6},e:{r:0,c:0}},_=!1,x=!1,A,w,S,C,z,W,P,re,Q,ee=[];u.biff=12,u["!row"]=0;var k=0,T=!1,E=[],I={},O=u.supbooks||i.supbooks||[[]];if(O.sharedf=I,O.arrayf=E,O.SheetNames=i.SheetNames||i.Sheets.map(function(be){return be.name}),!u.supbooks&&(u.supbooks=O,i.Names))for(var D=0;D<i.Names.length;++D)O[0][D+1]=i.Names[D];var F=[],Fe=[],Ce=!1;J0[16]={n:"BrtShortReal",f:w4};var ne;if(zi(t,function(te,G,se){if(!x)switch(se){case 148:d=te;break;case 0:A=te,u.sheetRows&&u.sheetRows<=A.r&&(x=!0),re=Xn(C=A.r),u["!row"]=A.r,(te.hidden||te.hpt||te.level!=null)&&(te.hpt&&(te.hpx=df(te.hpt)),Fe[te.r]=te);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(w={t:te[2]},te[2]){case"n":w.v=te[1];break;case"s":P=qu[te[1]],w.v=P.t,w.r=P.r;break;case"b":w.v=!!te[1];break;case"e":w.v=te[1],u.cellText!==!1&&(w.w=tl[w.v]);break;case"str":w.t="s",w.v=te[1];break;case"is":w.t="s",w.v=te[1].t;break}if((S=c.CellXf[te[0].iStyleRef])&&T4(w,S.numFmtId,null,u,o,c),z=te[0].c==-1?z+1:te[0].c,u.dense?(h[C]||(h[C]=[]),h[C][z]=w):h[wn(z)+re]=w,u.cellFormula){for(T=!1,k=0;k<E.length;++k){var M=E[k];A.r>=M[0].s.r&&A.r<=M[0].e.r&&z>=M[0].s.c&&z<=M[0].e.c&&(w.F=qt(M[0]),T=!0)}!T&&te.length>3&&(w.f=te[3])}if(g.s.r>A.r&&(g.s.r=A.r),g.s.c>z&&(g.s.c=z),g.e.r<A.r&&(g.e.r=A.r),g.e.c<z&&(g.e.c=z),u.cellDates&&S&&w.t=="n"&&Tc(ht[S.numFmtId])){var j=Oo(w.v);j&&(w.t="d",w.v=new Date(j.y,j.m-1,j.d,j.H,j.M,j.S,j.u))}ne&&(ne.type=="XLDAPR"&&(w.D=!0),ne=void 0);break;case 1:case 12:if(!u.sheetStubs||_)break;w={t:"z",v:void 0},z=te[0].c==-1?z+1:te[0].c,u.dense?(h[C]||(h[C]=[]),h[C][z]=w):h[wn(z)+re]=w,g.s.r>A.r&&(g.s.r=A.r),g.s.c>z&&(g.s.c=z),g.e.r<A.r&&(g.e.r=A.r),g.e.c<z&&(g.e.c=z),ne&&(ne.type=="XLDAPR"&&(w.D=!0),ne=void 0);break;case 176:ee.push(te);break;case 49:ne=((u.xlmeta||{}).Cell||[])[te-1];break;case 494:var Y=n["!id"][te.relId];for(Y?(te.Target=Y.Target,te.loc&&(te.Target+="#"+te.loc),te.Rel=Y):te.relId==""&&(te.Target="#"+te.loc),C=te.rfx.s.r;C<=te.rfx.e.r;++C)for(z=te.rfx.s.c;z<=te.rfx.e.c;++z)u.dense?(h[C]||(h[C]=[]),h[C][z]||(h[C][z]={t:"z",v:void 0}),h[C][z].l=te):(W=vt({c:z,r:C}),h[W]||(h[W]={t:"z",v:void 0}),h[W].l=te);break;case 426:if(!u.cellFormula)break;E.push(te),Q=u.dense?h[C][z]:h[wn(z)+re],Q.f=cn(te[1],g,{r:A.r,c:z},O,u),Q.F=qt(te[0]);break;case 427:if(!u.cellFormula)break;I[vt(te[0].s)]=te[1],Q=u.dense?h[C][z]:h[wn(z)+re],Q.f=cn(te[1],g,{r:A.r,c:z},O,u);break;case 60:if(!u.cellStyles)break;for(;te.e>=te.s;)F[te.e--]={width:te.w/256,hidden:!!(te.flags&1),level:te.level},Ce||(Ce=!0,iv(te.w/256)),dc(F[te.e+1]);break;case 161:h["!autofilter"]={ref:qt(te)};break;case 476:h["!margins"]=te;break;case 147:i.Sheets[r]||(i.Sheets[r]={}),te.name&&(i.Sheets[r].CodeName=te.name),(te.above||te.left)&&(h["!outline"]={above:te.above,left:te.left});break;case 137:i.Views||(i.Views=[{}]),i.Views[0]||(i.Views[0]={}),te.RTL&&(i.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:_=!0;break;case 36:_=!1;break;case 37:_=!0;break;case 38:_=!1;break;default:if(!G.T){if(!_||u.WTF)throw new Error("Unexpected record 0x"+se.toString(16))}}},u),delete u.supbooks,delete u["!row"],!h["!ref"]&&(g.s.r<2e6||d&&(d.e.r>0||d.e.c>0||d.s.r>0||d.s.c>0))&&(h["!ref"]=qt(d||g)),u.sheetRows&&h["!ref"]){var oe=qr(h["!ref"]);u.sheetRows<=+oe.e.r&&(oe.e.r=u.sheetRows-1,oe.e.r>g.e.r&&(oe.e.r=g.e.r),oe.e.r<oe.s.r&&(oe.s.r=oe.e.r),oe.e.c>g.e.c&&(oe.e.c=g.e.c),oe.e.c<oe.s.c&&(oe.s.c=oe.e.c),h["!fullref"]=h["!ref"],h["!ref"]=qt(oe))}return ee.length>0&&(h["!merges"]=ee),F.length>0&&(h["!cols"]=F),Fe.length>0&&(h["!rows"]=Fe),h}function r7(t){var e=[],r=t.match(/^<c:numCache>/),n;(t.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(o){var c=o.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);c&&(e[+c[1]]=r?+c[2]:c[2])});var i=Nt((t.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(t.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(o){n=o.replace(/<.*?>/g,"")}),[e,i,n]}function n7(t,e,r,n,i,o){var c=o||{"!type":"chart"};if(!t)return o;var u=0,h=0,d="A",g={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(t.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(_){var x=r7(_);g.s.r=g.s.c=0,g.e.c=u,d=wn(u),x[0].forEach(function(A,w){c[d+Xn(w)]={t:"n",v:A,z:x[1]},h=w}),g.e.r<h&&(g.e.r=h),++u}),u>0&&(c["!ref"]=qt(g)),c}function a7(t,e,r,n,i){if(!t)return t;n||(n={"!id":{}});var o={"!type":"chart","!drawel":null,"!rel":""},c,u=t.match(A4);return u&&ov(u[0],o,i,r),(c=t.match(/drawing r:id="(.*?)"/))&&(o["!rel"]=c[1]),n["!id"][o["!rel"]]&&(o["!drawel"]=n["!id"][o["!rel"]]),o}function i7(t,e){t.l+=10;var r=dn(t);return{name:r}}function s7(t,e,r,n,i){if(!t)return t;n||(n={"!id":{}});var o={"!type":"chart","!drawel":null,"!rel":""},c=!1;return zi(t,function(h,d,g){switch(g){case 550:o["!rel"]=h;break;case 651:i.Sheets[r]||(i.Sheets[r]={}),h.name&&(i.Sheets[r].CodeName=h.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:c=!0;break;case 36:c=!1;break;case 37:break;case 38:break;default:if(!(d.T>0)){if(!(d.T<0)){if(!c||e.WTF)throw new Error("Unexpected record 0x"+g.toString(16))}}}},e),n["!id"][o["!rel"]]&&(o["!drawel"]=n["!id"][o["!rel"]]),o}var S4=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],o7=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],l7=[],c7=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function s2(t,e){for(var r=0;r!=t.length;++r)for(var n=t[r],i=0;i!=e.length;++i){var o=e[i];if(n[o[0]]==null)n[o[0]]=o[1];else switch(o[2]){case"bool":typeof n[o[0]]=="string"&&(n[o[0]]=ir(n[o[0]]));break;case"int":typeof n[o[0]]=="string"&&(n[o[0]]=parseInt(n[o[0]],10));break}}}function o2(t,e){for(var r=0;r!=e.length;++r){var n=e[r];if(t[n[0]]==null)t[n[0]]=n[1];else switch(n[2]){case"bool":typeof t[n[0]]=="string"&&(t[n[0]]=ir(t[n[0]]));break;case"int":typeof t[n[0]]=="string"&&(t[n[0]]=parseInt(t[n[0]],10));break}}}function C4(t){o2(t.WBProps,S4),o2(t.CalcPr,c7),s2(t.WBView,o7),s2(t.Sheets,l7),ac.date1904=ir(t.WBProps.date1904)}var u7="][*?/\\".split("");function f7(t,e){if(t.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return u7.forEach(function(n){if(t.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}var h7=/<\w+:workbook/;function d7(t,e){if(!t)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,i="xmlns",o={},c=0;if(t.replace(gn,function(h,d){var g=st(h);switch(si(g[0])){case"<?xml":break;case"<workbook":h.match(h7)&&(i="xmlns"+h.match(/<(\w+):/)[1]),r.xmlns=g[i];break;case"</workbook>":break;case"<fileVersion":delete g[0],r.AppVersion=g;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":S4.forEach(function(_){if(g[_[0]]!=null)switch(_[2]){case"bool":r.WBProps[_[0]]=ir(g[_[0]]);break;case"int":r.WBProps[_[0]]=parseInt(g[_[0]],10);break;default:r.WBProps[_[0]]=g[_[0]]}}),g.codeName&&(r.WBProps.CodeName=Jt(g.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete g[0],r.WBView.push(g);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(g.state){case"hidden":g.Hidden=1;break;case"veryHidden":g.Hidden=2;break;default:g.Hidden=0}delete g.state,g.name=Nt(Jt(g.name)),delete g[0],r.Sheets.push(g);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":o={},o.Name=Jt(g.name),g.comment&&(o.Comment=g.comment),g.localSheetId&&(o.Sheet=+g.localSheetId),ir(g.hidden||"0")&&(o.Hidden=!0),c=d+h.length;break;case"</definedName>":o.Ref=Nt(Jt(t.slice(c,d))),r.Names.push(o);break;case"<definedName/>":break;case"<calcPr":delete g[0],r.CalcPr=g;break;case"<calcPr/>":delete g[0],r.CalcPr=g;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&e.WTF)throw new Error("unrecognized "+g[0]+" in workbook")}return h}),DF.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return C4(r),r}function p7(t,e){var r={};return r.Hidden=t.read_shift(4),r.iTabID=t.read_shift(4),r.strRelID=Ng(t),r.name=dn(t),r}function m7(t,e){var r={},n=t.read_shift(4);r.defaultThemeVersion=t.read_shift(4);var i=e>8?dn(t):"";return i.length>0&&(r.CodeName=i),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function g7(t,e){var r={};return t.read_shift(4),r.ArchID=t.read_shift(4),t.l+=e-8,r}function v7(t,e,r){var n=t.l+e;t.l+=4,t.l+=1;var i=t.read_shift(4),o=YF(t),c=eL(t,0,r),u=ev(t);t.l=n;var h={Name:o,Ptg:c};return i<268435455&&(h.Sheet=i),u&&(h.Comment=u),h}function _7(t,e){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],i=!1;e||(e={}),e.biff=12;var o=[],c=[[]];return c.SheetNames=[],c.XTI=[],J0[16]={n:"BrtFRTArchID$",f:g7},zi(t,function(h,d,g){switch(g){case 156:c.SheetNames.push(h.name),r.Sheets.push(h);break;case 153:r.WBProps=h;break;case 39:h.Sheet!=null&&(e.SID=h.Sheet),h.Ref=cn(h.Ptg,null,null,c,e),delete e.SID,delete h.Ptg,o.push(h);break;case 1036:break;case 357:case 358:case 355:case 667:c[0].length?c.push([g,h]):c[0]=[g,h],c[c.length-1].XTI=[];break;case 362:c.length===0&&(c[0]=[],c[0].XTI=[]),c[c.length-1].XTI=c[c.length-1].XTI.concat(h),c.XTI=c.XTI.concat(h);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(g),i=!0;break;case 36:n.pop(),i=!1;break;case 37:n.push(g),i=!0;break;case 38:n.pop(),i=!1;break;case 16:break;default:if(!d.T){if(!i||e.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+g.toString(16))}}},e),C4(r),r.Names=o,r.supbooks=c,r}function x7(t,e,r){return e.slice(-4)===".bin"?_7(t,r):d7(t,r)}function y7(t,e,r,n,i,o,c,u){return e.slice(-4)===".bin"?t7(t,n,r,i,o,c,u):pL(t,n,r,i,o,c,u)}function E7(t,e,r,n,i,o,c,u){return e.slice(-4)===".bin"?s7(t,n,r,i,o):a7(t,n,r,i,o)}function T7(t,e,r,n,i,o,c,u){return e.slice(-4)===".bin"?I5():D5()}function A7(t,e,r,n,i,o,c,u){return e.slice(-4)===".bin"?k5():b5()}function w7(t,e,r,n){return e.slice(-4)===".bin"?qM(t,r,n):UM(t,r,n)}function S7(t,e,r){return h4(t,r)}function C7(t,e,r){return e.slice(-4)===".bin"?oM(t,r):iM(t,r)}function R7(t,e,r){return e.slice(-4)===".bin"?S5(t,r):y5(t,r)}function k7(t,e,r){return e.slice(-4)===".bin"?v5(t):m5(t)}function b7(t,e,r,n){return r.slice(-4)===".bin"?_5(t,e,r,n):void 0}function I7(t,e,r){return e.slice(-4)===".bin"?d5(t,e,r):p5(t,e,r)}var R4=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,k4=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function wa(t,e){var r=t.split(/\s+/),n=[];if(n[0]=r[0],r.length===1)return n;var i=t.match(R4),o,c,u,h;if(i)for(h=0;h!=i.length;++h)o=i[h].match(k4),(c=o[1].indexOf(":"))===-1?n[o[1]]=o[2].slice(1,o[2].length-1):(o[1].slice(0,6)==="xmlns:"?u="xmlns"+o[1].slice(6):u=o[1].slice(c+1),n[u]=o[2].slice(1,o[2].length-1));return n}function D7(t){var e=t.split(/\s+/),r={};if(e.length===1)return r;var n=t.match(R4),i,o,c,u;if(n)for(u=0;u!=n.length;++u)i=n[u].match(k4),(o=i[1].indexOf(":"))===-1?r[i[1]]=i[2].slice(1,i[2].length-1):(i[1].slice(0,6)==="xmlns:"?c="xmlns"+i[1].slice(6):c=i[1].slice(o+1),r[c]=i[2].slice(1,i[2].length-1));return r}var Xu;function O7(t,e){var r=Xu[t]||Nt(t);return r==="General"?jo(e):ga(r,e)}function N7(t,e,r,n){var i=n;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":i=ir(n);break;case"i2":case"int":i=parseInt(n,10);break;case"r4":case"float":i=parseFloat(n);break;case"date":case"dateTime.tz":i=Jr(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}t[Nt(e)]=i}function F7(t,e,r){if(t.t!=="z"){if(!r||r.cellText!==!1)try{t.t==="e"?t.w=t.w||tl[t.v]:e==="General"?t.t==="n"?(t.v|0)===t.v?t.w=t.v.toString(10):t.w=of(t.v):t.w=jo(t.v):t.w=O7(e||"General",t.v)}catch(o){if(r.WTF)throw o}try{var n=Xu[e]||e||"General";if(r.cellNF&&(t.z=n),r.cellDates&&t.t=="n"&&Tc(n)){var i=Oo(t.v);i&&(t.t="d",t.v=new Date(i.y,i.m-1,i.d,i.H,i.M,i.S,i.u))}}catch(o){if(r.WTF)throw o}}}function P7(t,e,r){if(r.cellStyles&&e.Interior){var n=e.Interior;n.Pattern&&(n.patternType=NM[n.Pattern]||n.Pattern)}t[e.ID]=e}function M7(t,e,r,n,i,o,c,u,h,d){var g="General",_=n.StyleID,x={};d=d||{};var A=[],w=0;for(_===void 0&&u&&(_=u.StyleID),_===void 0&&c&&(_=c.StyleID);o[_]!==void 0&&(o[_].nf&&(g=o[_].nf),o[_].Interior&&A.push(o[_].Interior),!!o[_].Parent);)_=o[_].Parent;switch(r.Type){case"Boolean":n.t="b",n.v=ir(t);break;case"String":n.t="s",n.r=bT(Nt(t)),n.v=t.indexOf("<")>-1?Nt(e||t).replace(/<.*?>/g,""):n.r;break;case"DateTime":t.slice(-1)!="Z"&&(t+="Z"),n.v=(Jr(t)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),n.v!==n.v?n.v=Nt(t):n.v<60&&(n.v=n.v-1),(!g||g=="General")&&(g="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+t),n.t||(n.t="n");break;case"Error":n.t="e",n.v=GS[t],d.cellText!==!1&&(n.w=t);break;default:t==""&&e==""?n.t="z":(n.t="s",n.v=bT(e||t));break}if(F7(n,g,d),d.cellFormula!==!1)if(n.Formula){var S=Nt(n.Formula);S.charCodeAt(0)==61&&(S=S.slice(1)),n.f=nc(S,i),delete n.Formula,n.ArrayRange=="RC"?n.F=nc("RC:RC",i):n.ArrayRange&&(n.F=nc(n.ArrayRange,i),h.push([qr(n.F),n.F]))}else for(w=0;w<h.length;++w)i.r>=h[w][0].s.r&&i.r<=h[w][0].e.r&&i.c>=h[w][0].s.c&&i.c<=h[w][0].e.c&&(n.F=h[w][1]);d.cellStyles&&(A.forEach(function(C){!x.patternType&&C.patternType&&(x.patternType=C.patternType)}),n.s=x),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function L7(t){t.t=t.v||"",t.t=t.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.v=t.w=t.ixfe=void 0}function tg(t,e){var r=e||{};mS();var n=bu($1(t));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(n=Jt(n));var i=n.slice(0,1024).toLowerCase(),o=!1;if(i=i.replace(/".*?"/g,""),(i.indexOf(">")&1023)>Math.min(i.indexOf(",")&1023,i.indexOf(";")&1023)){var c=en(r);return c.type="string",ff.to_workbook(n,c)}if(i.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(Ye){i.indexOf("<"+Ye)>=0&&(o=!0)}),o)return H7(n,r);Xu={"General Number":"General","General Date":ht[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":ht[15],"Short Date":ht[14],"Long Time":ht[19],"Medium Time":ht[18],"Short Time":ht[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:ht[2],Standard:ht[4],Percent:ht[10],Scientific:ht[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var u,h=[],d,g={},_=[],x=r.dense?[]:{},A="",w={},S={},C=wa('<Data ss:Type="String">'),z=0,W=0,P=0,re={s:{r:2e6,c:2e6},e:{r:0,c:0}},Q={},ee={},k="",T=0,E=[],I={},O={},D=0,F=[],Fe=[],Ce={},ne=[],oe,be=!1,te=[],G=[],se={},M=0,j=0,Y={Sheets:[],WBProps:{date1904:!1}},Z={};uf.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var ue="";u=uf.exec(n);)switch(u[3]=(ue=u[3]).toLowerCase()){case"data":if(ue=="data"){if(u[1]==="/"){if((d=h.pop())[0]!==u[3])throw new Error("Bad state: "+d.join("|"))}else u[0].charAt(u[0].length-2)!=="/"&&h.push([u[3],!0]);break}if(h[h.length-1][1])break;u[1]==="/"?M7(n.slice(z,u.index),k,C,h[h.length-1][0]=="comment"?Ce:w,{c:W,r:P},Q,ne[W],S,te,r):(k="",C=wa(u[0]),z=u.index+u[0].length);break;case"cell":if(u[1]==="/")if(Fe.length>0&&(w.c=Fe),(!r.sheetRows||r.sheetRows>P)&&w.v!==void 0&&(r.dense?(x[P]||(x[P]=[]),x[P][W]=w):x[wn(W)+Xn(P)]=w),w.HRef&&(w.l={Target:Nt(w.HRef)},w.HRefScreenTip&&(w.l.Tooltip=w.HRefScreenTip),delete w.HRef,delete w.HRefScreenTip),(w.MergeAcross||w.MergeDown)&&(M=W+(parseInt(w.MergeAcross,10)|0),j=P+(parseInt(w.MergeDown,10)|0),E.push({s:{c:W,r:P},e:{c:M,r:j}})),!r.sheetStubs)w.MergeAcross?W=M+1:++W;else if(w.MergeAcross||w.MergeDown){for(var Ie=W;Ie<=M;++Ie)for(var Ee=P;Ee<=j;++Ee)(Ie>W||Ee>P)&&(r.dense?(x[Ee]||(x[Ee]=[]),x[Ee][Ie]={t:"z"}):x[wn(Ie)+Xn(Ee)]={t:"z"});W=M+1}else++W;else w=D7(u[0]),w.Index&&(W=+w.Index-1),W<re.s.c&&(re.s.c=W),W>re.e.c&&(re.e.c=W),u[0].slice(-2)==="/>"&&++W,Fe=[];break;case"row":u[1]==="/"||u[0].slice(-2)==="/>"?(P<re.s.r&&(re.s.r=P),P>re.e.r&&(re.e.r=P),u[0].slice(-2)==="/>"&&(S=wa(u[0]),S.Index&&(P=+S.Index-1)),W=0,++P):(S=wa(u[0]),S.Index&&(P=+S.Index-1),se={},(S.AutoFitHeight=="0"||S.Height)&&(se.hpx=parseInt(S.Height,10),se.hpt=f4(se.hpx),G[P]=se),S.Hidden=="1"&&(se.hidden=!0,G[P]=se));break;case"worksheet":if(u[1]==="/"){if((d=h.pop())[0]!==u[3])throw new Error("Bad state: "+d.join("|"));_.push(A),re.s.r<=re.e.r&&re.s.c<=re.e.c&&(x["!ref"]=qt(re),r.sheetRows&&r.sheetRows<=re.e.r&&(x["!fullref"]=x["!ref"],re.e.r=r.sheetRows-1,x["!ref"]=qt(re))),E.length&&(x["!merges"]=E),ne.length>0&&(x["!cols"]=ne),G.length>0&&(x["!rows"]=G),g[A]=x}else re={s:{r:2e6,c:2e6},e:{r:0,c:0}},P=W=0,h.push([u[3],!1]),d=wa(u[0]),A=Nt(d.Name),x=r.dense?[]:{},E=[],te=[],G=[],Z={name:A,Hidden:0},Y.Sheets.push(Z);break;case"table":if(u[1]==="/"){if((d=h.pop())[0]!==u[3])throw new Error("Bad state: "+d.join("|"))}else{if(u[0].slice(-2)=="/>")break;h.push([u[3],!1]),ne=[],be=!1}break;case"style":u[1]==="/"?P7(Q,ee,r):ee=wa(u[0]);break;case"numberformat":ee.nf=Nt(wa(u[0]).Format||"General"),Xu[ee.nf]&&(ee.nf=Xu[ee.nf]);for(var we=0;we!=392&&ht[we]!=ee.nf;++we);if(we==392){for(we=57;we!=392;++we)if(ht[we]==null){Fo(ee.nf,we);break}}break;case"column":if(h[h.length-1][0]!=="table")break;if(oe=wa(u[0]),oe.Hidden&&(oe.hidden=!0,delete oe.Hidden),oe.Width&&(oe.wpx=parseInt(oe.Width,10)),!be&&oe.wpx>10){be=!0,An=c4;for(var Te=0;Te<ne.length;++Te)ne[Te]&&dc(ne[Te])}be&&dc(oe),ne[oe.Index-1||ne.length]=oe;for(var Ue=0;Ue<+oe.Span;++Ue)ne[ne.length]=en(oe);break;case"namedrange":if(u[1]==="/")break;Y.Names||(Y.Names=[]);var K=st(u[0]),nt={Name:K.Name,Ref:nc(K.RefersTo.slice(1),{r:0,c:0})};Y.Sheets.length>0&&(nt.Sheet=Y.Sheets.length-1),Y.Names.push(nt);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(u[0].slice(-2)==="/>")break;u[1]==="/"?k+=n.slice(T,u.index):T=u.index+u[0].length;break;case"interior":if(!r.cellStyles)break;ee.Interior=wa(u[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(u[0].slice(-2)==="/>")break;u[1]==="/"?y8(I,ue,n.slice(D,u.index)):D=u.index+u[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(u[1]==="/"){if((d=h.pop())[0]!==u[3])throw new Error("Bad state: "+d.join("|"))}else h.push([u[3],!1]);break;case"comment":if(u[1]==="/"){if((d=h.pop())[0]!==u[3])throw new Error("Bad state: "+d.join("|"));L7(Ce),Fe.push(Ce)}else h.push([u[3],!1]),d=wa(u[0]),Ce={a:d.Author};break;case"autofilter":if(u[1]==="/"){if((d=h.pop())[0]!==u[3])throw new Error("Bad state: "+d.join("|"))}else if(u[0].charAt(u[0].length-2)!=="/"){var Ge=wa(u[0]);x["!autofilter"]={ref:nc(Ge.Range).replace(/\$/g,"")},h.push([u[3],!0])}break;case"name":break;case"datavalidation":if(u[1]==="/"){if((d=h.pop())[0]!==u[3])throw new Error("Bad state: "+d.join("|"))}else u[0].charAt(u[0].length-2)!=="/"&&h.push([u[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(u[1]==="/"){if((d=h.pop())[0]!==u[3])throw new Error("Bad state: "+d.join("|"))}else u[0].charAt(u[0].length-2)!=="/"&&h.push([u[3],!0]);break;case"null":break;default:if(h.length==0&&u[3]=="document"||h.length==0&&u[3]=="uof")return h2(n,r);var Ke=!0;switch(h[h.length-1][0]){case"officedocumentsettings":switch(u[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:Ke=!1}break;case"componentoptions":switch(u[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:Ke=!1}break;case"excelworkbook":switch(u[3]){case"date1904":Y.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:Ke=!1}break;case"workbookoptions":switch(u[3]){case"owcversion":break;case"height":break;case"width":break;default:Ke=!1}break;case"worksheetoptions":switch(u[3]){case"visible":if(u[0].slice(-2)!=="/>")if(u[1]==="/")switch(n.slice(D,u.index)){case"SheetHidden":Z.Hidden=1;break;case"SheetVeryHidden":Z.Hidden=2;break}else D=u.index+u[0].length;break;case"header":x["!margins"]||Ku(x["!margins"]={},"xlml"),isNaN(+st(u[0]).Margin)||(x["!margins"].header=+st(u[0]).Margin);break;case"footer":x["!margins"]||Ku(x["!margins"]={},"xlml"),isNaN(+st(u[0]).Margin)||(x["!margins"].footer=+st(u[0]).Margin);break;case"pagemargins":var Be=st(u[0]);x["!margins"]||Ku(x["!margins"]={},"xlml"),isNaN(+Be.Top)||(x["!margins"].top=+Be.Top),isNaN(+Be.Left)||(x["!margins"].left=+Be.Left),isNaN(+Be.Right)||(x["!margins"].right=+Be.Right),isNaN(+Be.Bottom)||(x["!margins"].bottom=+Be.Bottom);break;case"displayrighttoleft":Y.Views||(Y.Views=[]),Y.Views[0]||(Y.Views[0]={}),Y.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":x["!outline"]||(x["!outline"]={}),x["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":x["!outline"]||(x["!outline"]={}),x["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:Ke=!1}break;case"pivottable":case"pivotcache":switch(u[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:Ke=!1}break;case"pagebreaks":switch(u[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:Ke=!1}break;case"autofilter":switch(u[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:Ke=!1}break;case"querytable":switch(u[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:Ke=!1}break;case"datavalidation":switch(u[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:Ke=!1}break;case"sorting":case"conditionalformatting":switch(u[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:Ke=!1}break;case"mapinfo":case"schema":case"data":switch(u[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:Ke=!1}break;case"smarttags":break;default:Ke=!1;break}if(Ke||u[3].match(/!\[CDATA/))break;if(!h[h.length-1][1])throw"Unrecognized tag: "+u[3]+"|"+h.join("|");if(h[h.length-1][0]==="customdocumentproperties"){if(u[0].slice(-2)==="/>")break;u[1]==="/"?N7(O,ue,F,n.slice(D,u.index)):(F=u,D=u.index+u[0].length);break}if(r.WTF)throw"Unrecognized tag: "+u[3]+"|"+h.join("|")}var Ne={};return!r.bookSheets&&!r.bookProps&&(Ne.Sheets=g),Ne.SheetNames=_,Ne.Workbook=Y,Ne.SSF=en(ht),Ne.Props=I,Ne.Custprops=O,Ne}function Lg(t,e){switch(uv(e=e||{}),e.type||"base64"){case"base64":return tg(Wn(t),e);case"binary":case"buffer":case"file":return tg(t,e);case"array":return tg(Qo(t),e)}}function V7(t){var e={},r=t.content;if(r.l=28,e.AnsiUserType=r.read_shift(0,"lpstr-ansi"),e.AnsiClipboardFormat=ZF(r),r.length-r.l<=4)return e;var n=r.read_shift(4);if(n==0||n>40||(r.l-=4,e.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(n=r.read_shift(4),n!==1907505652)||(e.UnicodeClipboardFormat=JF(r),n=r.read_shift(4),n==0||n>40))return e;r.l-=4,e.Reserved2=r.read_shift(0,"lpwstr")}var U7=[60,1084,2066,2165,2175];function B7(t,e,r,n,i){var o=n,c=[],u=r.slice(r.l,r.l+o);if(i&&i.enc&&i.enc.insitu&&u.length>0)switch(t){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:i.enc.insitu(u)}c.push(u),r.l+=o;for(var h=Oi(r,r.l),d=Vg[h],g=0;d!=null&&U7.indexOf(h)>-1;)o=Oi(r,r.l+2),g=r.l+4,h==2066?g+=4:(h==2165||h==2175)&&(g+=12),u=r.slice(g,r.l+4+o),c.push(u),r.l+=4+o,d=Vg[h=Oi(r,r.l)];var _=As(c);Qr(_,0);var x=0;_.lens=[];for(var A=0;A<c.length;++A)_.lens.push(x),x+=c[A].length;if(_.length<n)throw"XLS Record 0x"+t.toString(16)+" Truncated: "+_.length+" < "+n;return e.f(_,_.length,i)}function $a(t,e,r){if(t.t!=="z"&&t.XF){var n=0;try{n=t.z||t.XF.numFmtId||0,e.cellNF&&(t.z=ht[n])}catch(o){if(e.WTF)throw o}if(!e||e.cellText!==!1)try{t.t==="e"?t.w=t.w||tl[t.v]:n===0||n=="General"?t.t==="n"?(t.v|0)===t.v?t.w=t.v.toString(10):t.w=of(t.v):t.w=jo(t.v):t.w=ga(n,t.v,{date1904:!!r,dateNF:e&&e.dateNF})}catch(o){if(e.WTF)throw o}if(e.cellDates&&n&&t.t=="n"&&Tc(ht[n]||String(n))){var i=Oo(t.v);i&&(t.t="d",t.v=new Date(i.y,i.m-1,i.d,i.H,i.M,i.S,i.u))}}}function c0(t,e,r){return{v:t,ixfe:e,t:r}}function j7(t,e){var r={opts:{}},n={},i=e.dense?[]:{},o={},c={},u=null,h=[],d="",g={},_,x="",A,w,S,C,z={},W=[],P,re,Q=[],ee=[],k={Sheets:[],WBProps:{date1904:!1},Views:[{}]},T={},E=function(ot){return ot<8?Po[ot]:ot<64&&ee[ot-8]||Po[ot]},I=function(ot,Ft,Vt){var Ot=Ft.XF.data;if(!(!Ot||!Ot.patternType||!Vt||!Vt.cellStyles)){Ft.s={},Ft.s.patternType=Ot.patternType;var Lr;(Lr=hf(E(Ot.icvFore)))&&(Ft.s.fgColor={rgb:Lr}),(Lr=hf(E(Ot.icvBack)))&&(Ft.s.bgColor={rgb:Lr})}},O=function(ot,Ft,Vt){if(!(se>1)&&!(Vt.sheetRows&&ot.r>=Vt.sheetRows)){if(Vt.cellStyles&&Ft.XF&&Ft.XF.data&&I(ot,Ft,Vt),delete Ft.ixfe,delete Ft.XF,_=ot,x=vt(ot),(!c||!c.s||!c.e)&&(c={s:{r:0,c:0},e:{r:0,c:0}}),ot.r<c.s.r&&(c.s.r=ot.r),ot.c<c.s.c&&(c.s.c=ot.c),ot.r+1>c.e.r&&(c.e.r=ot.r+1),ot.c+1>c.e.c&&(c.e.c=ot.c+1),Vt.cellFormula&&Ft.f){for(var Ot=0;Ot<W.length;++Ot)if(!(W[Ot][0].s.c>ot.c||W[Ot][0].s.r>ot.r)&&!(W[Ot][0].e.c<ot.c||W[Ot][0].e.r<ot.r)){Ft.F=qt(W[Ot][0]),(W[Ot][0].s.c!=ot.c||W[Ot][0].s.r!=ot.r)&&delete Ft.f,Ft.f&&(Ft.f=""+cn(W[Ot][1],c,ot,te,D));break}}Vt.dense?(i[ot.r]||(i[ot.r]=[]),i[ot.r][ot.c]=Ft):i[x]=Ft}},D={enc:!1,sbcch:0,snames:[],sharedf:z,arrayf:W,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!e&&!!e.cellStyles,WTF:!!e&&!!e.wtf};e.password&&(D.password=e.password);var F,Fe=[],Ce=[],ne=[],oe=[],be=!1,te=[];te.SheetNames=D.snames,te.sharedf=D.sharedf,te.arrayf=D.arrayf,te.names=[],te.XTI=[];var G=0,se=0,M=0,j=[],Y=[],Z;D.codepage=1200,ka(1200);for(var ue=!1;t.l<t.length-1;){var Ie=t.l,Ee=t.read_shift(2);if(Ee===0&&G===10)break;var we=t.l===t.length?0:t.read_shift(2),Te=Vg[Ee];if(Te&&Te.f){if(e.bookSheets&&G===133&&Ee!==133)break;if(G=Ee,Te.r===2||Te.r==12){var Ue=t.read_shift(2);if(we-=2,!D.enc&&Ue!==Ee&&((Ue&255)<<8|Ue>>8)!==Ee)throw new Error("rt mismatch: "+Ue+"!="+Ee);Te.r==12&&(t.l+=10,we-=10)}var K={};if(Ee===10?K=Te.f(t,we,D):K=B7(Ee,Te,t,we,D),se==0&&[9,521,1033,2057].indexOf(G)===-1)continue;switch(Ee){case 34:r.opts.Date1904=k.WBProps.date1904=K;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(D.enc||(t.l=0),D.enc=K,!e.password)throw new Error("File is password-protected");if(K.valid==null)throw new Error("Encryption scheme unsupported");if(!K.valid)throw new Error("Password is incorrect");break;case 92:D.lastuser=K;break;case 66:var nt=Number(K);switch(nt){case 21010:nt=1200;break;case 32768:nt=1e4;break;case 32769:nt=1252;break}ka(D.codepage=nt),ue=!0;break;case 317:D.rrtabid=K;break;case 25:D.winlocked=K;break;case 439:r.opts.RefreshAll=K;break;case 12:r.opts.CalcCount=K;break;case 16:r.opts.CalcDelta=K;break;case 17:r.opts.CalcIter=K;break;case 13:r.opts.CalcMode=K;break;case 14:r.opts.CalcPrecision=K;break;case 95:r.opts.CalcSaveRecalc=K;break;case 15:D.CalcRefMode=K;break;case 2211:r.opts.FullCalc=K;break;case 129:K.fDialog&&(i["!type"]="dialog"),K.fBelow||((i["!outline"]||(i["!outline"]={})).above=!0),K.fRight||((i["!outline"]||(i["!outline"]={})).left=!0);break;case 224:Q.push(K);break;case 430:te.push([K]),te[te.length-1].XTI=[];break;case 35:case 547:te[te.length-1].push(K);break;case 24:case 536:Z={Name:K.Name,Ref:cn(K.rgce,c,null,te,D)},K.itab>0&&(Z.Sheet=K.itab-1),te.names.push(Z),te[0]||(te[0]=[],te[0].XTI=[]),te[te.length-1].push(K),K.Name=="_xlnm._FilterDatabase"&&K.itab>0&&K.rgce&&K.rgce[0]&&K.rgce[0][0]&&K.rgce[0][0][0]=="PtgArea3d"&&(Y[K.itab-1]={ref:qt(K.rgce[0][0][1][2])});break;case 22:D.ExternCount=K;break;case 23:te.length==0&&(te[0]=[],te[0].XTI=[]),te[te.length-1].XTI=te[te.length-1].XTI.concat(K),te.XTI=te.XTI.concat(K);break;case 2196:if(D.biff<8)break;Z!=null&&(Z.Comment=K[1]);break;case 18:i["!protect"]=K;break;case 19:K!==0&&D.WTF&&console.error("Password verifier: "+K);break;case 133:o[K.pos]=K,D.snames.push(K.name);break;case 10:{if(--se)break;if(c.e){if(c.e.r>0&&c.e.c>0){if(c.e.r--,c.e.c--,i["!ref"]=qt(c),e.sheetRows&&e.sheetRows<=c.e.r){var Ge=c.e.r;c.e.r=e.sheetRows-1,i["!fullref"]=i["!ref"],i["!ref"]=qt(c),c.e.r=Ge}c.e.r++,c.e.c++}Fe.length>0&&(i["!merges"]=Fe),Ce.length>0&&(i["!objects"]=Ce),ne.length>0&&(i["!cols"]=ne),oe.length>0&&(i["!rows"]=oe),k.Sheets.push(T)}d===""?g=i:n[d]=i,i=e.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(D.biff===8&&(D.biff={9:2,521:3,1033:4}[Ee]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[K.BIFFVer]||8),D.biffguess=K.BIFFVer==0,K.BIFFVer==0&&K.dt==4096&&(D.biff=5,ue=!0,ka(D.codepage=28591)),D.biff==8&&K.BIFFVer==0&&K.dt==16&&(D.biff=2),se++)break;if(i=e.dense?[]:{},D.biff<8&&!ue&&(ue=!0,ka(D.codepage=e.codepage||1252)),D.biff<5||K.BIFFVer==0&&K.dt==4096){d===""&&(d="Sheet1"),c={s:{r:0,c:0},e:{r:0,c:0}};var Ke={pos:t.l-we,name:d};o[Ke.pos]=Ke,D.snames.push(d)}else d=(o[Ie]||{name:""}).name;K.dt==32&&(i["!type"]="chart"),K.dt==64&&(i["!type"]="macro"),Fe=[],Ce=[],D.arrayf=W=[],ne=[],oe=[],be=!1,T={Hidden:(o[Ie]||{hs:0}).hs,name:d}}break;case 515:case 3:case 2:i["!type"]=="chart"&&(e.dense?(i[K.r]||[])[K.c]:i[vt({c:K.c,r:K.r})])&&++K.c,P={ixfe:K.ixfe,XF:Q[K.ixfe]||{},v:K.val,t:"n"},M>0&&(P.z=j[P.ixfe>>8&63]),$a(P,e,r.opts.Date1904),O({c:K.c,r:K.r},P,e);break;case 5:case 517:P={ixfe:K.ixfe,XF:Q[K.ixfe],v:K.val,t:K.t},M>0&&(P.z=j[P.ixfe>>8&63]),$a(P,e,r.opts.Date1904),O({c:K.c,r:K.r},P,e);break;case 638:P={ixfe:K.ixfe,XF:Q[K.ixfe],v:K.rknum,t:"n"},M>0&&(P.z=j[P.ixfe>>8&63]),$a(P,e,r.opts.Date1904),O({c:K.c,r:K.r},P,e);break;case 189:for(var Be=K.c;Be<=K.C;++Be){var Ne=K.rkrec[Be-K.c][0];P={ixfe:Ne,XF:Q[Ne],v:K.rkrec[Be-K.c][1],t:"n"},M>0&&(P.z=j[P.ixfe>>8&63]),$a(P,e,r.opts.Date1904),O({c:Be,r:K.r},P,e)}break;case 6:case 518:case 1030:{if(K.val=="String"){u=K;break}if(P=c0(K.val,K.cell.ixfe,K.tt),P.XF=Q[P.ixfe],e.cellFormula){var Ye=K.formula;if(Ye&&Ye[0]&&Ye[0][0]&&Ye[0][0][0]=="PtgExp"){var ut=Ye[0][0][1][0],_t=Ye[0][0][1][1],rr=vt({r:ut,c:_t});z[rr]?P.f=""+cn(K.formula,c,K.cell,te,D):P.F=((e.dense?(i[ut]||[])[_t]:i[rr])||{}).F}else P.f=""+cn(K.formula,c,K.cell,te,D)}M>0&&(P.z=j[P.ixfe>>8&63]),$a(P,e,r.opts.Date1904),O(K.cell,P,e),u=K}break;case 7:case 519:if(u)u.val=K,P=c0(K,u.cell.ixfe,"s"),P.XF=Q[P.ixfe],e.cellFormula&&(P.f=""+cn(u.formula,c,u.cell,te,D)),M>0&&(P.z=j[P.ixfe>>8&63]),$a(P,e,r.opts.Date1904),O(u.cell,P,e),u=null;else throw new Error("String record expects Formula");break;case 33:case 545:{W.push(K);var _r=vt(K[0].s);if(A=e.dense?(i[K[0].s.r]||[])[K[0].s.c]:i[_r],e.cellFormula&&A){if(!u||!_r||!A)break;A.f=""+cn(K[1],c,K[0],te,D),A.F=qt(K[0])}}break;case 1212:{if(!e.cellFormula)break;if(x){if(!u)break;z[vt(u.cell)]=K[0],A=e.dense?(i[u.cell.r]||[])[u.cell.c]:i[vt(u.cell)],(A||{}).f=""+cn(K[0],c,_,te,D)}}break;case 253:P=c0(h[K.isst].t,K.ixfe,"s"),h[K.isst].h&&(P.h=h[K.isst].h),P.XF=Q[P.ixfe],M>0&&(P.z=j[P.ixfe>>8&63]),$a(P,e,r.opts.Date1904),O({c:K.c,r:K.r},P,e);break;case 513:e.sheetStubs&&(P={ixfe:K.ixfe,XF:Q[K.ixfe],t:"z"},M>0&&(P.z=j[P.ixfe>>8&63]),$a(P,e,r.opts.Date1904),O({c:K.c,r:K.r},P,e));break;case 190:if(e.sheetStubs)for(var fr=K.c;fr<=K.C;++fr){var Et=K.ixfe[fr-K.c];P={ixfe:Et,XF:Q[Et],t:"z"},M>0&&(P.z=j[P.ixfe>>8&63]),$a(P,e,r.opts.Date1904),O({c:fr,r:K.r},P,e)}break;case 214:case 516:case 4:P=c0(K.val,K.ixfe,"s"),P.XF=Q[P.ixfe],M>0&&(P.z=j[P.ixfe>>8&63]),$a(P,e,r.opts.Date1904),O({c:K.c,r:K.r},P,e);break;case 0:case 512:se===1&&(c=K);break;case 252:h=K;break;case 1054:if(D.biff==4){j[M++]=K[1];for(var er=0;er<M+163&&ht[er]!=K[1];++er);er>=163&&Fo(K[1],M+163)}else Fo(K[1],K[0]);break;case 30:{j[M++]=K;for(var Ze=0;Ze<M+163&&ht[Ze]!=K;++Ze);Ze>=163&&Fo(K,M+163)}break;case 229:Fe=Fe.concat(K);break;case 93:Ce[K.cmo[0]]=D.lastobj=K;break;case 438:D.lastobj.TxO=K;break;case 127:D.lastobj.ImData=K;break;case 440:for(C=K[0].s.r;C<=K[0].e.r;++C)for(S=K[0].s.c;S<=K[0].e.c;++S)A=e.dense?(i[C]||[])[S]:i[vt({c:S,r:C})],A&&(A.l=K[1]);break;case 2048:for(C=K[0].s.r;C<=K[0].e.r;++C)for(S=K[0].s.c;S<=K[0].e.c;++S)A=e.dense?(i[C]||[])[S]:i[vt({c:S,r:C})],A&&A.l&&(A.l.Tooltip=K[1]);break;case 28:{if(D.biff<=5&&D.biff>=2)break;A=e.dense?(i[K[0].r]||[])[K[0].c]:i[vt(K[0])];var Je=Ce[K[2]];A||(e.dense?(i[K[0].r]||(i[K[0].r]=[]),A=i[K[0].r][K[0].c]={t:"z"}):A=i[vt(K[0])]={t:"z"},c.e.r=Math.max(c.e.r,K[0].r),c.s.r=Math.min(c.s.r,K[0].r),c.e.c=Math.max(c.e.c,K[0].c),c.s.c=Math.min(c.s.c,K[0].c)),A.c||(A.c=[]),w={a:K[1],t:Je.TxO.t},A.c.push(w)}break;case 2173:c5(Q[K.ixfe],K.ext);break;case 125:{if(!D.cellStyles)break;for(;K.e>=K.s;)ne[K.e--]={width:K.w/256,level:K.level||0,hidden:!!(K.flags&1)},be||(be=!0,iv(K.w/256)),dc(ne[K.e+1])}break;case 520:{var dt={};K.level!=null&&(oe[K.r]=dt,dt.level=K.level),K.hidden&&(oe[K.r]=dt,dt.hidden=!0),K.hpt&&(oe[K.r]=dt,dt.hpt=K.hpt,dt.hpx=df(K.hpt))}break;case 38:case 39:case 40:case 41:i["!margins"]||Ku(i["!margins"]={}),i["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[Ee]]=K;break;case 161:i["!margins"]||Ku(i["!margins"]={}),i["!margins"].header=K.header,i["!margins"].footer=K.footer;break;case 574:K.RTL&&(k.Views[0].RTL=!0);break;case 146:ee=K;break;case 2198:F=K;break;case 140:re=K;break;case 442:d?T.CodeName=K||T.name:k.WBProps.CodeName=K||"ThisWorkbook";break}}else Te||console.error("Missing Info for XLS Record 0x"+Ee.toString(16)),t.l+=we}return r.SheetNames=qs(o).sort(function(Lt,ot){return Number(Lt)-Number(ot)}).map(function(Lt){return o[Lt].name}),e.bookSheets||(r.Sheets=n),!r.SheetNames.length&&g["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=g)):r.Preamble=g,r.Sheets&&Y.forEach(function(Lt,ot){r.Sheets[r.SheetNames[ot]]["!autofilter"]=Lt}),r.Strings=h,r.SSF=en(ht),D.enc&&(r.Encryption=D.enc),F&&(r.Themes=F),r.Metadata={},re!==void 0&&(r.Metadata.Country=re),te.names.length>0&&(k.Names=te.names),r.Workbook=k,r}var l2={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function z7(t,e,r){var n=Dt.find(t,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var i=qT(n,i8,l2.DSI);for(var o in i)e[o]=i[o]}catch(d){if(r.WTF)throw d}var c=Dt.find(t,"/!SummaryInformation");if(c&&c.size>0)try{var u=qT(c,s8,l2.SI);for(var h in u)e[h]==null&&(e[h]=u[h])}catch(d){if(r.WTF)throw d}e.HeadingPairs&&e.TitlesOfParts&&(KS(e.HeadingPairs,e.TitlesOfParts,e,r),delete e.HeadingPairs,delete e.TitlesOfParts)}function b4(t,e){e||(e={}),uv(e),nS(),e.codepage&&G1(e.codepage);var r,n;if(t.FullPaths){if(Dt.find(t,"/encryption"))throw new Error("File is password-protected");r=Dt.find(t,"!CompObj"),n=Dt.find(t,"/Workbook")||Dt.find(t,"/Book")}else{switch(e.type){case"base64":t=Ca(Wn(t));break;case"binary":t=Ca(t);break;case"buffer":break;case"array":Array.isArray(t)||(t=Array.prototype.slice.call(t));break}Qr(t,0),n={content:t}}var i,o;if(r&&V7(r),e.bookProps&&!e.bookSheets)i={};else{var c=wt?"buffer":"array";if(n&&n.content)i=j7(n.content,e);else if((o=Dt.find(t,"PerfectOffice_MAIN"))&&o.content)i=Gu.to_workbook(o.content,(e.type=c,e));else if((o=Dt.find(t,"NativeContent_MAIN"))&&o.content)i=Gu.to_workbook(o.content,(e.type=c,e));else throw(o=Dt.find(t,"MN0"))&&o.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");e.bookVBA&&t.FullPaths&&Dt.find(t,"/_VBA_PROJECT_CUR/VBA/dir")&&(i.vbaraw=R5(t))}var u={};return t.FullPaths&&z7(t,u,e),i.Props=i.Custprops=u,e.bookFiles&&(i.cfb=t),i}var J0={0:{f:AL},1:{f:RL},2:{f:ML},3:{f:DL},4:{f:bL},5:{f:PL},6:{f:UL},7:{f:NL},8:{f:GL},9:{f:HL},10:{f:jL},11:{f:zL},12:{f:kL},13:{f:LL},14:{f:OL},15:{f:IL},16:{f:w4},17:{f:BL},18:{f:FL},19:{f:J1},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:v7},40:{},42:{},43:{f:jM},44:{f:BM},45:{f:zM},46:{f:GM},47:{f:HM},48:{},49:{f:qF},50:{},51:{f:f5},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:a4},62:{f:VL},63:{f:g5},64:{f:JL},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:mn,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:ZL},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:CL},148:{f:wL,p:16},151:{f:XL},152:{},153:{f:m7},154:{},155:{},156:{f:p7},157:{},158:{},159:{T:1,f:sM},160:{T:-1},161:{T:1,f:el},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:qL},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:u5},336:{T:-1},337:{f:h5,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:Ng},357:{},358:{},359:{},360:{T:1},361:{},362:{f:n4},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:WL},427:{f:YL},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:QL},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:SL},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:KL},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:Ng},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:w5},633:{T:1},634:{T:-1},635:{T:1,f:A5},636:{T:-1},637:{f:XF},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:i7},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:e7},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},Vg={6:{f:Jm},10:{f:_s},12:{f:Sr},13:{f:Sr},14:{f:mr},15:{f:mr},16:{f:fn},17:{f:mr},18:{f:mr},19:{f:Sr},20:{f:YT},21:{f:YT},23:{f:n4},24:{f:QT},25:{f:mr},26:{},27:{},28:{f:EP},29:{},34:{f:mr},35:{f:$T},38:{f:fn},39:{f:fn},40:{f:fn},41:{f:fn},42:{f:mr},43:{f:mr},47:{f:SM},49:{f:rP},51:{f:Sr},60:{},61:{f:J8},64:{f:mr},65:{f:tP},66:{f:Sr},77:{},80:{},81:{},82:{},85:{f:Sr},89:{},90:{},91:{},92:{f:q8},93:{f:AP},94:{},95:{f:mr},96:{},97:{},99:{f:mr},125:{f:a4},128:{f:hP},129:{f:K8},130:{f:Sr},131:{f:mr},132:{f:mr},133:{f:X8},134:{},140:{f:bP},141:{f:Sr},144:{},146:{f:DP},151:{},152:{},153:{},154:{},155:{},156:{f:Sr},157:{},158:{},160:{f:MP},161:{f:NP},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:lP},190:{f:cP},193:{f:_s},197:{},198:{},199:{},200:{},201:{},202:{f:mr},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:Sr},220:{},221:{f:mr},222:{},224:{f:fP},225:{f:G8},226:{f:_s},227:{},229:{f:TP},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:W8},253:{f:nP},255:{f:Y8},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:QS},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:mr},353:{f:_s},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:pP},431:{f:mr},432:{},433:{},434:{},437:{},438:{f:CP},439:{f:mr},440:{f:RP},441:{},442:{f:bf},443:{},444:{f:Sr},445:{},446:{},448:{f:_s},449:{f:Z8,r:2},450:{f:_s},512:{f:XT},513:{f:PP},515:{f:dP},516:{f:aP},517:{f:WT},519:{f:LP},520:{f:$8},523:{},545:{f:ZT},549:{f:KT},566:{},574:{f:eP},638:{f:oP},659:{},1048:{},1054:{f:iP},1084:{},1212:{f:_P},2048:{f:kP},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:s0},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:_s},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:OP,r:12},2173:{f:l5,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:mr,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:vP,r:12},2197:{},2198:{f:r5,r:12},2199:{},2200:{},2201:{},2202:{f:xP,r:12},2203:{f:_s},2204:{},2205:{},2206:{},2207:{},2211:{f:Q8},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:Sr},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:FP},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:IP},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:XT},1:{},2:{f:jP},3:{f:BP},4:{f:UP},5:{f:WT},7:{f:zP},8:{},9:{f:s0},11:{},22:{f:Sr},30:{f:sP},31:{},32:{},33:{f:ZT},36:{},37:{f:KT},50:{f:HP},62:{},52:{},67:{},68:{f:Sr},69:{},86:{},126:{},127:{f:VP},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:GP},223:{},234:{},354:{},421:{},518:{f:Jm},521:{f:s0},536:{f:QT},547:{f:$T},561:{},579:{},1030:{f:Jm},1033:{f:s0},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function Sa(t,e,r,n){var i=e;if(!isNaN(i)){var o=(r||[]).length||0,c=t.next(4);c.write_shift(2,i),c.write_shift(2,o),o>0&&LS(r)&&t.push(r)}}function c2(t,e){var r=e||{},n=r.dense?[]:{};t=t.replace(/<!--.*?-->/g,"");var i=t.match(/<table/i);if(!i)throw new Error("Invalid HTML: could not find <table>");var o=t.match(/<\/table/i),c=i.index,u=o&&o.index||t.length,h=mF(t.slice(c,u),/(:?<tr[^>]*>)/i,"<tr>"),d=-1,g=0,_=0,x=0,A={s:{r:1e7,c:1e7},e:{r:0,c:0}},w=[];for(c=0;c<h.length;++c){var S=h[c].trim(),C=S.slice(0,3).toLowerCase();if(C=="<tr"){if(++d,r.sheetRows&&r.sheetRows<=d){--d;break}g=0;continue}if(!(C!="<td"&&C!="<th")){var z=S.split(/<\/t[dh]>/i);for(u=0;u<z.length;++u){var W=z[u].trim();if(W.match(/<t[dh]/i)){for(var P=W,re=0;P.charAt(0)=="<"&&(re=P.indexOf(">"))>-1;)P=P.slice(re+1);for(var Q=0;Q<w.length;++Q){var ee=w[Q];ee.s.c==g&&ee.s.r<d&&d<=ee.e.r&&(g=ee.e.c+1,Q=-1)}var k=st(W.slice(0,W.indexOf(">")));x=k.colspan?+k.colspan:1,((_=+k.rowspan)>1||x>1)&&w.push({s:{r:d,c:g},e:{r:d+(_||1)-1,c:g+x-1}});var T=k.t||k["data-t"]||"";if(!P.length){g+=x;continue}if(P=CF(P),A.s.r>d&&(A.s.r=d),A.e.r<d&&(A.e.r=d),A.s.c>g&&(A.s.c=g),A.e.c<g&&(A.e.c=g),!P.length){g+=x;continue}var E={t:"s",v:P};r.raw||!P.trim().length||T=="s"||(P==="TRUE"?E={t:"b",v:!0}:P==="FALSE"?E={t:"b",v:!1}:isNaN(Pi(P))?isNaN(lf(P).getDate())||(E={t:"d",v:Jr(P)},r.cellDates||(E={t:"n",v:Yn(E.v)}),E.z=r.dateNF||ht[14]):E={t:"n",v:Pi(P)}),r.dense?(n[d]||(n[d]=[]),n[d][g]=E):n[vt({r:d,c:g})]=E,g+=x}}}}return n["!ref"]=qt(A),w.length&&(n["!merges"]=w),n}function H7(t,e){var r=t.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return Zo(c2(r[0],e),e);var n=N4();return r.forEach(function(i,o){F4(n,c2(i,e),"Sheet"+(o+1))}),n}function G7(t){var e=t.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,i){return Array(parseInt(i,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=Nt(e.replace(/<[^>]*>/g,""));return[r]}var u2={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function I4(t,e){var r=e||{},n=$1(t),i=[],o,c,u={name:""},h="",d=0,g,_,x={},A=[],w=r.dense?[]:{},S,C,z={value:""},W="",P=0,re=[],Q=-1,ee=-1,k={s:{r:1e6,c:1e7},e:{r:0,c:0}},T=0,E={},I=[],O={},D=0,F=0,Fe=[],Ce=1,ne=1,oe=[],be={Names:[]},te={},G=["",""],se=[],M={},j="",Y=0,Z=!1,ue=!1,Ie=0;for(uf.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");S=uf.exec(n);)switch(S[3]=S[3].replace(/_.*$/,"")){case"table":case"":S[1]==="/"?(k.e.c>=k.s.c&&k.e.r>=k.s.r?w["!ref"]=qt(k):w["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=k.e.r&&(w["!fullref"]=w["!ref"],k.e.r=r.sheetRows-1,w["!ref"]=qt(k)),I.length&&(w["!merges"]=I),Fe.length&&(w["!rows"]=Fe),g.name=g.||g.name,typeof JSON<"u"&&JSON.stringify(g),A.push(g.name),x[g.name]=w,ue=!1):S[0].charAt(S[0].length-2)!=="/"&&(g=st(S[0],!1),Q=ee=-1,k.s.r=k.s.c=1e7,k.e.r=k.e.c=0,w=r.dense?[]:{},I=[],Fe=[],ue=!0);break;case"table-row-group":S[1]==="/"?--T:++T;break;case"table-row":case"":if(S[1]==="/"){Q+=Ce,Ce=1;break}if(_=st(S[0],!1),_.?Q=_.-1:Q==-1&&(Q=0),Ce=+_["number-rows-repeated"]||1,Ce<10)for(Ie=0;Ie<Ce;++Ie)T>0&&(Fe[Q+Ie]={level:T});ee=-1;break;case"covered-table-cell":S[1]!=="/"&&++ee,r.sheetStubs&&(r.dense?(w[Q]||(w[Q]=[]),w[Q][ee]={t:"z"}):w[vt({r:Q,c:ee})]={t:"z"}),W="",re=[];break;case"table-cell":case"":if(S[0].charAt(S[0].length-2)==="/")++ee,z=st(S[0],!1),ne=parseInt(z["number-columns-repeated"]||"1",10),C={t:"z",v:null},z.formula&&r.cellFormula!=!1&&(C.f=i2(Nt(z.formula))),(z.||z["value-type"])=="string"&&(C.t="s",C.v=Nt(z["string-value"]||""),r.dense?(w[Q]||(w[Q]=[]),w[Q][ee]=C):w[vt({r:Q,c:ee})]=C),ee+=ne-1;else if(S[1]!=="/"){++ee,W="",P=0,re=[],ne=1;var Ee=Ce?Q+Ce-1:Q;if(ee>k.e.c&&(k.e.c=ee),ee<k.s.c&&(k.s.c=ee),Q<k.s.r&&(k.s.r=Q),Ee>k.e.r&&(k.e.r=Ee),z=st(S[0],!1),se=[],M={},C={t:z.||z["value-type"],v:null},r.cellFormula)if(z.formula&&(z.formula=Nt(z.formula)),z["number-matrix-columns-spanned"]&&z["number-matrix-rows-spanned"]&&(D=parseInt(z["number-matrix-rows-spanned"],10)||0,F=parseInt(z["number-matrix-columns-spanned"],10)||0,O={s:{r:Q,c:ee},e:{r:Q+D-1,c:ee+F-1}},C.F=qt(O),oe.push([O,C.F])),z.formula)C.f=i2(z.formula);else for(Ie=0;Ie<oe.length;++Ie)Q>=oe[Ie][0].s.r&&Q<=oe[Ie][0].e.r&&ee>=oe[Ie][0].s.c&&ee<=oe[Ie][0].e.c&&(C.F=oe[Ie][1]);switch((z["number-columns-spanned"]||z["number-rows-spanned"])&&(D=parseInt(z["number-rows-spanned"],10)||0,F=parseInt(z["number-columns-spanned"],10)||0,O={s:{r:Q,c:ee},e:{r:Q+D-1,c:ee+F-1}},I.push(O)),z["number-columns-repeated"]&&(ne=parseInt(z["number-columns-repeated"],10)),C.t){case"boolean":C.t="b",C.v=ir(z["boolean-value"]);break;case"float":C.t="n",C.v=parseFloat(z.value);break;case"percentage":C.t="n",C.v=parseFloat(z.value);break;case"currency":C.t="n",C.v=parseFloat(z.value);break;case"date":C.t="d",C.v=Jr(z["date-value"]),r.cellDates||(C.t="n",C.v=Yn(C.v)),C.z="m/d/yy";break;case"time":C.t="n",C.v=hF(z["time-value"])/86400,r.cellDates&&(C.t="d",C.v=bd(C.v)),C.z="HH:MM:SS";break;case"number":C.t="n",C.v=parseFloat(z.);break;default:if(C.t==="string"||C.t==="text"||!C.t)C.t="s",z["string-value"]!=null&&(W=Nt(z["string-value"]),re=[]);else throw new Error("Unsupported value type "+C.t)}}else{if(Z=!1,C.t==="s"&&(C.v=W||"",re.length&&(C.R=re),Z=P==0),te.Target&&(C.l=te),se.length>0&&(C.c=se,se=[]),W&&r.cellText!==!1&&(C.w=W),Z&&(C.t="z",delete C.v),(!Z||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=Q))for(var we=0;we<Ce;++we){if(ne=parseInt(z["number-columns-repeated"]||"1",10),r.dense)for(w[Q+we]||(w[Q+we]=[]),w[Q+we][ee]=we==0?C:en(C);--ne>0;)w[Q+we][ee+ne]=en(C);else for(w[vt({r:Q+we,c:ee})]=C;--ne>0;)w[vt({r:Q+we,c:ee+ne})]=en(C);k.e.c<=ee&&(k.e.c=ee)}ne=parseInt(z["number-columns-repeated"]||"1",10),ee+=ne-1,ne=0,C={},W="",re=[]}te={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(S[1]==="/"){if((o=i.pop())[0]!==S[3])throw"Bad state: "+o}else S[0].charAt(S[0].length-2)!=="/"&&i.push([S[3],!0]);break;case"annotation":if(S[1]==="/"){if((o=i.pop())[0]!==S[3])throw"Bad state: "+o;M.t=W,re.length&&(M.R=re),M.a=j,se.push(M)}else S[0].charAt(S[0].length-2)!=="/"&&i.push([S[3],!1]);j="",Y=0,W="",P=0,re=[];break;case"creator":S[1]==="/"?j=n.slice(Y,S.index):Y=S.index+S[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(S[1]==="/"){if((o=i.pop())[0]!==S[3])throw"Bad state: "+o}else S[0].charAt(S[0].length-2)!=="/"&&i.push([S[3],!1]);W="",P=0,re=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(S[1]==="/"){if(E[u.name]=h,(o=i.pop())[0]!==S[3])throw"Bad state: "+o}else S[0].charAt(S[0].length-2)!=="/"&&(h="",u=st(S[0],!1),i.push([S[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(i[i.length-1][0]){case"time-style":case"date-style":c=st(S[0],!1),h+=u2[S[3]][c.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(i[i.length-1][0]){case"time-style":case"date-style":c=st(S[0],!1),h+=u2[S[3]][c.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(S[0].slice(-2)==="/>")break;if(S[1]==="/")switch(i[i.length-1][0]){case"number-style":case"date-style":case"time-style":h+=n.slice(d,S.index);break}else d=S.index+S[0].length;break;case"named-range":c=st(S[0],!1),G=eg(c["cell-range-address"]);var Te={Name:c.name,Ref:G[0]+"!"+G[1]};ue&&(Te.Sheet=A.length),be.Names.push(Te);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(i[i.length-1][0])>-1)break;if(S[1]==="/"&&(!z||!z["string-value"])){var Ue=G7(n.slice(P,S.index));W=(W.length>0?W+`
`:"")+Ue[0]}else st(S[0],!1),P=S.index+S[0].length;break;case"s":break;case"database-range":if(S[1]==="/")break;try{G=eg(st(S[0])["target-range-address"]),x[G[0]]["!autofilter"]={ref:G[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(S[1]!=="/"){if(te=st(S[0],!1),!te.href)break;te.Target=Nt(te.href),delete te.href,te.Target.charAt(0)=="#"&&te.Target.indexOf(".")>-1?(G=eg(te.Target.slice(1)),te.Target="#"+G[0]+"!"+G[1]):te.Target.match(/^\.\.[\\\/]/)&&(te.Target=te.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(S[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(r.WTF)throw new Error(S)}}var K={Sheets:x,SheetNames:A,Workbook:be};return r.bookSheets&&delete K.Sheets,K}function f2(t,e){e=e||{},ua(t,"META-INF/manifest.xml")&&d8(wr(t,"META-INF/manifest.xml"),e);var r=qn(t,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var n=I4(Jt(r),e);return ua(t,"meta.xml")&&(n.Props=qS(wr(t,"meta.xml"))),n}function h2(t,e){return I4(t,e)}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function lv(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}function Ug(t){return typeof TextDecoder<"u"?new TextDecoder().decode(t):Jt(Qo(t))}function Bg(t){var e=t.reduce(function(i,o){return i+o.length},0),r=new Uint8Array(e),n=0;return t.forEach(function(i){r.set(i,n),n+=i.length}),r}function d2(t){return t-=t>>1&1431655765,t=(t&858993459)+(t>>2&858993459),(t+(t>>4)&252645135)*16843009>>>24}function q7(t,e){for(var r=(t[e+15]&127)<<7|t[e+14]>>1,n=t[e+14]&1,i=e+13;i>=e;--i)n=n*256+t[i];return(t[e+15]&128?-n:n)*Math.pow(10,r-6176)}function pf(t,e){var r=e?e[0]:0,n=t[r]&127;e:if(t[r++]>=128&&(n|=(t[r]&127)<<7,t[r++]<128||(n|=(t[r]&127)<<14,t[r++]<128)||(n|=(t[r]&127)<<21,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,28),++r,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,35),++r,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,42),++r,t[r++]<128)))break e;return e&&(e[0]=r),n}function Mr(t){var e=0,r=t[e]&127;e:if(t[e++]>=128){if(r|=(t[e]&127)<<7,t[e++]<128||(r|=(t[e]&127)<<14,t[e++]<128)||(r|=(t[e]&127)<<21,t[e++]<128))break e;r|=(t[e]&127)<<28}return r}function hn(t){for(var e=[],r=[0];r[0]<t.length;){var n=r[0],i=pf(t,r),o=i&7;i=Math.floor(i/8);var c=0,u;if(i==0)break;switch(o){case 0:{for(var h=r[0];t[r[0]++]>=128;);u=t.slice(h,r[0])}break;case 5:c=4,u=t.slice(r[0],r[0]+c),r[0]+=c;break;case 1:c=8,u=t.slice(r[0],r[0]+c),r[0]+=c;break;case 2:c=pf(t,r),u=t.slice(r[0],r[0]+c),r[0]+=c;break;case 3:case 4:default:throw new Error("PB Type ".concat(o," for Field ").concat(i," at offset ").concat(n))}var d={data:u,type:o};e[i]==null?e[i]=[d]:e[i].push(d)}return e}function cv(t,e){return t?.map(function(r){return e(r.data)})||[]}function K7(t){for(var e,r=[],n=[0];n[0]<t.length;){var i=pf(t,n),o=hn(t.slice(n[0],n[0]+i));n[0]+=i;var c={id:Mr(o[1][0].data),messages:[]};o[2].forEach(function(u){var h=hn(u.data),d=Mr(h[3][0].data);c.messages.push({meta:h,data:t.slice(n[0],n[0]+d)}),n[0]+=d}),(e=o[3])!=null&&e[0]&&(c.merge=Mr(o[3][0].data)>>>0>0),r.push(c)}return r}function X7(t,e){if(t!=0)throw new Error("Unexpected Snappy chunk type ".concat(t));for(var r=[0],n=pf(e,r),i=[];r[0]<e.length;){var o=e[r[0]]&3;if(o==0){var c=e[r[0]++]>>2;if(c<60)++c;else{var u=c-59;c=e[r[0]],u>1&&(c|=e[r[0]+1]<<8),u>2&&(c|=e[r[0]+2]<<16),u>3&&(c|=e[r[0]+3]<<24),c>>>=0,c++,r[0]+=u}i.push(e.slice(r[0],r[0]+c)),r[0]+=c;continue}else{var h=0,d=0;if(o==1?(d=(e[r[0]]>>2&7)+4,h=(e[r[0]++]&224)<<3,h|=e[r[0]++]):(d=(e[r[0]++]>>2)+1,o==2?(h=e[r[0]]|e[r[0]+1]<<8,r[0]+=2):(h=(e[r[0]]|e[r[0]+1]<<8|e[r[0]+2]<<16|e[r[0]+3]<<24)>>>0,r[0]+=4)),i=[Bg(i)],h==0)throw new Error("Invalid offset 0");if(h>i[0].length)throw new Error("Invalid offset beyond length");if(d>=h)for(i.push(i[0].slice(-h)),d-=h;d>=i[i.length-1].length;)i.push(i[i.length-1]),d-=i[i.length-1].length;i.push(i[0].slice(-h,-h+d))}}var g=Bg(i);if(g.length!=n)throw new Error("Unexpected length: ".concat(g.length," != ").concat(n));return g}function W7(t){for(var e=[],r=0;r<t.length;){var n=t[r++],i=t[r]|t[r+1]<<8|t[r+2]<<16;r+=3,e.push(X7(n,t.slice(r,r+i))),r+=i}if(r!==t.length)throw new Error("data is not a valid framed stream!");return Bg(e)}function Y7(t,e,r,n){var i=lv(t),o=i.getUint32(4,!0),c=(n>1?12:8)+d2(o&(n>1?3470:398))*4,u=-1,h=-1,d=NaN,g=new Date(2001,0,1);o&512&&(u=i.getUint32(c,!0),c+=4),c+=d2(o&(n>1?12288:4096))*4,o&16&&(h=i.getUint32(c,!0),c+=4),o&32&&(d=i.getFloat64(c,!0),c+=8),o&64&&(g.setTime(g.getTime()+i.getFloat64(c,!0)*1e3),c+=8);var _;switch(t[2]){case 0:break;case 2:_={t:"n",v:d};break;case 3:_={t:"s",v:e[h]};break;case 5:_={t:"d",v:g};break;case 6:_={t:"b",v:d>0};break;case 7:_={t:"n",v:d/86400};break;case 8:_={t:"e",v:0};break;case 9:if(u>-1)_={t:"s",v:r[u]};else if(h>-1)_={t:"s",v:e[h]};else if(!isNaN(d))_={t:"n",v:d};else throw new Error("Unsupported cell type ".concat(t.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(t.slice(0,4)))}return _}function $7(t,e,r){var n=lv(t),i=n.getUint32(8,!0),o=12,c=-1,u=-1,h=NaN,d=NaN,g=new Date(2001,0,1);i&1&&(h=q7(t,o),o+=16),i&2&&(d=n.getFloat64(o,!0),o+=8),i&4&&(g.setTime(g.getTime()+n.getFloat64(o,!0)*1e3),o+=8),i&8&&(u=n.getUint32(o,!0),o+=4),i&16&&(c=n.getUint32(o,!0),o+=4);var _;switch(t[1]){case 0:break;case 2:_={t:"n",v:h};break;case 3:_={t:"s",v:e[u]};break;case 5:_={t:"d",v:g};break;case 6:_={t:"b",v:d>0};break;case 7:_={t:"n",v:d/86400};break;case 8:_={t:"e",v:0};break;case 9:if(c>-1)_={t:"s",v:r[c]};else throw new Error("Unsupported cell type ".concat(t[1]," : ").concat(i&31," : ").concat(t.slice(0,4)));break;case 10:_={t:"n",v:h};break;default:throw new Error("Unsupported cell type ".concat(t[1]," : ").concat(i&31," : ").concat(t.slice(0,4)))}return _}function Q7(t,e,r){switch(t[0]){case 0:case 1:case 2:case 3:return Y7(t,e,r,t[0]);case 5:return $7(t,e,r);default:throw new Error("Unsupported payload version ".concat(t[0]))}}function Ps(t){var e=hn(t);return pf(e[1][0].data)}function p2(t,e){var r=hn(e.data),n=Mr(r[1][0].data),i=r[3],o=[];return(i||[]).forEach(function(c){var u=hn(c.data),h=Mr(u[1][0].data)>>>0;switch(n){case 1:o[h]=Ug(u[3][0].data);break;case 8:{var d=t[Ps(u[9][0].data)][0],g=hn(d.data),_=t[Ps(g[1][0].data)][0],x=Mr(_.meta[1][0].data);if(x!=2001)throw new Error("2000 unexpected reference to ".concat(x));var A=hn(_.data);o[h]=A[3].map(function(w){return Ug(w.data)}).join("")}break}}),o}function Z7(t,e){var r,n,i,o,c,u,h,d,g,_,x,A,w,S,C=hn(t),z=Mr(C[1][0].data)>>>0,W=Mr(C[2][0].data)>>>0,P=((n=(r=C[8])==null?void 0:r[0])==null?void 0:n.data)&&Mr(C[8][0].data)>0||!1,re,Q;if((o=(i=C[7])==null?void 0:i[0])!=null&&o.data&&e!=0)re=(u=(c=C[7])==null?void 0:c[0])==null?void 0:u.data,Q=(d=(h=C[6])==null?void 0:h[0])==null?void 0:d.data;else if((_=(g=C[4])==null?void 0:g[0])!=null&&_.data&&e!=1)re=(A=(x=C[4])==null?void 0:x[0])==null?void 0:A.data,Q=(S=(w=C[3])==null?void 0:w[0])==null?void 0:S.data;else throw"NUMBERS Tile missing ".concat(e," cell storage");for(var ee=P?4:1,k=lv(re),T=[],E=0;E<re.length/2;++E){var I=k.getUint16(E*2,!0);I<65535&&T.push([E,I])}if(T.length!=W)throw"Expected ".concat(W," cells, found ").concat(T.length);var O=[];for(E=0;E<T.length-1;++E)O[T[E][0]]=Q.subarray(T[E][1]*ee,T[E+1][1]*ee);return T.length>=1&&(O[T[T.length-1][0]]=Q.subarray(T[T.length-1][1]*ee)),{R:z,cells:O}}function J7(t,e){var r,n=hn(e.data),i=(r=n?.[7])!=null&&r[0]?Mr(n[7][0].data)>>>0>0?1:0:-1,o=cv(n[5],function(c){return Z7(c,i)});return{nrows:Mr(n[4][0].data)>>>0,data:o.reduce(function(c,u){return c[u.R]||(c[u.R]=[]),u.cells.forEach(function(h,d){if(c[u.R][d])throw new Error("Duplicate cell r=".concat(u.R," c=").concat(d));c[u.R][d]=h}),c},[])}}function eV(t,e,r){var n,i=hn(e.data),o={s:{r:0,c:0},e:{r:0,c:0}};if(o.e.r=(Mr(i[6][0].data)>>>0)-1,o.e.r<0)throw new Error("Invalid row varint ".concat(i[6][0].data));if(o.e.c=(Mr(i[7][0].data)>>>0)-1,o.e.c<0)throw new Error("Invalid col varint ".concat(i[7][0].data));r["!ref"]=qt(o);var c=hn(i[4][0].data),u=p2(t,t[Ps(c[4][0].data)][0]),h=(n=c[17])!=null&&n[0]?p2(t,t[Ps(c[17][0].data)][0]):[],d=hn(c[3][0].data),g=0;d[1].forEach(function(_){var x=hn(_.data),A=t[Ps(x[2][0].data)][0],w=Mr(A.meta[1][0].data);if(w!=6002)throw new Error("6001 unexpected reference to ".concat(w));var S=J7(t,A);S.data.forEach(function(C,z){C.forEach(function(W,P){var re=vt({r:g+z,c:P}),Q=Q7(W,u,h);Q&&(r[re]=Q)})}),g+=S.nrows})}function tV(t,e){var r=hn(e.data),n={"!ref":"A1"},i=t[Ps(r[2][0].data)],o=Mr(i[0].meta[1][0].data);if(o!=6001)throw new Error("6000 unexpected reference to ".concat(o));return eV(t,i[0],n),n}function rV(t,e){var r,n=hn(e.data),i={name:(r=n[1])!=null&&r[0]?Ug(n[1][0].data):"",sheets:[]},o=cv(n[2],Ps);return o.forEach(function(c){t[c].forEach(function(u){var h=Mr(u.meta[1][0].data);h==6e3&&i.sheets.push(tV(t,u))})}),i}function nV(t,e){var r=N4(),n=hn(e.data),i=cv(n[1],Ps);if(i.forEach(function(o){t[o].forEach(function(c){var u=Mr(c.meta[1][0].data);if(u==2){var h=rV(t,c);h.sheets.forEach(function(d,g){F4(r,d,g==0?h.name:h.name+"_"+g,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function rg(t){var e,r,n,i,o={},c=[];if(t.FullPaths.forEach(function(h){if(h.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),t.FileIndex.forEach(function(h){if(h.name.match(/\.iwa$/)){var d;try{d=W7(h.content)}catch(_){return console.log("?? "+h.content.length+" "+(_.message||_))}var g;try{g=K7(d)}catch(_){return console.log("## "+(_.message||_))}g.forEach(function(_){o[_.id]=_.messages,c.push(_.id)})}}),!c.length)throw new Error("File has no messages");var u=((i=(n=(r=(e=o?.[1])==null?void 0:e[0])==null?void 0:r.meta)==null?void 0:n[1])==null?void 0:i[0].data)&&Mr(o[1][0].meta[1][0].data)==1&&o[1][0];if(u||c.forEach(function(h){o[h].forEach(function(d){var g=Mr(d.meta[1][0].data)>>>0;if(g==1)if(!u)u=d;else throw new Error("Document has multiple roots")})}),!u)throw new Error("Cannot find Document root");return nV(o,u)}function aV(t){return function(r){for(var n=0;n!=t.length;++n){var i=t[n];r[i[0]]===void 0&&(r[i[0]]=i[1]),i[2]==="n"&&(r[i[0]]=Number(r[i[0]]))}}}function uv(t){aV([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(t)}function iV(t){return $l.WS.indexOf(t)>-1?"sheet":t==$l.CS?"chart":t==$l.DS?"dialog":t==$l.MS?"macro":t&&t.length?t:"sheet"}function sV(t,e){if(!t)return 0;try{t=e.map(function(n){return n.id||(n.id=n.strRelID),[n.name,t["!id"][n.id].Target,iV(t["!id"][n.id].Type)]})}catch{return null}return!t||t.length===0?null:t}function oV(t,e,r,n,i,o,c,u,h,d,g,_){try{o[n]=zu(qn(t,r,!0),e);var x=wr(t,e),A;switch(u){case"sheet":A=y7(x,e,i,h,o[n],d,g,_);break;case"chart":if(A=E7(x,e,i,h,o[n],d,g,_),!A||!A["!drawel"])break;var w=Du(A["!drawel"].Target,e),S=Fg(w),C=x5(qn(t,w,!0),zu(qn(t,S,!0),w)),z=Du(C,w),W=Fg(z);A=n7(qn(t,z,!0),z,h,zu(qn(t,W,!0),z),d,A);break;case"macro":A=T7(x,e,i,h,o[n],d,g,_);break;case"dialog":A=A7(x,e,i,h,o[n],d,g,_);break;default:throw new Error("Unrecognized sheet type "+u)}c[n]=A;var P=[];o&&o[n]&&qs(o[n]).forEach(function(re){var Q="";if(o[n][re].Type==$l.CMNT){Q=Du(o[n][re].Target,e);var ee=R7(wr(t,Q,!0),Q,h);if(!ee||!ee.length)return;e2(A,ee,!1)}o[n][re].Type==$l.TCMNT&&(Q=Du(o[n][re].Target,e),P=P.concat(E5(wr(t,Q,!0),h)))}),P&&P.length&&e2(A,P,!0,h.people||[])}catch(re){if(h.WTF)throw re}}function la(t){return t.charAt(0)=="/"?t.slice(1):t}function lV(t,e){if(mS(),e=e||{},uv(e),ua(t,"META-INF/manifest.xml")||ua(t,"objectdata.xml"))return f2(t,e);if(ua(t,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof rg<"u"){if(t.FileIndex)return rg(t);var r=Dt.utils.cfb_new();return RT(t).forEach(function(Fe){_F(r,Fe,vF(t,Fe))}),rg(r)}throw new Error("Unsupported NUMBERS file")}if(!ua(t,"[Content_Types].xml"))throw ua(t,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):ua(t,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=RT(t),i=f8(qn(t,"[Content_Types].xml")),o=!1,c,u;if(i.workbooks.length===0&&(u="xl/workbook.xml",wr(t,u,!0)&&i.workbooks.push(u)),i.workbooks.length===0){if(u="xl/workbook.bin",!wr(t,u,!0))throw new Error("Could not find workbook");i.workbooks.push(u),o=!0}i.workbooks[0].slice(-3)=="bin"&&(o=!0);var h={},d={};if(!e.bookSheets&&!e.bookProps){if(qu=[],i.sst)try{qu=C7(wr(t,la(i.sst)),i.sst,e)}catch(Fe){if(e.WTF)throw Fe}e.cellStyles&&i.themes.length&&(h=S7(qn(t,i.themes[0].replace(/^\//,""),!0)||"",i.themes[0],e)),i.style&&(d=w7(wr(t,la(i.style)),i.style,h,e))}i.links.map(function(Fe){try{var Ce=zu(qn(t,Fg(la(Fe))),Fe);return b7(wr(t,la(Fe)),Ce,Fe,e)}catch{}});var g=x7(wr(t,la(i.workbooks[0])),i.workbooks[0],e),_={},x="";i.coreprops.length&&(x=wr(t,la(i.coreprops[0]),!0),x&&(_=qS(x)),i.extprops.length!==0&&(x=wr(t,la(i.extprops[0]),!0),x&&g8(x,_,e)));var A={};(!e.bookSheets||e.bookProps)&&i.custprops.length!==0&&(x=qn(t,la(i.custprops[0]),!0),x&&(A=_8(x,e)));var w={};if((e.bookSheets||e.bookProps)&&(g.Sheets?c=g.Sheets.map(function(Ce){return Ce.name}):_.Worksheets&&_.SheetNames.length>0&&(c=_.SheetNames),e.bookProps&&(w.Props=_,w.Custprops=A),e.bookSheets&&typeof c<"u"&&(w.SheetNames=c),e.bookSheets?w.SheetNames:e.bookProps))return w;c={};var S={};e.bookDeps&&i.calcchain&&(S=k7(wr(t,la(i.calcchain)),i.calcchain));var C=0,z={},W,P;{var re=g.Sheets;_.Worksheets=re.length,_.SheetNames=[];for(var Q=0;Q!=re.length;++Q)_.SheetNames[Q]=re[Q].name}var ee=o?"bin":"xml",k=i.workbooks[0].lastIndexOf("/"),T=(i.workbooks[0].slice(0,k+1)+"_rels/"+i.workbooks[0].slice(k+1)+".rels").replace(/^\//,"");ua(t,T)||(T="xl/_rels/workbook."+ee+".rels");var E=zu(qn(t,T,!0),T.replace(/_rels.*/,"s5s"));(i.metadata||[]).length>=1&&(e.xlmeta=I7(wr(t,la(i.metadata[0])),i.metadata[0],e)),(i.people||[]).length>=1&&(e.people=T5(wr(t,la(i.people[0])),e)),E&&(E=sV(E,g.Sheets));var I=wr(t,"xl/worksheets/sheet.xml",!0)?1:0;e:for(C=0;C!=_.Worksheets;++C){var O="sheet";if(E&&E[C]?(W="xl/"+E[C][1].replace(/[\/]?xl\//,""),ua(t,W)||(W=E[C][1]),ua(t,W)||(W=T.replace(/_rels\/.*$/,"")+E[C][1]),O=E[C][2]):(W="xl/worksheets/sheet"+(C+1-I)+"."+ee,W=W.replace(/sheet0\./,"sheet.")),P=W.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),e&&e.sheets!=null)switch(typeof e.sheets){case"number":if(C!=e.sheets)continue e;break;case"string":if(_.SheetNames[C].toLowerCase()!=e.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(e.sheets)){for(var D=!1,F=0;F!=e.sheets.length;++F)typeof e.sheets[F]=="number"&&e.sheets[F]==C&&(D=1),typeof e.sheets[F]=="string"&&e.sheets[F].toLowerCase()==_.SheetNames[C].toLowerCase()&&(D=1);if(!D)continue e}}oV(t,W,P,_.SheetNames[C],C,z,c,O,e,g,h,d)}return w={Directory:i,Workbook:g,Props:_,Custprops:A,Deps:S,Sheets:c,SheetNames:_.SheetNames,Strings:qu,Styles:d,Themes:h,SSF:en(ht)},e&&e.bookFiles&&(t.files?(w.keys=n,w.files=t.files):(w.keys=[],w.files={},t.FullPaths.forEach(function(Fe,Ce){Fe=Fe.replace(/^Root Entry[\/]/,""),w.keys.push(Fe),w.files[Fe]=t.FileIndex[Ce]}))),e&&e.bookVBA&&(i.vba.length>0?w.vbaraw=wr(t,la(i.vba[0]),!0):i.defaults&&i.defaults.bin===C5&&(w.vbaraw=wr(t,"xl/vbaProject.bin",!0))),w}function cV(t,e){var r=e||{},n="Workbook",i=Dt.find(t,n);try{if(n="/!DataSpaces/Version",i=Dt.find(t,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(lM(i.content),n="/!DataSpaces/DataSpaceMap",i=Dt.find(t,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var o=uM(i.content);if(o.length!==1||o[0].comps.length!==1||o[0].comps[0].t!==0||o[0].name!=="StrongEncryptionDataSpace"||o[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",i=Dt.find(t,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var c=fM(i.content);if(c.length!=1||c[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",i=Dt.find(t,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);dM(i.content)}catch{}if(n="/EncryptionInfo",i=Dt.find(t,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var u=pM(i.content);if(n="/EncryptedPackage",i=Dt.find(t,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(u[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(u[1],i.content,r.password||"",r);if(u[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(u[1],i.content,r.password||"",r);throw new Error("File is password-protected")}function fv(t,e){var r="";switch((e||{}).type||"base64"){case"buffer":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];case"base64":r=Wn(t.slice(0,12));break;case"binary":r=t;break;case"array":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];default:throw new Error("Unrecognized type "+(e&&e.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function uV(t,e){return Dt.find(t,"EncryptedPackage")?cV(t,e):b4(t,e)}function fV(t,e){var r,n=t,i=e||{};return i.type||(i.type=wt&&Buffer.isBuffer(t)?"buffer":"base64"),r=ES(n,i),lV(r,i)}function D4(t,e){var r=0;e:for(;r<t.length;)switch(t.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return Lg(t.slice(r),e);default:break e}return ff.to_workbook(t,e)}function hV(t,e){var r="",n=fv(t,e);switch(e.type){case"base64":r=Wn(t);break;case"binary":r=t;break;case"buffer":r=t.toString("binary");break;case"array":r=zo(t);break;default:throw new Error("Unrecognized type "+e.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(r=Jt(r)),e.type="binary",D4(r,e)}function dV(t,e){var r=t;return e.type=="base64"&&(r=Wn(r)),r=sf.utils.decode(1200,r.slice(2),"str"),e.type="binary",D4(r,e)}function pV(t){return t.match(/[^\x00-\x7F]/)?Ou(t):t}function ng(t,e,r,n){return n?(r.type="string",ff.to_workbook(t,r)):ff.to_workbook(e,r)}function jg(t,e){nS();var r=e||{};if(typeof ArrayBuffer<"u"&&t instanceof ArrayBuffer)return jg(new Uint8Array(t),(r=en(r),r.type="array",r));typeof Uint8Array<"u"&&t instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var n=t,i=[0,0,0,0],o=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),ac={},r.dateNF&&(ac.dateNF=r.dateNF),r.type||(r.type=wt&&Buffer.isBuffer(t)?"buffer":"base64"),r.type=="file"&&(r.type=wt?"buffer":"binary",n=uF(t),typeof Uint8Array<"u"&&!wt&&(r.type="array")),r.type=="string"&&(o=!0,r.type="binary",r.codepage=65001,n=pV(t)),r.type=="array"&&typeof Uint8Array<"u"&&t instanceof Uint8Array&&typeof ArrayBuffer<"u"){var c=new ArrayBuffer(3),u=new Uint8Array(c);if(u.foo="bar",!u.foo)return r=en(r),r.type="array",jg(q1(n),r)}switch((i=fv(n,r))[0]){case 208:if(i[1]===207&&i[2]===17&&i[3]===224&&i[4]===161&&i[5]===177&&i[6]===26&&i[7]===225)return uV(Dt.read(n,r),r);break;case 9:if(i[1]<=8)return b4(n,r);break;case 60:return Lg(n,r);case 73:if(i[1]===73&&i[2]===42&&i[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(i[1]===68)return YP(n,r);break;case 84:if(i[1]===65&&i[2]===66&&i[3]===76)return XP.to_workbook(n,r);break;case 80:return i[1]===75&&i[2]<9&&i[3]<9?fV(n,r):ng(t,n,r,o);case 239:return i[3]===60?Lg(n,r):ng(t,n,r,o);case 255:if(i[1]===254)return dV(n,r);if(i[1]===0&&i[2]===2&&i[3]===0)return Gu.to_workbook(n,r);break;case 0:if(i[1]===0&&(i[2]>=2&&i[3]===0||i[2]===0&&(i[3]===8||i[3]===9)))return Gu.to_workbook(n,r);break;case 3:case 131:case 139:case 140:return JT.to_workbook(n,r);case 123:if(i[1]===92&&i[2]===114&&i[3]===116)return CM.to_workbook(n,r);break;case 10:case 13:case 32:return hV(n,r);case 137:if(i[1]===80&&i[2]===78&&i[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return qP.indexOf(i[0])>-1&&i[2]<=12&&i[3]<=31?JT.to_workbook(n,r):ng(t,n,r,o)}function mV(t,e,r,n,i,o,c,u){var h=Xn(r),d=u.defval,g=u.raw||!Object.prototype.hasOwnProperty.call(u,"raw"),_=!0,x=i===1?[]:{};if(i!==1)if(Object.defineProperty)try{Object.defineProperty(x,"__rowNum__",{value:r,enumerable:!1})}catch{x.__rowNum__=r}else x.__rowNum__=r;if(!c||t[r])for(var A=e.s.c;A<=e.e.c;++A){var w=c?t[r][A]:t[n[A]+h];if(w===void 0||w.t===void 0){if(d===void 0)continue;o[A]!=null&&(x[o[A]]=d);continue}var S=w.v;switch(w.t){case"z":if(S==null)break;continue;case"e":S=S==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+w.t)}if(o[A]!=null){if(S==null)if(w.t=="e"&&S===null)x[o[A]]=null;else if(d!==void 0)x[o[A]]=d;else if(g&&S===null)x[o[A]]=null;else continue;else x[o[A]]=g&&(w.t!=="n"||w.t==="n"&&u.rawNumbers!==!1)?S:hc(w,S,u);S!=null&&(_=!1)}}return{row:x,isempty:_}}function O4(t,e){if(t==null||t["!ref"]==null)return[];var r={t:"n",v:0},n=0,i=1,o=[],c=0,u="",h={s:{r:0,c:0},e:{r:0,c:0}},d=e||{},g=d.range!=null?d.range:t["!ref"];switch(d.header===1?n=1:d.header==="A"?n=2:Array.isArray(d.header)?n=3:d.header==null&&(n=0),typeof g){case"string":h=qr(g);break;case"number":h=qr(t["!ref"]),h.s.r=g;break;default:h=g}n>0&&(i=0);var _=Xn(h.s.r),x=[],A=[],w=0,S=0,C=Array.isArray(t),z=h.s.r,W=0,P={};C&&!t[z]&&(t[z]=[]);var re=d.skipHidden&&t["!cols"]||[],Q=d.skipHidden&&t["!rows"]||[];for(W=h.s.c;W<=h.e.c;++W)if(!(re[W]||{}).hidden)switch(x[W]=wn(W),r=C?t[z][W]:t[x[W]+_],n){case 1:o[W]=W-h.s.c;break;case 2:o[W]=x[W];break;case 3:o[W]=d.header[W-h.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),u=c=hc(r,null,d),S=P[c]||0,!S)P[c]=1;else{do u=c+"_"+S++;while(P[u]);P[c]=S,P[u]=1}o[W]=u}for(z=h.s.r+i;z<=h.e.r;++z)if(!(Q[z]||{}).hidden){var ee=mV(t,h,z,x,n,o,C,d);(ee.isempty===!1||(n===1?d.blankrows!==!1:d.blankrows))&&(A[w++]=ee.row)}return A.length=w,A}function N4(){return{SheetNames:[],Sheets:{}}}function F4(t,e,r,n){var i=1;if(!r)for(;i<=65535&&t.SheetNames.indexOf(r="Sheet"+i)!=-1;++i,r=void 0);if(!r||t.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&t.SheetNames.indexOf(r)>=0){var o=r.match(/(^.*?)(\d+)$/);i=o&&+o[2]||0;var c=o&&o[1]||r;for(++i;i<=65535&&t.SheetNames.indexOf(r=c+i)!=-1;++i);}if(f7(r),t.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return t.SheetNames.push(r),t.Sheets[r]=e,r}var gV={sheet_to_json:O4},E0={exports:{}};/* @license
Papa Parse
v5.5.3
https://github.com/mholt/PapaParse
License: MIT
*/var vV=E0.exports,m2;function _V(){return m2||(m2=1,function(t,e){((r,n)=>{t.exports=n()})(vV,function r(){var n=typeof self<"u"?self:typeof window<"u"?window:n!==void 0?n:{},i,o=!n.document&&!!n.postMessage,c=n.IS_PAPA_WORKER||!1,u={},h=0,d={};function g(T){this._handle=null,this._finished=!1,this._completed=!1,this._halted=!1,this._input=null,this._baseIndex=0,this._partialLine="",this._rowCount=0,this._start=0,this._nextChunk=null,this.isFirstChunk=!0,this._completeResults={data:[],errors:[],meta:{}},(function(E){var I=Q(E);I.chunkSize=parseInt(I.chunkSize),E.step||E.chunk||(I.chunkSize=null),this._handle=new S(I),(this._handle.streamer=this)._config=I}).call(this,T),this.parseChunk=function(E,I){var O=parseInt(this._config.skipFirstNLines)||0;if(this.isFirstChunk&&0<O){let F=this._config.newline;F||(D=this._config.quoteChar||'"',F=this._handle.guessLineEndings(E,D)),E=[...E.split(F).slice(O)].join(F)}this.isFirstChunk&&k(this._config.beforeFirstChunk)&&(D=this._config.beforeFirstChunk(E))!==void 0&&(E=D),this.isFirstChunk=!1,this._halted=!1;var O=this._partialLine+E,D=(this._partialLine="",this._handle.parse(O,this._baseIndex,!this._finished));if(!this._handle.paused()&&!this._handle.aborted()){if(E=D.meta.cursor,O=(this._finished||(this._partialLine=O.substring(E-this._baseIndex),this._baseIndex=E),D&&D.data&&(this._rowCount+=D.data.length),this._finished||this._config.preview&&this._rowCount>=this._config.preview),c)n.postMessage({results:D,workerId:d.WORKER_ID,finished:O});else if(k(this._config.chunk)&&!I){if(this._config.chunk(D,this._handle),this._handle.paused()||this._handle.aborted())return void(this._halted=!0);this._completeResults=D=void 0}return this._config.step||this._config.chunk||(this._completeResults.data=this._completeResults.data.concat(D.data),this._completeResults.errors=this._completeResults.errors.concat(D.errors),this._completeResults.meta=D.meta),this._completed||!O||!k(this._config.complete)||D&&D.meta.aborted||(this._config.complete(this._completeResults,this._input),this._completed=!0),O||D&&D.meta.paused||this._nextChunk(),D}this._halted=!0},this._sendError=function(E){k(this._config.error)?this._config.error(E):c&&this._config.error&&n.postMessage({workerId:d.WORKER_ID,error:E,finished:!1})}}function _(T){var E;(T=T||{}).chunkSize||(T.chunkSize=d.RemoteChunkSize),g.call(this,T),this._nextChunk=o?function(){this._readChunk(),this._chunkLoaded()}:function(){this._readChunk()},this.stream=function(I){this._input=I,this._nextChunk()},this._readChunk=function(){if(this._finished)this._chunkLoaded();else{if(E=new XMLHttpRequest,this._config.withCredentials&&(E.withCredentials=this._config.withCredentials),o||(E.onload=ee(this._chunkLoaded,this),E.onerror=ee(this._chunkError,this)),E.open(this._config.downloadRequestBody?"POST":"GET",this._input,!o),this._config.downloadRequestHeaders){var I,O=this._config.downloadRequestHeaders;for(I in O)E.setRequestHeader(I,O[I])}var D;this._config.chunkSize&&(D=this._start+this._config.chunkSize-1,E.setRequestHeader("Range","bytes="+this._start+"-"+D));try{E.send(this._config.downloadRequestBody)}catch(F){this._chunkError(F.message)}o&&E.status===0&&this._chunkError()}},this._chunkLoaded=function(){E.readyState===4&&(E.status<200||400<=E.status?this._chunkError():(this._start+=this._config.chunkSize||E.responseText.length,this._finished=!this._config.chunkSize||this._start>=(I=>(I=I.getResponseHeader("Content-Range"))!==null?parseInt(I.substring(I.lastIndexOf("/")+1)):-1)(E),this.parseChunk(E.responseText)))},this._chunkError=function(I){I=E.statusText||I,this._sendError(new Error(I))}}function x(T){(T=T||{}).chunkSize||(T.chunkSize=d.LocalChunkSize),g.call(this,T);var E,I,O=typeof FileReader<"u";this.stream=function(D){this._input=D,I=D.slice||D.webkitSlice||D.mozSlice,O?((E=new FileReader).onload=ee(this._chunkLoaded,this),E.onerror=ee(this._chunkError,this)):E=new FileReaderSync,this._nextChunk()},this._nextChunk=function(){this._finished||this._config.preview&&!(this._rowCount<this._config.preview)||this._readChunk()},this._readChunk=function(){var D=this._input,F=(this._config.chunkSize&&(F=Math.min(this._start+this._config.chunkSize,this._input.size),D=I.call(D,this._start,F)),E.readAsText(D,this._config.encoding));O||this._chunkLoaded({target:{result:F}})},this._chunkLoaded=function(D){this._start+=this._config.chunkSize,this._finished=!this._config.chunkSize||this._start>=this._input.size,this.parseChunk(D.target.result)},this._chunkError=function(){this._sendError(E.error)}}function A(T){var E;g.call(this,T=T||{}),this.stream=function(I){return E=I,this._nextChunk()},this._nextChunk=function(){var I,O;if(!this._finished)return I=this._config.chunkSize,E=I?(O=E.substring(0,I),E.substring(I)):(O=E,""),this._finished=!E,this.parseChunk(O)}}function w(T){g.call(this,T=T||{});var E=[],I=!0,O=!1;this.pause=function(){g.prototype.pause.apply(this,arguments),this._input.pause()},this.resume=function(){g.prototype.resume.apply(this,arguments),this._input.resume()},this.stream=function(D){this._input=D,this._input.on("data",this._streamData),this._input.on("end",this._streamEnd),this._input.on("error",this._streamError)},this._checkIsFinished=function(){O&&E.length===1&&(this._finished=!0)},this._nextChunk=function(){this._checkIsFinished(),E.length?this.parseChunk(E.shift()):I=!0},this._streamData=ee(function(D){try{E.push(typeof D=="string"?D:D.toString(this._config.encoding)),I&&(I=!1,this._checkIsFinished(),this.parseChunk(E.shift()))}catch(F){this._streamError(F)}},this),this._streamError=ee(function(D){this._streamCleanUp(),this._sendError(D)},this),this._streamEnd=ee(function(){this._streamCleanUp(),O=!0,this._streamData("")},this),this._streamCleanUp=ee(function(){this._input.removeListener("data",this._streamData),this._input.removeListener("end",this._streamEnd),this._input.removeListener("error",this._streamError)},this)}function S(T){var E,I,O,D,F=Math.pow(2,53),Fe=-F,Ce=/^\s*-?(\d+\.?|\.\d+|\d+\.\d+)([eE][-+]?\d+)?\s*$/,ne=/^((\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z)))$/,oe=this,be=0,te=0,G=!1,se=!1,M=[],j={data:[],errors:[],meta:{}};function Y(Ee){return T.skipEmptyLines==="greedy"?Ee.join("").trim()==="":Ee.length===1&&Ee[0].length===0}function Z(){if(j&&O&&(Ie("Delimiter","UndetectableDelimiter","Unable to auto-detect delimiting character; defaulted to '"+d.DefaultDelimiter+"'"),O=!1),T.skipEmptyLines&&(j.data=j.data.filter(function(K){return!Y(K)})),ue()){let K=function(nt,Ge){k(T.transformHeader)&&(nt=T.transformHeader(nt,Ge)),M.push(nt)};var Ue=K;if(j)if(Array.isArray(j.data[0])){for(var Ee=0;ue()&&Ee<j.data.length;Ee++)j.data[Ee].forEach(K);j.data.splice(0,1)}else j.data.forEach(K)}function we(K,nt){for(var Ge=T.header?{}:[],Ke=0;Ke<K.length;Ke++){var Be=Ke,Ne=K[Ke],Ne=((Ye,ut)=>(_t=>(T.dynamicTypingFunction&&T.dynamicTyping[_t]===void 0&&(T.dynamicTyping[_t]=T.dynamicTypingFunction(_t)),(T.dynamicTyping[_t]||T.dynamicTyping)===!0))(Ye)?ut==="true"||ut==="TRUE"||ut!=="false"&&ut!=="FALSE"&&((_t=>{if(Ce.test(_t)&&(_t=parseFloat(_t),Fe<_t&&_t<F))return 1})(ut)?parseFloat(ut):ne.test(ut)?new Date(ut):ut===""?null:ut):ut)(Be=T.header?Ke>=M.length?"__parsed_extra":M[Ke]:Be,Ne=T.transform?T.transform(Ne,Be):Ne);Be==="__parsed_extra"?(Ge[Be]=Ge[Be]||[],Ge[Be].push(Ne)):Ge[Be]=Ne}return T.header&&(Ke>M.length?Ie("FieldMismatch","TooManyFields","Too many fields: expected "+M.length+" fields but parsed "+Ke,te+nt):Ke<M.length&&Ie("FieldMismatch","TooFewFields","Too few fields: expected "+M.length+" fields but parsed "+Ke,te+nt)),Ge}var Te;j&&(T.header||T.dynamicTyping||T.transform)&&(Te=1,!j.data.length||Array.isArray(j.data[0])?(j.data=j.data.map(we),Te=j.data.length):j.data=we(j.data,0),T.header&&j.meta&&(j.meta.fields=M),te+=Te)}function ue(){return T.header&&M.length===0}function Ie(Ee,we,Te,Ue){Ee={type:Ee,code:we,message:Te},Ue!==void 0&&(Ee.row=Ue),j.errors.push(Ee)}k(T.step)&&(D=T.step,T.step=function(Ee){j=Ee,ue()?Z():(Z(),j.data.length!==0&&(be+=Ee.data.length,T.preview&&be>T.preview?I.abort():(j.data=j.data[0],D(j,oe))))}),this.parse=function(Ee,we,Te){var Ue=T.quoteChar||'"',Ue=(T.newline||(T.newline=this.guessLineEndings(Ee,Ue)),O=!1,T.delimiter?k(T.delimiter)&&(T.delimiter=T.delimiter(Ee),j.meta.delimiter=T.delimiter):((Ue=((K,nt,Ge,Ke,Be)=>{var Ne,Ye,ut,_t;Be=Be||[",","	","|",";",d.RECORD_SEP,d.UNIT_SEP];for(var rr=0;rr<Be.length;rr++){for(var _r,fr=Be[rr],Et=0,er=0,Ze=0,Je=(ut=void 0,new z({comments:Ke,delimiter:fr,newline:nt,preview:10}).parse(K)),dt=0;dt<Je.data.length;dt++)Ge&&Y(Je.data[dt])?Ze++:(_r=Je.data[dt].length,er+=_r,ut===void 0?ut=_r:0<_r&&(Et+=Math.abs(_r-ut),ut=_r));0<Je.data.length&&(er/=Je.data.length-Ze),(Ye===void 0||Et<=Ye)&&(_t===void 0||_t<er)&&1.99<er&&(Ye=Et,Ne=fr,_t=er)}return{successful:!!(T.delimiter=Ne),bestDelimiter:Ne}})(Ee,T.newline,T.skipEmptyLines,T.comments,T.delimitersToGuess)).successful?T.delimiter=Ue.bestDelimiter:(O=!0,T.delimiter=d.DefaultDelimiter),j.meta.delimiter=T.delimiter),Q(T));return T.preview&&T.header&&Ue.preview++,E=Ee,I=new z(Ue),j=I.parse(E,we,Te),Z(),G?{meta:{paused:!0}}:j||{meta:{paused:!1}}},this.paused=function(){return G},this.pause=function(){G=!0,I.abort(),E=k(T.chunk)?"":E.substring(I.getCharIndex())},this.resume=function(){oe.streamer._halted?(G=!1,oe.streamer.parseChunk(E,!0)):setTimeout(oe.resume,3)},this.aborted=function(){return se},this.abort=function(){se=!0,I.abort(),j.meta.aborted=!0,k(T.complete)&&T.complete(j),E=""},this.guessLineEndings=function(K,Ue){K=K.substring(0,1048576);var Ue=new RegExp(C(Ue)+"([^]*?)"+C(Ue),"gm"),Te=(K=K.replace(Ue,"")).split("\r"),Ue=K.split(`
`),K=1<Ue.length&&Ue[0].length<Te[0].length;if(Te.length===1||K)return`
`;for(var nt=0,Ge=0;Ge<Te.length;Ge++)Te[Ge][0]===`
`&&nt++;return nt>=Te.length/2?`\r
`:"\r"}}function C(T){return T.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function z(T){var E=(T=T||{}).delimiter,I=T.newline,O=T.comments,D=T.step,F=T.preview,Fe=T.fastMode,Ce=null,ne=!1,oe=T.quoteChar==null?'"':T.quoteChar,be=oe;if(T.escapeChar!==void 0&&(be=T.escapeChar),(typeof E!="string"||-1<d.BAD_DELIMITERS.indexOf(E))&&(E=","),O===E)throw new Error("Comment character same as delimiter");O===!0?O="#":(typeof O!="string"||-1<d.BAD_DELIMITERS.indexOf(O))&&(O=!1),I!==`
`&&I!=="\r"&&I!==`\r
`&&(I=`
`);var te=0,G=!1;this.parse=function(se,M,j){if(typeof se!="string")throw new Error("Input must be a string");var Y=se.length,Z=E.length,ue=I.length,Ie=O.length,Ee=k(D),we=[],Te=[],Ue=[],K=te=0;if(!se)return Et();if(Fe||Fe!==!1&&se.indexOf(oe)===-1){for(var nt=se.split(I),Ge=0;Ge<nt.length;Ge++){if(Ue=nt[Ge],te+=Ue.length,Ge!==nt.length-1)te+=I.length;else if(j)return Et();if(!O||Ue.substring(0,Ie)!==O){if(Ee){if(we=[],_t(Ue.split(E)),er(),G)return Et()}else _t(Ue.split(E));if(F&&F<=Ge)return we=we.slice(0,F),Et(!0)}}return Et()}for(var Ke=se.indexOf(E,te),Be=se.indexOf(I,te),Ne=new RegExp(C(be)+C(oe),"g"),Ye=se.indexOf(oe,te);;)if(se[te]===oe)for(Ye=te,te++;;){if((Ye=se.indexOf(oe,Ye+1))===-1)return j||Te.push({type:"Quotes",code:"MissingQuotes",message:"Quoted field unterminated",row:we.length,index:te}),_r();if(Ye===Y-1)return _r(se.substring(te,Ye).replace(Ne,oe));if(oe===be&&se[Ye+1]===be)Ye++;else if(oe===be||Ye===0||se[Ye-1]!==be){Ke!==-1&&Ke<Ye+1&&(Ke=se.indexOf(E,Ye+1));var ut=rr((Be=Be!==-1&&Be<Ye+1?se.indexOf(I,Ye+1):Be)===-1?Ke:Math.min(Ke,Be));if(se.substr(Ye+1+ut,Z)===E){Ue.push(se.substring(te,Ye).replace(Ne,oe)),se[te=Ye+1+ut+Z]!==oe&&(Ye=se.indexOf(oe,te)),Ke=se.indexOf(E,te),Be=se.indexOf(I,te);break}if(ut=rr(Be),se.substring(Ye+1+ut,Ye+1+ut+ue)===I){if(Ue.push(se.substring(te,Ye).replace(Ne,oe)),fr(Ye+1+ut+ue),Ke=se.indexOf(E,te),Ye=se.indexOf(oe,te),Ee&&(er(),G))return Et();if(F&&we.length>=F)return Et(!0);break}Te.push({type:"Quotes",code:"InvalidQuotes",message:"Trailing quote on quoted field is malformed",row:we.length,index:te}),Ye++}}else if(O&&Ue.length===0&&se.substring(te,te+Ie)===O){if(Be===-1)return Et();te=Be+ue,Be=se.indexOf(I,te),Ke=se.indexOf(E,te)}else if(Ke!==-1&&(Ke<Be||Be===-1))Ue.push(se.substring(te,Ke)),te=Ke+Z,Ke=se.indexOf(E,te);else{if(Be===-1)break;if(Ue.push(se.substring(te,Be)),fr(Be+ue),Ee&&(er(),G))return Et();if(F&&we.length>=F)return Et(!0)}return _r();function _t(Ze){we.push(Ze),K=te}function rr(Ze){var Je=0;return Je=Ze!==-1&&(Ze=se.substring(Ye+1,Ze))&&Ze.trim()===""?Ze.length:Je}function _r(Ze){return j||(Ze===void 0&&(Ze=se.substring(te)),Ue.push(Ze),te=Y,_t(Ue),Ee&&er()),Et()}function fr(Ze){te=Ze,_t(Ue),Ue=[],Be=se.indexOf(I,te)}function Et(Ze){if(T.header&&!M&&we.length&&!ne){var Je=we[0],dt=Object.create(null),Lt=new Set(Je);let ot=!1;for(let Ft=0;Ft<Je.length;Ft++){let Vt=Je[Ft];if(dt[Vt=k(T.transformHeader)?T.transformHeader(Vt,Ft):Vt]){let Ot,Lr=dt[Vt];for(;Ot=Vt+"_"+Lr,Lr++,Lt.has(Ot););Lt.add(Ot),Je[Ft]=Ot,dt[Vt]++,ot=!0,(Ce=Ce===null?{}:Ce)[Ot]=Vt}else dt[Vt]=1,Je[Ft]=Vt;Lt.add(Vt)}ot&&console.warn("Duplicate headers found and renamed."),ne=!0}return{data:we,errors:Te,meta:{delimiter:E,linebreak:I,aborted:G,truncated:!!Ze,cursor:K+(M||0),renamedHeaders:Ce}}}function er(){D(Et()),we=[],Te=[]}},this.abort=function(){G=!0},this.getCharIndex=function(){return te}}function W(T){var E=T.data,I=u[E.workerId],O=!1;if(E.error)I.userError(E.error,E.file);else if(E.results&&E.results.data){var D={abort:function(){O=!0,P(E.workerId,{data:[],errors:[],meta:{aborted:!0}})},pause:re,resume:re};if(k(I.userStep)){for(var F=0;F<E.results.data.length&&(I.userStep({data:E.results.data[F],errors:E.results.errors,meta:E.results.meta},D),!O);F++);delete E.results}else k(I.userChunk)&&(I.userChunk(E.results,D,E.file),delete E.results)}E.finished&&!O&&P(E.workerId,E.results)}function P(T,E){var I=u[T];k(I.userComplete)&&I.userComplete(E),I.terminate(),delete u[T]}function re(){throw new Error("Not implemented.")}function Q(T){if(typeof T!="object"||T===null)return T;var E,I=Array.isArray(T)?[]:{};for(E in T)I[E]=Q(T[E]);return I}function ee(T,E){return function(){T.apply(E,arguments)}}function k(T){return typeof T=="function"}return d.parse=function(T,E){var I=(E=E||{}).dynamicTyping||!1;if(k(I)&&(E.dynamicTypingFunction=I,I={}),E.dynamicTyping=I,E.transform=!!k(E.transform)&&E.transform,!E.worker||!d.WORKERS_SUPPORTED)return I=null,d.NODE_STREAM_INPUT,typeof T=="string"?(T=(O=>O.charCodeAt(0)!==65279?O:O.slice(1))(T),I=new(E.download?_:A)(E)):T.readable===!0&&k(T.read)&&k(T.on)?I=new w(E):(n.File&&T instanceof File||T instanceof Object)&&(I=new x(E)),I.stream(T);(I=(()=>{var O;return!!d.WORKERS_SUPPORTED&&(O=(()=>{var D=n.URL||n.webkitURL||null,F=r.toString();return d.BLOB_URL||(d.BLOB_URL=D.createObjectURL(new Blob(["var global = (function() { if (typeof self !== 'undefined') { return self; } if (typeof window !== 'undefined') { return window; } if (typeof global !== 'undefined') { return global; } return {}; })(); global.IS_PAPA_WORKER=true; ","(",F,")();"],{type:"text/javascript"})))})(),(O=new n.Worker(O)).onmessage=W,O.id=h++,u[O.id]=O)})()).userStep=E.step,I.userChunk=E.chunk,I.userComplete=E.complete,I.userError=E.error,E.step=k(E.step),E.chunk=k(E.chunk),E.complete=k(E.complete),E.error=k(E.error),delete E.worker,I.postMessage({input:T,config:E,workerId:I.id})},d.unparse=function(T,E){var I=!1,O=!0,D=",",F=`\r
`,Fe='"',Ce=Fe+Fe,ne=!1,oe=null,be=!1,te=((()=>{if(typeof E=="object"){if(typeof E.delimiter!="string"||d.BAD_DELIMITERS.filter(function(M){return E.delimiter.indexOf(M)!==-1}).length||(D=E.delimiter),typeof E.quotes!="boolean"&&typeof E.quotes!="function"&&!Array.isArray(E.quotes)||(I=E.quotes),typeof E.skipEmptyLines!="boolean"&&typeof E.skipEmptyLines!="string"||(ne=E.skipEmptyLines),typeof E.newline=="string"&&(F=E.newline),typeof E.quoteChar=="string"&&(Fe=E.quoteChar),typeof E.header=="boolean"&&(O=E.header),Array.isArray(E.columns)){if(E.columns.length===0)throw new Error("Option columns is empty");oe=E.columns}E.escapeChar!==void 0&&(Ce=E.escapeChar+Fe),E.escapeFormulae instanceof RegExp?be=E.escapeFormulae:typeof E.escapeFormulae=="boolean"&&E.escapeFormulae&&(be=/^[=+\-@\t\r].*$/)}})(),new RegExp(C(Fe),"g"));if(typeof T=="string"&&(T=JSON.parse(T)),Array.isArray(T)){if(!T.length||Array.isArray(T[0]))return G(null,T,ne);if(typeof T[0]=="object")return G(oe||Object.keys(T[0]),T,ne)}else if(typeof T=="object")return typeof T.data=="string"&&(T.data=JSON.parse(T.data)),Array.isArray(T.data)&&(T.fields||(T.fields=T.meta&&T.meta.fields||oe),T.fields||(T.fields=Array.isArray(T.data[0])?T.fields:typeof T.data[0]=="object"?Object.keys(T.data[0]):[]),Array.isArray(T.data[0])||typeof T.data[0]=="object"||(T.data=[T.data])),G(T.fields||[],T.data||[],ne);throw new Error("Unable to serialize unrecognized input");function G(M,j,Y){var Z="",ue=(typeof M=="string"&&(M=JSON.parse(M)),typeof j=="string"&&(j=JSON.parse(j)),Array.isArray(M)&&0<M.length),Ie=!Array.isArray(j[0]);if(ue&&O){for(var Ee=0;Ee<M.length;Ee++)0<Ee&&(Z+=D),Z+=se(M[Ee],Ee);0<j.length&&(Z+=F)}for(var we=0;we<j.length;we++){var Te=(ue?M:j[we]).length,Ue=!1,K=ue?Object.keys(j[we]).length===0:j[we].length===0;if(Y&&!ue&&(Ue=Y==="greedy"?j[we].join("").trim()==="":j[we].length===1&&j[we][0].length===0),Y==="greedy"&&ue){for(var nt=[],Ge=0;Ge<Te;Ge++){var Ke=Ie?M[Ge]:Ge;nt.push(j[we][Ke])}Ue=nt.join("").trim()===""}if(!Ue){for(var Be=0;Be<Te;Be++){0<Be&&!K&&(Z+=D);var Ne=ue&&Ie?M[Be]:Be;Z+=se(j[we][Ne],Be)}we<j.length-1&&(!Y||0<Te&&!K)&&(Z+=F)}}return Z}function se(M,j){var Y,Z;return M==null?"":M.constructor===Date?JSON.stringify(M).slice(1,25):(Z=!1,be&&typeof M=="string"&&be.test(M)&&(M="'"+M,Z=!0),Y=M.toString().replace(te,Ce),(Z=Z||I===!0||typeof I=="function"&&I(M,j)||Array.isArray(I)&&I[j]||((ue,Ie)=>{for(var Ee=0;Ee<Ie.length;Ee++)if(-1<ue.indexOf(Ie[Ee]))return!0;return!1})(Y,d.BAD_DELIMITERS)||-1<Y.indexOf(D)||Y.charAt(0)===" "||Y.charAt(Y.length-1)===" ")?Fe+Y+Fe:Y)}},d.RECORD_SEP="",d.UNIT_SEP="",d.BYTE_ORDER_MARK="\uFEFF",d.BAD_DELIMITERS=["\r",`
`,'"',d.BYTE_ORDER_MARK],d.WORKERS_SUPPORTED=!o&&!!n.Worker,d.NODE_STREAM_INPUT=1,d.LocalChunkSize=10485760,d.RemoteChunkSize=5242880,d.DefaultDelimiter=",",d.Parser=z,d.ParserHandle=S,d.NetworkStreamer=_,d.FileStreamer=x,d.StringStreamer=A,d.ReadableStreamStreamer=w,n.jQuery&&((i=n.jQuery).fn.parse=function(T){var E=T.config||{},I=[];return this.each(function(F){if(!(i(this).prop("tagName").toUpperCase()==="INPUT"&&i(this).attr("type").toLowerCase()==="file"&&n.FileReader)||!this.files||this.files.length===0)return!0;for(var Fe=0;Fe<this.files.length;Fe++)I.push({file:this.files[Fe],inputElem:this,instanceConfig:i.extend({},E)})}),O(),this;function O(){if(I.length===0)k(T.complete)&&T.complete();else{var F,Fe,Ce,ne,oe=I[0];if(k(T.before)){var be=T.before(oe.file,oe.inputElem);if(typeof be=="object"){if(be.action==="abort")return F="AbortError",Fe=oe.file,Ce=oe.inputElem,ne=be.reason,void(k(T.error)&&T.error({name:F},Fe,Ce,ne));if(be.action==="skip")return void D();typeof be.config=="object"&&(oe.instanceConfig=i.extend(oe.instanceConfig,be.config))}else if(be==="skip")return void D()}var te=oe.instanceConfig.complete;oe.instanceConfig.complete=function(G){k(te)&&te(G,oe.file,oe.inputElem),D()},d.parse(oe.file,oe.instanceConfig)}}function D(){I.splice(0,1),O()}}),c&&(n.onmessage=function(T){T=T.data,d.WORKER_ID===void 0&&T&&(d.WORKER_ID=T.workerId),typeof T.input=="string"?n.postMessage({workerId:d.WORKER_ID,results:d.parse(T.input,T.config),finished:!0}):(n.File&&T.input instanceof File||T.input instanceof Object)&&(T=d.parse(T.input,T.config))&&n.postMessage({workerId:d.WORKER_ID,results:T,finished:!0})}),(_.prototype=Object.create(g.prototype)).constructor=_,(x.prototype=Object.create(g.prototype)).constructor=x,(A.prototype=Object.create(A.prototype)).constructor=A,(w.prototype=Object.create(g.prototype)).constructor=w,d})}(E0)),E0.exports}var xV=_V();const yV=zg(xV),EV=()=>{const[t,e]=Pe.useState([]),[r,n]=Pe.useState([]),[i,o]=Pe.useState(!0),[c,u]=Pe.useState(!1),[h,d]=Pe.useState(null),[g,_]=Pe.useState({nom:"",prenom:"",classeId:"",email:"",dateNaissance:""}),[x,A]=Pe.useState(null);Pe.useEffect(()=>{w(),S()},[]);const w=async()=>{try{o(!0);const Q=await Hl.getAllEleves();e(Q)}catch(Q){A("Erreur lors du chargement des lves"),console.error(Q)}finally{o(!1)}},S=async()=>{try{const Q=await NN.getAllClasses();n(Q)}catch(Q){A("Erreur lors du chargement des classes"),console.error(Q)}},C=async Q=>{if(Q.preventDefault(),!g.nom.trim()||!g.prenom.trim()||!g.classeId){A("Tous les champs obligatoires doivent tre remplis");return}try{h?await Hl.updateEleve(h.id,g):await Hl.createEleve(g),_({nom:"",prenom:"",classeId:"",email:"",dateNaissance:""}),d(null),u(!1),A(null),await w()}catch(ee){A("Erreur lors de l'enregistrement"),console.error(ee)}},z=Q=>{d(Q),_({nom:Q.nom,prenom:Q.prenom,classeId:Q.classeId,email:Q.email||"",dateNaissance:Q.dateNaissance||""}),u(!0)},W=async Q=>{if(window.confirm("tes-vous sr de vouloir supprimer cet lve ?"))try{await Hl.deleteEleve(Q),await w()}catch(ee){A("Erreur lors de la suppression"),console.error(ee)}},P=()=>{_({nom:"",prenom:"",classeId:"",email:"",dateNaissance:""}),d(null),u(!1),A(null)},re=async Q=>{const ee=Q.target.files?.[0];if(ee){A(null);try{let k=[];if(ee.name.endsWith(".csv")){const F=await ee.text(),Fe=F.includes(";");k=yV.parse(F,{header:!0,delimiter:Fe?";":","}).data.filter(ne=>Object.values(ne).some(oe=>oe&&String(oe).trim()!=="")),k.length>0&&(k=k.map(ne=>{const oe={};return Object.keys(ne).forEach(be=>{oe[be.trim()]=typeof ne[be]=="string"?ne[be].trim():ne[be]}),oe}))}else if(ee.name.endsWith(".xlsx")){const F=await ee.arrayBuffer(),Fe=jg(F,{type:"array"}),Ce=Fe.Sheets[Fe.SheetNames[0]];k=gV.sheet_to_json(Ce)}else{A("Format de fichier non support. Utilisez .csv ou .xlsx");return}const T=["nom","prenom","classe"],E=k[0]||{},I=Object.keys(E).join(", ");for(const F of T)if(!Object.keys(E).includes(F)){A(`Colonne manquante ou vide : ${F}. Colonnes dtectes : ${I}`);return}for(const F of k)for(const Fe of T)if(!F[Fe]){A(`Colonne manquante ou vide : ${Fe}. Colonnes dtectes : ${I}`);return}const O=new Map(r.map(F=>[F.nom,F.id])),D=Array.from(new Set(k.map(F=>F.classe).filter(F=>!O.has(F))));if(D.length>0){A("Classe(s) inconnue(s) : "+D.join(", "));return}for(const F of k)await Hl.createEleve({nom:F.nom,prenom:F.prenom,classeId:String(O.get(F.classe)),email:F.email||"",dateNaissance:F.dateNaissance||""});await w(),A(null),alert("Import termin !")}catch(k){A("Erreur lors de l'import : "+k.message),console.error(k)}}};return i?ie.jsx("div",{className:"loading",children:"Chargement des lves..."}):ie.jsxs("div",{className:"gestion-eleves",children:[ie.jsxs("div",{className:"header",children:[ie.jsx("h2",{children:"Gestion des lves"}),ie.jsxs("div",{style:{display:"flex",gap:"1rem"},children:[ie.jsx("button",{className:"btn-primary",onClick:()=>u(!0),children:"Ajouter un lve"}),ie.jsxs("label",{className:"btn-primary",style:{cursor:"pointer",margin:0},children:["Importer des lves",ie.jsx("input",{type:"file",accept:".csv,.xlsx",style:{display:"none"},onChange:re})]})]})]}),x&&ie.jsx("div",{className:"error-message",children:x}),c&&ie.jsx("div",{className:"form-overlay",children:ie.jsxs("div",{className:"form-container",children:[ie.jsx("h3",{children:h?"Modifier l'lve":"Nouvel lve"}),ie.jsxs("form",{onSubmit:C,children:[ie.jsxs("div",{className:"form-group",children:[ie.jsx("label",{htmlFor:"nom",children:"Nom"}),ie.jsx("input",{type:"text",id:"nom",value:g.nom,onChange:Q=>_({...g,nom:Q.target.value}),required:!0})]}),ie.jsxs("div",{className:"form-group",children:[ie.jsx("label",{htmlFor:"prenom",children:"Prnom"}),ie.jsx("input",{type:"text",id:"prenom",value:g.prenom,onChange:Q=>_({...g,prenom:Q.target.value}),required:!0})]}),ie.jsxs("div",{className:"form-group",children:[ie.jsx("label",{htmlFor:"classeId",children:"Classe"}),ie.jsxs("select",{id:"classeId",value:g.classeId,onChange:Q=>_({...g,classeId:Q.target.value}),required:!0,children:[ie.jsx("option",{value:"",children:"Slectionner une classe"}),r.map(Q=>ie.jsx("option",{value:Q.id,children:Q.nom},Q.id))]})]}),ie.jsxs("div",{className:"form-group",children:[ie.jsx("label",{htmlFor:"email",children:"Email"}),ie.jsx("input",{type:"email",id:"email",value:g.email,onChange:Q=>_({...g,email:Q.target.value})})]}),ie.jsxs("div",{className:"form-group",children:[ie.jsx("label",{htmlFor:"dateNaissance",children:"Date de naissance"}),ie.jsx("input",{type:"date",id:"dateNaissance",value:g.dateNaissance,onChange:Q=>_({...g,dateNaissance:Q.target.value})})]}),ie.jsxs("div",{className:"form-actions",children:[ie.jsx("button",{type:"submit",className:"btn-primary",children:h?"Modifier":"Crer"}),ie.jsx("button",{type:"button",className:"btn-secondary",onClick:P,children:"Annuler"}),!h&&ie.jsx("button",{type:"button",className:"btn-primary",onClick:async()=>{if(!g.nom.trim()||!g.prenom.trim()||!g.classeId){A("Tous les champs obligatoires doivent tre remplis");return}try{await Hl.createEleve(g),_({nom:"",prenom:"",classeId:"",email:"",dateNaissance:""}),A(null),await w()}catch(Q){A("Erreur lors de la cration"),console.error(Q)}},children:"Crer et ajouter un autre"})]})]})]})}),ie.jsx("div",{className:"eleves-grid",children:t.length===0?ie.jsxs("div",{className:"empty-state",children:[ie.jsx("p",{children:"Aucun lve trouv"}),ie.jsx("button",{className:"btn-primary",onClick:()=>u(!0),children:"Crer le premier lve"})]}):t.map(Q=>ie.jsxs("div",{className:"eleve-card",children:[ie.jsxs("div",{className:"eleve-info",children:[ie.jsxs("h3",{children:[Q.prenom," ",Q.nom]}),ie.jsxs("p",{children:["Classe : ",r.find(ee=>ee.id===Q.classeId)?.nom||"Inconnue"]}),ie.jsxs("p",{children:["Email : ",Q.email||"Non renseign"]}),ie.jsxs("p",{children:["Date de naissance : ",Q.dateNaissance||"Non renseigne"]}),ie.jsxs("p",{children:["Cr le ",(()=>{let ee=Q.createdAt;return ee instanceof Date||(ee=new Date(ee)),isNaN(ee.getTime())?"Date inconnue":ee.toLocaleDateString("fr-FR")})()]})]}),ie.jsxs("div",{className:"eleve-actions",children:[ie.jsx("button",{className:"btn-edit",onClick:()=>z(Q),children:"Modifier"}),ie.jsx("button",{className:"btn-delete",onClick:()=>W(Q.id),children:"Supprimer"})]})]},Q.id))})]})},Nd="periodesStage",TV=async()=>(await Ad(Hs(Fr,Nd))).docs.map(e=>({id:e.id,...e.data()})),AV=async t=>(await Cd(Hs(Fr,Nd),t)).id,wV=async(t,e)=>{await wd(pa(Fr,Nd,t),e)},SV=async t=>{await Sd(pa(Fr,Nd,t))},CV=()=>{const[t,e]=Pe.useState([]),[r,n]=Pe.useState({nom:"",dateDebut:"",dateFin:""}),[i,o]=Pe.useState(null),[c,u]=Pe.useState(!1),h=async()=>{u(!0),e(await TV()),u(!1)};Pe.useEffect(()=>{h()},[]);const d=A=>{n({...r,[A.target.name]:A.target.value})},g=async A=>{A.preventDefault(),i?(await wV(i,r),o(null)):await AV(r),n({nom:"",dateDebut:"",dateFin:""}),h()},_=A=>{o(A.id),n({nom:A.nom,dateDebut:A.dateDebut,dateFin:A.dateFin})},x=async A=>{window.confirm("Supprimer cette priode ?")&&(await SV(A),h())};return ie.jsxs("div",{className:"gestion-periodes-stage",children:[ie.jsx("h2",{children:"Gestion des priodes de stage"}),ie.jsxs("form",{onSubmit:g,style:{marginBottom:24},children:[ie.jsx("input",{name:"nom",placeholder:"Nom (ex: PFMP1)",value:r.nom,onChange:d,required:!0}),ie.jsx("input",{name:"dateDebut",type:"date",value:r.dateDebut,onChange:d,required:!0}),ie.jsx("input",{name:"dateFin",type:"date",value:r.dateFin,onChange:d,required:!0}),ie.jsx("button",{type:"submit",children:i?"Modifier":"Ajouter"}),i&&ie.jsx("button",{type:"button",onClick:()=>{o(null),n({nom:"",dateDebut:"",dateFin:""})},children:"Annuler"})]}),c?ie.jsx("p",{children:"Chargement..."}):ie.jsxs("table",{children:[ie.jsx("thead",{children:ie.jsxs("tr",{children:[ie.jsx("th",{children:"Nom"}),ie.jsx("th",{children:"Dbut"}),ie.jsx("th",{children:"Fin"}),ie.jsx("th",{children:"Actions"})]})}),ie.jsx("tbody",{children:t.map(A=>ie.jsxs("tr",{children:[ie.jsx("td",{children:A.nom}),ie.jsx("td",{children:A.dateDebut}),ie.jsx("td",{children:A.dateFin}),ie.jsxs("td",{children:[ie.jsx("button",{onClick:()=>_(A),children:"Modifier"}),ie.jsx("button",{onClick:()=>x(A.id),children:"Supprimer"})]})]},A.id))})]})]})},RV=({isDarkMode:t})=>{const{currentUser:e}=kd(),r=[{label:"Grer les classes",description:"Crez, modifiez et supprimez les classes",link:"/classes",show:e?.role==="admin",icon:""},{label:"Grer les lves",description:"Ajoutez et grez les lves",link:"/eleves",show:!0,icon:""},{label:"Grer les stages",description:"Dfinissez les priodes de stage (PFMP1, PFMP2...)",link:"/periodes-stage",show:!0,icon:""},{label:"valuer un lve",description:"Remplissez une fiche d'valuation",link:"/evaluations",show:!0,icon:""},{label:"Exporter rapports",description:"Tlchargez les rapports de suivi",link:"/rapports",show:!0,icon:""},{label:"Gestion des comptes",description:"Grez les comptes utilisateurs",link:"/comptes",show:e?.role==="admin",icon:""}];return ie.jsx("div",{className:`app home-landing ${t?"dark":"light"}`,children:ie.jsxs("main",{className:"main",style:{minHeight:"100vh"},children:[ie.jsx("h1",{style:{textAlign:"center",fontSize:"3rem",fontWeight:800,marginBottom:"1rem"},children:"Grez vos stages et valuations avec IA"}),ie.jsx("p",{style:{textAlign:"center",fontSize:"1.3rem",marginBottom:"2.5rem",color:"#555"},children:"Plateforme moderne pour la gestion des stages, des lves et des valuations"}),ie.jsx("div",{className:"tiles-grid",children:r.filter(n=>n.show).map(n=>ie.jsxs(xs,{to:n.link,className:"tile-card",children:[ie.jsx("div",{className:"tile-icon",children:n.icon}),ie.jsx("div",{className:"tile-title",children:n.label}),ie.jsx("div",{className:"tile-desc",children:n.description})]},n.label))}),e&&ie.jsxs("p",{style:{textAlign:"center",marginTop:"2rem",color:"#888"},children:["Connect en tant que : ",e.prenom," ",e.nom," (",e.role,")"]})]})})},u0=({children:t})=>{const{currentUser:e,loading:r}=kd();return r?ie.jsx("div",{className:"loading",children:"Chargement..."}):e?ie.jsx(ie.Fragment,{children:t}):ie.jsx(R2,{to:"/login"})},kV=()=>{const[t,e]=Pe.useState(!1),r=()=>{e(!t)};return ie.jsx(pk,{children:ie.jsxs("div",{className:`app ${t?"dark":"light"}`,children:[ie.jsx(bN,{onToggleTheme:r,isDarkMode:t}),ie.jsxs(ok,{children:[ie.jsx(Ro,{path:"/login",element:ie.jsx(IN,{})}),ie.jsx(Ro,{path:"/",element:ie.jsx(u0,{children:ie.jsx(RV,{isDarkMode:t})})}),ie.jsx(Ro,{path:"/classes",element:ie.jsx(u0,{children:ie.jsx(DN,{})})}),ie.jsx(Ro,{path:"/eleves",element:ie.jsx(u0,{children:ie.jsx(EV,{})})}),ie.jsx(Ro,{path:"/periodes-stage",element:ie.jsx(u0,{children:ie.jsx(CV,{})})}),ie.jsx(Ro,{path:"*",element:ie.jsx(R2,{to:"/"})})]})]})})};function bV(){return ie.jsx(kN,{children:ie.jsx(kV,{})})}gR.createRoot(document.getElementById("root")).render(ie.jsx(g2.StrictMode,{children:ie.jsx(bV,{})}));
